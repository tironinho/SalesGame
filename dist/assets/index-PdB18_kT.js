(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();var Bn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Um(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Fm(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var Yf={exports:{}},Ba={},Qf={exports:{}},Me={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gi=Symbol.for("react.element"),zm=Symbol.for("react.portal"),Wm=Symbol.for("react.fragment"),Vm=Symbol.for("react.strict_mode"),Gm=Symbol.for("react.profiler"),qm=Symbol.for("react.provider"),Hm=Symbol.for("react.context"),Km=Symbol.for("react.forward_ref"),Jm=Symbol.for("react.suspense"),Ym=Symbol.for("react.memo"),Qm=Symbol.for("react.lazy"),od=Symbol.iterator;function Xm(t){return t===null||typeof t!="object"?null:(t=od&&t[od]||t["@@iterator"],typeof t=="function"?t:null)}var Xf={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Zf=Object.assign,eh={};function mo(t,e,n){this.props=t,this.context=e,this.refs=eh,this.updater=n||Xf}mo.prototype.isReactComponent={};mo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};mo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function th(){}th.prototype=mo.prototype;function ic(t,e,n){this.props=t,this.context=e,this.refs=eh,this.updater=n||Xf}var ac=ic.prototype=new th;ac.constructor=ic;Zf(ac,mo.prototype);ac.isPureReactComponent=!0;var id=Array.isArray,nh=Object.prototype.hasOwnProperty,lc={current:null},rh={key:!0,ref:!0,__self:!0,__source:!0};function sh(t,e,n){var r,s={},o=null,i=null;if(e!=null)for(r in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(o=""+e.key),e)nh.call(e,r)&&!rh.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];s.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:gi,type:t,key:o,ref:i,props:s,_owner:lc.current}}function Zm(t,e){return{$$typeof:gi,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function uc(t){return typeof t=="object"&&t!==null&&t.$$typeof===gi}function eg(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var ad=/\/+/g;function dl(t,e){return typeof t=="object"&&t!==null&&t.key!=null?eg(""+t.key):e.toString(36)}function Zi(t,e,n,r,s){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case gi:case zm:i=!0}}if(i)return i=t,s=s(i),t=r===""?"."+dl(i,0):r,id(s)?(n="",t!=null&&(n=t.replace(ad,"$&/")+"/"),Zi(s,e,n,"",function(c){return c})):s!=null&&(uc(s)&&(s=Zm(s,n+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(ad,"$&/")+"/")+t)),e.push(s)),1;if(i=0,r=r===""?".":r+":",id(t))for(var l=0;l<t.length;l++){o=t[l];var u=r+dl(o,l);i+=Zi(o,e,n,u,s)}else if(u=Xm(t),typeof u=="function")for(t=u.call(t),l=0;!(o=t.next()).done;)o=o.value,u=r+dl(o,l++),i+=Zi(o,e,n,u,s);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function Ci(t,e,n){if(t==null)return t;var r=[],s=0;return Zi(t,r,"","",function(o){return e.call(n,o,s++)}),r}function tg(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var hn={current:null},ea={transition:null},ng={ReactCurrentDispatcher:hn,ReactCurrentBatchConfig:ea,ReactCurrentOwner:lc};function oh(){throw Error("act(...) is not supported in production builds of React.")}Me.Children={map:Ci,forEach:function(t,e,n){Ci(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ci(t,function(){e++}),e},toArray:function(t){return Ci(t,function(e){return e})||[]},only:function(t){if(!uc(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Me.Component=mo;Me.Fragment=Wm;Me.Profiler=Gm;Me.PureComponent=ic;Me.StrictMode=Vm;Me.Suspense=Jm;Me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ng;Me.act=oh;Me.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Zf({},t.props),s=t.key,o=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,i=lc.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)nh.call(e,u)&&!rh.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];r.children=l}return{$$typeof:gi,type:t.type,key:s,ref:o,props:r,_owner:i}};Me.createContext=function(t){return t={$$typeof:Hm,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:qm,_context:t},t.Consumer=t};Me.createElement=sh;Me.createFactory=function(t){var e=sh.bind(null,t);return e.type=t,e};Me.createRef=function(){return{current:null}};Me.forwardRef=function(t){return{$$typeof:Km,render:t}};Me.isValidElement=uc;Me.lazy=function(t){return{$$typeof:Qm,_payload:{_status:-1,_result:t},_init:tg}};Me.memo=function(t,e){return{$$typeof:Ym,type:t,compare:e===void 0?null:e}};Me.startTransition=function(t){var e=ea.transition;ea.transition={};try{t()}finally{ea.transition=e}};Me.unstable_act=oh;Me.useCallback=function(t,e){return hn.current.useCallback(t,e)};Me.useContext=function(t){return hn.current.useContext(t)};Me.useDebugValue=function(){};Me.useDeferredValue=function(t){return hn.current.useDeferredValue(t)};Me.useEffect=function(t,e){return hn.current.useEffect(t,e)};Me.useId=function(){return hn.current.useId()};Me.useImperativeHandle=function(t,e,n){return hn.current.useImperativeHandle(t,e,n)};Me.useInsertionEffect=function(t,e){return hn.current.useInsertionEffect(t,e)};Me.useLayoutEffect=function(t,e){return hn.current.useLayoutEffect(t,e)};Me.useMemo=function(t,e){return hn.current.useMemo(t,e)};Me.useReducer=function(t,e,n){return hn.current.useReducer(t,e,n)};Me.useRef=function(t){return hn.current.useRef(t)};Me.useState=function(t){return hn.current.useState(t)};Me.useSyncExternalStore=function(t,e,n){return hn.current.useSyncExternalStore(t,e,n)};Me.useTransition=function(){return hn.current.useTransition()};Me.version="18.3.1";Qf.exports=Me;var j=Qf.exports;const ue=Um(j);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rg=j,sg=Symbol.for("react.element"),og=Symbol.for("react.fragment"),ig=Object.prototype.hasOwnProperty,ag=rg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,lg={key:!0,ref:!0,__self:!0,__source:!0};function ih(t,e,n){var r,s={},o=null,i=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(i=e.ref);for(r in e)ig.call(e,r)&&!lg.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:sg,type:t,key:o,ref:i,props:s,_owner:ag.current}}Ba.Fragment=og;Ba.jsx=ih;Ba.jsxs=ih;Yf.exports=Ba;var a=Yf.exports,Xl={},ah={exports:{}},Tn={},lh={exports:{}},uh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(F,oe){var Z=F.length;F.push(oe);e:for(;0<Z;){var We=Z-1>>>1,he=F[We];if(0<s(he,oe))F[We]=oe,F[Z]=he,Z=We;else break e}}function n(F){return F.length===0?null:F[0]}function r(F){if(F.length===0)return null;var oe=F[0],Z=F.pop();if(Z!==oe){F[0]=Z;e:for(var We=0,he=F.length,ht=he>>>1;We<ht;){var It=2*(We+1)-1,He=F[It],pt=It+1,er=F[pt];if(0>s(He,Z))pt<he&&0>s(er,He)?(F[We]=er,F[pt]=Z,We=pt):(F[We]=He,F[It]=Z,We=It);else if(pt<he&&0>s(er,Z))F[We]=er,F[pt]=Z,We=pt;else break e}}return oe}function s(F,oe){var Z=F.sortIndex-oe.sortIndex;return Z!==0?Z:F.id-oe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var i=Date,l=i.now();t.unstable_now=function(){return i.now()-l}}var u=[],c=[],d=1,h=null,p=3,g=!1,b=!1,x=!1,S=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,f=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function m(F){for(var oe=n(c);oe!==null;){if(oe.callback===null)r(c);else if(oe.startTime<=F)r(c),oe.sortIndex=oe.expirationTime,e(u,oe);else break;oe=n(c)}}function w(F){if(x=!1,m(F),!b)if(n(u)!==null)b=!0,ke(k);else{var oe=n(c);oe!==null&&je(w,oe.startTime-F)}}function k(F,oe){b=!1,x&&(x=!1,y(E),E=-1),g=!0;var Z=p;try{for(m(oe),h=n(u);h!==null&&(!(h.expirationTime>oe)||F&&!C());){var We=h.callback;if(typeof We=="function"){h.callback=null,p=h.priorityLevel;var he=We(h.expirationTime<=oe);oe=t.unstable_now(),typeof he=="function"?h.callback=he:h===n(u)&&r(u),m(oe)}else r(u);h=n(u)}if(h!==null)var ht=!0;else{var It=n(c);It!==null&&je(w,It.startTime-oe),ht=!1}return ht}finally{h=null,p=Z,g=!1}}var D=!1,R=null,E=-1,N=5,v=-1;function C(){return!(t.unstable_now()-v<N)}function P(){if(R!==null){var F=t.unstable_now();v=F;var oe=!0;try{oe=R(!0,F)}finally{oe?I():(D=!1,R=null)}}else D=!1}var I;if(typeof f=="function")I=function(){f(P)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,X=H.port2;H.port1.onmessage=P,I=function(){X.postMessage(null)}}else I=function(){S(P,0)};function ke(F){R=F,D||(D=!0,I())}function je(F,oe){E=S(function(){F(t.unstable_now())},oe)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(F){F.callback=null},t.unstable_continueExecution=function(){b||g||(b=!0,ke(k))},t.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<F?Math.floor(1e3/F):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(F){switch(p){case 1:case 2:case 3:var oe=3;break;default:oe=p}var Z=p;p=oe;try{return F()}finally{p=Z}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(F,oe){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var Z=p;p=F;try{return oe()}finally{p=Z}},t.unstable_scheduleCallback=function(F,oe,Z){var We=t.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?We+Z:We):Z=We,F){case 1:var he=-1;break;case 2:he=250;break;case 5:he=1073741823;break;case 4:he=1e4;break;default:he=5e3}return he=Z+he,F={id:d++,callback:oe,priorityLevel:F,startTime:Z,expirationTime:he,sortIndex:-1},Z>We?(F.sortIndex=Z,e(c,F),n(u)===null&&F===n(c)&&(x?(y(E),E=-1):x=!0,je(w,Z-We))):(F.sortIndex=he,e(u,F),b||g||(b=!0,ke(k))),F},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(F){var oe=p;return function(){var Z=p;p=oe;try{return F.apply(this,arguments)}finally{p=Z}}}})(uh);lh.exports=uh;var ug=lh.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cg=j,On=ug;function G(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ch=new Set,Qo={};function Rs(t,e){io(t,e),io(t+"Capture",e)}function io(t,e){for(Qo[t]=e,t=0;t<e.length;t++)ch.add(e[t])}var _r=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Zl=Object.prototype.hasOwnProperty,dg=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ld={},ud={};function fg(t){return Zl.call(ud,t)?!0:Zl.call(ld,t)?!1:dg.test(t)?ud[t]=!0:(ld[t]=!0,!1)}function hg(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function pg(t,e,n,r){if(e===null||typeof e>"u"||hg(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function pn(t,e,n,r,s,o,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=i}var Xt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Xt[t]=new pn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Xt[e]=new pn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Xt[t]=new pn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Xt[t]=new pn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Xt[t]=new pn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Xt[t]=new pn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Xt[t]=new pn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Xt[t]=new pn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Xt[t]=new pn(t,5,!1,t.toLowerCase(),null,!1,!1)});var cc=/[\-:]([a-z])/g;function dc(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(cc,dc);Xt[e]=new pn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(cc,dc);Xt[e]=new pn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(cc,dc);Xt[e]=new pn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Xt[t]=new pn(t,1,!1,t.toLowerCase(),null,!1,!1)});Xt.xlinkHref=new pn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Xt[t]=new pn(t,1,!1,t.toLowerCase(),null,!0,!0)});function fc(t,e,n,r){var s=Xt.hasOwnProperty(e)?Xt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(pg(e,n,s,r)&&(n=null),r||s===null?fg(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Rr=cg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ri=Symbol.for("react.element"),zs=Symbol.for("react.portal"),Ws=Symbol.for("react.fragment"),hc=Symbol.for("react.strict_mode"),eu=Symbol.for("react.profiler"),dh=Symbol.for("react.provider"),fh=Symbol.for("react.context"),pc=Symbol.for("react.forward_ref"),tu=Symbol.for("react.suspense"),nu=Symbol.for("react.suspense_list"),mc=Symbol.for("react.memo"),Pr=Symbol.for("react.lazy"),hh=Symbol.for("react.offscreen"),cd=Symbol.iterator;function So(t){return t===null||typeof t!="object"?null:(t=cd&&t[cd]||t["@@iterator"],typeof t=="function"?t:null)}var kt=Object.assign,fl;function Oo(t){if(fl===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);fl=e&&e[1]||""}return`
`+fl+t}var hl=!1;function pl(t,e){if(!t||hl)return"";hl=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),o=r.stack.split(`
`),i=s.length-1,l=o.length-1;1<=i&&0<=l&&s[i]!==o[l];)l--;for(;1<=i&&0<=l;i--,l--)if(s[i]!==o[l]){if(i!==1||l!==1)do if(i--,l--,0>l||s[i]!==o[l]){var u=`
`+s[i].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=i&&0<=l);break}}}finally{hl=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Oo(t):""}function mg(t){switch(t.tag){case 5:return Oo(t.type);case 16:return Oo("Lazy");case 13:return Oo("Suspense");case 19:return Oo("SuspenseList");case 0:case 2:case 15:return t=pl(t.type,!1),t;case 11:return t=pl(t.type.render,!1),t;case 1:return t=pl(t.type,!0),t;default:return""}}function ru(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ws:return"Fragment";case zs:return"Portal";case eu:return"Profiler";case hc:return"StrictMode";case tu:return"Suspense";case nu:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case fh:return(t.displayName||"Context")+".Consumer";case dh:return(t._context.displayName||"Context")+".Provider";case pc:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case mc:return e=t.displayName||null,e!==null?e:ru(t.type)||"Memo";case Pr:e=t._payload,t=t._init;try{return ru(t(e))}catch{}}return null}function gg(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ru(e);case 8:return e===hc?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Jr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function ph(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function yg(t){var e=ph(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(i){r=""+i,o.call(this,i)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ni(t){t._valueTracker||(t._valueTracker=yg(t))}function mh(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=ph(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function da(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function su(t,e){var n=e.checked;return kt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function dd(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Jr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function gh(t,e){e=e.checked,e!=null&&fc(t,"checked",e,!1)}function ou(t,e){gh(t,e);var n=Jr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?iu(t,e.type,n):e.hasOwnProperty("defaultValue")&&iu(t,e.type,Jr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function fd(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function iu(t,e,n){(e!=="number"||da(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var To=Array.isArray;function eo(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Jr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function au(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(G(91));return kt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function hd(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(G(92));if(To(n)){if(1<n.length)throw Error(G(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Jr(n)}}function yh(t,e){var n=Jr(e.value),r=Jr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function pd(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function vh(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lu(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?vh(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Di,xh=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Di=Di||document.createElement("div"),Di.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Di.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Xo(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Mo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},vg=["Webkit","ms","Moz","O"];Object.keys(Mo).forEach(function(t){vg.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Mo[e]=Mo[t]})});function bh(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Mo.hasOwnProperty(t)&&Mo[t]?(""+e).trim():e+"px"}function wh(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=bh(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var xg=kt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function uu(t,e){if(e){if(xg[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(G(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(G(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(G(61))}if(e.style!=null&&typeof e.style!="object")throw Error(G(62))}}function cu(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var du=null;function gc(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var fu=null,to=null,no=null;function md(t){if(t=xi(t)){if(typeof fu!="function")throw Error(G(280));var e=t.stateNode;e&&(e=Va(e),fu(t.stateNode,t.type,e))}}function Sh(t){to?no?no.push(t):no=[t]:to=t}function _h(){if(to){var t=to,e=no;if(no=to=null,md(t),e)for(t=0;t<e.length;t++)md(e[t])}}function kh(t,e){return t(e)}function Eh(){}var ml=!1;function jh(t,e,n){if(ml)return t(e,n);ml=!0;try{return kh(t,e,n)}finally{ml=!1,(to!==null||no!==null)&&(Eh(),_h())}}function Zo(t,e){var n=t.stateNode;if(n===null)return null;var r=Va(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(G(231,e,typeof n));return n}var hu=!1;if(_r)try{var _o={};Object.defineProperty(_o,"passive",{get:function(){hu=!0}}),window.addEventListener("test",_o,_o),window.removeEventListener("test",_o,_o)}catch{hu=!1}function bg(t,e,n,r,s,o,i,l,u){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(d){this.onError(d)}}var Bo=!1,fa=null,ha=!1,pu=null,wg={onError:function(t){Bo=!0,fa=t}};function Sg(t,e,n,r,s,o,i,l,u){Bo=!1,fa=null,bg.apply(wg,arguments)}function _g(t,e,n,r,s,o,i,l,u){if(Sg.apply(this,arguments),Bo){if(Bo){var c=fa;Bo=!1,fa=null}else throw Error(G(198));ha||(ha=!0,pu=c)}}function Ns(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Ch(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function gd(t){if(Ns(t)!==t)throw Error(G(188))}function kg(t){var e=t.alternate;if(!e){if(e=Ns(t),e===null)throw Error(G(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var o=s.alternate;if(o===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return gd(s),t;if(o===r)return gd(s),e;o=o.sibling}throw Error(G(188))}if(n.return!==r.return)n=s,r=o;else{for(var i=!1,l=s.child;l;){if(l===n){i=!0,n=s,r=o;break}if(l===r){i=!0,r=s,n=o;break}l=l.sibling}if(!i){for(l=o.child;l;){if(l===n){i=!0,n=o,r=s;break}if(l===r){i=!0,r=o,n=s;break}l=l.sibling}if(!i)throw Error(G(189))}}if(n.alternate!==r)throw Error(G(190))}if(n.tag!==3)throw Error(G(188));return n.stateNode.current===n?t:e}function Rh(t){return t=kg(t),t!==null?Nh(t):null}function Nh(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Nh(t);if(e!==null)return e;t=t.sibling}return null}var Dh=On.unstable_scheduleCallback,yd=On.unstable_cancelCallback,Eg=On.unstable_shouldYield,jg=On.unstable_requestPaint,Nt=On.unstable_now,Cg=On.unstable_getCurrentPriorityLevel,yc=On.unstable_ImmediatePriority,Ah=On.unstable_UserBlockingPriority,pa=On.unstable_NormalPriority,Rg=On.unstable_LowPriority,Oh=On.unstable_IdlePriority,Ua=null,hr=null;function Ng(t){if(hr&&typeof hr.onCommitFiberRoot=="function")try{hr.onCommitFiberRoot(Ua,t,void 0,(t.current.flags&128)===128)}catch{}}var Qn=Math.clz32?Math.clz32:Og,Dg=Math.log,Ag=Math.LN2;function Og(t){return t>>>=0,t===0?32:31-(Dg(t)/Ag|0)|0}var Ai=64,Oi=4194304;function Po(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ma(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,o=t.pingedLanes,i=n&268435455;if(i!==0){var l=i&~s;l!==0?r=Po(l):(o&=i,o!==0&&(r=Po(o)))}else i=n&~s,i!==0?r=Po(i):o!==0&&(r=Po(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,o=e&-e,s>=o||s===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Qn(e),s=1<<n,r|=t[n],e&=~s;return r}function Tg(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Pg(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,o=t.pendingLanes;0<o;){var i=31-Qn(o),l=1<<i,u=s[i];u===-1?(!(l&n)||l&r)&&(s[i]=Tg(l,e)):u<=e&&(t.expiredLanes|=l),o&=~l}}function mu(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Th(){var t=Ai;return Ai<<=1,!(Ai&4194240)&&(Ai=64),t}function gl(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function yi(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Qn(e),t[e]=n}function Lg(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Qn(n),o=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~o}}function vc(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Qn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var rt=0;function Ph(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Lh,xc,Ih,$h,Mh,gu=!1,Ti=[],Fr=null,zr=null,Wr=null,ei=new Map,ti=new Map,Ir=[],Ig="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function vd(t,e){switch(t){case"focusin":case"focusout":Fr=null;break;case"dragenter":case"dragleave":zr=null;break;case"mouseover":case"mouseout":Wr=null;break;case"pointerover":case"pointerout":ei.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ti.delete(e.pointerId)}}function ko(t,e,n,r,s,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[s]},e!==null&&(e=xi(e),e!==null&&xc(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function $g(t,e,n,r,s){switch(e){case"focusin":return Fr=ko(Fr,t,e,n,r,s),!0;case"dragenter":return zr=ko(zr,t,e,n,r,s),!0;case"mouseover":return Wr=ko(Wr,t,e,n,r,s),!0;case"pointerover":var o=s.pointerId;return ei.set(o,ko(ei.get(o)||null,t,e,n,r,s)),!0;case"gotpointercapture":return o=s.pointerId,ti.set(o,ko(ti.get(o)||null,t,e,n,r,s)),!0}return!1}function Bh(t){var e=gs(t.target);if(e!==null){var n=Ns(e);if(n!==null){if(e=n.tag,e===13){if(e=Ch(n),e!==null){t.blockedOn=e,Mh(t.priority,function(){Ih(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function ta(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=yu(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);du=r,n.target.dispatchEvent(r),du=null}else return e=xi(n),e!==null&&xc(e),t.blockedOn=n,!1;e.shift()}return!0}function xd(t,e,n){ta(t)&&n.delete(e)}function Mg(){gu=!1,Fr!==null&&ta(Fr)&&(Fr=null),zr!==null&&ta(zr)&&(zr=null),Wr!==null&&ta(Wr)&&(Wr=null),ei.forEach(xd),ti.forEach(xd)}function Eo(t,e){t.blockedOn===e&&(t.blockedOn=null,gu||(gu=!0,On.unstable_scheduleCallback(On.unstable_NormalPriority,Mg)))}function ni(t){function e(s){return Eo(s,t)}if(0<Ti.length){Eo(Ti[0],t);for(var n=1;n<Ti.length;n++){var r=Ti[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Fr!==null&&Eo(Fr,t),zr!==null&&Eo(zr,t),Wr!==null&&Eo(Wr,t),ei.forEach(e),ti.forEach(e),n=0;n<Ir.length;n++)r=Ir[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ir.length&&(n=Ir[0],n.blockedOn===null);)Bh(n),n.blockedOn===null&&Ir.shift()}var ro=Rr.ReactCurrentBatchConfig,ga=!0;function Bg(t,e,n,r){var s=rt,o=ro.transition;ro.transition=null;try{rt=1,bc(t,e,n,r)}finally{rt=s,ro.transition=o}}function Ug(t,e,n,r){var s=rt,o=ro.transition;ro.transition=null;try{rt=4,bc(t,e,n,r)}finally{rt=s,ro.transition=o}}function bc(t,e,n,r){if(ga){var s=yu(t,e,n,r);if(s===null)jl(t,e,r,ya,n),vd(t,r);else if($g(s,t,e,n,r))r.stopPropagation();else if(vd(t,r),e&4&&-1<Ig.indexOf(t)){for(;s!==null;){var o=xi(s);if(o!==null&&Lh(o),o=yu(t,e,n,r),o===null&&jl(t,e,r,ya,n),o===s)break;s=o}s!==null&&r.stopPropagation()}else jl(t,e,r,null,n)}}var ya=null;function yu(t,e,n,r){if(ya=null,t=gc(r),t=gs(t),t!==null)if(e=Ns(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Ch(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ya=t,null}function Uh(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Cg()){case yc:return 1;case Ah:return 4;case pa:case Rg:return 16;case Oh:return 536870912;default:return 16}default:return 16}}var Br=null,wc=null,na=null;function Fh(){if(na)return na;var t,e=wc,n=e.length,r,s="value"in Br?Br.value:Br.textContent,o=s.length;for(t=0;t<n&&e[t]===s[t];t++);var i=n-t;for(r=1;r<=i&&e[n-r]===s[o-r];r++);return na=s.slice(t,1<r?1-r:void 0)}function ra(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Pi(){return!0}function bd(){return!1}function Pn(t){function e(n,r,s,o,i){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Pi:bd,this.isPropagationStopped=bd,this}return kt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Pi)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Pi)},persist:function(){},isPersistent:Pi}),e}var go={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Sc=Pn(go),vi=kt({},go,{view:0,detail:0}),Fg=Pn(vi),yl,vl,jo,Fa=kt({},vi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_c,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==jo&&(jo&&t.type==="mousemove"?(yl=t.screenX-jo.screenX,vl=t.screenY-jo.screenY):vl=yl=0,jo=t),yl)},movementY:function(t){return"movementY"in t?t.movementY:vl}}),wd=Pn(Fa),zg=kt({},Fa,{dataTransfer:0}),Wg=Pn(zg),Vg=kt({},vi,{relatedTarget:0}),xl=Pn(Vg),Gg=kt({},go,{animationName:0,elapsedTime:0,pseudoElement:0}),qg=Pn(Gg),Hg=kt({},go,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Kg=Pn(Hg),Jg=kt({},go,{data:0}),Sd=Pn(Jg),Yg={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Qg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Xg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Zg(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Xg[t])?!!e[t]:!1}function _c(){return Zg}var e0=kt({},vi,{key:function(t){if(t.key){var e=Yg[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ra(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Qg[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_c,charCode:function(t){return t.type==="keypress"?ra(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ra(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),t0=Pn(e0),n0=kt({},Fa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_d=Pn(n0),r0=kt({},vi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_c}),s0=Pn(r0),o0=kt({},go,{propertyName:0,elapsedTime:0,pseudoElement:0}),i0=Pn(o0),a0=kt({},Fa,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),l0=Pn(a0),u0=[9,13,27,32],kc=_r&&"CompositionEvent"in window,Uo=null;_r&&"documentMode"in document&&(Uo=document.documentMode);var c0=_r&&"TextEvent"in window&&!Uo,zh=_r&&(!kc||Uo&&8<Uo&&11>=Uo),kd=" ",Ed=!1;function Wh(t,e){switch(t){case"keyup":return u0.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vh(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Vs=!1;function d0(t,e){switch(t){case"compositionend":return Vh(e);case"keypress":return e.which!==32?null:(Ed=!0,kd);case"textInput":return t=e.data,t===kd&&Ed?null:t;default:return null}}function f0(t,e){if(Vs)return t==="compositionend"||!kc&&Wh(t,e)?(t=Fh(),na=wc=Br=null,Vs=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return zh&&e.locale!=="ko"?null:e.data;default:return null}}var h0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jd(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!h0[t.type]:e==="textarea"}function Gh(t,e,n,r){Sh(r),e=va(e,"onChange"),0<e.length&&(n=new Sc("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Fo=null,ri=null;function p0(t){np(t,0)}function za(t){var e=Hs(t);if(mh(e))return t}function m0(t,e){if(t==="change")return e}var qh=!1;if(_r){var bl;if(_r){var wl="oninput"in document;if(!wl){var Cd=document.createElement("div");Cd.setAttribute("oninput","return;"),wl=typeof Cd.oninput=="function"}bl=wl}else bl=!1;qh=bl&&(!document.documentMode||9<document.documentMode)}function Rd(){Fo&&(Fo.detachEvent("onpropertychange",Hh),ri=Fo=null)}function Hh(t){if(t.propertyName==="value"&&za(ri)){var e=[];Gh(e,ri,t,gc(t)),jh(p0,e)}}function g0(t,e,n){t==="focusin"?(Rd(),Fo=e,ri=n,Fo.attachEvent("onpropertychange",Hh)):t==="focusout"&&Rd()}function y0(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return za(ri)}function v0(t,e){if(t==="click")return za(e)}function x0(t,e){if(t==="input"||t==="change")return za(e)}function b0(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Zn=typeof Object.is=="function"?Object.is:b0;function si(t,e){if(Zn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Zl.call(e,s)||!Zn(t[s],e[s]))return!1}return!0}function Nd(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Dd(t,e){var n=Nd(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Nd(n)}}function Kh(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Kh(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Jh(){for(var t=window,e=da();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=da(t.document)}return e}function Ec(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function w0(t){var e=Jh(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Kh(n.ownerDocument.documentElement,n)){if(r!==null&&Ec(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,o=Math.min(r.start,s);r=r.end===void 0?o:Math.min(r.end,s),!t.extend&&o>r&&(s=r,r=o,o=s),s=Dd(n,o);var i=Dd(n,r);s&&i&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var S0=_r&&"documentMode"in document&&11>=document.documentMode,Gs=null,vu=null,zo=null,xu=!1;function Ad(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;xu||Gs==null||Gs!==da(r)||(r=Gs,"selectionStart"in r&&Ec(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),zo&&si(zo,r)||(zo=r,r=va(vu,"onSelect"),0<r.length&&(e=new Sc("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Gs)))}function Li(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var qs={animationend:Li("Animation","AnimationEnd"),animationiteration:Li("Animation","AnimationIteration"),animationstart:Li("Animation","AnimationStart"),transitionend:Li("Transition","TransitionEnd")},Sl={},Yh={};_r&&(Yh=document.createElement("div").style,"AnimationEvent"in window||(delete qs.animationend.animation,delete qs.animationiteration.animation,delete qs.animationstart.animation),"TransitionEvent"in window||delete qs.transitionend.transition);function Wa(t){if(Sl[t])return Sl[t];if(!qs[t])return t;var e=qs[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Yh)return Sl[t]=e[n];return t}var Qh=Wa("animationend"),Xh=Wa("animationiteration"),Zh=Wa("animationstart"),ep=Wa("transitionend"),tp=new Map,Od="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Qr(t,e){tp.set(t,e),Rs(e,[t])}for(var _l=0;_l<Od.length;_l++){var kl=Od[_l],_0=kl.toLowerCase(),k0=kl[0].toUpperCase()+kl.slice(1);Qr(_0,"on"+k0)}Qr(Qh,"onAnimationEnd");Qr(Xh,"onAnimationIteration");Qr(Zh,"onAnimationStart");Qr("dblclick","onDoubleClick");Qr("focusin","onFocus");Qr("focusout","onBlur");Qr(ep,"onTransitionEnd");io("onMouseEnter",["mouseout","mouseover"]);io("onMouseLeave",["mouseout","mouseover"]);io("onPointerEnter",["pointerout","pointerover"]);io("onPointerLeave",["pointerout","pointerover"]);Rs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Rs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Rs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Rs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Rs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Rs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),E0=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lo));function Td(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,_g(r,e,void 0,t),t.currentTarget=null}function np(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var i=r.length-1;0<=i;i--){var l=r[i],u=l.instance,c=l.currentTarget;if(l=l.listener,u!==o&&s.isPropagationStopped())break e;Td(s,l,c),o=u}else for(i=0;i<r.length;i++){if(l=r[i],u=l.instance,c=l.currentTarget,l=l.listener,u!==o&&s.isPropagationStopped())break e;Td(s,l,c),o=u}}}if(ha)throw t=pu,ha=!1,pu=null,t}function mt(t,e){var n=e[ku];n===void 0&&(n=e[ku]=new Set);var r=t+"__bubble";n.has(r)||(rp(e,t,2,!1),n.add(r))}function El(t,e,n){var r=0;e&&(r|=4),rp(n,t,r,e)}var Ii="_reactListening"+Math.random().toString(36).slice(2);function oi(t){if(!t[Ii]){t[Ii]=!0,ch.forEach(function(n){n!=="selectionchange"&&(E0.has(n)||El(n,!1,t),El(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ii]||(e[Ii]=!0,El("selectionchange",!1,e))}}function rp(t,e,n,r){switch(Uh(e)){case 1:var s=Bg;break;case 4:s=Ug;break;default:s=bc}n=s.bind(null,e,n,t),s=void 0,!hu||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function jl(t,e,n,r,s){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(i===4)for(i=r.return;i!==null;){var u=i.tag;if((u===3||u===4)&&(u=i.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;i=i.return}for(;l!==null;){if(i=gs(l),i===null)return;if(u=i.tag,u===5||u===6){r=o=i;continue e}l=l.parentNode}}r=r.return}jh(function(){var c=o,d=gc(n),h=[];e:{var p=tp.get(t);if(p!==void 0){var g=Sc,b=t;switch(t){case"keypress":if(ra(n)===0)break e;case"keydown":case"keyup":g=t0;break;case"focusin":b="focus",g=xl;break;case"focusout":b="blur",g=xl;break;case"beforeblur":case"afterblur":g=xl;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=wd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=Wg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=s0;break;case Qh:case Xh:case Zh:g=qg;break;case ep:g=i0;break;case"scroll":g=Fg;break;case"wheel":g=l0;break;case"copy":case"cut":case"paste":g=Kg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=_d}var x=(e&4)!==0,S=!x&&t==="scroll",y=x?p!==null?p+"Capture":null:p;x=[];for(var f=c,m;f!==null;){m=f;var w=m.stateNode;if(m.tag===5&&w!==null&&(m=w,y!==null&&(w=Zo(f,y),w!=null&&x.push(ii(f,w,m)))),S)break;f=f.return}0<x.length&&(p=new g(p,b,null,n,d),h.push({event:p,listeners:x}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",p&&n!==du&&(b=n.relatedTarget||n.fromElement)&&(gs(b)||b[kr]))break e;if((g||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,g?(b=n.relatedTarget||n.toElement,g=c,b=b?gs(b):null,b!==null&&(S=Ns(b),b!==S||b.tag!==5&&b.tag!==6)&&(b=null)):(g=null,b=c),g!==b)){if(x=wd,w="onMouseLeave",y="onMouseEnter",f="mouse",(t==="pointerout"||t==="pointerover")&&(x=_d,w="onPointerLeave",y="onPointerEnter",f="pointer"),S=g==null?p:Hs(g),m=b==null?p:Hs(b),p=new x(w,f+"leave",g,n,d),p.target=S,p.relatedTarget=m,w=null,gs(d)===c&&(x=new x(y,f+"enter",b,n,d),x.target=m,x.relatedTarget=S,w=x),S=w,g&&b)t:{for(x=g,y=b,f=0,m=x;m;m=Ts(m))f++;for(m=0,w=y;w;w=Ts(w))m++;for(;0<f-m;)x=Ts(x),f--;for(;0<m-f;)y=Ts(y),m--;for(;f--;){if(x===y||y!==null&&x===y.alternate)break t;x=Ts(x),y=Ts(y)}x=null}else x=null;g!==null&&Pd(h,p,g,x,!1),b!==null&&S!==null&&Pd(h,S,b,x,!0)}}e:{if(p=c?Hs(c):window,g=p.nodeName&&p.nodeName.toLowerCase(),g==="select"||g==="input"&&p.type==="file")var k=m0;else if(jd(p))if(qh)k=x0;else{k=y0;var D=g0}else(g=p.nodeName)&&g.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(k=v0);if(k&&(k=k(t,c))){Gh(h,k,n,d);break e}D&&D(t,p,c),t==="focusout"&&(D=p._wrapperState)&&D.controlled&&p.type==="number"&&iu(p,"number",p.value)}switch(D=c?Hs(c):window,t){case"focusin":(jd(D)||D.contentEditable==="true")&&(Gs=D,vu=c,zo=null);break;case"focusout":zo=vu=Gs=null;break;case"mousedown":xu=!0;break;case"contextmenu":case"mouseup":case"dragend":xu=!1,Ad(h,n,d);break;case"selectionchange":if(S0)break;case"keydown":case"keyup":Ad(h,n,d)}var R;if(kc)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else Vs?Wh(t,n)&&(E="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(zh&&n.locale!=="ko"&&(Vs||E!=="onCompositionStart"?E==="onCompositionEnd"&&Vs&&(R=Fh()):(Br=d,wc="value"in Br?Br.value:Br.textContent,Vs=!0)),D=va(c,E),0<D.length&&(E=new Sd(E,t,null,n,d),h.push({event:E,listeners:D}),R?E.data=R:(R=Vh(n),R!==null&&(E.data=R)))),(R=c0?d0(t,n):f0(t,n))&&(c=va(c,"onBeforeInput"),0<c.length&&(d=new Sd("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:c}),d.data=R))}np(h,e)})}function ii(t,e,n){return{instance:t,listener:e,currentTarget:n}}function va(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=Zo(t,n),o!=null&&r.unshift(ii(t,o,s)),o=Zo(t,e),o!=null&&r.push(ii(t,o,s))),t=t.return}return r}function Ts(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Pd(t,e,n,r,s){for(var o=e._reactName,i=[];n!==null&&n!==r;){var l=n,u=l.alternate,c=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&c!==null&&(l=c,s?(u=Zo(n,o),u!=null&&i.unshift(ii(n,u,l))):s||(u=Zo(n,o),u!=null&&i.push(ii(n,u,l)))),n=n.return}i.length!==0&&t.push({event:e,listeners:i})}var j0=/\r\n?/g,C0=/\u0000|\uFFFD/g;function Ld(t){return(typeof t=="string"?t:""+t).replace(j0,`
`).replace(C0,"")}function $i(t,e,n){if(e=Ld(e),Ld(t)!==e&&n)throw Error(G(425))}function xa(){}var bu=null,wu=null;function Su(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var _u=typeof setTimeout=="function"?setTimeout:void 0,R0=typeof clearTimeout=="function"?clearTimeout:void 0,Id=typeof Promise=="function"?Promise:void 0,N0=typeof queueMicrotask=="function"?queueMicrotask:typeof Id<"u"?function(t){return Id.resolve(null).then(t).catch(D0)}:_u;function D0(t){setTimeout(function(){throw t})}function Cl(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),ni(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);ni(e)}function Vr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function $d(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var yo=Math.random().toString(36).slice(2),dr="__reactFiber$"+yo,ai="__reactProps$"+yo,kr="__reactContainer$"+yo,ku="__reactEvents$"+yo,A0="__reactListeners$"+yo,O0="__reactHandles$"+yo;function gs(t){var e=t[dr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[kr]||n[dr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=$d(t);t!==null;){if(n=t[dr])return n;t=$d(t)}return e}t=n,n=t.parentNode}return null}function xi(t){return t=t[dr]||t[kr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Hs(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(G(33))}function Va(t){return t[ai]||null}var Eu=[],Ks=-1;function Xr(t){return{current:t}}function gt(t){0>Ks||(t.current=Eu[Ks],Eu[Ks]=null,Ks--)}function ft(t,e){Ks++,Eu[Ks]=t.current,t.current=e}var Yr={},nn=Xr(Yr),_n=Xr(!1),Ss=Yr;function ao(t,e){var n=t.type.contextTypes;if(!n)return Yr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in n)s[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function kn(t){return t=t.childContextTypes,t!=null}function ba(){gt(_n),gt(nn)}function Md(t,e,n){if(nn.current!==Yr)throw Error(G(168));ft(nn,e),ft(_n,n)}function sp(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(G(108,gg(t)||"Unknown",s));return kt({},n,r)}function wa(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Yr,Ss=nn.current,ft(nn,t),ft(_n,_n.current),!0}function Bd(t,e,n){var r=t.stateNode;if(!r)throw Error(G(169));n?(t=sp(t,e,Ss),r.__reactInternalMemoizedMergedChildContext=t,gt(_n),gt(nn),ft(nn,t)):gt(_n),ft(_n,n)}var vr=null,Ga=!1,Rl=!1;function op(t){vr===null?vr=[t]:vr.push(t)}function T0(t){Ga=!0,op(t)}function Zr(){if(!Rl&&vr!==null){Rl=!0;var t=0,e=rt;try{var n=vr;for(rt=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}vr=null,Ga=!1}catch(s){throw vr!==null&&(vr=vr.slice(t+1)),Dh(yc,Zr),s}finally{rt=e,Rl=!1}}return null}var Js=[],Ys=0,Sa=null,_a=0,Ln=[],In=0,_s=null,xr=1,br="";function fs(t,e){Js[Ys++]=_a,Js[Ys++]=Sa,Sa=t,_a=e}function ip(t,e,n){Ln[In++]=xr,Ln[In++]=br,Ln[In++]=_s,_s=t;var r=xr;t=br;var s=32-Qn(r)-1;r&=~(1<<s),n+=1;var o=32-Qn(e)+s;if(30<o){var i=s-s%5;o=(r&(1<<i)-1).toString(32),r>>=i,s-=i,xr=1<<32-Qn(e)+s|n<<s|r,br=o+t}else xr=1<<o|n<<s|r,br=t}function jc(t){t.return!==null&&(fs(t,1),ip(t,1,0))}function Cc(t){for(;t===Sa;)Sa=Js[--Ys],Js[Ys]=null,_a=Js[--Ys],Js[Ys]=null;for(;t===_s;)_s=Ln[--In],Ln[In]=null,br=Ln[--In],Ln[In]=null,xr=Ln[--In],Ln[In]=null}var Dn=null,Nn=null,vt=!1,Jn=null;function ap(t,e){var n=$n(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Ud(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Dn=t,Nn=Vr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Dn=t,Nn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=_s!==null?{id:xr,overflow:br}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=$n(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Dn=t,Nn=null,!0):!1;default:return!1}}function ju(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Cu(t){if(vt){var e=Nn;if(e){var n=e;if(!Ud(t,e)){if(ju(t))throw Error(G(418));e=Vr(n.nextSibling);var r=Dn;e&&Ud(t,e)?ap(r,n):(t.flags=t.flags&-4097|2,vt=!1,Dn=t)}}else{if(ju(t))throw Error(G(418));t.flags=t.flags&-4097|2,vt=!1,Dn=t}}}function Fd(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Dn=t}function Mi(t){if(t!==Dn)return!1;if(!vt)return Fd(t),vt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Su(t.type,t.memoizedProps)),e&&(e=Nn)){if(ju(t))throw lp(),Error(G(418));for(;e;)ap(t,e),e=Vr(e.nextSibling)}if(Fd(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(G(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Nn=Vr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Nn=null}}else Nn=Dn?Vr(t.stateNode.nextSibling):null;return!0}function lp(){for(var t=Nn;t;)t=Vr(t.nextSibling)}function lo(){Nn=Dn=null,vt=!1}function Rc(t){Jn===null?Jn=[t]:Jn.push(t)}var P0=Rr.ReactCurrentBatchConfig;function Co(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(G(309));var r=n.stateNode}if(!r)throw Error(G(147,t));var s=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(i){var l=s.refs;i===null?delete l[o]:l[o]=i},e._stringRef=o,e)}if(typeof t!="string")throw Error(G(284));if(!n._owner)throw Error(G(290,t))}return t}function Bi(t,e){throw t=Object.prototype.toString.call(e),Error(G(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function zd(t){var e=t._init;return e(t._payload)}function up(t){function e(y,f){if(t){var m=y.deletions;m===null?(y.deletions=[f],y.flags|=16):m.push(f)}}function n(y,f){if(!t)return null;for(;f!==null;)e(y,f),f=f.sibling;return null}function r(y,f){for(y=new Map;f!==null;)f.key!==null?y.set(f.key,f):y.set(f.index,f),f=f.sibling;return y}function s(y,f){return y=Kr(y,f),y.index=0,y.sibling=null,y}function o(y,f,m){return y.index=m,t?(m=y.alternate,m!==null?(m=m.index,m<f?(y.flags|=2,f):m):(y.flags|=2,f)):(y.flags|=1048576,f)}function i(y){return t&&y.alternate===null&&(y.flags|=2),y}function l(y,f,m,w){return f===null||f.tag!==6?(f=Ll(m,y.mode,w),f.return=y,f):(f=s(f,m),f.return=y,f)}function u(y,f,m,w){var k=m.type;return k===Ws?d(y,f,m.props.children,w,m.key):f!==null&&(f.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Pr&&zd(k)===f.type)?(w=s(f,m.props),w.ref=Co(y,f,m),w.return=y,w):(w=ca(m.type,m.key,m.props,null,y.mode,w),w.ref=Co(y,f,m),w.return=y,w)}function c(y,f,m,w){return f===null||f.tag!==4||f.stateNode.containerInfo!==m.containerInfo||f.stateNode.implementation!==m.implementation?(f=Il(m,y.mode,w),f.return=y,f):(f=s(f,m.children||[]),f.return=y,f)}function d(y,f,m,w,k){return f===null||f.tag!==7?(f=ws(m,y.mode,w,k),f.return=y,f):(f=s(f,m),f.return=y,f)}function h(y,f,m){if(typeof f=="string"&&f!==""||typeof f=="number")return f=Ll(""+f,y.mode,m),f.return=y,f;if(typeof f=="object"&&f!==null){switch(f.$$typeof){case Ri:return m=ca(f.type,f.key,f.props,null,y.mode,m),m.ref=Co(y,null,f),m.return=y,m;case zs:return f=Il(f,y.mode,m),f.return=y,f;case Pr:var w=f._init;return h(y,w(f._payload),m)}if(To(f)||So(f))return f=ws(f,y.mode,m,null),f.return=y,f;Bi(y,f)}return null}function p(y,f,m,w){var k=f!==null?f.key:null;if(typeof m=="string"&&m!==""||typeof m=="number")return k!==null?null:l(y,f,""+m,w);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Ri:return m.key===k?u(y,f,m,w):null;case zs:return m.key===k?c(y,f,m,w):null;case Pr:return k=m._init,p(y,f,k(m._payload),w)}if(To(m)||So(m))return k!==null?null:d(y,f,m,w,null);Bi(y,m)}return null}function g(y,f,m,w,k){if(typeof w=="string"&&w!==""||typeof w=="number")return y=y.get(m)||null,l(f,y,""+w,k);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ri:return y=y.get(w.key===null?m:w.key)||null,u(f,y,w,k);case zs:return y=y.get(w.key===null?m:w.key)||null,c(f,y,w,k);case Pr:var D=w._init;return g(y,f,m,D(w._payload),k)}if(To(w)||So(w))return y=y.get(m)||null,d(f,y,w,k,null);Bi(f,w)}return null}function b(y,f,m,w){for(var k=null,D=null,R=f,E=f=0,N=null;R!==null&&E<m.length;E++){R.index>E?(N=R,R=null):N=R.sibling;var v=p(y,R,m[E],w);if(v===null){R===null&&(R=N);break}t&&R&&v.alternate===null&&e(y,R),f=o(v,f,E),D===null?k=v:D.sibling=v,D=v,R=N}if(E===m.length)return n(y,R),vt&&fs(y,E),k;if(R===null){for(;E<m.length;E++)R=h(y,m[E],w),R!==null&&(f=o(R,f,E),D===null?k=R:D.sibling=R,D=R);return vt&&fs(y,E),k}for(R=r(y,R);E<m.length;E++)N=g(R,y,E,m[E],w),N!==null&&(t&&N.alternate!==null&&R.delete(N.key===null?E:N.key),f=o(N,f,E),D===null?k=N:D.sibling=N,D=N);return t&&R.forEach(function(C){return e(y,C)}),vt&&fs(y,E),k}function x(y,f,m,w){var k=So(m);if(typeof k!="function")throw Error(G(150));if(m=k.call(m),m==null)throw Error(G(151));for(var D=k=null,R=f,E=f=0,N=null,v=m.next();R!==null&&!v.done;E++,v=m.next()){R.index>E?(N=R,R=null):N=R.sibling;var C=p(y,R,v.value,w);if(C===null){R===null&&(R=N);break}t&&R&&C.alternate===null&&e(y,R),f=o(C,f,E),D===null?k=C:D.sibling=C,D=C,R=N}if(v.done)return n(y,R),vt&&fs(y,E),k;if(R===null){for(;!v.done;E++,v=m.next())v=h(y,v.value,w),v!==null&&(f=o(v,f,E),D===null?k=v:D.sibling=v,D=v);return vt&&fs(y,E),k}for(R=r(y,R);!v.done;E++,v=m.next())v=g(R,y,E,v.value,w),v!==null&&(t&&v.alternate!==null&&R.delete(v.key===null?E:v.key),f=o(v,f,E),D===null?k=v:D.sibling=v,D=v);return t&&R.forEach(function(P){return e(y,P)}),vt&&fs(y,E),k}function S(y,f,m,w){if(typeof m=="object"&&m!==null&&m.type===Ws&&m.key===null&&(m=m.props.children),typeof m=="object"&&m!==null){switch(m.$$typeof){case Ri:e:{for(var k=m.key,D=f;D!==null;){if(D.key===k){if(k=m.type,k===Ws){if(D.tag===7){n(y,D.sibling),f=s(D,m.props.children),f.return=y,y=f;break e}}else if(D.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Pr&&zd(k)===D.type){n(y,D.sibling),f=s(D,m.props),f.ref=Co(y,D,m),f.return=y,y=f;break e}n(y,D);break}else e(y,D);D=D.sibling}m.type===Ws?(f=ws(m.props.children,y.mode,w,m.key),f.return=y,y=f):(w=ca(m.type,m.key,m.props,null,y.mode,w),w.ref=Co(y,f,m),w.return=y,y=w)}return i(y);case zs:e:{for(D=m.key;f!==null;){if(f.key===D)if(f.tag===4&&f.stateNode.containerInfo===m.containerInfo&&f.stateNode.implementation===m.implementation){n(y,f.sibling),f=s(f,m.children||[]),f.return=y,y=f;break e}else{n(y,f);break}else e(y,f);f=f.sibling}f=Il(m,y.mode,w),f.return=y,y=f}return i(y);case Pr:return D=m._init,S(y,f,D(m._payload),w)}if(To(m))return b(y,f,m,w);if(So(m))return x(y,f,m,w);Bi(y,m)}return typeof m=="string"&&m!==""||typeof m=="number"?(m=""+m,f!==null&&f.tag===6?(n(y,f.sibling),f=s(f,m),f.return=y,y=f):(n(y,f),f=Ll(m,y.mode,w),f.return=y,y=f),i(y)):n(y,f)}return S}var uo=up(!0),cp=up(!1),ka=Xr(null),Ea=null,Qs=null,Nc=null;function Dc(){Nc=Qs=Ea=null}function Ac(t){var e=ka.current;gt(ka),t._currentValue=e}function Ru(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function so(t,e){Ea=t,Nc=Qs=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Sn=!0),t.firstContext=null)}function Un(t){var e=t._currentValue;if(Nc!==t)if(t={context:t,memoizedValue:e,next:null},Qs===null){if(Ea===null)throw Error(G(308));Qs=t,Ea.dependencies={lanes:0,firstContext:t}}else Qs=Qs.next=t;return e}var ys=null;function Oc(t){ys===null?ys=[t]:ys.push(t)}function dp(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Oc(e)):(n.next=s.next,s.next=n),e.interleaved=n,Er(t,r)}function Er(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Lr=!1;function Tc(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function fp(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Sr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Gr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ve&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Er(t,n)}return s=r.interleaved,s===null?(e.next=e,Oc(r)):(e.next=s.next,s.next=e),r.interleaved=e,Er(t,n)}function sa(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,vc(t,n)}}function Wd(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?s=o=i:o=o.next=i,n=n.next}while(n!==null);o===null?s=o=e:o=o.next=e}else s=o=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function ja(t,e,n,r){var s=t.updateQueue;Lr=!1;var o=s.firstBaseUpdate,i=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,c=u.next;u.next=null,i===null?o=c:i.next=c,i=u;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==i&&(l===null?d.firstBaseUpdate=c:l.next=c,d.lastBaseUpdate=u))}if(o!==null){var h=s.baseState;i=0,d=c=u=null,l=o;do{var p=l.lane,g=l.eventTime;if((r&p)===p){d!==null&&(d=d.next={eventTime:g,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var b=t,x=l;switch(p=e,g=n,x.tag){case 1:if(b=x.payload,typeof b=="function"){h=b.call(g,h,p);break e}h=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=x.payload,p=typeof b=="function"?b.call(g,h,p):b,p==null)break e;h=kt({},h,p);break e;case 2:Lr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,p=s.effects,p===null?s.effects=[l]:p.push(l))}else g={eventTime:g,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(c=d=g,u=h):d=d.next=g,i|=p;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;p=l,l=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(d===null&&(u=h),s.baseState=u,s.firstBaseUpdate=c,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do i|=s.lane,s=s.next;while(s!==e)}else o===null&&(s.shared.lanes=0);Es|=i,t.lanes=i,t.memoizedState=h}}function Vd(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(G(191,s));s.call(r)}}}var bi={},pr=Xr(bi),li=Xr(bi),ui=Xr(bi);function vs(t){if(t===bi)throw Error(G(174));return t}function Pc(t,e){switch(ft(ui,e),ft(li,t),ft(pr,bi),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:lu(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=lu(e,t)}gt(pr),ft(pr,e)}function co(){gt(pr),gt(li),gt(ui)}function hp(t){vs(ui.current);var e=vs(pr.current),n=lu(e,t.type);e!==n&&(ft(li,t),ft(pr,n))}function Lc(t){li.current===t&&(gt(pr),gt(li))}var St=Xr(0);function Ca(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Nl=[];function Ic(){for(var t=0;t<Nl.length;t++)Nl[t]._workInProgressVersionPrimary=null;Nl.length=0}var oa=Rr.ReactCurrentDispatcher,Dl=Rr.ReactCurrentBatchConfig,ks=0,_t=null,Ft=null,Kt=null,Ra=!1,Wo=!1,ci=0,L0=0;function Zt(){throw Error(G(321))}function $c(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Zn(t[n],e[n]))return!1;return!0}function Mc(t,e,n,r,s,o){if(ks=o,_t=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,oa.current=t===null||t.memoizedState===null?B0:U0,t=n(r,s),Wo){o=0;do{if(Wo=!1,ci=0,25<=o)throw Error(G(301));o+=1,Kt=Ft=null,e.updateQueue=null,oa.current=F0,t=n(r,s)}while(Wo)}if(oa.current=Na,e=Ft!==null&&Ft.next!==null,ks=0,Kt=Ft=_t=null,Ra=!1,e)throw Error(G(300));return t}function Bc(){var t=ci!==0;return ci=0,t}function ar(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kt===null?_t.memoizedState=Kt=t:Kt=Kt.next=t,Kt}function Fn(){if(Ft===null){var t=_t.alternate;t=t!==null?t.memoizedState:null}else t=Ft.next;var e=Kt===null?_t.memoizedState:Kt.next;if(e!==null)Kt=e,Ft=t;else{if(t===null)throw Error(G(310));Ft=t,t={memoizedState:Ft.memoizedState,baseState:Ft.baseState,baseQueue:Ft.baseQueue,queue:Ft.queue,next:null},Kt===null?_t.memoizedState=Kt=t:Kt=Kt.next=t}return Kt}function di(t,e){return typeof e=="function"?e(t):e}function Al(t){var e=Fn(),n=e.queue;if(n===null)throw Error(G(311));n.lastRenderedReducer=t;var r=Ft,s=r.baseQueue,o=n.pending;if(o!==null){if(s!==null){var i=s.next;s.next=o.next,o.next=i}r.baseQueue=s=o,n.pending=null}if(s!==null){o=s.next,r=r.baseState;var l=i=null,u=null,c=o;do{var d=c.lane;if((ks&d)===d)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(l=u=h,i=r):u=u.next=h,_t.lanes|=d,Es|=d}c=c.next}while(c!==null&&c!==o);u===null?i=r:u.next=l,Zn(r,e.memoizedState)||(Sn=!0),e.memoizedState=r,e.baseState=i,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do o=s.lane,_t.lanes|=o,Es|=o,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Ol(t){var e=Fn(),n=e.queue;if(n===null)throw Error(G(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,o=e.memoizedState;if(s!==null){n.pending=null;var i=s=s.next;do o=t(o,i.action),i=i.next;while(i!==s);Zn(o,e.memoizedState)||(Sn=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function pp(){}function mp(t,e){var n=_t,r=Fn(),s=e(),o=!Zn(r.memoizedState,s);if(o&&(r.memoizedState=s,Sn=!0),r=r.queue,Uc(vp.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||Kt!==null&&Kt.memoizedState.tag&1){if(n.flags|=2048,fi(9,yp.bind(null,n,r,s,e),void 0,null),Jt===null)throw Error(G(349));ks&30||gp(n,e,s)}return s}function gp(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=_t.updateQueue,e===null?(e={lastEffect:null,stores:null},_t.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function yp(t,e,n,r){e.value=n,e.getSnapshot=r,xp(e)&&bp(t)}function vp(t,e,n){return n(function(){xp(e)&&bp(t)})}function xp(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Zn(t,n)}catch{return!0}}function bp(t){var e=Er(t,1);e!==null&&Xn(e,t,1,-1)}function Gd(t){var e=ar();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:di,lastRenderedState:t},e.queue=t,t=t.dispatch=M0.bind(null,_t,t),[e.memoizedState,t]}function fi(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=_t.updateQueue,e===null?(e={lastEffect:null,stores:null},_t.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function wp(){return Fn().memoizedState}function ia(t,e,n,r){var s=ar();_t.flags|=t,s.memoizedState=fi(1|e,n,void 0,r===void 0?null:r)}function qa(t,e,n,r){var s=Fn();r=r===void 0?null:r;var o=void 0;if(Ft!==null){var i=Ft.memoizedState;if(o=i.destroy,r!==null&&$c(r,i.deps)){s.memoizedState=fi(e,n,o,r);return}}_t.flags|=t,s.memoizedState=fi(1|e,n,o,r)}function qd(t,e){return ia(8390656,8,t,e)}function Uc(t,e){return qa(2048,8,t,e)}function Sp(t,e){return qa(4,2,t,e)}function _p(t,e){return qa(4,4,t,e)}function kp(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Ep(t,e,n){return n=n!=null?n.concat([t]):null,qa(4,4,kp.bind(null,e,t),n)}function Fc(){}function jp(t,e){var n=Fn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&$c(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Cp(t,e){var n=Fn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&$c(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Rp(t,e,n){return ks&21?(Zn(n,e)||(n=Th(),_t.lanes|=n,Es|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Sn=!0),t.memoizedState=n)}function I0(t,e){var n=rt;rt=n!==0&&4>n?n:4,t(!0);var r=Dl.transition;Dl.transition={};try{t(!1),e()}finally{rt=n,Dl.transition=r}}function Np(){return Fn().memoizedState}function $0(t,e,n){var r=Hr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Dp(t))Ap(e,n);else if(n=dp(t,e,n,r),n!==null){var s=fn();Xn(n,t,r,s),Op(n,e,r)}}function M0(t,e,n){var r=Hr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Dp(t))Ap(e,s);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var i=e.lastRenderedState,l=o(i,n);if(s.hasEagerState=!0,s.eagerState=l,Zn(l,i)){var u=e.interleaved;u===null?(s.next=s,Oc(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=dp(t,e,s,r),n!==null&&(s=fn(),Xn(n,t,r,s),Op(n,e,r))}}function Dp(t){var e=t.alternate;return t===_t||e!==null&&e===_t}function Ap(t,e){Wo=Ra=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Op(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,vc(t,n)}}var Na={readContext:Un,useCallback:Zt,useContext:Zt,useEffect:Zt,useImperativeHandle:Zt,useInsertionEffect:Zt,useLayoutEffect:Zt,useMemo:Zt,useReducer:Zt,useRef:Zt,useState:Zt,useDebugValue:Zt,useDeferredValue:Zt,useTransition:Zt,useMutableSource:Zt,useSyncExternalStore:Zt,useId:Zt,unstable_isNewReconciler:!1},B0={readContext:Un,useCallback:function(t,e){return ar().memoizedState=[t,e===void 0?null:e],t},useContext:Un,useEffect:qd,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ia(4194308,4,kp.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ia(4194308,4,t,e)},useInsertionEffect:function(t,e){return ia(4,2,t,e)},useMemo:function(t,e){var n=ar();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=ar();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=$0.bind(null,_t,t),[r.memoizedState,t]},useRef:function(t){var e=ar();return t={current:t},e.memoizedState=t},useState:Gd,useDebugValue:Fc,useDeferredValue:function(t){return ar().memoizedState=t},useTransition:function(){var t=Gd(!1),e=t[0];return t=I0.bind(null,t[1]),ar().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=_t,s=ar();if(vt){if(n===void 0)throw Error(G(407));n=n()}else{if(n=e(),Jt===null)throw Error(G(349));ks&30||gp(r,e,n)}s.memoizedState=n;var o={value:n,getSnapshot:e};return s.queue=o,qd(vp.bind(null,r,o,t),[t]),r.flags|=2048,fi(9,yp.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=ar(),e=Jt.identifierPrefix;if(vt){var n=br,r=xr;n=(r&~(1<<32-Qn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=ci++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=L0++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},U0={readContext:Un,useCallback:jp,useContext:Un,useEffect:Uc,useImperativeHandle:Ep,useInsertionEffect:Sp,useLayoutEffect:_p,useMemo:Cp,useReducer:Al,useRef:wp,useState:function(){return Al(di)},useDebugValue:Fc,useDeferredValue:function(t){var e=Fn();return Rp(e,Ft.memoizedState,t)},useTransition:function(){var t=Al(di)[0],e=Fn().memoizedState;return[t,e]},useMutableSource:pp,useSyncExternalStore:mp,useId:Np,unstable_isNewReconciler:!1},F0={readContext:Un,useCallback:jp,useContext:Un,useEffect:Uc,useImperativeHandle:Ep,useInsertionEffect:Sp,useLayoutEffect:_p,useMemo:Cp,useReducer:Ol,useRef:wp,useState:function(){return Ol(di)},useDebugValue:Fc,useDeferredValue:function(t){var e=Fn();return Ft===null?e.memoizedState=t:Rp(e,Ft.memoizedState,t)},useTransition:function(){var t=Ol(di)[0],e=Fn().memoizedState;return[t,e]},useMutableSource:pp,useSyncExternalStore:mp,useId:Np,unstable_isNewReconciler:!1};function qn(t,e){if(t&&t.defaultProps){e=kt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Nu(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:kt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Ha={isMounted:function(t){return(t=t._reactInternals)?Ns(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=fn(),s=Hr(t),o=Sr(r,s);o.payload=e,n!=null&&(o.callback=n),e=Gr(t,o,s),e!==null&&(Xn(e,t,s,r),sa(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=fn(),s=Hr(t),o=Sr(r,s);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=Gr(t,o,s),e!==null&&(Xn(e,t,s,r),sa(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=fn(),r=Hr(t),s=Sr(n,r);s.tag=2,e!=null&&(s.callback=e),e=Gr(t,s,r),e!==null&&(Xn(e,t,r,n),sa(e,t,r))}};function Hd(t,e,n,r,s,o,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,i):e.prototype&&e.prototype.isPureReactComponent?!si(n,r)||!si(s,o):!0}function Tp(t,e,n){var r=!1,s=Yr,o=e.contextType;return typeof o=="object"&&o!==null?o=Un(o):(s=kn(e)?Ss:nn.current,r=e.contextTypes,o=(r=r!=null)?ao(t,s):Yr),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ha,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=o),e}function Kd(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Ha.enqueueReplaceState(e,e.state,null)}function Du(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Tc(t);var o=e.contextType;typeof o=="object"&&o!==null?s.context=Un(o):(o=kn(e)?Ss:nn.current,s.context=ao(t,o)),s.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Nu(t,e,o,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Ha.enqueueReplaceState(s,s.state,null),ja(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function fo(t,e){try{var n="",r=e;do n+=mg(r),r=r.return;while(r);var s=n}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:s,digest:null}}function Tl(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Au(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var z0=typeof WeakMap=="function"?WeakMap:Map;function Pp(t,e,n){n=Sr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Aa||(Aa=!0,Fu=r),Au(t,e)},n}function Lp(t,e,n){n=Sr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Au(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){Au(t,e),typeof r!="function"&&(qr===null?qr=new Set([this]):qr.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),n}function Jd(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new z0;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=ny.bind(null,t,e,n),e.then(t,t))}function Yd(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Qd(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Sr(-1,1),e.tag=2,Gr(n,e,1))),n.lanes|=1),t)}var W0=Rr.ReactCurrentOwner,Sn=!1;function cn(t,e,n,r){e.child=t===null?cp(e,null,n,r):uo(e,t.child,n,r)}function Xd(t,e,n,r,s){n=n.render;var o=e.ref;return so(e,s),r=Mc(t,e,n,r,o,s),n=Bc(),t!==null&&!Sn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,jr(t,e,s)):(vt&&n&&jc(e),e.flags|=1,cn(t,e,r,s),e.child)}function Zd(t,e,n,r,s){if(t===null){var o=n.type;return typeof o=="function"&&!Jc(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,Ip(t,e,o,r,s)):(t=ca(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&s)){var i=o.memoizedProps;if(n=n.compare,n=n!==null?n:si,n(i,r)&&t.ref===e.ref)return jr(t,e,s)}return e.flags|=1,t=Kr(o,r),t.ref=e.ref,t.return=e,e.child=t}function Ip(t,e,n,r,s){if(t!==null){var o=t.memoizedProps;if(si(o,r)&&t.ref===e.ref)if(Sn=!1,e.pendingProps=r=o,(t.lanes&s)!==0)t.flags&131072&&(Sn=!0);else return e.lanes=t.lanes,jr(t,e,s)}return Ou(t,e,n,r,s)}function $p(t,e,n){var r=e.pendingProps,s=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ft(Zs,Rn),Rn|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ft(Zs,Rn),Rn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,ft(Zs,Rn),Rn|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,ft(Zs,Rn),Rn|=r;return cn(t,e,s,n),e.child}function Mp(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Ou(t,e,n,r,s){var o=kn(n)?Ss:nn.current;return o=ao(e,o),so(e,s),n=Mc(t,e,n,r,o,s),r=Bc(),t!==null&&!Sn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,jr(t,e,s)):(vt&&r&&jc(e),e.flags|=1,cn(t,e,n,s),e.child)}function ef(t,e,n,r,s){if(kn(n)){var o=!0;wa(e)}else o=!1;if(so(e,s),e.stateNode===null)aa(t,e),Tp(e,n,r),Du(e,n,r,s),r=!0;else if(t===null){var i=e.stateNode,l=e.memoizedProps;i.props=l;var u=i.context,c=n.contextType;typeof c=="object"&&c!==null?c=Un(c):(c=kn(n)?Ss:nn.current,c=ao(e,c));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";h||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==r||u!==c)&&Kd(e,i,r,c),Lr=!1;var p=e.memoizedState;i.state=p,ja(e,r,i,s),u=e.memoizedState,l!==r||p!==u||_n.current||Lr?(typeof d=="function"&&(Nu(e,n,d,r),u=e.memoizedState),(l=Lr||Hd(e,n,l,r,p,u,c))?(h||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),i.props=r,i.state=u,i.context=c,r=l):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{i=e.stateNode,fp(t,e),l=e.memoizedProps,c=e.type===e.elementType?l:qn(e.type,l),i.props=c,h=e.pendingProps,p=i.context,u=n.contextType,typeof u=="object"&&u!==null?u=Un(u):(u=kn(n)?Ss:nn.current,u=ao(e,u));var g=n.getDerivedStateFromProps;(d=typeof g=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==h||p!==u)&&Kd(e,i,r,u),Lr=!1,p=e.memoizedState,i.state=p,ja(e,r,i,s);var b=e.memoizedState;l!==h||p!==b||_n.current||Lr?(typeof g=="function"&&(Nu(e,n,g,r),b=e.memoizedState),(c=Lr||Hd(e,n,c,r,p,b,u)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,b,u),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,b,u)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=b),i.props=r,i.state=b,i.context=u,r=c):(typeof i.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return Tu(t,e,n,r,o,s)}function Tu(t,e,n,r,s,o){Mp(t,e);var i=(e.flags&128)!==0;if(!r&&!i)return s&&Bd(e,n,!1),jr(t,e,o);r=e.stateNode,W0.current=e;var l=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&i?(e.child=uo(e,t.child,null,o),e.child=uo(e,null,l,o)):cn(t,e,l,o),e.memoizedState=r.state,s&&Bd(e,n,!0),e.child}function Bp(t){var e=t.stateNode;e.pendingContext?Md(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Md(t,e.context,!1),Pc(t,e.containerInfo)}function tf(t,e,n,r,s){return lo(),Rc(s),e.flags|=256,cn(t,e,n,r),e.child}var Pu={dehydrated:null,treeContext:null,retryLane:0};function Lu(t){return{baseLanes:t,cachePool:null,transitions:null}}function Up(t,e,n){var r=e.pendingProps,s=St.current,o=!1,i=(e.flags&128)!==0,l;if((l=i)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),ft(St,s&1),t===null)return Cu(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=r.children,t=r.fallback,o?(r=e.mode,o=e.child,i={mode:"hidden",children:i},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=Ya(i,r,0,null),t=ws(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=Lu(n),e.memoizedState=Pu,t):zc(e,i));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return V0(t,e,i,r,l,s,n);if(o){o=r.fallback,i=e.mode,s=t.child,l=s.sibling;var u={mode:"hidden",children:r.children};return!(i&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Kr(s,u),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?o=Kr(l,o):(o=ws(o,i,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,i=t.child.memoizedState,i=i===null?Lu(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=t.childLanes&~n,e.memoizedState=Pu,r}return o=t.child,t=o.sibling,r=Kr(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function zc(t,e){return e=Ya({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ui(t,e,n,r){return r!==null&&Rc(r),uo(e,t.child,null,n),t=zc(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function V0(t,e,n,r,s,o,i){if(n)return e.flags&256?(e.flags&=-257,r=Tl(Error(G(422))),Ui(t,e,i,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,s=e.mode,r=Ya({mode:"visible",children:r.children},s,0,null),o=ws(o,s,i,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&uo(e,t.child,null,i),e.child.memoizedState=Lu(i),e.memoizedState=Pu,o);if(!(e.mode&1))return Ui(t,e,i,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,o=Error(G(419)),r=Tl(o,r,void 0),Ui(t,e,i,r)}if(l=(i&t.childLanes)!==0,Sn||l){if(r=Jt,r!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|i)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,Er(t,s),Xn(r,t,s,-1))}return Kc(),r=Tl(Error(G(421))),Ui(t,e,i,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=ry.bind(null,t),s._reactRetry=e,null):(t=o.treeContext,Nn=Vr(s.nextSibling),Dn=e,vt=!0,Jn=null,t!==null&&(Ln[In++]=xr,Ln[In++]=br,Ln[In++]=_s,xr=t.id,br=t.overflow,_s=e),e=zc(e,r.children),e.flags|=4096,e)}function nf(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Ru(t.return,e,n)}function Pl(t,e,n,r,s){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=s)}function Fp(t,e,n){var r=e.pendingProps,s=r.revealOrder,o=r.tail;if(cn(t,e,r.children,n),r=St.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&nf(t,n,e);else if(t.tag===19)nf(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ft(St,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Ca(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Pl(e,!1,s,n,o);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Ca(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Pl(e,!0,n,null,o);break;case"together":Pl(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function aa(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function jr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Es|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(G(153));if(e.child!==null){for(t=e.child,n=Kr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Kr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function G0(t,e,n){switch(e.tag){case 3:Bp(e),lo();break;case 5:hp(e);break;case 1:kn(e.type)&&wa(e);break;case 4:Pc(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;ft(ka,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ft(St,St.current&1),e.flags|=128,null):n&e.child.childLanes?Up(t,e,n):(ft(St,St.current&1),t=jr(t,e,n),t!==null?t.sibling:null);ft(St,St.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Fp(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ft(St,St.current),r)break;return null;case 22:case 23:return e.lanes=0,$p(t,e,n)}return jr(t,e,n)}var zp,Iu,Wp,Vp;zp=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Iu=function(){};Wp=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,vs(pr.current);var o=null;switch(n){case"input":s=su(t,s),r=su(t,r),o=[];break;case"select":s=kt({},s,{value:void 0}),r=kt({},r,{value:void 0}),o=[];break;case"textarea":s=au(t,s),r=au(t,r),o=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=xa)}uu(n,r);var i;n=null;for(c in s)if(!r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var l=s[c];for(i in l)l.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Qo.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in r){var u=r[c];if(l=s!=null?s[c]:void 0,r.hasOwnProperty(c)&&u!==l&&(u!=null||l!=null))if(c==="style")if(l){for(i in l)!l.hasOwnProperty(i)||u&&u.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in u)u.hasOwnProperty(i)&&l[i]!==u[i]&&(n||(n={}),n[i]=u[i])}else n||(o||(o=[]),o.push(c,n)),n=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(o=o||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(o=o||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Qo.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&mt("scroll",t),o||l===u||(o=[])):(o=o||[]).push(c,u))}n&&(o=o||[]).push("style",n);var c=o;(e.updateQueue=c)&&(e.flags|=4)}};Vp=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ro(t,e){if(!vt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function en(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function q0(t,e,n){var r=e.pendingProps;switch(Cc(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return en(e),null;case 1:return kn(e.type)&&ba(),en(e),null;case 3:return r=e.stateNode,co(),gt(_n),gt(nn),Ic(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Mi(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Jn!==null&&(Vu(Jn),Jn=null))),Iu(t,e),en(e),null;case 5:Lc(e);var s=vs(ui.current);if(n=e.type,t!==null&&e.stateNode!=null)Wp(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(G(166));return en(e),null}if(t=vs(pr.current),Mi(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[dr]=e,r[ai]=o,t=(e.mode&1)!==0,n){case"dialog":mt("cancel",r),mt("close",r);break;case"iframe":case"object":case"embed":mt("load",r);break;case"video":case"audio":for(s=0;s<Lo.length;s++)mt(Lo[s],r);break;case"source":mt("error",r);break;case"img":case"image":case"link":mt("error",r),mt("load",r);break;case"details":mt("toggle",r);break;case"input":dd(r,o),mt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},mt("invalid",r);break;case"textarea":hd(r,o),mt("invalid",r)}uu(n,o),s=null;for(var i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="children"?typeof l=="string"?r.textContent!==l&&(o.suppressHydrationWarning!==!0&&$i(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&$i(r.textContent,l,t),s=["children",""+l]):Qo.hasOwnProperty(i)&&l!=null&&i==="onScroll"&&mt("scroll",r)}switch(n){case"input":Ni(r),fd(r,o,!0);break;case"textarea":Ni(r),pd(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=xa)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=vh(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=i.createElement(n,{is:r.is}):(t=i.createElement(n),n==="select"&&(i=t,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):t=i.createElementNS(t,n),t[dr]=e,t[ai]=r,zp(t,e,!1,!1),e.stateNode=t;e:{switch(i=cu(n,r),n){case"dialog":mt("cancel",t),mt("close",t),s=r;break;case"iframe":case"object":case"embed":mt("load",t),s=r;break;case"video":case"audio":for(s=0;s<Lo.length;s++)mt(Lo[s],t);s=r;break;case"source":mt("error",t),s=r;break;case"img":case"image":case"link":mt("error",t),mt("load",t),s=r;break;case"details":mt("toggle",t),s=r;break;case"input":dd(t,r),s=su(t,r),mt("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=kt({},r,{value:void 0}),mt("invalid",t);break;case"textarea":hd(t,r),s=au(t,r),mt("invalid",t);break;default:s=r}uu(n,s),l=s;for(o in l)if(l.hasOwnProperty(o)){var u=l[o];o==="style"?wh(t,u):o==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&xh(t,u)):o==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Xo(t,u):typeof u=="number"&&Xo(t,""+u):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Qo.hasOwnProperty(o)?u!=null&&o==="onScroll"&&mt("scroll",t):u!=null&&fc(t,o,u,i))}switch(n){case"input":Ni(t),fd(t,r,!1);break;case"textarea":Ni(t),pd(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Jr(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?eo(t,!!r.multiple,o,!1):r.defaultValue!=null&&eo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=xa)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return en(e),null;case 6:if(t&&e.stateNode!=null)Vp(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(G(166));if(n=vs(ui.current),vs(pr.current),Mi(e)){if(r=e.stateNode,n=e.memoizedProps,r[dr]=e,(o=r.nodeValue!==n)&&(t=Dn,t!==null))switch(t.tag){case 3:$i(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&$i(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[dr]=e,e.stateNode=r}return en(e),null;case 13:if(gt(St),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(vt&&Nn!==null&&e.mode&1&&!(e.flags&128))lp(),lo(),e.flags|=98560,o=!1;else if(o=Mi(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(G(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(G(317));o[dr]=e}else lo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;en(e),o=!1}else Jn!==null&&(Vu(Jn),Jn=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||St.current&1?zt===0&&(zt=3):Kc())),e.updateQueue!==null&&(e.flags|=4),en(e),null);case 4:return co(),Iu(t,e),t===null&&oi(e.stateNode.containerInfo),en(e),null;case 10:return Ac(e.type._context),en(e),null;case 17:return kn(e.type)&&ba(),en(e),null;case 19:if(gt(St),o=e.memoizedState,o===null)return en(e),null;if(r=(e.flags&128)!==0,i=o.rendering,i===null)if(r)Ro(o,!1);else{if(zt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=Ca(t),i!==null){for(e.flags|=128,Ro(o,!1),r=i.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,t=i.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ft(St,St.current&1|2),e.child}t=t.sibling}o.tail!==null&&Nt()>ho&&(e.flags|=128,r=!0,Ro(o,!1),e.lanes=4194304)}else{if(!r)if(t=Ca(i),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ro(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!vt)return en(e),null}else 2*Nt()-o.renderingStartTime>ho&&n!==1073741824&&(e.flags|=128,r=!0,Ro(o,!1),e.lanes=4194304);o.isBackwards?(i.sibling=e.child,e.child=i):(n=o.last,n!==null?n.sibling=i:e.child=i,o.last=i)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Nt(),e.sibling=null,n=St.current,ft(St,r?n&1|2:n&1),e):(en(e),null);case 22:case 23:return Hc(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Rn&1073741824&&(en(e),e.subtreeFlags&6&&(e.flags|=8192)):en(e),null;case 24:return null;case 25:return null}throw Error(G(156,e.tag))}function H0(t,e){switch(Cc(e),e.tag){case 1:return kn(e.type)&&ba(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return co(),gt(_n),gt(nn),Ic(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Lc(e),null;case 13:if(gt(St),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(G(340));lo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return gt(St),null;case 4:return co(),null;case 10:return Ac(e.type._context),null;case 22:case 23:return Hc(),null;case 24:return null;default:return null}}var Fi=!1,tn=!1,K0=typeof WeakSet=="function"?WeakSet:Set,ie=null;function Xs(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ct(t,e,r)}else n.current=null}function $u(t,e,n){try{n()}catch(r){Ct(t,e,r)}}var rf=!1;function J0(t,e){if(bu=ga,t=Jh(),Ec(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var i=0,l=-1,u=-1,c=0,d=0,h=t,p=null;t:for(;;){for(var g;h!==n||s!==0&&h.nodeType!==3||(l=i+s),h!==o||r!==0&&h.nodeType!==3||(u=i+r),h.nodeType===3&&(i+=h.nodeValue.length),(g=h.firstChild)!==null;)p=h,h=g;for(;;){if(h===t)break t;if(p===n&&++c===s&&(l=i),p===o&&++d===r&&(u=i),(g=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=g}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(wu={focusedElem:t,selectionRange:n},ga=!1,ie=e;ie!==null;)if(e=ie,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ie=t;else for(;ie!==null;){e=ie;try{var b=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var x=b.memoizedProps,S=b.memoizedState,y=e.stateNode,f=y.getSnapshotBeforeUpdate(e.elementType===e.type?x:qn(e.type,x),S);y.__reactInternalSnapshotBeforeUpdate=f}break;case 3:var m=e.stateNode.containerInfo;m.nodeType===1?m.textContent="":m.nodeType===9&&m.documentElement&&m.removeChild(m.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(G(163))}}catch(w){Ct(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,ie=t;break}ie=e.return}return b=rf,rf=!1,b}function Vo(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var o=s.destroy;s.destroy=void 0,o!==void 0&&$u(e,n,o)}s=s.next}while(s!==r)}}function Ka(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Mu(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Gp(t){var e=t.alternate;e!==null&&(t.alternate=null,Gp(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[dr],delete e[ai],delete e[ku],delete e[A0],delete e[O0])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function qp(t){return t.tag===5||t.tag===3||t.tag===4}function sf(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||qp(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Bu(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=xa));else if(r!==4&&(t=t.child,t!==null))for(Bu(t,e,n),t=t.sibling;t!==null;)Bu(t,e,n),t=t.sibling}function Uu(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Uu(t,e,n),t=t.sibling;t!==null;)Uu(t,e,n),t=t.sibling}var Yt=null,Hn=!1;function Dr(t,e,n){for(n=n.child;n!==null;)Hp(t,e,n),n=n.sibling}function Hp(t,e,n){if(hr&&typeof hr.onCommitFiberUnmount=="function")try{hr.onCommitFiberUnmount(Ua,n)}catch{}switch(n.tag){case 5:tn||Xs(n,e);case 6:var r=Yt,s=Hn;Yt=null,Dr(t,e,n),Yt=r,Hn=s,Yt!==null&&(Hn?(t=Yt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Yt.removeChild(n.stateNode));break;case 18:Yt!==null&&(Hn?(t=Yt,n=n.stateNode,t.nodeType===8?Cl(t.parentNode,n):t.nodeType===1&&Cl(t,n),ni(t)):Cl(Yt,n.stateNode));break;case 4:r=Yt,s=Hn,Yt=n.stateNode.containerInfo,Hn=!0,Dr(t,e,n),Yt=r,Hn=s;break;case 0:case 11:case 14:case 15:if(!tn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var o=s,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&$u(n,e,i),s=s.next}while(s!==r)}Dr(t,e,n);break;case 1:if(!tn&&(Xs(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Ct(n,e,l)}Dr(t,e,n);break;case 21:Dr(t,e,n);break;case 22:n.mode&1?(tn=(r=tn)||n.memoizedState!==null,Dr(t,e,n),tn=r):Dr(t,e,n);break;default:Dr(t,e,n)}}function of(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new K0),e.forEach(function(r){var s=sy.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Vn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var o=t,i=e,l=i;e:for(;l!==null;){switch(l.tag){case 5:Yt=l.stateNode,Hn=!1;break e;case 3:Yt=l.stateNode.containerInfo,Hn=!0;break e;case 4:Yt=l.stateNode.containerInfo,Hn=!0;break e}l=l.return}if(Yt===null)throw Error(G(160));Hp(o,i,s),Yt=null,Hn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(c){Ct(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Kp(e,t),e=e.sibling}function Kp(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Vn(e,t),or(t),r&4){try{Vo(3,t,t.return),Ka(3,t)}catch(x){Ct(t,t.return,x)}try{Vo(5,t,t.return)}catch(x){Ct(t,t.return,x)}}break;case 1:Vn(e,t),or(t),r&512&&n!==null&&Xs(n,n.return);break;case 5:if(Vn(e,t),or(t),r&512&&n!==null&&Xs(n,n.return),t.flags&32){var s=t.stateNode;try{Xo(s,"")}catch(x){Ct(t,t.return,x)}}if(r&4&&(s=t.stateNode,s!=null)){var o=t.memoizedProps,i=n!==null?n.memoizedProps:o,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&gh(s,o),cu(l,i);var c=cu(l,o);for(i=0;i<u.length;i+=2){var d=u[i],h=u[i+1];d==="style"?wh(s,h):d==="dangerouslySetInnerHTML"?xh(s,h):d==="children"?Xo(s,h):fc(s,d,h,c)}switch(l){case"input":ou(s,o);break;case"textarea":yh(s,o);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var g=o.value;g!=null?eo(s,!!o.multiple,g,!1):p!==!!o.multiple&&(o.defaultValue!=null?eo(s,!!o.multiple,o.defaultValue,!0):eo(s,!!o.multiple,o.multiple?[]:"",!1))}s[ai]=o}catch(x){Ct(t,t.return,x)}}break;case 6:if(Vn(e,t),or(t),r&4){if(t.stateNode===null)throw Error(G(162));s=t.stateNode,o=t.memoizedProps;try{s.nodeValue=o}catch(x){Ct(t,t.return,x)}}break;case 3:if(Vn(e,t),or(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ni(e.containerInfo)}catch(x){Ct(t,t.return,x)}break;case 4:Vn(e,t),or(t);break;case 13:Vn(e,t),or(t),s=t.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(Gc=Nt())),r&4&&of(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(tn=(c=tn)||d,Vn(e,t),tn=c):Vn(e,t),or(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!d&&t.mode&1)for(ie=t,d=t.child;d!==null;){for(h=ie=d;ie!==null;){switch(p=ie,g=p.child,p.tag){case 0:case 11:case 14:case 15:Vo(4,p,p.return);break;case 1:Xs(p,p.return);var b=p.stateNode;if(typeof b.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,b.props=e.memoizedProps,b.state=e.memoizedState,b.componentWillUnmount()}catch(x){Ct(r,n,x)}}break;case 5:Xs(p,p.return);break;case 22:if(p.memoizedState!==null){lf(h);continue}}g!==null?(g.return=p,ie=g):lf(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,c?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=h.stateNode,u=h.memoizedProps.style,i=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=bh("display",i))}catch(x){Ct(t,t.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(x){Ct(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Vn(e,t),or(t),r&4&&of(t);break;case 21:break;default:Vn(e,t),or(t)}}function or(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(qp(n)){var r=n;break e}n=n.return}throw Error(G(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Xo(s,""),r.flags&=-33);var o=sf(t);Uu(t,o,s);break;case 3:case 4:var i=r.stateNode.containerInfo,l=sf(t);Bu(t,l,i);break;default:throw Error(G(161))}}catch(u){Ct(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Y0(t,e,n){ie=t,Jp(t)}function Jp(t,e,n){for(var r=(t.mode&1)!==0;ie!==null;){var s=ie,o=s.child;if(s.tag===22&&r){var i=s.memoizedState!==null||Fi;if(!i){var l=s.alternate,u=l!==null&&l.memoizedState!==null||tn;l=Fi;var c=tn;if(Fi=i,(tn=u)&&!c)for(ie=s;ie!==null;)i=ie,u=i.child,i.tag===22&&i.memoizedState!==null?uf(s):u!==null?(u.return=i,ie=u):uf(s);for(;o!==null;)ie=o,Jp(o),o=o.sibling;ie=s,Fi=l,tn=c}af(t)}else s.subtreeFlags&8772&&o!==null?(o.return=s,ie=o):af(t)}}function af(t){for(;ie!==null;){var e=ie;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:tn||Ka(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!tn)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:qn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&Vd(e,o,r);break;case 3:var i=e.updateQueue;if(i!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Vd(e,i,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&ni(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(G(163))}tn||e.flags&512&&Mu(e)}catch(p){Ct(e,e.return,p)}}if(e===t){ie=null;break}if(n=e.sibling,n!==null){n.return=e.return,ie=n;break}ie=e.return}}function lf(t){for(;ie!==null;){var e=ie;if(e===t){ie=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ie=n;break}ie=e.return}}function uf(t){for(;ie!==null;){var e=ie;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Ka(4,e)}catch(u){Ct(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){Ct(e,s,u)}}var o=e.return;try{Mu(e)}catch(u){Ct(e,o,u)}break;case 5:var i=e.return;try{Mu(e)}catch(u){Ct(e,i,u)}}}catch(u){Ct(e,e.return,u)}if(e===t){ie=null;break}var l=e.sibling;if(l!==null){l.return=e.return,ie=l;break}ie=e.return}}var Q0=Math.ceil,Da=Rr.ReactCurrentDispatcher,Wc=Rr.ReactCurrentOwner,Mn=Rr.ReactCurrentBatchConfig,Ve=0,Jt=null,Lt=null,Qt=0,Rn=0,Zs=Xr(0),zt=0,hi=null,Es=0,Ja=0,Vc=0,Go=null,bn=null,Gc=0,ho=1/0,gr=null,Aa=!1,Fu=null,qr=null,zi=!1,Ur=null,Oa=0,qo=0,zu=null,la=-1,ua=0;function fn(){return Ve&6?Nt():la!==-1?la:la=Nt()}function Hr(t){return t.mode&1?Ve&2&&Qt!==0?Qt&-Qt:P0.transition!==null?(ua===0&&(ua=Th()),ua):(t=rt,t!==0||(t=window.event,t=t===void 0?16:Uh(t.type)),t):1}function Xn(t,e,n,r){if(50<qo)throw qo=0,zu=null,Error(G(185));yi(t,n,r),(!(Ve&2)||t!==Jt)&&(t===Jt&&(!(Ve&2)&&(Ja|=n),zt===4&&$r(t,Qt)),En(t,r),n===1&&Ve===0&&!(e.mode&1)&&(ho=Nt()+500,Ga&&Zr()))}function En(t,e){var n=t.callbackNode;Pg(t,e);var r=ma(t,t===Jt?Qt:0);if(r===0)n!==null&&yd(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&yd(n),e===1)t.tag===0?T0(cf.bind(null,t)):op(cf.bind(null,t)),N0(function(){!(Ve&6)&&Zr()}),n=null;else{switch(Ph(r)){case 1:n=yc;break;case 4:n=Ah;break;case 16:n=pa;break;case 536870912:n=Oh;break;default:n=pa}n=rm(n,Yp.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Yp(t,e){if(la=-1,ua=0,Ve&6)throw Error(G(327));var n=t.callbackNode;if(oo()&&t.callbackNode!==n)return null;var r=ma(t,t===Jt?Qt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Ta(t,r);else{e=r;var s=Ve;Ve|=2;var o=Xp();(Jt!==t||Qt!==e)&&(gr=null,ho=Nt()+500,bs(t,e));do try{ey();break}catch(l){Qp(t,l)}while(!0);Dc(),Da.current=o,Ve=s,Lt!==null?e=0:(Jt=null,Qt=0,e=zt)}if(e!==0){if(e===2&&(s=mu(t),s!==0&&(r=s,e=Wu(t,s))),e===1)throw n=hi,bs(t,0),$r(t,r),En(t,Nt()),n;if(e===6)$r(t,r);else{if(s=t.current.alternate,!(r&30)&&!X0(s)&&(e=Ta(t,r),e===2&&(o=mu(t),o!==0&&(r=o,e=Wu(t,o))),e===1))throw n=hi,bs(t,0),$r(t,r),En(t,Nt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(G(345));case 2:hs(t,bn,gr);break;case 3:if($r(t,r),(r&130023424)===r&&(e=Gc+500-Nt(),10<e)){if(ma(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){fn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=_u(hs.bind(null,t,bn,gr),e);break}hs(t,bn,gr);break;case 4:if($r(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var i=31-Qn(r);o=1<<i,i=e[i],i>s&&(s=i),r&=~o}if(r=s,r=Nt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Q0(r/1960))-r,10<r){t.timeoutHandle=_u(hs.bind(null,t,bn,gr),r);break}hs(t,bn,gr);break;case 5:hs(t,bn,gr);break;default:throw Error(G(329))}}}return En(t,Nt()),t.callbackNode===n?Yp.bind(null,t):null}function Wu(t,e){var n=Go;return t.current.memoizedState.isDehydrated&&(bs(t,e).flags|=256),t=Ta(t,e),t!==2&&(e=bn,bn=n,e!==null&&Vu(e)),t}function Vu(t){bn===null?bn=t:bn.push.apply(bn,t)}function X0(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],o=s.getSnapshot;s=s.value;try{if(!Zn(o(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function $r(t,e){for(e&=~Vc,e&=~Ja,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Qn(e),r=1<<n;t[n]=-1,e&=~r}}function cf(t){if(Ve&6)throw Error(G(327));oo();var e=ma(t,0);if(!(e&1))return En(t,Nt()),null;var n=Ta(t,e);if(t.tag!==0&&n===2){var r=mu(t);r!==0&&(e=r,n=Wu(t,r))}if(n===1)throw n=hi,bs(t,0),$r(t,e),En(t,Nt()),n;if(n===6)throw Error(G(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,hs(t,bn,gr),En(t,Nt()),null}function qc(t,e){var n=Ve;Ve|=1;try{return t(e)}finally{Ve=n,Ve===0&&(ho=Nt()+500,Ga&&Zr())}}function js(t){Ur!==null&&Ur.tag===0&&!(Ve&6)&&oo();var e=Ve;Ve|=1;var n=Mn.transition,r=rt;try{if(Mn.transition=null,rt=1,t)return t()}finally{rt=r,Mn.transition=n,Ve=e,!(Ve&6)&&Zr()}}function Hc(){Rn=Zs.current,gt(Zs)}function bs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,R0(n)),Lt!==null)for(n=Lt.return;n!==null;){var r=n;switch(Cc(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ba();break;case 3:co(),gt(_n),gt(nn),Ic();break;case 5:Lc(r);break;case 4:co();break;case 13:gt(St);break;case 19:gt(St);break;case 10:Ac(r.type._context);break;case 22:case 23:Hc()}n=n.return}if(Jt=t,Lt=t=Kr(t.current,null),Qt=Rn=e,zt=0,hi=null,Vc=Ja=Es=0,bn=Go=null,ys!==null){for(e=0;e<ys.length;e++)if(n=ys[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,o=n.pending;if(o!==null){var i=o.next;o.next=s,r.next=i}n.pending=r}ys=null}return t}function Qp(t,e){do{var n=Lt;try{if(Dc(),oa.current=Na,Ra){for(var r=_t.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Ra=!1}if(ks=0,Kt=Ft=_t=null,Wo=!1,ci=0,Wc.current=null,n===null||n.return===null){zt=1,hi=e,Lt=null;break}e:{var o=t,i=n.return,l=n,u=e;if(e=Qt,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var g=Yd(i);if(g!==null){g.flags&=-257,Qd(g,i,l,o,e),g.mode&1&&Jd(o,c,e),e=g,u=c;var b=e.updateQueue;if(b===null){var x=new Set;x.add(u),e.updateQueue=x}else b.add(u);break e}else{if(!(e&1)){Jd(o,c,e),Kc();break e}u=Error(G(426))}}else if(vt&&l.mode&1){var S=Yd(i);if(S!==null){!(S.flags&65536)&&(S.flags|=256),Qd(S,i,l,o,e),Rc(fo(u,l));break e}}o=u=fo(u,l),zt!==4&&(zt=2),Go===null?Go=[o]:Go.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var y=Pp(o,u,e);Wd(o,y);break e;case 1:l=u;var f=o.type,m=o.stateNode;if(!(o.flags&128)&&(typeof f.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(qr===null||!qr.has(m)))){o.flags|=65536,e&=-e,o.lanes|=e;var w=Lp(o,l,e);Wd(o,w);break e}}o=o.return}while(o!==null)}em(n)}catch(k){e=k,Lt===n&&n!==null&&(Lt=n=n.return);continue}break}while(!0)}function Xp(){var t=Da.current;return Da.current=Na,t===null?Na:t}function Kc(){(zt===0||zt===3||zt===2)&&(zt=4),Jt===null||!(Es&268435455)&&!(Ja&268435455)||$r(Jt,Qt)}function Ta(t,e){var n=Ve;Ve|=2;var r=Xp();(Jt!==t||Qt!==e)&&(gr=null,bs(t,e));do try{Z0();break}catch(s){Qp(t,s)}while(!0);if(Dc(),Ve=n,Da.current=r,Lt!==null)throw Error(G(261));return Jt=null,Qt=0,zt}function Z0(){for(;Lt!==null;)Zp(Lt)}function ey(){for(;Lt!==null&&!Eg();)Zp(Lt)}function Zp(t){var e=nm(t.alternate,t,Rn);t.memoizedProps=t.pendingProps,e===null?em(t):Lt=e,Wc.current=null}function em(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=H0(n,e),n!==null){n.flags&=32767,Lt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{zt=6,Lt=null;return}}else if(n=q0(n,e,Rn),n!==null){Lt=n;return}if(e=e.sibling,e!==null){Lt=e;return}Lt=e=t}while(e!==null);zt===0&&(zt=5)}function hs(t,e,n){var r=rt,s=Mn.transition;try{Mn.transition=null,rt=1,ty(t,e,n,r)}finally{Mn.transition=s,rt=r}return null}function ty(t,e,n,r){do oo();while(Ur!==null);if(Ve&6)throw Error(G(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(G(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(Lg(t,o),t===Jt&&(Lt=Jt=null,Qt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||zi||(zi=!0,rm(pa,function(){return oo(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Mn.transition,Mn.transition=null;var i=rt;rt=1;var l=Ve;Ve|=4,Wc.current=null,J0(t,n),Kp(n,t),w0(wu),ga=!!bu,wu=bu=null,t.current=n,Y0(n),jg(),Ve=l,rt=i,Mn.transition=o}else t.current=n;if(zi&&(zi=!1,Ur=t,Oa=s),o=t.pendingLanes,o===0&&(qr=null),Ng(n.stateNode),En(t,Nt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Aa)throw Aa=!1,t=Fu,Fu=null,t;return Oa&1&&t.tag!==0&&oo(),o=t.pendingLanes,o&1?t===zu?qo++:(qo=0,zu=t):qo=0,Zr(),null}function oo(){if(Ur!==null){var t=Ph(Oa),e=Mn.transition,n=rt;try{if(Mn.transition=null,rt=16>t?16:t,Ur===null)var r=!1;else{if(t=Ur,Ur=null,Oa=0,Ve&6)throw Error(G(331));var s=Ve;for(Ve|=4,ie=t.current;ie!==null;){var o=ie,i=o.child;if(ie.flags&16){var l=o.deletions;if(l!==null){for(var u=0;u<l.length;u++){var c=l[u];for(ie=c;ie!==null;){var d=ie;switch(d.tag){case 0:case 11:case 15:Vo(8,d,o)}var h=d.child;if(h!==null)h.return=d,ie=h;else for(;ie!==null;){d=ie;var p=d.sibling,g=d.return;if(Gp(d),d===c){ie=null;break}if(p!==null){p.return=g,ie=p;break}ie=g}}}var b=o.alternate;if(b!==null){var x=b.child;if(x!==null){b.child=null;do{var S=x.sibling;x.sibling=null,x=S}while(x!==null)}}ie=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,ie=i;else e:for(;ie!==null;){if(o=ie,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Vo(9,o,o.return)}var y=o.sibling;if(y!==null){y.return=o.return,ie=y;break e}ie=o.return}}var f=t.current;for(ie=f;ie!==null;){i=ie;var m=i.child;if(i.subtreeFlags&2064&&m!==null)m.return=i,ie=m;else e:for(i=f;ie!==null;){if(l=ie,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Ka(9,l)}}catch(k){Ct(l,l.return,k)}if(l===i){ie=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,ie=w;break e}ie=l.return}}if(Ve=s,Zr(),hr&&typeof hr.onPostCommitFiberRoot=="function")try{hr.onPostCommitFiberRoot(Ua,t)}catch{}r=!0}return r}finally{rt=n,Mn.transition=e}}return!1}function df(t,e,n){e=fo(n,e),e=Pp(t,e,1),t=Gr(t,e,1),e=fn(),t!==null&&(yi(t,1,e),En(t,e))}function Ct(t,e,n){if(t.tag===3)df(t,t,n);else for(;e!==null;){if(e.tag===3){df(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(qr===null||!qr.has(r))){t=fo(n,t),t=Lp(e,t,1),e=Gr(e,t,1),t=fn(),e!==null&&(yi(e,1,t),En(e,t));break}}e=e.return}}function ny(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=fn(),t.pingedLanes|=t.suspendedLanes&n,Jt===t&&(Qt&n)===n&&(zt===4||zt===3&&(Qt&130023424)===Qt&&500>Nt()-Gc?bs(t,0):Vc|=n),En(t,e)}function tm(t,e){e===0&&(t.mode&1?(e=Oi,Oi<<=1,!(Oi&130023424)&&(Oi=4194304)):e=1);var n=fn();t=Er(t,e),t!==null&&(yi(t,e,n),En(t,n))}function ry(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),tm(t,n)}function sy(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(G(314))}r!==null&&r.delete(e),tm(t,n)}var nm;nm=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||_n.current)Sn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Sn=!1,G0(t,e,n);Sn=!!(t.flags&131072)}else Sn=!1,vt&&e.flags&1048576&&ip(e,_a,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;aa(t,e),t=e.pendingProps;var s=ao(e,nn.current);so(e,n),s=Mc(null,e,r,t,s,n);var o=Bc();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,kn(r)?(o=!0,wa(e)):o=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Tc(e),s.updater=Ha,e.stateNode=s,s._reactInternals=e,Du(e,r,t,n),e=Tu(null,e,r,!0,o,n)):(e.tag=0,vt&&o&&jc(e),cn(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(aa(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=iy(r),t=qn(r,t),s){case 0:e=Ou(null,e,r,t,n);break e;case 1:e=ef(null,e,r,t,n);break e;case 11:e=Xd(null,e,r,t,n);break e;case 14:e=Zd(null,e,r,qn(r.type,t),n);break e}throw Error(G(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:qn(r,s),Ou(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:qn(r,s),ef(t,e,r,s,n);case 3:e:{if(Bp(e),t===null)throw Error(G(387));r=e.pendingProps,o=e.memoizedState,s=o.element,fp(t,e),ja(e,r,null,n);var i=e.memoizedState;if(r=i.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){s=fo(Error(G(423)),e),e=tf(t,e,r,n,s);break e}else if(r!==s){s=fo(Error(G(424)),e),e=tf(t,e,r,n,s);break e}else for(Nn=Vr(e.stateNode.containerInfo.firstChild),Dn=e,vt=!0,Jn=null,n=cp(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(lo(),r===s){e=jr(t,e,n);break e}cn(t,e,r,n)}e=e.child}return e;case 5:return hp(e),t===null&&Cu(e),r=e.type,s=e.pendingProps,o=t!==null?t.memoizedProps:null,i=s.children,Su(r,s)?i=null:o!==null&&Su(r,o)&&(e.flags|=32),Mp(t,e),cn(t,e,i,n),e.child;case 6:return t===null&&Cu(e),null;case 13:return Up(t,e,n);case 4:return Pc(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=uo(e,null,r,n):cn(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:qn(r,s),Xd(t,e,r,s,n);case 7:return cn(t,e,e.pendingProps,n),e.child;case 8:return cn(t,e,e.pendingProps.children,n),e.child;case 12:return cn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,o=e.memoizedProps,i=s.value,ft(ka,r._currentValue),r._currentValue=i,o!==null)if(Zn(o.value,i)){if(o.children===s.children&&!_n.current){e=jr(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var l=o.dependencies;if(l!==null){i=o.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(o.tag===1){u=Sr(-1,n&-n),u.tag=2;var c=o.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}o.lanes|=n,u=o.alternate,u!==null&&(u.lanes|=n),Ru(o.return,n,e),l.lanes|=n;break}u=u.next}}else if(o.tag===10)i=o.type===e.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(G(341));i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),Ru(i,n,e),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===e){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}cn(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,so(e,n),s=Un(s),r=r(s),e.flags|=1,cn(t,e,r,n),e.child;case 14:return r=e.type,s=qn(r,e.pendingProps),s=qn(r.type,s),Zd(t,e,r,s,n);case 15:return Ip(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:qn(r,s),aa(t,e),e.tag=1,kn(r)?(t=!0,wa(e)):t=!1,so(e,n),Tp(e,r,s),Du(e,r,s,n),Tu(null,e,r,!0,t,n);case 19:return Fp(t,e,n);case 22:return $p(t,e,n)}throw Error(G(156,e.tag))};function rm(t,e){return Dh(t,e)}function oy(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $n(t,e,n,r){return new oy(t,e,n,r)}function Jc(t){return t=t.prototype,!(!t||!t.isReactComponent)}function iy(t){if(typeof t=="function")return Jc(t)?1:0;if(t!=null){if(t=t.$$typeof,t===pc)return 11;if(t===mc)return 14}return 2}function Kr(t,e){var n=t.alternate;return n===null?(n=$n(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function ca(t,e,n,r,s,o){var i=2;if(r=t,typeof t=="function")Jc(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case Ws:return ws(n.children,s,o,e);case hc:i=8,s|=8;break;case eu:return t=$n(12,n,e,s|2),t.elementType=eu,t.lanes=o,t;case tu:return t=$n(13,n,e,s),t.elementType=tu,t.lanes=o,t;case nu:return t=$n(19,n,e,s),t.elementType=nu,t.lanes=o,t;case hh:return Ya(n,s,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case dh:i=10;break e;case fh:i=9;break e;case pc:i=11;break e;case mc:i=14;break e;case Pr:i=16,r=null;break e}throw Error(G(130,t==null?t:typeof t,""))}return e=$n(i,n,e,s),e.elementType=t,e.type=r,e.lanes=o,e}function ws(t,e,n,r){return t=$n(7,t,r,e),t.lanes=n,t}function Ya(t,e,n,r){return t=$n(22,t,r,e),t.elementType=hh,t.lanes=n,t.stateNode={isHidden:!1},t}function Ll(t,e,n){return t=$n(6,t,null,e),t.lanes=n,t}function Il(t,e,n){return e=$n(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function ay(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gl(0),this.expirationTimes=gl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gl(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Yc(t,e,n,r,s,o,i,l,u){return t=new ay(t,e,n,l,u),e===1?(e=1,o===!0&&(e|=8)):e=0,o=$n(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Tc(o),t}function ly(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:zs,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function sm(t){if(!t)return Yr;t=t._reactInternals;e:{if(Ns(t)!==t||t.tag!==1)throw Error(G(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(kn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(G(171))}if(t.tag===1){var n=t.type;if(kn(n))return sp(t,n,e)}return e}function om(t,e,n,r,s,o,i,l,u){return t=Yc(n,r,!0,t,s,o,i,l,u),t.context=sm(null),n=t.current,r=fn(),s=Hr(n),o=Sr(r,s),o.callback=e??null,Gr(n,o,s),t.current.lanes=s,yi(t,s,r),En(t,r),t}function Qa(t,e,n,r){var s=e.current,o=fn(),i=Hr(s);return n=sm(n),e.context===null?e.context=n:e.pendingContext=n,e=Sr(o,i),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Gr(s,e,i),t!==null&&(Xn(t,s,i,o),sa(t,s,i)),i}function Pa(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function ff(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Qc(t,e){ff(t,e),(t=t.alternate)&&ff(t,e)}function uy(){return null}var im=typeof reportError=="function"?reportError:function(t){console.error(t)};function Xc(t){this._internalRoot=t}Xa.prototype.render=Xc.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(G(409));Qa(t,e,null,null)};Xa.prototype.unmount=Xc.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;js(function(){Qa(null,t,null,null)}),e[kr]=null}};function Xa(t){this._internalRoot=t}Xa.prototype.unstable_scheduleHydration=function(t){if(t){var e=$h();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ir.length&&e!==0&&e<Ir[n].priority;n++);Ir.splice(n,0,t),n===0&&Bh(t)}};function Zc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Za(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function hf(){}function cy(t,e,n,r,s){if(s){if(typeof r=="function"){var o=r;r=function(){var c=Pa(i);o.call(c)}}var i=om(e,r,t,0,null,!1,!1,"",hf);return t._reactRootContainer=i,t[kr]=i.current,oi(t.nodeType===8?t.parentNode:t),js(),i}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var c=Pa(u);l.call(c)}}var u=Yc(t,0,!1,null,null,!1,!1,"",hf);return t._reactRootContainer=u,t[kr]=u.current,oi(t.nodeType===8?t.parentNode:t),js(function(){Qa(e,u,n,r)}),u}function el(t,e,n,r,s){var o=n._reactRootContainer;if(o){var i=o;if(typeof s=="function"){var l=s;s=function(){var u=Pa(i);l.call(u)}}Qa(e,i,t,s)}else i=cy(n,e,t,s,r);return Pa(i)}Lh=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Po(e.pendingLanes);n!==0&&(vc(e,n|1),En(e,Nt()),!(Ve&6)&&(ho=Nt()+500,Zr()))}break;case 13:js(function(){var r=Er(t,1);if(r!==null){var s=fn();Xn(r,t,1,s)}}),Qc(t,1)}};xc=function(t){if(t.tag===13){var e=Er(t,134217728);if(e!==null){var n=fn();Xn(e,t,134217728,n)}Qc(t,134217728)}};Ih=function(t){if(t.tag===13){var e=Hr(t),n=Er(t,e);if(n!==null){var r=fn();Xn(n,t,e,r)}Qc(t,e)}};$h=function(){return rt};Mh=function(t,e){var n=rt;try{return rt=t,e()}finally{rt=n}};fu=function(t,e,n){switch(e){case"input":if(ou(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Va(r);if(!s)throw Error(G(90));mh(r),ou(r,s)}}}break;case"textarea":yh(t,n);break;case"select":e=n.value,e!=null&&eo(t,!!n.multiple,e,!1)}};kh=qc;Eh=js;var dy={usingClientEntryPoint:!1,Events:[xi,Hs,Va,Sh,_h,qc]},No={findFiberByHostInstance:gs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},fy={bundleType:No.bundleType,version:No.version,rendererPackageName:No.rendererPackageName,rendererConfig:No.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Rr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Rh(t),t===null?null:t.stateNode},findFiberByHostInstance:No.findFiberByHostInstance||uy,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Wi=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Wi.isDisabled&&Wi.supportsFiber)try{Ua=Wi.inject(fy),hr=Wi}catch{}}Tn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dy;Tn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Zc(e))throw Error(G(200));return ly(t,e,null,n)};Tn.createRoot=function(t,e){if(!Zc(t))throw Error(G(299));var n=!1,r="",s=im;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Yc(t,1,!1,null,null,n,!1,r,s),t[kr]=e.current,oi(t.nodeType===8?t.parentNode:t),new Xc(e)};Tn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(G(188)):(t=Object.keys(t).join(","),Error(G(268,t)));return t=Rh(e),t=t===null?null:t.stateNode,t};Tn.flushSync=function(t){return js(t)};Tn.hydrate=function(t,e,n){if(!Za(e))throw Error(G(200));return el(null,t,e,!0,n)};Tn.hydrateRoot=function(t,e,n){if(!Zc(t))throw Error(G(405));var r=n!=null&&n.hydratedSources||null,s=!1,o="",i=im;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),e=om(e,null,t,1,n??null,s,!1,o,i),t[kr]=e.current,oi(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Xa(e)};Tn.render=function(t,e,n){if(!Za(e))throw Error(G(200));return el(null,t,e,!1,n)};Tn.unmountComponentAtNode=function(t){if(!Za(t))throw Error(G(40));return t._reactRootContainer?(js(function(){el(null,null,t,!1,function(){t._reactRootContainer=null,t[kr]=null})}),!0):!1};Tn.unstable_batchedUpdates=qc;Tn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Za(n))throw Error(G(200));if(t==null||t._reactInternals===void 0)throw Error(G(38));return el(t,e,n,!1,r)};Tn.version="18.3.1-next-f1338f8080-20240426";function am(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(am)}catch(t){console.error(t)}}am(),ah.exports=Tn;var hy=ah.exports,pf=hy;Xl.createRoot=pf.createRoot,Xl.hydrateRoot=pf.hydrateRoot;const py="modulepreload",my=function(t){return"/"+t},mf={},wi=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=Promise.allSettled(n.map(u=>{if(u=my(u),u in mf)return;mf[u]=!0;const c=u.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":py,c||(h.as="script"),h.crossOrigin="",h.href=u,l&&h.setAttribute("nonce",l),document.head.appendChild(h),c)return new Promise((p,g)=>{h.addEventListener("load",p),h.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${u}`)))})}))}function o(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return s.then(i=>{for(const l of i||[])l.status==="rejected"&&o(l.reason);return e().catch(o)})},gy=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>wi(async()=>{const{default:r}=await Promise.resolve().then(()=>vo);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)};class ed extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class yy extends ed{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class gf extends ed{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class yf extends ed{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Gu;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Gu||(Gu={}));var vy=function(t,e,n,r){function s(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?o(d.value):s(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};class xy{constructor(e,{headers:n={},customFetch:r,region:s=Gu.Any}={}){this.url=e,this.headers=n,this.region=s,this.fetch=gy(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var r;return vy(this,void 0,void 0,function*(){try{const{headers:s,method:o,body:i}=n;let l={},{region:u}=n;u||(u=this.region);const c=new URL(`${this.url}/${e}`);u&&u!=="any"&&(l["x-region"]=u,c.searchParams.set("forceFunctionRegion",u));let d;i&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",d=i):typeof i=="string"?(l["Content-Type"]="text/plain",d=i):typeof FormData<"u"&&i instanceof FormData?d=i:(l["Content-Type"]="application/json",d=JSON.stringify(i)));const h=yield this.fetch(c.toString(),{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),s),body:d}).catch(x=>{throw new yy(x)}),p=h.headers.get("x-relay-error");if(p&&p==="true")throw new gf(h);if(!h.ok)throw new yf(h);let g=((r=h.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),b;return g==="application/json"?b=yield h.json():g==="application/octet-stream"?b=yield h.blob():g==="text/event-stream"?b=h:g==="multipart/form-data"?b=yield h.formData():b=yield h.text(),{data:b,error:null,response:h}}catch(s){return{data:null,error:s,response:s instanceof yf||s instanceof gf?s.context:void 0}}})}}var wn={},td={},tl={},Si={},nl={},rl={},by=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},po=by();const wy=po.fetch,lm=po.fetch.bind(po),um=po.Headers,Sy=po.Request,_y=po.Response,vo=Object.freeze(Object.defineProperty({__proto__:null,Headers:um,Request:Sy,Response:_y,default:lm,fetch:wy},Symbol.toStringTag,{value:"Module"})),ky=Fm(vo);var sl={};Object.defineProperty(sl,"__esModule",{value:!0});let Ey=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};sl.default=Ey;var cm=Bn&&Bn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(rl,"__esModule",{value:!0});const jy=cm(ky),Cy=cm(sl);let Ry=class{constructor(e){var n,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(n=e.shouldThrowOnError)!==null&&n!==void 0?n:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=jy.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,n){return this.headers=new Headers(this.headers),this.headers.set(e,n),this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const r=this.fetch;let s=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async o=>{var i,l,u,c;let d=null,h=null,p=null,g=o.status,b=o.statusText;if(o.ok){if(this.method!=="HEAD"){const f=await o.text();f===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((i=this.headers.get("Accept"))===null||i===void 0)&&i.includes("application/vnd.pgrst.plan+text"))?h=f:h=JSON.parse(f))}const S=(l=this.headers.get("Prefer"))===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),y=(u=o.headers.get("content-range"))===null||u===void 0?void 0:u.split("/");S&&y&&y.length>1&&(p=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(h)&&(h.length>1?(d={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,p=null,g=406,b="Not Acceptable"):h.length===1?h=h[0]:h=null)}else{const S=await o.text();try{d=JSON.parse(S),Array.isArray(d)&&o.status===404&&(h=[],d=null,g=200,b="OK")}catch{o.status===404&&S===""?(g=204,b="No Content"):d={message:S}}if(d&&this.isMaybeSingle&&(!((c=d==null?void 0:d.details)===null||c===void 0)&&c.includes("0 rows"))&&(d=null,g=200,b="OK"),d&&this.shouldThrowOnError)throw new Cy.default(d)}return{error:d,data:h,count:p,status:g,statusText:b}});return this.shouldThrowOnError||(s=s.catch(o=>{var i,l,u;return{error:{message:`${(i=o==null?void 0:o.name)!==null&&i!==void 0?i:"FetchError"}: ${o==null?void 0:o.message}`,details:`${(l=o==null?void 0:o.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(u=o==null?void 0:o.code)!==null&&u!==void 0?u:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,n)}returns(){return this}overrideTypes(){return this}};rl.default=Ry;var Ny=Bn&&Bn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(nl,"__esModule",{value:!0});const Dy=Ny(rl);let Ay=class extends Dy.default{select(e){let n=!1;const r=(e??"*").split("").map(s=>/\s/.test(s)&&!n?"":(s==='"'&&(n=!n),s)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:n=!0,nullsFirst:r,foreignTable:s,referencedTable:o=s}={}){const i=o?`${o}.order`:"order",l=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${l?`${l},`:""}${e}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:r=n}={}){const s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,n,{foreignTable:r,referencedTable:s=r}={}){const o=typeof s>"u"?"offset":`${s}.offset`,i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(o,`${e}`),this.url.searchParams.set(i,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:n=!1,settings:r=!1,buffers:s=!1,wal:o=!1,format:i="text"}={}){var l;const u=[e?"analyze":null,n?"verbose":null,r?"settings":null,s?"buffers":null,o?"wal":null].filter(Boolean).join("|"),c=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${c}"; options=${u};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};nl.default=Ay;var Oy=Bn&&Bn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Si,"__esModule",{value:!0});const Ty=Oy(nl);let Py=class extends Ty.default{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const r=Array.from(new Set(n)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:r,type:s}={}){let o="";s==="plain"?o="pl":s==="phrase"?o="ph":s==="websearch"&&(o="w");const i=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${o}fts${i}.${n}`),this}match(e){return Object.entries(e).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(e,n,r){return this.url.searchParams.append(e,`not.${n}.${r}`),this}or(e,{foreignTable:n,referencedTable:r=n}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,n,r){return this.url.searchParams.append(e,`${n}.${r}`),this}};Si.default=Py;var Ly=Bn&&Bn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(tl,"__esModule",{value:!0});const Do=Ly(Si);let Iy=class{constructor(e,{headers:n={},schema:r,fetch:s}){this.url=e,this.headers=new Headers(n),this.schema=r,this.fetch=s}select(e,{head:n=!1,count:r}={}){const s=n?"HEAD":"GET";let o=!1;const i=(e??"*").split("").map(l=>/\s/.test(l)&&!o?"":(l==='"'&&(o=!o),l)).join("");return this.url.searchParams.set("select",i),r&&this.headers.append("Prefer",`count=${r}`),new Do.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:n,defaultToNull:r=!0}={}){var s;const o="POST";if(n&&this.headers.append("Prefer",`count=${n}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const i=e.reduce((l,u)=>l.concat(Object.keys(u)),[]);if(i.length>0){const l=[...new Set(i)].map(u=>`"${u}"`);this.url.searchParams.set("columns",l.join(","))}}return new Do.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(e,{onConflict:n,ignoreDuplicates:r=!1,count:s,defaultToNull:o=!0}={}){var i;const l="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),n!==void 0&&this.url.searchParams.set("on_conflict",n),s&&this.headers.append("Prefer",`count=${s}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const u=e.reduce((c,d)=>c.concat(Object.keys(d)),[]);if(u.length>0){const c=[...new Set(u)].map(d=>`"${d}"`);this.url.searchParams.set("columns",c.join(","))}}return new Do.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(e,{count:n}={}){var r;const s="PATCH";return n&&this.headers.append("Prefer",`count=${n}`),new Do.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var n;const r="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new Do.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}};tl.default=Iy;var dm=Bn&&Bn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(td,"__esModule",{value:!0});const $y=dm(tl),My=dm(Si);let By=class fm{constructor(e,{headers:n={},schema:r,fetch:s}={}){this.url=e,this.headers=new Headers(n),this.schemaName=r,this.fetch=s}from(e){const n=new URL(`${this.url}/${e}`);return new $y.default(n,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new fm(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:r=!1,get:s=!1,count:o}={}){var i;let l;const u=new URL(`${this.url}/rpc/${e}`);let c;r||s?(l=r?"HEAD":"GET",Object.entries(n).filter(([h,p])=>p!==void 0).map(([h,p])=>[h,Array.isArray(p)?`{${p.join(",")}}`:`${p}`]).forEach(([h,p])=>{u.searchParams.append(h,p)})):(l="POST",c=n);const d=new Headers(this.headers);return o&&d.set("Prefer",`count=${o}`),new My.default({method:l,url:u,headers:d,schema:this.schemaName,body:c,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};td.default=By;var xo=Bn&&Bn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(wn,"__esModule",{value:!0});wn.PostgrestError=wn.PostgrestBuilder=wn.PostgrestTransformBuilder=wn.PostgrestFilterBuilder=wn.PostgrestQueryBuilder=wn.PostgrestClient=void 0;const hm=xo(td);wn.PostgrestClient=hm.default;const pm=xo(tl);wn.PostgrestQueryBuilder=pm.default;const mm=xo(Si);wn.PostgrestFilterBuilder=mm.default;const gm=xo(nl);wn.PostgrestTransformBuilder=gm.default;const ym=xo(rl);wn.PostgrestBuilder=ym.default;const vm=xo(sl);wn.PostgrestError=vm.default;var Uy=wn.default={PostgrestClient:hm.default,PostgrestQueryBuilder:pm.default,PostgrestFilterBuilder:mm.default,PostgrestTransformBuilder:gm.default,PostgrestBuilder:ym.default,PostgrestError:vm.default};const{PostgrestClient:Fy,PostgrestQueryBuilder:Gb,PostgrestFilterBuilder:qb,PostgrestTransformBuilder:Hb,PostgrestBuilder:Kb,PostgrestError:Jb}=Uy;class zy{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const r=n.node,s=parseInt(r.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const r=this.getWebSocketConstructor();return new r(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const Wy="2.15.5",Vy=`realtime-js/${Wy}`,Gy="1.0.0",qu=1e4,qy=1e3,Hy=100;var Ho;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Ho||(Ho={}));var Bt;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Bt||(Bt={}));var Kn;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Kn||(Kn={}));var Hu;(function(t){t.websocket="websocket"})(Hu||(Hu={}));var ms;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(ms||(ms={}));class Ky{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const s=n.getUint8(1),o=n.getUint8(2);let i=this.HEADER_LENGTH+2;const l=r.decode(e.slice(i,i+s));i=i+s;const u=r.decode(e.slice(i,i+o));i=i+o;const c=JSON.parse(r.decode(e.slice(i,e.byteLength)));return{ref:null,topic:l,event:u,payload:c}}}class xm{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var dt;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(dt||(dt={}));const vf=(t,e,n={})=>{var r;const s=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((o,i)=>(o[i]=Jy(i,t,e,s),o),{})},Jy=(t,e,n,r)=>{const s=e.find(l=>l.name===t),o=s==null?void 0:s.type,i=n[t];return o&&!r.includes(o)?bm(o,i):Ku(i)},bm=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return Zy(e,n)}switch(t){case dt.bool:return Yy(e);case dt.float4:case dt.float8:case dt.int2:case dt.int4:case dt.int8:case dt.numeric:case dt.oid:return Qy(e);case dt.json:case dt.jsonb:return Xy(e);case dt.timestamp:return ev(e);case dt.abstime:case dt.date:case dt.daterange:case dt.int4range:case dt.int8range:case dt.money:case dt.reltime:case dt.text:case dt.time:case dt.timestamptz:case dt.timetz:case dt.tsrange:case dt.tstzrange:return Ku(e);default:return Ku(e)}},Ku=t=>t,Yy=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Qy=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Xy=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},Zy=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let o;const i=t.slice(1,n);try{o=JSON.parse("["+i+"]")}catch{o=i?i.split(","):[]}return o.map(l=>bm(e,l))}return t},ev=t=>typeof t=="string"?t.replace(" ","T"):t,wm=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class $l{constructor(e,n,r={},s=qu){this.channel=e,this.event=n,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var xf;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(xf||(xf={}));class Ko{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:o,onLeave:i,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ko.syncState(this.state,s,o,i),this.pendingDiffs.forEach(u=>{this.state=Ko.syncDiff(this.state,u,o,i)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},s=>{const{onJoin:o,onLeave:i,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Ko.syncDiff(this.state,s,o,i),l())}),this.onJoin((s,o,i)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:o,newPresences:i})}),this.onLeave((s,o,i)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:o,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,s){const o=this.cloneDeep(e),i=this.transformState(n),l={},u={};return this.map(o,(c,d)=>{i[c]||(u[c]=d)}),this.map(i,(c,d)=>{const h=o[c];if(h){const p=d.map(S=>S.presence_ref),g=h.map(S=>S.presence_ref),b=d.filter(S=>g.indexOf(S.presence_ref)<0),x=h.filter(S=>p.indexOf(S.presence_ref)<0);b.length>0&&(l[c]=b),x.length>0&&(u[c]=x)}else l[c]=d}),this.syncDiff(o,{joins:l,leaves:u},r,s)}static syncDiff(e,n,r,s){const{joins:o,leaves:i}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(o,(l,u)=>{var c;const d=(c=e[l])!==null&&c!==void 0?c:[];if(e[l]=this.cloneDeep(u),d.length>0){const h=e[l].map(g=>g.presence_ref),p=d.filter(g=>h.indexOf(g.presence_ref)<0);e[l].unshift(...p)}r(l,d,u)}),this.map(i,(l,u)=>{let c=e[l];if(!c)return;const d=u.map(h=>h.presence_ref);c=c.filter(h=>d.indexOf(h.presence_ref)<0),e[l]=c,s(l,c,u),c.length===0&&delete e[l]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const s=e[r];return"metas"in s?n[r]=s.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):n[r]=s,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var bf;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(bf||(bf={}));var Jo;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Jo||(Jo={}));var yr;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(yr||(yr={}));class nd{constructor(e,n={config:{}},r){this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=Bt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new $l(this,Kn.join,this.params,this.timeout),this.rejoinTimer=new xm(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Bt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Bt.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Bt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Bt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Bt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Kn.reply,{},(s,o)=>{this._trigger(this._replyEventName(o),s)}),this.presence=new Ko(this),this.broadcastEndpointURL=wm(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var r,s,o;if(this.socket.isConnected()||this.socket.connect(),this.state==Bt.closed){const{config:{broadcast:i,presence:l,private:u}}=this.params,c=(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(g=>g.filter))!==null&&s!==void 0?s:[],d=!!this.bindings[Jo.PRESENCE]&&this.bindings[Jo.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,h={},p={broadcast:i,presence:Object.assign(Object.assign({},l),{enabled:d}),postgres_changes:c,private:u};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(g=>e==null?void 0:e(yr.CHANNEL_ERROR,g)),this._onClose(()=>e==null?void 0:e(yr.CLOSED)),this.updateJoinPayload(Object.assign({config:p},h)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:g})=>{var b;if(this.socket.setAuth(),g===void 0){e==null||e(yr.SUBSCRIBED);return}else{const x=this.bindings.postgres_changes,S=(b=x==null?void 0:x.length)!==null&&b!==void 0?b:0,y=[];for(let f=0;f<S;f++){const m=x[f],{filter:{event:w,schema:k,table:D,filter:R}}=m,E=g&&g[f];if(E&&E.event===w&&E.schema===k&&E.table===D&&E.filter===R)y.push(Object.assign(Object.assign({},m),{id:E.id}));else{this.unsubscribe(),this.state=Bt.errored,e==null||e(yr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,e&&e(yr.SUBSCRIBED);return}}).receive("error",g=>{this.state=Bt.errored,e==null||e(yr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(g).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(yr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this.state===Bt.joined&&e===Jo.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,n,r)}async send(e,n={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){const{event:o,payload:i}=e,u={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:i,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=c.body)===null||s===void 0?void 0:s.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var i,l,u;const c=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((u=(l=(i=this.params)===null||i===void 0?void 0:i.config)===null||l===void 0?void 0:l.broadcast)===null||u===void 0)&&u.ack)&&o("ok"),c.receive("ok",()=>o("ok")),c.receive("error",()=>o("error")),c.receive("timeout",()=>o("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Bt.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Kn.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new $l(this,Kn.leave,{},e),r.receive("ok",()=>{n(),s("ok")}).receive("timeout",()=>{n(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Bt.closed,this.bindings={}}async _fetchWithTimeout(e,n,r){const s=new AbortController,o=setTimeout(()=>s.abort(),r),i=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:s.signal}));return clearTimeout(o),i}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new $l(this,e,n,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Hy){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var s,o;const i=e.toLocaleLowerCase(),{close:l,error:u,leave:c,join:d}=Kn;if(r&&[l,u,c,d].indexOf(i)>=0&&r!==this._joinRef())return;let p=this._onMessage(i,n,r);if(n&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(g=>{var b,x,S;return((b=g.filter)===null||b===void 0?void 0:b.event)==="*"||((S=(x=g.filter)===null||x===void 0?void 0:x.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===i}).map(g=>g.callback(p,r)):(o=this.bindings[i])===null||o===void 0||o.filter(g=>{var b,x,S,y,f,m;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in g){const w=g.id,k=(b=g.filter)===null||b===void 0?void 0:b.event;return w&&((x=n.ids)===null||x===void 0?void 0:x.includes(w))&&(k==="*"||(k==null?void 0:k.toLocaleLowerCase())===((S=n.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))}else{const w=(f=(y=g==null?void 0:g.filter)===null||y===void 0?void 0:y.event)===null||f===void 0?void 0:f.toLocaleLowerCase();return w==="*"||w===((m=n==null?void 0:n.event)===null||m===void 0?void 0:m.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===i}).map(g=>{if(typeof p=="object"&&"ids"in p){const b=p.data,{schema:x,table:S,commit_timestamp:y,type:f,errors:m}=b;p=Object.assign(Object.assign({},{schema:x,table:S,commit_timestamp:y,eventType:f,new:{},old:{},errors:m}),this._getPayloadRecords(b))}g.callback(p,r)})}_isClosed(){return this.state===Bt.closed}_isJoined(){return this.state===Bt.joined}_isJoining(){return this.state===Bt.joining}_isLeaving(){return this.state===Bt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const s=e.toLocaleLowerCase(),o={type:s,filter:n,callback:r};return this.bindings[s]?this.bindings[s].push(o):this.bindings[s]=[o],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(s=>{var o;return!(((o=s.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===r&&nd.isEqual(s.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Kn.close,{},e)}_onError(e){this._on(Kn.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Bt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=vf(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=vf(e.columns,e.old_record)),n}}const Ml=()=>{},Vi={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},tv=[1e3,2e3,5e3,1e4],nv=1e4,rv=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class sv{constructor(e,n){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=qu,this.transport=null,this.heartbeatIntervalMs=Vi.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ml,this.ref=0,this.reconnectTimer=null,this.logger=Ml,this.conn=null,this.sendBuffer=[],this.serializer=new Ky,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let o;return s?o=s:typeof fetch>"u"?o=(...i)=>wi(async()=>{const{default:l}=await Promise.resolve().then(()=>vo);return{default:l}},void 0).then(({default:l})=>l(...i)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):o=fetch,(...i)=>o(...i)},!(!((r=n==null?void 0:n.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${Hu.websocket}`,this.httpEndpoint=wm(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=zy.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Gy}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Ho.connecting:return ms.Connecting;case Ho.open:return ms.Open;case Ho.closing:return ms.Closing;default:return ms.Closed}}isConnected(){return this.connectionState()===ms.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const r=`realtime:${e}`,s=this.getChannels().find(o=>o.topic===r);if(s)return s;{const o=new nd(`realtime:${e}`,n,this);return this.channels.push(o),o}}push(e){const{topic:n,event:r,payload:s,ref:o}=e,i=()=>{this.encode(e,l=>{var u;(u=this.conn)===null||u===void 0||u.send(l)})};this.log("push",`${n} ${r} (${o})`,s),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(qy,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},Vi.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:s,payload:o,ref:i}=n,l=i?`(${i})`:"",u=o.status||"";this.log("receive",`${u} ${r} ${s} ${l}`.trim(),o),this.channels.filter(c=>c._isMember(r)).forEach(c=>c._trigger(s,o,i)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Kn.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(n);return`${e}${r}${s}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([rv],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n;e?n=e:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const s={access_token:n,version:Vy};n&&r.updateJoinPayload(s),r.joinedOnce&&r._isJoined()&&r._push(Kn.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(n)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new xm(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Vi.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,r,s,o,i,l,u,c,d;if(this.transport=(n=e==null?void 0:e.transport)!==null&&n!==void 0?n:null,this.timeout=(r=e==null?void 0:e.timeout)!==null&&r!==void 0?r:qu,this.heartbeatIntervalMs=(s=e==null?void 0:e.heartbeatIntervalMs)!==null&&s!==void 0?s:Vi.HEARTBEAT_INTERVAL,this.worker=(o=e==null?void 0:e.worker)!==null&&o!==void 0?o:!1,this.accessToken=(i=e==null?void 0:e.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(l=e==null?void 0:e.heartbeatCallback)!==null&&l!==void 0?l:Ml,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=e==null?void 0:e.reconnectAfterMs)!==null&&u!==void 0?u:h=>tv[h-1]||nv,this.encode=(c=e==null?void 0:e.encode)!==null&&c!==void 0?c:(h,p)=>p(JSON.stringify(h)),this.decode=(d=e==null?void 0:e.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class rd extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Ut(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class ov extends rd{constructor(e,n,r){super(e),this.name="StorageApiError",this.status=n,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Ju extends rd{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var iv=function(t,e,n,r){function s(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?o(d.value):s(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};const Sm=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>wi(async()=>{const{default:r}=await Promise.resolve().then(()=>vo);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},av=()=>iv(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield wi(()=>Promise.resolve().then(()=>vo),void 0)).Response:Response}),Yu=t=>{if(Array.isArray(t))return t.map(n=>Yu(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const s=n.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));e[s]=Yu(r)}),e},lv=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var Ds=function(t,e,n,r){function s(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?o(d.value):s(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};const Bl=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),uv=(t,e,n)=>Ds(void 0,void 0,void 0,function*(){const r=yield av();t instanceof r&&!(n!=null&&n.noResolveJson)?t.json().then(s=>{const o=t.status||500,i=(s==null?void 0:s.statusCode)||o+"";e(new ov(Bl(s),o,i))}).catch(s=>{e(new Ju(Bl(s),s))}):e(new Ju(Bl(t),t))}),cv=(t,e,n,r)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!r?s:(lv(r)?(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(r)):s.body=r,e!=null&&e.duplex&&(s.duplex=e.duplex),Object.assign(Object.assign({},s),n))};function _i(t,e,n,r,s,o){return Ds(this,void 0,void 0,function*(){return new Promise((i,l)=>{t(n,cv(e,r,s,o)).then(u=>{if(!u.ok)throw u;return r!=null&&r.noResolveJson?u:u.json()}).then(u=>i(u)).catch(u=>uv(u,l,r))})})}function La(t,e,n,r){return Ds(this,void 0,void 0,function*(){return _i(t,"GET",e,n,r)})}function lr(t,e,n,r,s){return Ds(this,void 0,void 0,function*(){return _i(t,"POST",e,r,s,n)})}function Qu(t,e,n,r,s){return Ds(this,void 0,void 0,function*(){return _i(t,"PUT",e,r,s,n)})}function dv(t,e,n,r){return Ds(this,void 0,void 0,function*(){return _i(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function _m(t,e,n,r,s){return Ds(this,void 0,void 0,function*(){return _i(t,"DELETE",e,r,s,n)})}var ln=function(t,e,n,r){function s(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?o(d.value):s(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};const fv={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},wf={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class hv{constructor(e,n={},r,s){this.shouldThrowOnError=!1,this.url=e,this.headers=n,this.bucketId=r,this.fetch=Sm(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,n,r,s){return ln(this,void 0,void 0,function*(){try{let o;const i=Object.assign(Object.assign({},wf),s);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(i.upsert)});const u=i.metadata;typeof Blob<"u"&&r instanceof Blob?(o=new FormData,o.append("cacheControl",i.cacheControl),u&&o.append("metadata",this.encodeMetadata(u)),o.append("",r)):typeof FormData<"u"&&r instanceof FormData?(o=r,o.append("cacheControl",i.cacheControl),u&&o.append("metadata",this.encodeMetadata(u))):(o=r,l["cache-control"]=`max-age=${i.cacheControl}`,l["content-type"]=i.contentType,u&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(u)))),s!=null&&s.headers&&(l=Object.assign(Object.assign({},l),s.headers));const c=this._removeEmptyFolders(n),d=this._getFinalPath(c),h=yield(e=="PUT"?Qu:lr)(this.fetch,`${this.url}/object/${d}`,o,Object.assign({headers:l},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:c,id:h.Id,fullPath:h.Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Ut(o))return{data:null,error:o};throw o}})}upload(e,n,r){return ln(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,s){return ln(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(e),i=this._getFinalPath(o),l=new URL(this.url+`/object/upload/sign/${i}`);l.searchParams.set("token",n);try{let u;const c=Object.assign({upsert:wf.upsert},s),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&r instanceof Blob?(u=new FormData,u.append("cacheControl",c.cacheControl),u.append("",r)):typeof FormData<"u"&&r instanceof FormData?(u=r,u.append("cacheControl",c.cacheControl)):(u=r,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType);const h=yield Qu(this.fetch,l.toString(),u,{headers:d});return{data:{path:o,fullPath:h.Key},error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(Ut(u))return{data:null,error:u};throw u}})}createSignedUploadUrl(e,n){return ln(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const s=Object.assign({},this.headers);n!=null&&n.upsert&&(s["x-upsert"]="true");const o=yield lr(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),i=new URL(this.url+o.url),l=i.searchParams.get("token");if(!l)throw new rd("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:l},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ut(r))return{data:null,error:r};throw r}})}update(e,n,r){return ln(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return ln(this,void 0,void 0,function*(){try{return{data:yield lr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ut(s))return{data:null,error:s};throw s}})}copy(e,n,r){return ln(this,void 0,void 0,function*(){try{return{data:{path:(yield lr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ut(s))return{data:null,error:s};throw s}})}createSignedUrl(e,n,r){return ln(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),o=yield lr(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${i}`)},{data:o,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ut(s))return{data:null,error:s};throw s}})}createSignedUrls(e,n,r){return ln(this,void 0,void 0,function*(){try{const s=yield lr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${o}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ut(s))return{data:null,error:s};throw s}})}download(e,n){return ln(this,void 0,void 0,function*(){const s=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),i=o?`?${o}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield La(this.fetch,`${this.url}/${s}/${l}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Ut(l))return{data:null,error:l};throw l}})}info(e){return ln(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const r=yield La(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Yu(r),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ut(r))return{data:null,error:r};throw r}})}exists(e){return ln(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield dv(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ut(r)&&r instanceof Ju){const s=r.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,n){const r=this._getFinalPath(e),s=[],o=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";o!==""&&s.push(o);const l=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",u=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});u!==""&&s.push(u);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${c}`)}}}remove(e){return ln(this,void 0,void 0,function*(){try{return{data:yield _m(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ut(n))return{data:null,error:n};throw n}})}list(e,n,r){return ln(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},fv),n),{prefix:e||""});return{data:yield lr(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ut(s))return{data:null,error:s};throw s}})}listV2(e,n){return ln(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield lr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},n),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ut(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const pv="2.12.1",mv={"X-Client-Info":`storage-js/${pv}`};var Ps=function(t,e,n,r){function s(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?o(d.value):s(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};class gv{constructor(e,n={},r,s){this.shouldThrowOnError=!1;const o=new URL(e);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase.")),this.url=o.href,this.headers=Object.assign(Object.assign({},mv),n),this.fetch=Sm(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return Ps(this,void 0,void 0,function*(){try{return{data:yield La(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Ut(e))return{data:null,error:e};throw e}})}getBucket(e){return Ps(this,void 0,void 0,function*(){try{return{data:yield La(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ut(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return Ps(this,void 0,void 0,function*(){try{return{data:yield lr(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ut(r))return{data:null,error:r};throw r}})}updateBucket(e,n){return Ps(this,void 0,void 0,function*(){try{return{data:yield Qu(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ut(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Ps(this,void 0,void 0,function*(){try{return{data:yield lr(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ut(n))return{data:null,error:n};throw n}})}deleteBucket(e){return Ps(this,void 0,void 0,function*(){try{return{data:yield _m(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ut(n))return{data:null,error:n};throw n}})}}class yv extends gv{constructor(e,n={},r,s){super(e,n,r,s)}from(e){return new hv(this.url,this.headers,e,this.fetch)}}const vv="2.57.4";let Io="";typeof Deno<"u"?Io="deno":typeof document<"u"?Io="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Io="react-native":Io="node";const xv={"X-Client-Info":`supabase-js-${Io}/${vv}`},bv={headers:xv},wv={schema:"public"},Sv={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},_v={};var kv=function(t,e,n,r){function s(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?o(d.value):s(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};const Ev=t=>{let e;return t?e=t:typeof fetch>"u"?e=lm:e=fetch,(...n)=>e(...n)},jv=()=>typeof Headers>"u"?um:Headers,Cv=(t,e,n)=>{const r=Ev(n),s=jv();return(o,i)=>kv(void 0,void 0,void 0,function*(){var l;const u=(l=yield e())!==null&&l!==void 0?l:t;let c=new s(i==null?void 0:i.headers);return c.has("apikey")||c.set("apikey",t),c.has("Authorization")||c.set("Authorization",`Bearer ${u}`),r(o,Object.assign(Object.assign({},i),{headers:c}))})};var Rv=function(t,e,n,r){function s(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?o(d.value):s(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};function Nv(t){return t.endsWith("/")?t:t+"/"}function Dv(t,e){var n,r;const{db:s,auth:o,realtime:i,global:l}=t,{db:u,auth:c,realtime:d,global:h}=e,p={db:Object.assign(Object.assign({},u),s),auth:Object.assign(Object.assign({},c),o),realtime:Object.assign(Object.assign({},d),i),storage:{},global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(n=h==null?void 0:h.headers)!==null&&n!==void 0?n:{}),(r=l==null?void 0:l.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>Rv(this,void 0,void 0,function*(){return""})};return t.accessToken?p.accessToken=t.accessToken:delete p.accessToken,p}function Av(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Nv(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const km="2.71.1",Bs=30*1e3,Xu=3,Ul=Xu*Bs,Ov="http://localhost:9999",Tv="supabase.auth.token",Pv={"X-Client-Info":`gotrue-js/${km}`},Zu="X-Supabase-Api-Version",Em={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Lv=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Iv=10*60*1e3;class sd extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function Re(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class $v extends sd{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function Mv(t){return Re(t)&&t.name==="AuthApiError"}class jm extends sd{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class es extends sd{constructor(e,n,r,s){super(e,r,s),this.name=n,this.status=r}}class Tr extends es{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Bv(t){return Re(t)&&t.name==="AuthSessionMissingError"}class Gi extends es{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class qi extends es{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Hi extends es{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Uv(t){return Re(t)&&t.name==="AuthImplicitGrantRedirectError"}class Sf extends es{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ec extends es{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function Fl(t){return Re(t)&&t.name==="AuthRetryableFetchError"}class _f extends es{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class tc extends es{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ia="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),kf=` 	
\r=`.split(""),Fv=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<kf.length;e+=1)t[kf[e].charCodeAt(0)]=-2;for(let e=0;e<Ia.length;e+=1)t[Ia[e].charCodeAt(0)]=e;return t})();function Ef(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(Ia[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(Ia[r]),e.queuedBits-=6}}function Cm(t,e,n){const r=Fv[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function jf(t){const e=[],n=i=>{e.push(String.fromCodePoint(i))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},o=i=>{Vv(i,r,n)};for(let i=0;i<t.length;i+=1)Cm(t.charCodeAt(i),s,o);return e.join("")}function zv(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function Wv(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|s)+65536,n+=1}zv(r,e)}}function Vv(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if(!(t>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function Gv(t){const e=[],n={queue:0,queuedBits:0},r=s=>{e.push(s)};for(let s=0;s<t.length;s+=1)Cm(t.charCodeAt(s),n,r);return new Uint8Array(e)}function qv(t){const e=[];return Wv(t,n=>e.push(n)),new Uint8Array(e)}function Hv(t){const e=[],n={queue:0,queuedBits:0},r=s=>{e.push(s)};return t.forEach(s=>Ef(s,n,r)),Ef(null,n,r),e.join("")}function Kv(t){return Math.round(Date.now()/1e3)+t}function Jv(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Gn=()=>typeof window<"u"&&typeof document<"u",cs={tested:!1,writable:!1},Rm=()=>{if(!Gn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(cs.tested)return cs.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),cs.tested=!0,cs.writable=!0}catch{cs.tested=!0,cs.writable=!1}return cs.writable};function Yv(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((s,o)=>{e[o]=s})}catch{}return n.searchParams.forEach((r,s)=>{e[s]=r}),e}const Nm=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>wi(async()=>{const{default:r}=await Promise.resolve().then(()=>vo);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},Qv=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Us=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},ds=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Ar=async(t,e)=>{await t.removeItem(e)};class ol{constructor(){this.promise=new ol.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}ol.promiseConstructor=Promise;function zl(t){const e=t.split(".");if(e.length!==3)throw new tc("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!Lv.test(e[r]))throw new tc("JWT not in base64url format");return{header:JSON.parse(jf(e[0])),payload:JSON.parse(jf(e[1])),signature:Gv(e[2]),raw:{header:e[0],payload:e[1]}}}async function Xv(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function Zv(t,e){return new Promise((r,s)=>{(async()=>{for(let o=0;o<1/0;o++)try{const i=await t(o);if(!e(o,null,i)){r(i);return}}catch(i){if(!e(o,i)){s(i);return}}})()})}function ex(t){return("0"+t.toString(16)).substr(-2)}function tx(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let s="";for(let o=0;o<56;o++)s+=n.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,ex).join("")}async function nx(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),s=new Uint8Array(r);return Array.from(s).map(o=>String.fromCharCode(o)).join("")}async function rx(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await nx(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ls(t,e,n=!1){const r=tx();let s=r;n&&(s+="/PASSWORD_RECOVERY"),await Us(t,`${e}-code-verifier`,s);const o=await rx(r);return[o,r===o?"plain":"s256"]}const sx=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function ox(t){const e=t.headers.get(Zu);if(!e||!e.match(sx))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function ix(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function ax(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const lx=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Is(t){if(!lx.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Wl(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Cf(t){return JSON.parse(JSON.stringify(t))}var ux=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n};const ps=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),cx=[502,503,504];async function Rf(t){var e;if(!Qv(t))throw new ec(ps(t),0);if(cx.includes(t.status))throw new ec(ps(t),t.status);let n;try{n=await t.json()}catch(o){throw new jm(ps(o),o)}let r;const s=ox(t);if(s&&s.getTime()>=Em["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new _f(ps(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new Tr}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((o,i)=>o&&typeof i=="string",!0))throw new _f(ps(n),t.status,n.weak_password.reasons);throw new $v(ps(n),t.status||500,r)}const dx=(t,e,n,r)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),n))};async function $e(t,e,n,r){var s;const o=Object.assign({},r==null?void 0:r.headers);o[Zu]||(o[Zu]=Em["2024-01-01"].name),r!=null&&r.jwt&&(o.Authorization=`Bearer ${r.jwt}`);const i=(s=r==null?void 0:r.query)!==null&&s!==void 0?s:{};r!=null&&r.redirectTo&&(i.redirect_to=r.redirectTo);const l=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",u=await fx(t,e,n+l,{headers:o,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(u):{data:Object.assign({},u),error:null}}async function fx(t,e,n,r,s,o){const i=dx(e,r,s,o);let l;try{l=await t(n,Object.assign({},i))}catch(u){throw console.error(u),new ec(ps(u),0)}if(l.ok||await Rf(l),r!=null&&r.noResolveJson)return l;try{return await l.json()}catch(u){await Rf(u)}}function mr(t){var e;let n=null;gx(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=Kv(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function Nf(t){const e=mr(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Mr(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function hx(t){return{data:t,error:null}}function px(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:s,verification_type:o}=t,i=ux(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:n,hashed_token:r,redirect_to:s,verification_type:o},u=Object.assign({},i);return{data:{properties:l,user:u},error:null}}function mx(t){return t}function gx(t){return t.access_token&&t.refresh_token&&t.expires_in}const Vl=["global","local","others"];var yx=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n};class vx{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=Nm(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n=Vl[0]){if(Vl.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Vl.join(", ")}`);try{return await $e(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Re(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await $e(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Mr})}catch(r){if(Re(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=yx(e,["options"]),s=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(s.new_email=r==null?void 0:r.newEmail,delete s.newEmail),await $e(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:px,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(Re(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await $e(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Mr})}catch(n){if(Re(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,s,o,i,l,u;try{const c={nextPage:null,lastPage:0,total:0},d=await $e(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(o=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&o!==void 0?o:""},xform:mx});if(d.error)throw d.error;const h=await d.json(),p=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,g=(u=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&u!==void 0?u:[];return g.length>0&&(g.forEach(b=>{const x=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(b.split(";")[1].split("=")[1]);c[`${S}Page`]=x}),c.total=parseInt(p)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(Re(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){Is(e);try{return await $e(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Mr})}catch(n){if(Re(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){Is(e);try{return await $e(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Mr})}catch(r){if(Re(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){Is(e);try{return await $e(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Mr})}catch(r){if(Re(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Is(e.userId);try{const{data:n,error:r}=await $e(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:n,error:r}}catch(n){if(Re(n))return{data:null,error:n};throw n}}async _deleteFactor(e){Is(e.userId),Is(e.id);try{return{data:await $e(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(Re(n))return{data:null,error:n};throw n}}}function Df(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function xx(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const $s={debug:!!(globalThis&&Rm()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Dm extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class bx extends Dm{}async function wx(t,e,n){$s.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),$s.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){$s.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,s.name);try{return await n()}finally{$s.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,s.name)}}else{if(e===0)throw $s.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new bx(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if($s.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}xx();const Sx={url:Ov,storageKey:Tv,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Pv,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Af(t,e,n){return await n()}const Ms={};class pi{constructor(e){var n,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=pi.nextInstanceID,pi.nextInstanceID+=1,this.instanceID>0&&Gn()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},Sx),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new vx({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=Nm(s.fetch),this.lock=s.lock||Af,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:Gn()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=wx:this.lock=Af,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:Rm()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Df(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=Df(this.memoryStorage)),Gn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}get jwks(){var e,n;return(n=(e=Ms[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){Ms[this.storageKey]=Object.assign(Object.assign({},Ms[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=Ms[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Ms[this.storageKey]=Object.assign(Object.assign({},Ms[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${km}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=Yv(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),Gn()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:o}=await this._getSessionFromURL(n,r);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),Uv(o)){const u=(e=o.details)===null||e===void 0?void 0:e.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:i,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",i,"redirect type",l),await this._saveSession(i),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Re(n)?{error:n}:{error:new jm("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,s;try{const o=await $e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:mr}),{data:i,error:l}=o;if(l||!i)return{data:{user:null,session:null},error:l};const u=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(o){if(Re(o))return{data:{user:null,session:null},error:o};throw o}}async signUp(e){var n,r,s;try{let o;if("email"in e){const{email:d,password:h,options:p}=e;let g=null,b=null;this.flowType==="pkce"&&([g,b]=await Ls(this.storage,this.storageKey)),o=await $e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:d,password:h,data:(n=p==null?void 0:p.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:g,code_challenge_method:b},xform:mr})}else if("phone"in e){const{phone:d,password:h,options:p}=e;o=await $e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},channel:(s=p==null?void 0:p.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:mr})}else throw new qi("You must provide either an email or phone number and a password");const{data:i,error:l}=o;if(l||!i)return{data:{user:null,session:null},error:l};const u=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(o){if(Re(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithPassword(e){try{let n;if("email"in e){const{email:o,password:i,options:l}=e;n=await $e(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Nf})}else if("phone"in e){const{phone:o,password:i,options:l}=e;n=await $e(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Nf})}else throw new qi("You must provide either an email or phone number and a password");const{data:r,error:s}=n;return s?{data:{user:null,session:null},error:s}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Gi}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(n){if(Re(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,r,s,o;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;if(n==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(e){var n,r,s,o,i,l,u,c,d,h,p,g;let b,x;if("message"in e)b=e.message,x=e.signature;else{const{chain:S,wallet:y,statement:f,options:m}=e;let w;if(Gn())if(typeof y=="object")w=y;else{const D=window;if("solana"in D&&typeof D.solana=="object"&&("signIn"in D.solana&&typeof D.solana.signIn=="function"||"signMessage"in D.solana&&typeof D.solana.signMessage=="function"))w=D.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(m!=null&&m.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=y}const k=new URL((n=m==null?void 0:m.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in w&&w.signIn){const D=await w.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},m==null?void 0:m.signInWithSolana),{version:"1",domain:k.host,uri:k.href}),f?{statement:f}:null));let R;if(Array.isArray(D)&&D[0]&&typeof D[0]=="object")R=D[0];else if(D&&typeof D=="object"&&"signedMessage"in D&&"signature"in D)R=D;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in R&&"signature"in R&&(typeof R.signedMessage=="string"||R.signedMessage instanceof Uint8Array)&&R.signature instanceof Uint8Array)b=typeof R.signedMessage=="string"?R.signedMessage:new TextDecoder().decode(R.signedMessage),x=R.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in w)||typeof w.signMessage!="function"||!("publicKey"in w)||typeof w!="object"||!w.publicKey||!("toBase58"in w.publicKey)||typeof w.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");b=[`${k.host} wants you to sign in with your Solana account:`,w.publicKey.toBase58(),...f?["",f,""]:[""],"Version: 1",`URI: ${k.href}`,`Issued At: ${(s=(r=m==null?void 0:m.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((o=m==null?void 0:m.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${m.signInWithSolana.notBefore}`]:[],...!((i=m==null?void 0:m.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${m.signInWithSolana.expirationTime}`]:[],...!((l=m==null?void 0:m.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${m.signInWithSolana.chainId}`]:[],...!((u=m==null?void 0:m.signInWithSolana)===null||u===void 0)&&u.nonce?[`Nonce: ${m.signInWithSolana.nonce}`]:[],...!((c=m==null?void 0:m.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${m.signInWithSolana.requestId}`]:[],...!((h=(d=m==null?void 0:m.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?["Resources",...m.signInWithSolana.resources.map(R=>`- ${R}`)]:[]].join(`
`);const D=await w.signMessage(new TextEncoder().encode(b),"utf8");if(!D||!(D instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");x=D}}try{const{data:S,error:y}=await $e(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:b,signature:Hv(x)},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(g=e.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:mr});if(y)throw y;return!S||!S.session||!S.user?{data:{user:null,session:null},error:new Gi}:(S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),{data:Object.assign({},S),error:y})}catch(S){if(Re(S))return{data:{user:null,session:null},error:S};throw S}}async _exchangeCodeForSession(e){const n=await ds(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(n??"").split("/");try{const{data:o,error:i}=await $e(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:mr});if(await Ar(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new Gi}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:s??null}),error:i})}catch(o){if(Re(o))return{data:{user:null,session:null,redirectType:null},error:o};throw o}}async signInWithIdToken(e){try{const{options:n,provider:r,token:s,access_token:o,nonce:i}=e,l=await $e(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:o,nonce:i,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:mr}),{data:u,error:c}=l;return c?{data:{user:null,session:null},error:c}:!u||!u.session||!u.user?{data:{user:null,session:null},error:new Gi}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:u,error:c})}catch(n){if(Re(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,r,s,o,i;try{if("email"in e){const{email:l,options:u}=e;let c=null,d=null;this.flowType==="pkce"&&([c,d]=await Ls(this.storage,this.storageKey));const{error:h}=await $e(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(n=u==null?void 0:u.data)!==null&&n!==void 0?n:{},create_user:(r=u==null?void 0:u.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},code_challenge:c,code_challenge_method:d},redirectTo:u==null?void 0:u.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:l,options:u}=e,{data:c,error:d}=await $e(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=u==null?void 0:u.data)!==null&&s!==void 0?s:{},create_user:(o=u==null?void 0:u.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},channel:(i=u==null?void 0:u.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:d}}throw new qi("You must provide either an email or phone number.")}catch(l){if(Re(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var n,r;try{let s,o;"options"in e&&(s=(n=e.options)===null||n===void 0?void 0:n.redirectTo,o=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:i,error:l}=await $e(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:s,xform:mr});if(l)throw l;if(!i)throw new Error("An error occurred on token verification.");const u=i.session,c=i.user;return u!=null&&u.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(s){if(Re(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var n,r,s;try{let o=null,i=null;return this.flowType==="pkce"&&([o,i]=await Ls(this.storage,this.storageKey)),await $e(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:i}),headers:this.headers,xform:hx})}catch(o){if(Re(o))return{data:null,error:o};throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new Tr;const{error:s}=await $e(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(Re(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:o}=e,{error:i}=await $e(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},redirectTo:o==null?void 0:o.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in e){const{phone:r,type:s,options:o}=e,{data:i,error:l}=await $e(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:l}}throw new qi("You must provide either an email or phone number and a type")}catch(n){if(Re(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await ds(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<Ul:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const i=await ds(this.userStorage,this.storageKey+"-user");i!=null&&i.user?e.user=i.user:e.user=Wl()}if(this.storage.isServer&&e.user){let i=this.suppressGetSessionWarning;e=new Proxy(e,{get:(u,c,d)=>(!i&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(u,c,d))})}return{data:{session:e},error:null}}const{session:s,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{session:null},error:o}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await $e(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Mr}):await this._useSession(async n=>{var r,s,o;const{data:i,error:l}=n;if(l)throw l;return!(!((r=i.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Tr}:await $e(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&o!==void 0?o:void 0,xform:Mr})})}catch(n){if(Re(n))return Bv(n)&&(await this._removeSession(),await Ar(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:s,error:o}=r;if(o)throw o;if(!s.session)throw new Tr;const i=s.session;let l=null,u=null;this.flowType==="pkce"&&e.email!=null&&([l,u]=await Ls(this.storage,this.storageKey));const{data:c,error:d}=await $e(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:u}),jwt:i.access_token,xform:Mr});if(d)throw d;return i.user=c.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(r){if(Re(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Tr;const n=Date.now()/1e3;let r=n,s=!0,o=null;const{payload:i}=zl(e.access_token);if(i.exp&&(r=i.exp,s=r<=n),s){const{session:l,error:u}=await this._callRefreshToken(e.refresh_token);if(u)return{data:{user:null,session:null},error:u};if(!l)return{data:{user:null,session:null},error:null};o=l}else{const{data:l,error:u}=await this._getUser(e.access_token);if(u)throw u;o={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(n){if(Re(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:i,error:l}=n;if(l)throw l;e=(r=i.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new Tr;const{session:s,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{user:null,session:null},error:o}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(Re(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!Gn())throw new Hi("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Hi(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new Sf("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Hi("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Sf("No code detected.");const{data:f,error:m}=await this._exchangeCodeForSession(e.code);if(m)throw m;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:f.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:o,refresh_token:i,expires_in:l,expires_at:u,token_type:c}=e;if(!o||!l||!i||!c)throw new Hi("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(l);let p=d+h;u&&(p=parseInt(u));const g=p-d;g*1e3<=Bs&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${h}s`);const b=p-h;d-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,p,d):d-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,p,d);const{data:x,error:S}=await this._getUser(o);if(S)throw S;const y={provider_token:r,provider_refresh_token:s,access_token:o,expires_in:h,expires_at:p,refresh_token:i,token_type:c,user:x.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:e.type},error:null}}catch(r){if(Re(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await ds(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:s,error:o}=n;if(o)return{error:o};const i=(r=s.session)===null||r===void 0?void 0:r.access_token;if(i){const{error:l}=await this.admin.signOut(i,e);if(l&&!(Mv(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await Ar(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=Jv(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,s;try{const{data:{session:o},error:i}=n;if(i)throw i;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}})}async resetPasswordForEmail(e,n={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await Ls(this.storage,this.storageKey,!0));try{return await $e(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(o){if(Re(o))return{data:null,error:o};throw o}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(Re(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:r,error:s}=await this._useSession(async o=>{var i,l,u,c,d;const{data:h,error:p}=o;if(p)throw p;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(u=e.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await $e(this.fetch,"GET",g,{headers:this.headers,jwt:(d=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&d!==void 0?d:void 0})});if(s)throw s;return Gn()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(Re(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,s;const{data:o,error:i}=n;if(i)throw i;return await $e(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(n){if(Re(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await Zv(async s=>(s>0&&await Xv(200*Math.pow(2,s-1)),this._debug(n,"refreshing attempt",s),await $e(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:mr})),(s,o)=>{const i=200*Math.pow(2,s);return o&&Fl(o)&&Date.now()+i-r<Bs})}catch(r){if(this._debug(n,"error",r),Re(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),Gn()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await ds(this.storage,this.storageKey);if(s&&this.userStorage){let i=await ds(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:s.user},await Us(this.userStorage,this.storageKey+"-user",i)),s.user=(e=i==null?void 0:i.user)!==null&&e!==void 0?e:Wl()}else if(s&&!s.user&&!s.user){const i=await ds(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(s.user=i.user,await Ar(this.storage,this.storageKey+"-user"),await Us(this.storage,this.storageKey,s)):s.user=Wl()}if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&await this._removeSession();return}const o=((n=s.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<Ul;if(this._debug(r,`session has${o?"":" not"} expired with margin of ${Ul}s`),o){if(this.autoRefreshToken&&s.refresh_token){const{error:i}=await this._callRefreshToken(s.refresh_token);i&&(console.error(i),Fl(i)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:l}=await this._getUser(s.access_token);!l&&(i!=null&&i.user)?(s.user=i.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(r,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new Tr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new ol;const{data:o,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!o.session)throw new Tr;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const l={session:o.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(o){if(this._debug(s,"error",o),Re(o)){const i={session:null,error:o};return Fl(o)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(i),i}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(o),o}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,n,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const o=[],i=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,n)}catch(u){o.push(u)}});if(await Promise.all(i),o.length>0){for(let l=0;l<o.length;l+=1)console.error(o[l]);throw o[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const n=Object.assign({},e),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await Us(this.userStorage,this.storageKey+"-user",{user:n.user});const s=Object.assign({},n);delete s.user;const o=Cf(s);await Us(this.storage,this.storageKey,o)}else{const s=Cf(n);await Us(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await Ar(this.storage,this.storageKey),await Ar(this.storage,this.storageKey+"-code-verifier"),await Ar(this.storage,this.storageKey+"-user"),this.userStorage&&await Ar(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Gn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Bs);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/Bs);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Bs}ms, refresh threshold is ${Xu} ticks`),s<=Xu&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Dm)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Gn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const s=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[o,i]=await Ls(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(i)}`});s.push(l.toString())}if(r!=null&&r.queryParams){const o=new URLSearchParams(r.queryParams);s.push(o.toString())}return r!=null&&r.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:s,error:o}=n;return o?{data:null,error:o}:await $e(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(Re(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,s;const{data:o,error:i}=n;if(i)return{data:null,error:i};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:u,error:c}=await $e(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((s=u==null?void 0:u.totp)===null||s===void 0)&&s.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),{data:u,error:null})})}catch(n){if(Re(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:o}=n;if(o)return{data:null,error:o};const{data:i,error:l}=await $e(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:l})})}catch(n){if(Re(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:o}=n;return o?{data:null,error:o}:await $e(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(Re(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(e==null?void 0:e.factors)||[],s=r.filter(i=>i.factor_type==="totp"&&i.status==="verified"),o=r.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:r,totp:s,phone:o},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,r;const{data:{session:s},error:o}=e;if(o)return{data:null,error:o};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=zl(s.access_token);let l=null;i.aal&&(l=i.aal);let u=l;((r=(n=s.user.factors)===null||n===void 0?void 0:n.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(u="aal2");const d=i.amr||[];return{data:{currentLevel:l,nextLevel:u,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(l=>l.kid===e);if(r)return r;const s=Date.now();if(r=this.jwks.keys.find(l=>l.kid===e),r&&this.jwks_cached_at+Iv>s)return r;const{data:o,error:i}=await $e(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=s,r=o.keys.find(l=>l.kid===e),!r)?null:r}async getClaims(e,n={}){try{let r=e;if(!r){const{data:g,error:b}=await this.getSession();if(b||!g.session)return{data:null,error:b};r=g.session.access_token}const{header:s,payload:o,signature:i,raw:{header:l,payload:u}}=zl(r);n!=null&&n.allowExpired||ix(o.exp);const c=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!c){const{error:g}=await this.getUser(r);if(g)throw g;return{data:{claims:o,header:s,signature:i},error:null}}const d=ax(s.alg),h=await crypto.subtle.importKey("jwk",c,d,!0,["verify"]);if(!await crypto.subtle.verify(d,h,i,qv(`${l}.${u}`)))throw new tc("Invalid JWT signature");return{data:{claims:o,header:s,signature:i},error:null}}catch(r){if(Re(r))return{data:null,error:r};throw r}}}pi.nextInstanceID=0;const _x=pi;class kx extends _x{constructor(e){super(e)}}var Ex=function(t,e,n,r){function s(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?o(d.value):s(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};class jx{constructor(e,n,r){var s,o,i;this.supabaseUrl=e,this.supabaseKey=n;const l=Av(e);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const u=`sb-${l.hostname.split(".")[0]}-auth-token`,c={db:wv,realtime:_v,auth:Object.assign(Object.assign({},Sv),{storageKey:u}),global:bv},d=Dv(r??{},c);this.storageKey=(s=d.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(o=d.global.headers)!==null&&o!==void 0?o:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(h,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=d.auth)!==null&&i!==void 0?i:{},this.headers,d.global.fetch),this.fetch=Cv(n,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new Fy(new URL("rest/v1",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new yv(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new xy(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r={}){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return Ex(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:s,userStorage:o,storageKey:i,flowType:l,lock:u,debug:c},d,h){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new kx({url:this.authUrl.href,headers:Object.assign(Object.assign({},p),d),storageKey:i,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:s,userStorage:o,flowType:l,lock:u,debug:c,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(g=>g.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new sv(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Cx=(t,e,n)=>new jx(t,e,n);function Rx(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}Rx()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Nx="https://wjylzxsfevdlhqunvfqc.supabase.co",Dx="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndqeWx6eHNmZXZkbGhxdW52ZnFjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg2ODMwOTEsImV4cCI6MjA3NDI1OTA5MX0.SuB0gd7-gefwpUHFnKsupDgo8P2VeLuMbdlsU6AMrLw",Of=globalThis,Fe=Of.__sg_supabase||(Of.__sg_supabase=Cx(Nx,Dx,{auth:{persistSession:!0,autoRefreshToken:!0,storageKey:"salesgame-auth"},realtime:{params:{eventsPerSecond:10}}}));function Ax(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,8)}`}function mi(){const t="sg_tab_player_id";let e=sessionStorage.getItem(t);return e||(e=Ax(),sessionStorage.setItem(t,e)),e}const Ox="sg:playerName";function Am(t){const e=String(t??"").trim();if(e){try{localStorage.setItem(Ox,e)}catch{}try{sessionStorage.setItem("sg_tab_player_name",e)}catch{}}return e}const Tx="/dynamic-data-visualization-3d.jpg",Px="/SalesGame_Logo-removebg-preview.png",Lx="/Multiplier-Copia.png",Ix="/WhatsApp_Image_2025-06-24_at_16.47.00-removebg-preview.png";function $x({onEnter:t}){const[e,n]=j.useState(""),r=j.useRef(null);j.useEffect(()=>{var l;(l=r.current)==null||l.focus()},[]);function s(){const l=(e||"").trim();l&&(Am(l),t==null||t(l))}function o(l){l.key==="Enter"&&s()}const i=(e||"").trim().length>0;return a.jsxs("div",{className:"start",children:[a.jsx("img",{className:"startBg",src:Tx,alt:""}),a.jsx("div",{className:"startShade"}),a.jsx("div",{className:"startHeader",children:a.jsx("img",{className:"startLogo",src:Px,alt:"Sales GAME"})}),a.jsx("div",{className:"startCenter",children:a.jsxs("div",{className:"startCard",children:[a.jsx("label",{className:"startLabel",htmlFor:"playerName",children:"Nome do Jogador"}),a.jsx("input",{id:"playerName",ref:r,className:"startInput",placeholder:"Digite seu nome",value:e,onChange:l=>n(l.target.value),onKeyDown:o,maxLength:30}),a.jsx("button",{className:"startBtn",onClick:s,disabled:!i,"aria-disabled":!i,children:"Entrar"})]})}),a.jsxs("div",{className:"startFooter",children:[a.jsxs("div",{className:"startLinks",children:[a.jsx("div",{children:"@multiplier.educacao"}),a.jsx("div",{children:"https://multipliereducacao.com.br/"})]}),a.jsx("div",{className:"startBrand",children:a.jsx("img",{className:"startBrandLogo",src:Lx,alt:"Multiplier"})})]}),a.jsx("img",{className:"startCoach",src:Ix,alt:"",draggable:"false"})]})}async function Mx(){const{data:t,error:e}=await Fe.from("lobbies").select(`
      id,
      name,
      max_players,
      status,
      created_at,
      lobby_players!left(count)
    `).order("created_at",{ascending:!0});if(e)throw e;return(t||[]).map(n=>{var r,s;return{id:n.id,name:n.name,max:n.max_players,status:n.status||"open",players:(((s=(r=n.lobby_players)==null?void 0:r[0])==null?void 0:s.count)??0)|0}})}function Bx(t){const e=Fe.channel("lobbies-list").on("postgres_changes",{event:"*",schema:"public",table:"lobbies"},()=>t==null?void 0:t()).on("postgres_changes",{event:"*",schema:"public",table:"lobby_players"},()=>t==null?void 0:t()).subscribe();return()=>Fe.removeChannel(e)}async function Ux({name:t,hostId:e,max:n=4}){if(!e)throw new Error("hostId obrigatrio em createLobby");const s={id:typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,8)}`,name:t,host_id:e,max_players:Number(n)||4,status:"open",created_at:new Date().toISOString()},{data:o,error:i}=await Fe.from("lobbies").insert(s).select("id").single();if(i)throw i;return o.id}async function nc({lobbyId:t,playerId:e,playerName:n,ready:r=!1}){const{data:s,error:o}=await Fe.from("lobbies").select("id, max_players, status, host_id").eq("id",t).single();if(o)throw o;if(s.status!=="open")throw new Error("Sala fechada.");const{count:i,error:l}=await Fe.from("lobby_players").select("lobby_id",{count:"exact",head:!0}).eq("lobby_id",t);if(l)throw l;if((i||0)>=s.max_players)throw new Error("Sala cheia.");try{window.__MY_UID=e}catch{}const{error:u}=await Fe.from("lobby_players").upsert({lobby_id:t,player_id:e,player_name:n,ready:!!r,joined_at:new Date().toISOString()},{onConflict:"lobby_id,player_id"});if(u)throw u;s.host_id||await Fe.from("lobbies").update({host_id:e}).eq("id",t)}async function Tf({lobbyId:t,playerId:e}){var l;const{data:n,error:r}=await Fe.from("lobbies").select("id, host_id").eq("id",t).single();if(r)throw r;const{error:s}=await Fe.from("lobby_players").delete().match({lobby_id:t,player_id:e});if(s)throw s;const{data:o,error:i}=await Fe.from("lobby_players").select("player_id, joined_at").eq("lobby_id",t).order("joined_at",{ascending:!0});if(i)throw i;if(!o||o.length===0){await Fe.from("lobbies").delete().eq("id",t);return}if((n==null?void 0:n.host_id)===e){const u=(l=o[0])==null?void 0:l.player_id;u&&await Fe.from("lobbies").update({host_id:u}).eq("id",t)}}async function Pf(t){const{data:e,error:n}=await Fe.from("lobby_players").select("player_id, player_name, ready, joined_at").eq("lobby_id",t).order("joined_at",{ascending:!0});if(n)throw n;return e||[]}async function Fx({lobbyId:t,playerId:e,ready:n}){const{error:r}=await Fe.from("lobby_players").update({ready:n}).match({lobby_id:t,player_id:e});if(r)throw r}async function zx(t,e,n){return Fx({lobbyId:t,playerId:e,ready:n})}async function Wx({lobbyId:t,playerId:e,playerName:n}){const{error:r}=await Fe.from("lobby_players").update({player_name:n}).match({lobby_id:t,player_id:e});if(r)throw r}async function Lf(t,e){const{error:n}=await Fe.from("lobbies").update({status:e}).eq("id",t);if(n)throw n}function Vx(t,e){let n=0;const r=()=>{n&&cancelAnimationFrame(n),n=requestAnimationFrame(()=>e==null?void 0:e())},s=Fe.channel(`lobby-${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"lobby_players",filter:`lobby_id=eq.${t}`},o=>{console.debug("[rt] lobby_players:INSERT",o.new),r()}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"lobby_players",filter:`lobby_id=eq.${t}`},o=>{console.debug("[rt] lobby_players:UPDATE",o.new),r()}).on("postgres_changes",{event:"DELETE",schema:"public",table:"lobby_players",filter:`lobby_id=eq.${t}`},o=>{console.debug("[rt] lobby_players:DELETE",o.old),r()}).on("postgres_changes",{event:"*",schema:"public",table:"lobbies",filter:`id=eq.${t}`},o=>{console.debug("[rt] lobbies:*",o.new||o.old),r()}).subscribe();return()=>{n&&cancelAnimationFrame(n),Fe.removeChannel(s)}}async function Gx(t){const{data:e,error:n}=await Fe.from("lobbies").select("id,name,status,max_players,host_id,created_at").eq("id",t).single();if(n)throw n;return e}async function qx({lobbyId:t}){var s;const{data:e}=await Fe.from("lobby_players").select("player_id, player_name, ready").eq("lobby_id",t),{data:n,error:r}=await Fe.from("matches").insert({lobby_id:t,host_id:((s=e==null?void 0:e[0])==null?void 0:s.player_id)||null,state:{players:e},created_at:new Date().toISOString()}).select("id").single();if(r)throw r;return n}async function Hx(t){const{data:e,error:n}=await Fe.from("matches").select("id, lobby_id, created_at").eq("lobby_id",t).order("created_at",{ascending:!1}).limit(1);if(n)throw n;return(e==null?void 0:e[0])||null}async function Gl({roomCode:t,playerId:e}){if(!t||!e){console.log("[leaveRoom] Parmetros invlidos:",{roomCode:t,playerId:e});return}try{console.log(`[leaveRoom] Tentando remover jogador ${e} da sala ${t}`);const{data:n,error:r}=await Fe.from("lobbies").select("id, name, host_id").eq("id",t).single();if(r){console.warn("[leaveRoom] Erro ao buscar lobby:",r);return}if(!n){console.log(`[leaveRoom] Lobby ${t} no encontrado`);return}console.log("[leaveRoom] Lobby encontrado:",n);const{error:s}=await Fe.from("lobby_players").delete().match({lobby_id:t,player_id:e});s?console.warn("[leaveRoom] Erro ao remover jogador:",s):console.log(`[leaveRoom] Jogador ${e} removido do lobby ${t}`);const{data:o,error:i}=await Fe.from("lobby_players").select("player_id").eq("lobby_id",t);if(i){console.warn("[leaveRoom] Erro ao contar jogadores restantes:",i);return}if(!o||o.length===0){const{error:l}=await Fe.from("lobbies").delete().eq("id",t);l?console.warn("[leaveRoom] Erro ao deletar lobby vazio:",l):console.log(`[leaveRoom] Lobby ${t} deletado com sucesso (sem jogadores)`)}else if(console.log(`[leaveRoom] Jogador ${e} saiu do lobby ${t}. Restam ${o.length} jogadores.`),n.host_id===e&&o.length>0){const l=o[0].player_id,{error:u}=await Fe.from("lobbies").update({host_id:l}).eq("id",t);u?console.warn("[leaveRoom] Erro ao transferir host:",u):console.log(`[leaveRoom] Host transferido para ${l}`)}}catch(n){console.error("[leaveRoom] Erro inesperado:",n)}}function Kx({onEnterRoom:t,playerName:e}){const[n,r]=j.useState([]),[s,o]=j.useState(!1);async function i(){o(!0);try{const d=await Mx();r(d)}finally{o(!1)}}j.useEffect(()=>(i(),Bx(()=>i())),[]);async function l(){const d=String(e||"").trim();if(!d){alert("Digite seu nome na tela inicial antes de criar/entrar em salas.");return}const h=`Sala de ${d}`,p=prompt("Nome do lobby:",h)||h,g=mi();try{const b=await Ux({name:p,hostId:g,max:4});await nc({lobbyId:b,playerId:g,playerName:d,ready:!1}),t==null||t(b)}catch(b){alert(b.message||"No foi possvel criar o lobby."),await i()}}async function u(d){try{const h=String(e||"").trim();if(!h){alert("Digite seu nome na tela inicial antes de entrar em salas.");return}const p=mi();await nc({lobbyId:d,playerId:p,playerName:h,ready:!1}),t==null||t(d)}catch(h){alert(h.message||"No foi possvel entrar no lobby.")}}const c={page:{minHeight:"100vh",background:"#0f0f12",color:"#e9ecf1",padding:"32px 16px",display:"flex",justifyContent:"center"},container:{width:"100%",maxWidth:980},headerRow:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:16,marginBottom:16,flexWrap:"wrap"},title:{fontSize:28,fontWeight:800,color:"#fff"},actions:{display:"flex",gap:10},btn:{padding:"12px 16px",border:0,borderRadius:12,fontWeight:800,cursor:"pointer"},btnPrimary:{background:"#4f46e5",color:"#fff",boxShadow:"0 8px 24px rgba(79,70,229,.25)"},btnSecondary:{background:"#20222a",color:"#fff",border:"1px solid #2b2e38"},grid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:14},card:{background:"linear-gradient(180deg, rgba(255,255,255,0.02) 0%, rgba(255,255,255,0.00) 100%)",border:"1px solid rgba(255,255,255,.08)",borderRadius:16,padding:16,display:"flex",flexDirection:"column",gap:12,boxShadow:"0 10px 20px rgba(0,0,0,.25)"},cardHeader:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:10},lobbyName:{fontSize:18,fontWeight:800,color:"#fff",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:1},meta:{fontSize:13,color:"#b8c0cc"},joinBtn:{padding:"10px 14px",borderRadius:10,border:0,background:"#7c3aed",color:"#fff",fontWeight:800,cursor:"pointer",boxShadow:"0 10px 20px rgba(124,58,237,.25)"},disabled:{opacity:.6,cursor:"not-allowed",filter:"grayscale(.3)"},empty:{marginTop:24,padding:18,borderRadius:12,border:"1px dashed rgba(255,255,255,.12)",color:"#c7cfdb",textAlign:"center"}};return a.jsx("div",{style:c.page,children:a.jsxs("div",{style:c.container,children:[a.jsxs("div",{style:c.headerRow,children:[a.jsx("h2",{style:c.title,children:"SalesGame  Lobbies"}),a.jsxs("div",{style:c.actions,children:[a.jsx("button",{style:{...c.btn,...c.btnPrimary},onClick:l,children:"Criar Lobby"}),a.jsx("button",{style:{...c.btn,...c.btnSecondary},onClick:i,disabled:s,children:s?"Atualizando":"Atualizar"})]})]}),n.length===0&&!s?a.jsxs("div",{style:c.empty,children:["Nenhuma sala criada ainda. Clique em ",a.jsx("b",{children:"Criar Lobby"})," para comear."]}):a.jsx("div",{style:c.grid,children:n.map(d=>{const h=(d.players??0)>=(d.max??4),p=(d.status??"open")==="open",g=h||!p;return a.jsxs("div",{style:c.card,children:[a.jsxs("div",{style:c.cardHeader,children:[a.jsx("div",{style:c.lobbyName,title:d.name,children:d.name}),a.jsxs("span",{style:c.meta,children:[d.players??0,"/",d.max??4]})]}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("span",{style:c.meta,children:["status: ",d.status??"open"]}),a.jsx("button",{style:{...c.joinBtn,...g?c.disabled:{}},disabled:g,onClick:()=>u(d.id),title:g?h?"Sala cheia":"Sala no est aberta":"Entrar na sala",children:"Entrar"})]})]},d.id)})})]})})}function Jx({lobbyId:t,playerName:e,onBack:n,onStartGame:r}){const s=mi(),o=String(e||"").trim(),[i,l]=j.useState(null),[u,c]=j.useState([]),[d,h]=j.useState(!0),[p,g]=j.useState(!1),b=j.useRef(!1),x=j.useRef(!0),S=j.useRef(!1),y=j.useRef(!1),f=j.useMemo(()=>(i==null?void 0:i.host_id)===s,[i,s]),m=j.useMemo(()=>u.find(P=>P.player_id===s),[u,s]),w=j.useMemo(()=>u.filter(P=>P.ready).length,[u]),k=j.useMemo(()=>{const P=u.map(I=>String(I.player_name||"").trim().toLowerCase()).filter(Boolean);return new Set(P).size!==P.length},[u]),D=f&&(i==null?void 0:i.status)==="open"&&u.length>=1&&w===u.length;j.useEffect(()=>{o||(alert("Digite seu nome primeiro."),n==null||n())},[o]),console.log("[PlayersLobby] Debug:",{players:u.length,readyCount:w,lobbyStatus:i==null?void 0:i.status,amHost:f,canStart:D,meId:s,meName:o});async function R(P){if(y.current)return;const I=await Hx(t);if(I!=null&&I.id){y.current=!0;const H=(P||[]).map((X,ke)=>({id:X.player_id,name:X.player_name,index:ke}));r==null||r({lobbyId:t,matchId:I==null?void 0:I.id,players:H,me:{id:s,name:o}})}}async function E(){x.current&&h(!0);try{console.log("[PlayersLobby] refreshAll - buscando lobby:",t);const[P,I]=await Promise.all([Gx(t),Pf(t)]);console.log("[PlayersLobby] refreshAll - lobby:",P,"players:",I),l(P),c(I);const H=I.find(X=>X.player_id===s);if(console.log("[PlayersLobby] refreshAll - mine:",H,"meId:",s),!H&&!b.current&&(P==null?void 0:P.status)==="open"){console.log("[PlayersLobby] refreshAll - entrando na sala"),b.current=!0;try{await nc({lobbyId:t,playerId:s,playerName:o,ready:!1}),console.log("[PlayersLobby] refreshAll - entrada na sala bem-sucedida");const X=await Pf(t);console.log("[PlayersLobby] refreshAll - jogadores aps entrada:",X),c(X)}catch(X){console.error("[PlayersLobby] refreshAll - erro ao entrar na sala:",X)}}if(H&&!S.current&&o&&H.player_name!==o){console.log("[PlayersLobby] refreshAll - sincronizando nome"),S.current=!0;try{await Wx({lobbyId:t,playerId:s,playerName:o})}catch{}}await R(I)}catch(P){console.error("[PlayersLobby] refreshAll - erro:",P)}finally{x.current&&(x.current=!1,h(!1))}}j.useEffect(()=>{const P=()=>{Tf({lobbyId:t,playerId:s}).catch(()=>{})},I=()=>P();return window.addEventListener("pagehide",I),window.addEventListener("beforeunload",I),()=>{window.removeEventListener("pagehide",I),window.removeEventListener("beforeunload",I)}},[t,s]),j.useEffect(()=>(b.current=!1,x.current=!0,S.current=!1,y.current=!1,E(),Vx(t,()=>E())),[t]);async function N(P){if(!m)return;g(!0);const I=m.ready;c(H=>H.map(X=>X.player_id===s?{...X,ready:P}:X));try{await zx(t,s,P)}catch(H){c(X=>X.map(ke=>ke.player_id===s?{...ke,ready:I}:ke)),console.error("setReadyUI failed",H)}finally{g(!1)}}async function v(){try{await Tf({lobbyId:t,playerId:s})}finally{n==null||n()}}async function C(){if(!D)return;const P=i==null?void 0:i.status;await Lf(t,"locked");try{const I=await qx({lobbyId:t});y.current=!0;const H=u.map((X,ke)=>({id:X.player_id,name:X.player_name,index:ke}));r==null||r({lobbyId:t,matchId:I==null?void 0:I.id,players:H,me:{id:s,name:o}})}catch(I){console.error("startMatch failed",I),await Lf(t,P||"open")}}return a.jsx("div",{style:qe.page,children:a.jsxs("div",{style:qe.container,children:[a.jsxs("div",{style:qe.top,children:[a.jsx("button",{style:qe.backBtn,onClick:v,children:" Voltar"}),a.jsxs("h2",{style:qe.title,children:["SalesGame  ",(i==null?void 0:i.name)||"..."]})]}),a.jsxs("div",{style:qe.table,children:[a.jsxs("div",{style:qe.thead,children:[a.jsx("div",{style:qe.colPlayer,children:"Jogador"}),a.jsx("div",{style:qe.colReady,children:"Pronto?"})]}),d?a.jsx("div",{style:qe.loading,children:"Carregando..."}):u.map(P=>a.jsxs("div",{style:qe.row,children:[a.jsxs("div",{style:qe.colPlayer,children:[a.jsx("span",{style:qe.avatar,children:(P.player_name||"?").slice(0,2).toLowerCase()}),a.jsx("span",{children:P.player_name||"Annimo"}),(i==null?void 0:i.host_id)===P.player_id&&a.jsx("span",{style:qe.badgeHost,children:"Host"}),P.player_id===s&&a.jsx("span",{style:qe.badgeYou,children:"Voc"})]}),a.jsx("div",{style:qe.colReady,children:P.player_id===s?a.jsxs("div",{style:{display:"flex",gap:8},children:[a.jsx("button",{style:{...qe.btn,...m!=null&&m.ready?qe.btnGhost:qe.btnDark},onClick:()=>N(!1),disabled:p||!(m!=null&&m.ready),children:"No pronto"}),a.jsxs("button",{style:{...qe.btn,...m!=null&&m.ready?qe.btnPrimary:qe.btnPurple},onClick:()=>N(!0),disabled:p||!!(m!=null&&m.ready),children:[" ",m!=null&&m.ready?"Pronto":"Ficar pronto"]})]}):a.jsx("span",{style:P.ready?qe.pillReady:qe.pillWait,children:P.ready?"Pronto":"Aguardando"})})]},P.player_id))]}),a.jsxs("div",{style:qe.footer,children:[a.jsxs("div",{style:qe.statusWrap,children:[a.jsx("span",{style:{...qe.dot,background:(i==null?void 0:i.status)==="open"?"#22c55e":"#f59e0b"}}),a.jsxs("span",{children:["status: ",(i==null?void 0:i.status)||"..."]}),a.jsxs("span",{style:{marginLeft:12},children:["Prontos: ",w,"/",u.length]})]}),k&&a.jsx("div",{style:{marginTop:8,color:"#ffd54f",fontWeight:800},children:" Aviso: existe nome duplicado na sala. (A identidade  pelo ID; renomear evita confuso.)"}),a.jsxs("div",{style:{display:"flex",gap:12},children:[a.jsx("button",{style:{...qe.btn,...D?qe.btnPrimary:qe.disabled},onClick:C,disabled:!D,children:"Iniciar partida"}),a.jsx("button",{style:{...qe.btn,...qe.btnDark},onClick:v,children:"Sair da sala"})]})]})]})})}const qe={page:{minHeight:"100vh",background:"#0f0f12",color:"#e9ecf1",padding:"24px 16px",display:"flex",justifyContent:"center"},container:{width:"100%",maxWidth:980},top:{display:"flex",alignItems:"center",gap:12,marginBottom:16},backBtn:{padding:"10px 14px",background:"#20222a",border:"1px solid #2b2e38",borderRadius:12,color:"#fff",cursor:"pointer"},title:{margin:0,fontSize:28,fontWeight:800},table:{background:"rgba(255,255,255,.02)",border:"1px solid rgba(255,255,255,.08)",borderRadius:16,overflow:"hidden"},thead:{display:"grid",gridTemplateColumns:"1fr 220px",padding:"12px 16px",borderBottom:"1px solid rgba(255,255,255,.08)",color:"#c7cfdb"},row:{display:"grid",gridTemplateColumns:"1fr 220px",padding:"12px 16px",borderBottom:"1px solid rgba(255,255,255,.06)"},colPlayer:{display:"flex",alignItems:"center",gap:10,minWidth:0},colReady:{display:"flex",alignItems:"center",justifyContent:"flex-end"},avatar:{width:28,height:28,borderRadius:999,background:"#1f2430",display:"grid",placeItems:"center",color:"#c7cfdb",fontSize:12,textTransform:"lowercase"},badgeHost:{marginLeft:8,fontSize:12,background:"#fde68a",color:"#111827",padding:"2px 8px",borderRadius:999,fontWeight:800},badgeYou:{marginLeft:8,fontSize:12,background:"#bfdbfe",color:"#111827",padding:"2px 8px",borderRadius:999,fontWeight:800},loading:{padding:16,color:"#c7cfdb"},pillReady:{background:"rgba(34,197,94,.15)",color:"#22c55e",padding:"6px 10px",borderRadius:999,fontWeight:700},pillWait:{background:"rgba(245,158,11,.14)",color:"#f59e0b",padding:"6px 10px",borderRadius:999,fontWeight:700},footer:{display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:16},statusWrap:{display:"flex",alignItems:"center",gap:6,color:"#c7cfdb"},dot:{width:8,height:8,borderRadius:"50%"},btn:{padding:"12px 16px",border:0,borderRadius:12,fontWeight:800,cursor:"pointer"},btnPrimary:{background:"#4f46e5",color:"#fff",boxShadow:"0 8px 24px rgba(79,70,229,.25)"},btnPurple:{background:"#7c3aed",color:"#fff"},btnDark:{background:"#20222a",color:"#fff",border:"1px solid #2b2e38"},btnGhost:{background:"transparent",color:"#e9ecf1",border:"1px solid rgba(255,255,255,.15)"},disabled:{opacity:.5,cursor:"not-allowed",filter:"grayscale(.25)"}},Yx="/board.jpg",rc=800,sc=700,il=[{nx:.9278494291885221,ny:.9008218764923216},{nx:.8188460351743289,ny:.9120818357755046},{nx:.7145819191607529,ny:.920124663834921},{nx:.6016291268127121,ny:.920124663834921},{nx:.49104597346497997,ny:.9233417950586875},{nx:.37888306078370876,ny:.920124663834921},{nx:.24618327676643012,ny:.9152989669992712},{nx:.21695772909595804,ny:.7994822429436751},{nx:.1853625424251774,ny:.7270967904089275},{nx:.1340203640851589,ny:.6354085505315806},{nx:.12851782363977485,ny:.5145797598627787},{nx:.12664165103189493,ny:.37392795883361923},{nx:.05347091932457786,ny:.30017152658662094},{nx:.051594746716697934,ny:.20240137221269297},{nx:.14540337711069418,ny:.12006861063464837},{nx:.23921200750469043,ny:.11663807890222985},{nx:.3771106941838649,ny:.11663807890222985},{nx:.5037523452157598,ny:.12006861063464837},{nx:.5975609756097561,ny:.1320754716981132},{nx:.5984990619136961,ny:.24356775300171526},{nx:.5065666041275797,ny:.2692967409948542},{nx:.398686679174484,ny:.27101200686106347},{nx:.28893058161350843,ny:.27101200686106347},{nx:.2373358348968105,ny:.3687821612349914},{nx:.23921200750469043,ny:.48027444253859347},{nx:.24202626641651032,ny:.5660377358490566},{nx:.26454033771106944,ny:.6895368782161235},{nx:.3330206378986867,ny:.6946826758147513},{nx:.35647279549718575,ny:.5831903945111492},{nx:.35647279549718575,ny:.4716981132075472},{nx:.3818011257035647,ny:.37735849056603776},{nx:.5225140712945591,ny:.3653516295025729},{nx:.6238273921200751,ny:.3687821612349914},{nx:.7223264540337712,ny:.40308747855917665},{nx:.6613508442776735,ny:.5197255574614065},{nx:.5300187617260788,ny:.5025728987993139},{nx:.4427767354596623,ny:.5694682675814752},{nx:.4896810506566604,ny:.6861063464837049},{nx:.6163227016885553,ny:.6861063464837049},{nx:.724202626641651,ny:.6861063464837049},{nx:.8273921200750469,ny:.660377358490566},{nx:.8395872420262664,ny:.5368782161234992},{nx:.8395872420262664,ny:.4339622641509434},{nx:.8283302063789869,ny:.313893653516295},{nx:.7176360225140713,ny:.30017152658662094},{nx:.6876172607879925,ny:.22298456260720412},{nx:.698874296435272,ny:.1457975986277873},{nx:.8020637898686679,ny:.11663807890222985},{nx:.8958724202626641,ny:.11663807890222985},{nx:.9446529080675422,ny:.21783876500857632},{nx:.9446529080675422,ny:.3293310463121784},{nx:.9380863039399625,ny:.45797598627787306},{nx:.9409005628517824,ny:.5711835334476844},{nx:.950281425891182,ny:.6723842195540308},{nx:.9540337711069419,ny:.7804459691252144}],xs=il.length;function Om(t,e,n){return{x:t.nx*e,y:t.ny*n}}il.map(t=>[t.nx*rc,t.ny*sc]);function Qx({visible:t=!0,boardWidth:e,boardHeight:n}){return t?a.jsx("div",{className:"markersLayer",children:il.map((r,s)=>{const{x:o,y:i}=Om(r,e,n);return a.jsx("div",{className:"marker",style:{left:o,top:i},title:`Casa ${s+1}`,children:s+1},s)})}):null}function Xx({boardRef:t,expected:e=55,onFinish:n,initial:r=[]}){const[s,o]=j.useState(r);function i(g){if(!(t!=null&&t.current))return;const b=t.current.getBoundingClientRect(),x=g.clientX-b.left,S=g.clientY-b.top,y=x/b.width,f=S/b.height;o(m=>m.length>=e?m:[...m,{nx:y,ny:f}])}function l(){o(g=>g.slice(0,-1))}function u(){o([])}const c=j.useMemo(()=>JSON.stringify(s,null,2),[s]);async function d(){try{await navigator.clipboard.writeText(c),alert("Copiado para a rea de transferncia!")}catch{alert("No foi possvel copiar. Use o boto Baixar.")}}function h(){const g=new Blob([c],{type:"application/json"}),b=URL.createObjectURL(g),x=document.createElement("a");x.href=b,x.download="track-points-55.json",document.body.appendChild(x),x.click(),x.remove(),URL.revokeObjectURL(b)}function p(){n==null||n(s),console.log(`TRACK_POINTS_NORM (cole em src/data/track.js):
`,c),alert("Finalizado! O JSON foi impresso no console. Copie e cole em src/data/track.js")}return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"recLayer",onClick:i}),a.jsx("div",{className:"recDotsLayer",pointerEvents:"none",children:s.map((g,b)=>a.jsx("div",{className:"recDot",style:{left:`${g.nx*100}%`,top:`${g.ny*100}%`},title:`Casa ${b+1}`,children:b+1},b))}),a.jsxs("div",{className:"recToolbar",children:[a.jsxs("div",{className:"recInfo",children:[a.jsx("b",{children:"Gravando trilha"}),"  clique nas casas na ordem.",a.jsxs("span",{children:["Marcados: ",a.jsx("b",{children:s.length})," / ",e]})]}),a.jsxs("div",{className:"recBtns",children:[a.jsx("button",{onClick:l,disabled:!s.length,children:"Desfazer"}),a.jsx("button",{onClick:u,disabled:!s.length,children:"Limpar"}),a.jsx("button",{onClick:d,disabled:!s.length,children:"Copiar JSON"}),a.jsx("button",{onClick:h,disabled:!s.length,children:"Baixar .json"}),a.jsx("button",{onClick:p,disabled:s.length!==e,children:"Finalizar"})]})]})]})}const Zx=40,eb=1.15,tb=3,nb="0 8px 18px rgba(0,0,0,.35)",If={cash:18e3,possibAt:0,clientsAt:0,faturamento:770,manutencao:1150,emprestimos:0,vendedoresComuns:0,fieldSales:0,insideSales:0,mixDBens:4e3,erpClientes:0,manualOnboarding:!0,azul:0,amarelo:0,roxo:0,gestores:0};function rb({players:t,turnIdx:e,recordTrack:n=!1,matchId:r,me:s,onMeHud:o}){const i=j.useRef(null),[l,u]=j.useState({w:rc,h:sc}),c=(s==null?void 0:s.id)||mi(),d="Jogador",h=j.useMemo(()=>(t==null?void 0:t.find(w=>w.id===c))||null,[t,c]),p=(s==null?void 0:s.name)||(h==null?void 0:h.name)||d,g=(h==null?void 0:h.color)||"#6c5ce7",b=j.useMemo(()=>`sg_stats_v1:${r||"local"}:${c}`,[r,c]),[x,S]=j.useState(()=>{try{const w=sessionStorage.getItem(b);return w?JSON.parse(w):If}catch{return If}});j.useEffect(()=>{try{sessionStorage.setItem(b,JSON.stringify(x))}catch{}},[b,x]),j.useEffect(()=>{const w={id:c,name:p,color:g,cash:x.cash,possibAt:x.possibAt,clientsAt:x.clientsAt,matchId:r||"local"};o==null||o(w),document.dispatchEvent(new CustomEvent("sg:meHud",{detail:w}))},[c,p,g,x.cash,x.possibAt,x.clientsAt,r]),j.useLayoutEffect(()=>{if(!i.current)return;const w=i.current,k=new ResizeObserver(D=>{for(const R of D){const E=R.contentRect;u({w:E.width,h:E.height})}});return k.observe(w),()=>k.disconnect()},[]);const y=l.w/rc,f=l.h/sc,m=Math.min(y,f);return a.jsxs("div",{className:"board",ref:i,children:[a.jsx("img",{src:Yx,alt:"Board",className:"boardImg"}),n&&a.jsx(Xx,{boardRef:i,expected:55,onFinish:w=>{console.log("TRACK_POINTS_NORM (cole em src/data/track.js):",JSON.stringify(w,null,2))}}),!n&&a.jsxs(a.Fragment,{children:[a.jsx(Qx,{visible:!1,boardWidth:l.w,boardHeight:l.h}),t.map((w,k)=>{var je;const D=(je=t==null?void 0:t[e])==null?void 0:je.id,R=String(w==null?void 0:w.id)===String(D),E=(w.pos%xs+xs)%xs,N=il[E],v=Om(N,l.w,l.h),C=k*12*m,I=Zx*m*(R?eb:1),H=Math.max(2,tb*m),X=["","","","","","","",""],ke=X[k%X.length];return a.jsx("div",{className:"token",style:{position:"absolute",left:v.x+C,top:v.y-C,transform:"translate(-50%, -50%)",width:I,height:I,borderRadius:"50%",background:w.color,border:`${H}px solid rgba(255,255,255,.95)`,boxShadow:nb,pointerEvents:"none",display:"grid",placeItems:"center",color:"#000",fontWeight:900,userSelect:"none",zIndex:R?4:3,fontSize:`${Math.max(16,I*.6)}px`},title:`${w.name}  Casa ${E+1}`,"aria-label":`${w.name} est na casa ${E+1}`,children:R?"":ke},w.id)})]})]})}function sb({totals:t,players:e}){return j.useEffect(()=>{console.groupCollapsed("[HUD] totals"),console.log(t),console.groupEnd()},[t]),a.jsxs("div",{className:"hud",children:[a.jsxs("div",{className:"panel",children:[a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Faturamento:"})," ",a.jsxs("span",{className:"pos",children:["$ ",t.faturamento]})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Manuteno:"})," ",a.jsxs("span",{className:"neg",children:["$ ",t.manutencao]})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Emprstimos:"})," ",a.jsxs("span",{children:["$ ",t.emprestimos]})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Vendedores Comuns:"})," ",a.jsx("span",{children:t.vendedoresComuns})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Field Sales:"})," ",a.jsx("span",{children:t.fieldSales})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Inside Sales:"})," ",a.jsx("span",{children:t.insideSales})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Mix Produtos:"})," ",a.jsx("span",{children:t.mixProdutos})," ",a.jsx("b",{children:" Bens:"})," ",a.jsxs("span",{children:["$ ",t.bens]})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"ERP/Sistemas:"})," ",a.jsx("span",{children:t.erpSistemas})," ",a.jsx("b",{children:" Clientes:"})," ",a.jsx("span",{children:t.clientes})]}),a.jsxs("div",{children:[a.jsx("b",{children:"Manual Onboarding:"})," "]}),a.jsxs("div",{children:[a.jsx("b",{children:"Azul:"})," ",a.jsx("span",{children:t.az||0})," ",a.jsx("b",{children:" Amarelo: "}),a.jsx("span",{children:t.am||0})," ",a.jsx("b",{children:"Roxo:"})," ",a.jsx("span",{children:t.rox||0})]}),a.jsxs("div",{children:[a.jsx("b",{children:"Gestores Comerciais:"})," ",a.jsx("span",{children:t.gestores??t.gestoresComerciais??0})]}),a.jsxs("div",{children:[a.jsx("b",{children:"Capacidade:"})," ",a.jsx("span",{children:t.possibAt??0}),"  ",a.jsx("b",{children:"Em Atendimento:"})," ",a.jsx("span",{children:t.clientsAt??0})]})]}),a.jsxs("div",{className:"score",children:[a.jsx("div",{className:"title",children:"Placar"}),e.map(n=>a.jsxs("div",{className:"row",children:[a.jsx("span",{children:n.name}),a.jsx("span",{children:n.cash})]},n.id))]})]})}function ob({onAction:t,current:e,isMyTurn:n=!1,myUid:r,turnPlayerId:s,turnLock:o=!1,lockOwner:i=null,modalLocks:l=0,gameOver:u=!1}){const c=!!(e!=null&&e.bankrupt),d=s!=null&&r!=null&&String(s)===String(r),h=!!s&&d&&o===!1&&Number(l||0)===0&&u!==!0&&!c;j.useEffect(()=>{console.log("[CAN_ROLL_CHECK]",{myUid:r,turnPlayerId:s,isMyTurn:d,turnLock:o,modalLocks:l,gameOver:u,bankrupt:c,result:h})},[r,s,d,o,l,u,c,h]);const p=()=>{if(console.log("[Controls] click => Rolar Dado & Andar (canRoll=%s)",h),!h)return;if(s!=null&&r!=null&&String(s)!==String(r)){console.warn("[ROLL_BLOCK][Controls] not my turn",{turnPlayerId:s,myUid:r});return}if(o)return;const x=Math.floor(Math.random()*6)+1,S=0,y=`Dado: ${x}`;console.log("[Controls] onAction ROLL => steps=%d cashDelta=%d note=%s",x,S,y),t==null||t({type:"ROLL",steps:x,cashDelta:S,note:y})},g=async()=>{c||(console.log("[Controls] click => Recuperao Financeira"),t==null||t({type:"RECOVERY_MODAL"}))},b=async()=>{c||(console.log("[Controls] click => Declarar Falncia"),t==null||t({type:"BANKRUPT_MODAL"}))};return a.jsxs("div",{className:`controls ${h?"":"is-wait"} ${c?"is-bankrupt":""}`,children:[a.jsx("button",{className:"btn primary",onClick:g,disabled:c,"aria-disabled":c,children:"RECUPERAO FINANCEIRA"}),a.jsx("button",{className:"btn dark",onClick:b,disabled:c,"aria-disabled":c,children:"DECLARAR FALNCIA"}),a.jsxs("div",{className:"turnBox",children:[a.jsxs("div",{children:["Vez de: ",a.jsx("b",{children:e==null?void 0:e.name})]}),a.jsx("button",{className:"btn go",onClick:p,disabled:!h,"aria-disabled":!h,children:"Rolar Dado & Andar"})]})]})}function ki({children:t,onClose:e,zIndex:n=3e3}){const r=()=>{typeof e=="function"&&e()};return a.jsx("div",{className:"sg-modal-backdrop",style:{position:"fixed",inset:0,background:"rgba(8,10,16,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:n},onClick:r,children:a.jsx("div",{className:"sg-modal-card",style:{position:"relative",background:"#0f1420",border:"1px solid rgba(255,255,255,.1)",borderRadius:14,width:"min(780px, 92vw)",maxWidth:"92vw",color:"#fff",boxShadow:"0 20px 60px rgba(0,0,0,.45)"},onClick:s=>s.stopPropagation(),children:t})})}function ib({players:t=[],onExit:e,onResolve:n}){const r=j.useMemo(()=>{const u=[...t].map(c=>({...c,patrimonio:(Number(c.cash)||0)+(Number(c.bens)||0)})).sort((c,d)=>d.patrimonio-c.patrimonio);return[u[1],u[0],u[2]]},[t]),s=r==null?void 0:r[1],o=r==null?void 0:r[0],i=r==null?void 0:r[2],l=()=>{n?n({action:"EXIT"}):e==null||e()};return a.jsx(ki,{zIndex:2147483647,onClose:()=>{},children:a.jsxs("div",{style:Yn.wrap,children:[a.jsx("h1",{style:Yn.title,children:" Fim da 5 Rodada"}),a.jsxs("p",{style:Yn.subtitle,children:["Vence quem tiver ",a.jsx("b",{children:"Saldo + Bens"}),". Eis o pdio:"]}),a.jsxs("div",{style:Yn.podium,children:[a.jsx(ql,{place:"second",player:o}),a.jsx(ql,{place:"first",player:s,big:!0}),a.jsx(ql,{place:"third",player:i})]}),a.jsx("div",{style:{display:"flex",gap:12,marginTop:18,flexWrap:"wrap",justifyContent:"center"},children:a.jsx("button",{style:Yn.btn,onClick:l,children:" Voltar aos Lobbies"})})]})})}function ql({place:t,player:e,big:n}){if(!e)return a.jsx("div",{style:{width:220}});const r={first:Hl("#d4af37","#f5d76e"),second:Hl("#9fa4ad","#cfd4db"),third:Hl("#b87333","#d28c45")},s={first:"1",second:"2",third:"3"}[t],o=r[t].ring,i=r[t].face;return a.jsxs("div",{style:{...Yn.medalCol,transform:n?"translateY(-18px)":"none"},children:[a.jsx("div",{style:Yn.ribbon}),a.jsx("div",{style:{...Yn.medal,...o,width:n?180:150,height:n?180:150},children:a.jsx("div",{style:{...Yn.medalFace,...i},children:a.jsx("div",{style:Yn.medalNumber,children:s})})}),a.jsxs("div",{style:Yn.cardBelow,children:[a.jsx("div",{style:{fontWeight:900,fontSize:16,lineHeight:1.2,textAlign:"center"},children:e.name}),a.jsxs("div",{style:{opacity:.9,fontSize:13,marginTop:4,textAlign:"center"},children:["Saldo: ",a.jsxs("b",{children:["$ ",Number(e.cash||0).toLocaleString()]}),a.jsx("br",{}),"Bens: ",a.jsxs("b",{children:["$ ",Number(e.bens||0).toLocaleString()]})]}),a.jsxs("div",{style:{marginTop:6,fontWeight:900,textAlign:"center"},children:["Patrimnio: ",a.jsxs("b",{children:["$ ",Number(e.patrimonio||0).toLocaleString()]})]})]})]})}function Hl(t,e){return{ring:{background:`radial-gradient(circle at 35% 30%, ${e} 0%, ${t} 65%, #000 120%)`,boxShadow:"0 12px 30px rgba(0,0,0,.35), inset 0 0 12px rgba(255,255,255,.12)"},face:{background:`conic-gradient(from 0deg, ${e}, ${t}, ${e})`}}}const Yn={wrap:{pointerEvents:"auto",border:"1px solid rgba(255,255,255,.15)",background:"#11161f",color:"#eef1f6",borderRadius:16,padding:20,width:"min(900px, 92vw)",maxWidth:"92vw",textAlign:"center"},title:{margin:"0 0 6px",fontWeight:900,fontSize:28},subtitle:{margin:"0 0 14px",opacity:.9},podium:{display:"flex",alignItems:"flex-end",justifyContent:"center",gap:24,padding:"10px 0",flexWrap:"wrap"},medalCol:{display:"flex",flexDirection:"column",alignItems:"center"},ribbon:{width:16,height:70,background:"linear-gradient(#e41f1f,#9e1313)",borderRadius:4,marginBottom:-12},medal:{borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",border:"3px solid rgba(255,255,255,.18)"},medalFace:{width:"85%",height:"85%",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"inset 0 8px 18px rgba(0,0,0,.35), inset 0 -6px 10px rgba(255,255,255,.08)"},medalNumber:{fontWeight:900,fontSize:28,letterSpacing:1,textShadow:"0 2px 4px rgba(0,0,0,.45)"},cardBelow:{background:"#19202c",border:"1px solid rgba(255,255,255,.12)",borderRadius:12,padding:"10px 12px",width:220,marginTop:10},btn:{background:"#2a3342",color:"#fff",border:"1px solid rgba(255,255,255,.18)",borderRadius:10,padding:"10px 14px",fontWeight:800,cursor:"pointer"}},Tm=j.createContext(null);function $o({children:t}){var b;const[e,n]=j.useState([]),r=j.useRef(e),s=j.useRef(new Map);j.useEffect(()=>{r.current=e},[e]);const o=()=>{try{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID()}catch{}return String(Date.now()+Math.random())},i=ue.useCallback((x,S)=>{const y=String(x??"");if(!y)return;const f=s.current.get(y);if(f){s.current.delete(y);try{f(S)}catch{}}n(m=>m.filter(w=>String(w.id)!==y))},[]),l=ue.useCallback(x=>{const S=r.current;if(!S||S.length===0)return;const y=S[S.length-1];i(y.id,x)},[i]),u=l,c=()=>l({action:"SKIP"}),d=()=>l(!1),h=x=>{const S=o(),y=ue.cloneElement(x,{onResolve:f=>i(S,f)});return n(f=>[...f,{id:S,el:y}]),S},p=()=>new Promise(x=>{const S=r.current;if(!S||S.length===0){x(null);return}const y=S[S.length-1];s.current.set(String(y.id),x)}),g=j.useMemo(()=>({pushModal:h,awaitTop:p,resolveTop:u,closeTop:l,closeModal:c,popModal:d,closeById:i}),[]);return a.jsxs(Tm.Provider,{value:g,children:[t,e.length>0&&a.jsxs("div",{style:{position:"fixed",inset:0,zIndex:9999,pointerEvents:"auto",display:"flex",alignItems:"center",justifyContent:"center"},children:[a.jsx("div",{"aria-hidden":"true",style:{position:"absolute",inset:0,background:"rgba(0,0,0,0.55)"}}),a.jsx("div",{style:{position:"relative",zIndex:1},children:(b=e[e.length-1])==null?void 0:b.el})]})]})}const An=()=>j.useContext(Tm);function ab({playerName:t="Jogador"}){const{resolveTop:e,closeModal:n}=An();return a.jsx(ki,{width:700,onClose:n,children:a.jsx("div",{className:"bankruptcyModal",children:a.jsxs("div",{className:"paper",style:{padding:24},children:[a.jsx("h2",{style:{marginTop:0},children:"Declarar Falncia"}),a.jsxs("p",{children:["Tem certeza que deseja declarar ",a.jsx("b",{children:"Falncia"}),", ",a.jsx("b",{children:t}),"?",a.jsx("br",{}),"Esta ao  irreversvel e voc no poder mais jogar."]}),a.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end",marginTop:24},children:[a.jsx("button",{onClick:()=>{n(),e(!1)},className:"btn",children:"Cancelar"}),a.jsx("button",{onClick:()=>{n(),e(!0)},className:"btn btn-danger",children:"Sim, declarar falncia"})]})]})})})}const Oe={comum:{cap:2,baseFat:600,incFat:100,baseDesp:1e3,incDesp:100},inside:{cap:5,baseFat:1500,incFat:500,baseDesp:2e3,incDesp:100},field:{cap:5,baseFat:1500,incFat:500,baseDesp:2e3,incDesp:100},gestor:{baseDesp:3e3,incDesp:500}},ur={A:{fat:1e3,desp:400},B:{fat:500,desp:200},C:{fat:200,desp:100},D:{fat:70,desp:50}},cr={A:{fatPerClient:1200,despPerClient:700},B:{fatPerClient:600,despPerClient:400},C:{fatPerClient:300,despPerClient:200},D:{fatPerClient:100,despPerClient:50}},$a=[0,.2,.3,.4,.6],Pm=7,dn=t=>Number(t||0),wr=(t={},e)=>{var n;return new Set(((n=t==null?void 0:t.trainingsByVendor)==null?void 0:n[e])||[]).size},lb=t=>wr(t,"gestor");function Ma(t={}){const e=Math.max(0,dn(t.vendedoresComuns)),n=Math.max(0,dn(t.insideSales)),r=Math.max(0,dn(t.fieldSales)),s=e*Oe.comum.cap,o=n*Oe.inside.cap,i=r*Oe.field.cap,l=s+o+i,u=Math.max(0,dn(t.clients)),c=Math.min(u,l);return{cap:l,inAtt:c}}function al(t={}){var E,N;const e=dn(t.vendedoresComuns),n=dn(t.insideSales),r=dn(t.fieldSales),s=dn(t.gestores??t.gestoresComerciais??t.managers),o=wr(t,"comum"),i=wr(t,"inside"),l=wr(t,"field"),u=wr(t,"gestor"),c=e*(Oe.comum.baseFat+Oe.comum.incFat*o),d=n*(Oe.inside.baseFat+Oe.inside.incFat*i),h=r*(Oe.field.baseFat+Oe.field.incFat*l);let p=c+d+h;const g=e+n+r,b=g>0?Math.min(1,s*Pm/g):0,x=Math.max(0,u),S=$a[Math.min(x,$a.length-1)]||0;p=p*(1+b*S);const y=String(t.mixProdutos||"D").toUpperCase(),f=(((E=cr[y])==null?void 0:E.fatPerClient)||0)*dn(t.clients),m=String(t.erpLevel||"D").toUpperCase(),w=g+s,k=(((N=ur[m])==null?void 0:N.fat)||0)*w,D=dn(t.revenue);return Math.max(0,Math.floor(p+f+k+D))}function ll(t={}){var k,D;const e=dn(t.vendedoresComuns),n=dn(t.insideSales),r=dn(t.fieldSales),s=dn(t.gestores??t.gestoresComerciais??t.managers),o=wr(t,"comum"),i=wr(t,"inside"),l=wr(t,"field"),u=wr(t,"gestor"),c=e*(Oe.comum.baseDesp+Oe.comum.incDesp*o),d=n*(Oe.inside.baseDesp+Oe.inside.incDesp*i),h=r*(Oe.field.baseDesp+Oe.field.incDesp*l),p=s*(Oe.gestor.baseDesp+Oe.gestor.incDesp*u),g=String(t.mixProdutos||"D").toUpperCase(),b=(((k=cr[g])==null?void 0:k.despPerClient)||0)*dn(t.clients),x=String(t.erpLevel||"D").toUpperCase(),S=e+n+r+s,y=(((D=ur[x])==null?void 0:D.desp)||0)*S;return Math.max(0,Math.floor(c+d+h+p+b+y+0+1e3))}function qt(t,e={}){var s,o;const n={...t},r=(i,l)=>{n[i]=(n[i]??0)+l};if(Number.isFinite(e.cashDelta)&&r("cash",Number(e.cashDelta)),Number.isFinite(e.clientsDelta)&&r("clients",Number(e.clientsDelta)),Number.isFinite(e.manutencaoDelta)&&r("manutencao",Number(e.manutencaoDelta)),Number.isFinite(e.bensDelta)&&r("bens",Number(e.bensDelta)),Number.isFinite(e.vendedoresComunsDelta)&&r("vendedoresComuns",Number(e.vendedoresComunsDelta)),Number.isFinite(e.fieldSalesDelta)&&r("fieldSales",Number(e.fieldSalesDelta)),Number.isFinite(e.insideSalesDelta)&&r("insideSales",Number(e.insideSalesDelta)),Number.isFinite(e.gestoresDelta)){const i=Number(e.gestoresDelta);n.gestores=(n.gestores??0)+i,n.gestoresComerciais=(n.gestoresComerciais??0)+i,n.managers=(n.managers??0)+i}if(Number.isFinite(e.revenueDelta)&&r("revenue",Number(e.revenueDelta)),typeof e.mixProdutosSet<"u"){n.mixProdutos=e.mixProdutosSet;const i=String(e.mixProdutosSet).toUpperCase();["A","B","C","D"].includes(i)&&(n.mixOwned={...n.mixOwned||{},[i]:!0},(s=n.reducedLevels)!=null&&s.MIX&&(n.reducedLevels={...n.reducedLevels,MIX:n.reducedLevels.MIX.filter(l=>l!==i)}))}if(e.mixBaseSet&&(n.mixBase={...n.mixBase||{},...e.mixBaseSet}),typeof e.erpLevelSet<"u"){n.erpLevel=e.erpLevelSet;const i=String(e.erpLevelSet).toUpperCase();["A","B","C","D"].includes(i)&&(n.erpOwned={...n.erpOwned||{},[i]:!0},(o=n.reducedLevels)!=null&&o.ERP&&(n.reducedLevels={...n.reducedLevels,ERP:n.reducedLevels.ERP.filter(l=>l!==i)}))}return Array.isArray(e.trainingsPush)&&e.trainingsPush.length&&(n.trainings=[...n.trainings||[],...e.trainingsPush]),Array.isArray(e.directBuysPush)&&e.directBuysPush.length&&(n.directBuys=[...n.directBuys||[],...e.directBuysPush]),n}function $f(t,e){const{purchases:n=[],grandTotal:r=0}=e||{},s={personalizado:"az",fieldsales:"am",imersaomultiplier:"rox"},o={...t};return o.cash=(o.cash??0)-Number(r||0),o.bens=(o.bens??0)+Number(r||0),o.onboarding=!0,n.forEach(i=>{var h;const{vendorType:l,items:u=[]}=i||{};u.forEach(p=>{const g=s[p==null?void 0:p.id];g&&(o[g]=(o[g]??0)+1)});const c=String(l||"comum"),d=new Set(((h=o.trainingsByVendor)==null?void 0:h[c])||[]);u.forEach(p=>{p!=null&&p.id&&d.add(p.id)}),o.trainingsByVendor={...o.trainingsByVendor||{},[c]:Array.from(d)}}),o}function Kl(t,e,n){return t===e?!1:t<e?n>t&&n<=e:n>t||n<=e}function Yo(t){return t.reduce((e,n)=>e+(n!=null&&n.bankrupt?0:1),0)}function Ao(t,e){var o;const n=t.length;if(n===0)return 0;let r=(e+1)%n,s=0;for(;s<n;){if(!((o=t[r])!=null&&o.bankrupt))return r;r=(r+1)%n,s++}return e}class Lm{constructor(){this.errors=[],this.warnings=[]}validateGameState(e,n,r,s,o){return this.errors=[],this.warnings=[],this.validatePlayers(e),this.validateTurnState(e,n),this.validateGameOverState(e,s,o),this.validateRoundState(e,r),{isValid:this.errors.length===0,errors:this.errors,warnings:this.warnings}}validatePlayers(e){if(!Array.isArray(e)||e.length===0){this.addError("Jogadores invlidos: deve ser um array no vazio");return}e.forEach((n,r)=>{this.validatePlayer(n,r)}),this.validatePlayerUniqueness(e),this.validateAlivePlayers(e)}validatePlayer(e,n){const r=`Jogador ${n+1} (${e.name||"Sem nome"})`;e.id||this.addError(`${r}: ID  obrigatrio`),(typeof e.cash!="number"||e.cash<0)&&this.addError(`${r}: Cash deve ser um nmero no negativo (atual: ${e.cash})`),(typeof e.clients!="number"||e.clients<0)&&this.addError(`${r}: Clientes deve ser um nmero no negativo (atual: ${e.clients})`),this.validateResourceCounts(e,r),this.validateCalculations(e,r)}validateResourceCounts(e,n){["vendedoresComuns","fieldSales","insideSales","gestores","gestoresComerciais","managers"].forEach(o=>{const i=e[o];i!==void 0&&(typeof i!="number"||i<0)&&this.addError(`${n}: ${o} deve ser um nmero no negativo (atual: ${i})`)}),["az","am","rox"].forEach(o=>{const i=e[o];i!==void 0&&(typeof i!="number"||i<0)&&this.addError(`${n}: Certificado ${o} deve ser um nmero no negativo (atual: ${i})`)})}validateCalculations(e,n){try{const r=al(e),s=ll(e),{cap:o,inAtt:i}=Ma(e);(typeof r!="number"||r<0)&&this.addError(`${n}: Faturamento calculado invlido: ${r}`),(typeof s!="number"||s<0)&&this.addError(`${n}: Manuteno calculada invlida: ${s}`),(typeof o!="number"||o<0)&&this.addError(`${n}: Capacidade calculada invlida: ${o}`),(typeof i!="number"||i<0||i>o)&&this.addError(`${n}: Clientes em atendimento invlido: ${i} (capacidade: ${o})`),this.isInitialState(e)&&s!==1150&&this.addError(`${n}: Manuteno inicial deve ser 1150, mas  ${s}`)}catch(r){this.addError(`${n}: Erro ao calcular faturamento/manuteno: ${r.message}`)}}isInitialState(e){return e.vendedoresComuns===1&&e.clients===1&&e.fieldSales===0&&e.insideSales===0&&e.gestores===0&&e.mixProdutos==="D"&&e.erpLevel==="D"&&(e.az||0)===0&&(e.am||0)===0&&(e.rox||0)===0}validatePlayerUniqueness(e){const n=e.map(s=>s.id).filter(Boolean),r=new Set(n);n.length!==r.size&&this.addError("IDs de jogadores devem ser nicos")}validateAlivePlayers(e){const n=Yo(e);n===0&&this.addError("No pode haver zero jogadores vivos"),n===1&&this.addWarning("Apenas 1 jogador vivo - jogo deve terminar")}validateTurnState(e,n){if(typeof n!="number"||n<0||n>=e.length){this.addError(`TurnIdx invlido: ${n} (deve estar entre 0 e ${e.length-1})`);return}const r=e[n];if(!r){this.addError(`Jogador do turno no encontrado no ndice ${n}`);return}r.bankrupt&&this.addError(`Jogador do turno (${r.name}) est falido`)}validateGameOverState(e,n,r){const s=Yo(e);n&&s>1&&this.addError("Jogo marcado como terminado mas h mais de 1 jogador vivo"),n&&!r&&this.addError("Jogo terminado mas no h vencedor definido"),r&&!n&&this.addError("H vencedor definido mas jogo no terminou"),r&&r.bankrupt&&this.addError("Vencedor no pode estar falido")}validateRoundState(e,n){(typeof n!="number"||n<1)&&this.addError(`Rodada invlida: ${n} (deve ser >= 1)`),n>10&&this.addWarning(`Rodada muito alta: ${n} (jogo pode estar travado)`)}validateAction(e,n,r){switch(this.errors=[],this.warnings=[],e.type){case"MOVE":this.validateMoveAction(e,n);break;case"BUY":this.validateBuyAction(e,n);break;case"HIRE":this.validateHireAction(e,n);break;case"BANKRUPT":this.validateBankruptAction(e,n);break;default:this.addWarning(`Tipo de ao no reconhecido: ${e.type}`)}return{isValid:this.errors.length===0,errors:this.errors,warnings:this.warnings}}validateMoveAction(e,n){(typeof e.steps!="number"||e.steps<1||e.steps>6)&&this.addError(`Passos invlidos: ${e.steps} (deve estar entre 1 e 6)`)}validateBuyAction(e,n){const r=e.cost||e.price||0;r>n.cash&&this.addError(`Saldo insuficiente: precisa de ${r}, tem ${n.cash}`)}validateHireAction(e,n){const r=e.cost||0;r>n.cash&&this.addError(`Saldo insuficiente para contratao: precisa de ${r}, tem ${n.cash}`)}validateBankruptAction(e,n){n.bankrupt||this.addWarning("Jogador declarando falncia mas no est marcado como falido")}addError(e){this.errors.push(e)}addWarning(e){this.warnings.push(e)}}function ub(t,e,n,r,s){return new Lm().validateGameState(t,e,n,r,s)}function cb(t,e,n){return new Lm().validateAction(t,e,n)}class db{constructor(){this.enabled=!1,this.logs=[],this.maxLogs=1e4,this.originalConsole={log:console.log,warn:console.warn,error:console.error,debug:console.debug,info:console.info},this.prefixes=["[DEBUG]","[NET]","[App]","[SG]","[Controls]","[HUD]","[DEBUG MODE]","[PlayersLobby]","[leaveRoom]","[GameNet]","[useTurnEngine]","[useGameSync]"]}shouldCapture(e){if(!this.enabled)return!1;const n=e.map(r=>{if(typeof r=="object")try{return JSON.stringify(r)}catch{return String(r)}return String(r)}).join(" ");return this.prefixes.some(r=>n.includes(r))}addLog(e,n){this.logs.length>=this.maxLogs&&(this.logs=this.logs.slice(-Math.floor(this.maxLogs*.9)));const r=Date.now(),s={timestamp:r,time:new Date(r).toISOString(),level:e,args:n.map(o=>{if(typeof o=="object"&&o!==null)try{return JSON.parse(JSON.stringify(o,(i,l)=>typeof l=="function"?"[Function]":l===void 0?"[undefined]":Array.isArray(l)&&l.length>100?`[Array(${l.length}) - truncado]`:l))}catch{return String(o)}return o}),message:n.map(o=>{if(typeof o=="object")try{return JSON.stringify(o)}catch{return String(o)}return String(o)}).join(" ")};this.logs.push(s)}interceptLog(...e){this.shouldCapture(e)&&this.addLog("log",e),this.originalConsole.log.apply(console,e)}interceptWarn(...e){this.shouldCapture(e)&&this.addLog("warn",e),this.originalConsole.warn.apply(console,e)}interceptError(...e){this.addLog("error",e),this.originalConsole.error.apply(console,e)}interceptDebug(...e){this.shouldCapture(e)&&this.addLog("debug",e),this.originalConsole.debug.apply(console,e)}interceptInfo(...e){this.shouldCapture(e)&&this.addLog("info",e),this.originalConsole.info.apply(console,e)}enable(){this.enabled||(this.enabled=!0,console.log=this.interceptLog.bind(this),console.warn=this.interceptWarn.bind(this),console.error=this.interceptError.bind(this),console.debug=this.interceptDebug.bind(this),console.info=this.interceptInfo.bind(this),console.log("[LogCapture]  Captura de logs ativada"))}disable(){this.enabled&&(this.enabled=!1,console.log=this.originalConsole.log,console.warn=this.originalConsole.warn,console.error=this.originalConsole.error,console.debug=this.originalConsole.debug,console.info=this.originalConsole.info,console.log("[LogCapture]  Captura de logs desativada"))}clear(){this.logs=[],console.log("[LogCapture]  Histrico de logs limpo")}getLogs(){return[...this.logs]}getStats(){const e=this.logs.length,n={log:0,warn:0,error:0,debug:0,info:0};return this.logs.forEach(r=>{n[r.level]=(n[r.level]||0)+1}),{total:e,byLevel:n,enabled:this.enabled}}exportAsText(){const e=["=".repeat(80),"RELATRIO DE LOGS - Sales Game","=".repeat(80),`Data/Hora: ${new Date().toISOString()}`,`Total de logs: ${this.logs.length}`,`Estatsticas: ${JSON.stringify(this.getStats(),null,2)}`,"=".repeat(80),""];return this.logs.forEach(n=>{const r={log:"",warn:"",error:"",debug:"",info:""}[n.level]||"";e.push(`[${n.time}] ${r} [${n.level.toUpperCase()}]`),n.args.forEach((s,o)=>{typeof s=="object"?e.push(`  Arg ${o+1}: ${JSON.stringify(s,null,2)}`):e.push(`  Arg ${o+1}: ${s}`)}),e.push("")}),e.join(`
`)}exportAsJSON(){return{timestamp:new Date().toISOString(),stats:this.getStats(),logs:this.logs}}exportFull(){return{timestamp:new Date().toISOString(),stats:this.getStats(),text:this.exportAsText(),json:this.exportAsJSON()}}}const fr=new db,fb=()=>fr.clear(),oc=()=>fr.getStats(),hb=()=>fr.exportAsText(),pb=()=>fr.exportAsJSON();class mb{constructor(){this.enabled=!1,this.validationHistory=[],this.maxHistorySize=100}toggle(){return this.enabled=!this.enabled,this.enabled&&fr.enable(),console.log(`[DEBUG MODE] ${this.enabled?"ATIVADO":"DESATIVADO"}`),this.enabled}validateGameState(e,n,r,s,o,i=""){if(!this.enabled)return;const l=ub(e,n,r,s,o);return this.addToHistory({type:"GAME_STATE",context:i,timestamp:Date.now(),result:l}),l.isValid||console.error("[DEBUG MODE]  Estado do jogo invlido:",l.errors),l.warnings.length>0&&console.warn("[DEBUG MODE]  Avisos:",l.warnings),l}validateAction(e,n,r,s=""){if(!this.enabled)return;const o=cb(e,n,r);return this.addToHistory({type:"ACTION",context:s,timestamp:Date.now(),action:e.type,player:n.name,result:o}),o.isValid||console.error(`[DEBUG MODE]  Ao invlida (${e.type}):`,o.errors),o}validateResourceChange(e,n,r,s){if(!this.enabled)return;const o=[],i=[];if(n.clients!==r.clients){const c=r.clients-n.clients;r.clients<0&&o.push(`Clientes no pode ser negativo: ${r.clients}`),Math.abs(c)>10&&i.push(`Mudana grande de clientes: ${c}`)}if(n.cash!==r.cash){const c=r.cash-n.cash;r.cash<0&&o.push(`Cash no pode ser negativo: ${r.cash}`),Math.abs(c)>5e4&&i.push(`Mudana grande de cash: ${c}`)}["vendedoresComuns","fieldSales","insideSales","gestores"].forEach(c=>{if(n[c]!==r[c]){const d=r[c]-n[c];r[c]<0&&o.push(`${c} no pode ser negativo: ${r[c]}`),Math.abs(d)>5&&i.push(`Mudana grande de ${c}: ${d}`)}});const u={isValid:o.length===0,errors:o,warnings:i};return this.addToHistory({type:"RESOURCE_CHANGE",context:s,timestamp:Date.now(),player:e.name,oldState:n,newState:r,result:u}),u.isValid||console.error("[DEBUG MODE]  Mudana de recurso invlida:",u.errors),u}validateCalculations(e,n=""){if(this.enabled)try{const r=al(e),s=ll(e),{cap:o,inAtt:i}=Ma(e),l=[],u=[];(typeof r!="number"||r<0)&&l.push(`Faturamento invlido: ${r}`),(typeof s!="number"||s<0)&&l.push(`Manuteno invlida: ${s}`),(typeof o!="number"||o<0)&&l.push(`Capacidade invlida: ${o}`),(typeof i!="number"||i<0||i>o)&&l.push(`Clientes em atendimento invlido: ${i} (capacidade: ${o})`),this.isInitialState(e)&&s!==1150&&l.push(`Manuteno inicial deve ser 1150, mas  ${s}`);const c={isValid:l.length===0,errors:l,warnings:u,calculations:{faturamento:r,manutencao:s,cap:o,inAtt:i}};return this.addToHistory({type:"CALCULATIONS",context:n,timestamp:Date.now(),player:e.name,result:c}),c.isValid||console.error("[DEBUG MODE]  Clculos invlidos:",c.errors),c}catch(r){return console.error("[DEBUG MODE]  Erro ao validar clculos:",r),{isValid:!1,errors:[r.message],warnings:[]}}}isInitialState(e){return e.vendedoresComuns===1&&e.clients===1&&e.fieldSales===0&&e.insideSales===0&&e.gestores===0&&e.mixProdutos==="D"&&e.erpLevel==="D"}addToHistory(e){this.validationHistory.unshift(e),this.validationHistory.length>this.maxHistorySize&&(this.validationHistory=this.validationHistory.slice(0,this.maxHistorySize))}getHistory(){return this.validationHistory}clearHistory(){this.validationHistory=[]}getStats(){const e=this.validationHistory.length,n=this.validationHistory.filter(s=>!s.result.isValid).length,r=this.validationHistory.filter(s=>s.result.warnings.length>0).length;return{total:e,errors:n,warnings:r,errorRate:e>0?n/e*100:0,warningRate:e>0?r/e*100:0}}exportReport(){const e=this.getStats(),n={timestamp:new Date().toISOString(),stats:e,history:this.validationHistory};return console.log("[DEBUG MODE]  Relatrio de validao:",n),n}exportFullReport(){const e=this.exportReport(),n=fr.exportFull();return{timestamp:new Date().toISOString(),validation:e,logs:n,text:this.exportFullReportAsText(e,n)}}exportFullReportAsText(e,n){return["=".repeat(80),"RELATRIO COMPLETO DE DEBUG - Sales Game","=".repeat(80),`Data/Hora: ${new Date().toISOString()}`,"","--- VALIDAES ---",`Total de validaes: ${e.stats.total}`,`Erros: ${e.stats.errors}`,`Avisos: ${e.stats.warnings}`,`Taxa de erro: ${e.stats.errorRate.toFixed(2)}%`,"","--- LOGS CAPTURADOS ---",`Total de logs: ${n.stats.total}`,`Logs por nvel: ${JSON.stringify(n.stats.byLevel,null,2)}`,"","--- HISTRICO DE VALIDAES ---",...e.history.map(s=>`[${new Date(s.timestamp).toISOString()}] ${s.type} - ${s.context||""} - ${JSON.stringify(s.result,null,2)}`),"","--- LOGS DETALHADOS ---",n.text,"=".repeat(80)].join(`
`)}}const Cs=new mb,gb=(t,e,n,r,s,o)=>Cs.validateGameState(t,e,n,r,s,o),yb=(t,e)=>Cs.validateCalculations(t,e),Mf=()=>Cs.getStats(),vb=()=>Cs.exportReport(),Im=()=>Cs.exportFullReport(),Jl="__CASH_AUDIT__";function bo(){return typeof window>"u"?null:(window[Jl]||(window[Jl]={enabled:!1,entries:[],maxEntries:5e3,currentMeta:null}),window[Jl])}function $m(t={}){const e=bo();return e?(typeof t.enabled=="boolean"&&(e.enabled=t.enabled),Number.isFinite(t.maxEntries)&&t.maxEntries>0&&(e.maxEntries=Math.floor(t.maxEntries)),{enabled:e.enabled,maxEntries:e.maxEntries,size:e.entries.length}):{enabled:!1}}function xb(t){const e=bo();e&&(e.currentMeta=t||null)}function Mm(t){const e=Number(t.beforeCash),n=Number(t.afterCash),r=Number(t.delta);if(!Number.isFinite(n)||Number.isNaN(n)||!Number.isFinite(r)||Number.isNaN(r)||n<-1e9||n>1e9)return"ERROR";const s=String(t.actionType||""),o=/PAY|EXPENSE|OPS|DEBT/i.test(s);return Math.abs(r)>=5e3||o&&r>0||Number.isFinite(e)&&Number.isFinite(n)&&n-e!==r?"WARN":"INFO"}function Bf(t){const e=bo();if(!e||!e.enabled)return;const n={...t};if(n.traceId=n.traceId||"unknown",n.ts=n.ts||new Date().toISOString(),n.severity=n.severity||Mm(n),n.severity==="ERROR"&&!n.stack)try{n.stack=new Error("cashAudit").stack}catch{}e.entries.push(n),e.entries.length>e.maxEntries&&e.entries.splice(0,e.entries.length-e.maxEntries);const r=Number(n.delta||0),s=Number(n.afterCash||0),o=n.playerName||n.playerId,i=n.reason||"UNKNOWN_CASH_CHANGE",l=n.severity||"INFO";console.groupCollapsed(`[CASH] ${l} ${r} -> ${s} | ${o} | ${i}`),console.log(n),console.groupEnd()}function Uf(t){return Array.isArray(t)?t:t&&Array.isArray(t.players)?t.players:null}function bb(t,e,n=null){var p;const r=bo();if(!r||!r.enabled)return;const s=Uf(t)||[],o=Uf(e)||[],i=new Map(s.map(g=>[String(g==null?void 0:g.id),g||{}])),l=new Map(o.map(g=>[String(g==null?void 0:g.id),g||{}])),u=new Set([...i.keys(),...l.keys()]),c=n||r.currentMeta||{},d=c.origin||{},h=c.context||{};for(const g of u){const b=i.get(g),x=l.get(g);if(!b&&x){Bf({ts:new Date().toISOString(),traceId:c.traceId||"unknown",actionType:c.actionType||"PLAYER_ADDED",reason:c.reason||"PLAYER_ADDED",severity:"INFO",playerId:g,playerName:x==null?void 0:x.name,beforeCash:0,afterCash:Number((x==null?void 0:x.cash)||0),delta:Number((x==null?void 0:x.cash)||0),origin:d,context:h});continue}if(!x&&b)continue;const S=Number((b==null?void 0:b.cash)||0),y=Number((x==null?void 0:x.cash)||0);if(S===y)continue;const f=y-S,m={ts:new Date().toISOString(),traceId:c.traceId||"unknown",actionType:c.actionType||"UNKNOWN",reason:c.reason||"UNKNOWN_CASH_CHANGE",playerId:g,playerName:x==null?void 0:x.name,beforeCash:S,afterCash:y,delta:f,origin:{...d,file:d.file,fn:d.fn,modal:d.modal,component:d.component},context:{round:h.round,pos:Number.isFinite(Number(x==null?void 0:x.pos))?Number(x.pos):h.pos,tile:h.tile,debt:h.debt,loanPending:Number(((p=x==null?void 0:x.loanPending)==null?void 0:p.amount)||0)||h.loanPending,opsExpense:h.opsExpense,revenue:h.revenue}};m.severity=Mm(m),Bf(m)}}function wb({download:t=!1,filename:e}={}){var o;const n=bo(),r={exportedAt:new Date().toISOString(),enabled:!!(n!=null&&n.enabled),size:((o=n==null?void 0:n.entries)==null?void 0:o.length)||0,entries:(n==null?void 0:n.entries)||[]},s=JSON.stringify(r,null,2);if(t&&typeof window<"u")try{const i=new Blob([s],{type:"application/json"}),l=URL.createObjectURL(i),u=document.createElement("a");u.href=l,u.download=e||`cash-audit-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.json`,u.click(),URL.revokeObjectURL(l)}catch(i){console.warn("[cashAudit] download failed",i)}return s}function Sb(){const t=bo();t&&(t.entries=[])}function _b({players:t,turnIdx:e,round:n,gameOver:r,winner:s}){var C,P;const[o,i]=j.useState(!1),[l,u]=j.useState({total:0,errors:0,warnings:0,errorRate:0,warningRate:0}),[c,d]=j.useState({total:0,byLevel:{},enabled:!1}),[h,p]=j.useState(!1),[g,b]=j.useState({x:0,y:0}),[x,S]=j.useState({x:0,y:0}),y=j.useRef(null);j.useEffect(()=>{const I=()=>{u(Mf()),d(oc())};I();const H=setInterval(I,1e3);return()=>clearInterval(H)},[]);const f=()=>{const I=Cs.toggle();i(I)},m=()=>{const I=vb(),H=new Blob([JSON.stringify(I,null,2)],{type:"application/json"}),X=URL.createObjectURL(H),ke=document.createElement("a");ke.href=X,ke.download=`debug-report-${new Date().toISOString().slice(0,19)}.json`,ke.click(),URL.revokeObjectURL(X)},w=()=>{const I=Im(),H=new Blob([I.text],{type:"text/plain;charset=utf-8"}),X=URL.createObjectURL(H),ke=document.createElement("a");ke.href=X,ke.download=`debug-logs-completo-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.txt`,ke.click(),URL.revokeObjectURL(X);const je=new Blob([JSON.stringify(I,null,2)],{type:"application/json"}),F=URL.createObjectURL(je),oe=document.createElement("a");oe.href=F,oe.download=`debug-logs-completo-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.json`,oe.click(),URL.revokeObjectURL(F),console.log("[DebugPanel]  Relatrio completo exportado (texto + JSON)")},k=()=>{Cs.clearHistory(),fb(),Sb(),u(Mf()),d(oc()),console.log("[DebugPanel]  Todos os logs foram limpos")},D=()=>{const I=wb({download:!0});console.log("[CashAudit] export json:",I)},R=()=>{var H;const I=!!((H=window.__CASH_AUDIT__)!=null&&H.enabled);$m({enabled:!I}),console.log("[CashAudit] enabled =",!I)},E=I=>{if(I.target.closest("button"))return;p(!0);const H=y.current.getBoundingClientRect();S({x:I.clientX-H.left,y:I.clientY-H.top})},N=I=>{h&&b({x:I.clientX-x.x,y:I.clientY-x.y})},v=()=>{p(!1)};return j.useEffect(()=>{if(h)return document.addEventListener("mousemove",N),document.addEventListener("mouseup",v),()=>{document.removeEventListener("mousemove",N),document.removeEventListener("mouseup",v)}},[h,x]),o?a.jsxs("div",{ref:y,style:{position:"fixed",top:g.y||10,left:g.x||10,zIndex:9999,background:"#1a1a1a",color:"#fff",padding:"12px",borderRadius:"8px",border:"1px solid #333",minWidth:"300px",maxHeight:"80vh",overflow:"auto",fontSize:"12px",fontFamily:"monospace",cursor:h?"grabbing":"grab",userSelect:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},onMouseDown:E,children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[a.jsx("h3",{style:{margin:0,color:"#4CAF50"},children:" Debug Panel"}),a.jsx("button",{onClick:f,style:{background:"#ff4444",color:"#fff",border:"none",borderRadius:"4px",padding:"4px 8px",cursor:"pointer",fontSize:"10px"},children:""})]}),a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("h4",{style:{margin:"0 0 8px 0",color:"#FFC107"},children:" Estatsticas de Validao"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px"},children:[a.jsxs("div",{children:["Total: ",l.total]}),a.jsxs("div",{style:{color:l.errors>0?"#ff4444":"#4CAF50"},children:["Erros: ",l.errors]}),a.jsxs("div",{style:{color:l.warnings>0?"#FFC107":"#4CAF50"},children:["Avisos: ",l.warnings]}),a.jsxs("div",{children:["Taxa Erro: ",l.errorRate.toFixed(1),"%"]})]})]}),a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("h4",{style:{margin:"0 0 8px 0",color:"#FFC107"},children:" Estatsticas de Logs"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px"},children:[a.jsxs("div",{children:["Total: ",c.total]}),a.jsxs("div",{style:{color:c.enabled?"#4CAF50":"#ff4444"},children:["Status: ",c.enabled?" Ativo":" Inativo"]}),c.byLevel&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:["Logs: ",c.byLevel.log||0]}),a.jsxs("div",{style:{color:"#FFC107"},children:["Warns: ",c.byLevel.warn||0]}),a.jsxs("div",{style:{color:"#ff4444"},children:["Errors: ",c.byLevel.error||0]}),a.jsxs("div",{children:["Debug: ",c.byLevel.debug||0]})]})]})]}),a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("h4",{style:{margin:"0 0 8px 0",color:"#FFC107"},children:" Estado do Jogo"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px"},children:[a.jsxs("div",{children:["Jogadores: ",t.length]}),a.jsxs("div",{children:["Turno: ",e+1]}),a.jsxs("div",{children:["Rodada: ",n]}),a.jsxs("div",{style:{color:r?"#ff4444":"#4CAF50"},children:["Status: ",r?"Fim":"Ativo"]}),s&&a.jsxs("div",{children:["Vencedor: ",s.name]})]})]}),a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("h4",{style:{margin:"0 0 8px 0",color:"#FFC107"},children:" Jogadores"}),t.map((I,H)=>{var X;return a.jsxs("div",{style:{background:H===e?"#333":"transparent",padding:"4px",borderRadius:"4px",marginBottom:"2px",border:I.bankrupt?"1px solid #ff4444":"1px solid transparent"},children:[a.jsxs("div",{style:{fontWeight:"bold"},children:[I.name," ",I.bankrupt?"":""," ",H===e?"":""]}),a.jsxs("div",{style:{fontSize:"10px",opacity:.8},children:["Cash: $",((X=I.cash)==null?void 0:X.toLocaleString())||0," | Clientes: ",I.clients||0," | Vendedores: ",I.vendedoresComuns||0]})]},I.id)})]}),a.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[a.jsx("button",{onClick:w,style:{background:"#2196F3",color:"#fff",border:"none",borderRadius:"4px",padding:"6px 12px",cursor:"pointer",fontSize:"10px",fontWeight:"bold"},title:"Exporta relatrio completo com todos os logs (texto + JSON)",children:" Exportar Logs Completos"}),a.jsx("button",{onClick:m,style:{background:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",padding:"6px 12px",cursor:"pointer",fontSize:"10px"},title:"Exporta apenas relatrio de validao (JSON)",children:" Exportar Validao"}),a.jsx("button",{onClick:k,style:{background:"#FF9800",color:"#fff",border:"none",borderRadius:"4px",padding:"6px 12px",cursor:"pointer",fontSize:"10px"},title:"Limpa todos os logs e histrico de validao",children:" Limpar Tudo"}),a.jsx("button",{onClick:D,style:{background:"#8e44ad",color:"#fff",border:"none",borderRadius:"4px",padding:"6px 12px",cursor:"pointer",fontSize:"10px"},title:"Exporta o audit log de saldo (JSON)",children:" Exportar Cash Audit"}),a.jsx("button",{onClick:R,style:{background:(C=window.__CASH_AUDIT__)!=null&&C.enabled?"#2ecc71":"#7f8c8d",color:"#111",border:"none",borderRadius:"4px",padding:"6px 12px",cursor:"pointer",fontSize:"10px",fontWeight:800},title:"Ativa/desativa auditoria de saldo (runtime)",children:(P=window.__CASH_AUDIT__)!=null&&P.enabled?" Cash Audit ON":" Cash Audit OFF"})]}),a.jsxs("div",{style:{marginTop:"12px",padding:"8px",background:"#333",borderRadius:"4px",fontSize:"10px"},children:[a.jsx("div",{style:{color:"#FFC107",marginBottom:"4px"},children:" Instrues:"}),a.jsx("div",{children:' Clique em " Debug" para ativar/desativar'}),a.jsx("div",{children:" Logs so capturados automaticamente quando debug est ativo"}),a.jsx("div",{children:' " Exportar Logs Completos" gera arquivo .txt e .json'}),a.jsx("div",{children:" Compartilhe o arquivo .txt para anlise de problemas"}),a.jsx("div",{children:" Todos os console.log com prefixos [DEBUG], [NET], [App], etc. so capturados"})]})]}):a.jsx("div",{style:{background:"#1a1a1a",color:"#fff",padding:"6px 10px",borderRadius:"4px",border:"1px solid #333",cursor:"pointer",fontSize:"11px",fontFamily:"monospace",display:"inline-block",userSelect:"none"},onClick:f,children:" Debug"})}function Cr({onResolve:t,requiredAmount:e=0,currentCash:n=0,title:r="Saldo insuficiente",message:s="Seu saldo atual no  suficiente para concluir esta compra.",okLabel:o="OK",showRecoveryOptions:i=!1,canClose:l=!0}){const u=j.useRef(null),c=j.useMemo(()=>Math.max(0,Number(e||0)-Number(n||0)),[e,n]),d=x=>`$ ${Number(x||0).toLocaleString()}`,h=x=>{var S,y;(S=x==null?void 0:x.preventDefault)==null||S.call(x),(y=x==null?void 0:x.stopPropagation)==null||y.call(x),t==null||t({action:"ACK"})},p=x=>{var S,y;(S=x==null?void 0:x.preventDefault)==null||S.call(x),(y=x==null?void 0:x.stopPropagation)==null||y.call(x),!(i||!l)&&(t==null||t({action:"SKIP"}))},g=x=>{var S,y;(S=x==null?void 0:x.preventDefault)==null||S.call(x),(y=x==null?void 0:x.stopPropagation)==null||y.call(x),t==null||t({action:"RECOVERY"})},b=x=>{var S,y;(S=x==null?void 0:x.preventDefault)==null||S.call(x),(y=x==null?void 0:x.stopPropagation)==null||y.call(x),t==null||t({action:"BANKRUPT"})};return j.useEffect(()=>{const x=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var S,y;return(y=(S=u.current)==null?void 0:S.focus)==null?void 0:y.call(S)},0),()=>{document.body.style.overflow=x}},[]),a.jsx("div",{style:yn.wrap,role:"dialog","aria-modal":"true",onMouseDown:x=>{x.target===x.currentTarget&&x.stopPropagation()},children:a.jsxs("div",{style:yn.card,onMouseDown:x=>x.stopPropagation(),children:[!i&&l&&a.jsx("button",{type:"button",style:yn.close,onClick:p,"aria-label":"Fechar",children:""}),a.jsx("div",{style:yn.icon,children:""}),a.jsx("h2",{style:yn.title,children:r}),a.jsx("p",{style:yn.msg,children:s}),a.jsxs("div",{style:yn.grid,children:[a.jsxs("div",{style:yn.row,children:[a.jsx("span",{children:"Necessrio:"}),a.jsx("b",{children:d(e)})]}),a.jsxs("div",{style:yn.row,children:[a.jsx("span",{children:"Seu saldo:"}),a.jsx("b",{children:d(n)})]}),a.jsxs("div",{style:{...yn.row,color:"#fca5a5"},children:[a.jsx("span",{children:"Faltam:"}),a.jsx("b",{children:d(c)})]})]}),a.jsx("div",{style:yn.actions,children:i?a.jsxs(a.Fragment,{children:[a.jsx("button",{type:"button",style:{...yn.btn,background:"#f59e0b",color:"#fff",marginRight:"8px"},onClick:g,children:"Recuperao Financeira"}),a.jsx("button",{type:"button",style:{...yn.btn,background:"#dc2626",color:"#fff"},onClick:b,children:"Declarar Falncia"})]}):a.jsx("button",{ref:u,type:"button",style:{...yn.btn,background:"#6b7280",color:"#fff"},onClick:h,children:o})})]})})}const yn={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"grid",placeItems:"center",zIndex:1100},card:{width:"min(440px, 92vw)",background:"#1f2330",color:"#e9ecf1",borderRadius:16,padding:"18px 18px 16px",border:"1px solid rgba(255,255,255,.12)",boxShadow:"0 18px 50px rgba(0,0,0,.5)",position:"relative"},close:{position:"absolute",right:10,top:10,width:34,height:34,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},icon:{fontSize:28,lineHeight:1,marginBottom:6},title:{margin:"2px 0 6px",fontWeight:900,fontSize:20},msg:{opacity:.95,margin:"0 0 10px"},grid:{border:"1px solid rgba(255,255,255,.15)",borderRadius:12,padding:"10px 12px",marginBottom:12,background:"#171b26"},row:{display:"flex",justifyContent:"space-between",padding:"4px 0"},actions:{display:"flex",justifyContent:"center",marginTop:6},btn:{minWidth:120,padding:"10px 16px",borderRadius:10,border:"none",fontWeight:900,cursor:"pointer"}},vn={A:{compra:1e4,despesa:ur.A.desp,faturamento:ur.A.fat,color:"#1d4ed8",pill:"NVEL A"},B:{compra:4e3,despesa:ur.B.desp,faturamento:ur.B.fat,color:"#16a34a",pill:"NVEL B"},C:{compra:1500,despesa:ur.C.desp,faturamento:ur.C.fat,color:"#f59e0b",pill:"NVEL C"},D:{compra:500,despesa:ur.D.desp,faturamento:ur.D.fat,color:"#6b7280",pill:"NVEL D"}};function Ff({onResolve:t,currentCash:e=0,currentLevel:n=null,erpOwned:r=null}){const s=j.useRef(null),{pushModal:o,awaitTop:i}=An(),l=c=>{var d,h;(d=c==null?void 0:c.preventDefault)==null||d.call(c),(h=c==null?void 0:c.stopPropagation)==null||h.call(c),t==null||t({action:"SKIP"})},u=async c=>{if(r?r[c]===!0:n===c)return;const h=vn[c],p=Number((h==null?void 0:h.compra)||0),g=Number(e||0);if(g<p){o(a.jsx(Cr,{requiredAmount:p,currentCash:g,title:"Saldo insuficiente para comprar ERP",message:`Voc precisa de $ ${p.toLocaleString()} para o ERP nvel ${c}, mas possui $ ${g.toLocaleString()}.`,okLabel:"Entendi"})),await i();return}t==null||t({action:"BUY",level:c,values:h})};return j.useEffect(()=>{const c=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var d,h;return(h=(d=s.current)==null?void 0:d.focus)==null?void 0:h.call(d)},0),()=>{document.body.style.overflow=c}},[]),a.jsx("div",{style:ut.wrap,role:"dialog","aria-modal":"true","aria-label":"ERP/Sistemas",children:a.jsxs("div",{style:ut.card,children:[a.jsx("button",{ref:s,type:"button",style:ut.close,onClick:l,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:ut.title,children:["Escolha o nvel de ",a.jsx("b",{children:"ERP / Sistemas"}),":"]}),a.jsxs("div",{style:ut.note,children:[a.jsx("div",{style:{fontWeight:900,marginBottom:4},children:"ERP / SISTEMAS"}),a.jsxs("div",{children:[a.jsx("b",{children:"Impacto mensal:"})," adiciona ",a.jsx("b",{children:"Despesa"})," e ",a.jsx("b",{children:"Faturamento"})," de acordo com o nvel."]}),a.jsxs("div",{children:["O nvel ",a.jsx("b",{children:"D"})," tambm pode ser adquirido."]})]}),a.jsxs("div",{style:ut.saldo,children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",Number(e||0).toLocaleString()]})]}),a.jsxs("div",{style:ut.table,children:[a.jsxs("div",{style:ut.trHead,children:[a.jsx("div",{style:ut.th}),a.jsx("div",{style:{...ut.th,background:"#10214d"},children:"Nvel A"}),a.jsx("div",{style:{...ut.th,background:"#0f3a1c"},children:"Nvel B"}),a.jsx("div",{style:{...ut.th,background:"#4a3705"},children:"Nvel C"}),a.jsx("div",{style:{...ut.th,background:"#2a2f3b"},children:"Nvel D"})]}),a.jsx(Yl,{label:"COMPRA",fmt:!0,vA:vn.A.compra,vB:vn.B.compra,vC:vn.C.compra,vD:vn.D.compra}),a.jsx(Yl,{label:"DESPESA",fmt:!0,vA:vn.A.despesa,vB:vn.B.despesa,vC:vn.C.despesa,vD:vn.D.despesa}),a.jsx(Yl,{label:"FATURAMENTO",fmt:!0,vA:vn.A.faturamento,vB:vn.B.faturamento,vC:vn.C.faturamento,vD:vn.D.faturamento})]}),a.jsx("div",{style:ut.cards,children:["A","B","C","D"].map(c=>{const d=vn[c],h=r?r[c]===!0:n===c,p=h;return a.jsxs("div",{style:{...ut.cardItem,borderColor:h?"#16a34a":"rgba(255,255,255,.15)",opacity:p?.6:1},children:[a.jsx("div",{style:{...ut.pill,background:h?"#16a34a":"#fff",color:h?"#fff":"#111"},children:h?" ADQUIRIDO":d.pill}),a.jsx("div",{style:{...ut.cardBadge,background:d.color}}),a.jsxs("ul",{style:ut.lines,children:[a.jsxs("li",{children:["Compra: ",a.jsxs("b",{children:["$ ",d.compra.toLocaleString()]})]}),a.jsxs("li",{children:["Despesa: ",a.jsxs("b",{children:["$ ",d.despesa.toLocaleString()]})]}),a.jsxs("li",{children:["Faturamento: ",a.jsxs("b",{children:["$ ",d.faturamento.toLocaleString()]})]})]}),a.jsx("button",{type:"button",style:{...ut.buyBtn,background:p?"#6b7280":"#2442f9",cursor:p?"not-allowed":"pointer"},onClick:()=>u(c),disabled:p,title:p?`ERP nvel ${c} j adquirido`:`Comprar ERP nvel ${c}`,children:p?"J Adquirido":`Comprar ${c}`})]},c)})}),a.jsx("div",{style:ut.actions,children:a.jsx("button",{type:"button",style:{...ut.bigBtn,background:"#444"},onClick:l,children:"No comprar"})})]})})}function Yl({label:t,vA:e,vB:n,vC:r,vD:s,fmt:o}){const i=l=>o?`$ ${Number(l).toLocaleString()}`:l;return a.jsxs("div",{style:ut.tr,children:[a.jsx("div",{style:{...ut.td,fontWeight:700},children:t}),a.jsx("div",{style:ut.td,children:i(e)}),a.jsx("div",{style:ut.td,children:i(n)}),a.jsx("div",{style:ut.td,children:i(r)}),a.jsx("div",{style:ut.td,children:i(s)})]})}const ut={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(980px, 94vw)",background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:900},note:{background:"#2a2f3b",border:"1px solid rgba(255,255,255,.15)",borderRadius:12,padding:"10px 12px",margin:"0 0 10px"},saldo:{margin:"0 0 10px",padding:"8px 12px",border:"1px dashed rgba(255,255,255,.25)",borderRadius:10},table:{border:"1px solid rgba(255,255,255,.12)",borderRadius:12,overflow:"hidden",marginBottom:12},trHead:{display:"grid",gridTemplateColumns:"1fr repeat(4, 1fr)",background:"#121621"},th:{padding:"10px 12px",fontWeight:800,borderLeft:"1px solid rgba(255,255,255,.06)"},tr:{display:"grid",gridTemplateColumns:"1fr repeat(4, 1fr)",background:"#0f1320"},td:{padding:"10px 12px",borderTop:"1px solid rgba(255,255,255,.06)",borderLeft:"1px solid rgba(255,255,255/.06)"},cards:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:12,marginTop:8},cardItem:{background:"#0f1320",border:"1px solid",borderRadius:14,padding:"12px",display:"flex",flexDirection:"column",gap:8},cardBadge:{width:"100%",height:6,borderRadius:999,opacity:.9},pill:{alignSelf:"flex-start",fontSize:12,fontWeight:900,padding:"4px 8px",borderRadius:999,color:"#111"},lines:{margin:0,padding:"0 0 0 16px",lineHeight:1.35},buyBtn:{marginTop:"auto",padding:"10px 12px",borderRadius:10,border:"none",fontWeight:900,cursor:"pointer",background:"#2442f9",color:"#fff"},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:14},bigBtn:{minWidth:160,padding:"14px 18px",borderRadius:12,border:"none",color:"#fff",fontWeight:900,cursor:"pointer"}},Ki=[{id:"personalizado",label:`Treinamento de venda personalizado
Casagrande Consultores`,price:500,cert:"azul",colors:{bg:"#0f2848",border:"#3b82f6",pill:"#60a5fa"}},{id:"fieldsales",label:`Curso Field Sales Collab
Multiplier Educao e
Casagrande Consultores`,price:500,cert:"amarelo",colors:{bg:"#3a3202",border:"#facc15",pill:"#fde047"}},{id:"imersaomultiplier",label:`Pacote Imerses
Multiplier Educao`,price:500,cert:"roxo",colors:{bg:"#2b0840",border:"#a855f7",pill:"#c084fc"}}];function zf({onResolve:t,ownedByType:e={},canTrain:n={}}){const r=E=>typeof E=="string"&&E.trim()!==""&&!Number.isNaN(Number(E))?Number(E):E,s=E=>{const N=r(E);return typeof N=="number"?N>0:!!N},o=j.useMemo(()=>({comum:s(n.comum),field:s(n.field),inside:s(n.inside),gestor:s(n.gestor)}),[n]),i=Ki.map(E=>E.id),l=j.useMemo(()=>[{id:"comum",label:"Vend. Comum"},{id:"field",label:"Field Sales"},{id:"inside",label:"Inside Sales"},{id:"gestor",label:"Gestor"}].filter(E=>o[E.id]).filter(E=>{const N=e[E.id]instanceof Set?e[E.id]:new Set(e[E.id]||[]);return i.some(v=>!N.has(v))}),[e,o]),[u,c]=j.useState(()=>new Set),[d,h]=j.useState(()=>new Set);j.useEffect(()=>{u.size===0&&l.length>0&&c(new Set([l[0].id]))},[l,u.size]);const p=j.useRef(null),g=j.useMemo(()=>{const E=[];if(d.size>0){const N=Array.from(d).map(C=>Ki.find(P=>P.id===C)).filter(Boolean),v=N.reduce((C,P)=>C+((P==null?void 0:P.price)||0),0);u.forEach(C=>{E.push({vendorType:C,items:N,total:v})})}return E},[u,d]),b=j.useMemo(()=>g.reduce((E,N)=>E+N.total,0),[g]),x=j.useMemo(()=>{const E={azul:0,amarelo:0,roxo:0};return d.size>0&&Array.from(d).map(v=>Ki.find(C=>C.id===v)).filter(Boolean).forEach(v=>{E[v.cert]=(E[v.cert]||0)+u.size}),E},[d,u.size]),S=j.useMemo(()=>{const E={};if(d.size>0){const N=Array.from(d);u.forEach(v=>{E[v]=N})}return E},[d,u]),y=E=>{c(N=>{const v=new Set(N);return v.has(E)?v.delete(E):v.add(E),v})},f=E=>{Array.from(u).some(v=>(e[v]instanceof Set?e[v]:new Set(e[v]||[])).has(E))||h(v=>{const C=new Set(v);return C.has(E)?C.delete(E):C.add(E),C})},m=()=>{g.length!==0&&(t==null||t({action:"BUY",purchases:g,grandTotal:b,bensDelta:b,certsCount:x,ownedUpdate:S}))},w=()=>{c(new Set),h(new Set)},k=E=>{var N,v;(N=E==null?void 0:E.preventDefault)==null||N.call(E),(v=E==null?void 0:E.stopPropagation)==null||v.call(E),t==null||t({action:"SKIP"})};j.useEffect(()=>{const E=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var N,v;return(v=(N=p.current)==null?void 0:N.focus)==null?void 0:v.call(N)},0),()=>{document.body.style.overflow=E}},[]);const D=l.length===0,R=!Object.values(o).some(Boolean);return a.jsx("div",{style:un.wrap,role:"dialog","aria-modal":"true",children:a.jsxs("div",{style:un.card,children:[a.jsx("button",{ref:p,type:"button",style:un.close,onClick:k,"aria-label":"Fechar",children:""}),a.jsx("h2",{style:un.title,children:"Escolha os vendedores e treinamentos que deseja comprar:"}),D?a.jsx("div",{style:un.allDoneBox,children:R?"Nenhum profissional disponvel para treinar no momento.":"Todos os treinamentos j foram comprados para os profissionais disponveis."}):a.jsx(a.Fragment,{children:a.jsxs("div",{style:{marginBottom:"16px"},children:[a.jsx("p",{style:{margin:"0 0 8px",opacity:.9,fontSize:"14px"},children:"Selecione os tipos de vendedores que deseja treinar:"}),a.jsx("div",{style:{...un.vendorRow,gridTemplateColumns:`repeat(${l.length}, minmax(0,1fr))`},children:l.map(E=>a.jsx("button",{type:"button",onClick:()=>y(E.id),style:{...un.vendorBtn,background:u.has(E.id)?"#6f5bd6":"#2a2f3b",borderColor:u.has(E.id)?"rgba(255,255,255,.35)":"rgba(255,255,255,.15)"},children:E.label},E.id))})]})}),!D&&u.size>0&&a.jsxs(a.Fragment,{children:[a.jsx("p",{style:{margin:"10px 2px 14px",opacity:.9},children:"Escolha os treinamentos que sero aplicados a todos os tipos selecionados:"}),a.jsxs("div",{style:{marginBottom:"16px"},children:[a.jsxs("div",{style:{marginBottom:"12px",padding:"8px 12px",background:"#2a2f3b",borderRadius:"8px",border:"1px solid rgba(255,255,255,.15)"},children:[a.jsx("div",{style:{fontWeight:"bold",marginBottom:"4px"},children:"Tipos selecionados:"}),a.jsx("div",{style:{fontSize:"14px",opacity:.9},children:Array.from(u).map(E=>{const N=l.find(v=>v.id===E);return N==null?void 0:N.label}).join(", ")})]}),a.jsx("div",{style:un.products,children:Ki.map(E=>{const N=d.has(E.id),v=Array.from(u).some(C=>(e[C]instanceof Set?e[C]:new Set(e[C]||[])).has(E.id));return a.jsxs("button",{type:"button",onClick:()=>f(E.id),disabled:v,style:{...un.productCard,background:E.colors.bg,borderColor:E.colors.border,boxShadow:N?`0 0 0 3px ${E.colors.pill}`:"none",opacity:v?.45:1,cursor:v?"not-allowed":"pointer"},title:v?"J adquirido para algum tipo selecionado":void 0,children:[a.jsxs("div",{style:un.pill(E.colors.pill),children:["Certificado ",E.cert==="azul"?"Azul":E.cert==="amarelo"?"Amarelo":"Roxo"]}),a.jsx("div",{style:{whiteSpace:"pre-line",fontWeight:800,marginBottom:10},children:E.label}),a.jsxs("div",{style:{fontSize:22,fontWeight:900},children:["$ ",E.price.toLocaleString()]})]},E.id)})})]}),a.jsxs("div",{style:un.actionsRow,children:[a.jsx("button",{type:"button",style:{...un.smallBtn,background:"#3a4152"},onClick:w,children:"Limpar Tudo"}),a.jsx("div",{style:{flex:1}}),a.jsxs("div",{style:{fontWeight:900},children:["Total: $ ",b.toLocaleString(),u.size>1&&a.jsxs("span",{style:{fontSize:"12px",opacity:.8,marginLeft:"8px"},children:["(",d.size," treinamentos  ",u.size," tipos)"]})]})]}),a.jsxs("div",{style:un.btnRow,children:[a.jsx("button",{type:"button",style:{...un.bigBtn,background:"#444"},onClick:k,children:"No comprar"}),a.jsxs("button",{type:"button",disabled:g.length===0,style:{...un.bigBtn,background:g.length>0?"#6f5bd6":"#3a3a3a",opacity:g.length>0?1:.6,cursor:g.length>0?"pointer":"not-allowed"},onClick:m,children:["Comprar (",g.length," tipo",g.length!==1?"s":"",")"]})]})]})]})})}const un={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(980px, 94vw)",maxWidth:980,background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:900},allDoneBox:{background:"#0f1320",border:"1px solid rgba(255,255,255,.15)",borderRadius:12,padding:"14px",fontWeight:800,textAlign:"center"},vendorRow:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:10,marginBottom:12},vendorBtn:{padding:"10px 12px",borderRadius:10,border:"1px solid",color:"#fff",fontWeight:800,cursor:"pointer"},products:{display:"grid",gridTemplateColumns:"repeat(3, minmax(0,1fr))",gap:12,margin:"4px 0 10px"},productCard:{textAlign:"center",padding:"16px 14px",borderRadius:14,border:"2px solid",color:"#fff"},pill:t=>({display:"inline-block",background:t,color:"#111",fontWeight:900,padding:"4px 8px",borderRadius:999,marginBottom:8}),actionsRow:{display:"flex",alignItems:"center",gap:12,margin:"6px 0 6px"},smallBtn:{padding:"10px 14px",borderRadius:10,border:"none",color:"#fff",fontWeight:800,cursor:"pointer"},btnRow:{display:"flex",gap:12,justifyContent:"flex-end",marginTop:12},bigBtn:{minWidth:160,padding:"14px 18px",borderRadius:12,border:"none",color:"#fff",fontWeight:900,cursor:"pointer"}};function kb({onResolve:t,currentCash:e=0}){const n=j.useRef(null),r=i=>{var l,u;(l=i==null?void 0:i.preventDefault)==null||l.call(i),(u=i==null?void 0:i.stopPropagation)==null||u.call(i),t==null||t({action:"SKIP"})};j.useEffect(()=>{const i=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var l,u;return(u=(l=n.current)==null?void 0:l.focus)==null?void 0:u.call(l)},0),()=>{document.body.style.overflow=i}},[]);const s=i=>()=>{t==null||t({action:"OPEN",open:String(i).toUpperCase()})},o=[{key:"mix",title:"Mix Produtos",lines:["Nvel A: $12000","Nvel B: $6000","Nvel C: $3000","Nvel D: $1000"],onBuy:s("MIX")},{key:"gestor",title:"Gestor Comercial",lines:["Contratao: $5000","Manuteno: $3000"],onBuy:s("MANAGER")},{key:"inside",title:"Inside Sales",lines:["Contratao: $3000","Manuteno: $2000"],onBuy:s("INSIDE")},{key:"field",title:"Field Sales",lines:["Contratao: $3000","Manuteno: $2000"],onBuy:s("FIELD")},{key:"vendedor",title:"Vendedor Comum",lines:["Contratao: $1500","Despesas: $1000"],onBuy:s("COMMON")},{key:"erp",title:"ERP/Sistemas",lines:["Nvel A: $10000","Nvel B: $4000","Nvel C: $1500","Nvel D: $500"],onBuy:s("ERP")},{key:"carteira",title:"Carteira de Clientes",lines:["Aquisio: $1000"],onBuy:s("CLIENTS")},{key:"training",title:"Treinamento",lines:["Azul: $500","Amarelo: $500","Roxo: $500"],onBuy:s("TRAINING")}];return a.jsx("div",{style:ir.wrap,role:"dialog","aria-modal":"true",children:a.jsxs("div",{style:ir.card,children:[a.jsx("button",{ref:n,type:"button",style:ir.close,onClick:r,"aria-label":"Fechar",children:""}),a.jsx("h2",{style:ir.title,children:"Direto de Compra  escolha uma casa para adquirir:"}),a.jsxs("div",{style:{marginBottom:8,opacity:.8,fontSize:13},children:["Saldo atual: ",a.jsxs("b",{children:["$",Number(e).toLocaleString()]})]}),a.jsx("div",{style:ir.grid,children:o.map(i=>a.jsxs("div",{style:ir.cell,children:[a.jsx("div",{style:ir.cellTitle,children:i.title}),a.jsx("ul",{style:ir.lines,children:i.lines.map((l,u)=>a.jsx("li",{children:l},u))}),a.jsx("button",{type:"button",style:ir.buyBtn,onClick:i.onBuy,children:"Comprar"})]},i.key))}),a.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:16},children:a.jsx("button",{type:"button",style:{...ir.buyBtn,background:"#666"},onClick:r,children:"No Comprar"})})]})})}const ir={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(1000px, 94vw)",background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 16px",fontWeight:800},grid:{display:"grid",gridTemplateColumns:"repeat(4, minmax(180px, 1fr))",gap:12},cell:{background:"#0f1320",border:"1px solid rgba(255,255,255,.08)",borderRadius:12,padding:12,display:"flex",flexDirection:"column",gap:8,minHeight:160},cellTitle:{fontWeight:800,marginBottom:4},lines:{margin:0,padding:"0 0 0 16px",opacity:.85,lineHeight:1.3},buyBtn:{marginTop:"auto",alignSelf:"center",minWidth:140,padding:"10px 14px",borderRadius:10,border:"none",background:"#3fbf49",color:"#09110f",fontWeight:900,cursor:"pointer"}};function Wf({onResolve:t,currentCash:e=0}){const n=j.useRef(null),[r,s]=j.useState(""),{pushModal:o,awaitTop:i}=An(),l=3e3,u=Oe.inside.baseDesp,c=Oe.inside.baseFat,d=k=>`$ ${Number(k||0).toLocaleString()}`,h=k=>Oe.inside.baseDesp+Oe.inside.incDesp*Math.max(0,k),p=k=>Oe.inside.baseFat+Oe.inside.incFat*Math.max(0,k),g=j.useMemo(()=>{const k=Number(r);return Number.isFinite(k)&&k>0?Math.floor(k):0},[r]),b=g*l,x=g>0,S=Math.max(0,Math.floor(Number(e||0)/l)),y=k=>{var D,R;(D=k==null?void 0:k.preventDefault)==null||D.call(k),(R=k==null?void 0:k.stopPropagation)==null||R.call(k),t==null||t({action:"SKIP"})},f=k=>{const D=Number(r)||0,R=Math.min(S||1/0,D+k);s(R||"")},m=()=>s(S||""),w=async()=>{if(!x)return;const k=Number(e||0),D=Number(b||0);if(k<D){o(a.jsx(Cr,{requiredAmount:D,currentCash:k,title:"Saldo insuficiente para contratar Inside Sales",message:`Voc precisa de $ ${D.toLocaleString()} mas possui $ ${k.toLocaleString()}.`,okLabel:"Entendi"})),await i();return}t==null||t({action:"BUY",qty:g,headcount:g,unitHire:l,total:b,cost:b,totalCost:b,baseExpense:u,baseRevenue:c})};return j.useEffect(()=>{const k=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var D,R;return(R=(D=n.current)==null?void 0:D.focus)==null?void 0:R.call(D)},0),()=>{document.body.style.overflow=k}},[]),a.jsx("div",{style:jt.wrap,role:"dialog","aria-modal":"true","aria-label":"Inside Sales",children:a.jsxs("div",{style:jt.card,children:[a.jsx("button",{ref:n,type:"button",style:jt.close,onClick:y,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:jt.title,children:["Voc pode escolher quantos ",a.jsx("b",{children:"Inside Sales"})," quer comprar:"]}),a.jsxs("div",{style:jt.note,children:[a.jsx("div",{style:{fontWeight:900,marginBottom:4},children:"INSIDE SALES (SDR/BDR + CLOSER + CS)"}),a.jsxs("div",{children:[a.jsx("b",{children:"Base para clculo despesa:"}),"  quantidade ",a.jsx("b",{children:"field sales"})," ou ",a.jsx("b",{children:"inside sales"}),"."]}),a.jsxs("div",{children:[a.jsx("b",{children:"Base para clculo faturamento:"}),"  quantidade ",a.jsx("b",{children:"mxima de clientes que cada vendedor pode atender"}),"."]})]}),a.jsxs("div",{style:jt.saldoRow,children:[a.jsxs("div",{children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",Number(e||0).toLocaleString()]})]}),a.jsxs("div",{children:["Mximo por saldo: ",a.jsx("b",{children:S})]})]}),a.jsxs("div",{style:jt.inputRow,children:[a.jsx("input",{type:"number",inputMode:"numeric",min:1,placeholder:"Digite o nmero de Inside Sales",value:r,onChange:k=>s(k.target.value),style:jt.input}),a.jsxs("div",{style:jt.quickBtns,children:[a.jsx("button",{type:"button",style:jt.quickBtn,onClick:()=>f(1),children:"+1"}),a.jsx("button",{type:"button",style:jt.quickBtn,onClick:()=>f(5),children:"+5"}),a.jsx("button",{type:"button",style:jt.quickBtn,onClick:()=>f(10),children:"+10"}),a.jsx("button",{type:"button",style:{...jt.quickBtn,fontWeight:900},onClick:m,children:"Mx"})]}),a.jsxs("div",{style:jt.totalBox,children:["Total contratar: ",a.jsxs("b",{children:["$ ",Number(b).toLocaleString()]})]})]}),a.jsxs("div",{style:jt.cards,children:[a.jsx(Ji,{title:"Sem certificado",bg:"#2a2f3b",pill:"BASE",lines:[`Contratao: $ ${l.toLocaleString()}`,`Despesa: ${d(h(0))}`,`Faturamento: ${d(p(0))}`]}),a.jsx(Ji,{title:"1 certificado",bg:"#f1c40f",pill:"NVEL 1",dark:!0,lines:["Contratao: ",`Despesa: ${d(h(1))}`,`Faturamento: ${d(p(1))}`]}),a.jsx(Ji,{title:"2 certificados",bg:"#a78bfa",pill:"NVEL 2",dark:!0,lines:["Contratao: ",`Despesa: ${d(h(2))}`,`Faturamento: ${d(p(2))}`]}),a.jsx(Ji,{title:"3 certificados",bg:"#8b5cf6",pill:"NVEL 3",dark:!0,lines:["Contratao: ",`Despesa: ${d(h(3))}`,`Faturamento: ${d(p(3))}`]})]}),a.jsxs("div",{style:jt.actions,children:[a.jsx("button",{type:"button",style:{...jt.bigBtn,background:"#666",color:"#fff"},onClick:y,children:"No comprar"}),a.jsxs("button",{type:"button",style:{...jt.bigBtn,background:x?"#3fbf49":"#2f5d33",color:"#09110f"},onClick:w,disabled:!x,title:x?void 0:"Informe uma quantidade vlida",children:["Comprar ",x?`($ ${b.toLocaleString()})`:""]})]})]})})}function Ji({title:t,pill:e,lines:n,bg:r,dark:s=!1}){return a.jsxs("div",{style:{...jt.cardItem,background:r,color:s?"#111":"#fff",borderColor:"rgba(255,255,255,.15)"},children:[a.jsxs("div",{style:jt.cardHeader,children:[a.jsx("span",{style:{...jt.pill,background:s?"#111":"#fff",color:s?"#fff":"#111"},children:e}),a.jsx("div",{style:{fontWeight:900},children:t})]}),a.jsx("ul",{style:jt.lines,children:n.map((o,i)=>a.jsx("li",{children:o},i))})]})}const jt={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(980px, 94vw)",background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:900},note:{background:"#2a2f3b",border:"1px solid rgba(255,255,255,.15)",borderRadius:12,padding:"10px 12px",margin:"0 0 10px"},saldoRow:{display:"flex",justifyContent:"space-between",gap:12,padding:"8px 12px",border:"1px dashed rgba(255,255,255,.25)",borderRadius:10,marginBottom:8},inputRow:{display:"grid",gridTemplateColumns:"1fr auto auto",alignItems:"center",gap:10,marginBottom:12},input:{height:42,borderRadius:10,padding:"0 12px",border:"1px solid rgba(255,255,255,.18)",background:"#0f1320",color:"#fff",outline:"none"},quickBtns:{display:"flex",gap:6},quickBtn:{minWidth:44,height:42,borderRadius:10,border:"1px solid rgba(255,255,255,.18)",background:"#2a2f3b",color:"#fff",fontWeight:800,cursor:"pointer",padding:"0 10px"},totalBox:{padding:"8px 12px",borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#0f1320",fontWeight:900},cards:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:12,margin:"8px 0 14px"},cardItem:{border:"1px solid",borderRadius:14,padding:"14px"},cardHeader:{display:"flex",alignItems:"center",gap:8,marginBottom:8},pill:{fontSize:12,fontWeight:900,padding:"4px 8px",borderRadius:999},lines:{margin:0,padding:"0 0 0 16px",lineHeight:1.35},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:8},bigBtn:{minWidth:180,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function Vf({onResolve:t,unitAcquisition:e=1e3,unitMaintenance:n=50,currentCash:r=0}){const s=j.useRef(null),o=j.useRef(null),{pushModal:i,awaitTop:l}=An(),[u,c]=j.useState(""),d=j.useMemo(()=>{const k=Math.floor(Number(u));return Number.isFinite(k)&&k>0?k:0},[u]),h=Number(e||0),p=Number(n||0),g=Number(r||0),b=j.useMemo(()=>h<=0?0:Math.max(0,Math.floor(g/h)),[g,h]),x=d*h,S=d*p,y=d>0,f=k=>{var D,R;(D=k==null?void 0:k.preventDefault)==null||D.call(k),(R=k==null?void 0:k.stopPropagation)==null||R.call(k),t==null||t({action:"SKIP"})},m=async()=>{if(y){if(g<x){i(a.jsx(Cr,{requiredAmount:x,currentCash:g,title:"Saldo insuficiente para comprar clientes",message:"Voc no possui saldo suficiente para concluir esta aquisio.",okLabel:"Entendi"})),await l();return}t==null||t({action:"BUY",qty:d,unitAcquisition:h,totalCost:x,unitMaintenance:p,maintenanceDelta:S,bensDelta:x,clientsAdded:d,source:{modal:"BuyClientsModal",file:"src/modals/BuyClientsModal.jsx"}})}};j.useEffect(()=>{const k=document.body.style.overflow;document.body.style.overflow="hidden";const D=setTimeout(()=>{var N,v;return(v=(N=s.current)==null?void 0:N.focus)==null?void 0:v.call(N)},0),R=setTimeout(()=>{var N,v;return(v=(N=o.current)==null?void 0:N.focus)==null?void 0:v.call(N)},50),E=N=>{N.key==="Enter"&&(N.preventDefault(),m())};return window.addEventListener("keydown",E),()=>{document.body.style.overflow=k,window.removeEventListener("keydown",E),clearTimeout(D),clearTimeout(R)}},[]);const w=k=>{const D=Math.max(0,Math.min(Math.floor(Number(k)||0),1e6));c(String(D))};return a.jsx("div",{style:Ht.wrap,role:"dialog","aria-modal":"true",onMouseDown:k=>{k.target===k.currentTarget&&k.stopPropagation()},children:a.jsxs("div",{style:Ht.card,onMouseDown:k=>k.stopPropagation(),children:[a.jsx("button",{ref:s,type:"button",style:Ht.close,onClick:f,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:Ht.title,children:["Voc pode escolher quantos clientes quer comprar,",a.jsx("br",{}),"Digite o nmero de clientes:"]}),a.jsxs("p",{style:Ht.warn,children:[a.jsx("b",{children:"Mas cuidado com a capacidade de atendimento da sua equipe!"}),a.jsx("br",{}),"Se o jogador adquirir mais clientes do que os vendedores podem atender, assim que passar na casa ",a.jsx("i",{children:"Faturamento do Ms"})," no receber o faturamento dos clientes excedentes e perder o(s) cliente(s) que no foram atendidos."]}),a.jsxs("div",{style:Ht.inlineInfo,children:[a.jsxs("div",{children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",g.toLocaleString()]})]}),a.jsxs("div",{children:["Mximo por saldo: ",a.jsx("b",{children:b})]})]}),a.jsxs("div",{style:Ht.qtyRow,children:[a.jsx("input",{ref:o,type:"number",inputMode:"numeric",min:1,placeholder:"Digite o nmero de Clientes",value:u,onChange:k=>w(k.target.value),style:Ht.input}),a.jsxs("div",{style:Ht.quickBtns,children:[a.jsx("button",{type:"button",style:Ht.qbtn,onClick:()=>w(d+1),children:"+1"}),a.jsx("button",{type:"button",style:Ht.qbtn,onClick:()=>w(d+5),children:"+5"}),a.jsx("button",{type:"button",style:Ht.qbtn,onClick:()=>w(d+10),children:"+10"}),a.jsx("button",{type:"button",style:Ht.qbtn,onClick:()=>w(b),title:"Comprar o mximo possvel com o saldo atual",children:"Mx"})]})]}),a.jsxs("div",{style:Ht.summary,children:[a.jsxs("div",{children:["Preo por cliente: ",a.jsxs("b",{children:["$ ",h.toLocaleString()]})]}),a.jsxs("div",{children:["Despesa mensal por cliente: ",a.jsxs("b",{children:["$ ",p.toLocaleString()]})]})]}),a.jsxs("div",{style:Ht.summaryStrong,children:[a.jsxs("div",{children:["Total compra: ",a.jsxs("b",{children:["$ ",Number(x).toLocaleString()]})]}),a.jsxs("div",{children:["Manuteno mensal adicionada: ",a.jsxs("b",{children:["$ ",Number(S).toLocaleString()]})]})]}),a.jsxs("div",{style:Ht.actions,children:[a.jsx("button",{type:"button",style:{...Ht.bigBtn,background:"#666",color:"#fff"},onClick:f,children:"No comprar"}),a.jsxs("button",{type:"button",style:{...Ht.bigBtn,background:y?"#3fbf49":"#2f5d33",color:"#09110f"},onClick:m,disabled:!y,title:y?g<x?"Saldo insuficiente":void 0:"Informe uma quantidade vlida",children:["Comprar ",y?`($ ${x.toLocaleString()})`:""]})]})]})})}const Ht={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(820px, 92vw)",maxWidth:820,background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px 20px 16px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:800,lineHeight:1.3},warn:{background:"#271c12",border:"1px solid rgba(255,180,0,.35)",color:"#ffd489",borderRadius:10,padding:"10px 12px",margin:"0 0 12px"},inlineInfo:{display:"flex",justifyContent:"space-between",gap:10,margin:"0 0 8px",opacity:.95,fontWeight:700,flexWrap:"wrap"},qtyRow:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},input:{flex:"1 1 260px",height:42,borderRadius:10,padding:"0 12px",border:"1px solid rgba(255,255,255,.18)",background:"#0f1320",color:"#fff",outline:"none"},quickBtns:{display:"flex",gap:6,flexWrap:"wrap"},qbtn:{height:42,padding:"0 12px",borderRadius:10,border:"1px solid rgba(255,255,255,.18)",background:"#2a2f3b",color:"#fff",cursor:"pointer",fontWeight:800},summary:{display:"flex",justifyContent:"space-between",gap:10,border:"1px dashed rgba(255,255,255,.2)",borderRadius:10,padding:"8px 12px",marginBottom:8,fontWeight:700,flexWrap:"wrap"},summaryStrong:{display:"flex",justifyContent:"space-between",gap:10,border:"1px solid rgba(255,255,255,.25)",borderRadius:10,padding:"10px 12px",marginBottom:10,fontWeight:800,flexWrap:"wrap"},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:4,flexWrap:"wrap"},bigBtn:{minWidth:180,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function Gf({onResolve:t,unitHire:e=5e3,unitExpense:n=Oe.gestor.baseDesp,managesUpTo:r=Pm,currentCash:s=0}){const o=j.useRef(null),i=j.useRef(null),{pushModal:l,awaitTop:u}=An(),[c,d]=j.useState(""),h=Number(e||0),p=Number(n||0),g=Number(s||0),b=j.useMemo(()=>{const N=Math.floor(Number(c));return Number.isFinite(N)&&N>0?N:0},[c]),x=j.useMemo(()=>h<=0?0:Math.max(0,Math.floor(g/h)),[g,h]),S=b*h,y=b*p,f=b>0,m=N=>`$ ${Number(N||0).toLocaleString()}`,w=N=>Oe.gestor.baseDesp+Oe.gestor.incDesp*Math.max(0,N),k=N=>{const v=Math.max(0,N);return($a[Math.min(v,$a.length-1)]||0)*100},D=N=>{const v=Math.floor(Number(N)||0),C=Math.max(0,Math.min(v,1e6));d(String(C))},R=N=>{var v,C;(v=N==null?void 0:N.preventDefault)==null||v.call(N),(C=N==null?void 0:N.stopPropagation)==null||C.call(N),t==null||t({action:"SKIP"})},E=async()=>{if(f){if(g<S){l(a.jsx(Cr,{requiredAmount:S,currentCash:g,title:"Saldo insuficiente para contratar Gestores",message:"Voc no possui saldo suficiente para concluir esta contratao.",okLabel:"Entendi"})),await u();return}t==null||t({action:"BUY",role:"MANAGER",qty:b,headcount:b,gestoresDelta:b,unitHire:h,unitExpense:p,totalHire:S,totalExpense:y,cost:S,total:S,cashDelta:-S,expenseDelta:y,hudUpdate:{category:"Gestores Comerciais",addQty:b}})}};return j.useEffect(()=>{const N=document.body.style.overflow;document.body.style.overflow="hidden";const v=setTimeout(()=>{var I,H;return(H=(I=o.current)==null?void 0:I.focus)==null?void 0:H.call(I)},0),C=setTimeout(()=>{var I,H;return(H=(I=i.current)==null?void 0:I.focus)==null?void 0:H.call(I)},60),P=I=>{I.key==="Enter"&&(I.preventDefault(),E())};return window.addEventListener("keydown",P),()=>{document.body.style.overflow=N,window.removeEventListener("keydown",P),clearTimeout(v),clearTimeout(C)}},[]),a.jsx("div",{style:et.wrap,role:"dialog","aria-modal":"true",onMouseDown:N=>{N.target===N.currentTarget&&N.stopPropagation()},children:a.jsxs("div",{style:et.card,onMouseDown:N=>N.stopPropagation(),children:[a.jsx("button",{ref:o,type:"button",style:et.close,onClick:R,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:et.title,children:["Voc pode escolher quantos ",a.jsx("b",{children:"Gestores"})," quer comprar,",a.jsx("br",{}),"Digite o nmero de gestores:"]}),a.jsxs("div",{style:et.inlineInfo,children:[a.jsxs("div",{children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",g.toLocaleString()]})]}),a.jsxs("div",{children:["Mximo por saldo: ",a.jsx("b",{children:x})]})]}),a.jsxs("div",{style:et.qtyRow,children:[a.jsx("input",{ref:i,type:"number",inputMode:"numeric",min:1,placeholder:"Digite o nmero de Gestores",value:c,onChange:N=>D(N.target.value),style:et.input}),a.jsxs("div",{style:et.quickBtns,children:[a.jsx("button",{type:"button",style:et.qbtn,onClick:()=>D(b+1),children:"+1"}),a.jsx("button",{type:"button",style:et.qbtn,onClick:()=>D(b+5),children:"+5"}),a.jsx("button",{type:"button",style:et.qbtn,onClick:()=>D(b+10),children:"+10"}),a.jsx("button",{type:"button",style:et.qbtn,onClick:()=>D(x),title:"Comprar o mximo possvel com o saldo atual",children:"Mx"})]})]}),a.jsxs("div",{style:et.infoBox,children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"GESTOR COMERCIAL"}),a.jsxs("div",{style:{opacity:.9,marginBottom:8},children:["Base para clculo de despesa: ",a.jsx("b",{children:"x quantidade de Gestores"}),".",a.jsx("br",{}),"Cada Gestor gerencia at ",a.jsx("b",{children:r})," colaboradores."]}),a.jsxs("div",{style:et.table,children:[a.jsxs("div",{style:et.trHead,children:[a.jsx("div",{style:et.th,children:"Certificao"}),a.jsx("div",{style:et.th,children:"Contratao"}),a.jsx("div",{style:et.th,children:"Despesa"}),a.jsx("div",{style:et.th,children:"Efeito"})]}),a.jsx(Yi,{label:"Sem Certificado",hire:m(e),expense:m(w(0)),revenue:`potencializa colaboradores em ${k(0)}%`}),a.jsx(Yi,{label:"Com 1 certificado",hire:"-",expense:m(w(1)),revenue:`potencializa colaboradores em ${k(1)}%`}),a.jsx(Yi,{label:"Com 2 certificados",hire:"-",expense:m(w(2)),revenue:`potencializa colaboradores em ${k(2)}%`}),a.jsx(Yi,{label:"Com 3 certificados",hire:"-",expense:m(w(3)),revenue:`potencializa colaboradores em ${k(3)}%`})]})]}),a.jsxs("div",{style:et.summary,children:[a.jsxs("div",{children:["Custo de contratao (pagamento nico): ",a.jsxs("b",{children:["$ ",Number(e).toLocaleString()]})," / gestor"]}),a.jsxs("div",{children:["Despesa mensal recorrente (OPEX): ",a.jsxs("b",{children:["$ ",Number(n).toLocaleString()]})," / gestor"]})]}),a.jsxs("div",{style:et.summaryStrong,children:[a.jsxs("div",{children:["Total contratar: ",a.jsxs("b",{children:["$ ",Number(S).toLocaleString()]})]}),a.jsxs("div",{children:["Despesa mensal total: ",a.jsxs("b",{children:["$ ",Number(y).toLocaleString()]})]})]}),a.jsxs("div",{style:et.actions,children:[a.jsx("button",{type:"button",style:{...et.bigBtn,background:"#666",color:"#fff"},onClick:R,children:"No comprar"}),a.jsxs("button",{type:"button",style:{...et.bigBtn,background:f?"#3fbf49":"#2f5d33",color:"#09110f"},onClick:E,disabled:!f,title:f?g<S?"Saldo insuficiente":void 0:"Informe uma quantidade vlida",children:["Comprar ",f?`(${b})`:""]})]})]})})}function Yi({label:t,hire:e,expense:n,revenue:r}){const s=o=>typeof o=="number"?`$ ${Number(o).toLocaleString()}`:o;return a.jsxs("div",{style:et.tr,children:[a.jsx("div",{style:et.td,children:t}),a.jsx("div",{style:et.td,children:s(e)}),a.jsx("div",{style:et.td,children:s(n)}),a.jsx("div",{style:et.td,children:r})]})}const et={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(880px, 92vw)",maxWidth:880,background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px 20px 16px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:800,lineHeight:1.3},inlineInfo:{display:"flex",justifyContent:"space-between",gap:10,margin:"0 0 8px",opacity:.95,fontWeight:700,flexWrap:"wrap"},qtyRow:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},input:{flex:"1 1 260px",height:42,borderRadius:10,padding:"0 12px",border:"1px solid rgba(255,255,255,.18)",background:"#0f1320",color:"#fff",outline:"none"},quickBtns:{display:"flex",gap:6,flexWrap:"wrap"},qbtn:{height:42,padding:"0 12px",borderRadius:10,border:"1px solid rgba(255,255,255,.18)",background:"#2a2f3b",color:"#fff",cursor:"pointer",fontWeight:800},infoBox:{border:"1px solid rgba(255,255,255,.12)",borderRadius:12,padding:"12px",background:"#101522",marginBottom:12},table:{border:"1px solid rgba(255,255,255,.12)",borderRadius:10,overflow:"hidden"},trHead:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 3fr",background:"#121621"},th:{padding:"10px 12px",fontWeight:800,borderLeft:"1px solid rgba(255,255,255,.06)"},tr:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 3fr",background:"#0f1320"},td:{padding:"10px 12px",borderTop:"1px solid rgba(255,255,255,.06)",borderLeft:"1px solid rgba(255,255,255,.06)"},summary:{display:"flex",justifyContent:"space-between",border:"1px dashed rgba(255,255,255,.2)",borderRadius:10,padding:"8px 12px",marginTop:10,flexWrap:"wrap",gap:10},summaryStrong:{display:"flex",justifyContent:"space-between",border:"1px solid rgba(255,255,255,.25)",borderRadius:10,padding:"10px 12px",marginTop:8,fontWeight:800,flexWrap:"wrap",gap:10},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:12,flexWrap:"wrap"},bigBtn:{minWidth:180,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function qf({onResolve:t,unitHire:e=3e3,unitExpense:n=Oe.field.baseDesp,attendsUpTo:r=Oe.field.cap,currentCash:s=0}){const o=j.useRef(null),i=j.useRef(null),{pushModal:l,awaitTop:u}=An(),[c,d]=j.useState(""),h=Number(e||0),p=Number(n||0),g=Number(s||0),b=j.useMemo(()=>{const C=Math.floor(Number(c));return Number.isFinite(C)&&C>0?C:0},[c]),x=j.useMemo(()=>h<=0?0:Math.max(0,Math.floor(g/h)),[g,h]),S=b*h,y=b*p,f=Oe.field.baseFat,m=b*f,w=b>0,k=C=>`$ ${Number(C||0).toLocaleString()}`,D=C=>Oe.field.baseDesp+Oe.field.incDesp*Math.max(0,C),R=C=>Oe.field.baseFat+Oe.field.incFat*Math.max(0,C),E=C=>{const P=Math.floor(Number(C)||0),I=Math.max(0,Math.min(P,1e6));d(String(I))},N=C=>{var P,I;(P=C==null?void 0:C.preventDefault)==null||P.call(C),(I=C==null?void 0:C.stopPropagation)==null||I.call(C),t==null||t({action:"SKIP"})},v=async()=>{if(w){if(g<S){l(a.jsx(Cr,{requiredAmount:S,currentCash:g,title:"Saldo insuficiente para contratar Field Sales",message:"Voc no possui saldo suficiente para concluir esta contratao.",okLabel:"Entendi"})),await u();return}t==null||t({action:"BUY",qty:b,unitHire:h,unitExpense:p,totalHire:S,totalExpense:y,cashDelta:-S,expenseDelta:y,revenueDelta:m,cost:S,total:S,role:"FIELD"})}};return j.useEffect(()=>{const C=document.body.style.overflow;document.body.style.overflow="hidden";const P=setTimeout(()=>{var X,ke;return(ke=(X=o.current)==null?void 0:X.focus)==null?void 0:ke.call(X)},0),I=setTimeout(()=>{var X,ke;return(ke=(X=i.current)==null?void 0:X.focus)==null?void 0:ke.call(X)},50),H=X=>{X.key==="Enter"&&(X.preventDefault(),v())};return window.addEventListener("keydown",H),()=>{document.body.style.overflow=C,window.removeEventListener("keydown",H),clearTimeout(P),clearTimeout(I)}},[]),a.jsx("div",{style:tt.wrap,role:"dialog","aria-modal":"true",onMouseDown:C=>{C.target===C.currentTarget&&C.stopPropagation()},children:a.jsxs("div",{style:tt.card,onMouseDown:C=>C.stopPropagation(),children:[a.jsx("button",{ref:o,type:"button",style:tt.close,onClick:N,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:tt.title,children:["Voc pode escolher quantos ",a.jsx("b",{children:"Field Sales"})," quer comprar,",a.jsx("br",{}),"Digite o nmero de vendedores:"]}),a.jsxs("div",{style:tt.inlineInfo,children:[a.jsxs("div",{children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",g.toLocaleString()]})]}),a.jsxs("div",{children:["Mximo por saldo: ",a.jsx("b",{children:x})]})]}),a.jsxs("div",{style:tt.qtyRow,children:[a.jsx("input",{ref:i,type:"number",inputMode:"numeric",min:1,placeholder:"Digite o nmero de Field Sales",value:c,onChange:C=>E(C.target.value),style:tt.input}),a.jsxs("div",{style:tt.quickBtns,children:[a.jsx("button",{type:"button",style:tt.qbtn,onClick:()=>E(b+1),children:"+1"}),a.jsx("button",{type:"button",style:tt.qbtn,onClick:()=>E(b+5),children:"+5"}),a.jsx("button",{type:"button",style:tt.qbtn,onClick:()=>E(b+10),children:"+10"}),a.jsx("button",{type:"button",style:tt.qbtn,onClick:()=>E(x),title:"Comprar o mximo possvel com o saldo atual",children:"Mx"})]})]}),a.jsxs("div",{style:tt.infoBox,children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"FIELD SALES (REPRESENTANTES COMERCIAIS)"}),a.jsxs("div",{style:{opacity:.9,marginBottom:8},children:["Base para clculo de despesa: ",a.jsx("b",{children:"x quantidade de Field Sales"}),".",a.jsx("br",{}),"Base para clculo de faturamento: ",a.jsx("b",{children:"x quantidade mxima de clientes que cada vendedor pode atender"}),".",a.jsx("br",{}),"Cada vendedor atende at ",a.jsx("b",{children:r})," clientes."]}),a.jsxs("div",{style:tt.table,children:[a.jsxs("div",{style:tt.trHead,children:[a.jsx("div",{style:tt.th,children:"Certificao"}),a.jsx("div",{style:tt.th,children:"Contratao"}),a.jsx("div",{style:tt.th,children:"Despesa"}),a.jsx("div",{style:tt.th,children:"Faturamento"})]}),a.jsx(Qi,{label:"S/ Certificado",hire:k(e),expense:k(D(0)),revenue:k(R(0))}),a.jsx(Qi,{label:"Com 1 certificado",hire:"-",expense:k(D(1)),revenue:k(R(1))}),a.jsx(Qi,{label:"Com 2 certificados",hire:"-",expense:k(D(2)),revenue:k(R(2))}),a.jsx(Qi,{label:"Com 3 certificados",hire:"-",expense:k(D(3)),revenue:k(R(3))})]})]}),a.jsxs("div",{style:tt.summary,children:[a.jsxs("div",{children:["Custo de contratao (pagamento nico): ",a.jsxs("b",{children:["$ ",Number(e).toLocaleString()]})," / vendedor"]}),a.jsxs("div",{children:["Despesa mensal recorrente (OPEX): ",a.jsxs("b",{children:["$ ",Number(n).toLocaleString()]})," / vendedor"]})]}),a.jsxs("div",{style:tt.summaryStrong,children:[a.jsxs("div",{children:["Total contratar: ",a.jsxs("b",{children:["$ ",Number(S).toLocaleString()]})]}),a.jsxs("div",{children:["Despesa mensal total: ",a.jsxs("b",{children:["$ ",Number(y).toLocaleString()]})]})]}),a.jsxs("div",{style:tt.actions,children:[a.jsx("button",{type:"button",style:{...tt.bigBtn,background:"#666",color:"#fff"},onClick:N,children:"No comprar"}),a.jsxs("button",{type:"button",style:{...tt.bigBtn,background:w?"#75e16c":"#365b31",color:"#0b120a"},onClick:v,disabled:!w,title:w?g<S?"Saldo insuficiente":void 0:"Informe uma quantidade vlida",children:["Comprar ",w?`(${b})`:""]})]})]})})}function Qi({label:t,hire:e,expense:n,revenue:r}){return a.jsxs("div",{style:tt.tr,children:[a.jsx("div",{style:tt.td,children:t}),a.jsx("div",{style:tt.td,children:e}),a.jsx("div",{style:tt.td,children:n}),a.jsx("div",{style:tt.td,children:r})]})}const tt={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(880px, 92vw)",maxWidth:880,background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px 20px 16px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:800,lineHeight:1.3},inlineInfo:{display:"flex",justifyContent:"space-between",gap:10,margin:"0 0 8px",opacity:.95,fontWeight:700,flexWrap:"wrap"},qtyRow:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},input:{flex:"1 1 260px",height:42,borderRadius:10,padding:"0 12px",border:"1px solid rgba(255,255,255,.18)",background:"#0f1320",color:"#fff",outline:"none"},quickBtns:{display:"flex",gap:6,flexWrap:"wrap"},qbtn:{height:42,padding:"0 12px",borderRadius:10,border:"1px solid rgba(255,255,255,.18)",background:"#2a2f3b",color:"#fff",cursor:"pointer",fontWeight:800},infoBox:{border:"1px solid rgba(255,255,255,.12)",borderRadius:12,padding:"12px",background:"#101522",marginBottom:12},table:{border:"1px solid rgba(255,255,255,.12)",borderRadius:10,overflow:"hidden"},trHead:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",background:"#121621"},th:{padding:"10px 12px",fontWeight:800,borderLeft:"1px solid rgba(255,255,255,.06)"},tr:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",background:"#0f1320"},td:{padding:"10px 12px",borderTop:"1px solid rgba(255,255,255,.06)",borderLeft:"1px solid rgba(255,255,255,.06)"},summary:{display:"flex",justifyContent:"space-between",border:"1px dashed rgba(255,255,255,.2)",borderRadius:10,padding:"8px 12px",marginTop:10,flexWrap:"wrap",gap:10},summaryStrong:{display:"flex",justifyContent:"space-between",border:"1px solid rgba(255,255,255,.25)",borderRadius:10,padding:"10px 12px",marginTop:8,fontWeight:800,flexWrap:"wrap",gap:10},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:12,flexWrap:"wrap"},bigBtn:{minWidth:180,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function Hf({onResolve:t,unitHire:e=1500,unitExpense:n=Oe.comum.baseDesp,attendsUpTo:r=Oe.comum.cap,currentCash:s=0}){const[o,i]=j.useState(""),l=j.useRef(null),u=j.useRef(null),{pushModal:c,awaitTop:d}=An(),h=Number(e||0),p=Number(n||0),g=Number(s||0),b=Oe.comum.baseFat,x=v=>`$ ${Number(v||0).toLocaleString()}`,S=v=>Oe.comum.baseDesp+Oe.comum.incDesp*Math.max(0,v),y=v=>Oe.comum.baseFat+Oe.comum.incFat*Math.max(0,v),f=j.useMemo(()=>{const v=Math.floor(Number(o));return Number.isFinite(v)&&v>0?v:0},[o]),m=j.useMemo(()=>h<=0?0:Math.max(0,Math.floor(g/h)),[g,h]),w=j.useMemo(()=>f*h,[f,h]),k=j.useMemo(()=>f*p,[f,p]),D=f>0,R=v=>{const C=Math.floor(Number(v)||0),P=Math.max(0,Math.min(C,1e6));i(String(P))},E=v=>{var C;(C=v==null?void 0:v.stopPropagation)==null||C.call(v),t==null||t({action:"SKIP"})},N=async()=>{if(!D)return;if(g<w){c(a.jsx(Cr,{requiredAmount:w,currentCash:g,title:"Saldo insuficiente para contratar vendedores",message:"Voc no possui saldo suficiente para concluir esta contratao.",okLabel:"Entendi"})),await d();return}const v={action:"BUY",role:"COMMON",qty:f,headcount:f,unitHire:h,unitExpense:p,totalHire:w,totalExpense:k,total:w,cost:w,attendsUpTo:r,cashDelta:-w,expenseDelta:k,revenueDelta:b*f,revenuePerSeller:b,hudUpdate:{category:"Vendedores Comuns",addQty:f}};t==null||t(v)};return j.useEffect(()=>{const v=document.body.style.overflow;document.body.style.overflow="hidden";const C=setTimeout(()=>{var H,X;return(X=(H=l.current)==null?void 0:H.focus)==null?void 0:X.call(H)},0),P=setTimeout(()=>{var H,X;return(X=(H=u.current)==null?void 0:H.focus)==null?void 0:X.call(H)},50),I=H=>{H.key==="Enter"&&(H.preventDefault(),N())};return window.addEventListener("keydown",I),()=>{document.body.style.overflow=v,window.removeEventListener("keydown",I),clearTimeout(C),clearTimeout(P)}},[]),a.jsx("div",{style:nt.wrap,role:"dialog","aria-modal":"true","aria-label":"Comprar Vendedores Comuns",onMouseDown:v=>{v.target===v.currentTarget&&v.stopPropagation()},children:a.jsxs("div",{style:nt.card,onMouseDown:v=>v.stopPropagation(),children:[a.jsx("button",{ref:l,type:"button",style:nt.close,onClick:E,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:nt.title,children:["Voc pode escolher quantos ",a.jsx("b",{children:"Vendedores Comuns"})," quer comprar,",a.jsx("br",{}),"Digite o nmero de vendedores:"]}),a.jsxs("div",{style:nt.inlineInfo,children:[a.jsxs("div",{children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",g.toLocaleString()]})]}),a.jsxs("div",{children:["Mximo por saldo: ",a.jsx("b",{children:m})]})]}),a.jsxs("div",{style:nt.qtyRow,children:[a.jsx("input",{ref:u,type:"number",inputMode:"numeric",min:1,placeholder:"Digite o nmero de Vendedores Comuns",value:o,onChange:v=>R(v.target.value),style:nt.input}),a.jsxs("div",{style:nt.quickBtns,children:[a.jsx("button",{type:"button",style:nt.qbtn,onClick:()=>R(f+1),children:"+1"}),a.jsx("button",{type:"button",style:nt.qbtn,onClick:()=>R(f+5),children:"+5"}),a.jsx("button",{type:"button",style:nt.qbtn,onClick:()=>R(f+10),children:"+10"}),a.jsx("button",{type:"button",style:nt.qbtn,onClick:()=>R(m),title:"Comprar o mximo possvel com o saldo atual",children:"Mx"})]})]}),a.jsxs("div",{style:nt.infoBox,children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"VENDEDOR COMUM (FAZ TUDO)"}),a.jsxs("div",{style:{opacity:.9,marginBottom:8},children:["Base para clculo despesa: ",a.jsx("b",{children:"x quantidade vendedor comum"}),".",a.jsx("br",{}),"Base para clculo faturamento: ",a.jsx("b",{children:"x quantidade mxima de clientes que cada vendedor pode atender"}),".",a.jsx("br",{}),a.jsxs("b",{children:["Atende at ",r," clientes"]}),"."]}),a.jsxs("div",{style:nt.table,children:[a.jsxs("div",{style:nt.trHead,children:[a.jsx("div",{style:nt.th,children:"Certificao"}),a.jsx("div",{style:nt.th,children:"Contratao"}),a.jsx("div",{style:nt.th,children:"Despesa"}),a.jsx("div",{style:nt.th,children:"Faturamento"})]}),a.jsx(Xi,{label:"S/ Certificado",hire:x(e),expense:x(S(0)),revenue:x(y(0))}),a.jsx(Xi,{label:"Com 1 certificado",hire:"-",expense:x(S(1)),revenue:x(y(1))}),a.jsx(Xi,{label:"Com 2 certificados",hire:"-",expense:x(S(2)),revenue:x(y(2))}),a.jsx(Xi,{label:"Com 3 certificados",hire:"-",expense:x(S(3)),revenue:x(y(3))})]})]}),a.jsxs("div",{style:nt.summary,children:[a.jsxs("div",{children:["Custo de contratao (pagamento nico): ",a.jsxs("b",{children:["$ ",Number(e).toLocaleString()]})," / vendedor"]}),a.jsxs("div",{children:["Despesa mensal recorrente (OPEX): ",a.jsxs("b",{children:["$ ",Number(n).toLocaleString()]})," / vendedor"]})]}),a.jsxs("div",{style:nt.summaryStrong,children:[a.jsxs("div",{children:["Total contratar: ",a.jsxs("b",{children:["$ ",Number(w).toLocaleString()]})]}),a.jsxs("div",{children:["Despesa mensal total: ",a.jsxs("b",{children:["$ ",Number(k).toLocaleString()]})]})]}),a.jsxs("div",{style:nt.actions,children:[a.jsx("button",{type:"button",style:{...nt.bigBtn,background:"#666",color:"#fff"},onClick:E,children:"No comprar"}),a.jsx("button",{type:"button",disabled:!D,style:{...nt.bigBtn,background:D?"#7cbe1a":"#3a3f4a",color:"#0d1200",fontWeight:900},onClick:N,title:D?g<w?"Saldo insuficiente":void 0:"Informe uma quantidade vlida",children:"Comprar"})]})]})})}function Xi({label:t,hire:e,expense:n,revenue:r}){return a.jsxs("div",{style:nt.tr,children:[a.jsx("div",{style:nt.td,children:t}),a.jsx("div",{style:nt.td,children:e}),a.jsx("div",{style:nt.td,children:n}),a.jsx("div",{style:nt.td,children:r})]})}const nt={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(880px, 92vw)",maxWidth:880,background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px 20px 16px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:800,lineHeight:1.3},inlineInfo:{display:"flex",justifyContent:"space-between",gap:10,margin:"0 0 8px",opacity:.95,fontWeight:700,flexWrap:"wrap"},qtyRow:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},input:{flex:"1 1 260px",height:42,borderRadius:10,padding:"0 12px",border:"1px solid rgba(255,255,255,.18)",background:"#111522",color:"#eef2f7",outline:"none"},quickBtns:{display:"flex",gap:6,flexWrap:"wrap"},qbtn:{height:42,padding:"0 12px",borderRadius:10,border:"1px solid rgba(255,255,255,.18)",background:"#2a2f3b",color:"#fff",cursor:"pointer",fontWeight:800},infoBox:{background:"#161a28",border:"1px solid rgba(255,255,255,.12)",borderRadius:14,padding:14,marginTop:6},table:{border:"1px solid rgba(255,255,255,.12)",borderRadius:12,overflow:"hidden",marginTop:8},trHead:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",background:"#121621"},th:{padding:"10px 12px",fontWeight:800,borderLeft:"1px solid rgba(255,255,255,.06)"},tr:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",background:"#0f1320"},td:{padding:"10px 12px",borderTop:"1px solid rgba(255,255,255,.06)",borderLeft:"1px solid rgba(255,255,255,.06)"},summary:{display:"flex",justifyContent:"space-between",border:"1px dashed rgba(255,255,255,.2)",borderRadius:10,padding:"8px 12px",marginTop:10,flexWrap:"wrap",gap:10},summaryStrong:{display:"flex",justifyContent:"space-between",border:"1px solid rgba(255,255,255,.25)",borderRadius:10,padding:"10px 12px",marginTop:8,fontWeight:800,flexWrap:"wrap",gap:10},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:12,flexWrap:"wrap"},bigBtn:{minWidth:180,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function Kf({onResolve:t,currentCash:e,currentLevel:n=null,mixOwned:r=null}){const s=j.useRef(null),{pushModal:o,awaitTop:i}=An(),l={A:{compra:12e3,despesa:cr.A.despPerClient,faturamento:cr.A.fatPerClient,color:"#1d4ed8",pill:"NVEL A",label:"100 produtos"},B:{compra:6e3,despesa:cr.B.despPerClient,faturamento:cr.B.fatPerClient,color:"#16a34a",pill:"NVEL B",label:"50 produtos"},C:{compra:3e3,despesa:cr.C.despPerClient,faturamento:cr.C.fatPerClient,color:"#f59e0b",pill:"NVEL C",label:"20 produtos"},D:{compra:1e3,despesa:cr.D.despPerClient,faturamento:cr.D.fatPerClient,color:"#6b7280",pill:"NVEL D",label:"5 produtos"}};async function u(d){if(r?r[d]===!0:n===d)return;const p=l[d],g=Number((p==null?void 0:p.compra)||0),b=Number(e);if(Number.isFinite(b)&&b>=0&&b<g){o(a.jsx(Cr,{requiredAmount:g,currentCash:b,title:"Saldo insuficiente para adquirir o Mix de Produtos",message:`Voc precisa de $ ${g.toLocaleString()} mas possui $ ${b.toLocaleString()}.`,okLabel:"Entendi"})),await i();return}t==null||t({action:"BUY",level:d,...p})}function c(){t==null||t({action:"SKIP"})}return j.useEffect(()=>{const d=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var h,p;return(p=(h=s.current)==null?void 0:h.focus)==null?void 0:p.call(h)},0),()=>{document.body.style.overflow=d}},[]),a.jsx("div",{style:xn.wrap,role:"dialog","aria-modal":"true","aria-label":"Mix de Produtos",children:a.jsxs("div",{style:xn.card,children:[a.jsx("button",{ref:s,type:"button",style:xn.close,onClick:c,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:xn.title,children:["Escolha um ",a.jsx("b",{children:"mix de produtos"}),":"]}),a.jsxs("div",{style:xn.note,children:[a.jsx("div",{style:{fontWeight:900,marginBottom:4},children:"MIX DE PRODUTOS"}),a.jsxs("div",{children:["Base para clculo de ",a.jsx("b",{children:"Despesa"}),"/",a.jsx("b",{children:"Faturamento"}),": multiplicar pela ",a.jsx("b",{children:"quantidade total de clientes"}),"."]})]}),Number.isFinite(Number(e))&&a.jsxs("div",{style:xn.saldo,children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",Number(e||0).toLocaleString()]})]}),a.jsx("div",{style:xn.cards,children:["A","B","C","D"].map(d=>{const h=l[d],p=r?r[d]===!0:n===d,g=p;return a.jsxs("div",{style:{...xn.cardItem,borderColor:p?"#16a34a":"rgba(255,255,255,.15)",opacity:g?.6:1},children:[a.jsx("div",{style:{...xn.pill,background:p?"#16a34a":"#fff",color:p?"#fff":"#111"},children:p?" ADQUIRIDO":h.pill}),a.jsx("div",{style:{...xn.cardBadge,background:h.color}}),a.jsxs("ul",{style:xn.lines,children:[a.jsx("li",{children:a.jsx("b",{children:h.label})}),a.jsxs("li",{children:["Compra: ",a.jsxs("b",{children:["$ ",h.compra.toLocaleString()]})]}),a.jsxs("li",{children:["Despesa: ",a.jsxs("b",{children:["$ ",h.despesa.toLocaleString()]})]}),a.jsxs("li",{children:["Faturamento: ",a.jsxs("b",{children:["$ ",h.faturamento.toLocaleString()]})]})]}),a.jsx("button",{type:"button",style:{...xn.buyBtn,background:g?"#6b7280":"#2442f9",cursor:g?"not-allowed":"pointer"},onClick:()=>u(d),disabled:g,title:g?`Mix nvel ${d} j adquirido`:`Comprar Mix de Produtos ${d}`,children:g?"J Adquirido":`Comprar ${d}`})]},d)})}),a.jsx("div",{style:xn.actions,children:a.jsx("button",{type:"button",style:{...xn.bigBtn,background:"#444",color:"#fff"},onClick:c,children:"No comprar"})})]})})}const xn={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(980px, 94vw)",background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:900},note:{background:"#2a2f3b",border:"1px solid rgba(255,255,255,.15)",borderRadius:12,padding:"10px 12px",margin:"0 0 10px"},saldo:{margin:"0 0 10px",padding:"8px 12px",border:"1px dashed rgba(255,255,255,.25)",borderRadius:10},cards:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:12,marginTop:8},cardItem:{background:"#0f1320",border:"1px solid",borderRadius:14,padding:"12px",display:"flex",flexDirection:"column",gap:8},cardBadge:{width:"100%",height:6,borderRadius:999,opacity:.9},pill:{alignSelf:"flex-start",fontSize:12,fontWeight:900,padding:"4px 8px",borderRadius:999,color:"#111"},lines:{margin:0,padding:"0 0 0 16px",lineHeight:1.35},buyBtn:{marginTop:"auto",padding:"10px 12px",borderRadius:10,border:"none",fontWeight:900,cursor:"pointer",background:"#2442f9",color:"#fff"},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:14},bigBtn:{minWidth:160,padding:"14px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function Eb({onResolve:t,player:e={}}){const n=j.useRef(null),r=(f,m=0)=>Number.isFinite(Number(f))?Number(f):m,s=f=>r(f.am,0)>0,o=f=>r(f.az,0)>0,i=f=>{var w,k;const m=(f==null?void 0:f.certPurple)??((w=f==null?void 0:f.certs)==null?void 0:w.purple)??((k=f==null?void 0:f.certificates)==null?void 0:k.purple)??(f==null?void 0:f.cert_roxo)??(f==null?void 0:f.rox)??0;return m===!0||Number(m)>0},l=f=>{var w;const m=(f==null?void 0:f.mixLevel)??((w=f==null?void 0:f.mixProdutos)==null?void 0:w.level)??(f==null?void 0:f.mixProdutos)??(f==null?void 0:f.mix)??"D";return String(m||"D").toUpperCase()},u=f=>l(f)==="A",c=f=>String(f.erpLevel||f.erpSistemas||"D").toUpperCase()==="A",d=f=>{const m=String(f.mixProdutos||"D").toUpperCase();return m==="A"||m==="B"},h=f=>{var w;const m=k=>{if(!k)return 0;try{const D=Array.isArray(k)?k:Object.values(k);return new Set(D).size}catch{return 0}};return(w=f.trainingsByVendor)!=null&&w.gestor?m(f.trainingsByVendor.gestor):r(f.gestoresCertificados,0)},p=f=>r(f.vendedoresComuns)+r(f.insideSales)+r(f.fieldSales)+r(f.gestores??f.gestoresComerciais??f.managers),g=j.useMemo(()=>[{id:"gov_fgts",kind:"SORTE",title:"Ao Governamental Positiva",text:"Liberao de FGTS aumentou o poder de compra. Receba 5 novos clientes (se tiver equipe para atender).",clientsDelta:5},{id:"referral_bonus",kind:"SORTE",title:"Indicao Lucrativa",text:"Um cliente indicou amigos e a primeira compra foi tima. Receba R$ 800,00.",cashDelta:800},{id:"network_cert_mgr",kind:"SORTE",title:"Rede Estratgica",text:"Para cada gestor com certificado, receba R$ 5.000,00.",_compute:f=>({cashDelta:5e3*h(f)})},{id:"innovation_invest",kind:"SORTE",title:"Inovao Premiada",text:"Se tiver infraestrutura (mix/sistemas) nvel A ou B, receba aporte de R$ 25.000,00.",_compute:f=>({cashDelta:d(f)?25e3:0})},{id:"segmentation",kind:"SORTE",title:"Segmentao Inteligente",text:"Novo segmento lucrativo. Receba R$ 1.000,00.",cashDelta:1e3},{id:"casa_bonus_10k",kind:"SORTE",title:"Casagrande Insights",text:"Implementao bem-sucedida. Receba R$ 10.000,00.",cashDelta:1e4},{id:"casa_network_7k",kind:"SORTE",title:"Rede de Contatos Valiosa",text:"Parceria estratgica. Ganhe R$ 7.000,00.",cashDelta:7e3},{id:"casa_strategy_5k",kind:"SORTE",title:"Estratgia Personalizada",text:"Processos melhorados. Receba R$ 5.000,00.",cashDelta:5e3},{id:"casa_best_practices_8k",kind:"SORTE",title:"Melhores Prticas",text:"Eficincia aumentada. Receba R$ 8.000,00.",cashDelta:8e3},{id:"casa_start_6k",kind:"SORTE",title:"Satisfao do Cliente em Alta",text:"Fidelidade e vendas sobem. Receba R$ 6.000,00.",cashDelta:6e3},{id:"casa_change_cert_blue",kind:"SORTE",title:"Gesto de Mudanas Bem-sucedida",text:"Um vendedor generalista concluiu todos os treinamentos. Ganhe um certificado AZUL para esse vendedor.",_compute:()=>({certDelta:{az:1}})},{id:"training_roi_team",kind:"SORTE",title:"Treinamento Personalizado",text:"Receba R$ 500,00 por membro participante.",_compute:f=>({cashDelta:500*Math.max(0,p(f))})},{id:"purple_award_25k",kind:"SORTE",title:"Profissional do Ano (Roxo)",text:"Se houver pelo menos um colaborador com certificado roxo, receba R$ 25.000,00.",_compute:f=>({cashDelta:i(f)?25e3:0})},{id:"reputation_1500",kind:"SORTE",title:"Reputao Impecvel",text:"timas avaliaes elevam a confiana. Receba R$ 1.500,00.",cashDelta:1500},{id:"client_cheer_per_client",kind:"SORTE",title:"Cliente Promotor",text:"Ganhe R$ 500,00 por cada cliente atual.",_compute:f=>({cashDelta:500*Math.max(0,r(f.clients))})},{id:"big_order_freight_save",kind:"SORTE",title:"Grande Pedido + Frete Econmico",text:"Receba R$ 1.500,00.",cashDelta:1500},{id:"sales_win_2k",kind:"SORTE",title:"Vitria de Vendas",text:"Venda aguardada foi fechada. Receba R$ 2.000,00.",cashDelta:2e3},{id:"missed_admission",kind:"REVES",title:"Admisso No Reportada",text:"Multa governamental. Pague R$ 3.000,00.",cashDelta:-3e3},{id:"no_mix_a_pay_7000",kind:"REVES",title:"Mix A Ausente",text:"Se no tiver Mix nvel A, pague R$ 7.000,00.",_compute:f=>({cashDelta:u(f)?0:-7e3})},{id:"env_fine_20k",kind:"REVES",title:"Impacto Ambiental",text:"Multa ambiental. Pague R$ 20.000,00.",cashDelta:-2e4},{id:"key_client_at_risk",kind:"REVES",title:"Cliente Chave em Risco",text:"Sem certificado AMARELO: perca 1 cliente e pague R$ 2.000,00.",_compute:f=>s(f)?{clientsDelta:0,cashDelta:0,_overrideText:"Voc possui certificado amarelo. Nada acontece."}:{clientsDelta:-1,cashDelta:-2e3}},{id:"social_crisis",kind:"REVES",title:"Crise nas Redes",text:"Pague R$ 400,00 e perca 2 clientes.",cashDelta:-400,clientsDelta:-2},{id:"car_break",kind:"REVES",title:"Carro Quebrou",text:"Conserto urgente. Pague R$ 1.000,00.",cashDelta:-1e3},{id:"service_improvement_1k",kind:"REVES",title:"Aprimoramentos de Servio",text:"Pague R$ 1.000,00.",cashDelta:-1e3},{id:"recovery_failed_5k",kind:"REVES",title:"Recuperao Mal Sucedida",text:"Cancele grande pedido. Pague R$ 5.000,00.",cashDelta:-5e3},{id:"discount_pressure_1k",kind:"REVES",title:"Descontos Forados",text:"Presso por descontos reduziu sua margem. Pague R$ 1.000,00.",cashDelta:-1e3},{id:"domino_2k",kind:"REVES",title:"Efeito Domin",text:"Cancelamentos em cadeia. Perca R$ 2.000,00.",cashDelta:-2e3},{id:"needs_change_lose4",kind:"REVES",title:"Necessidades Mudaram",text:"Sem certificado AZUL: perca 4 clientes.",_compute:f=>o(f)?{clientsDelta:0,_overrideText:"Voc possui certificado azul. Nada acontece."}:{clientsDelta:-4}},{id:"payroll_error_1k",kind:"REVES",title:"Erro na Folha",text:"Corrigir problema. Pague R$ 1.000,00.",cashDelta:-1e3},{id:"strike_lose5",kind:"REVES",title:"Greve Inesperada",text:"Atrasos e perdas. Perca 5 clientes.",clientsDelta:-5},{id:"customs_hold_3k",kind:"REVES",title:"Alfndega",text:"Pague R$ 3.000,00.",cashDelta:-3e3},{id:"cyber_breach_7k_or_A",kind:"REVES",title:"Falha de Segurana",text:"Se NO tiver sistemas nvel A, pague R$ 7.000,00.",_compute:f=>({cashDelta:c(f)?0:-7e3})},{id:"supplier_issue_2k",kind:"REVES",title:"Fornecedor em Crise",text:"Expedio expressa. Pague R$ 2.000,00.",cashDelta:-2e3},{id:"reg_change_30k",kind:"REVES",title:"Regulamentao Nova",text:"Adequao de processos. Pague R$ 30.000,00.",cashDelta:-3e4},{id:"bad_mix_2500",kind:"REVES",title:"Mix de Produtos Desequilibrado",text:"Descontos e liquidaes. Pague R$ 2.500,00.",cashDelta:-2500},{id:"quality_crisis",kind:"REVES",title:"Crise de Qualidade",text:"Perca 1 cliente e pague R$ 1.000,00.",cashDelta:-1e3,clientsDelta:-1}],[]),[b]=j.useState(()=>g[Math.floor(Math.random()*g.length)]),x=j.useMemo(()=>{const f={action:"APPLY_CARD",kind:b.kind,id:b.id,title:b.title};if(typeof b._compute=="function"){const w=b._compute(e||{}),{_overrideText:k,...D}=w||{};return{text:k||b.text,payload:{...f,...D}}}const m={};return Number.isFinite(b.cashDelta)&&(m.cashDelta=Number(b.cashDelta)),Number.isFinite(b.clientsDelta)&&(m.clientsDelta=Number(b.clientsDelta)),{text:b.text,payload:{...f,...m}}},[b,e]),S=()=>t==null?void 0:t(x.payload),y=()=>t==null?void 0:t({action:"SKIP"});return j.useEffect(()=>{const f=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var m,w;return(w=(m=n.current)==null?void 0:m.focus)==null?void 0:w.call(m)},0),()=>{document.body.style.overflow=f}},[]),a.jsx("div",{style:Or.wrap,role:"dialog","aria-modal":"true","aria-label":"Sorte e Revs",children:a.jsxs("div",{style:Or.card,children:[a.jsx("button",{ref:n,style:Or.close,onClick:y,"aria-label":"Fechar",children:""}),a.jsx("div",{style:Or.badge(b.kind),children:b.kind==="SORTE"?"SORTE":"REVS"}),b.title&&a.jsx("h2",{style:Or.title,children:b.title}),a.jsx("p",{style:Or.text,children:x.text}),a.jsx("div",{style:Or.footer,children:a.jsx("button",{type:"button",style:Or.okBtn,onClick:S,children:"OK"})})]})})}const Or={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(760px, 92vw)",background:"#1b1f2a",color:"#e9ecf1",borderRadius:18,padding:"22px",border:"1px solid rgba(255,255,255,.12)",boxShadow:"0 10px 40px rgba(0,0,0,.4)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},badge:t=>({display:"inline-block",padding:"6px 12px",borderRadius:999,fontWeight:900,marginBottom:8,background:t==="SORTE"?"#22c55e":"#ef4444",color:"#111"}),title:{margin:"2px 0 6px",fontWeight:900},text:{fontSize:18,lineHeight:1.5,opacity:.95,margin:"6px 0 14px"},footer:{display:"flex",justifyContent:"center"},okBtn:{minWidth:140,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer",background:"#fff",color:"#111"}};function jb({value:t=0,onResolve:e}){const n=Number(t||0),r=s=>{var o,i;(o=s==null?void 0:s.preventDefault)==null||o.call(s),(i=s==null?void 0:s.stopPropagation)==null||i.call(s),e==null||e({action:"OK",value:n,source:{modal:"FaturamentoMesModal",file:"src/modals/FaturamentoMesModal.jsx"}})};return a.jsx(ki,{zIndex:2147483647,onClose:()=>e==null?void 0:e({action:"CLOSE",value:n,source:{modal:"FaturamentoMesModal",file:"src/modals/FaturamentoMesModal.jsx"}}),children:a.jsxs("div",{style:{padding:28,textAlign:"center",pointerEvents:"auto"},children:[a.jsx("div",{style:{fontWeight:900,fontSize:28,color:"#4caf50",letterSpacing:.5,marginBottom:6},children:"FATURAMENTO DO MS"}),a.jsx("div",{style:{opacity:.9,marginBottom:16},children:"Ser creditado o valor do Faturamento ao seu Saldo"}),a.jsxs("div",{style:{fontSize:18,marginBottom:24},children:["no valor de: ",a.jsxs("b",{children:["$ ",n.toLocaleString()]})]}),a.jsx("button",{type:"button",onClick:r,className:"btn",style:{minWidth:120,background:"#8bd65a",color:"#1a1f2a",fontWeight:800,borderRadius:10},children:"OK"})]})})}function Cb({expense:t=0,loanCharge:e=0,onResolve:n}){const r=Number(t||0)+Number(e||0),s=o=>{var i,l;(i=o==null?void 0:o.preventDefault)==null||i.call(o),(l=o==null?void 0:o.stopPropagation)==null||l.call(o),n==null||n({action:"OK",expense:Number(t||0),loanCharge:Number(e||0),total:Number(r||0),source:{modal:"DespesasOperacionaisModal",file:"src/modals/DespesasOperacionaisModal.jsx"}})};return a.jsx(ki,{zIndex:2147483647,onClose:()=>n==null?void 0:n({action:"CLOSE",source:{modal:"DespesasOperacionaisModal",file:"src/modals/DespesasOperacionaisModal.jsx"}}),children:a.jsxs("div",{style:{padding:28,textAlign:"center",pointerEvents:"auto"},children:[a.jsx("div",{style:{fontWeight:900,fontSize:26,color:"#ffb74d",letterSpacing:.5,marginBottom:6},children:"DESPESAS DO MS"}),a.jsxs("div",{style:{marginBottom:8},children:["Despesas operacionais:",a.jsxs("b",{children:["-$ ",Number(t).toLocaleString()]})]}),Number(e)>0&&a.jsxs("div",{style:{marginBottom:8,color:"#ffd54f"},children:["Emprstimo cobrado nesta rodada:",a.jsxs("b",{children:["-$ ",Number(e).toLocaleString()]})]}),a.jsxs("div",{style:{margin:"6px 0 18px",opacity:.85},children:["Total a debitar: ",a.jsxs("b",{children:["-$ ",r.toLocaleString()]})]}),a.jsx("button",{type:"button",onClick:s,className:"btn",style:{minWidth:120,background:"#ffcc80",color:"#1a1f2a",fontWeight:800,borderRadius:10},children:"OK"})]})})}const Ue={backdrop:{position:"fixed",inset:0,background:"rgba(0,0,0,.6)",display:"grid",placeItems:"center",zIndex:9999},card:{width:"min(920px, 96vw)",maxHeight:"90vh",overflow:"auto",background:"#15161a",color:"#e9ecf1",border:"1px solid rgba(255,255,255,.08)",borderRadius:20,boxShadow:"0 20px 50px rgba(0,0,0,.5)"},header:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"14px 16px",borderBottom:"1px solid rgba(255,255,255,.08)"},closeBtn:{width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"transparent",color:"#fff",fontSize:20,cursor:"pointer"},body:{padding:16},lead:{opacity:.95,lineHeight:1.5},bullets:{margin:"8px 0 16px 18px"},rowBtns:{display:"flex",gap:12,justifyContent:"flex-end",marginTop:12,flexWrap:"wrap"},cta:{padding:"12px 16px",border:0,borderRadius:12,color:"#fff",fontWeight:900,cursor:"pointer",boxShadow:"0 10px 24px rgba(0,0,0,.25)"},back:{padding:"10px 14px",borderRadius:12,border:"1px solid rgba(255,255,255,.15)",background:"transparent",color:"#e9ecf1",cursor:"pointer"},subHeader:{marginBottom:8},infoRow:{display:"flex",gap:8,alignItems:"baseline",margin:"4px 0"},input:{width:"100%",padding:"12px 12px",borderRadius:12,background:"#0f1115",color:"#fff",border:"1px solid rgba(255,255,255,.15)",marginTop:10},option:{padding:16,background:"rgba(255,255,255,.04)",border:"1px solid rgba(255,255,255,.08)",borderRadius:14,textAlign:"center",cursor:"pointer"},spin:{width:34,height:34,borderRadius:8,border:"1px solid rgba(255,255,255,.15)",background:"transparent",color:"#fff",fontSize:18,cursor:"pointer"}};function Rb({playerName:t,loanAvailable:e,hasPendingLoan:n,onGoLoan:r,onGoReduce:s,onGoFire:o,onDeclareBankruptcy:i}){return a.jsxs("div",{style:Ue.body,children:[a.jsxs("p",{style:Ue.lead,children:["Voc est sem dinheiro, ",t,". Escolha uma das opes:"]}),n&&a.jsx("div",{style:{...Ue.lead,color:"#ef4444",fontWeight:"bold",marginBottom:"16px"},children:" Voc j possui um emprstimo pendente. Cada jogador s pode ter um emprstimo por vez."}),a.jsxs("ul",{style:Ue.bullets,children:[a.jsxs("li",{children:["Pedir ",a.jsx("b",{children:"emprstimo"})," nico com 50% de juros garantido por 50% dos seus ",a.jsx("b",{children:"BENS"})," (limite ",`$ ${e}`,")."]}),a.jsxs("li",{children:[a.jsx("b",{children:"Reduzir"})," nveis de ",a.jsx("b",{children:"MIX de Produtos"})," ou ",a.jsx("b",{children:"ERP/Sistemas"})," e receber 50% do valor pago."]}),a.jsxs("li",{children:[a.jsx("b",{children:"Demitir"})," funcionrios e receber 50% do valor total."]})]}),a.jsxs("div",{style:Ue.rowBtns,children:[a.jsx("button",{style:{...Ue.cta,background:"#ef4444"},onClick:o,children:"DEMITIR"}),a.jsx("button",{style:{...Ue.cta,background:"#a16207"},onClick:s,children:"REDUZIR"}),a.jsx("button",{style:{...Ue.cta,background:n?"#6b7280":"#16a34a",cursor:n?"not-allowed":"pointer"},onClick:n?void 0:r,disabled:n,children:n?"EMPRSTIMO (J REALIZADO)":"EMPRSTIMO"}),a.jsx("button",{style:{...Ue.cta,background:"#d32f2f",fontWeight:"bold"},onClick:i,children:"DECLARAR FALNCIA"})]})]})}function Nb({loanAvailable:t,alreadyHasLoan:e=!1,onBack:n,onConfirm:r}){const[s,o]=j.useState(""),i=j.useMemo(()=>Math.max(0,Math.floor(Number(s)||0)),[s]),l=!e&&i>0&&i<=Number(t||0),u=()=>{if(e){r==null||r({type:"LOAN_DENIED",reason:"ALREADY_TAKEN"});return}const c=Math.max(0,Math.floor(Number(t)||0)),d=Math.max(0,Math.min(c,i));if(d>0){const h={type:"LOAN",amount:d,cashDelta:d,loan:{amount:d,charged:!1}};console.log("[DEBUG] RecoveryLoan enviando payload:",h),r==null||r(h)}else r==null||r({type:"LOAN_DENIED",reason:"INVALID_AMOUNT"})};return a.jsxs("div",{style:Ue.body,children:[a.jsx("div",{style:Ue.subHeader,children:a.jsx("b",{style:{fontSize:20},children:"EMPRSTIMO"})}),a.jsxs("p",{children:["Voc pode realizar um emprstimo colocando ",a.jsx("b",{children:"50% dos seus BENS"})," como garantia (pago na prxima Despesas Operacionais)."]}),a.jsxs("div",{style:Ue.infoRow,children:[a.jsx("span",{children:"Valor disponvel:"})," ",a.jsxs("b",{children:["$",Number(t||0)]})]}),a.jsxs("div",{style:Ue.infoRow,children:[a.jsx("span",{children:"Valor garantia:"})," ",a.jsxs("b",{children:["$",Number(t||0)]})]}),e&&a.jsx("div",{style:{...Ue.infoRow,color:"#fca5a5",border:"1px solid rgba(255,0,0,.25)",padding:"8px 10px",borderRadius:8,background:"rgba(255,0,0,.06)"},children:"Voc j possui um emprstimo ativo. No  possvel pegar outro."}),a.jsx("input",{style:Ue.input,type:"number",min:0,max:Math.max(0,Number(t||0)),placeholder:"Digite o valor que quer emprestar",value:s,onChange:c=>o(c.target.value),disabled:e}),a.jsxs("div",{style:{fontSize:12,opacity:.8,marginTop:6},children:["Mx: $",Number(t||0),"  valor ser somado ao seu saldo e cobrado na prxima Despesas Operacionais."]}),a.jsxs("div",{style:Ue.rowBtns,children:[a.jsx("button",{style:Ue.back,onClick:n,children:" Voltar"}),a.jsx("button",{style:{...Ue.cta,background:"#16a34a",opacity:l?1:.6,cursor:l?"pointer":"not-allowed"},onClick:u,disabled:!l,children:"Pegar Emprstimo"})]})]})}function Db(t){const{options:e=[],optionsMix:n,optionsErp:r,mixOwned:s,erpOwned:o,credits:i,snapshot:l,onBack:u,onConfirm:c}=t,d=(...v)=>console.log("[RecoveryReduce]",...v),h={MIX:{accent:"#06B6D4",soft:"rgba(6,182,212,.14)",ring:"rgba(6,182,212,.45)",glow:"rgba(6,182,212,.35)",pillBg:"rgba(6,182,212,.18)",pillFg:"#9FF1FF"},ERP:{accent:"#8B5CF6",soft:"rgba(139,92,246,.14)",ring:"rgba(139,92,246,.45)",glow:"rgba(139,92,246,.35)",pillBg:"rgba(139,92,246,.18)",pillFg:"#E9D5FF"}},p=["A","B","C","D"],g=(v,C,P)=>p.map(I=>({key:`${v}-${I}`,group:v,level:I,label:`Nvel ${I}`,credit:Number((C==null?void 0:C[I])??0),owned:!!(P!=null&&P[I])})),b=j.useMemo(()=>Array.isArray(n)&&n.length?n:i!=null&&i.MIX?g("MIX",i.MIX,s):g("MIX",{A:0,B:0,C:0,D:0},s),[n,i,s]),x=j.useMemo(()=>Array.isArray(r)&&r.length?r:i!=null&&i.ERP?g("ERP",i.ERP,o):g("ERP",{A:0,B:0,C:0,D:0},o),[r,i,o]);j.useEffect(()=>{console.groupCollapsed("[RecoveryReduce] props snapshot"),console.log("mixCards:",b),console.log("erpCards:",x),console.log("mixOwned:",s),console.log("erpOwned:",o),console.log("credits:",i),console.groupEnd()},[b,x,s,o,i]);const[S,y]=j.useState([]),[f,m]=j.useState(new Set),[w,k]=j.useState(!1),D=v=>{v.level!=="D"&&(!v.owned||v.owned===!1||f.has(v.key)||v.alreadyReduced||y(C=>C.some(I=>I.key===v.key)?C.filter(I=>I.key!==v.key):[...C,v]))},R=j.useMemo(()=>S.reduce((v,C)=>v+Number(C.credit||0),0),[S]),E=v=>S.some(C=>C.key===v.key),N=v=>{var Z,We;const C=E(v),P=v.level==="D",I=v.owned===!0,H=P||!I||f.has(v.key)||v.alreadyReduced||w,X=h[v.group]||h.MIX,ke={...Ue.option,position:"relative",borderRadius:14,background:H?"rgba(148,163,184,.12)":X.soft,border:C?`2.5px solid ${X.accent}`:"1px solid rgba(148,163,184,.25)",boxShadow:C?`0 0 0 2px ${X.ring}, 0 10px 24px ${X.glow}`:"none",cursor:H?"not-allowed":"pointer",opacity:H?.35:1,transition:"transform .06s ease-out, box-shadow .12s ease-out, border-color .12s"},je={fontWeight:900,fontSize:16,marginBottom:8,color:H?"#CBD5E1":"#E5F9FF"},F={fontWeight:700,marginTop:2,color:H?"#A1A1AA":"#FFFFFF"},oe={position:"absolute",top:8,right:8,fontSize:11,padding:"3px 8px",borderRadius:999,background:H?"rgba(148,163,184,.22)":X.pillBg,color:H?"#E5E7EB":X.pillFg,border:`1px solid ${H?"rgba(148,163,184,.35)":X.ring}`,letterSpacing:.2};return a.jsxs("button",{onClick:()=>D(v),disabled:H,"aria-pressed":C,style:ke,title:P?"Nvel D  o bsico e no pode ser reduzido.":I?f.has(v.key)?"Nvel j reduzido nesta sesso.":v.alreadyReduced?"Este nvel j foi reduzido anteriormente. Compre o nvel novamente para poder reduzir.":"":"Este nvel no est disponvel. Compre o nvel novamente para poder reduzir.",onMouseDown:he=>!H&&(he.currentTarget.style.transform="translateY(1px)"),onMouseUp:he=>he.currentTarget.style.transform="translateY(0)",onMouseLeave:he=>he.currentTarget.style.transform="translateY(0)",children:[a.jsx("span",{style:oe,children:P?"bsico":I?f.has(v.key)?"vendido":v.alreadyReduced?"j reduzido":"adquirido":"zerado"}),a.jsx("div",{style:je,children:v.label}),a.jsx("div",{style:{color:H?"#A1A1AA":"#BFEFFF"},children:"Crdito ao reduzir:"}),a.jsxs("div",{style:F,children:["$",((We=(Z=v.credit).toLocaleString)==null?void 0:We.call(Z))??v.credit]})]},v.key)};return a.jsxs("div",{style:Ue.body,children:[a.jsx("div",{style:Ue.subHeader,children:a.jsx("b",{style:{fontSize:20},children:"REDUZIR NVEL MIX/ERP"})}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[a.jsxs("div",{style:{padding:8,borderRadius:8,background:"rgba(255,255,255,0.05)"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"MIX PRODUTOS"}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:12},children:b.map(N)})]}),a.jsxs("div",{style:{padding:8,borderRadius:8,background:"rgba(255,255,255,0.05)"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"ERP/SISTEMAS"}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:12},children:x.map(N)})]})]}),a.jsxs("div",{style:{marginTop:10,display:"flex",justifyContent:"space-between",alignItems:"center",opacity:.92},children:[a.jsxs("div",{children:["Selecionados: ",a.jsx("b",{children:S.length}),"    Total: ",a.jsxs("b",{children:["$",R.toLocaleString()]})]}),a.jsx("div",{style:{fontSize:12,opacity:.7},children:"S  possvel selecionar nveis adquiridos."})]}),a.jsxs("div",{style:Ue.rowBtns,children:[a.jsx("button",{style:Ue.back,onClick:u,disabled:w,children:" Voltar"}),a.jsx("button",{style:{...Ue.cta,background:"#F59E0B",color:"#101010",fontWeight:900,opacity:S.length&&!w?1:.55},onClick:()=>{if(!S.length||w)return;k(!0),m(C=>{const P=new Set(C);return S.forEach(I=>P.add(I.key)),P});const v={items:S.map(C=>({...C,selected:!0})),total:R};d("confirm payload =>",v),c==null||c(v),y([]),k(!1)},disabled:!S.length||w,children:"REDUZIR"})]})]})}function Ab({roles:t=[],onBack:e,onConfirm:n}){const r=j.useMemo(()=>t.map(p=>{const g=Number(p.unit??p.total??0),b=Number(p.owned??p.qty??0);return{...p,unit:g,owned:b}}),[t]),[s,o]=j.useState(()=>{const p={};return r.forEach(g=>{p[g.key]=0}),p}),i=p=>`R$ ${Number(p||0).toLocaleString("pt-BR")}`,l=p=>Math.floor(Number(p||0)*.5),u=(p,g)=>{o(b=>{const x=r.find(f=>f.key===p);if(!x)return b;const S=Number(b[p]||0),y=Math.max(0,Math.min(x.owned,S+g));return y===S?b:{...b,[p]:y}})},c=j.useMemo(()=>{const p={};return r.forEach(g=>{const b=Number(s[g.key]||0);p[g.key]=l(g.unit)*b}),p},[s,r]),d=j.useMemo(()=>Object.values(c).reduce((p,g)=>p+g,0),[c]),h=()=>{if(d<=0)return;const p={};r.forEach(g=>{p[g.key]=Number(s[g.key]||0)}),n==null||n({type:"FIRE",items:p,creditByRole:c,totalCredit:d,amount:d,note:`Demisses +${i(d)}`})};return a.jsxs("div",{style:Ue.body,children:[a.jsx("div",{style:Ue.subHeader,children:a.jsx("b",{style:{fontSize:20},children:"DEMITIR FUNCIONRIOS"})}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1.2fr 1fr 1.2fr 1fr",gap:8,opacity:.9,fontWeight:700,marginBottom:6},children:[a.jsx("div",{children:"Cargo"}),a.jsx("div",{children:"Valor Unitrio"}),a.jsx("div",{children:"Qtd demitir"}),a.jsx("div",{children:"Crdito"})]}),a.jsx("div",{style:{display:"grid",gap:12},children:r.map(p=>{const g=Number(s[p.key]||0),b=Number(p.unit||0),x=Number(p.owned||0),S=l(b),y=S*g,f=g<=0,m=g>=x||x<=0;return a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1.2fr 1fr 1.2fr 1fr",alignItems:"center",gap:8},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:800},children:p.label}),a.jsxs("div",{style:{opacity:.75,fontSize:12},children:["Possui: ",a.jsx("b",{children:x})]})]}),a.jsxs("div",{children:[a.jsx("div",{children:a.jsx("b",{children:i(b)})}),a.jsxs("div",{style:{opacity:.75,fontSize:12},children:["Crdito por un.: ",a.jsx("b",{children:i(S)})]})]}),a.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center"},children:[a.jsx("button",{style:{...Ue.spin,opacity:f?.5:1,cursor:f?"not-allowed":"pointer"},disabled:f,onClick:()=>u(p.key,-1),children:"-"}),a.jsx("div",{style:{minWidth:28,textAlign:"center",fontWeight:800},children:g}),a.jsx("button",{style:{...Ue.spin,opacity:m?.5:1,cursor:m?"not-allowed":"pointer"},disabled:m,onClick:()=>u(p.key,1),children:"+"})]}),a.jsx("div",{children:a.jsx("b",{children:i(y)})})]},p.key)})}),a.jsxs("div",{style:{marginTop:12,textAlign:"right",fontWeight:900},children:["Total a resgatar: ",a.jsx("b",{children:i(d)})]}),a.jsxs("div",{style:Ue.rowBtns,children:[a.jsx("button",{style:Ue.back,onClick:e,children:" Voltar"}),a.jsx("button",{style:{...Ue.cta,background:"#ef4444",opacity:d>0?1:.6},onClick:h,disabled:d<=0,children:"DEMITIR"})]})]})}function Jf({playerName:t="Jogador",bens:e=0,currentPlayer:n,canClose:r=!0}){var N;const{resolveTop:s,popModal:o}=(An==null?void 0:An())||{},[i,l]=j.useState("menu"),u=()=>{r&&(o?o(!1):s==null||s(null))},c=j.useMemo(()=>({A:12e3,B:6e3,C:3e3,D:1e3}),[]),d=j.useMemo(()=>({A:1e4,B:4e3,C:1500,D:500}),[]),h=v=>{if(v==null)return"";const C=String(v).trim().toUpperCase();if(["A","B","C","D"].includes(C))return C;const P=Number(C);return P===1?"A":P===2?"B":P===3?"C":P===4?"D":""},p=j.useMemo(()=>{const v=n||{};return{name:v.name??t,bens:Number(v.bens??e??0),vendedoresComuns:Number(v.vendedoresComuns??0),fieldSales:Number(v.fieldSales??0),insideSales:Number(v.insideSales??0),gestores:Number(v.gestores??v.gestoresComerciais??0),raw:v}},[n,t,e]);j.useEffect(()=>{console.group("[RecoveryModal] mount snapshot"),console.log("raw player =>",p.raw),console.groupEnd()},[p.raw]);const g=j.useMemo(()=>Math.max(0,Math.floor(p.bens*.5)),[p.bens]),b=j.useMemo(()=>{var C;const v=(C=p.raw)==null?void 0:C.loanPending;return v&&Number(v.amount)>0},[(N=p.raw)==null?void 0:N.loanPending]),x=j.useMemo(()=>[{key:"mix",label:"MIX PRODUTOS",credit:1500},{key:"erp",label:"ERP/SISTEMAS",credit:1500}],[]),S=j.useMemo(()=>[{key:"comum",label:"Vendedor Comum",unit:1500,owned:p.vendedoresComuns},{key:"field",label:"Field Sales",unit:3e3,owned:p.fieldSales},{key:"inside",label:"Inside Sales",unit:3e3,owned:p.insideSales},{key:"gestor",label:"Gestor",unit:5e3,owned:p.gestores}],[p]),y=j.useMemo(()=>{const v=p.raw||{};return h(v.mixProdutosLetter??v.mixProdutos??v.mixProducts??v.mixLevelLetter??v.mixLevel??v.mix_level??v.mix??v.mix_produtos??v.mix_products)},[p.raw]),f=j.useMemo(()=>{var C;const v=p.raw||{};return h(v.erpSistemasLetter??v.erpSistemas??((C=v.erpSystems)==null?void 0:C.level)??v.erpSystemsLetter??v.erpLevelLetter??v.erpLevel??v.erp_level??v.erp??v.erp_sistemas)},[p.raw]),m=j.useMemo(()=>{const v=p.raw||{},C=v.mixOwned??v.mix??{},P=new Set;return typeof C=="object"&&!Array.isArray(C)&&C!==null&&(C.A===!0&&P.add("A"),C.B===!0&&P.add("B"),C.C===!0&&P.add("C"),C.D===!0&&P.add("D")),P.size===0&&y&&(P.add("D"),y==="A"?(P.add("A"),P.add("B"),P.add("C")):y==="B"?(P.add("B"),P.add("C")):y==="C"&&P.add("C")),P.size===0&&P.add("D"),P},[p.raw,y]),w=j.useMemo(()=>{const v=p.raw||{},C=v.erpOwned??v.erp??{},P=new Set;return typeof C=="object"&&!Array.isArray(C)&&C!==null&&(C.A===!0&&P.add("A"),C.B===!0&&P.add("B"),C.C===!0&&P.add("C"),C.D===!0&&P.add("D")),P.size===0&&f&&(P.add("D"),f==="A"?(P.add("A"),P.add("B"),P.add("C")):f==="B"?(P.add("B"),P.add("C")):f==="C"&&P.add("C")),P.size===0&&P.add("D"),P},[p.raw,f]);j.useEffect(()=>{console.group("[RecoveryModal] owned detect"),console.log("mixLetter(panel):",y," -> ownedMix =",Object.fromEntries(["A","B","C","D"].map(v=>[v,m.has(v)]))),console.log("erpLetter(panel):",f," -> ownedErp =",Object.fromEntries(["A","B","C","D"].map(v=>[v,w.has(v)]))),console.groupEnd()},[y,f,m,w]);const k=j.useMemo(()=>{var C,P;const v=p.raw||{};return{MIX:Array.isArray((C=v.reducedLevels)==null?void 0:C.MIX)?v.reducedLevels.MIX:[],ERP:Array.isArray((P=v.reducedLevels)==null?void 0:P.ERP)?v.reducedLevels.ERP:[]}},[p.raw]),D=j.useMemo(()=>["A","B","C","D"].map(v=>({key:`mix-${v}`,group:"MIX",level:v,label:`Nvel ${v}`,credit:(c[v]||0)/2,owned:m.has(v),alreadyReduced:k.MIX.includes(v)})),[m,c,k.MIX]),R=j.useMemo(()=>["A","B","C","D"].map(v=>({key:`erp-${v}`,group:"ERP",level:v,label:`Nvel ${v}`,credit:(d[v]||0)/2,owned:w.has(v),alreadyReduced:k.ERP.includes(v)})),[w,d,k.ERP]),E=j.useMemo(()=>({MIX:{A:c.A/2,B:c.B/2,C:c.C/2,D:c.D/2},ERP:{A:d.A/2,B:d.B/2,C:d.C/2,D:d.D/2}}),[c,d]);return a.jsx("div",{style:Ue.backdrop,children:a.jsxs("div",{style:Ue.card,children:[a.jsxs("div",{style:Ue.header,children:[a.jsx("div",{style:{fontWeight:900,fontSize:22},children:"RECUPERAO FINANCEIRA"}),r&&a.jsx("button",{onClick:u,style:Ue.closeBtn,children:""})]}),i==="menu"&&a.jsx(Rb,{playerName:p.name,loanAvailable:g,hasPendingLoan:b,onGoLoan:()=>l("loan"),onGoReduce:()=>l("reduce"),onGoFire:()=>l("fire"),onDeclareBankruptcy:()=>s==null?void 0:s({type:"TRIGGER_BANKRUPTCY",source:{modal:"RecoveryModal",file:"src/modals/RecoveryModal.jsx"}})}),i==="loan"&&a.jsx(Nb,{loanAvailable:g,onBack:()=>l("menu"),onConfirm:v=>{console.log("[DEBUG] RecoveryModal recebeu payload do RecoveryLoan:",v),console.log("[DEBUG] RecoveryModal chamando resolveTop com:",v);const C=s==null?void 0:s({...v||{},source:{modal:"RecoveryModal",file:"src/modals/RecoveryModal.jsx"}});console.log("[DEBUG] RecoveryModal resolveTop retornou:",C)}}),i==="reduce"&&a.jsx(Db,{options:x,optionsMix:D,optionsErp:R,mixOwned:{A:m.has("A"),B:m.has("B"),C:m.has("C"),D:m.has("D")},erpOwned:{A:w.has("A"),B:w.has("B"),C:w.has("C"),D:w.has("D")},credits:E,snapshot:p,onBack:()=>l("menu"),onConfirm:v=>{if(Array.isArray(v==null?void 0:v.items)){const I=Number(v.total??v.items.filter(H=>H.selected).reduce((H,X)=>H+Number(X.credit||0),0));s==null||s({type:"REDUCE",amount:I,items:v.items,note:`Reduo mltipla +R$ ${I.toLocaleString()}`,source:{modal:"RecoveryModal",file:"src/modals/RecoveryModal.jsx"}});return}const C=Number((v==null?void 0:v.credit)||(v==null?void 0:v.amount)||0),P=v&&v.group&&v.level?{group:String(v.group).toUpperCase(),level:String(v.level).toUpperCase(),credit:C}:null;s==null||s({type:"REDUCE",amount:C,group:P==null?void 0:P.group,level:P==null?void 0:P.level,selection:P,note:P?`Reduo ${P.group} nvel ${P.level} +R$ ${C.toLocaleString()}`:`Reduo +R$ ${C.toLocaleString()}`,source:{modal:"RecoveryModal",file:"src/modals/RecoveryModal.jsx"}})}}),i==="fire"&&a.jsx(Ab,{roles:S,onBack:()=>l("menu"),onConfirm:v=>s==null?void 0:s({...v||{},source:{modal:"RecoveryModal",file:"src/modals/RecoveryModal.jsx"}})})]},i)})}function Ob({playerName:t="Jogador",balanceText:e=""}){const{resolveTop:n,closeModal:r}=An(),s=j.useRef(null);j.useEffect(()=>{var c;const u=document.body.style.overflow;return document.body.style.overflow="hidden",(c=s.current)==null||c.focus(),()=>{document.body.style.overflow=u}},[]),j.useEffect(()=>{const u=c=>{(c.key==="Escape"||c.key==="Enter"||c.key===" ")&&(c.preventDefault(),c.stopPropagation())};return document.addEventListener("keydown",u,!0),()=>document.removeEventListener("keydown",u,!0)},[]);const o=u=>{u.preventDefault(),u.stopPropagation()},i=()=>{n(!1),r==null||r()},l=()=>{n(!0),r==null||r()};return a.jsxs(ki,{width:780,onClose:i,children:[a.jsx("style",{children:`
        .sg-modal-panel {
          background:#111827; border:1px solid rgba(255,255,255,0.08);
          border-radius:16px; padding:20px 22px 18px; color:#e5e7eb;
          position:relative; box-shadow:0 10px 35px rgba(0,0,0,.55);
        }
        .sg-modal-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
        .sg-modal-title{font-size:22px;font-weight:700;margin:0}
        .sg-icon-close{background:transparent;border:0;color:#9ca3af;font-size:24px;line-height:1;cursor:pointer}
        .sg-icon-close:hover{color:#e5e7eb}

        .sg-modal-infos{display:flex;justify-content:space-between;align-items:center;
          font-size:14px;color:#cbd5e1;margin:6px 0 12px}
        .sg-modal-infos .right{opacity:.8}

        .sg-callout-warning{
          background:rgba(250,204,21,.12); border:1px solid rgba(250,204,21,.45);
          border-radius:12px; padding:14px 16px; margin-bottom:14px
        }
        .sg-callout-title{font-weight:700;margin-bottom:6px;color:#fde68a}
        .sg-muted{opacity:.7}

        .sg-modal-body{margin:8px 2px 14px;font-size:15px;line-height:1.5}

        .sg-modal-actions{display:flex;justify-content:space-between;gap:12px;margin-top:10px}
        .sg-btn{font-weight:600;border:0;cursor:pointer;padding:12px 18px}
        .sg-pill{border-radius:999px}
        .sg-btn-neutral{background:#374151;color:#e5e7eb}
        .sg-btn-neutral:hover{background:#4b5563}
        .sg-btn-danger{background:#b91c1c;color:#fff}
        .sg-btn-danger:hover{background:#991b1b}
        .sg-btn:focus{outline:2px solid rgba(255,255,255,.35);outline-offset:2px}
      `}),a.jsxs("div",{className:"sg-modal-panel",role:"dialog","aria-modal":"true","aria-labelledby":"bk-title","aria-describedby":"bk-desc",onClick:o,onMouseDown:o,onKeyDown:o,children:[a.jsxs("div",{className:"sg-modal-header",children:[a.jsx("h2",{id:"bk-title",className:"sg-modal-title",children:"Declarar Falncia"}),a.jsx("button",{className:"sg-icon-close","aria-label":"Fechar",onClick:i,children:""})]}),a.jsxs("div",{className:"sg-modal-infos",children:[a.jsx("div",{className:"left",children:e?a.jsxs(a.Fragment,{children:["Saldo disponvel: ",a.jsx("b",{children:e})]}):a.jsx(a.Fragment,{children:""})}),a.jsx("div",{className:"right",children:"Ao permanente nesta partida"})]}),a.jsxs("div",{className:"sg-callout-warning",id:"bk-desc",children:[a.jsx("div",{className:"sg-callout-title",children:"Ateno"}),a.jsxs("p",{children:[t,", ao confirmar, voc ser marcado como ",a.jsx("b",{children:"FALIDO"}),". Seu turno ser ",a.jsx("b",{children:"sempre pulado"})," e voc no poder mais executar aes."]}),a.jsx("p",{className:"sg-muted",children:"Esta deciso  irreversvel at o fim da partida."})]}),a.jsx("div",{className:"sg-modal-body",children:a.jsxs("p",{children:["Confirme abaixo para encerrar sua participao ativa. Voc continuar visvel no placar como ",a.jsx("b",{children:"FALIDO"}),"."]})}),a.jsxs("div",{className:"sg-modal-actions",children:[a.jsx("button",{className:"sg-btn sg-pill sg-btn-neutral",onClick:i,children:"Cancelar"}),a.jsx("button",{ref:s,className:"sg-btn sg-pill sg-btn-danger",onClick:l,children:"Declarar Falncia"})]})]})]})}function Tb({traceId:t="unknown",actionType:e="UNKNOWN",reason:n="UNKNOWN_CASH_CHANGE",origin:r={},context:s={}}={}){return{traceId:t||"unknown",actionType:e||"UNKNOWN",reason:n||"UNKNOWN_CASH_CHANGE",origin:{file:r.file,fn:r.fn,modal:r.modal,component:r.component},context:{round:s.round,pos:s.pos,tile:s.tile,debt:s.debt,loanPending:s.loanPending,opsExpense:s.opsExpense,revenue:s.revenue}}}const Cn=5;function Pb({players:t,setPlayers:e,round:n,setRound:r,turnIdx:s,setTurnIdx:o,turnPlayerId:i,setTurnPlayerId:l,roundFlags:u,setRoundFlags:c,isMyTurn:d,isMine:h,myUid:p,meId:g,myCash:b,current:x,broadcastState:S,appendLog:y,turnLock:f,setTurnLockBroadcast:m,gameOver:w,setGameOver:k,winner:D,setWinner:R,setShowBankruptOverlay:E}){const N=An(),v=N==null?void 0:N.pushModal,C=N==null?void 0:N.awaitTop,P=N==null?void 0:N.closeTop,I=N==null?void 0:N.popModal,H=ue.useCallback(K=>{try{if(typeof P=="function")return P(K);if(typeof I=="function")return I()}catch{}},[P,I]),[X,ke]=ue.useState(0),je=ue.useRef(0);ue.useEffect(()=>{je.current=X},[X]);const F=ue.useRef(!1),oe=ue.useRef(!1),Z=ue.useRef(Promise.resolve()),We=ue.useCallback(K=>{const xe=async()=>{oe.current=!0;try{return await K()}finally{oe.current=!1}},Ee=Z.current.then(xe,xe);return Z.current=Ee.catch(W=>{console.error("[DEBUG] actionQueue error:",W)}),Ee},[]),he=ue.useRef(!1),ht=ue.useRef(null),It=ue.useRef(null),He=ue.useRef(null),pt=ue.useRef(null),er=ue.useRef(Promise.resolve()),ts=ue.useCallback(K=>{if(!Array.isArray(K)||K.length===0)return K;const xe=[...K].filter(Boolean);let W=xe.every(Ne=>Number.isInteger(Ne.seat))?xe.sort((Ne,we)=>Ne.seat-we.seat):xe.sort((Ne,we)=>String((Ne==null?void 0:Ne.id)??(Ne==null?void 0:Ne.player_id)??"").localeCompare(String((we==null?void 0:we.id)??(we==null?void 0:we.player_id)??""))),Ye=0;const re=new Set(W.filter(Ne=>Number.isInteger(Ne.seat)).map(Ne=>Ne.seat));return W=W.map(Ne=>{if(Number.isInteger(Ne.seat))return Ne;for(;re.has(Ye);)Ye++;return re.add(Ye),{...Ne,seat:Ye++}}),W=W.sort((Ne,we)=>Ne.seat-we.seat),W},[]),ve=ue.useMemo(()=>ts(t),[t,ts]),tr=ue.useCallback((K,xe)=>(K||[]).findIndex(Ee=>String(Ee==null?void 0:Ee.id)===String(xe)),[]),Je=ue.useCallback((K,xe)=>(K||[]).find(Ee=>String(Ee==null?void 0:Ee.id)===String(xe)),[]),ne=ue.useCallback((K,xe,Ee)=>(K||[]).map(W=>String(W==null?void 0:W.id)===String(xe)?Ee(W):W),[]);ue.useEffect(()=>{d?console.log("[DEBUG] modalLocks sync - isMyTurn:",d,"modalLocks:",X):X>0&&(console.log("[DEBUG] modalLocks sync - resetando modalLocks para 0 (no  minha vez)"),ke(0),je.current=0,F.current=!1)},[d,X]),ue.useEffect(()=>(f?(He.current&&clearTimeout(He.current),He.current=setTimeout(()=>{const K=it.current,xe=String(K||"")===String(p),Ee=je.current,W=F.current;console.warn("[DEBUG]  TIMEOUT DE SEGURANA - turnLock ativo h mais de 30s",{isLockOwner:xe,currentModalLocks:Ee,currentOpening:W,lockOwner:K}),(xe&&Ee===0&&!W||K==null&&Ee===0&&!W)&&(console.warn("[DEBUG]  FORANDO LIBERAO DO TURNLOCK (timeout de segurana)",{isLockOwner:xe,lockOwner:K,modalLocks:Ee,opening:W}),m(!1),he.current=!1)},3e4)):He.current&&(clearTimeout(He.current),He.current=null),()=>{He.current&&(clearTimeout(He.current),He.current=null)}),[f,p,m]);const[ns,As]=ue.useState(null),it=ue.useRef(null);ue.useEffect(()=>{it.current=ns},[ns]);const xt=ue.useRef(null),pe=ue.useRef(n);ue.useEffect(()=>{pe.current=n,console.log("[DEBUG]  currentRoundRef atualizado para:",n)},[n]);const Dt=ue.useRef(t);ue.useEffect(()=>{Dt.current=t},[t]);const nr=ue.useRef(s);ue.useEffect(()=>{nr.current=s},[s]);const Wt=ue.useRef(w);ue.useEffect(()=>{Wt.current=w},[w]);const rs=ue.useRef(!1),ss=ue.useRef(!1);ue.useEffect(()=>{const K=t[s];K&&String(K.id)===String(p)?xt.current&&(xt.current.nextTurnIdx===s?(console.log("[DEBUG] Limpando pendingTurnDataRef - turno j foi processado (nextTurnIdx === turnIdx)"),xt.current=null):console.log("[DEBUG] Mantendo pendingTurnDataRef - prximo turno:",xt.current.nextTurnIdx,"turno atual:",s)):xt.current&&xt.current.nextTurnIdx!==s&&(console.log("[DEBUG] Limpando pendingTurnDataRef - no  minha vez e dados no so para turno atual"),xt.current=null)},[s,t,p]);const st=ue.useCallback(K=>{if(!v||!C)return Promise.resolve(null);const xe=async()=>{let W=!1;try{F.current=!0,ke(Ne=>{const we=Ne+1;return je.current=we,pt.current=null,console.log("[DEBUG] openModalAndWait - ABRINDO modal, modalLocks:",Ne,"->",we,"openingModalRef:",F.current),we}),v(K),await new Promise(Ne=>setTimeout(Ne,100)),F.current=!1,console.log("[DEBUG] openModalAndWait - Modal renderizada, openingModalRef:",F.current);const Ye=new Promise((Ne,we)=>setTimeout(()=>we(new Error("Modal timeout")),15e3)),re=await Promise.race([C(),Ye]);return W=!0,await new Promise(Ne=>setTimeout(Ne,50)),re??null}catch(Ye){if(console.error("[DEBUG] openModalAndWait - erro aguardando modal:",Ye),Ye.message==="Modal timeout"){console.warn("[WARN] modal timeout -> auto-close");try{H({action:"SKIP"})}catch{}}return W=!0,null}finally{F.current=!1,W&&ke(Ye=>{const re=Math.max(0,Ye-1);return je.current=re,re===0&&(pt.current=Date.now(),console.log("[DEBUG] openModalAndWait - LTIMA MODAL FECHADA - timestamp:",pt.current)),console.log("[DEBUG] openModalAndWait - FECHANDO modal, modalLocks:",Ye,"->",re),re})}},Ee=er.current.then(xe,xe);return er.current=Ee.catch(()=>{}),Ee},[v,C,H]),Os=ue.useCallback((K,xe)=>{const Ee=t[K],W=Math.max(0,Number(xe||0));return Number((Ee==null?void 0:Ee.cash)||0)>=W},[t]),At=ue.useCallback((K,xe,Ee)=>{const W=Os(K,xe);return W||y(`Saldo insuficiente${Ee?" para "+Ee:""}. Use RECUPERAO (demitir / emprestar / reduzir) ou declare FALNCIA.`),W},[Os,y]),Ei=ue.useCallback((K,xe,Ee)=>{var Ne;if(xe<=Cn)return{finished:!1,winner:null,finalRound:xe};const W=(K||[]).filter(we=>!(we!=null&&we.bankrupt));if(W.length===0)return console.log("[DEBUG]  FIM DE JOGO - Nenhum jogador vivo restante"),{finished:!0,winner:null,finalRound:Cn};const re=((Ne=W.map(we=>({player:we,patrimonio:(we.cash||0)+(we.bens||0),cash:we.cash||0})).sort((we,Vt)=>{var jn,rr;return Vt.patrimonio-we.patrimonio||Vt.cash-we.cash||String(((jn=we.player)==null?void 0:jn.name)||"").localeCompare(String(((rr=Vt.player)==null?void 0:rr.name)||""))})[0])==null?void 0:Ne.player)||null;return console.log("[ENDGAME] finalizando: vencedor=",(re==null?void 0:re.name)||"N/A",", round=",Cn),{finished:!0,winner:re,finalRound:Cn}},[]),wo=ue.useCallback((K,xe,Ee)=>{if(console.log("[DEBUG]  advanceAndMaybeLap chamada - steps:",K,"deltaCash:",xe,"note:",Ee),!(Wt.current||rs.current||ss.current||!t.length)){if(he.current){console.warn("[DEBUG]  advanceAndMaybeLap - mudana de turno j em progresso, ignorando");return}if(je.current>0||F.current){if(console.warn("[DEBUG]  advanceAndMaybeLap - h modais abertas, aguardando...",{modalLocks:je.current,opening:F.current}),It.current={steps:K,deltaCash:xe,note:Ee},ht.current)return;ht.current=setTimeout(()=>{ht.current=null;const W=It.current;It.current=null,W&&je.current===0&&!F.current&&wo(W.steps,W.deltaCash,W.note)},200);return}he.current=!0,m(!0,String(p)),As(String(p));try{const W=s,Ye=ve[W];if(!Ye){m(!1),he.current=!1;return}const re=String(Ye.id);console.log("[DEBUG]  POSIO INICIAL - Jogador:",Ye.name,"Posio:",Ye.pos,"Saldo:",Ye.cash);const Ne=async(A,J,ee,q=t)=>{var Y,ye,ze,Et,Ot,De,Tt,Le,on,Pt;const ge=Je(q,re)||{},me=Number((ge==null?void 0:ge.cash)||0);if(me>=A){console.log("[DEBUG]  Saldo suficiente! Processando pagamento de:",A);const be=ts(q).map(Ce=>String(Ce.id)!==re?Ce:{...Ce,cash:Math.max(0,(Ce.cash||0)-A),pos:Ce.pos});return e(be),S(be,s,pe.current),!0}F.current=!0;const Q=await st(a.jsx(Cr,{requiredAmount:A,currentCash:me,title:`Saldo insuficiente para ${ee} ${J}`,message:`Voc precisa ${ee} R$ ${A.toLocaleString()} mas possui apenas R$ ${me.toLocaleString()}.`,showRecoveryOptions:!0}));if(!Q)return m(!1),!1;if(Q.action==="RECOVERY"){console.log("[DEBUG] Abrindo RecoveryModal para jogador:",ge);const be=await st(a.jsx(Jf,{currentPlayer:ge,canClose:!1}));if(console.log("[DEBUG] RecoveryModal retornou:",be),be){console.log("[DEBUG] recoveryModalRes existe, tipo:",be.type,"action:",be.action);let Ce=q;if(be.type==="FIRE"){console.log("[DEBUG]  Condio FIRE atendida! Processando demisses:",be);const ot={cashDelta:Number(be.amount||0),vendedoresComunsDelta:-Number(((Y=be.items)==null?void 0:Y.comum)||0),fieldSalesDelta:-Number(((ye=be.items)==null?void 0:ye.field)||0),insideSalesDelta:-Number(((ze=be.items)==null?void 0:ze.inside)||0),gestoresDelta:-Number(((Et=be.items)==null?void 0:Et.gestor)||0)};console.log("[DEBUG] Deltas de demisso:",ot),Ce=ne(q,re,Xe=>({...qt(Xe,ot),pos:Xe.pos})),console.log("[DEBUG] Novo saldo aps demisses:",(Ot=Je(Ce,re))==null?void 0:Ot.cash),e(Ce),S(Ce,s,pe.current)}else if(be.type==="LOAN"){console.log("[DEBUG]  Condio LOAN atendida! Processando emprstimo:",be);const ot=(Je(q,re)||{}).loanPending;if(ot&&Number(ot.amount)>0){console.log("[DEBUG]  Jogador j possui emprstimo pendente:",ot);const ct=await st(a.jsx(Cr,{requiredAmount:A,currentCash:Number((Je(q,re)||{}).cash||0),title:"Emprstimo j realizado",message:`Voc j possui um emprstimo pendente de R$ ${Number(ot.amount).toLocaleString()}. Cada jogador s pode ter um emprstimo por vez.`,showRecoveryOptions:!1,canClose:!1}));if(!ct||ct.action!=="BANKRUPT")return m(!1),!1;const B=ne(q,re,Be=>({...Be,bankrupt:!0}));if(Yo(B)<=1){const Be=B.findIndex(yt=>!(yt!=null&&yt.bankrupt));return R(Be>=0?B[Be]:null),e(B),k(!0),m(!1),S(B,s,n,!0,Be>=0?B[Be]:null),!1}const de=tr(B,re),Se=Ao(B,de>=0?de:W),Ie=B[Se],_e=Ie!=null&&Ie.id?String(Ie.id):null;return e(B),o(Se),l&&l(_e),m(!1),S(B,Se,pe.current,!1,null,{turnPlayerId:_e}),!1}const Xe=Number(be.amount||0);console.log("[DEBUG] Valor do emprstimo:",Xe),console.log("[DEBUG] Saldo atual do jogador:",Number((Je(q,re)||{}).cash||0)),Ce=ne(q,re,ct=>({...ct,cash:(Number(ct.cash)||0)+Xe,loanPending:{amount:Xe,charged:!1,shouldChargeOnNextExpenses:!0},pos:ct.pos})),console.log("[DEBUG] Novo saldo do jogador:",(De=Je(Ce,re))==null?void 0:De.cash),console.log("[DEBUG] Novo loanPending:",(Tt=Je(Ce,re))==null?void 0:Tt.loanPending),e(Ce),S(Ce,s,pe.current)}else if(be.type==="REDUCE"){console.log("[DEBUG]  Condio REDUCE atendida! Processando reduo:",be);const ot=be.items||[];let Xe=0;console.log("[DEBUG] Selees para reduzir:",ot);const ct=B=>(B==null?void 0:B.A)===!0?"A":(B==null?void 0:B.B)===!0?"B":(B==null?void 0:B.C)===!0?"C":"D";Ce=ne(q,re,B=>{let ce={...B},de={A:!1,B:!1,C:!1,D:!1,...ce.mixOwned||ce.mix||{}},Se={A:!1,B:!1,C:!1,D:!1,...ce.erpOwned||ce.erp||{}};const Ie=String(ce.mixProdutos||"D").toUpperCase(),_e=String(ce.erpLevel||ce.erpSistemas||"D").toUpperCase();!de.A&&!de.B&&!de.C&&!de.D&&Ie&&(Ie==="A"?de={A:!0,B:!0,C:!0,D:!0}:Ie==="B"?de={A:!1,B:!0,C:!0,D:!0}:Ie==="C"?de={A:!1,B:!1,C:!0,D:!0}:de={A:!1,B:!1,C:!1,D:!0}),!Se.A&&!Se.B&&!Se.C&&!Se.D&&_e&&(_e==="A"?Se={A:!0,B:!0,C:!0,D:!0}:_e==="B"?Se={A:!1,B:!0,C:!0,D:!0}:_e==="C"?Se={A:!1,B:!1,C:!0,D:!0}:Se={A:!1,B:!1,C:!1,D:!0});let Be=Ie,yt=_e;for(const Nr of ot)if(Nr.selected){if(Xe+=Number(Nr.credit||0),Nr.group==="MIX"){if(de[Nr.level]=!1,Nr.level===Be){const as=["A","B","C","D"],cl=as.indexOf(Be);for(let ls=cl+1;ls<as.length;ls++){const us=as[ls];if(de[us]||us==="D"){Be=us;break}}}}else if(Nr.group==="ERP"&&(Se[Nr.level]=!1,Nr.level===yt)){const as=["A","B","C","D"],cl=as.indexOf(yt);for(let ls=cl+1;ls<as.length;ls++){const us=as[ls];if(Se[us]||us==="D"){yt=us;break}}}}const an=ct(de)||Be||"D",ji=ct(Se)||yt||"D";return ce.mixOwned=de,ce.mix=de,ce.erpOwned=Se,ce.erp=Se,ce.mixProdutos=an,ce.erpLevel=ji,ce.erpSistemas=ji,ce.mixLevel=an,ce.mixProducts=an,ce.mixLevelLetter=an,ce.erpLevelLetter=ji,ce.cash=(Number(ce.cash)||0)+Xe,ce.pos=B.pos,console.log("[DEBUG] Reduo aplicada - mixProdutos:",an,"erpLevel:",ji,"crdito:",Xe),ce}),console.log("[DEBUG] Total de crdito da reduo:",Xe),console.log("[DEBUG] Novo saldo aps reduo:",(Le=Je(Ce,re))==null?void 0:Le.cash),console.log("[DEBUG] Novo mixProdutos:",(on=Je(Ce,re))==null?void 0:on.mixProdutos,"Novo erpLevel:",(Pt=Je(Ce,re))==null?void 0:Pt.erpLevel),e(Ce),S(Ce,s,pe.current)}else console.log("[DEBUG]  Nenhuma condio foi atendida! Tipo:",be.type,"Action:",be.action);const gn=Number((Je(Ce,re)||{}).cash||0);if(console.log("[DEBUG] Verificando saldo aps recuperao - Novo saldo:",gn,"Necessrio:",A),gn>=A){console.log("[DEBUG]  Saldo suficiente aps recuperao! Processando pagamento de:",A);const ot=ne(Ce,re,Xe=>({...Xe,cash:Math.max(0,(Xe.cash||0)-A),pos:Xe.pos}));return console.log("[DEBUG]  PAGAMENTO - Saldo antes:",Number((Je(Ce,re)||{}).cash||0),"Valor a pagar:",A,"Saldo aps:",Number((Je(ot,re)||{}).cash||0)),e(ot),S(ot,s,pe.current),!0}else return console.log("[DEBUG]  Saldo ainda insuficiente aps recuperao. Continuando recurso..."),await Ne(A,J,ee,Ce)}else return m(!1),!1}else if(Q.action==="BANKRUPT"){const be=ne(q,re,B=>({...B,bankrupt:!0}));if(Yo(be)<=1){const B=be.findIndex(ce=>!(ce!=null&&ce.bankrupt));return R(B>=0?be[B]:null),e(be),k(!0),m(!1),S(be,s,n,!0,B>=0?be[B]:null),!1}const gn=tr(be,re),ot=Ao(be,gn>=0?gn:W),Xe=be[ot],ct=Xe!=null&&Xe.id?String(Xe.id):null;return e(be),o(ot),l&&l(ct),m(!1),S(be,ot,pe.current,!1,null,{turnPlayerId:ct}),!1}else return m(!1),!1},we=Ye.pos,Vt=(we+K)%xs,jn=Vt<we,rr=jn&&we>=xs-1;console.log("[DEBUG]  MOVIMENTO - De posio:",we,"Para posio:",Vt,"Steps:",K,"Lap:",jn,"CompletedLap:",rr);const _=Kl(we,Vt,0)||jn,O=pe.current,U=t.filter(A=>!(A!=null&&A.bankrupt)).length,$=ts(t).map(A=>{if(String(A.id)!==re)return A;const J=(A.cash||0)+(xe||0),ee=Number(A.lastRevenueRound)||0,q=A.waitingAtRevenue===!0;let ge=ee,me=O===Cn?q:!1,Q=me?0:Vt;return _&&(ge=Math.max(ee,O),O===Cn&&U>1&&(me=!0,Q=0)),{...A,pos:Q,cash:Math.max(0,J),lastRevenueRound:ge,waitingAtRevenue:me}}),T=$.find(A=>String(A.id)===re);console.log("[DEBUG]  APS MOVIMENTO - Jogador:",T==null?void 0:T.name,"Posio:",T==null?void 0:T.pos,"Saldo:",T==null?void 0:T.cash,"lastRevenueRound:",T==null?void 0:T.lastRevenueRound,"waitingAtRevenue:",T==null?void 0:T.waitingAtRevenue);let M=pe.current,V=[...u],L=!1,se=!1;if(jn){console.log("[DEBUG]  VOLTA COMPLETA DETECTADA (lap=true) - Jogador completou uma volta completa!",{jogador:Ye.name,posicaoAnterior:we,posicaoNova:Vt,rodadaAtual:pe.current}),V.length<t.length&&(V=[...V,...new Array(t.length-V.length).fill(!1)]);const A=ve.findIndex(J=>String(J.id)===re);A>=0&&(V[A]=!0),console.log("[DEBUG]  Flag marcada por volta completa (lap) - Flags:",V.map((J,ee)=>{var q;return`${(q=ve[ee])==null?void 0:q.name}:${J}`}).join(", "))}if(_){V.length<t.length&&(V=[...V,...new Array(t.length-V.length).fill(!1)]);const A=ve.findIndex(Q=>String(Q.id)===re);A>=0&&(V[A]?console.log("[DEBUG]  Jogador j tinha flag marcada (por lap) - Flags:",V.map((Q,Y)=>{var ye;return`${(ye=ve[Y])==null?void 0:ye.name}:${Q}`}).join(", ")):(V[A]=!0,console.log("[DEBUG]  Jogador passou pela casa 0 (crossedStart1ForRound) - Flags:",V.map((Q,Y)=>{var ye;return`${(ye=ve[Y])==null?void 0:ye.name}:${Q}`}).join(", "))));const J=$.filter(Q=>!(Q!=null&&Q.bankrupt)),ee=$.map((Q,Y)=>Q!=null&&Q.bankrupt?-1:Y).filter(Q=>Q>=0),q=$.filter(Q=>!(Q!=null&&Q.bankrupt)),ge=q.length>0&&q.every(Q=>(Number(Q.lastRevenueRound)||0)>=O);console.log("[DEBUG]  Verificando allAliveDone - Rodada atual:",O,"Jogadores vivos:",q.map(Q=>({name:Q.name,lastRevenueRound:Q.lastRevenueRound})));const me=$.find(Q=>String(Q.id)===re);if(console.log("[DEBUG]  Verificao de rodada - Jogador:",me==null?void 0:me.name,"Rodada atual:",O,"round do closure:",n),console.log("[DEBUG]  Jogadores vivos:",ee.map(Q=>{const Y=$[Q],ye=ve.findIndex(ze=>String(ze.id)===String(Y==null?void 0:Y.id));return`${Y==null?void 0:Y.name}:${ye>=0?V[ye]:!1}`}).join(", ")),console.log("[DEBUG]  Total de jogadores vivos:",ee.length),console.log("[DEBUG]  Flags completas:",V.map((Q,Y)=>{var ye;return`${(ye=$[Y])==null?void 0:ye.name}:${Q?"":""}`}).join(", ")),console.log("[DEBUG]  Todos passaram pela casa 0?",ge),ge)O<Cn?(M=O+1,L=!0):se=!0,L?(V=V.map((Q,Y)=>{var ye;return(ye=$[Y])!=null&&ye.bankrupt?V[Y]:!1}),console.log("[DEBUG]  RODADA INCREMENTADA - Nova rodada:",M,"Rodada anterior:",O,"Jogadores vivos:",q.length),console.log("[DEBUG]  Flags resetadas:",V.map((Q,Y)=>{var ye;return`${(ye=$[Y])==null?void 0:ye.name}:${Q}`}).join(", ")),y(` Rodada ${M} iniciada! Todos os jogadores vivos passaram pela casa de faturamento.`)):se&&console.log("[DEBUG]  FIM DE JOGO - Rodada 5 completa, todos os jogadores vivos chegaram!");else{const Q=q.filter(Y=>(Number(Y.lastRevenueRound)||0)<O).map(Y=>Y.name);console.log("[DEBUG]  Rodada NO incrementada - ainda faltam jogadores completarem o ms:",Q.join(", "))}}c(V),console.log("[DEBUG] roundFlags updated / round closed:",V.map((A,J)=>{var ee;return`${(ee=$[J])==null?void 0:ee.name}:${A}`}).join(", "));let Ke=Ao($,W);if(pe.current===5){let A=0;for(;A<$.length;){const J=$[Ke];if(!J.bankrupt&&J.waitingAtRevenue!==!0)break;Ke=(Ke+1)%$.length,A++}}xe&&y(`${Ye.name} ${xe>0?"ganhou":"pagou"} $${Math.abs(xe).toLocaleString()}`),Ee&&y(Ee),e($,{source:"ROLL"}),S($,s,pe.current,Wt.current,winnerRef.current,{kind:"PLAYER_DELTA"}),r(A=>{const J=Math.min(Cn,M),ee=Math.min(Cn,Math.max(A,J));return L&&ee>A&&(console.log("[ROUND] allAliveDone=true -> round",A,"->",ee),y(` Rodada ${ee} iniciada! Todos os jogadores vivos passaram pela casa de faturamento.`)),ee!==A&&console.log("[ROUND]",A,"->",ee),pe.current=ee,ee});const Ge=M,Ze=V,bt=$[Ke],ae=bt!=null&&bt.id?String(bt.id):null;xt.current={nextPlayers:$,nextTurnIdx:Ke,nextTurnPlayerId:ae,nextRound:Ge,nextRoundFlags:Ze,timestamp:Date.now(),shouldIncrementRound:L,endGame:se},console.log("[DEBUG]  pendingTurnDataRef preenchido - prximo turno:",Ke,"rodada atual:",n,"prxima rodada:",Ge,"nextRound calculado:",M,"shouldIncrementRound:",L,"rodada foi incrementada?",M>n,"roundFlags:",Ze.map((A,J)=>{var ee;return`${(ee=$[J])==null?void 0:ee.name}:${A}`}).join(", "));const te=Vt+1,Ae=Kl(we,Vt,0),at=Kl(we,Vt,22);let Pe=!1;(te===6||te===16||te===32||te===49)&&d&&v&&C&&(Pe=!0,F.current=!0,(async()=>{var ge,me,Q,Y,ye;const A=((ge=t[W])==null?void 0:ge.erpLevel)||null,J=((me=t[W])==null?void 0:me.erpOwned)||((Q=t[W])==null?void 0:Q.erp)||{},ee=await st(a.jsx(Ff,{currentCash:((Y=$[W])==null?void 0:Y.cash)??b,currentLevel:A,erpOwned:J}));if(!ee||ee.action!=="BUY")return;const q=Number(((ye=ee.values)==null?void 0:ye.compra)||0);if(!At(W,q,"comprar ERP")){m(!1);return}e(ze=>{const Et=ne(ze,re,Ot=>qt(Ot,{cashDelta:-q,erpLevelSet:ee.level}));return S(Et,s,pe.current),Et})})()),(te===2||te===11||te===19||te===47)&&d&&v&&C&&(F.current=!0,(async()=>{var q,ge,me,Q;const A=t.find(h)||$[W],J=await st(a.jsx(zf,{canTrain:{comum:Number(A==null?void 0:A.vendedoresComuns)||0,field:Number(A==null?void 0:A.fieldSales)||0,inside:Number(A==null?void 0:A.insideSales)||0,gestor:Number((A==null?void 0:A.gestores)??(A==null?void 0:A.gestoresComerciais)??(A==null?void 0:A.managers))||0},ownedByType:{comum:((q=A==null?void 0:A.trainingsByVendor)==null?void 0:q.comum)||[],field:((ge=A==null?void 0:A.trainingsByVendor)==null?void 0:ge.field)||[],inside:((me=A==null?void 0:A.trainingsByVendor)==null?void 0:me.inside)||[],gestor:((Q=A==null?void 0:A.trainingsByVendor)==null?void 0:Q.gestor)||[]}}));if(!J||J.action!=="BUY")return;const ee=Number(J.grandTotal||0);if(!At(W,ee,"comprar Treinamento")){m(!1);return}e(Y=>{const ye=ne(Y,re,ze=>$f(ze,J));return S(ye,s,pe.current),ye})})()),(te===5||te===10||te===43)&&d&&v&&C&&(F.current=!0,(async()=>{var ee,q,ge,me,Q,Y,ye,ze,Et,Ot,De,Tt,Le,on,Pt,be,Ce,gn,ot,Xe;const A=((ee=$[W])==null?void 0:ee.cash)??b,J=await st(a.jsx(kb,{currentCash:A}));if(J){if(J.action==="OPEN"){const ct=String(J.open||"").toUpperCase();if(ct==="MIX"){const B=((q=t[W])==null?void 0:q.mixProdutos)||null,ce=((ge=t[W])==null?void 0:ge.mixOwned)||((me=t[W])==null?void 0:me.mix)||{},de=await st(a.jsx(Kf,{currentCash:((Q=$[W])==null?void 0:Q.cash)??b,currentLevel:B,mixOwned:ce}));if(de&&de.action==="BUY"){const Se=Number(de.compra||0),Ie=String(de.level||"D");if(!At(W,Se,"comprar MIX")){m(!1);return}const _e=Math.max(0,- -Se);e(Be=>{const yt=ne(Be,re,an=>qt(an,{cashDelta:-Se,bensDelta:_e,mixProdutosSet:Ie,mixBaseSet:{despesaPorCliente:Number(de.despesa||0),faturamentoPorCliente:Number(de.faturamento||0)}}));return S(yt,s,pe.current),yt})}return}if(ct==="MANAGER"){const B=await st(a.jsx(Gf,{currentCash:((Y=$[W])==null?void 0:Y.cash)??b}));if(B&&(B.action==="BUY"||B.action==="HIRE")){const ce=Number(B.headcount??B.qty??B.managersQty??1),de=Number(typeof B.cashDelta<"u"?B.cashDelta:-Number(B.cost??B.total??B.totalHire??0)),Se=de<0?-de:0;if(Se>0&&!At(W,Se,"contratar Gestor")){m(!1);return}const Ie=Number(B.expenseDelta??B.totalExpense??B.maintenanceDelta??0);e(_e=>{const Be=ne(_e,re,yt=>qt(yt,{cashDelta:de,gestoresDelta:ce,manutencaoDelta:Ie}));return S(Be,s,pe.current),Be})}return}if(ct==="INSIDE"){const B=await st(a.jsx(Wf,{currentCash:((ye=$[W])==null?void 0:ye.cash)??b}));if(B&&(B.action==="BUY"||B.action==="HIRE")){const ce=Number(B.cost??B.total??0);if(!At(W,ce,"contratar Inside Sales")){m(!1);return}const de=Number(B.headcount??B.qty??1);e(Se=>{const Ie=ne(Se,re,_e=>qt(_e,{cashDelta:-ce,insideSalesDelta:de}));return S(Ie,s,pe.current),Ie})}return}if(ct==="FIELD"){const B=await st(a.jsx(qf,{currentCash:((ze=$[W])==null?void 0:ze.cash)??b}));if(B&&(B.action==="HIRE"||B.action==="BUY")){const ce=Number(B.headcount??B.qty??1),de={cashDelta:Number(B.cashDelta??-Number(B.totalHire??B.total??B.cost??0)),manutencaoDelta:Number(B.expenseDelta??B.totalExpense??0),revenueDelta:Number(B.revenueDelta??0),fieldSalesDelta:ce},Se=de.cashDelta<0?-de.cashDelta:0;if(Se>0&&!At(W,Se,"contratar Field Sales")){m(!1);return}e(Ie=>{const _e=ne(Ie,re,Be=>qt(Be,de));return S(_e,s,pe.current),_e})}return}if(ct==="COMMON"){const B=await st(a.jsx(Hf,{currentCash:((Et=$[W])==null?void 0:Et.cash)??b}));if(B&&B.action==="BUY"){const ce=Number(B.headcount??B.qty??0),de={cashDelta:Number(B.cashDelta??-Number(B.totalHire??B.total??B.cost??0)),vendedoresComunsDelta:ce,manutencaoDelta:Number(B.expenseDelta??B.totalExpense??0),revenueDelta:Number(B.revenueDelta??0)},Se=de.cashDelta<0?-de.cashDelta:0;if(Se>0&&!At(W,Se,"contratar Vendedores Comuns")){m(!1);return}e(Ie=>{const _e=ne(Ie,re,Be=>qt(Be,de));return S(_e,s,pe.current),_e})}return}if(ct==="ERP"){const B=((Ot=t[W])==null?void 0:Ot.erpLevel)||null,ce=((De=t[W])==null?void 0:De.erpOwned)||((Tt=t[W])==null?void 0:Tt.erp)||{},de=await st(a.jsx(Ff,{currentCash:((Le=$[W])==null?void 0:Le.cash)??b,currentLevel:B,erpOwned:ce}));if(de&&de.action==="BUY"){const Se=Number(((on=de.values)==null?void 0:on.compra)||0);if(!At(W,Se,"comprar ERP")){m(!1);return}e(Ie=>{const _e=ne(Ie,re,Be=>qt(Be,{cashDelta:-Se,erpLevelSet:de.level}));return S(_e,s,pe.current),_e})}return}if(ct==="CLIENTS"){const B=Number(((Pt=$.find(de=>String(de.id)===re))==null?void 0:Pt.cash)??b),ce=await st(a.jsx(Vf,{currentCash:B}));if(ce&&ce.action==="BUY"){const de=Number(ce.totalCost||0);if(B<de){y("Saldo insuficiente para comprar Clientes."),m(!1);return}const Se=Number(ce.qty||0),Ie=Number(ce.maintenanceDelta||0),_e=Number(ce.bensDelta||de);e(Be=>{const yt=Be.map(an=>String(an.id)!==re?an:qt(an,{cashDelta:-de,clientsDelta:Se,manutencaoDelta:Ie,bensDelta:_e}));return S(yt,s,pe.current),yt})}return}if(ct==="TRAINING"){const B=t.find(h)||$[W],ce=await st(a.jsx(zf,{canTrain:{comum:Number(B==null?void 0:B.vendedoresComuns)||0,field:Number(B==null?void 0:B.fieldSales)||0,inside:Number(B==null?void 0:B.insideSales)||0,gestor:Number((B==null?void 0:B.gestores)??(B==null?void 0:B.gestoresComerciais)??(B==null?void 0:B.managers))||0},ownedByType:{comum:((be=B==null?void 0:B.trainingsByVendor)==null?void 0:be.comum)||[],field:((Ce=B==null?void 0:B.trainingsByVendor)==null?void 0:Ce.field)||[],inside:((gn=B==null?void 0:B.trainingsByVendor)==null?void 0:gn.inside)||[],gestor:((ot=B==null?void 0:B.trainingsByVendor)==null?void 0:ot.gestor)||[]}}));if(ce&&ce.action==="BUY"){const de=Number(ce.grandTotal||0);if(!At(W,de,"comprar Treinamento")){m(!1);return}e(Se=>{const Ie=ne(Se,re,_e=>$f(_e,ce));return S(Ie,s,pe.current),Ie})}return}}if(J.action==="BUY"){if(J.kind==="CLIENTS"||J.modal==="CLIENTS"||typeof J.clientsQty<"u"||typeof J.numClients<"u"||typeof J.totalCost<"u"||typeof J.maintenanceDelta<"u"){const ce=Number(J.totalCost??J.total??J.amount??0);if(Number(((Xe=$.find(Be=>String(Be.id)===re))==null?void 0:Xe.cash)??b)<ce){y("Saldo insuficiente para comprar Clientes."),m(!1);return}const Se=Number(J.clientsQty??J.numClients??J.qty??0),Ie=Number(J.maintenanceDelta??J.maintenance??J.mexp??0),_e=Number(J.bensDelta??ce);e(Be=>{const yt=Be.map(an=>String(an.id)!==re?an:qt(an,{cashDelta:-ce,clientsDelta:Se,manutencaoDelta:Ie,bensDelta:_e}));return S(yt,s,pe.current),yt});return}const B=Number(J.total??J.amount??0);if(!At(W,B,"esta compra")){m(!1);return}e(ce=>{const de=ce.map((Se,Ie)=>Ie!==W?Se:qt(Se,{cashDelta:-B,directBuysPush:[J.item||{total:B}]}));return S(de,s,pe.current),de})}}})()),(te===12||te===21||te===30||te===42||te===53)&&d&&v&&C&&(F.current=!0,(async()=>{var q;const A=await st(a.jsx(Wf,{currentCash:((q=$[W])==null?void 0:q.cash)??b}));if(!A||A.action!=="HIRE"&&A.action!=="BUY")return;const J=Number(A.cost??A.total??0);if(!At(W,J,"contratar Inside Sales")){m(!1);return}const ee=Number(A.headcount??A.qty??1);e(ge=>{const me=ne(ge,re,Q=>qt(Q,{cashDelta:-J,insideSalesDelta:ee}));return S(me,s,pe.current),me})})()),[4,8,15,17,20,27,34,36,39,46,52,55].includes(te)&&d&&v&&C&&(F.current=!0,(async()=>{var Q;const A=Number(((Q=$.find(Y=>String(Y.id)===re))==null?void 0:Q.cash)??b),J=await st(a.jsx(Vf,{currentCash:A}));if(!J||J.action!=="BUY")return;const ee=Number(J.totalCost||0);if(A<ee){y("Saldo insuficiente para comprar Clientes."),m(!1);return}const q=Number(J.qty||0),ge=Number(J.maintenanceDelta||0),me=Number(J.bensDelta||ee);e(Y=>{const ye=Y.map(ze=>String(ze.id)!==re?ze:qt(ze,{cashDelta:-ee,clientsDelta:q,manutencaoDelta:ge,bensDelta:me}));return S(ye,s,pe.current),ye})})()),[18,24,29,51].includes(te)&&d&&v&&C&&(F.current=!0,(async()=>{var me;const A=await st(a.jsx(Gf,{currentCash:((me=$[W])==null?void 0:me.cash)??b}));if(!A||A.action!=="BUY"&&A.action!=="HIRE")return;const J=Number(A.headcount??A.qty??A.managersQty??1),ee=Number(typeof A.cashDelta<"u"?A.cashDelta:-Number(A.cost??A.total??A.totalHire??0)),q=ee<0?-ee:0;if(q>0&&!At(W,q,"contratar Gestor")){m(!1);return}const ge=Number(A.expenseDelta??A.totalExpense??A.maintenanceDelta??0);e(Q=>{const Y=ne(Q,re,ye=>qt(ye,{cashDelta:ee,gestoresDelta:J,manutencaoDelta:ge}));return S(Y,s,pe.current),Y})})()),[13,25,33,38,50].includes(te)&&d&&v&&C&&(F.current=!0,(async()=>{var J;const A=await st(a.jsx(qf,{currentCash:((J=$[W])==null?void 0:J.cash)??b}));if(A&&(A.action==="HIRE"||A.action==="BUY")){const ee=Number(A.headcount??A.qty??1),q={cashDelta:Number(A.cashDelta??-Number(A.totalHire??A.total??A.cost??0)),manutencaoDelta:Number(A.expenseDelta??A.totalExpense??0),revenueDelta:Number(A.revenueDelta??0),fieldSalesDelta:ee},ge=q.cashDelta<0?-q.cashDelta:0;if(ge>0&&!At(W,ge,"contratar Field Sales")){m(!1);return}e(me=>{const Q=ne(me,re,Y=>qt(Y,q));return S(Q,s,pe.current),Q})}})()),[9,28,40,45].includes(te)&&d&&v&&C&&(F.current=!0,(async()=>{var ge;const A=await st(a.jsx(Hf,{currentCash:((ge=$[W])==null?void 0:ge.cash)??b}));if(!A||A.action!=="BUY")return;const J=Number(A.headcount??A.qty??0),ee={cashDelta:Number(A.cashDelta??-Number(A.totalHire??A.total??A.cost??0)),vendedoresComunsDelta:J,manutencaoDelta:Number(A.expenseDelta??A.totalExpense??0),revenueDelta:Number(A.revenueDelta??0)},q=ee.cashDelta<0?-ee.cashDelta:0;if(q>0&&!At(W,q,"contratar Vendedores Comuns")){m(!1);return}e(me=>{const Q=ne(me,re,Y=>qt(Y,ee));return S(Q,s,pe.current),Q})})()),[7,31,44].includes(te)&&d&&v&&C&&(F.current=!0,(async()=>{var Q,Y,ye,ze;const A=((Q=t[W])==null?void 0:Q.mixProdutos)||null,J=((Y=t[W])==null?void 0:Y.mixOwned)||((ye=t[W])==null?void 0:ye.mix)||{},ee=await st(a.jsx(Kf,{currentCash:((ze=$[W])==null?void 0:ze.cash)??b,currentLevel:A,mixOwned:J}));if(!ee||ee.action!=="BUY")return;const q=Number(ee.compra||0);if(!At(W,q,"comprar MIX")){m(!1);return}const ge=String(ee.level||"D"),me=Math.max(0,q);e(Et=>{const Ot=Et.map((De,Tt)=>Tt!==W?De:qt(De,{cashDelta:-q,bensDelta:me,mixProdutosSet:ge,mixBaseSet:{despesaPorCliente:Number(ee.despesa||0),faturamentoPorCliente:Number(ee.faturamento||0)}}));return S(Ot,s,pe.current),Ot})})());const sn=[3,14,22,26,35,41,48,54].includes(te);if(d&&!!v&&!!C&&(Ae||at||sn)){const A=xt.current;A._once=A._once||{};const J=(q,ge,me)=>{const Q=(ge-q+me)%me;return Q===0?me:Q},ee=[];Ae&&!A._once.faturamento&&(A._once.faturamento=!0,ee.push({type:"REVENUE",at:J(we,0,xs)})),at&&!A._once.expenses23&&(A._once.expenses23=!0,ee.push({type:"EXPENSES",at:J(we,22,xs)})),sn&&!A._once.luck&&(A._once.luck=!0,ee.push({type:"LUCK",at:K})),ee.sort((q,ge)=>q.at-ge.at),We(async()=>{let q=Array.isArray(Dt.current)?Dt.current:$;for(const ge of ee){const me=Je(q,re)||{};if(!(me!=null&&me.id))break;if(ge.type==="REVENUE"){F.current=!0;const Q=Math.max(0,Math.floor(al(me)));await st(a.jsx(jb,{value:Q})),q=ne(q,re,Y=>({...Y,cash:(Number(Y.cash)||0)+Q})),e(q),S(q,nr.current,pe.current),y(`${me.name} recebeu faturamento do ms: +$${Q.toLocaleString()}`);continue}if(ge.type==="EXPENSES"){F.current=!0;const Q=Math.max(0,Math.floor(ll(me))),Y=me.loanPending||{},ye=Number(Y.amount)>0&&!Y.charged&&Y.shouldChargeOnNextExpenses===!0,ze=ye?Math.max(0,Math.floor(Number(Y.amount))):0;await st(a.jsx(Cb,{expense:Q,loanCharge:ze}));const Et=Q+ze;if(!await Ne(Et,"Despesas Operacionais","pagar",q))return;q=Array.isArray(Dt.current)?Dt.current:q,ye&&(q=ne(q,re,De=>({...De,loanPending:{...De.loanPending||{},charged:!0,chargedAtRound:pe.current,shouldChargeOnNextExpenses:!1}})),e(q),S(q,nr.current,pe.current)),y(`${me.name} pagou despesas operacionais: -$${Q.toLocaleString()}`),ze>0&&y(`${me.name} teve emprstimo cobrado: -$${ze.toLocaleString()}`);continue}if(ge.type==="LUCK"){F.current=!0;const Q=Je(Array.isArray(Dt.current)?Dt.current:q,re)||Je(q,re)||me,Y=await st(a.jsx(Eb,{player:Q}));if(!Y||Y.action!=="APPLY_CARD")continue;let ye=Number.isFinite(Y.cashDelta)?Number(Y.cashDelta):0;const ze=Number.isFinite(Y.clientsDelta)?Number(Y.clientsDelta):0;if(ye<0){if(!await Ne(Math.abs(ye),"Sorte & Revs","pagar",q))return;ye=0,q=Array.isArray(Dt.current)?Dt.current:q}if(q=ne(q,re,Ot=>{var Tt;let De={...Ot};if(ye&&(De.cash=Math.max(0,(Number(De.cash)||0)+ye)),ze&&(De.clients=Math.max(0,(Number(De.clients)||0)+ze)),Y.gainSpecialCell&&(De.fieldSales=(De.fieldSales||0)+(Y.gainSpecialCell.fieldSales||0),De.support=(De.support||0)+(Y.gainSpecialCell.support||0),De.gestores=(De.gestores||0)+(Y.gainSpecialCell.manager||0),De.gestoresComerciais=(De.gestoresComerciais||0)+(Y.gainSpecialCell.manager||0),De.managers=(De.managers||0)+(Y.gainSpecialCell.manager||0)),Y.id==="casa_change_cert_blue"){De.az=(De.az||0)+1;const Le=new Set(((Tt=De.trainingsByVendor)==null?void 0:Tt.comum)||[]);Le.add("personalizado"),De.trainingsByVendor={...De.trainingsByVendor||{},comum:Array.from(Le)}}return De}),e(q),S(q,nr.current,pe.current),Y.perClientBonus||Y.perCertifiedManagerBonus||Y.mixLevelBonusABOnly){const Ot=Je(q,re)||{};let De=0;if(Y.perClientBonus&&(De+=(Number(Ot.clients)||0)*Number(Y.perClientBonus||0)),Y.perCertifiedManagerBonus&&(De+=lb(Ot)*Number(Y.perCertifiedManagerBonus||0)),Y.mixLevelBonusABOnly){const Tt=String(Ot.mixProdutos||"").toUpperCase();(Tt==="A"||Tt==="B")&&(De+=Number(Y.mixLevelBonusABOnly||0))}De&&(q=ne(q,re,Tt=>({...Tt,cash:(Number(Tt.cash)||0)+De})),e(q),S(q,nr.current,pe.current))}}}})}const os=Date.now();let sr=0;const is=200,Wn=()=>{var Y,ye,ze;if(sr++,sr>is){console.warn("[DEBUG]  TIMEOUT - excedeu tentativas mximas, forando desbloqueio");const Et=it.current;String(Et||"")===String(p)&&(m(!1),he.current=!1,je.current>0&&(console.warn("[DEBUG]  Forando modalLocks para 0 (timeout)"),je.current=0,ke(0)),F.current=!1);return}const A=je.current,J=F.current||oe.current,ee=it.current,q=String(ee||"")===String(p);if(console.log("[DEBUG] tick - tentativa:",sr,"modalLocks:",A,"openingModalRef:",J,"lockOwner:",ee,"myUid:",p,"isLockOwner:",q),J){console.log("[DEBUG]  tick - modal est sendo aberta, aguardando..."),setTimeout(Wn,150);return}const ge=pt.current?Date.now()-pt.current:1/0;if(A===0&&(ge>=200||!pt.current)){const Et=xt.current;if(!!(Et!=null&&Et.endGame||rs.current)&&!ss.current){ss.current=!0,rs.current=!1;const Le=Array.isArray(Dt.current)?Dt.current:(Et==null?void 0:Et.nextPlayers)||[],on=(Le||[]).filter(be=>!(be!=null&&be.bankrupt));let Pt=null;on.length>0&&(Pt=((Y=on.map(Ce=>({p:Ce,patrimonio:(Number(Ce.cash)||0)+(Number(Ce.bens)||0),cash:Number(Ce.cash)||0})).sort((Ce,gn)=>{var ot,Xe;return gn.patrimonio-Ce.patrimonio||gn.cash-Ce.cash||String(((ot=Ce.p)==null?void 0:ot.name)||"").localeCompare(String(((Xe=gn.p)==null?void 0:Xe.name)||""))})[0])==null?void 0:Y.p)||null),console.log("[ENDGAME] finalizando: vencedor=%s, round=5",(Pt==null?void 0:Pt.name)||""),e(Le||[]),k(!0),R(Pt),r(5),pe.current=5,xt.current=null,he.current=!1,F.current=!1,m(!1),S(Le||[],nr.current,5,!0,Pt,{round:5,gameOver:!0,winner:Pt});return}const De=t[s],Tt=De&&String(De.id)===String(p);if(q||Tt&&!ee){const Le=xt.current;if(console.log("[DEBUG]  tick - verificando pendingTurnDataRef:",Le?`prximo turno: ${Le.nextTurnIdx}`:"null"),Le){const on=Array.isArray(Dt.current)&&Dt.current.length?Dt.current:Le.nextPlayers||[],Pt=je.current,be=F.current,Ce=s,gn=it.current,ot=String(gn||"")===String(p),Xe=pt.current?Date.now()-pt.current:1/0,ct=Pt===0&&!be&&(Xe>=200||!pt.current);if(ct&&Ce===s&&ot){console.log("[DEBUG]  Mudando turno - de:",s,"para:",Le.nextTurnIdx,"finalModalLocks:",Pt,"finalOpening:",be,"timeSinceLastModalClosed:",Xe);const B=pe.current===5&&Le.shouldIncrementRound,ce=Le.endGame===!0;if(B||ce||Le.shouldIncrementRound&&Le.nextRound>Cn){console.log("[ENDGAME] detectado: fim da 5 - currentRound:",pe.current,"shouldIncrementRound:",Le.shouldIncrementRound,"nextRound:",Le.nextRound);const _e=Ei(on,Le.nextRound,s);if(_e.finished){console.log("[DEBUG]  FIM DE JOGO finalizando - Rodada:",_e.finalRound,"Vencedor:",((ye=_e.winner)==null?void 0:ye.name)||null),e(on),R(_e.winner),k(!0),r(_e.finalRound),pe.current=_e.finalRound,y(`Fim de jogo! ${Cn} rodadas completas. Vencedor: ${((ze=_e.winner)==null?void 0:ze.name)||""}`);const Be={};Le.nextRoundFlags&&(Be.roundFlags=Le.nextRoundFlags),Be.round=_e.finalRound,Be.gameOver=!0,Be.winner=_e.winner,S(on,s,_e.finalRound,!0,_e.winner,Be),xt.current=null,m(!1),he.current=!1;return}}he.current=!0;const de=Le.nextRound,Se=Le.shouldIncrementRound||!1;console.log("[DEBUG]  Broadcast - Rodada a ser transmitida:",de,"Rodada atual no estado:",n,"shouldIncrement:",Se),o(Le.nextTurnIdx),l&&l(Le.nextTurnPlayerId??null),r(_e=>{const Be=Math.min(Cn,de),yt=Math.min(Cn,Math.max(_e,Be));return yt!==_e&&console.log("[DEBUG]  Rodada atualizada no tick - de:",_e,"para:",yt),pe.current=yt,yt});const Ie={};Le.nextRoundFlags&&(Ie.roundFlags=Le.nextRoundFlags),Le.shouldIncrementRound&&(Ie.round=de),Le.nextTurnPlayerId&&(Ie.turnPlayerId=Le.nextTurnPlayerId),S(on,Le.nextTurnIdx,de,w,D,Ie),xt.current=null,m(!1),he.current=!1,console.log("[DEBUG]  Turno mudado com sucesso - Rodada:",de)}else{console.log("[DEBUG]  tick - condies no atendidas, no mudando turno",{finalModalLocks:Pt,finalOpening:be,finalCanChangeTurn:ct,timeSinceLastModalClosed:Xe,finalTurnIdx:Ce,turnIdx:s,finalIsLockOwner:ot,isLockOwner:q}),console.log("[DEBUG]  tick - condies no atendidas, no mudando turno",{finalModalLocks:Pt,finalOpening:be,finalTurnIdx:Ce,turnIdx:s,finalIsLockOwner:ot,isLockOwner:q}),setTimeout(Wn,150);return}}else{console.log("[DEBUG]  tick - turnData  null, no mudando turno. turnIdx atual:",s,"lockOwner:",ee,"isLockOwner:",q);const on=pt.current?Date.now()-pt.current:1/0,Pt=A===0&&(on>=200||!pt.current);if(q&&Pt&&!J)if(sr<10){console.log("[DEBUG]  tick - tentando novamente em 200ms (pode ser que pendingTurnDataRef ainda no foi preenchido)"),setTimeout(Wn,200);return}else console.warn("[DEBUG]  tick - excedeu tentativas de retry, liberando turnLock"),m(!1),he.current=!1;else m(!1),he.current=!1}}else console.log("[DEBUG]  tick - no sou o dono do cadeado e no  minha vez, no mudando turno",{isLockOwner:q,isCurrentPlayerMe:Tt,currentLockOwner:ee,myUid:p,turnIdx:s}),Tt||(m(!1),he.current=!1);return}setTimeout(Wn,100)};let mn=0;const Mt=50,lt=()=>{mn++;const A=F.current,J=je.current>0;if((A||J)&&mn<Mt){mn%5===1&&console.log("[DEBUG]  checkBeforeTick - aguardando modais...",{hasOpening:A,hasLocks:J,modalLocks:je.current,attempt:mn});const ee=Math.min(1e3,Math.floor(150*Math.pow(1.35,mn)));setTimeout(lt,ee);return}mn>=Mt&&(console.warn("[DEBUG]  checkBeforeTick - excedeu tentativas, forando avano do turno",{hasOpening:A,hasLocks:J,modalLocks:je.current}),je.current>0&&(console.warn("[DEBUG]  checkBeforeTick - forando modalLocks para 0"),je.current=0,ke(0)),F.current=!1),console.log("[DEBUG]  checkBeforeTick - iniciando tick, sem modais abertas"),Wn()};setTimeout(lt,500)}catch(W){throw console.error("[DEBUG] Erro em advanceAndMaybeLap:",W),it.current===String(p)&&m(!1),W}finally{it.current===String(p)?setTimeout(()=>{it.current===String(p)&&(m(!1),he.current=!1)},100):he.current=!1}}},[t,n,s,u,d,h,p,b,w,y,S,e,r,o,c,m,At,Ei,v,C,P]),ul=ue.useCallback(()=>{if(w||!t.length)return;const K=Ao(t,s),xe=t[K],Ee=xe!=null&&xe.id?String(xe.id):null;o(K),l&&l(Ee),S(t,K,pe.current,!1,null,{turnPlayerId:Ee})},[S,w,t,n,o,l,s]),$t=ue.useCallback(K=>{var xe,Ee,W,Ye,re,Ne,we,Vt,jn,rr;if(!(!(K!=null&&K.type)||Wt.current||rs.current||ss.current)){if(K.type==="ROLL"){if(!i||String(i)!==String(p)){console.warn("[ROLL_BLOCK] not my turn (turnPlayerId mismatch)",{turnPlayerId:i,myUid:p});return}if(!d){console.warn("[DEBUG]  onAction ROLL - no  minha vez, ignorando");return}if(f){console.warn("[DEBUG]  onAction ROLL - turnLock ativo, ignorando");return}const _=it.current;if(f&&_&&String(_)!==String(p)){console.warn("[ROLL_BLOCK] locked by other",{lockOwner:_,myUid:p});return}if(je.current>0){console.warn("[DEBUG]  onAction ROLL - h modais abertas, ignorando");return}try{const O=`ROLL:r${pe.current}:t${nr.current}:${Date.now()}`;xb(Tb({traceId:O,actionType:"ROLL",reason:K.note||"ROLL",origin:{file:"src/game/useTurnEngine.jsx",fn:"onAction(ROLL)"},context:{round:pe.current}}))}catch{}try{wo(K.steps,K.cashDelta,K.note)}catch(O){console.error("[DEBUG] Erro em advanceAndMaybeLap:",O),it.current===String(p)&&m(!1)}return}if(K.type==="RECOVERY"){const _=Math.floor(Math.random()*3e3)+1e3,O=t.find(h);if(!O)return;const U=t.map($=>h($)?{...$,cash:$.cash+_}:$);y(`${O.name} ativou Recuperao Financeira (+$${_})`),e(U),S(U,s,pe.current);return}if(K.type==="RECOVERY_CUSTOM"){const _=Number(K.amount||0),O=t.find(h);if(!O)return;const U=t.map($=>h($)?{...$,cash:$.cash+_}:$);y(`${O.name} recuperou +$${_}`),e(U),S(U,s,pe.current);return}if(K.type==="RECOVERY_MODAL"){if(!d||!v||!C)return;(async()=>{const _=await st(a.jsx(Jf,{playerName:(x==null?void 0:x.name)||"Jogador",currentPlayer:x}));if(_){if(_&&_.type==="TRIGGER_BANKRUPTCY"){$t({type:"BANKRUPT"});return}switch(_.type){case"FIRE":$t==null||$t({type:"RECOVERY_FIRE",items:_.items,amount:_.totalCredit??_.amount??0,note:_.note,creditByRole:_.creditByRole});break;case"REDUCE":{const O=Array.isArray(_.items)&&_.items.length>0,U=O?_.items.map((V,L)=>({...V,group:String(V.group||V.tipo||"").toUpperCase(),level:String(V.level||V.nivel||"").toUpperCase(),credit:Number(V.credit??V.amount??0),selected:L===0?!0:!!V.selected})):void 0,$=O&&(U==null?void 0:U[0])||_.selection||_.sel||(_.group&&_.level?{group:String(_.group).toUpperCase(),level:String(_.level).toUpperCase(),credit:Number(_.credit??_.amount??0)}:null),T=Number((O?_.total??_.totalCredit:void 0)??($==null?void 0:$.credit)??_.amount??0),M=_.note||(O?`Reduo mltipla +R$ ${T.toLocaleString()}`:$?`Reduo ${$.group} nvel ${$.level} +R$ ${T.toLocaleString()}`:`Reduo +R$ ${T.toLocaleString()}`);$t==null||$t({type:"RECOVERY_REDUCE",items:U,selection:$||null,amount:T,note:M});break}case"LOAN":{const O=typeof _.amount=="object"&&_.amount!==null?_.amount:{amount:Number(_.amount??0),cashDelta:Number(_.cashDelta??_.amount??0),loan:_.loan},U=Number(O.amount??0),$=Number(O.cashDelta??U??0),T=O.loan??_.loan??{};$t==null||$t({type:"RECOVERY_LOAN",amount:U,cashDelta:$,loan:T,note:_.note});break}default:_.amount>0&&($t==null||$t({type:"RECOVERY_CUSTOM",amount:_.amount,note:_.note}))}}})();return}if(K.type==="BANKRUPT_MODAL"){if(!d||!v||!C)return;(async()=>await st(a.jsx(Ob,{playerName:(x==null?void 0:x.name)||"Jogador"}))&&($t==null||$t({type:"BANKRUPT"})))();return}if(K.type==="RECOVERY_FIRE"){const _=Number(K.amount||0),O=K.items||{},U={cashDelta:_,vendedoresComunsDelta:-Number(O.comum||0),fieldSalesDelta:-Number(O.field||0),insideSalesDelta:-Number(O.inside||0),gestoresDelta:-Number(O.gestor||0)},$=s,T=String(((xe=t[$])==null?void 0:xe.id)??"");e(M=>{const V=T?ne(M,T,L=>qt(L,U)):M;return S(V,s,pe.current),V}),y(`${((Ee=t[$])==null?void 0:Ee.name)||"Jogador"}: ${K.note||"Demisses"}`);return}if(K.type==="RECOVERY_LOAN"){const _=Math.max(0,Number(K.amount||0));if(!_)return;const O=s,U=t[O];if(U!=null&&U.loanPending&&!U.loanPending.charged){y(`${(U==null?void 0:U.name)||"Jogador"} j possui um emprstimo pendente.`);return}e($=>{const T=$.map((M,V)=>V!==O?M:{...M,cash:(Number(M.cash)||0)+_,loanPending:{amount:_,charged:!1,shouldChargeOnNextExpenses:!0}});return S(T,s,pe.current),T}),y(`${(U==null?void 0:U.name)||"Jogador"} pegou emprstimo: +$${_.toLocaleString()}`);return}if(K.type==="BUY_MIX"||K.kind==="MIX_BUY"||K.type==="DIRECT_BUY_MIX"){const _=String(K.level||"").toUpperCase(),O=Math.max(0,Number(K.price??0));if(!["A","B","C","D"].includes(_)){m(!1);return}const U=s;if(!Os(U,O)){y("Saldo insuficiente para comprar MIX"),m(!1);return}e($=>{const T=$.map((M,V)=>{if(V!==U)return M;const L={...M.mixOwned||M.mix||{},D:!0};return L[_]=!0,{...M,cash:Math.max(0,(Number(M.cash)||0)-O),bens:(Number(M.bens)||0)+O,mixOwned:L,mix:L,mixLevel:_,mixProdutos:_}});return S(T,s,pe.current),T}),y(`${((W=t[U])==null?void 0:W.name)||"Jogador"} comprou MIX nvel ${_} por -$${O.toLocaleString()}`),m(!1);return}if(K.type==="BUY_ERP"||K.kind==="ERP_BUY"||K.type==="DIRECT_BUY_ERP"){const _=String(K.level||"").toUpperCase(),O=Math.max(0,Number(K.price??0));if(!["A","B","C","D"].includes(_)){m(!1);return}const U=s;if(!Os(U,O)){y("Saldo insuficiente para comprar ERP"),m(!1);return}e($=>{const T=$.map((M,V)=>{if(V!==U)return M;const L={...M.erpOwned||M.erp||{},D:!0};return L[_]=!0,{...M,cash:Math.max(0,(Number(M.cash)||0)-O),erpOwned:L,erp:L,erpLevel:_,erpSystems:{...M.erpSystems||{},level:_}}});return S(T,s,pe.current),T}),y(`${((Ye=t[U])==null?void 0:Ye.name)||"Jogador"} comprou ERP nvel ${_} por -$${O.toLocaleString()}`),m(!1);return}if(K.type==="RECOVERY_REDUCE"){const _=ae=>String(ae||"").toUpperCase(),O=ae=>{const te=String(ae||"").toUpperCase();return te==="MIX"||te==="ERP"?te:te.includes("MIX")?"MIX":te.includes("ERP")?"ERP":""},$=(()=>{if(Array.isArray(K.items)&&K.items.length)return K.items.filter(te=>(te==null?void 0:te.selected)??!0).map(te=>({group:O(te.group||te.kind),level:_(te.level),credit:Math.max(0,Number(te.credit??te.amount??0))})).filter(te=>(te.group==="MIX"||te.group==="ERP")&&["A","B","C"].includes(te.level));const ae=K.selection||K.target||null;if(ae){const te={group:O(ae.group||ae.kind),level:_(ae.level),credit:Math.max(0,Number(ae.credit??ae.amount??K.amount??0))};if((te.group==="MIX"||te.group==="ERP")&&["A","B","C"].includes(te.level))return[te]}return[]})();if(!$.length){const ae=Math.max(0,Number(K.amount??0));if(ae>0){const te=s;e(Ae=>{const at=Ae.map((Pe,z)=>z!==te?Pe:{...Pe,cash:(Number(Pe.cash)||0)+ae});return S(at,s,pe.current),at})}return}const T=(ae,te)=>{const Ae={A:!1,B:!1,C:!1,D:!1,...ae||{}},at=_(te);return!Ae.A&&!Ae.B&&!Ae.C&&!Ae.D&&(["A","B","C","D"].includes(at)?Ae[at]=!0:Ae.D=!0),Ae},M=ae=>ae!=null&&ae.A?"A":ae!=null&&ae.B?"B":ae!=null&&ae.C?"C":ae!=null&&ae.D?"D":"-",V=s,L=t[V];if($.some(ae=>ae.level==="D")){y("No  possvel reduzir o nvel D (bsico).");return}const Ke=Array.isArray((re=L.reducedLevels)==null?void 0:re.MIX)?L.reducedLevels.MIX:[],Ge=Array.isArray((Ne=L.reducedLevels)==null?void 0:Ne.ERP)?L.reducedLevels.ERP:[];if($.some(ae=>ae.group==="MIX"&&Ke.includes(ae.level)||ae.group==="ERP"&&Ge.includes(ae.level))){y("No  possvel reduzir um nvel que j foi reduzido anteriormente.");return}e(ae=>{const te=ae.map((Ae,at)=>{var Wn,mn;if(at!==V)return Ae;let Pe={A:!1,B:!1,C:!1,D:!1,...Ae.mixOwned||Ae.mix||{}},z={A:!1,B:!1,C:!1,D:!1,...Ae.erpOwned||Ae.erp||{}};Pe=T(Pe,Ae.mixProdutos),z=T(z,Ae.erpSistemas);const le=[...Array.isArray((Wn=Ae.reducedLevels)==null?void 0:Wn.MIX)?Ae.reducedLevels.MIX:[]],Te=[...Array.isArray((mn=Ae.reducedLevels)==null?void 0:mn.ERP)?Ae.reducedLevels.ERP:[]];let Qe=0,fe=String(Ae.mixProdutos||"D").toUpperCase(),wt=String(Ae.erpLevel||Ae.erpSistemas||"D").toUpperCase();for(const Mt of $)if(Qe+=Math.max(0,Number(Mt.credit||0)),Mt.group==="MIX"){if(Mt.level===fe){const lt=["A","B","C","D"],A=lt.indexOf(fe);for(let J=A+1;J<lt.length;J++){const ee=lt[J];if(Pe[ee]||ee==="D"){fe=ee;break}}}delete Pe[Mt.level],Pe[Mt.level]=!1,le.includes(Mt.level)||le.push(Mt.level)}else if(Mt.group==="ERP"){if(Mt.level===wt){const lt=["A","B","C","D"],A=lt.indexOf(wt);for(let J=A+1;J<lt.length;J++){const ee=lt[J];if(z[ee]||ee==="D"){wt=ee;break}}}delete z[Mt.level],z[Mt.level]=!1,Te.includes(Mt.level)||Te.push(Mt.level)}Pe.A||Pe.B||Pe.C||(Pe.D=!0,Pe.A=!1,Pe.B=!1,Pe.C=!1),z.A||z.B||z.C||(z.D=!0,z.A=!1,z.B=!1,z.C=!1);const rn=M(Pe),sn=M(z),zn=rn!=="-"?rn:fe||"D",os=sn!=="-"?sn:wt||"D",sr={...Pe},is={...z};return{...Ae,cash:(Number(Ae.cash)||0)+Qe,mixOwned:sr,erpOwned:is,mix:sr,erp:is,mixProdutos:zn,erpLevel:os,erpSistemas:os,reducedLevels:{MIX:le,ERP:Te}}});return S(te,s,pe.current),te});const bt=$.reduce((ae,te)=>ae+Math.max(0,Number(te.credit||0)),0);if($.length===1){const ae=$[0];y(`${(L==null?void 0:L.name)||"Jogador"} reduziu ${ae.group} nvel ${ae.level} e recebeu +$${bt.toLocaleString()}`)}else y(`${(L==null?void 0:L.name)||"Jogador"} reduziu ${$.length} nveis e recebeu +$${bt.toLocaleString()}`);return}if(K.type==="BANKRUPT"){const _=s;try{String((we=t[_])==null?void 0:we.id)===String(p)&&(E==null||E(!0))}catch{}const O=t.map((T,M)=>M===_?{...T,bankrupt:!0}:T);if(y(`${((Vt=t[_])==null?void 0:Vt.name)||"Jogador"} declarou FALNCIA.`),Yo(O)<=1){const T=O.findIndex(M=>!(M!=null&&M.bankrupt));R(T>=0?O[T]:null),e(O),k(!0),m(!1),S(O,s,n,!0,T>=0?O[T]:null);return}const $=Ao(O,_);if(e(O),o($),l){const T=O[$];l(T!=null&&T.id?String(T.id):null)}m(!1),S(O,$,pe.current),console.log("[DEBUG]  advanceAndMaybeLap finalizada (falncia) - posio final:",(jn=O[$])==null?void 0:jn.pos);return}console.log("[DEBUG]  advanceAndMaybeLap finalizada normalmente - posio final:",(rr=nextPlayers[curIdx])==null?void 0:rr.pos)}},[t,n,s,d,h,p,b,w,y,S,e,r,o,m,k,R,At,v,C,P,E]);return ue.useEffect(()=>{if(X===0&&f&&!F.current){const K=it.current;String(K||"")===String(p)?(console.log("[DEBUG]  Destravando turnLock - modalLocks: 0, sou o lockOwner"),m(!1),he.current=!1):d||(console.log("[DEBUG]  Destravando turnLock - no  minha vez e no sou lockOwner"),m(!1),he.current=!1)}},[X,f,ns,p,d,m]),ue.useEffect(()=>{if(d&&X===0&&f&&!F.current){const K=it.current;String(K||"")===String(p)?(console.log("[DEBUG]  Destravando turnLock -  minha vez e sou o lockOwner"),m(!1),he.current=!1):K||(console.log("[DEBUG]  Destravando turnLock -  minha vez mas no h lockOwner"),m(!1),he.current=!1)}},[d,X,f,ns,p,m]),ue.useEffect(()=>()=>{He.current&&(clearTimeout(He.current),He.current=null),he.current=!1,F.current=!1},[]),{advanceAndMaybeLap:wo,onAction:$t,nextTurn:ul,modalLocks:X,lockOwner:ns}}const Bm=j.createContext(null),Lb=()=>j.useContext(Bm);function Ib({roomCode:t,hostId:e,children:n}){const r=!!Fe&&!!t,s=String(t||"").trim(),[o,i]=j.useState(!1),[l,u]=j.useState({}),[c,d]=j.useState(0),[h,p]=j.useState(null),g=j.useRef(l),b=j.useRef(c),x=j.useRef(h),S=j.useRef(0),y=j.useRef(null),f=j.useRef(null);j.useEffect(()=>{g.current=l},[l]),j.useEffect(()=>{b.current=c},[c]),j.useEffect(()=>{x.current=h},[h]);const m=async D=>{const{data:R,error:E}=await Fe.from("rooms").select("id, code, host_id, state, version, updated_at").eq("code",D).order("updated_at",{ascending:!1}).limit(1).maybeSingle();return E?(console.warn("[NET] getLatestRoomByCode error:",E.message||E),null):R};j.useEffect(()=>{if(!r)return;let D=!1;return(async()=>{let R=await m(s);if(!R){const E={code:s,state:{},version:0,host_id:e||null},{data:N,error:v}=await Fe.from("rooms").insert(E).select("id, code, host_id, state, version, updated_at").maybeSingle();if(v){console.warn("[NET] rooms/create:",v.message||v);return}if(D)return;N?R=N:R=await m(s)}D||(R&&(y.current=R.id,f.current=R.updated_at,u(R.state||{}),d(R.version??0)),i(!0))})(),()=>{D=!0}},[r,s,e]),j.useEffect(()=>{if(!r)return;const D=Fe.channel(`rooms:${s}`).on("postgres_changes",{event:"*",schema:"public",table:"rooms",filter:`code=eq.${s}`},R=>{const E=R.new||R.old||{},N=typeof E.version=="number"?E.version:null,v=E.state||null,C=(v==null?void 0:v.stateId)??null;(N!=null&&N>b.current||N!=null&&N===b.current&&C&&C!==x.current)&&(N!=null&&d(N),v&&u(v),C&&p(String(C)),E.updated_at&&(f.current=E.updated_at),E.id&&(y.current=E.id),S.current=Date.now(),N===b.current&&C&&C!==x.current?console.warn("[NET]  applied remote (same version, different stateId)",{version:N,stateId:C}):console.log("[NET]  applied remote v=%d (realtime)",N))}).subscribe();return()=>{try{Fe.removeChannel(D)}catch{}}},[r,s]),j.useEffect(()=>{if(!r)return;const D=setInterval(async()=>{var E;if(Date.now()-(S.current||0)<2e3)return;const R=await m(s);if(R){const N=((E=R.state)==null?void 0:E.stateId)??null;(R.version>b.current||R.version===b.current&&N&&N!==x.current)&&(d(R.version),u(R.state||{}),N&&p(String(N)),R.updated_at&&(f.current=R.updated_at),R.id&&(y.current=R.id))}},700);return()=>clearInterval(D)},[r,s]);const w=async D=>{var v,C,P;if(!r||!o)return;const R=3,E=new Date().toISOString();for(let I=1;I<=R;I++){let H=await m(s);if(!H){const he={code:s,state:{},version:0,host_id:e||null},{data:ht,error:It}=await Fe.from("rooms").insert(he).select("id, code, host_id, state, version, updated_at").maybeSingle();if(It){if(console.warn(`[NET] commit - insert failed (attempt ${I}/${R}):`,It.message||It),I<R){await new Promise(He=>setTimeout(He,50*I));continue}return}if(ht)H=ht,y.current=H.id,f.current=H.updated_at;else if(H=await m(s),!H){if(console.warn(`[NET] commit - no row after insert (attempt ${I}/${R})`),I<R){await new Promise(He=>setTimeout(He,50*I));continue}return}}H.id&&(y.current=H.id);let X=H.state||{},ke=typeof D=="function"?D(X)||{}:D||{};ke&&typeof ke=="object"&&(ke={...ke,stateId:(()=>{try{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID()}catch{}return`${Date.now()}-${Math.random().toString(16).slice(2)}`})()});const F=y.current||H.id;if(!F){if(console.warn("[NET] commit - no target ID available"),I<R){await new Promise(he=>setTimeout(he,50*I));continue}return}const{data:oe,error:Z}=await Fe.from("rooms").update({state:ke,version:(H.version||0)+1,updated_at:E}).eq("id",F).eq("version",H.version).select("state, version, updated_at").maybeSingle();if(!Z&&oe){u(oe.state||{}),d(oe.version??(H.version||0)+1),oe.updated_at&&(f.current=oe.updated_at),I>1&&console.log(`[NET] commit succeeded on attempt ${I}/${R}`);return}if(((Z==null?void 0:Z.code)==="PGRST116"||(Z==null?void 0:Z.status)===406||((v=Z==null?void 0:Z.message)==null?void 0:v.includes("0 rows"))||((C=Z==null?void 0:Z.message)==null?void 0:C.includes("Cannot coerce"))||(Z==null?void 0:Z.code)==="23505"||(Z==null?void 0:Z.message)&&Z.message.includes("version")||!oe)&&I<R){console.warn(`[NET] commit conflict (attempt ${I}/${R}):`,(Z==null?void 0:Z.message)||Z||"no rows updated","- retrying with merge monotnico...");const he=await m(s);if(he){H=he,y.current=he.id,f.current=he.updated_at,X=he.state||{};const ht=typeof D=="function"?D(X)||{}:D||{},It=((P=he.state)==null?void 0:P.stateVersion)??0,He=(ht==null?void 0:ht.stateVersion)??0,pt=Math.max(It,He)+1;ke={...X,...ht,stateVersion:pt}}await new Promise(ht=>setTimeout(ht,50*I));continue}console.warn(`[NET] commit conflict (attempt ${I}/${R}):`,(Z==null?void 0:Z.message)||Z||"no rows updated")}const N=await m(s);N?(u(N.state||{}),d(N.version??0),N.updated_at&&(f.current=N.updated_at),N.id&&(y.current=N.id),console.warn("[NET] commit failed after retries, resynced to latest state")):console.warn("[NET] commit fallback resync failed: no row found")},k=j.useMemo(()=>({enabled:r,ready:o,state:l,version:c,stateId:h,commit:w}),[r,o,l,c,h]);return a.jsx(Bm.Provider,{value:k,children:n})}const Fs=5,Ql=t=>{const e=Number(t);return Number.isFinite(e)?Math.min(Fs,Math.max(1,e)):1};function $b(){var we,Vt,jn,rr;const[t,e]=j.useState("start"),[n,r]=j.useState(null),[s,o]=j.useState(null),i=j.useMemo(()=>mi(),[]),[l,u]=j.useState(""),[c,d]=j.useState(i);j.useMemo(()=>Object.freeze({mixProdutos:"D",erpLevel:"D",clients:1,vendedoresComuns:1}),[]);const h=(_={})=>({..._,mixProdutos:_.mixProdutos??"D",erpLevel:_.erpLevel??"D",clients:_.clients??1,vendedoresComuns:_.vendedoresComuns??1}),p=_=>{if(!Array.isArray(_)||_.length===0)return _;const O=[..._].filter(Boolean),U=O.every(L=>Number.isInteger(L.joinOrder)),$=O.every(L=>Number.isInteger(L.seat));let T=U?O.sort((L,se)=>L.joinOrder-se.joinOrder||String((L==null?void 0:L.id)??"").localeCompare(String((se==null?void 0:se.id)??""))):$?O.sort((L,se)=>L.seat-se.seat||String((L==null?void 0:L.id)??"").localeCompare(String((se==null?void 0:se.id)??""))):O.sort((L,se)=>String((L==null?void 0:L.id)??(L==null?void 0:L.player_id)??"").localeCompare(String((se==null?void 0:se.id)??(se==null?void 0:se.player_id)??""))),M=0;const V=new Set(T.filter(L=>Number.isInteger(L.seat)).map(L=>L.seat));return T=T.map(L=>{if(Number.isInteger(L.seat))return L;for(;V.has(M);)M++;return V.add(M),{...L,seat:M++}}),T=T.map(L=>Number.isInteger(L.joinOrder)?L:Number.isInteger(L.seat)?{...L,joinOrder:L.seat}:{...L,joinOrder:0}),T=T.sort((L,se)=>L.joinOrder-se.joinOrder||String((L==null?void 0:L.id)??"").localeCompare(String((se==null?void 0:se.id)??""))),console.log("[App] normalizePlayers - ordenados:",T.map(L=>({id:L.id,name:L.name,seat:L.seat}))),T},[g,b]=j.useState([h({id:i,name:"",cash:18e3,pos:0,color:"#ffd54f",bens:4e3})]),x=ue.useCallback((_,O={})=>{b(U=>{var T;const $=typeof _=="function"?_(U):_;bb(U,$,null);try{const M=(O==null?void 0:O.source)||"UNKNOWN",V=new Map((U||[]).map(L=>[String(L==null?void 0:L.id),L]));for(const L of $||[]){const se=String(L==null?void 0:L.id),Ke=(T=V.get(se))==null?void 0:T.pos,Ge=L==null?void 0:L.pos;Ge!==void 0&&Ke!==void 0&&Number(Ke)!==Number(Ge)&&console.log("[POS_CHANGE]",{playerId:se,from:Ke,to:Ge,source:M})}}catch{}return $})},[]);j.useEffect(()=>{let _=!1;try{_=!1}catch{}try{new URL(window.location.href).searchParams.get("cashAudit")==="1"&&(_=!0)}catch{}$m({enabled:_})},[]);const[S,y]=j.useState(1),[f,m]=j.useState(0),[w,k]=j.useState(null),[D,R]=j.useState(new Array(1).fill(!1)),[E,N]=j.useState(!1),[v,C]=j.useState(null),[P,I]=j.useState({id:i,name:((we=g[0])==null?void 0:we.name)||"Jogador",color:((Vt=g[0])==null?void 0:Vt.color)||"#6c5ce7",cash:((jn=g[0])==null?void 0:jn.cash)??18e3,possibAt:0,clientsAt:0,matchId:"local"}),[H,X]=j.useState(["Bem-vindo ao Sales Game!"]),ke=_=>X(O=>[_,...O].slice(0,12)),[je,F]=j.useState(!1),[oe,Z]=j.useState(null),We=j.useRef(null),he=j.useRef(!1),ht=j.useRef(null),It=j.useRef(0);j.useEffect(()=>{je&&(oe||(w?(console.warn("[LOCK_INVARIANT] turnLock=true com lockOwner=null -> corrigindo owner para turnPlayerId",{turnPlayerId:w}),Z(String(w))):(console.warn("[LOCK_INVARIANT] turnLock=true sem turnPlayerId -> desligando turnLock"),F(!1))))},[je,oe,w]);const He=ue.useCallback(_=>!!_&&String(_.id)===String(c),[c]),pt=j.useMemo(()=>{var _;return((_=g.find(He))==null?void 0:_.cash)??0},[g,He]);j.useEffect(()=>{try{const _=new URL(window.location.href),O=_.searchParams.get("room"),U=localStorage.getItem("sg:lastRoomName"),$=O||U;if(U&&!O&&localStorage.removeItem("sg:lastRoomName"),$&&O){o(String($)),r(String($));try{_.searchParams.set("room",String($)),history.replaceState(null,"",_.toString())}catch{}}}catch{}},[]);const er=j.useMemo(()=>`sg-sync:${n||"local"}`,[n]);j.useEffect(()=>{var _,O;try{(O=(_=We.current)==null?void 0:_.close)==null||O.call(_);const U=new BroadcastChannel(er);return U.onmessage=$=>{var M,V,L,se,Ke,Ge;const T=$.data||{};if(String(T.source)!==String(i)){if(T.type==="START"){if(ve!=null&&ve.enabled){console.log("[INIT_GUARD] init skipped: net enabled (BC START ignored)");return}if(he.current){console.log("[INIT_GUARD] init skipped: hydratedFromNet=true (BC START ignored)");return}if(t==="start"){console.log("[INIT_GUARD] init skipped: phase=start (BC START ignored)");return}const Ze=Array.isArray(T.players)?T.players.map(h):[];if(!Ze.length)return;const bt=p(Ze);try{const te=window.__MY_UID||window.__myUid||window.__playerId||null;te&&d(String(te))}catch{}x(bt,{source:"BC_START"}),m(0);const ae=(M=bt[0])!=null&&M.id?String(bt[0].id):null;k(ae),y(1),R(new Array(Math.max(1,bt.length)).fill(!1)),N(!1),C(null),X(["Jogo iniciado!"]);return}if(T.type==="TURNLOCK"){F(!!T.value),T.value?T.owner&&Z(String(T.owner)):Z(null);return}if(T.type==="SYNC"&&t==="game"){if(ve!=null&&ve.enabled){console.log("[App] SYNC ignorado - net enabled, usando Supabase como autoridade nica");return}const Ze=Number(T.version||0),bt=Number(T.timestamp||0),ae=pe.current;if(console.log("[App] SYNC recebido - verso remota:",Ze,"verso local:",ae,"turnIdx:",T.turnIdx,"round:",T.round,"source:",T.source),console.log("[App] SYNC - meu turnIdx atual:",f,"meu myUid:",c),Ze>0&&ae>0&&Ze<ae){console.log("[App] SYNC -  REJEITANDO estado remoto - verso antiga:",Ze,"< verso local:",ae);return}const te=Date.now(),Ae=it.current;if(Ze>ae&&(pe.current=Ze,console.log("[App] SYNC -  Aceitando verso remota:",Ze,"> verso local:",ae)),T.turnIdx!==f&&!(ve!=null&&ve.enabled))if(T.turnPlayerId!==void 0&&T.turnPlayerId!==null){k(T.turnPlayerId);const le=p(T.players||g).findIndex(Te=>String(Te.id)===String(T.turnPlayerId));le>=0&&(m(le),console.log("[App] SYNC (BC) - turnIdx derivado de turnPlayerId:",le,"turnPlayerId:",T.turnPlayerId))}else T.turnIdx>=0&&T.turnIdx<(((V=T.players)==null?void 0:V.length)||g.length)&&(m(T.turnIdx),console.log("[App] SYNC (BC) - Sincronizando turnIdx",{local:f,remote:T.turnIdx}));if(Array.isArray(T.roundFlags)&&T.roundFlags.length>0&&R(z=>{const le=T.roundFlags.map((Te,Qe)=>z[Qe]||!1||Te);for(;le.length<z.length;)le.push(z[le.length]||!1);return console.log("[App] SYNC - roundFlags sincronizado:",le.map((Te,Qe)=>{var fe;return`${(fe=g[Qe])==null?void 0:fe.name}:${Te}`}).join(", ")),le}),T.round!==S){const z=Ql(T.round);if(Ae&&te-Ae.timestamp<3e3){const le=Ae.round!==S;y(le?Te=>{const Qe=Math.min(Fs,Math.max(Te,z));return Qe>Te&&console.log("[App] SYNC round aplicado (clamp): local=",Te,"remote=",z,"final=",Qe),Qe}:z)}else y(le=>{const Te=Math.min(Fs,Math.max(le,z));return console.log("[App] SYNC round aplicado (clamp): local=",le,"remote=",z,"final=",Te),Te})}(T.gameOver===!0||T.winner)&&y(Fs);const at=g,Pe=T.players.map(z=>{const le=at.find(Qe=>Qe.id===z.id);if(!le)return z;if(String(z.id)===String(c)){const Qe=Number(le.clients||0),fe=Number(z.clients||0),wt=Number(le.vendedoresComuns||0),Gt=Number(z.vendedoresComuns||0),Rt=Number(le.fieldSales||0),rn=Number(z.fieldSales||0),sn=Number(le.insideSales||0),zn=Number(z.insideSales||0);return Qe>fe||wt>Gt||Rt>rn||sn>zn||le.mixProdutos&&le.mixProdutos!==z.mixProdutos&&le.mixProdutos!=="D"||le.erpLevel&&le.erpLevel!==z.erpLevel&&le.erpLevel!=="D"?(console.log("[App] SYNC - Detectadas compras locais, preservando estado local completo",{localClients:Qe,remoteClients:fe,localVendedores:wt,remoteVendedores:Gt}),{...le,pos:z.pos,bankrupt:z.bankrupt??le.bankrupt,az:le.az||z.az||0,am:le.am||z.am||0,rox:le.rox||z.rox||0,trainingsByVendor:le.trainingsByVendor||z.trainingsByVendor||{},onboarding:le.onboarding||z.onboarding||!1}):{...z,cash:Number(z.cash||0),clients:fe,mixProdutos:z.mixProdutos,erpLevel:z.erpLevel,vendedoresComuns:Gt,fieldSales:rn,insideSales:zn,gestores:Number(z.gestores??z.gestoresComerciais??z.managers??0),gestoresComerciais:Number(z.gestoresComerciais??z.gestores??z.managers??0),managers:Number(z.managers??z.gestores??z.gestoresComerciais??0),bens:Number(z.bens||0),manutencao:z.manutencao,loanPending:z.loanPending,az:le.az||z.az||0,am:le.am||z.am||0,rox:le.rox||z.rox||0,trainingsByVendor:le.trainingsByVendor||z.trainingsByVendor||{},onboarding:le.onboarding||z.onboarding||!1}}return{...z,az:le.az||z.az||0,am:le.am||z.am||0,rox:le.rox||z.rox||0,trainingsByVendor:le.trainingsByVendor||z.trainingsByVendor||{},onboarding:le.onboarding||z.onboarding||!1}});x(Pe,{source:"BC_SYNC"}),console.log("[App] SYNC aplicado - novo turnIdx:",T.turnIdx),console.log("[App] SYNC - jogador da vez:",(L=Pe[T.turnIdx])==null?void 0:L.name,"id:",(se=Pe[T.turnIdx])==null?void 0:se.id),console.log("[App] SYNC -  minha vez?",String((Ke=Pe[T.turnIdx])==null?void 0:Ke.id)===String(c)),N(z=>z||!!T.gameOver),C(z=>(E||T.gameOver)&&z&&!T.winner?z:T.winner??z),T.gameOver===!0&&console.log(`[App] [ENDGAME] estado remoto aplicado: gameOver=true winner=${((Ge=T.winner)==null?void 0:Ge.name)??T.winner??"N/A"}`)}}},We.current=U,()=>U.close()}catch(U){console.warn("[App] BroadcastChannel init failed:",U)}},[er,i,t]),j.useEffect(()=>{const _=async()=>{if(console.log(`[App] handleLeaveRoom chamado - fase: ${t}, currentLobbyId: ${n}, myUid: ${c}`),(t==="lobbies"||t==="playersLobby"||t==="game")&&n&&c)try{console.log(`[App] Saindo da sala ${n} na fase ${t}`),await Gl({roomCode:n,playerId:c})}catch($){console.warn("[App] Erro ao sair da sala:",$)}else console.log("[App] No executando leaveRoom - condies no atendidas")},O=()=>{_()},U=()=>{_()};return window.addEventListener("beforeunload",O),window.addEventListener("pagehide",U),()=>{window.removeEventListener("beforeunload",O),window.removeEventListener("pagehide",U)}},[t,n,c]);const ts=(_,O=void 0)=>{var T,M;const U=!!_,$=U?String(O??c??w??""):null;F(U),U?$&&Z($):Z(null);try{(M=(T=We.current)==null?void 0:T.postMessage)==null||M.call(T,{type:"TURNLOCK",value:U,owner:$,ts:Date.now(),source:i})}catch{}try{ve!=null&&ve.enabled&&(ve!=null&&ve.ready)&&typeof tr=="function"&&rs({playersDeltaById:{},statePatch:{kind:"LOCK",turnLock:U,lockOwner:$,lockTs:Date.now()}})}catch{}},ve=Lb(),tr=ve==null?void 0:ve.commit,Je=ve==null?void 0:ve.version,ne=ve==null?void 0:ve.state,ns=ve==null?void 0:ve.stateId,As=j.useMemo(()=>{const _=String(c||i||"");return!_||!w?!1:String(w)===_},[w,c,i]);j.useEffect(()=>{var _,O;if(g!=null&&g.length){if(w){const U=g.findIndex($=>String($.id)===String(w));U>=0&&U!==f&&m(U)}else if(!(ve!=null&&ve.enabled)){const U=((_=g[f])==null?void 0:_.id)||((O=g[0])==null?void 0:O.id);U&&k(String(U))}}},[g,w,f]),ue.useRef(null);const it=ue.useRef(null),xt=ue.useRef(0),pe=ue.useRef(0),Dt=ue.useRef(0),nr=ue.useRef(null),Wt=ue.useRef(null),rs=ue.useCallback(({playersDeltaById:_={},statePatch:O={}})=>{if(typeof tr!="function")return;xt.current=xt.current+1;const U=xt.current,$=Date.now();try{tr(T=>{var Ae;const M=T||{},V=U,L=M.stateVersion??0,se=Math.max(V,L)+1,Ke=Array.isArray(M.players)&&M.players.length>0?M.players:Array.isArray((Ae=it.current)==null?void 0:Ae.players)&&it.current.players.length>0?it.current.players:Array.isArray(Wt.current)&&Wt.current.length>0?Wt.current:[],Ge=p(Ke),Ze=new Map(Ge.map(at=>[String(at.id),at]));for(const[at,Pe]of Object.entries(_)){const z=String(at),le=Ze.get(z);if(le){const Te=(Pe==null?void 0:Pe._actionId)||(O==null?void 0:O.actionId)||null;if(Te){const Qe=le.lastActions&&typeof le.lastActions=="object"?le.lastActions:{};if(Qe[Te]){console.warn("[IDEMPOTENCY] ignorando delta j aplicado",{playerId:z,actionId:Te});continue}const fe={...Qe,[Te]:$},wt=Object.keys(fe);wt.length>50&&wt.sort((sn,zn)=>Number(fe[sn]||0)-Number(fe[zn]||0)).slice(0,wt.length-50).forEach(sn=>{try{delete fe[sn]}catch{}});const{_actionId:Gt,...Rt}=Pe||{},rn={...le};for(const[sn,zn]of Object.entries(Rt))zn!==void 0&&(rn[sn]=zn);Ze.set(z,h({...rn,lastActions:fe}))}else{const{_actionId:Qe,...fe}=Pe||{},wt={...le};for(const[Gt,Rt]of Object.entries(fe))Rt!==void 0&&(wt[Gt]=Rt);Ze.set(z,h(wt))}}else{const{_actionId:Te,...Qe}=Pe||{};Ze.set(z,h({id:z,...Qe}))}}const bt=p(Array.from(Ze.values())),ae={...O,stateVersion:se,updatedAt:$,updatedBy:c};Object.keys(_).length>0&&(ae.players=bt);const te={...M,...ae};try{delete te.turnIdx}catch{}return te.players&&(te.players=p(te.players)),console.log("[NET]  commitGamePatch - tipo:",O.turnPlayerId?"TURN":O.round?"ROUND":"PLAYER_DELTA","playersDeltaIds:",Object.keys(_).join(","),"statePatchKeys:",Object.keys(O).join(","),"stateVersion:",se,"(local:",V,"remote:",L,")"),te})}catch(T){console.warn("[NET] commitGamePatch failed:",(T==null?void 0:T.message)||T)}},[tr,c]);ue.useEffect(()=>{const _=it.current,O=!_||_.turnIdx!==f,U=!_||_.round!==S,$=!_||JSON.stringify(_.players)!==JSON.stringify(g);if(O||U||$){const T=Date.now();(_?T-_.timestamp:1/0)>100?(it.current={..._||{},players:g,turnIdx:f,round:S,timestamp:T,stateVersion:(_==null?void 0:_.stateVersion)??xt.current??0},O&&console.log("[App] lastLocalStateRef atualizado via useEffect - turnIdx mudou:",_==null?void 0:_.turnIdx,"->",f)):it.current={...it.current,players:g,turnIdx:f,round:S}}},[g,f,S]),j.useEffect(()=>{var $,T;if(!(ve!=null&&ve.enabled)||!(ve!=null&&ve.ready)||!ne)return;if(typeof Je=="number"){const M=xt.current??(($=it.current)==null?void 0:$.stateVersion)??0,V=(ne==null?void 0:ne.stateVersion)??0,L=(ne==null?void 0:ne.stateId)??(ne==null?void 0:ne.actionId)??ns??null,se=L==null?"(missing)":String(L),Ke=nr.current,Ge=Ke==null?"(missing)":String(Ke),Ze=se===Ge,bt=se!=="(missing)"&&Ge!=="(missing)";if(Je<Dt.current){console.log("[NET]  IGNORADO - netVersion regressivo:",{netVersion:Je,lastApplied:Dt.current});return}if(Je===Dt.current){if(se!=="(missing)"&&se!==Ge)console.warn("[NET] same version but different stateId -> applying",{netVersion:Je,incomingStateId:se,lastStateId:Ge});else if(Ze&&bt){console.log("[NET]  IGNORADO - same version and same stateId:",{netVersion:Je,stateId:se});return}}if(V>0&&M>0&&V<M){console.warn("[NET]  IGNORANDO rollback de stateVersion:",{remoteStateVersion:V,localStateVersion:M,netVersion:Je}),Dt.current=Je;return}Dt.current=Je,nr.current=se==="(missing)"?null:se}else return;const _=Array.isArray(ne.players)?ne.players:null,O=Number.isInteger(ne.round)?ne.round:null,U=ne.turnPlayerId!==void 0&&ne.turnPlayerId!==null&&String(ne.turnPlayerId)!==""?String(ne.turnPlayerId):null;if(U&&String(w||"")!==U&&k(U),_){const M=p(_);if(x(M,{source:"SNAPSHOT"}),Wt.current=JSON.parse(JSON.stringify(M)),console.log("[NET]  Aplicado players (snapshot autoritativo) - netVersion:",Je,"playersOrdered:",M.map(V=>({id:V.id,seat:V.seat}))),U){const V=M.findIndex(L=>String(L.id)===String(U));V>=0&&V!==f&&(console.log("[NET]  derived turnIdx from turnPlayerId:",V,"turnPlayerId:",U),m(V))}}if(O!==null){const M=O===1&&Array.isArray(_)&&_.length>0&&_.every(L=>Number((L==null?void 0:L.pos)??0)===0)&&(ne.gameOver===!1||ne.gameOver==null),V=Ql(O);y(L=>M?1:Math.min(Fs,Math.max(L,V)))}if((ne.gameOver===!0||ne.winner)&&y(Fs),ne.roundFlags!==void 0){if(Array.isArray(ne.roundFlags))R(ne.roundFlags),console.log("[NET] applied remote includes roundFlags?",!0,"length:",ne.roundFlags.length);else if(typeof ne.roundFlags=="object"){const M=Object.values(ne.roundFlags);R(M),console.log("[NET] applied remote includes roundFlags?",!0,"converted from object, length:",M.length)}}typeof ne.turnLock<"u"&&F(!!ne.turnLock),typeof ne.lockOwner<"u"&&Z(ne.lockOwner?String(ne.lockOwner):null),ne.turnLock===!0&&!ne.lockOwner&&U&&Z(U),It.current=Date.now(),N(M=>M||!!ne.gameOver),C(M=>(!!ne.gameOver||!!ne.winner)&&M&&!ne.winner?M:ne.winner??M),ne.gameOver===!0&&console.log(`[App] [ENDGAME] estado remoto aplicado: gameOver=true winner=${((T=ne.winner)==null?void 0:T.name)??ne.winner??"N/A"}`),console.log("[NET]  applied remote snapshot - netVersion:",Je,"turnPlayerId:",ne.turnPlayerId,"round:",O);try{const M=Array.isArray(ne.players)&&ne.players.length>0,V=ne.turnPlayerId!==void 0&&ne.turnPlayerId!==null&&String(ne.turnPlayerId)!=="";M&&V&&(he.current=!0)}catch{}},[Je,ne,ve==null?void 0:ve.enabled,ve==null?void 0:ve.ready]),j.useEffect(()=>{if(!je){ht.current=null;return}ht.current||(ht.current=Date.now());const _=setInterval(()=>{const O=Date.now(),U=ht.current?O-ht.current:0,$=g[f],T=$&&String($.id)===String(c),M=As&&T,V=oe===c;U>8e3&&M&&!V&&oe!=null&&(console.warn("[LOCK-WATCHDOG] stole lock - turnLock travado por",U,"ms, liberando...",{isMyTurn:M,lockOwner:oe,myUid:c}),ss({turnLock:!1,lockOwner:c}),ts(!1),Z(c),ht.current=null)},1e3);return()=>clearInterval(_)},[je,As,f,g,oe,c,tr]);async function ss(_){if(typeof tr=="function")try{await tr(O=>{const U=O||{},$=_||{};if($.players&&Array.isArray($.players)){const se=Wt.current||U.players||[],Ke=U.players||[],Ge=$.players,Ze=new Map(se.map(fe=>[String(fe==null?void 0:fe.id),fe])),bt=new Map(Ke.map(fe=>[String(fe==null?void 0:fe.id),fe])),ae=new Map(Ge.map(fe=>[String(fe==null?void 0:fe.id),fe])),te=[],Ae=new Set([...Ze.keys(),...bt.keys(),...ae.keys()]);for(const fe of Ae){const wt=Ze.get(fe),Gt=bt.get(fe),Rt=ae.get(fe);wt&&Rt&&JSON.stringify(wt)!==JSON.stringify(Rt)&&Rt?te.push(h(Rt)):Gt?te.push(h(Gt)):Rt&&te.push(h(Rt))}const at=[],Pe=Ge.map(fe=>String(fe==null?void 0:fe.id));for(const fe of Pe){const wt=te.find(Gt=>String(Gt==null?void 0:Gt.id)===fe);wt&&at.push(wt)}for(const fe of te)Pe.includes(String(fe==null?void 0:fe.id))||at.push(fe);Wt.current=null;const z=$.stateVersion??0,le=U.stateVersion??0,Te=Math.max(z,le)+1,Qe={...U,...$,players:at.length>0?at:Ge,stateVersion:Te};try{delete Qe.turnIdx}catch{}return Qe}const T=$.stateVersion??0,M=U.stateVersion??0,V=Math.max(T,M)+1,L={...U,...$,stateVersion:V};try{delete L.turnIdx}catch{}return L})}catch(O){console.warn("[NET] commit failed:",(O==null?void 0:O.message)||O),Wt.current=null}}function st(_,O,U,$=E,T=v,M={}){var os,sr,is,Wn,mn,Mt;Wt.current||(Wt.current=JSON.parse(JSON.stringify(g)),console.log("[App] broadcastState - baseline capturado (estado atual antes da mudana):",Wt.current.length,"players")),xt.current=xt.current+1;const V=xt.current,L=M.roundFlags!==void 0?M.roundFlags:D,se=M.turnLock!==void 0?M.turnLock:je,Ke=((os=it.current)==null?void 0:os.lockOwner)??null,Ge=M.lockOwner!==void 0?M.lockOwner:Ke,Ze=M.gameOver!==void 0?M.gameOver:$,ae=!!E||!!((sr=it.current)!=null&&sr.gameOver)?!0:!!Ze,te=M.winner!==void 0?M.winner:T,Ae=v??((is=it.current)==null?void 0:is.winner)??null,at=ae?te??Ae:te,Pe=M.round!==void 0?M.round:U,z=Ql(Math.max(Number(Pe||1),Number(S||1),Number(((Wn=it.current)==null?void 0:Wn.round)||1)));Wt.current||(Wt.current=JSON.parse(JSON.stringify(g)),console.log("[App] broadcastState - baseline capturado (fallback):",Wt.current.length,"players"));const le=p(_),Te=M.turnPlayerId!==void 0&&M.turnPlayerId!==null?String(M.turnPlayerId):String(w||"");if(Te!=null){const lt=String(Te);String(w||"")!==lt&&k(lt)}const Qe=!Te||Te===w?w:(M.turnPlayerId!==void 0||z!==S,Te),fe=M.kind||(M.turnPlayerId!==void 0?"TURN":"PLAYER_DELTA"),wt=()=>{try{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID()}catch{}return`${String(c||"anon")}-${Date.now()}-${Math.random().toString(16).slice(2)}`},Gt=String(M.stateId||wt()),Rt=String(M.actionId||`${String(c||"anon")}-${Date.now()}-${V}`),rn=Date.now(),sn=Te?le.findIndex(lt=>String(lt.id)===String(Te)):O;if(it.current={players:le,turnIdx:sn,turnPlayerId:Qe,round:z,gameOver:ae,winner:at,lockOwner:Ge,timestamp:rn,version:V,stateVersion:V,updatedAt:rn,updatedBy:c},pe.current=V,M.isStartGame===!0||z===1&&O===0&&le.every(lt=>Number((lt==null?void 0:lt.pos)??0)===0))console.log("[App] broadcastState (START) - verso:",V,"turnPlayerId:",Qe,"round:",z),ss({players:le,turnPlayerId:Qe,round:z,roundFlags:L,stateId:Gt,actionId:Rt,kind:"START",stateVersion:V,updatedAt:rn,updatedBy:c});else{const lt={},A=new Map(g.map(ge=>[String(ge.id),ge]));for(const ge of le){const me=String(ge.id),Q=A.get(me);if(!Q)lt[me]={...ge,_actionId:Rt};else{const Y={},ye=["pos","cash","bankrupt","clients","vendedoresComuns","fieldSales","insideSales","gestores","gestoresComerciais","manutencao","bens","mixProdutos","erpLevel","az","am","rox","onboarding","trainingByVendor","trainingsByVendor","loanPending","waitingAtRevenue","revenue","erpOwned","erp","mixOwned","mix","lastRevenueRound","directBuys","directBuysPush","trainings","mixBase"];for(const ze of ye)JSON.stringify(Q[ze])!==JSON.stringify(ge[ze])&&(Y[ze]=ge[ze]);Object.keys(Y).length>0&&(lt[me]={...Y,_actionId:Rt})}}const J=Object.keys(lt).length>0,ee=fe==="TURN"||fe==="LOCK"||M.round!==void 0||M.roundFlags!==void 0||M.gameOver!==void 0||M.winner!==void 0;if(!J&&!ee){console.log("[App] broadcastState skipped (no-op)",{actionId:Rt,patchKind:fe});return}const q={kind:fe,actionId:Rt,stateId:Gt,...ae?{gameOver:!0,winner:at}:{},...fe==="TURN"?{turnPlayerId:Te,round:z,roundFlags:L,gameOver:ae,winner:at}:{},...fe==="LOCK"?{turnLock:se,lockOwner:Ge,lockTs:Date.now()}:{}};rs({playersDeltaById:lt,statePatch:q}),console.log("[App] broadcastState (PATCH) - kind:",fe,"playersDeltaIds:",Object.keys(lt).join(","),"turnPlayerId:",Qe,"round:",z)}try{(Mt=(mn=We.current)==null?void 0:mn.postMessage)==null||Mt.call(mn,{type:"SYNC",version:V,players:le,round:z,roundFlags:L,turnLock:se,lockOwner:Ge,gameOver:ae,winner:at,source:i,timestamp:rn})}catch(lt){console.warn("[App] broadcastState failed:",lt)}}function Os(_){var T,M,V;let O=p(_);const U=O.findIndex(L=>String(L==null?void 0:L.id)===String(c));U>0&&(O=[O[U],...O.slice(0,U),...O.slice(U+1)]);const $=(T=O[0])!=null&&T.id?String(O[0].id):null;st(O,0,1,!1,null,{turnPlayerId:$,roundFlags:Array(O.length).fill(!1),isStartGame:!0});try{(V=(M=We.current)==null?void 0:M.postMessage)==null||V.call(M,{type:"START",players:O,source:i})}catch(L){console.warn("[App] broadcastStart failed:",L)}}const At=g[f];j.useEffect(()=>{t==="game"&&gb(g,f,S,E,v,"Game State Update")},[g,f,S,E,v,t]),j.useEffect(()=>{const _=g.find(He);if(!_)return;const{cap:O,inAtt:U}=Ma(_);I($=>({...$,cash:_.cash,possibAt:O,clientsAt:U,name:_.name,color:_.color}))},[g,He]);const Ei=j.useMemo(()=>{const _=g.find(He)||g[0]||{},O=al(_),U=ll(_),{cap:$,inAtt:T}=Ma(_),M=String(_.erpLevel||"D").toUpperCase(),V=Number(_.gestores??_.gestoresComerciais??_.managers??0);return console.log("[App] Totals recalculado - me:",_.name,"clients:",_.clients,"faturamento:",O,"manutencao:",U,"vendedoresComuns:",_.vendedoresComuns,"fieldSales:",_.fieldSales,"insideSales:",_.insideSales),yb(_,"HUD Totals"),{faturamento:O,manutencao:U,emprestimos:_.loanPending&&!_.loanPending.charged?Number(_.loanPending.amount||0):0,vendedoresComuns:_.vendedoresComuns||0,fieldSales:_.fieldSales||0,insideSales:_.insideSales||0,mixProdutos:_.mixProdutos||"D",bens:_.bens??0,erpSistemas:M,clientes:_.clients||0,onboarding:!!_.onboarding,az:_.az||0,am:_.am||0,rox:_.rox||0,gestores:V,gestoresComerciais:V,possibAt:$,clientsAt:T}},[g,He]),[wo,ul]=j.useState(!1),{onAction:$t,modalLocks:K}=Pb({players:g,setPlayers:x,round:S,setRound:y,turnIdx:f,setTurnIdx:m,turnPlayerId:w,setTurnPlayerId:k,roundFlags:D,setRoundFlags:R,isMyTurn:As,isMine:He,myUid:c,meId:i,myCash:pt,current:At,broadcastState:st,appendLog:ke,turnLock:je,setTurnLockBroadcast:ts,gameOver:E,setGameOver:N,winner:v,setWinner:C,setShowBankruptOverlay:ul}),xe=g[f],Ee=(xe==null?void 0:xe.bankrupt)===!0,W=S===5&&((rr=g[f])==null?void 0:rr.waitingAtRevenue),Ye=w!=null&&c!=null&&String(w)===String(c),re=je?oe!=null&&String(oe)===String(c):!0,Ne=!!w&&g.length>0&&Ye&&je===!1&&re&&Number(K||0)===0&&E!==!0&&Ee!==!0&&W!==!0;return j.useEffect(()=>{console.log("[CAN_ROLL_CHECK]",{phase:t,myUid:c,turnPlayerId:w,isMyTurn:Ye,turnLock:je,modalLocks:K,gameOver:E,bankrupt:Ee,result:Ne})},[t,c,w,Ye,je,K,E,Ee,Ne]),t==="start"?a.jsx($o,{children:a.jsx($x,{currentName:l,onEnter:_=>{var U;const O=String(_||"").trim();O&&(Am(O),u(O),x([h({id:i,name:O,cash:18e3,pos:0,color:"#ffd54f",bens:4e3})],{source:"START"}),y(1),m(0),N(!1),C(null),R(new Array(1).fill(!1)),I($=>({...$,name:O})),X([`Bem-vindo, ${O}!`]),s?(r(s),(U=window.__setRoomCode)==null||U.call(window,s),e("playersLobby")):e("lobbies"))}})}):t==="lobbies"?a.jsx($o,{children:a.jsx(Kx,{playerName:l,onEnterRoom:_=>{var O;r(_),(O=window.__setRoomCode)==null||O.call(window,_);try{localStorage.setItem("sg:lastRoomName",String(_));const U=new URL(window.location.href);U.searchParams.set("room",String(_)),history.replaceState(null,"",U.toString())}catch{}e("playersLobby")}})}):t==="playersLobby"?a.jsx($o,{children:a.jsx(Jx,{lobbyId:n||s,playerName:l,onBack:()=>{var _;(_=window.__setRoomCode)==null||_.call(window,null),e("lobbies")},onStartGame:_=>{var V;const O=(_==null?void 0:_.lobbyName)||((V=_==null?void 0:_.lobby)==null?void 0:V.name)||(_==null?void 0:_.name)||n||"sala-demo";try{localStorage.setItem("sg:lastRoomName",String(O));const L=new URL(window.location.href);L.searchParams.set("room",String(O)),history.replaceState(null,"",L.toString())}catch{}const T=[...Array.isArray(_)?_:(_==null?void 0:_.players)??(_==null?void 0:_.lobbyPlayers)??[]].sort((L,se)=>{const Ke=L.created_at||L.joined_at||L.createdAt||L.joinedAt,Ge=se.created_at||se.joined_at||se.createdAt||se.joinedAt;if(Ke&&Ge)return new Date(Ke)-new Date(Ge);const Ze=String(L.id??L.player_id??""),bt=String(se.id??se.player_id??"");return Ze.localeCompare(bt)}).map((L,se)=>h({id:String(L.id??L.player_id),name:L.name??L.player_name,cash:18e3,pos:0,bens:4e3,color:["#ffd54f","#90caf9","#a5d6a7","#ffab91"][se%4],seat:se}));if(T.length===0)return;const M=p(T);try{M.find(se=>String(se.id)===String(i))&&d(String(i))}catch{}x(M,{source:"START_GAME"}),m(0),y(1),R(new Array(M.length).fill(!1)),N(!1),C(null),I(L=>{var Ke,Ge;const se=M.find(He);return{...L,name:(se==null?void 0:se.name)||((Ke=M[0])==null?void 0:Ke.name)||"Jogador",color:(se==null?void 0:se.color)||((Ge=M[0])==null?void 0:Ge.color)||"#6c5ce7",cash:(se==null?void 0:se.cash)??18e3,possibAt:0,clientsAt:0}}),X(["Jogo iniciado!"]),Os(M),e("game")}})}):a.jsx($o,{children:a.jsxs("div",{className:"page",children:[a.jsxs("header",{className:"topbar",children:[a.jsxs("div",{className:"status",style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[a.jsx("span",{style:{width:18,height:18,borderRadius:"50%",border:"2px solid rgba(255,255,255,.9)",boxShadow:"0 0 0 2px rgba(0,0,0,.25)",background:P.color}}),a.jsxs("span",{style:{background:"#1f2430",border:"1px solid rgba(255,255,255,.12)",borderRadius:10,padding:"4px 10px",fontWeight:800},children:[" ",P.name]}),a.jsxs("span",{children:["Possib. Atendimento: ",a.jsx("b",{children:P.possibAt??0})]}),a.jsxs("span",{children:["Clientes em Atendimento: ",a.jsx("b",{children:P.clientsAt??0})]}),a.jsx(_b,{players:g,turnIdx:f,round:S,gameOver:E,winner:v})]}),a.jsxs("div",{className:"status",style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[a.jsxs("span",{children:["Rodada: ",S]}),a.jsxs("span",{className:"money",children:[" $ ",Number(pt).toLocaleString()]})]})]}),a.jsxs("main",{className:"content",children:[a.jsx("div",{className:"boardWrap",children:a.jsx(rb,{players:g,turnIdx:f,onMeHud:I})}),a.jsxs("aside",{className:"side",children:[a.jsx(sb,{totals:Ei,players:g}),a.jsxs("div",{className:"controlsSticky",children:[a.jsx(ob,{onAction:_=>{$t(_)},current:At,isMyTurn:As,myUid:c,turnPlayerId:w,turnLock:je,lockOwner:oe,modalLocks:K,gameOver:E}),a.jsx("div",{style:{marginTop:10},children:a.jsx("button",{className:"btn dark",onClick:async()=>{var _;if(n&&c)try{await Gl({roomCode:n,playerId:c})}catch(O){console.warn("[App] Erro ao sair da sala:",O)}(_=window.__setRoomCode)==null||_.call(window,null),e("lobbies")},children:"Sair para Lobbies"})})]}),E&&a.jsx(ib,{players:g,onExit:async()=>{var _;if(n&&c)try{await Gl({roomCode:n,playerId:c})}catch(O){console.warn("[App] Erro ao sair da sala:",O)}(_=window.__setRoomCode)==null||_.call(window,null),e("lobbies")},onRestart:()=>{const _=g.map(O=>h({...O,cash:18e3,bens:4e3,pos:0}));x(_,{source:"RESTART"}),m(0),y(1),R(new Array(_.length).fill(!1)),X(["Novo jogo iniciado!"]),N(!1),C(null)}})]})]}),a.jsx("footer",{className:"foot",children:a.jsxs("small",{children:["Desenvolvido por ",a.jsx("a",{href:"https://www.tironitech.com",target:"_blank",rel:"noreferrer",children:"tironitech.com"})]})}),wo&&a.jsx(ab,{})]})})}function Mb(){const e=new URLSearchParams(window.location.search).get("room");return e&&String(e).trim()||null}function Bb(){const[t,e]=ue.useState(Mb());return ue.useEffect(()=>(window.__setRoomCode=n=>{const r=String(n||"").trim()||null;e(r);const s=new URL(window.location.href);r?s.searchParams.set("room",r):s.searchParams.delete("room"),window.history.replaceState({},"",s)},()=>{delete window.__setRoomCode}),[]),ue.useEffect(()=>(window.exportLogs=()=>{const n=Im(),r=new Blob([n.text],{type:"text/plain;charset=utf-8"}),s=URL.createObjectURL(r),o=document.createElement("a");return o.href=s,o.download=`debug-logs-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.txt`,o.click(),URL.revokeObjectURL(s),console.log(" Logs exportados! Arquivo .txt baixado."),n},window.getLogsText=()=>hb(),window.getLogsJSON=()=>pb(),window.getLogStats=()=>oc(),window.toggleLogCapture=()=>(fr.enabled?(fr.disable(),console.log(" Captura de logs DESATIVADA")):(fr.enable(),console.log(" Captura de logs ATIVADA")),fr.enabled),console.log("%c FUNES DE EXPORT DE LOGS DISPONVEIS:","color: #4CAF50; font-weight: bold; font-size: 14px"),console.log("%cexportLogs()","color: #2196F3; font-weight: bold","- Exporta logs completos (baixa arquivo .txt)"),console.log("%cgetLogsText()","color: #2196F3; font-weight: bold","- Retorna logs como string de texto"),console.log("%cgetLogsJSON()","color: #2196F3; font-weight: bold","- Retorna logs como objeto JSON"),console.log("%cgetLogStats()","color: #2196F3; font-weight: bold","- Retorna estatsticas dos logs"),console.log("%ctoggleLogCapture()","color: #2196F3; font-weight: bold","- Ativa/desativa captura de logs"),()=>{delete window.exportLogs,delete window.getLogsText,delete window.getLogsJSON,delete window.getLogStats,delete window.toggleLogCapture}),[]),a.jsx($o,{children:a.jsx(Ib,{roomCode:t,children:a.jsx($b,{})})})}Xl.createRoot(document.getElementById("root")).render(a.jsx(ue.StrictMode,{children:a.jsx(Bb,{})}));
//# sourceMappingURL=index-PdB18_kT.js.map
