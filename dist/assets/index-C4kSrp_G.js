(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();var Fn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Im(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function $m(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var o=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,o.get?o:{enumerable:!0,get:function(){return t[r]}})}),n}var Hf={exports:{}},Ia={},Kf={exports:{}},Ie={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hi=Symbol.for("react.element"),Mm=Symbol.for("react.portal"),Bm=Symbol.for("react.fragment"),Um=Symbol.for("react.strict_mode"),Fm=Symbol.for("react.profiler"),zm=Symbol.for("react.provider"),Wm=Symbol.for("react.context"),Vm=Symbol.for("react.forward_ref"),Gm=Symbol.for("react.suspense"),qm=Symbol.for("react.memo"),Hm=Symbol.for("react.lazy"),nd=Symbol.iterator;function Km(t){return t===null||typeof t!="object"?null:(t=nd&&t[nd]||t["@@iterator"],typeof t=="function"?t:null)}var Jf={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Yf=Object.assign,Qf={};function ps(t,e,n){this.props=t,this.context=e,this.refs=Qf,this.updater=n||Jf}ps.prototype.isReactComponent={};ps.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};ps.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Xf(){}Xf.prototype=ps.prototype;function rc(t,e,n){this.props=t,this.context=e,this.refs=Qf,this.updater=n||Jf}var oc=rc.prototype=new Xf;oc.constructor=rc;Yf(oc,ps.prototype);oc.isPureReactComponent=!0;var rd=Array.isArray,Zf=Object.prototype.hasOwnProperty,sc={current:null},eh={key:!0,ref:!0,__self:!0,__source:!0};function th(t,e,n){var r,o={},s=null,i=null;if(e!=null)for(r in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(s=""+e.key),e)Zf.call(e,r)&&!eh.hasOwnProperty(r)&&(o[r]=e[r]);var l=arguments.length-2;if(l===1)o.children=n;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];o.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)o[r]===void 0&&(o[r]=l[r]);return{$$typeof:hi,type:t,key:s,ref:i,props:o,_owner:sc.current}}function Jm(t,e){return{$$typeof:hi,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ic(t){return typeof t=="object"&&t!==null&&t.$$typeof===hi}function Ym(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var od=/\/+/g;function ll(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Ym(""+t.key):e.toString(36)}function Yi(t,e,n,r,o){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case hi:case Mm:i=!0}}if(i)return i=t,o=o(i),t=r===""?"."+ll(i,0):r,rd(o)?(n="",t!=null&&(n=t.replace(od,"$&/")+"/"),Yi(o,e,n,"",function(c){return c})):o!=null&&(ic(o)&&(o=Jm(o,n+(!o.key||i&&i.key===o.key?"":(""+o.key).replace(od,"$&/")+"/")+t)),e.push(o)),1;if(i=0,r=r===""?".":r+":",rd(t))for(var l=0;l<t.length;l++){s=t[l];var u=r+ll(s,l);i+=Yi(s,e,n,u,o)}else if(u=Km(t),typeof u=="function")for(t=u.call(t),l=0;!(s=t.next()).done;)s=s.value,u=r+ll(s,l++),i+=Yi(s,e,n,u,o);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function ki(t,e,n){if(t==null)return t;var r=[],o=0;return Yi(t,r,"","",function(s){return e.call(n,s,o++)}),r}function Qm(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var cn={current:null},Qi={transition:null},Xm={ReactCurrentDispatcher:cn,ReactCurrentBatchConfig:Qi,ReactCurrentOwner:sc};function nh(){throw Error("act(...) is not supported in production builds of React.")}Ie.Children={map:ki,forEach:function(t,e,n){ki(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return ki(t,function(){e++}),e},toArray:function(t){return ki(t,function(e){return e})||[]},only:function(t){if(!ic(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ie.Component=ps;Ie.Fragment=Bm;Ie.Profiler=Fm;Ie.PureComponent=rc;Ie.StrictMode=Um;Ie.Suspense=Gm;Ie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Xm;Ie.act=nh;Ie.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Yf({},t.props),o=t.key,s=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,i=sc.current),e.key!==void 0&&(o=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)Zf.call(e,u)&&!eh.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];r.children=l}return{$$typeof:hi,type:t.type,key:o,ref:s,props:r,_owner:i}};Ie.createContext=function(t){return t={$$typeof:Wm,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:zm,_context:t},t.Consumer=t};Ie.createElement=th;Ie.createFactory=function(t){var e=th.bind(null,t);return e.type=t,e};Ie.createRef=function(){return{current:null}};Ie.forwardRef=function(t){return{$$typeof:Vm,render:t}};Ie.isValidElement=ic;Ie.lazy=function(t){return{$$typeof:Hm,_payload:{_status:-1,_result:t},_init:Qm}};Ie.memo=function(t,e){return{$$typeof:qm,type:t,compare:e===void 0?null:e}};Ie.startTransition=function(t){var e=Qi.transition;Qi.transition={};try{t()}finally{Qi.transition=e}};Ie.unstable_act=nh;Ie.useCallback=function(t,e){return cn.current.useCallback(t,e)};Ie.useContext=function(t){return cn.current.useContext(t)};Ie.useDebugValue=function(){};Ie.useDeferredValue=function(t){return cn.current.useDeferredValue(t)};Ie.useEffect=function(t,e){return cn.current.useEffect(t,e)};Ie.useId=function(){return cn.current.useId()};Ie.useImperativeHandle=function(t,e,n){return cn.current.useImperativeHandle(t,e,n)};Ie.useInsertionEffect=function(t,e){return cn.current.useInsertionEffect(t,e)};Ie.useLayoutEffect=function(t,e){return cn.current.useLayoutEffect(t,e)};Ie.useMemo=function(t,e){return cn.current.useMemo(t,e)};Ie.useReducer=function(t,e,n){return cn.current.useReducer(t,e,n)};Ie.useRef=function(t){return cn.current.useRef(t)};Ie.useState=function(t){return cn.current.useState(t)};Ie.useSyncExternalStore=function(t,e,n){return cn.current.useSyncExternalStore(t,e,n)};Ie.useTransition=function(){return cn.current.useTransition()};Ie.version="18.3.1";Kf.exports=Ie;var E=Kf.exports;const ue=Im(E);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zm=E,eg=Symbol.for("react.element"),tg=Symbol.for("react.fragment"),ng=Object.prototype.hasOwnProperty,rg=Zm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,og={key:!0,ref:!0,__self:!0,__source:!0};function rh(t,e,n){var r,o={},s=null,i=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(i=e.ref);for(r in e)ng.call(e,r)&&!og.hasOwnProperty(r)&&(o[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)o[r]===void 0&&(o[r]=e[r]);return{$$typeof:eg,type:t,key:s,ref:i,props:o,_owner:rg.current}}Ia.Fragment=tg;Ia.jsx=rh;Ia.jsxs=rh;Hf.exports=Ia;var a=Hf.exports,Jl={},oh={exports:{}},Tn={},sh={exports:{}},ih={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Z,F){var ge=Z.length;Z.push(F);e:for(;0<ge;){var Re=ge-1>>>1,pe=Z[Re];if(0<o(pe,F))Z[Re]=F,Z[ge]=pe,ge=Re;else break e}}function n(Z){return Z.length===0?null:Z[0]}function r(Z){if(Z.length===0)return null;var F=Z[0],ge=Z.pop();if(ge!==F){Z[0]=ge;e:for(var Re=0,pe=Z.length,at=pe>>>1;Re<at;){var Pt=2*(Re+1)-1,_n=Z[Pt],se=Pt+1,en=Z[se];if(0>o(_n,ge))se<pe&&0>o(en,_n)?(Z[Re]=en,Z[se]=ge,Re=se):(Z[Re]=_n,Z[Pt]=ge,Re=Pt);else if(se<pe&&0>o(en,ge))Z[Re]=en,Z[se]=ge,Re=se;else break e}}return F}function o(Z,F){var ge=Z.sortIndex-F.sortIndex;return ge!==0?ge:Z.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var i=Date,l=i.now();t.unstable_now=function(){return i.now()-l}}var u=[],c=[],d=1,p=null,h=3,y=!1,b=!1,v=!1,S=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,f=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function m(Z){for(var F=n(c);F!==null;){if(F.callback===null)r(c);else if(F.startTime<=Z)r(c),F.sortIndex=F.expirationTime,e(u,F);else break;F=n(c)}}function w(Z){if(v=!1,m(Z),!b)if(n(u)!==null)b=!0,Ue(_);else{var F=n(c);F!==null&&wt(w,F.startTime-Z)}}function _(Z,F){b=!1,v&&(v=!1,g(k),k=-1),y=!0;var ge=h;try{for(m(F),p=n(u);p!==null&&(!(p.expirationTime>F)||Z&&!j());){var Re=p.callback;if(typeof Re=="function"){p.callback=null,h=p.priorityLevel;var pe=Re(p.expirationTime<=F);F=t.unstable_now(),typeof pe=="function"?p.callback=pe:p===n(u)&&r(u),m(F)}else r(u);p=n(u)}if(p!==null)var at=!0;else{var Pt=n(c);Pt!==null&&wt(w,Pt.startTime-F),at=!1}return at}finally{p=null,h=ge,y=!1}}var R=!1,D=null,k=-1,N=5,x=-1;function j(){return!(t.unstable_now()-x<N)}function L(){if(D!==null){var Z=t.unstable_now();x=Z;var F=!0;try{F=D(!0,Z)}finally{F?U():(R=!1,D=null)}}else R=!1}var U;if(typeof f=="function")U=function(){f(L)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,q=B.port2;B.port1.onmessage=L,U=function(){q.postMessage(null)}}else U=function(){S(L,0)};function Ue(Z){D=Z,R||(R=!0,U())}function wt(Z,F){k=S(function(){Z(t.unstable_now())},F)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Z){Z.callback=null},t.unstable_continueExecution=function(){b||y||(b=!0,Ue(_))},t.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<Z?Math.floor(1e3/Z):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(Z){switch(h){case 1:case 2:case 3:var F=3;break;default:F=h}var ge=h;h=F;try{return Z()}finally{h=ge}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Z,F){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var ge=h;h=Z;try{return F()}finally{h=ge}},t.unstable_scheduleCallback=function(Z,F,ge){var Re=t.unstable_now();switch(typeof ge=="object"&&ge!==null?(ge=ge.delay,ge=typeof ge=="number"&&0<ge?Re+ge:Re):ge=Re,Z){case 1:var pe=-1;break;case 2:pe=250;break;case 5:pe=1073741823;break;case 4:pe=1e4;break;default:pe=5e3}return pe=ge+pe,Z={id:d++,callback:F,priorityLevel:Z,startTime:ge,expirationTime:pe,sortIndex:-1},ge>Re?(Z.sortIndex=ge,e(c,Z),n(u)===null&&Z===n(c)&&(v?(g(k),k=-1):v=!0,wt(w,ge-Re))):(Z.sortIndex=pe,e(u,Z),b||y||(b=!0,Ue(_))),Z},t.unstable_shouldYield=j,t.unstable_wrapCallback=function(Z){var F=h;return function(){var ge=h;h=F;try{return Z.apply(this,arguments)}finally{h=ge}}}})(ih);sh.exports=ih;var sg=sh.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ig=E,On=sg;function G(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ah=new Set,Js={};function Eo(t,e){ss(t,e),ss(t+"Capture",e)}function ss(t,e){for(Js[t]=e,t=0;t<e.length;t++)ah.add(e[t])}var br=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Yl=Object.prototype.hasOwnProperty,ag=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,sd={},id={};function lg(t){return Yl.call(id,t)?!0:Yl.call(sd,t)?!1:ag.test(t)?id[t]=!0:(sd[t]=!0,!1)}function ug(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function cg(t,e,n,r){if(e===null||typeof e>"u"||ug(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function dn(t,e,n,r,o,s,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=i}var Jt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Jt[t]=new dn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Jt[e]=new dn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Jt[t]=new dn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Jt[t]=new dn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Jt[t]=new dn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Jt[t]=new dn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Jt[t]=new dn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Jt[t]=new dn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Jt[t]=new dn(t,5,!1,t.toLowerCase(),null,!1,!1)});var ac=/[\-:]([a-z])/g;function lc(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(ac,lc);Jt[e]=new dn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(ac,lc);Jt[e]=new dn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(ac,lc);Jt[e]=new dn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Jt[t]=new dn(t,1,!1,t.toLowerCase(),null,!1,!1)});Jt.xlinkHref=new dn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Jt[t]=new dn(t,1,!1,t.toLowerCase(),null,!0,!0)});function uc(t,e,n,r){var o=Jt.hasOwnProperty(e)?Jt[e]:null;(o!==null?o.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(cg(e,n,o,r)&&(n=null),r||o===null?lg(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):o.mustUseProperty?t[o.propertyName]=n===null?o.type===3?!1:"":n:(e=o.attributeName,r=o.attributeNamespace,n===null?t.removeAttribute(e):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Er=ig.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ei=Symbol.for("react.element"),Fo=Symbol.for("react.portal"),zo=Symbol.for("react.fragment"),cc=Symbol.for("react.strict_mode"),Ql=Symbol.for("react.profiler"),lh=Symbol.for("react.provider"),uh=Symbol.for("react.context"),dc=Symbol.for("react.forward_ref"),Xl=Symbol.for("react.suspense"),Zl=Symbol.for("react.suspense_list"),fc=Symbol.for("react.memo"),Ar=Symbol.for("react.lazy"),ch=Symbol.for("react.offscreen"),ad=Symbol.iterator;function ws(t){return t===null||typeof t!="object"?null:(t=ad&&t[ad]||t["@@iterator"],typeof t=="function"?t:null)}var bt=Object.assign,ul;function As(t){if(ul===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);ul=e&&e[1]||""}return`
`+ul+t}var cl=!1;function dl(t,e){if(!t||cl)return"";cl=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var o=c.stack.split(`
`),s=r.stack.split(`
`),i=o.length-1,l=s.length-1;1<=i&&0<=l&&o[i]!==s[l];)l--;for(;1<=i&&0<=l;i--,l--)if(o[i]!==s[l]){if(i!==1||l!==1)do if(i--,l--,0>l||o[i]!==s[l]){var u=`
`+o[i].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=i&&0<=l);break}}}finally{cl=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?As(t):""}function dg(t){switch(t.tag){case 5:return As(t.type);case 16:return As("Lazy");case 13:return As("Suspense");case 19:return As("SuspenseList");case 0:case 2:case 15:return t=dl(t.type,!1),t;case 11:return t=dl(t.type.render,!1),t;case 1:return t=dl(t.type,!0),t;default:return""}}function eu(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case zo:return"Fragment";case Fo:return"Portal";case Ql:return"Profiler";case cc:return"StrictMode";case Xl:return"Suspense";case Zl:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case uh:return(t.displayName||"Context")+".Consumer";case lh:return(t._context.displayName||"Context")+".Provider";case dc:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case fc:return e=t.displayName||null,e!==null?e:eu(t.type)||"Memo";case Ar:e=t._payload,t=t._init;try{return eu(t(e))}catch{}}return null}function fg(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return eu(e);case 8:return e===cc?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function qr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function dh(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function hg(t){var e=dh(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return o.call(this)},set:function(i){r=""+i,s.call(this,i)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ji(t){t._valueTracker||(t._valueTracker=hg(t))}function fh(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=dh(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function la(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function tu(t,e){var n=e.checked;return bt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function ld(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=qr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function hh(t,e){e=e.checked,e!=null&&uc(t,"checked",e,!1)}function nu(t,e){hh(t,e);var n=qr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?ru(t,e.type,n):e.hasOwnProperty("defaultValue")&&ru(t,e.type,qr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function ud(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function ru(t,e,n){(e!=="number"||la(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Os=Array.isArray;function Zo(t,e,n,r){if(t=t.options,e){e={};for(var o=0;o<n.length;o++)e["$"+n[o]]=!0;for(n=0;n<t.length;n++)o=e.hasOwnProperty("$"+t[n].value),t[n].selected!==o&&(t[n].selected=o),o&&r&&(t[n].defaultSelected=!0)}else{for(n=""+qr(n),e=null,o=0;o<t.length;o++){if(t[o].value===n){t[o].selected=!0,r&&(t[o].defaultSelected=!0);return}e!==null||t[o].disabled||(e=t[o])}e!==null&&(e.selected=!0)}}function ou(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(G(91));return bt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function cd(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(G(92));if(Os(n)){if(1<n.length)throw Error(G(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:qr(n)}}function ph(t,e){var n=qr(e.value),r=qr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function dd(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function mh(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function su(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?mh(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ci,gh=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,o){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,o)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ci=Ci||document.createElement("div"),Ci.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ci.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ys(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Is={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pg=["Webkit","ms","Moz","O"];Object.keys(Is).forEach(function(t){pg.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Is[e]=Is[t]})});function yh(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Is.hasOwnProperty(t)&&Is[t]?(""+e).trim():e+"px"}function vh(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,o=yh(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,o):t[n]=o}}var mg=bt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function iu(t,e){if(e){if(mg[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(G(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(G(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(G(61))}if(e.style!=null&&typeof e.style!="object")throw Error(G(62))}}function au(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var lu=null;function hc(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var uu=null,es=null,ts=null;function fd(t){if(t=gi(t)){if(typeof uu!="function")throw Error(G(280));var e=t.stateNode;e&&(e=Fa(e),uu(t.stateNode,t.type,e))}}function xh(t){es?ts?ts.push(t):ts=[t]:es=t}function bh(){if(es){var t=es,e=ts;if(ts=es=null,fd(t),e)for(t=0;t<e.length;t++)fd(e[t])}}function wh(t,e){return t(e)}function Sh(){}var fl=!1;function _h(t,e,n){if(fl)return t(e,n);fl=!0;try{return wh(t,e,n)}finally{fl=!1,(es!==null||ts!==null)&&(Sh(),bh())}}function Qs(t,e){var n=t.stateNode;if(n===null)return null;var r=Fa(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(G(231,e,typeof n));return n}var cu=!1;if(br)try{var Ss={};Object.defineProperty(Ss,"passive",{get:function(){cu=!0}}),window.addEventListener("test",Ss,Ss),window.removeEventListener("test",Ss,Ss)}catch{cu=!1}function gg(t,e,n,r,o,s,i,l,u){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(d){this.onError(d)}}var $s=!1,ua=null,ca=!1,du=null,yg={onError:function(t){$s=!0,ua=t}};function vg(t,e,n,r,o,s,i,l,u){$s=!1,ua=null,gg.apply(yg,arguments)}function xg(t,e,n,r,o,s,i,l,u){if(vg.apply(this,arguments),$s){if($s){var c=ua;$s=!1,ua=null}else throw Error(G(198));ca||(ca=!0,du=c)}}function jo(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function kh(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function hd(t){if(jo(t)!==t)throw Error(G(188))}function bg(t){var e=t.alternate;if(!e){if(e=jo(t),e===null)throw Error(G(188));return e!==t?null:t}for(var n=t,r=e;;){var o=n.return;if(o===null)break;var s=o.alternate;if(s===null){if(r=o.return,r!==null){n=r;continue}break}if(o.child===s.child){for(s=o.child;s;){if(s===n)return hd(o),t;if(s===r)return hd(o),e;s=s.sibling}throw Error(G(188))}if(n.return!==r.return)n=o,r=s;else{for(var i=!1,l=o.child;l;){if(l===n){i=!0,n=o,r=s;break}if(l===r){i=!0,r=o,n=s;break}l=l.sibling}if(!i){for(l=s.child;l;){if(l===n){i=!0,n=s,r=o;break}if(l===r){i=!0,r=s,n=o;break}l=l.sibling}if(!i)throw Error(G(189))}}if(n.alternate!==r)throw Error(G(190))}if(n.tag!==3)throw Error(G(188));return n.stateNode.current===n?t:e}function Eh(t){return t=bg(t),t!==null?jh(t):null}function jh(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=jh(t);if(e!==null)return e;t=t.sibling}return null}var Ch=On.unstable_scheduleCallback,pd=On.unstable_cancelCallback,wg=On.unstable_shouldYield,Sg=On.unstable_requestPaint,Ct=On.unstable_now,_g=On.unstable_getCurrentPriorityLevel,pc=On.unstable_ImmediatePriority,Rh=On.unstable_UserBlockingPriority,da=On.unstable_NormalPriority,kg=On.unstable_LowPriority,Nh=On.unstable_IdlePriority,$a=null,cr=null;function Eg(t){if(cr&&typeof cr.onCommitFiberRoot=="function")try{cr.onCommitFiberRoot($a,t,void 0,(t.current.flags&128)===128)}catch{}}var Qn=Math.clz32?Math.clz32:Rg,jg=Math.log,Cg=Math.LN2;function Rg(t){return t>>>=0,t===0?32:31-(jg(t)/Cg|0)|0}var Ri=64,Ni=4194304;function Ts(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function fa(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,o=t.suspendedLanes,s=t.pingedLanes,i=n&268435455;if(i!==0){var l=i&~o;l!==0?r=Ts(l):(s&=i,s!==0&&(r=Ts(s)))}else i=n&~o,i!==0?r=Ts(i):s!==0&&(r=Ts(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&o)&&(o=r&-r,s=e&-e,o>=s||o===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Qn(e),o=1<<n,r|=t[n],e&=~o;return r}function Ng(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Dg(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,o=t.expirationTimes,s=t.pendingLanes;0<s;){var i=31-Qn(s),l=1<<i,u=o[i];u===-1?(!(l&n)||l&r)&&(o[i]=Ng(l,e)):u<=e&&(t.expiredLanes|=l),s&=~l}}function fu(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Dh(){var t=Ri;return Ri<<=1,!(Ri&4194240)&&(Ri=64),t}function hl(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function pi(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Qn(e),t[e]=n}function Ag(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var o=31-Qn(n),s=1<<o;e[o]=0,r[o]=-1,t[o]=-1,n&=~s}}function mc(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Qn(n),o=1<<r;o&e|t[r]&e&&(t[r]|=e),n&=~o}}var Ze=0;function Ah(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Oh,gc,Th,Ph,Lh,hu=!1,Di=[],Mr=null,Br=null,Ur=null,Xs=new Map,Zs=new Map,Tr=[],Og="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function md(t,e){switch(t){case"focusin":case"focusout":Mr=null;break;case"dragenter":case"dragleave":Br=null;break;case"mouseover":case"mouseout":Ur=null;break;case"pointerover":case"pointerout":Xs.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Zs.delete(e.pointerId)}}function _s(t,e,n,r,o,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[o]},e!==null&&(e=gi(e),e!==null&&gc(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,o!==null&&e.indexOf(o)===-1&&e.push(o),t)}function Tg(t,e,n,r,o){switch(e){case"focusin":return Mr=_s(Mr,t,e,n,r,o),!0;case"dragenter":return Br=_s(Br,t,e,n,r,o),!0;case"mouseover":return Ur=_s(Ur,t,e,n,r,o),!0;case"pointerover":var s=o.pointerId;return Xs.set(s,_s(Xs.get(s)||null,t,e,n,r,o)),!0;case"gotpointercapture":return s=o.pointerId,Zs.set(s,_s(Zs.get(s)||null,t,e,n,r,o)),!0}return!1}function Ih(t){var e=fo(t.target);if(e!==null){var n=jo(e);if(n!==null){if(e=n.tag,e===13){if(e=kh(n),e!==null){t.blockedOn=e,Lh(t.priority,function(){Th(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Xi(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=pu(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);lu=r,n.target.dispatchEvent(r),lu=null}else return e=gi(n),e!==null&&gc(e),t.blockedOn=n,!1;e.shift()}return!0}function gd(t,e,n){Xi(t)&&n.delete(e)}function Pg(){hu=!1,Mr!==null&&Xi(Mr)&&(Mr=null),Br!==null&&Xi(Br)&&(Br=null),Ur!==null&&Xi(Ur)&&(Ur=null),Xs.forEach(gd),Zs.forEach(gd)}function ks(t,e){t.blockedOn===e&&(t.blockedOn=null,hu||(hu=!0,On.unstable_scheduleCallback(On.unstable_NormalPriority,Pg)))}function ei(t){function e(o){return ks(o,t)}if(0<Di.length){ks(Di[0],t);for(var n=1;n<Di.length;n++){var r=Di[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Mr!==null&&ks(Mr,t),Br!==null&&ks(Br,t),Ur!==null&&ks(Ur,t),Xs.forEach(e),Zs.forEach(e),n=0;n<Tr.length;n++)r=Tr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Tr.length&&(n=Tr[0],n.blockedOn===null);)Ih(n),n.blockedOn===null&&Tr.shift()}var ns=Er.ReactCurrentBatchConfig,ha=!0;function Lg(t,e,n,r){var o=Ze,s=ns.transition;ns.transition=null;try{Ze=1,yc(t,e,n,r)}finally{Ze=o,ns.transition=s}}function Ig(t,e,n,r){var o=Ze,s=ns.transition;ns.transition=null;try{Ze=4,yc(t,e,n,r)}finally{Ze=o,ns.transition=s}}function yc(t,e,n,r){if(ha){var o=pu(t,e,n,r);if(o===null)_l(t,e,r,pa,n),md(t,r);else if(Tg(o,t,e,n,r))r.stopPropagation();else if(md(t,r),e&4&&-1<Og.indexOf(t)){for(;o!==null;){var s=gi(o);if(s!==null&&Oh(s),s=pu(t,e,n,r),s===null&&_l(t,e,r,pa,n),s===o)break;o=s}o!==null&&r.stopPropagation()}else _l(t,e,r,null,n)}}var pa=null;function pu(t,e,n,r){if(pa=null,t=hc(r),t=fo(t),t!==null)if(e=jo(t),e===null)t=null;else if(n=e.tag,n===13){if(t=kh(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return pa=t,null}function $h(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(_g()){case pc:return 1;case Rh:return 4;case da:case kg:return 16;case Nh:return 536870912;default:return 16}default:return 16}}var Ir=null,vc=null,Zi=null;function Mh(){if(Zi)return Zi;var t,e=vc,n=e.length,r,o="value"in Ir?Ir.value:Ir.textContent,s=o.length;for(t=0;t<n&&e[t]===o[t];t++);var i=n-t;for(r=1;r<=i&&e[n-r]===o[s-r];r++);return Zi=o.slice(t,1<r?1-r:void 0)}function ea(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ai(){return!0}function yd(){return!1}function Pn(t){function e(n,r,o,s,i){this._reactName=n,this._targetInst=o,this.type=r,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Ai:yd,this.isPropagationStopped=yd,this}return bt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ai)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ai)},persist:function(){},isPersistent:Ai}),e}var ms={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},xc=Pn(ms),mi=bt({},ms,{view:0,detail:0}),$g=Pn(mi),pl,ml,Es,Ma=bt({},mi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bc,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Es&&(Es&&t.type==="mousemove"?(pl=t.screenX-Es.screenX,ml=t.screenY-Es.screenY):ml=pl=0,Es=t),pl)},movementY:function(t){return"movementY"in t?t.movementY:ml}}),vd=Pn(Ma),Mg=bt({},Ma,{dataTransfer:0}),Bg=Pn(Mg),Ug=bt({},mi,{relatedTarget:0}),gl=Pn(Ug),Fg=bt({},ms,{animationName:0,elapsedTime:0,pseudoElement:0}),zg=Pn(Fg),Wg=bt({},ms,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Vg=Pn(Wg),Gg=bt({},ms,{data:0}),xd=Pn(Gg),qg={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Hg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Kg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Jg(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Kg[t])?!!e[t]:!1}function bc(){return Jg}var Yg=bt({},mi,{key:function(t){if(t.key){var e=qg[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ea(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Hg[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bc,charCode:function(t){return t.type==="keypress"?ea(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ea(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Qg=Pn(Yg),Xg=bt({},Ma,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),bd=Pn(Xg),Zg=bt({},mi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bc}),e0=Pn(Zg),t0=bt({},ms,{propertyName:0,elapsedTime:0,pseudoElement:0}),n0=Pn(t0),r0=bt({},Ma,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),o0=Pn(r0),s0=[9,13,27,32],wc=br&&"CompositionEvent"in window,Ms=null;br&&"documentMode"in document&&(Ms=document.documentMode);var i0=br&&"TextEvent"in window&&!Ms,Bh=br&&(!wc||Ms&&8<Ms&&11>=Ms),wd=" ",Sd=!1;function Uh(t,e){switch(t){case"keyup":return s0.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Fh(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Wo=!1;function a0(t,e){switch(t){case"compositionend":return Fh(e);case"keypress":return e.which!==32?null:(Sd=!0,wd);case"textInput":return t=e.data,t===wd&&Sd?null:t;default:return null}}function l0(t,e){if(Wo)return t==="compositionend"||!wc&&Uh(t,e)?(t=Mh(),Zi=vc=Ir=null,Wo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Bh&&e.locale!=="ko"?null:e.data;default:return null}}var u0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _d(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!u0[t.type]:e==="textarea"}function zh(t,e,n,r){xh(r),e=ma(e,"onChange"),0<e.length&&(n=new xc("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Bs=null,ti=null;function c0(t){Zh(t,0)}function Ba(t){var e=qo(t);if(fh(e))return t}function d0(t,e){if(t==="change")return e}var Wh=!1;if(br){var yl;if(br){var vl="oninput"in document;if(!vl){var kd=document.createElement("div");kd.setAttribute("oninput","return;"),vl=typeof kd.oninput=="function"}yl=vl}else yl=!1;Wh=yl&&(!document.documentMode||9<document.documentMode)}function Ed(){Bs&&(Bs.detachEvent("onpropertychange",Vh),ti=Bs=null)}function Vh(t){if(t.propertyName==="value"&&Ba(ti)){var e=[];zh(e,ti,t,hc(t)),_h(c0,e)}}function f0(t,e,n){t==="focusin"?(Ed(),Bs=e,ti=n,Bs.attachEvent("onpropertychange",Vh)):t==="focusout"&&Ed()}function h0(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ba(ti)}function p0(t,e){if(t==="click")return Ba(e)}function m0(t,e){if(t==="input"||t==="change")return Ba(e)}function g0(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Zn=typeof Object.is=="function"?Object.is:g0;function ni(t,e){if(Zn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!Yl.call(e,o)||!Zn(t[o],e[o]))return!1}return!0}function jd(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Cd(t,e){var n=jd(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=jd(n)}}function Gh(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Gh(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function qh(){for(var t=window,e=la();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=la(t.document)}return e}function Sc(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function y0(t){var e=qh(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Gh(n.ownerDocument.documentElement,n)){if(r!==null&&Sc(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var o=n.textContent.length,s=Math.min(r.start,o);r=r.end===void 0?s:Math.min(r.end,o),!t.extend&&s>r&&(o=r,r=s,s=o),o=Cd(n,s);var i=Cd(n,r);o&&i&&(t.rangeCount!==1||t.anchorNode!==o.node||t.anchorOffset!==o.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(o.node,o.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var v0=br&&"documentMode"in document&&11>=document.documentMode,Vo=null,mu=null,Us=null,gu=!1;function Rd(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;gu||Vo==null||Vo!==la(r)||(r=Vo,"selectionStart"in r&&Sc(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Us&&ni(Us,r)||(Us=r,r=ma(mu,"onSelect"),0<r.length&&(e=new xc("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Vo)))}function Oi(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Go={animationend:Oi("Animation","AnimationEnd"),animationiteration:Oi("Animation","AnimationIteration"),animationstart:Oi("Animation","AnimationStart"),transitionend:Oi("Transition","TransitionEnd")},xl={},Hh={};br&&(Hh=document.createElement("div").style,"AnimationEvent"in window||(delete Go.animationend.animation,delete Go.animationiteration.animation,delete Go.animationstart.animation),"TransitionEvent"in window||delete Go.transitionend.transition);function Ua(t){if(xl[t])return xl[t];if(!Go[t])return t;var e=Go[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Hh)return xl[t]=e[n];return t}var Kh=Ua("animationend"),Jh=Ua("animationiteration"),Yh=Ua("animationstart"),Qh=Ua("transitionend"),Xh=new Map,Nd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Kr(t,e){Xh.set(t,e),Eo(e,[t])}for(var bl=0;bl<Nd.length;bl++){var wl=Nd[bl],x0=wl.toLowerCase(),b0=wl[0].toUpperCase()+wl.slice(1);Kr(x0,"on"+b0)}Kr(Kh,"onAnimationEnd");Kr(Jh,"onAnimationIteration");Kr(Yh,"onAnimationStart");Kr("dblclick","onDoubleClick");Kr("focusin","onFocus");Kr("focusout","onBlur");Kr(Qh,"onTransitionEnd");ss("onMouseEnter",["mouseout","mouseover"]);ss("onMouseLeave",["mouseout","mouseover"]);ss("onPointerEnter",["pointerout","pointerover"]);ss("onPointerLeave",["pointerout","pointerover"]);Eo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Eo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Eo("onBeforeInput",["compositionend","keypress","textInput","paste"]);Eo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Eo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Eo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ps="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),w0=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ps));function Dd(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,xg(r,e,void 0,t),t.currentTarget=null}function Zh(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],o=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var i=r.length-1;0<=i;i--){var l=r[i],u=l.instance,c=l.currentTarget;if(l=l.listener,u!==s&&o.isPropagationStopped())break e;Dd(o,l,c),s=u}else for(i=0;i<r.length;i++){if(l=r[i],u=l.instance,c=l.currentTarget,l=l.listener,u!==s&&o.isPropagationStopped())break e;Dd(o,l,c),s=u}}}if(ca)throw t=du,ca=!1,du=null,t}function dt(t,e){var n=e[wu];n===void 0&&(n=e[wu]=new Set);var r=t+"__bubble";n.has(r)||(ep(e,t,2,!1),n.add(r))}function Sl(t,e,n){var r=0;e&&(r|=4),ep(n,t,r,e)}var Ti="_reactListening"+Math.random().toString(36).slice(2);function ri(t){if(!t[Ti]){t[Ti]=!0,ah.forEach(function(n){n!=="selectionchange"&&(w0.has(n)||Sl(n,!1,t),Sl(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ti]||(e[Ti]=!0,Sl("selectionchange",!1,e))}}function ep(t,e,n,r){switch($h(e)){case 1:var o=Lg;break;case 4:o=Ig;break;default:o=yc}n=o.bind(null,e,n,t),o=void 0,!cu||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(o=!0),r?o!==void 0?t.addEventListener(e,n,{capture:!0,passive:o}):t.addEventListener(e,n,!0):o!==void 0?t.addEventListener(e,n,{passive:o}):t.addEventListener(e,n,!1)}function _l(t,e,n,r,o){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var l=r.stateNode.containerInfo;if(l===o||l.nodeType===8&&l.parentNode===o)break;if(i===4)for(i=r.return;i!==null;){var u=i.tag;if((u===3||u===4)&&(u=i.stateNode.containerInfo,u===o||u.nodeType===8&&u.parentNode===o))return;i=i.return}for(;l!==null;){if(i=fo(l),i===null)return;if(u=i.tag,u===5||u===6){r=s=i;continue e}l=l.parentNode}}r=r.return}_h(function(){var c=s,d=hc(n),p=[];e:{var h=Xh.get(t);if(h!==void 0){var y=xc,b=t;switch(t){case"keypress":if(ea(n)===0)break e;case"keydown":case"keyup":y=Qg;break;case"focusin":b="focus",y=gl;break;case"focusout":b="blur",y=gl;break;case"beforeblur":case"afterblur":y=gl;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":y=vd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":y=Bg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":y=e0;break;case Kh:case Jh:case Yh:y=zg;break;case Qh:y=n0;break;case"scroll":y=$g;break;case"wheel":y=o0;break;case"copy":case"cut":case"paste":y=Vg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":y=bd}var v=(e&4)!==0,S=!v&&t==="scroll",g=v?h!==null?h+"Capture":null:h;v=[];for(var f=c,m;f!==null;){m=f;var w=m.stateNode;if(m.tag===5&&w!==null&&(m=w,g!==null&&(w=Qs(f,g),w!=null&&v.push(oi(f,w,m)))),S)break;f=f.return}0<v.length&&(h=new y(h,b,null,n,d),p.push({event:h,listeners:v}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",y=t==="mouseout"||t==="pointerout",h&&n!==lu&&(b=n.relatedTarget||n.fromElement)&&(fo(b)||b[wr]))break e;if((y||h)&&(h=d.window===d?d:(h=d.ownerDocument)?h.defaultView||h.parentWindow:window,y?(b=n.relatedTarget||n.toElement,y=c,b=b?fo(b):null,b!==null&&(S=jo(b),b!==S||b.tag!==5&&b.tag!==6)&&(b=null)):(y=null,b=c),y!==b)){if(v=vd,w="onMouseLeave",g="onMouseEnter",f="mouse",(t==="pointerout"||t==="pointerover")&&(v=bd,w="onPointerLeave",g="onPointerEnter",f="pointer"),S=y==null?h:qo(y),m=b==null?h:qo(b),h=new v(w,f+"leave",y,n,d),h.target=S,h.relatedTarget=m,w=null,fo(d)===c&&(v=new v(g,f+"enter",b,n,d),v.target=m,v.relatedTarget=S,w=v),S=w,y&&b)t:{for(v=y,g=b,f=0,m=v;m;m=Oo(m))f++;for(m=0,w=g;w;w=Oo(w))m++;for(;0<f-m;)v=Oo(v),f--;for(;0<m-f;)g=Oo(g),m--;for(;f--;){if(v===g||g!==null&&v===g.alternate)break t;v=Oo(v),g=Oo(g)}v=null}else v=null;y!==null&&Ad(p,h,y,v,!1),b!==null&&S!==null&&Ad(p,S,b,v,!0)}}e:{if(h=c?qo(c):window,y=h.nodeName&&h.nodeName.toLowerCase(),y==="select"||y==="input"&&h.type==="file")var _=d0;else if(_d(h))if(Wh)_=m0;else{_=h0;var R=f0}else(y=h.nodeName)&&y.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(_=p0);if(_&&(_=_(t,c))){zh(p,_,n,d);break e}R&&R(t,h,c),t==="focusout"&&(R=h._wrapperState)&&R.controlled&&h.type==="number"&&ru(h,"number",h.value)}switch(R=c?qo(c):window,t){case"focusin":(_d(R)||R.contentEditable==="true")&&(Vo=R,mu=c,Us=null);break;case"focusout":Us=mu=Vo=null;break;case"mousedown":gu=!0;break;case"contextmenu":case"mouseup":case"dragend":gu=!1,Rd(p,n,d);break;case"selectionchange":if(v0)break;case"keydown":case"keyup":Rd(p,n,d)}var D;if(wc)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else Wo?Uh(t,n)&&(k="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(Bh&&n.locale!=="ko"&&(Wo||k!=="onCompositionStart"?k==="onCompositionEnd"&&Wo&&(D=Mh()):(Ir=d,vc="value"in Ir?Ir.value:Ir.textContent,Wo=!0)),R=ma(c,k),0<R.length&&(k=new xd(k,t,null,n,d),p.push({event:k,listeners:R}),D?k.data=D:(D=Fh(n),D!==null&&(k.data=D)))),(D=i0?a0(t,n):l0(t,n))&&(c=ma(c,"onBeforeInput"),0<c.length&&(d=new xd("onBeforeInput","beforeinput",null,n,d),p.push({event:d,listeners:c}),d.data=D))}Zh(p,e)})}function oi(t,e,n){return{instance:t,listener:e,currentTarget:n}}function ma(t,e){for(var n=e+"Capture",r=[];t!==null;){var o=t,s=o.stateNode;o.tag===5&&s!==null&&(o=s,s=Qs(t,n),s!=null&&r.unshift(oi(t,s,o)),s=Qs(t,e),s!=null&&r.push(oi(t,s,o))),t=t.return}return r}function Oo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Ad(t,e,n,r,o){for(var s=e._reactName,i=[];n!==null&&n!==r;){var l=n,u=l.alternate,c=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&c!==null&&(l=c,o?(u=Qs(n,s),u!=null&&i.unshift(oi(n,u,l))):o||(u=Qs(n,s),u!=null&&i.push(oi(n,u,l)))),n=n.return}i.length!==0&&t.push({event:e,listeners:i})}var S0=/\r\n?/g,_0=/\u0000|\uFFFD/g;function Od(t){return(typeof t=="string"?t:""+t).replace(S0,`
`).replace(_0,"")}function Pi(t,e,n){if(e=Od(e),Od(t)!==e&&n)throw Error(G(425))}function ga(){}var yu=null,vu=null;function xu(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var bu=typeof setTimeout=="function"?setTimeout:void 0,k0=typeof clearTimeout=="function"?clearTimeout:void 0,Td=typeof Promise=="function"?Promise:void 0,E0=typeof queueMicrotask=="function"?queueMicrotask:typeof Td<"u"?function(t){return Td.resolve(null).then(t).catch(j0)}:bu;function j0(t){setTimeout(function(){throw t})}function kl(t,e){var n=e,r=0;do{var o=n.nextSibling;if(t.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(r===0){t.removeChild(o),ei(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=o}while(n);ei(e)}function Fr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Pd(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var gs=Math.random().toString(36).slice(2),lr="__reactFiber$"+gs,si="__reactProps$"+gs,wr="__reactContainer$"+gs,wu="__reactEvents$"+gs,C0="__reactListeners$"+gs,R0="__reactHandles$"+gs;function fo(t){var e=t[lr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[wr]||n[lr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Pd(t);t!==null;){if(n=t[lr])return n;t=Pd(t)}return e}t=n,n=t.parentNode}return null}function gi(t){return t=t[lr]||t[wr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function qo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(G(33))}function Fa(t){return t[si]||null}var Su=[],Ho=-1;function Jr(t){return{current:t}}function ft(t){0>Ho||(t.current=Su[Ho],Su[Ho]=null,Ho--)}function ct(t,e){Ho++,Su[Ho]=t.current,t.current=e}var Hr={},Zt=Jr(Hr),bn=Jr(!1),vo=Hr;function is(t,e){var n=t.type.contextTypes;if(!n)return Hr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var o={},s;for(s in n)o[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function wn(t){return t=t.childContextTypes,t!=null}function ya(){ft(bn),ft(Zt)}function Ld(t,e,n){if(Zt.current!==Hr)throw Error(G(168));ct(Zt,e),ct(bn,n)}function tp(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var o in r)if(!(o in e))throw Error(G(108,fg(t)||"Unknown",o));return bt({},n,r)}function va(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Hr,vo=Zt.current,ct(Zt,t),ct(bn,bn.current),!0}function Id(t,e,n){var r=t.stateNode;if(!r)throw Error(G(169));n?(t=tp(t,e,vo),r.__reactInternalMemoizedMergedChildContext=t,ft(bn),ft(Zt),ct(Zt,t)):ft(bn),ct(bn,n)}var mr=null,za=!1,El=!1;function np(t){mr===null?mr=[t]:mr.push(t)}function N0(t){za=!0,np(t)}function Yr(){if(!El&&mr!==null){El=!0;var t=0,e=Ze;try{var n=mr;for(Ze=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}mr=null,za=!1}catch(o){throw mr!==null&&(mr=mr.slice(t+1)),Ch(pc,Yr),o}finally{Ze=e,El=!1}}return null}var Ko=[],Jo=0,xa=null,ba=0,$n=[],Mn=0,xo=null,gr=1,yr="";function ao(t,e){Ko[Jo++]=ba,Ko[Jo++]=xa,xa=t,ba=e}function rp(t,e,n){$n[Mn++]=gr,$n[Mn++]=yr,$n[Mn++]=xo,xo=t;var r=gr;t=yr;var o=32-Qn(r)-1;r&=~(1<<o),n+=1;var s=32-Qn(e)+o;if(30<s){var i=o-o%5;s=(r&(1<<i)-1).toString(32),r>>=i,o-=i,gr=1<<32-Qn(e)+o|n<<o|r,yr=s+t}else gr=1<<s|n<<o|r,yr=t}function _c(t){t.return!==null&&(ao(t,1),rp(t,1,0))}function kc(t){for(;t===xa;)xa=Ko[--Jo],Ko[Jo]=null,ba=Ko[--Jo],Ko[Jo]=null;for(;t===xo;)xo=$n[--Mn],$n[Mn]=null,yr=$n[--Mn],$n[Mn]=null,gr=$n[--Mn],$n[Mn]=null}var An=null,Dn=null,pt=!1,Jn=null;function op(t,e){var n=Bn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function $d(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,An=t,Dn=Fr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,An=t,Dn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=xo!==null?{id:gr,overflow:yr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Bn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,An=t,Dn=null,!0):!1;default:return!1}}function _u(t){return(t.mode&1)!==0&&(t.flags&128)===0}function ku(t){if(pt){var e=Dn;if(e){var n=e;if(!$d(t,e)){if(_u(t))throw Error(G(418));e=Fr(n.nextSibling);var r=An;e&&$d(t,e)?op(r,n):(t.flags=t.flags&-4097|2,pt=!1,An=t)}}else{if(_u(t))throw Error(G(418));t.flags=t.flags&-4097|2,pt=!1,An=t}}}function Md(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;An=t}function Li(t){if(t!==An)return!1;if(!pt)return Md(t),pt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!xu(t.type,t.memoizedProps)),e&&(e=Dn)){if(_u(t))throw sp(),Error(G(418));for(;e;)op(t,e),e=Fr(e.nextSibling)}if(Md(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(G(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Dn=Fr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Dn=null}}else Dn=An?Fr(t.stateNode.nextSibling):null;return!0}function sp(){for(var t=Dn;t;)t=Fr(t.nextSibling)}function as(){Dn=An=null,pt=!1}function Ec(t){Jn===null?Jn=[t]:Jn.push(t)}var D0=Er.ReactCurrentBatchConfig;function js(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(G(309));var r=n.stateNode}if(!r)throw Error(G(147,t));var o=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(i){var l=o.refs;i===null?delete l[s]:l[s]=i},e._stringRef=s,e)}if(typeof t!="string")throw Error(G(284));if(!n._owner)throw Error(G(290,t))}return t}function Ii(t,e){throw t=Object.prototype.toString.call(e),Error(G(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Bd(t){var e=t._init;return e(t._payload)}function ip(t){function e(g,f){if(t){var m=g.deletions;m===null?(g.deletions=[f],g.flags|=16):m.push(f)}}function n(g,f){if(!t)return null;for(;f!==null;)e(g,f),f=f.sibling;return null}function r(g,f){for(g=new Map;f!==null;)f.key!==null?g.set(f.key,f):g.set(f.index,f),f=f.sibling;return g}function o(g,f){return g=Gr(g,f),g.index=0,g.sibling=null,g}function s(g,f,m){return g.index=m,t?(m=g.alternate,m!==null?(m=m.index,m<f?(g.flags|=2,f):m):(g.flags|=2,f)):(g.flags|=1048576,f)}function i(g){return t&&g.alternate===null&&(g.flags|=2),g}function l(g,f,m,w){return f===null||f.tag!==6?(f=Ol(m,g.mode,w),f.return=g,f):(f=o(f,m),f.return=g,f)}function u(g,f,m,w){var _=m.type;return _===zo?d(g,f,m.props.children,w,m.key):f!==null&&(f.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Ar&&Bd(_)===f.type)?(w=o(f,m.props),w.ref=js(g,f,m),w.return=g,w):(w=aa(m.type,m.key,m.props,null,g.mode,w),w.ref=js(g,f,m),w.return=g,w)}function c(g,f,m,w){return f===null||f.tag!==4||f.stateNode.containerInfo!==m.containerInfo||f.stateNode.implementation!==m.implementation?(f=Tl(m,g.mode,w),f.return=g,f):(f=o(f,m.children||[]),f.return=g,f)}function d(g,f,m,w,_){return f===null||f.tag!==7?(f=yo(m,g.mode,w,_),f.return=g,f):(f=o(f,m),f.return=g,f)}function p(g,f,m){if(typeof f=="string"&&f!==""||typeof f=="number")return f=Ol(""+f,g.mode,m),f.return=g,f;if(typeof f=="object"&&f!==null){switch(f.$$typeof){case Ei:return m=aa(f.type,f.key,f.props,null,g.mode,m),m.ref=js(g,null,f),m.return=g,m;case Fo:return f=Tl(f,g.mode,m),f.return=g,f;case Ar:var w=f._init;return p(g,w(f._payload),m)}if(Os(f)||ws(f))return f=yo(f,g.mode,m,null),f.return=g,f;Ii(g,f)}return null}function h(g,f,m,w){var _=f!==null?f.key:null;if(typeof m=="string"&&m!==""||typeof m=="number")return _!==null?null:l(g,f,""+m,w);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Ei:return m.key===_?u(g,f,m,w):null;case Fo:return m.key===_?c(g,f,m,w):null;case Ar:return _=m._init,h(g,f,_(m._payload),w)}if(Os(m)||ws(m))return _!==null?null:d(g,f,m,w,null);Ii(g,m)}return null}function y(g,f,m,w,_){if(typeof w=="string"&&w!==""||typeof w=="number")return g=g.get(m)||null,l(f,g,""+w,_);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ei:return g=g.get(w.key===null?m:w.key)||null,u(f,g,w,_);case Fo:return g=g.get(w.key===null?m:w.key)||null,c(f,g,w,_);case Ar:var R=w._init;return y(g,f,m,R(w._payload),_)}if(Os(w)||ws(w))return g=g.get(m)||null,d(f,g,w,_,null);Ii(f,w)}return null}function b(g,f,m,w){for(var _=null,R=null,D=f,k=f=0,N=null;D!==null&&k<m.length;k++){D.index>k?(N=D,D=null):N=D.sibling;var x=h(g,D,m[k],w);if(x===null){D===null&&(D=N);break}t&&D&&x.alternate===null&&e(g,D),f=s(x,f,k),R===null?_=x:R.sibling=x,R=x,D=N}if(k===m.length)return n(g,D),pt&&ao(g,k),_;if(D===null){for(;k<m.length;k++)D=p(g,m[k],w),D!==null&&(f=s(D,f,k),R===null?_=D:R.sibling=D,R=D);return pt&&ao(g,k),_}for(D=r(g,D);k<m.length;k++)N=y(D,g,k,m[k],w),N!==null&&(t&&N.alternate!==null&&D.delete(N.key===null?k:N.key),f=s(N,f,k),R===null?_=N:R.sibling=N,R=N);return t&&D.forEach(function(j){return e(g,j)}),pt&&ao(g,k),_}function v(g,f,m,w){var _=ws(m);if(typeof _!="function")throw Error(G(150));if(m=_.call(m),m==null)throw Error(G(151));for(var R=_=null,D=f,k=f=0,N=null,x=m.next();D!==null&&!x.done;k++,x=m.next()){D.index>k?(N=D,D=null):N=D.sibling;var j=h(g,D,x.value,w);if(j===null){D===null&&(D=N);break}t&&D&&j.alternate===null&&e(g,D),f=s(j,f,k),R===null?_=j:R.sibling=j,R=j,D=N}if(x.done)return n(g,D),pt&&ao(g,k),_;if(D===null){for(;!x.done;k++,x=m.next())x=p(g,x.value,w),x!==null&&(f=s(x,f,k),R===null?_=x:R.sibling=x,R=x);return pt&&ao(g,k),_}for(D=r(g,D);!x.done;k++,x=m.next())x=y(D,g,k,x.value,w),x!==null&&(t&&x.alternate!==null&&D.delete(x.key===null?k:x.key),f=s(x,f,k),R===null?_=x:R.sibling=x,R=x);return t&&D.forEach(function(L){return e(g,L)}),pt&&ao(g,k),_}function S(g,f,m,w){if(typeof m=="object"&&m!==null&&m.type===zo&&m.key===null&&(m=m.props.children),typeof m=="object"&&m!==null){switch(m.$$typeof){case Ei:e:{for(var _=m.key,R=f;R!==null;){if(R.key===_){if(_=m.type,_===zo){if(R.tag===7){n(g,R.sibling),f=o(R,m.props.children),f.return=g,g=f;break e}}else if(R.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===Ar&&Bd(_)===R.type){n(g,R.sibling),f=o(R,m.props),f.ref=js(g,R,m),f.return=g,g=f;break e}n(g,R);break}else e(g,R);R=R.sibling}m.type===zo?(f=yo(m.props.children,g.mode,w,m.key),f.return=g,g=f):(w=aa(m.type,m.key,m.props,null,g.mode,w),w.ref=js(g,f,m),w.return=g,g=w)}return i(g);case Fo:e:{for(R=m.key;f!==null;){if(f.key===R)if(f.tag===4&&f.stateNode.containerInfo===m.containerInfo&&f.stateNode.implementation===m.implementation){n(g,f.sibling),f=o(f,m.children||[]),f.return=g,g=f;break e}else{n(g,f);break}else e(g,f);f=f.sibling}f=Tl(m,g.mode,w),f.return=g,g=f}return i(g);case Ar:return R=m._init,S(g,f,R(m._payload),w)}if(Os(m))return b(g,f,m,w);if(ws(m))return v(g,f,m,w);Ii(g,m)}return typeof m=="string"&&m!==""||typeof m=="number"?(m=""+m,f!==null&&f.tag===6?(n(g,f.sibling),f=o(f,m),f.return=g,g=f):(n(g,f),f=Ol(m,g.mode,w),f.return=g,g=f),i(g)):n(g,f)}return S}var ls=ip(!0),ap=ip(!1),wa=Jr(null),Sa=null,Yo=null,jc=null;function Cc(){jc=Yo=Sa=null}function Rc(t){var e=wa.current;ft(wa),t._currentValue=e}function Eu(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function rs(t,e){Sa=t,jc=Yo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(xn=!0),t.firstContext=null)}function zn(t){var e=t._currentValue;if(jc!==t)if(t={context:t,memoizedValue:e,next:null},Yo===null){if(Sa===null)throw Error(G(308));Yo=t,Sa.dependencies={lanes:0,firstContext:t}}else Yo=Yo.next=t;return e}var ho=null;function Nc(t){ho===null?ho=[t]:ho.push(t)}function lp(t,e,n,r){var o=e.interleaved;return o===null?(n.next=n,Nc(e)):(n.next=o.next,o.next=n),e.interleaved=n,Sr(t,r)}function Sr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Or=!1;function Dc(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function up(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function xr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function zr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,ze&2){var o=r.pending;return o===null?e.next=e:(e.next=o.next,o.next=e),r.pending=e,Sr(t,n)}return o=r.interleaved,o===null?(e.next=e,Nc(r)):(e.next=o.next,o.next=e),r.interleaved=e,Sr(t,n)}function ta(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,mc(t,n)}}function Ud(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var o=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?o=s=i:s=s.next=i,n=n.next}while(n!==null);s===null?o=s=e:s=s.next=e}else o=s=e;n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function _a(t,e,n,r){var o=t.updateQueue;Or=!1;var s=o.firstBaseUpdate,i=o.lastBaseUpdate,l=o.shared.pending;if(l!==null){o.shared.pending=null;var u=l,c=u.next;u.next=null,i===null?s=c:i.next=c,i=u;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==i&&(l===null?d.firstBaseUpdate=c:l.next=c,d.lastBaseUpdate=u))}if(s!==null){var p=o.baseState;i=0,d=c=u=null,l=s;do{var h=l.lane,y=l.eventTime;if((r&h)===h){d!==null&&(d=d.next={eventTime:y,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var b=t,v=l;switch(h=e,y=n,v.tag){case 1:if(b=v.payload,typeof b=="function"){p=b.call(y,p,h);break e}p=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=v.payload,h=typeof b=="function"?b.call(y,p,h):b,h==null)break e;p=bt({},p,h);break e;case 2:Or=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,h=o.effects,h===null?o.effects=[l]:h.push(l))}else y={eventTime:y,lane:h,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(c=d=y,u=p):d=d.next=y,i|=h;if(l=l.next,l===null){if(l=o.shared.pending,l===null)break;h=l,l=h.next,h.next=null,o.lastBaseUpdate=h,o.shared.pending=null}}while(!0);if(d===null&&(u=p),o.baseState=u,o.firstBaseUpdate=c,o.lastBaseUpdate=d,e=o.shared.interleaved,e!==null){o=e;do i|=o.lane,o=o.next;while(o!==e)}else s===null&&(o.shared.lanes=0);wo|=i,t.lanes=i,t.memoizedState=p}}function Fd(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],o=r.callback;if(o!==null){if(r.callback=null,r=n,typeof o!="function")throw Error(G(191,o));o.call(r)}}}var yi={},dr=Jr(yi),ii=Jr(yi),ai=Jr(yi);function po(t){if(t===yi)throw Error(G(174));return t}function Ac(t,e){switch(ct(ai,e),ct(ii,t),ct(dr,yi),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:su(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=su(e,t)}ft(dr),ct(dr,e)}function us(){ft(dr),ft(ii),ft(ai)}function cp(t){po(ai.current);var e=po(dr.current),n=su(e,t.type);e!==n&&(ct(ii,t),ct(dr,n))}function Oc(t){ii.current===t&&(ft(dr),ft(ii))}var vt=Jr(0);function ka(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var jl=[];function Tc(){for(var t=0;t<jl.length;t++)jl[t]._workInProgressVersionPrimary=null;jl.length=0}var na=Er.ReactCurrentDispatcher,Cl=Er.ReactCurrentBatchConfig,bo=0,xt=null,Mt=null,Wt=null,Ea=!1,Fs=!1,li=0,A0=0;function Yt(){throw Error(G(321))}function Pc(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Zn(t[n],e[n]))return!1;return!0}function Lc(t,e,n,r,o,s){if(bo=s,xt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,na.current=t===null||t.memoizedState===null?L0:I0,t=n(r,o),Fs){s=0;do{if(Fs=!1,li=0,25<=s)throw Error(G(301));s+=1,Wt=Mt=null,e.updateQueue=null,na.current=$0,t=n(r,o)}while(Fs)}if(na.current=ja,e=Mt!==null&&Mt.next!==null,bo=0,Wt=Mt=xt=null,Ea=!1,e)throw Error(G(300));return t}function Ic(){var t=li!==0;return li=0,t}function or(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wt===null?xt.memoizedState=Wt=t:Wt=Wt.next=t,Wt}function Wn(){if(Mt===null){var t=xt.alternate;t=t!==null?t.memoizedState:null}else t=Mt.next;var e=Wt===null?xt.memoizedState:Wt.next;if(e!==null)Wt=e,Mt=t;else{if(t===null)throw Error(G(310));Mt=t,t={memoizedState:Mt.memoizedState,baseState:Mt.baseState,baseQueue:Mt.baseQueue,queue:Mt.queue,next:null},Wt===null?xt.memoizedState=Wt=t:Wt=Wt.next=t}return Wt}function ui(t,e){return typeof e=="function"?e(t):e}function Rl(t){var e=Wn(),n=e.queue;if(n===null)throw Error(G(311));n.lastRenderedReducer=t;var r=Mt,o=r.baseQueue,s=n.pending;if(s!==null){if(o!==null){var i=o.next;o.next=s.next,s.next=i}r.baseQueue=o=s,n.pending=null}if(o!==null){s=o.next,r=r.baseState;var l=i=null,u=null,c=s;do{var d=c.lane;if((bo&d)===d)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var p={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(l=u=p,i=r):u=u.next=p,xt.lanes|=d,wo|=d}c=c.next}while(c!==null&&c!==s);u===null?i=r:u.next=l,Zn(r,e.memoizedState)||(xn=!0),e.memoizedState=r,e.baseState=i,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){o=t;do s=o.lane,xt.lanes|=s,wo|=s,o=o.next;while(o!==t)}else o===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Nl(t){var e=Wn(),n=e.queue;if(n===null)throw Error(G(311));n.lastRenderedReducer=t;var r=n.dispatch,o=n.pending,s=e.memoizedState;if(o!==null){n.pending=null;var i=o=o.next;do s=t(s,i.action),i=i.next;while(i!==o);Zn(s,e.memoizedState)||(xn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function dp(){}function fp(t,e){var n=xt,r=Wn(),o=e(),s=!Zn(r.memoizedState,o);if(s&&(r.memoizedState=o,xn=!0),r=r.queue,$c(mp.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Wt!==null&&Wt.memoizedState.tag&1){if(n.flags|=2048,ci(9,pp.bind(null,n,r,o,e),void 0,null),Vt===null)throw Error(G(349));bo&30||hp(n,e,o)}return o}function hp(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=xt.updateQueue,e===null?(e={lastEffect:null,stores:null},xt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function pp(t,e,n,r){e.value=n,e.getSnapshot=r,gp(e)&&yp(t)}function mp(t,e,n){return n(function(){gp(e)&&yp(t)})}function gp(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Zn(t,n)}catch{return!0}}function yp(t){var e=Sr(t,1);e!==null&&Xn(e,t,1,-1)}function zd(t){var e=or();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ui,lastRenderedState:t},e.queue=t,t=t.dispatch=P0.bind(null,xt,t),[e.memoizedState,t]}function ci(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=xt.updateQueue,e===null?(e={lastEffect:null,stores:null},xt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function vp(){return Wn().memoizedState}function ra(t,e,n,r){var o=or();xt.flags|=t,o.memoizedState=ci(1|e,n,void 0,r===void 0?null:r)}function Wa(t,e,n,r){var o=Wn();r=r===void 0?null:r;var s=void 0;if(Mt!==null){var i=Mt.memoizedState;if(s=i.destroy,r!==null&&Pc(r,i.deps)){o.memoizedState=ci(e,n,s,r);return}}xt.flags|=t,o.memoizedState=ci(1|e,n,s,r)}function Wd(t,e){return ra(8390656,8,t,e)}function $c(t,e){return Wa(2048,8,t,e)}function xp(t,e){return Wa(4,2,t,e)}function bp(t,e){return Wa(4,4,t,e)}function wp(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Sp(t,e,n){return n=n!=null?n.concat([t]):null,Wa(4,4,wp.bind(null,e,t),n)}function Mc(){}function _p(t,e){var n=Wn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Pc(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function kp(t,e){var n=Wn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Pc(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Ep(t,e,n){return bo&21?(Zn(n,e)||(n=Dh(),xt.lanes|=n,wo|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,xn=!0),t.memoizedState=n)}function O0(t,e){var n=Ze;Ze=n!==0&&4>n?n:4,t(!0);var r=Cl.transition;Cl.transition={};try{t(!1),e()}finally{Ze=n,Cl.transition=r}}function jp(){return Wn().memoizedState}function T0(t,e,n){var r=Vr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Cp(t))Rp(e,n);else if(n=lp(t,e,n,r),n!==null){var o=ln();Xn(n,t,r,o),Np(n,e,r)}}function P0(t,e,n){var r=Vr(t),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Cp(t))Rp(e,o);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var i=e.lastRenderedState,l=s(i,n);if(o.hasEagerState=!0,o.eagerState=l,Zn(l,i)){var u=e.interleaved;u===null?(o.next=o,Nc(e)):(o.next=u.next,u.next=o),e.interleaved=o;return}}catch{}finally{}n=lp(t,e,o,r),n!==null&&(o=ln(),Xn(n,t,r,o),Np(n,e,r))}}function Cp(t){var e=t.alternate;return t===xt||e!==null&&e===xt}function Rp(t,e){Fs=Ea=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Np(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,mc(t,n)}}var ja={readContext:zn,useCallback:Yt,useContext:Yt,useEffect:Yt,useImperativeHandle:Yt,useInsertionEffect:Yt,useLayoutEffect:Yt,useMemo:Yt,useReducer:Yt,useRef:Yt,useState:Yt,useDebugValue:Yt,useDeferredValue:Yt,useTransition:Yt,useMutableSource:Yt,useSyncExternalStore:Yt,useId:Yt,unstable_isNewReconciler:!1},L0={readContext:zn,useCallback:function(t,e){return or().memoizedState=[t,e===void 0?null:e],t},useContext:zn,useEffect:Wd,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ra(4194308,4,wp.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ra(4194308,4,t,e)},useInsertionEffect:function(t,e){return ra(4,2,t,e)},useMemo:function(t,e){var n=or();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=or();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=T0.bind(null,xt,t),[r.memoizedState,t]},useRef:function(t){var e=or();return t={current:t},e.memoizedState=t},useState:zd,useDebugValue:Mc,useDeferredValue:function(t){return or().memoizedState=t},useTransition:function(){var t=zd(!1),e=t[0];return t=O0.bind(null,t[1]),or().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=xt,o=or();if(pt){if(n===void 0)throw Error(G(407));n=n()}else{if(n=e(),Vt===null)throw Error(G(349));bo&30||hp(r,e,n)}o.memoizedState=n;var s={value:n,getSnapshot:e};return o.queue=s,Wd(mp.bind(null,r,s,t),[t]),r.flags|=2048,ci(9,pp.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=or(),e=Vt.identifierPrefix;if(pt){var n=yr,r=gr;n=(r&~(1<<32-Qn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=li++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=A0++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},I0={readContext:zn,useCallback:_p,useContext:zn,useEffect:$c,useImperativeHandle:Sp,useInsertionEffect:xp,useLayoutEffect:bp,useMemo:kp,useReducer:Rl,useRef:vp,useState:function(){return Rl(ui)},useDebugValue:Mc,useDeferredValue:function(t){var e=Wn();return Ep(e,Mt.memoizedState,t)},useTransition:function(){var t=Rl(ui)[0],e=Wn().memoizedState;return[t,e]},useMutableSource:dp,useSyncExternalStore:fp,useId:jp,unstable_isNewReconciler:!1},$0={readContext:zn,useCallback:_p,useContext:zn,useEffect:$c,useImperativeHandle:Sp,useInsertionEffect:xp,useLayoutEffect:bp,useMemo:kp,useReducer:Nl,useRef:vp,useState:function(){return Nl(ui)},useDebugValue:Mc,useDeferredValue:function(t){var e=Wn();return Mt===null?e.memoizedState=t:Ep(e,Mt.memoizedState,t)},useTransition:function(){var t=Nl(ui)[0],e=Wn().memoizedState;return[t,e]},useMutableSource:dp,useSyncExternalStore:fp,useId:jp,unstable_isNewReconciler:!1};function qn(t,e){if(t&&t.defaultProps){e=bt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function ju(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:bt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Va={isMounted:function(t){return(t=t._reactInternals)?jo(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=ln(),o=Vr(t),s=xr(r,o);s.payload=e,n!=null&&(s.callback=n),e=zr(t,s,o),e!==null&&(Xn(e,t,o,r),ta(e,t,o))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=ln(),o=Vr(t),s=xr(r,o);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=zr(t,s,o),e!==null&&(Xn(e,t,o,r),ta(e,t,o))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=ln(),r=Vr(t),o=xr(n,r);o.tag=2,e!=null&&(o.callback=e),e=zr(t,o,r),e!==null&&(Xn(e,t,r,n),ta(e,t,r))}};function Vd(t,e,n,r,o,s,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,i):e.prototype&&e.prototype.isPureReactComponent?!ni(n,r)||!ni(o,s):!0}function Dp(t,e,n){var r=!1,o=Hr,s=e.contextType;return typeof s=="object"&&s!==null?s=zn(s):(o=wn(e)?vo:Zt.current,r=e.contextTypes,s=(r=r!=null)?is(t,o):Hr),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Va,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=o,t.__reactInternalMemoizedMaskedChildContext=s),e}function Gd(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Va.enqueueReplaceState(e,e.state,null)}function Cu(t,e,n,r){var o=t.stateNode;o.props=n,o.state=t.memoizedState,o.refs={},Dc(t);var s=e.contextType;typeof s=="object"&&s!==null?o.context=zn(s):(s=wn(e)?vo:Zt.current,o.context=is(t,s)),o.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(ju(t,e,s,n),o.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(e=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),e!==o.state&&Va.enqueueReplaceState(o,o.state,null),_a(t,n,o,r),o.state=t.memoizedState),typeof o.componentDidMount=="function"&&(t.flags|=4194308)}function cs(t,e){try{var n="",r=e;do n+=dg(r),r=r.return;while(r);var o=n}catch(s){o=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:o,digest:null}}function Dl(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Ru(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var M0=typeof WeakMap=="function"?WeakMap:Map;function Ap(t,e,n){n=xr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Ra||(Ra=!0,Mu=r),Ru(t,e)},n}function Op(t,e,n){n=xr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var o=e.value;n.payload=function(){return r(o)},n.callback=function(){Ru(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Ru(t,e),typeof r!="function"&&(Wr===null?Wr=new Set([this]):Wr.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),n}function qd(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new M0;var o=new Set;r.set(e,o)}else o=r.get(e),o===void 0&&(o=new Set,r.set(e,o));o.has(n)||(o.add(n),t=X0.bind(null,t,e,n),e.then(t,t))}function Hd(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Kd(t,e,n,r,o){return t.mode&1?(t.flags|=65536,t.lanes=o,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=xr(-1,1),e.tag=2,zr(n,e,1))),n.lanes|=1),t)}var B0=Er.ReactCurrentOwner,xn=!1;function sn(t,e,n,r){e.child=t===null?ap(e,null,n,r):ls(e,t.child,n,r)}function Jd(t,e,n,r,o){n=n.render;var s=e.ref;return rs(e,o),r=Lc(t,e,n,r,s,o),n=Ic(),t!==null&&!xn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~o,_r(t,e,o)):(pt&&n&&_c(e),e.flags|=1,sn(t,e,r,o),e.child)}function Yd(t,e,n,r,o){if(t===null){var s=n.type;return typeof s=="function"&&!qc(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,Tp(t,e,s,r,o)):(t=aa(n.type,null,r,e,e.mode,o),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&o)){var i=s.memoizedProps;if(n=n.compare,n=n!==null?n:ni,n(i,r)&&t.ref===e.ref)return _r(t,e,o)}return e.flags|=1,t=Gr(s,r),t.ref=e.ref,t.return=e,e.child=t}function Tp(t,e,n,r,o){if(t!==null){var s=t.memoizedProps;if(ni(s,r)&&t.ref===e.ref)if(xn=!1,e.pendingProps=r=s,(t.lanes&o)!==0)t.flags&131072&&(xn=!0);else return e.lanes=t.lanes,_r(t,e,o)}return Nu(t,e,n,r,o)}function Pp(t,e,n){var r=e.pendingProps,o=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ct(Xo,Nn),Nn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ct(Xo,Nn),Nn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,ct(Xo,Nn),Nn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,ct(Xo,Nn),Nn|=r;return sn(t,e,o,n),e.child}function Lp(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Nu(t,e,n,r,o){var s=wn(n)?vo:Zt.current;return s=is(e,s),rs(e,o),n=Lc(t,e,n,r,s,o),r=Ic(),t!==null&&!xn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~o,_r(t,e,o)):(pt&&r&&_c(e),e.flags|=1,sn(t,e,n,o),e.child)}function Qd(t,e,n,r,o){if(wn(n)){var s=!0;va(e)}else s=!1;if(rs(e,o),e.stateNode===null)oa(t,e),Dp(e,n,r),Cu(e,n,r,o),r=!0;else if(t===null){var i=e.stateNode,l=e.memoizedProps;i.props=l;var u=i.context,c=n.contextType;typeof c=="object"&&c!==null?c=zn(c):(c=wn(n)?vo:Zt.current,c=is(e,c));var d=n.getDerivedStateFromProps,p=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";p||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==r||u!==c)&&Gd(e,i,r,c),Or=!1;var h=e.memoizedState;i.state=h,_a(e,r,i,o),u=e.memoizedState,l!==r||h!==u||bn.current||Or?(typeof d=="function"&&(ju(e,n,d,r),u=e.memoizedState),(l=Or||Vd(e,n,l,r,h,u,c))?(p||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),i.props=r,i.state=u,i.context=c,r=l):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{i=e.stateNode,up(t,e),l=e.memoizedProps,c=e.type===e.elementType?l:qn(e.type,l),i.props=c,p=e.pendingProps,h=i.context,u=n.contextType,typeof u=="object"&&u!==null?u=zn(u):(u=wn(n)?vo:Zt.current,u=is(e,u));var y=n.getDerivedStateFromProps;(d=typeof y=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==p||h!==u)&&Gd(e,i,r,u),Or=!1,h=e.memoizedState,i.state=h,_a(e,r,i,o);var b=e.memoizedState;l!==p||h!==b||bn.current||Or?(typeof y=="function"&&(ju(e,n,y,r),b=e.memoizedState),(c=Or||Vd(e,n,c,r,h,b,u)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,b,u),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,b,u)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||l===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=b),i.props=r,i.state=b,i.context=u,r=c):(typeof i.componentDidUpdate!="function"||l===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return Du(t,e,n,r,s,o)}function Du(t,e,n,r,o,s){Lp(t,e);var i=(e.flags&128)!==0;if(!r&&!i)return o&&Id(e,n,!1),_r(t,e,s);r=e.stateNode,B0.current=e;var l=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&i?(e.child=ls(e,t.child,null,s),e.child=ls(e,null,l,s)):sn(t,e,l,s),e.memoizedState=r.state,o&&Id(e,n,!0),e.child}function Ip(t){var e=t.stateNode;e.pendingContext?Ld(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Ld(t,e.context,!1),Ac(t,e.containerInfo)}function Xd(t,e,n,r,o){return as(),Ec(o),e.flags|=256,sn(t,e,n,r),e.child}var Au={dehydrated:null,treeContext:null,retryLane:0};function Ou(t){return{baseLanes:t,cachePool:null,transitions:null}}function $p(t,e,n){var r=e.pendingProps,o=vt.current,s=!1,i=(e.flags&128)!==0,l;if((l=i)||(l=t!==null&&t.memoizedState===null?!1:(o&2)!==0),l?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(o|=1),ct(vt,o&1),t===null)return ku(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=r.children,t=r.fallback,s?(r=e.mode,s=e.child,i={mode:"hidden",children:i},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=Ha(i,r,0,null),t=yo(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Ou(n),e.memoizedState=Au,t):Bc(e,i));if(o=t.memoizedState,o!==null&&(l=o.dehydrated,l!==null))return U0(t,e,i,r,l,o,n);if(s){s=r.fallback,i=e.mode,o=t.child,l=o.sibling;var u={mode:"hidden",children:r.children};return!(i&1)&&e.child!==o?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Gr(o,u),r.subtreeFlags=o.subtreeFlags&14680064),l!==null?s=Gr(l,s):(s=yo(s,i,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,i=t.child.memoizedState,i=i===null?Ou(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=t.childLanes&~n,e.memoizedState=Au,r}return s=t.child,t=s.sibling,r=Gr(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Bc(t,e){return e=Ha({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function $i(t,e,n,r){return r!==null&&Ec(r),ls(e,t.child,null,n),t=Bc(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function U0(t,e,n,r,o,s,i){if(n)return e.flags&256?(e.flags&=-257,r=Dl(Error(G(422))),$i(t,e,i,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,o=e.mode,r=Ha({mode:"visible",children:r.children},o,0,null),s=yo(s,o,i,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&ls(e,t.child,null,i),e.child.memoizedState=Ou(i),e.memoizedState=Au,s);if(!(e.mode&1))return $i(t,e,i,null);if(o.data==="$!"){if(r=o.nextSibling&&o.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error(G(419)),r=Dl(s,r,void 0),$i(t,e,i,r)}if(l=(i&t.childLanes)!==0,xn||l){if(r=Vt,r!==null){switch(i&-i){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(r.suspendedLanes|i)?0:o,o!==0&&o!==s.retryLane&&(s.retryLane=o,Sr(t,o),Xn(r,t,o,-1))}return Gc(),r=Dl(Error(G(421))),$i(t,e,i,r)}return o.data==="$?"?(e.flags|=128,e.child=t.child,e=Z0.bind(null,t),o._reactRetry=e,null):(t=s.treeContext,Dn=Fr(o.nextSibling),An=e,pt=!0,Jn=null,t!==null&&($n[Mn++]=gr,$n[Mn++]=yr,$n[Mn++]=xo,gr=t.id,yr=t.overflow,xo=e),e=Bc(e,r.children),e.flags|=4096,e)}function Zd(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Eu(t.return,e,n)}function Al(t,e,n,r,o){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=o)}function Mp(t,e,n){var r=e.pendingProps,o=r.revealOrder,s=r.tail;if(sn(t,e,r.children,n),r=vt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Zd(t,n,e);else if(t.tag===19)Zd(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ct(vt,r),!(e.mode&1))e.memoizedState=null;else switch(o){case"forwards":for(n=e.child,o=null;n!==null;)t=n.alternate,t!==null&&ka(t)===null&&(o=n),n=n.sibling;n=o,n===null?(o=e.child,e.child=null):(o=n.sibling,n.sibling=null),Al(e,!1,o,n,s);break;case"backwards":for(n=null,o=e.child,e.child=null;o!==null;){if(t=o.alternate,t!==null&&ka(t)===null){e.child=o;break}t=o.sibling,o.sibling=n,n=o,o=t}Al(e,!0,n,null,s);break;case"together":Al(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function oa(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function _r(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),wo|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(G(153));if(e.child!==null){for(t=e.child,n=Gr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Gr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function F0(t,e,n){switch(e.tag){case 3:Ip(e),as();break;case 5:cp(e);break;case 1:wn(e.type)&&va(e);break;case 4:Ac(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,o=e.memoizedProps.value;ct(wa,r._currentValue),r._currentValue=o;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ct(vt,vt.current&1),e.flags|=128,null):n&e.child.childLanes?$p(t,e,n):(ct(vt,vt.current&1),t=_r(t,e,n),t!==null?t.sibling:null);ct(vt,vt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Mp(t,e,n);e.flags|=128}if(o=e.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),ct(vt,vt.current),r)break;return null;case 22:case 23:return e.lanes=0,Pp(t,e,n)}return _r(t,e,n)}var Bp,Tu,Up,Fp;Bp=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Tu=function(){};Up=function(t,e,n,r){var o=t.memoizedProps;if(o!==r){t=e.stateNode,po(dr.current);var s=null;switch(n){case"input":o=tu(t,o),r=tu(t,r),s=[];break;case"select":o=bt({},o,{value:void 0}),r=bt({},r,{value:void 0}),s=[];break;case"textarea":o=ou(t,o),r=ou(t,r),s=[];break;default:typeof o.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=ga)}iu(n,r);var i;n=null;for(c in o)if(!r.hasOwnProperty(c)&&o.hasOwnProperty(c)&&o[c]!=null)if(c==="style"){var l=o[c];for(i in l)l.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Js.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var u=r[c];if(l=o!=null?o[c]:void 0,r.hasOwnProperty(c)&&u!==l&&(u!=null||l!=null))if(c==="style")if(l){for(i in l)!l.hasOwnProperty(i)||u&&u.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in u)u.hasOwnProperty(i)&&l[i]!==u[i]&&(n||(n={}),n[i]=u[i])}else n||(s||(s=[]),s.push(c,n)),n=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(s=s||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(s=s||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Js.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&dt("scroll",t),s||l===u||(s=[])):(s=s||[]).push(c,u))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};Fp=function(t,e,n,r){n!==r&&(e.flags|=4)};function Cs(t,e){if(!pt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Qt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var o=t.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags&14680064,r|=o.flags&14680064,o.return=t,o=o.sibling;else for(o=t.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=t,o=o.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function z0(t,e,n){var r=e.pendingProps;switch(kc(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qt(e),null;case 1:return wn(e.type)&&ya(),Qt(e),null;case 3:return r=e.stateNode,us(),ft(bn),ft(Zt),Tc(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Li(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Jn!==null&&(Fu(Jn),Jn=null))),Tu(t,e),Qt(e),null;case 5:Oc(e);var o=po(ai.current);if(n=e.type,t!==null&&e.stateNode!=null)Up(t,e,n,r,o),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(G(166));return Qt(e),null}if(t=po(dr.current),Li(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[lr]=e,r[si]=s,t=(e.mode&1)!==0,n){case"dialog":dt("cancel",r),dt("close",r);break;case"iframe":case"object":case"embed":dt("load",r);break;case"video":case"audio":for(o=0;o<Ps.length;o++)dt(Ps[o],r);break;case"source":dt("error",r);break;case"img":case"image":case"link":dt("error",r),dt("load",r);break;case"details":dt("toggle",r);break;case"input":ld(r,s),dt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},dt("invalid",r);break;case"textarea":cd(r,s),dt("invalid",r)}iu(n,s),o=null;for(var i in s)if(s.hasOwnProperty(i)){var l=s[i];i==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&Pi(r.textContent,l,t),o=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&Pi(r.textContent,l,t),o=["children",""+l]):Js.hasOwnProperty(i)&&l!=null&&i==="onScroll"&&dt("scroll",r)}switch(n){case"input":ji(r),ud(r,s,!0);break;case"textarea":ji(r),dd(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=ga)}r=o,e.updateQueue=r,r!==null&&(e.flags|=4)}else{i=o.nodeType===9?o:o.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=mh(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=i.createElement(n,{is:r.is}):(t=i.createElement(n),n==="select"&&(i=t,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):t=i.createElementNS(t,n),t[lr]=e,t[si]=r,Bp(t,e,!1,!1),e.stateNode=t;e:{switch(i=au(n,r),n){case"dialog":dt("cancel",t),dt("close",t),o=r;break;case"iframe":case"object":case"embed":dt("load",t),o=r;break;case"video":case"audio":for(o=0;o<Ps.length;o++)dt(Ps[o],t);o=r;break;case"source":dt("error",t),o=r;break;case"img":case"image":case"link":dt("error",t),dt("load",t),o=r;break;case"details":dt("toggle",t),o=r;break;case"input":ld(t,r),o=tu(t,r),dt("invalid",t);break;case"option":o=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},o=bt({},r,{value:void 0}),dt("invalid",t);break;case"textarea":cd(t,r),o=ou(t,r),dt("invalid",t);break;default:o=r}iu(n,o),l=o;for(s in l)if(l.hasOwnProperty(s)){var u=l[s];s==="style"?vh(t,u):s==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&gh(t,u)):s==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Ys(t,u):typeof u=="number"&&Ys(t,""+u):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Js.hasOwnProperty(s)?u!=null&&s==="onScroll"&&dt("scroll",t):u!=null&&uc(t,s,u,i))}switch(n){case"input":ji(t),ud(t,r,!1);break;case"textarea":ji(t),dd(t);break;case"option":r.value!=null&&t.setAttribute("value",""+qr(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Zo(t,!!r.multiple,s,!1):r.defaultValue!=null&&Zo(t,!!r.multiple,r.defaultValue,!0);break;default:typeof o.onClick=="function"&&(t.onclick=ga)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Qt(e),null;case 6:if(t&&e.stateNode!=null)Fp(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(G(166));if(n=po(ai.current),po(dr.current),Li(e)){if(r=e.stateNode,n=e.memoizedProps,r[lr]=e,(s=r.nodeValue!==n)&&(t=An,t!==null))switch(t.tag){case 3:Pi(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Pi(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[lr]=e,e.stateNode=r}return Qt(e),null;case 13:if(ft(vt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(pt&&Dn!==null&&e.mode&1&&!(e.flags&128))sp(),as(),e.flags|=98560,s=!1;else if(s=Li(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(G(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(G(317));s[lr]=e}else as(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Qt(e),s=!1}else Jn!==null&&(Fu(Jn),Jn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||vt.current&1?Bt===0&&(Bt=3):Gc())),e.updateQueue!==null&&(e.flags|=4),Qt(e),null);case 4:return us(),Tu(t,e),t===null&&ri(e.stateNode.containerInfo),Qt(e),null;case 10:return Rc(e.type._context),Qt(e),null;case 17:return wn(e.type)&&ya(),Qt(e),null;case 19:if(ft(vt),s=e.memoizedState,s===null)return Qt(e),null;if(r=(e.flags&128)!==0,i=s.rendering,i===null)if(r)Cs(s,!1);else{if(Bt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=ka(t),i!==null){for(e.flags|=128,Cs(s,!1),r=i.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,t=i.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ct(vt,vt.current&1|2),e.child}t=t.sibling}s.tail!==null&&Ct()>ds&&(e.flags|=128,r=!0,Cs(s,!1),e.lanes=4194304)}else{if(!r)if(t=ka(i),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Cs(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!pt)return Qt(e),null}else 2*Ct()-s.renderingStartTime>ds&&n!==1073741824&&(e.flags|=128,r=!0,Cs(s,!1),e.lanes=4194304);s.isBackwards?(i.sibling=e.child,e.child=i):(n=s.last,n!==null?n.sibling=i:e.child=i,s.last=i)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Ct(),e.sibling=null,n=vt.current,ct(vt,r?n&1|2:n&1),e):(Qt(e),null);case 22:case 23:return Vc(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Nn&1073741824&&(Qt(e),e.subtreeFlags&6&&(e.flags|=8192)):Qt(e),null;case 24:return null;case 25:return null}throw Error(G(156,e.tag))}function W0(t,e){switch(kc(e),e.tag){case 1:return wn(e.type)&&ya(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return us(),ft(bn),ft(Zt),Tc(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Oc(e),null;case 13:if(ft(vt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(G(340));as()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ft(vt),null;case 4:return us(),null;case 10:return Rc(e.type._context),null;case 22:case 23:return Vc(),null;case 24:return null;default:return null}}var Mi=!1,Xt=!1,V0=typeof WeakSet=="function"?WeakSet:Set,ae=null;function Qo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Et(t,e,r)}else n.current=null}function Pu(t,e,n){try{n()}catch(r){Et(t,e,r)}}var ef=!1;function G0(t,e){if(yu=ha,t=qh(),Sc(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var o=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var i=0,l=-1,u=-1,c=0,d=0,p=t,h=null;t:for(;;){for(var y;p!==n||o!==0&&p.nodeType!==3||(l=i+o),p!==s||r!==0&&p.nodeType!==3||(u=i+r),p.nodeType===3&&(i+=p.nodeValue.length),(y=p.firstChild)!==null;)h=p,p=y;for(;;){if(p===t)break t;if(h===n&&++c===o&&(l=i),h===s&&++d===r&&(u=i),(y=p.nextSibling)!==null)break;p=h,h=p.parentNode}p=y}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(vu={focusedElem:t,selectionRange:n},ha=!1,ae=e;ae!==null;)if(e=ae,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ae=t;else for(;ae!==null;){e=ae;try{var b=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var v=b.memoizedProps,S=b.memoizedState,g=e.stateNode,f=g.getSnapshotBeforeUpdate(e.elementType===e.type?v:qn(e.type,v),S);g.__reactInternalSnapshotBeforeUpdate=f}break;case 3:var m=e.stateNode.containerInfo;m.nodeType===1?m.textContent="":m.nodeType===9&&m.documentElement&&m.removeChild(m.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(G(163))}}catch(w){Et(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,ae=t;break}ae=e.return}return b=ef,ef=!1,b}function zs(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&t)===t){var s=o.destroy;o.destroy=void 0,s!==void 0&&Pu(e,n,s)}o=o.next}while(o!==r)}}function Ga(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Lu(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function zp(t){var e=t.alternate;e!==null&&(t.alternate=null,zp(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[lr],delete e[si],delete e[wu],delete e[C0],delete e[R0])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Wp(t){return t.tag===5||t.tag===3||t.tag===4}function tf(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Wp(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Iu(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=ga));else if(r!==4&&(t=t.child,t!==null))for(Iu(t,e,n),t=t.sibling;t!==null;)Iu(t,e,n),t=t.sibling}function $u(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for($u(t,e,n),t=t.sibling;t!==null;)$u(t,e,n),t=t.sibling}var Ht=null,Hn=!1;function Cr(t,e,n){for(n=n.child;n!==null;)Vp(t,e,n),n=n.sibling}function Vp(t,e,n){if(cr&&typeof cr.onCommitFiberUnmount=="function")try{cr.onCommitFiberUnmount($a,n)}catch{}switch(n.tag){case 5:Xt||Qo(n,e);case 6:var r=Ht,o=Hn;Ht=null,Cr(t,e,n),Ht=r,Hn=o,Ht!==null&&(Hn?(t=Ht,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ht.removeChild(n.stateNode));break;case 18:Ht!==null&&(Hn?(t=Ht,n=n.stateNode,t.nodeType===8?kl(t.parentNode,n):t.nodeType===1&&kl(t,n),ei(t)):kl(Ht,n.stateNode));break;case 4:r=Ht,o=Hn,Ht=n.stateNode.containerInfo,Hn=!0,Cr(t,e,n),Ht=r,Hn=o;break;case 0:case 11:case 14:case 15:if(!Xt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){o=r=r.next;do{var s=o,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&Pu(n,e,i),o=o.next}while(o!==r)}Cr(t,e,n);break;case 1:if(!Xt&&(Qo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Et(n,e,l)}Cr(t,e,n);break;case 21:Cr(t,e,n);break;case 22:n.mode&1?(Xt=(r=Xt)||n.memoizedState!==null,Cr(t,e,n),Xt=r):Cr(t,e,n);break;default:Cr(t,e,n)}}function nf(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new V0),e.forEach(function(r){var o=ey.bind(null,t,r);n.has(r)||(n.add(r),r.then(o,o))})}}function Vn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var o=n[r];try{var s=t,i=e,l=i;e:for(;l!==null;){switch(l.tag){case 5:Ht=l.stateNode,Hn=!1;break e;case 3:Ht=l.stateNode.containerInfo,Hn=!0;break e;case 4:Ht=l.stateNode.containerInfo,Hn=!0;break e}l=l.return}if(Ht===null)throw Error(G(160));Vp(s,i,o),Ht=null,Hn=!1;var u=o.alternate;u!==null&&(u.return=null),o.return=null}catch(c){Et(o,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Gp(e,t),e=e.sibling}function Gp(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Vn(e,t),nr(t),r&4){try{zs(3,t,t.return),Ga(3,t)}catch(v){Et(t,t.return,v)}try{zs(5,t,t.return)}catch(v){Et(t,t.return,v)}}break;case 1:Vn(e,t),nr(t),r&512&&n!==null&&Qo(n,n.return);break;case 5:if(Vn(e,t),nr(t),r&512&&n!==null&&Qo(n,n.return),t.flags&32){var o=t.stateNode;try{Ys(o,"")}catch(v){Et(t,t.return,v)}}if(r&4&&(o=t.stateNode,o!=null)){var s=t.memoizedProps,i=n!==null?n.memoizedProps:s,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&hh(o,s),au(l,i);var c=au(l,s);for(i=0;i<u.length;i+=2){var d=u[i],p=u[i+1];d==="style"?vh(o,p):d==="dangerouslySetInnerHTML"?gh(o,p):d==="children"?Ys(o,p):uc(o,d,p,c)}switch(l){case"input":nu(o,s);break;case"textarea":ph(o,s);break;case"select":var h=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!s.multiple;var y=s.value;y!=null?Zo(o,!!s.multiple,y,!1):h!==!!s.multiple&&(s.defaultValue!=null?Zo(o,!!s.multiple,s.defaultValue,!0):Zo(o,!!s.multiple,s.multiple?[]:"",!1))}o[si]=s}catch(v){Et(t,t.return,v)}}break;case 6:if(Vn(e,t),nr(t),r&4){if(t.stateNode===null)throw Error(G(162));o=t.stateNode,s=t.memoizedProps;try{o.nodeValue=s}catch(v){Et(t,t.return,v)}}break;case 3:if(Vn(e,t),nr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{ei(e.containerInfo)}catch(v){Et(t,t.return,v)}break;case 4:Vn(e,t),nr(t);break;case 13:Vn(e,t),nr(t),o=t.child,o.flags&8192&&(s=o.memoizedState!==null,o.stateNode.isHidden=s,!s||o.alternate!==null&&o.alternate.memoizedState!==null||(zc=Ct())),r&4&&nf(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(Xt=(c=Xt)||d,Vn(e,t),Xt=c):Vn(e,t),nr(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!d&&t.mode&1)for(ae=t,d=t.child;d!==null;){for(p=ae=d;ae!==null;){switch(h=ae,y=h.child,h.tag){case 0:case 11:case 14:case 15:zs(4,h,h.return);break;case 1:Qo(h,h.return);var b=h.stateNode;if(typeof b.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,b.props=e.memoizedProps,b.state=e.memoizedState,b.componentWillUnmount()}catch(v){Et(r,n,v)}}break;case 5:Qo(h,h.return);break;case 22:if(h.memoizedState!==null){of(p);continue}}y!==null?(y.return=h,ae=y):of(p)}d=d.sibling}e:for(d=null,p=t;;){if(p.tag===5){if(d===null){d=p;try{o=p.stateNode,c?(s=o.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=p.stateNode,u=p.memoizedProps.style,i=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=yh("display",i))}catch(v){Et(t,t.return,v)}}}else if(p.tag===6){if(d===null)try{p.stateNode.nodeValue=c?"":p.memoizedProps}catch(v){Et(t,t.return,v)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;d===p&&(d=null),p=p.return}d===p&&(d=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Vn(e,t),nr(t),r&4&&nf(t);break;case 21:break;default:Vn(e,t),nr(t)}}function nr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Wp(n)){var r=n;break e}n=n.return}throw Error(G(160))}switch(r.tag){case 5:var o=r.stateNode;r.flags&32&&(Ys(o,""),r.flags&=-33);var s=tf(t);$u(t,s,o);break;case 3:case 4:var i=r.stateNode.containerInfo,l=tf(t);Iu(t,l,i);break;default:throw Error(G(161))}}catch(u){Et(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function q0(t,e,n){ae=t,qp(t)}function qp(t,e,n){for(var r=(t.mode&1)!==0;ae!==null;){var o=ae,s=o.child;if(o.tag===22&&r){var i=o.memoizedState!==null||Mi;if(!i){var l=o.alternate,u=l!==null&&l.memoizedState!==null||Xt;l=Mi;var c=Xt;if(Mi=i,(Xt=u)&&!c)for(ae=o;ae!==null;)i=ae,u=i.child,i.tag===22&&i.memoizedState!==null?sf(o):u!==null?(u.return=i,ae=u):sf(o);for(;s!==null;)ae=s,qp(s),s=s.sibling;ae=o,Mi=l,Xt=c}rf(t)}else o.subtreeFlags&8772&&s!==null?(s.return=o,ae=s):rf(t)}}function rf(t){for(;ae!==null;){var e=ae;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Xt||Ga(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Xt)if(n===null)r.componentDidMount();else{var o=e.elementType===e.type?n.memoizedProps:qn(e.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Fd(e,s,r);break;case 3:var i=e.updateQueue;if(i!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Fd(e,i,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var p=d.dehydrated;p!==null&&ei(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(G(163))}Xt||e.flags&512&&Lu(e)}catch(h){Et(e,e.return,h)}}if(e===t){ae=null;break}if(n=e.sibling,n!==null){n.return=e.return,ae=n;break}ae=e.return}}function of(t){for(;ae!==null;){var e=ae;if(e===t){ae=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ae=n;break}ae=e.return}}function sf(t){for(;ae!==null;){var e=ae;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Ga(4,e)}catch(u){Et(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var o=e.return;try{r.componentDidMount()}catch(u){Et(e,o,u)}}var s=e.return;try{Lu(e)}catch(u){Et(e,s,u)}break;case 5:var i=e.return;try{Lu(e)}catch(u){Et(e,i,u)}}}catch(u){Et(e,e.return,u)}if(e===t){ae=null;break}var l=e.sibling;if(l!==null){l.return=e.return,ae=l;break}ae=e.return}}var H0=Math.ceil,Ca=Er.ReactCurrentDispatcher,Uc=Er.ReactCurrentOwner,Un=Er.ReactCurrentBatchConfig,ze=0,Vt=null,Tt=null,Kt=0,Nn=0,Xo=Jr(0),Bt=0,di=null,wo=0,qa=0,Fc=0,Ws=null,yn=null,zc=0,ds=1/0,hr=null,Ra=!1,Mu=null,Wr=null,Bi=!1,$r=null,Na=0,Vs=0,Bu=null,sa=-1,ia=0;function ln(){return ze&6?Ct():sa!==-1?sa:sa=Ct()}function Vr(t){return t.mode&1?ze&2&&Kt!==0?Kt&-Kt:D0.transition!==null?(ia===0&&(ia=Dh()),ia):(t=Ze,t!==0||(t=window.event,t=t===void 0?16:$h(t.type)),t):1}function Xn(t,e,n,r){if(50<Vs)throw Vs=0,Bu=null,Error(G(185));pi(t,n,r),(!(ze&2)||t!==Vt)&&(t===Vt&&(!(ze&2)&&(qa|=n),Bt===4&&Pr(t,Kt)),Sn(t,r),n===1&&ze===0&&!(e.mode&1)&&(ds=Ct()+500,za&&Yr()))}function Sn(t,e){var n=t.callbackNode;Dg(t,e);var r=fa(t,t===Vt?Kt:0);if(r===0)n!==null&&pd(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&pd(n),e===1)t.tag===0?N0(af.bind(null,t)):np(af.bind(null,t)),E0(function(){!(ze&6)&&Yr()}),n=null;else{switch(Ah(r)){case 1:n=pc;break;case 4:n=Rh;break;case 16:n=da;break;case 536870912:n=Nh;break;default:n=da}n=em(n,Hp.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Hp(t,e){if(sa=-1,ia=0,ze&6)throw Error(G(327));var n=t.callbackNode;if(os()&&t.callbackNode!==n)return null;var r=fa(t,t===Vt?Kt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Da(t,r);else{e=r;var o=ze;ze|=2;var s=Jp();(Vt!==t||Kt!==e)&&(hr=null,ds=Ct()+500,go(t,e));do try{Y0();break}catch(l){Kp(t,l)}while(!0);Cc(),Ca.current=s,ze=o,Tt!==null?e=0:(Vt=null,Kt=0,e=Bt)}if(e!==0){if(e===2&&(o=fu(t),o!==0&&(r=o,e=Uu(t,o))),e===1)throw n=di,go(t,0),Pr(t,r),Sn(t,Ct()),n;if(e===6)Pr(t,r);else{if(o=t.current.alternate,!(r&30)&&!K0(o)&&(e=Da(t,r),e===2&&(s=fu(t),s!==0&&(r=s,e=Uu(t,s))),e===1))throw n=di,go(t,0),Pr(t,r),Sn(t,Ct()),n;switch(t.finishedWork=o,t.finishedLanes=r,e){case 0:case 1:throw Error(G(345));case 2:lo(t,yn,hr);break;case 3:if(Pr(t,r),(r&130023424)===r&&(e=zc+500-Ct(),10<e)){if(fa(t,0)!==0)break;if(o=t.suspendedLanes,(o&r)!==r){ln(),t.pingedLanes|=t.suspendedLanes&o;break}t.timeoutHandle=bu(lo.bind(null,t,yn,hr),e);break}lo(t,yn,hr);break;case 4:if(Pr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,o=-1;0<r;){var i=31-Qn(r);s=1<<i,i=e[i],i>o&&(o=i),r&=~s}if(r=o,r=Ct()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*H0(r/1960))-r,10<r){t.timeoutHandle=bu(lo.bind(null,t,yn,hr),r);break}lo(t,yn,hr);break;case 5:lo(t,yn,hr);break;default:throw Error(G(329))}}}return Sn(t,Ct()),t.callbackNode===n?Hp.bind(null,t):null}function Uu(t,e){var n=Ws;return t.current.memoizedState.isDehydrated&&(go(t,e).flags|=256),t=Da(t,e),t!==2&&(e=yn,yn=n,e!==null&&Fu(e)),t}function Fu(t){yn===null?yn=t:yn.push.apply(yn,t)}function K0(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var o=n[r],s=o.getSnapshot;o=o.value;try{if(!Zn(s(),o))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Pr(t,e){for(e&=~Fc,e&=~qa,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Qn(e),r=1<<n;t[n]=-1,e&=~r}}function af(t){if(ze&6)throw Error(G(327));os();var e=fa(t,0);if(!(e&1))return Sn(t,Ct()),null;var n=Da(t,e);if(t.tag!==0&&n===2){var r=fu(t);r!==0&&(e=r,n=Uu(t,r))}if(n===1)throw n=di,go(t,0),Pr(t,e),Sn(t,Ct()),n;if(n===6)throw Error(G(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,lo(t,yn,hr),Sn(t,Ct()),null}function Wc(t,e){var n=ze;ze|=1;try{return t(e)}finally{ze=n,ze===0&&(ds=Ct()+500,za&&Yr())}}function So(t){$r!==null&&$r.tag===0&&!(ze&6)&&os();var e=ze;ze|=1;var n=Un.transition,r=Ze;try{if(Un.transition=null,Ze=1,t)return t()}finally{Ze=r,Un.transition=n,ze=e,!(ze&6)&&Yr()}}function Vc(){Nn=Xo.current,ft(Xo)}function go(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,k0(n)),Tt!==null)for(n=Tt.return;n!==null;){var r=n;switch(kc(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ya();break;case 3:us(),ft(bn),ft(Zt),Tc();break;case 5:Oc(r);break;case 4:us();break;case 13:ft(vt);break;case 19:ft(vt);break;case 10:Rc(r.type._context);break;case 22:case 23:Vc()}n=n.return}if(Vt=t,Tt=t=Gr(t.current,null),Kt=Nn=e,Bt=0,di=null,Fc=qa=wo=0,yn=Ws=null,ho!==null){for(e=0;e<ho.length;e++)if(n=ho[e],r=n.interleaved,r!==null){n.interleaved=null;var o=r.next,s=n.pending;if(s!==null){var i=s.next;s.next=o,r.next=i}n.pending=r}ho=null}return t}function Kp(t,e){do{var n=Tt;try{if(Cc(),na.current=ja,Ea){for(var r=xt.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}Ea=!1}if(bo=0,Wt=Mt=xt=null,Fs=!1,li=0,Uc.current=null,n===null||n.return===null){Bt=1,di=e,Tt=null;break}e:{var s=t,i=n.return,l=n,u=e;if(e=Kt,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,d=l,p=d.tag;if(!(d.mode&1)&&(p===0||p===11||p===15)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var y=Hd(i);if(y!==null){y.flags&=-257,Kd(y,i,l,s,e),y.mode&1&&qd(s,c,e),e=y,u=c;var b=e.updateQueue;if(b===null){var v=new Set;v.add(u),e.updateQueue=v}else b.add(u);break e}else{if(!(e&1)){qd(s,c,e),Gc();break e}u=Error(G(426))}}else if(pt&&l.mode&1){var S=Hd(i);if(S!==null){!(S.flags&65536)&&(S.flags|=256),Kd(S,i,l,s,e),Ec(cs(u,l));break e}}s=u=cs(u,l),Bt!==4&&(Bt=2),Ws===null?Ws=[s]:Ws.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var g=Ap(s,u,e);Ud(s,g);break e;case 1:l=u;var f=s.type,m=s.stateNode;if(!(s.flags&128)&&(typeof f.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Wr===null||!Wr.has(m)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=Op(s,l,e);Ud(s,w);break e}}s=s.return}while(s!==null)}Qp(n)}catch(_){e=_,Tt===n&&n!==null&&(Tt=n=n.return);continue}break}while(!0)}function Jp(){var t=Ca.current;return Ca.current=ja,t===null?ja:t}function Gc(){(Bt===0||Bt===3||Bt===2)&&(Bt=4),Vt===null||!(wo&268435455)&&!(qa&268435455)||Pr(Vt,Kt)}function Da(t,e){var n=ze;ze|=2;var r=Jp();(Vt!==t||Kt!==e)&&(hr=null,go(t,e));do try{J0();break}catch(o){Kp(t,o)}while(!0);if(Cc(),ze=n,Ca.current=r,Tt!==null)throw Error(G(261));return Vt=null,Kt=0,Bt}function J0(){for(;Tt!==null;)Yp(Tt)}function Y0(){for(;Tt!==null&&!wg();)Yp(Tt)}function Yp(t){var e=Zp(t.alternate,t,Nn);t.memoizedProps=t.pendingProps,e===null?Qp(t):Tt=e,Uc.current=null}function Qp(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=W0(n,e),n!==null){n.flags&=32767,Tt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Bt=6,Tt=null;return}}else if(n=z0(n,e,Nn),n!==null){Tt=n;return}if(e=e.sibling,e!==null){Tt=e;return}Tt=e=t}while(e!==null);Bt===0&&(Bt=5)}function lo(t,e,n){var r=Ze,o=Un.transition;try{Un.transition=null,Ze=1,Q0(t,e,n,r)}finally{Un.transition=o,Ze=r}return null}function Q0(t,e,n,r){do os();while($r!==null);if(ze&6)throw Error(G(327));n=t.finishedWork;var o=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(G(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(Ag(t,s),t===Vt&&(Tt=Vt=null,Kt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Bi||(Bi=!0,em(da,function(){return os(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Un.transition,Un.transition=null;var i=Ze;Ze=1;var l=ze;ze|=4,Uc.current=null,G0(t,n),Gp(n,t),y0(vu),ha=!!yu,vu=yu=null,t.current=n,q0(n),Sg(),ze=l,Ze=i,Un.transition=s}else t.current=n;if(Bi&&(Bi=!1,$r=t,Na=o),s=t.pendingLanes,s===0&&(Wr=null),Eg(n.stateNode),Sn(t,Ct()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)o=e[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(Ra)throw Ra=!1,t=Mu,Mu=null,t;return Na&1&&t.tag!==0&&os(),s=t.pendingLanes,s&1?t===Bu?Vs++:(Vs=0,Bu=t):Vs=0,Yr(),null}function os(){if($r!==null){var t=Ah(Na),e=Un.transition,n=Ze;try{if(Un.transition=null,Ze=16>t?16:t,$r===null)var r=!1;else{if(t=$r,$r=null,Na=0,ze&6)throw Error(G(331));var o=ze;for(ze|=4,ae=t.current;ae!==null;){var s=ae,i=s.child;if(ae.flags&16){var l=s.deletions;if(l!==null){for(var u=0;u<l.length;u++){var c=l[u];for(ae=c;ae!==null;){var d=ae;switch(d.tag){case 0:case 11:case 15:zs(8,d,s)}var p=d.child;if(p!==null)p.return=d,ae=p;else for(;ae!==null;){d=ae;var h=d.sibling,y=d.return;if(zp(d),d===c){ae=null;break}if(h!==null){h.return=y,ae=h;break}ae=y}}}var b=s.alternate;if(b!==null){var v=b.child;if(v!==null){b.child=null;do{var S=v.sibling;v.sibling=null,v=S}while(v!==null)}}ae=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,ae=i;else e:for(;ae!==null;){if(s=ae,s.flags&2048)switch(s.tag){case 0:case 11:case 15:zs(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,ae=g;break e}ae=s.return}}var f=t.current;for(ae=f;ae!==null;){i=ae;var m=i.child;if(i.subtreeFlags&2064&&m!==null)m.return=i,ae=m;else e:for(i=f;ae!==null;){if(l=ae,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Ga(9,l)}}catch(_){Et(l,l.return,_)}if(l===i){ae=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,ae=w;break e}ae=l.return}}if(ze=o,Yr(),cr&&typeof cr.onPostCommitFiberRoot=="function")try{cr.onPostCommitFiberRoot($a,t)}catch{}r=!0}return r}finally{Ze=n,Un.transition=e}}return!1}function lf(t,e,n){e=cs(n,e),e=Ap(t,e,1),t=zr(t,e,1),e=ln(),t!==null&&(pi(t,1,e),Sn(t,e))}function Et(t,e,n){if(t.tag===3)lf(t,t,n);else for(;e!==null;){if(e.tag===3){lf(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Wr===null||!Wr.has(r))){t=cs(n,t),t=Op(e,t,1),e=zr(e,t,1),t=ln(),e!==null&&(pi(e,1,t),Sn(e,t));break}}e=e.return}}function X0(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=ln(),t.pingedLanes|=t.suspendedLanes&n,Vt===t&&(Kt&n)===n&&(Bt===4||Bt===3&&(Kt&130023424)===Kt&&500>Ct()-zc?go(t,0):Fc|=n),Sn(t,e)}function Xp(t,e){e===0&&(t.mode&1?(e=Ni,Ni<<=1,!(Ni&130023424)&&(Ni=4194304)):e=1);var n=ln();t=Sr(t,e),t!==null&&(pi(t,e,n),Sn(t,n))}function Z0(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Xp(t,n)}function ey(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,o=t.memoizedState;o!==null&&(n=o.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(G(314))}r!==null&&r.delete(e),Xp(t,n)}var Zp;Zp=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||bn.current)xn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return xn=!1,F0(t,e,n);xn=!!(t.flags&131072)}else xn=!1,pt&&e.flags&1048576&&rp(e,ba,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;oa(t,e),t=e.pendingProps;var o=is(e,Zt.current);rs(e,n),o=Lc(null,e,r,t,o,n);var s=Ic();return e.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,wn(r)?(s=!0,va(e)):s=!1,e.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,Dc(e),o.updater=Va,e.stateNode=o,o._reactInternals=e,Cu(e,r,t,n),e=Du(null,e,r,!0,s,n)):(e.tag=0,pt&&s&&_c(e),sn(null,e,o,n),e=e.child),e;case 16:r=e.elementType;e:{switch(oa(t,e),t=e.pendingProps,o=r._init,r=o(r._payload),e.type=r,o=e.tag=ny(r),t=qn(r,t),o){case 0:e=Nu(null,e,r,t,n);break e;case 1:e=Qd(null,e,r,t,n);break e;case 11:e=Jd(null,e,r,t,n);break e;case 14:e=Yd(null,e,r,qn(r.type,t),n);break e}throw Error(G(306,r,""))}return e;case 0:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:qn(r,o),Nu(t,e,r,o,n);case 1:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:qn(r,o),Qd(t,e,r,o,n);case 3:e:{if(Ip(e),t===null)throw Error(G(387));r=e.pendingProps,s=e.memoizedState,o=s.element,up(t,e),_a(e,r,null,n);var i=e.memoizedState;if(r=i.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){o=cs(Error(G(423)),e),e=Xd(t,e,r,n,o);break e}else if(r!==o){o=cs(Error(G(424)),e),e=Xd(t,e,r,n,o);break e}else for(Dn=Fr(e.stateNode.containerInfo.firstChild),An=e,pt=!0,Jn=null,n=ap(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(as(),r===o){e=_r(t,e,n);break e}sn(t,e,r,n)}e=e.child}return e;case 5:return cp(e),t===null&&ku(e),r=e.type,o=e.pendingProps,s=t!==null?t.memoizedProps:null,i=o.children,xu(r,o)?i=null:s!==null&&xu(r,s)&&(e.flags|=32),Lp(t,e),sn(t,e,i,n),e.child;case 6:return t===null&&ku(e),null;case 13:return $p(t,e,n);case 4:return Ac(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ls(e,null,r,n):sn(t,e,r,n),e.child;case 11:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:qn(r,o),Jd(t,e,r,o,n);case 7:return sn(t,e,e.pendingProps,n),e.child;case 8:return sn(t,e,e.pendingProps.children,n),e.child;case 12:return sn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,o=e.pendingProps,s=e.memoizedProps,i=o.value,ct(wa,r._currentValue),r._currentValue=i,s!==null)if(Zn(s.value,i)){if(s.children===o.children&&!bn.current){e=_r(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){i=s.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(s.tag===1){u=xr(-1,n&-n),u.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}s.lanes|=n,u=s.alternate,u!==null&&(u.lanes|=n),Eu(s.return,n,e),l.lanes|=n;break}u=u.next}}else if(s.tag===10)i=s.type===e.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(G(341));i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),Eu(i,n,e),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===e){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}sn(t,e,o.children,n),e=e.child}return e;case 9:return o=e.type,r=e.pendingProps.children,rs(e,n),o=zn(o),r=r(o),e.flags|=1,sn(t,e,r,n),e.child;case 14:return r=e.type,o=qn(r,e.pendingProps),o=qn(r.type,o),Yd(t,e,r,o,n);case 15:return Tp(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:qn(r,o),oa(t,e),e.tag=1,wn(r)?(t=!0,va(e)):t=!1,rs(e,n),Dp(e,r,o),Cu(e,r,o,n),Du(null,e,r,!0,t,n);case 19:return Mp(t,e,n);case 22:return Pp(t,e,n)}throw Error(G(156,e.tag))};function em(t,e){return Ch(t,e)}function ty(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bn(t,e,n,r){return new ty(t,e,n,r)}function qc(t){return t=t.prototype,!(!t||!t.isReactComponent)}function ny(t){if(typeof t=="function")return qc(t)?1:0;if(t!=null){if(t=t.$$typeof,t===dc)return 11;if(t===fc)return 14}return 2}function Gr(t,e){var n=t.alternate;return n===null?(n=Bn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function aa(t,e,n,r,o,s){var i=2;if(r=t,typeof t=="function")qc(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case zo:return yo(n.children,o,s,e);case cc:i=8,o|=8;break;case Ql:return t=Bn(12,n,e,o|2),t.elementType=Ql,t.lanes=s,t;case Xl:return t=Bn(13,n,e,o),t.elementType=Xl,t.lanes=s,t;case Zl:return t=Bn(19,n,e,o),t.elementType=Zl,t.lanes=s,t;case ch:return Ha(n,o,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case lh:i=10;break e;case uh:i=9;break e;case dc:i=11;break e;case fc:i=14;break e;case Ar:i=16,r=null;break e}throw Error(G(130,t==null?t:typeof t,""))}return e=Bn(i,n,e,o),e.elementType=t,e.type=r,e.lanes=s,e}function yo(t,e,n,r){return t=Bn(7,t,r,e),t.lanes=n,t}function Ha(t,e,n,r){return t=Bn(22,t,r,e),t.elementType=ch,t.lanes=n,t.stateNode={isHidden:!1},t}function Ol(t,e,n){return t=Bn(6,t,null,e),t.lanes=n,t}function Tl(t,e,n){return e=Bn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function ry(t,e,n,r,o){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=hl(0),this.expirationTimes=hl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=hl(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Hc(t,e,n,r,o,s,i,l,u){return t=new ry(t,e,n,l,u),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Bn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Dc(s),t}function oy(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Fo,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function tm(t){if(!t)return Hr;t=t._reactInternals;e:{if(jo(t)!==t||t.tag!==1)throw Error(G(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(wn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(G(171))}if(t.tag===1){var n=t.type;if(wn(n))return tp(t,n,e)}return e}function nm(t,e,n,r,o,s,i,l,u){return t=Hc(n,r,!0,t,o,s,i,l,u),t.context=tm(null),n=t.current,r=ln(),o=Vr(n),s=xr(r,o),s.callback=e??null,zr(n,s,o),t.current.lanes=o,pi(t,o,r),Sn(t,r),t}function Ka(t,e,n,r){var o=e.current,s=ln(),i=Vr(o);return n=tm(n),e.context===null?e.context=n:e.pendingContext=n,e=xr(s,i),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=zr(o,e,i),t!==null&&(Xn(t,o,i,s),ta(t,o,i)),i}function Aa(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function uf(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Kc(t,e){uf(t,e),(t=t.alternate)&&uf(t,e)}function sy(){return null}var rm=typeof reportError=="function"?reportError:function(t){console.error(t)};function Jc(t){this._internalRoot=t}Ja.prototype.render=Jc.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(G(409));Ka(t,e,null,null)};Ja.prototype.unmount=Jc.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;So(function(){Ka(null,t,null,null)}),e[wr]=null}};function Ja(t){this._internalRoot=t}Ja.prototype.unstable_scheduleHydration=function(t){if(t){var e=Ph();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Tr.length&&e!==0&&e<Tr[n].priority;n++);Tr.splice(n,0,t),n===0&&Ih(t)}};function Yc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Ya(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function cf(){}function iy(t,e,n,r,o){if(o){if(typeof r=="function"){var s=r;r=function(){var c=Aa(i);s.call(c)}}var i=nm(e,r,t,0,null,!1,!1,"",cf);return t._reactRootContainer=i,t[wr]=i.current,ri(t.nodeType===8?t.parentNode:t),So(),i}for(;o=t.lastChild;)t.removeChild(o);if(typeof r=="function"){var l=r;r=function(){var c=Aa(u);l.call(c)}}var u=Hc(t,0,!1,null,null,!1,!1,"",cf);return t._reactRootContainer=u,t[wr]=u.current,ri(t.nodeType===8?t.parentNode:t),So(function(){Ka(e,u,n,r)}),u}function Qa(t,e,n,r,o){var s=n._reactRootContainer;if(s){var i=s;if(typeof o=="function"){var l=o;o=function(){var u=Aa(i);l.call(u)}}Ka(e,i,t,o)}else i=iy(n,e,t,o,r);return Aa(i)}Oh=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ts(e.pendingLanes);n!==0&&(mc(e,n|1),Sn(e,Ct()),!(ze&6)&&(ds=Ct()+500,Yr()))}break;case 13:So(function(){var r=Sr(t,1);if(r!==null){var o=ln();Xn(r,t,1,o)}}),Kc(t,1)}};gc=function(t){if(t.tag===13){var e=Sr(t,134217728);if(e!==null){var n=ln();Xn(e,t,134217728,n)}Kc(t,134217728)}};Th=function(t){if(t.tag===13){var e=Vr(t),n=Sr(t,e);if(n!==null){var r=ln();Xn(n,t,e,r)}Kc(t,e)}};Ph=function(){return Ze};Lh=function(t,e){var n=Ze;try{return Ze=t,e()}finally{Ze=n}};uu=function(t,e,n){switch(e){case"input":if(nu(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var o=Fa(r);if(!o)throw Error(G(90));fh(r),nu(r,o)}}}break;case"textarea":ph(t,n);break;case"select":e=n.value,e!=null&&Zo(t,!!n.multiple,e,!1)}};wh=Wc;Sh=So;var ay={usingClientEntryPoint:!1,Events:[gi,qo,Fa,xh,bh,Wc]},Rs={findFiberByHostInstance:fo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ly={bundleType:Rs.bundleType,version:Rs.version,rendererPackageName:Rs.rendererPackageName,rendererConfig:Rs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Er.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Eh(t),t===null?null:t.stateNode},findFiberByHostInstance:Rs.findFiberByHostInstance||sy,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ui=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ui.isDisabled&&Ui.supportsFiber)try{$a=Ui.inject(ly),cr=Ui}catch{}}Tn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ay;Tn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Yc(e))throw Error(G(200));return oy(t,e,null,n)};Tn.createRoot=function(t,e){if(!Yc(t))throw Error(G(299));var n=!1,r="",o=rm;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(o=e.onRecoverableError)),e=Hc(t,1,!1,null,null,n,!1,r,o),t[wr]=e.current,ri(t.nodeType===8?t.parentNode:t),new Jc(e)};Tn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(G(188)):(t=Object.keys(t).join(","),Error(G(268,t)));return t=Eh(e),t=t===null?null:t.stateNode,t};Tn.flushSync=function(t){return So(t)};Tn.hydrate=function(t,e,n){if(!Ya(e))throw Error(G(200));return Qa(null,t,e,!0,n)};Tn.hydrateRoot=function(t,e,n){if(!Yc(t))throw Error(G(405));var r=n!=null&&n.hydratedSources||null,o=!1,s="",i=rm;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),e=nm(e,null,t,1,n??null,o,!1,s,i),t[wr]=e.current,ri(t),r)for(t=0;t<r.length;t++)n=r[t],o=n._getVersion,o=o(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,o]:e.mutableSourceEagerHydrationData.push(n,o);return new Ja(e)};Tn.render=function(t,e,n){if(!Ya(e))throw Error(G(200));return Qa(null,t,e,!1,n)};Tn.unmountComponentAtNode=function(t){if(!Ya(t))throw Error(G(40));return t._reactRootContainer?(So(function(){Qa(null,null,t,!1,function(){t._reactRootContainer=null,t[wr]=null})}),!0):!1};Tn.unstable_batchedUpdates=Wc;Tn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Ya(n))throw Error(G(200));if(t==null||t._reactInternals===void 0)throw Error(G(38));return Qa(t,e,n,!1,r)};Tn.version="18.3.1-next-f1338f8080-20240426";function om(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(om)}catch(t){console.error(t)}}om(),oh.exports=Tn;var uy=oh.exports,df=uy;Jl.createRoot=df.createRoot,Jl.hydrateRoot=df.hydrateRoot;const cy="modulepreload",dy=function(t){return"/"+t},ff={},vi=function(e,n,r){let o=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));o=Promise.allSettled(n.map(u=>{if(u=dy(u),u in ff)return;ff[u]=!0;const c=u.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const p=document.createElement("link");if(p.rel=c?"stylesheet":cy,c||(p.as="script"),p.crossOrigin="",p.href=u,l&&p.setAttribute("nonce",l),document.head.appendChild(p),c)return new Promise((h,y)=>{p.addEventListener("load",h),p.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return o.then(i=>{for(const l of i||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})},fy=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>vi(async()=>{const{default:r}=await Promise.resolve().then(()=>ys);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)};class Qc extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class hy extends Qc{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class hf extends Qc{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class pf extends Qc{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var zu;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(zu||(zu={}));var py=function(t,e,n,r){function o(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function l(d){try{c(r.next(d))}catch(p){i(p)}}function u(d){try{c(r.throw(d))}catch(p){i(p)}}function c(d){d.done?s(d.value):o(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};class my{constructor(e,{headers:n={},customFetch:r,region:o=zu.Any}={}){this.url=e,this.headers=n,this.region=o,this.fetch=fy(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var r;return py(this,void 0,void 0,function*(){try{const{headers:o,method:s,body:i}=n;let l={},{region:u}=n;u||(u=this.region);const c=new URL(`${this.url}/${e}`);u&&u!=="any"&&(l["x-region"]=u,c.searchParams.set("forceFunctionRegion",u));let d;i&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",d=i):typeof i=="string"?(l["Content-Type"]="text/plain",d=i):typeof FormData<"u"&&i instanceof FormData?d=i:(l["Content-Type"]="application/json",d=JSON.stringify(i)));const p=yield this.fetch(c.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),o),body:d}).catch(v=>{throw new hy(v)}),h=p.headers.get("x-relay-error");if(h&&h==="true")throw new hf(p);if(!p.ok)throw new pf(p);let y=((r=p.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),b;return y==="application/json"?b=yield p.json():y==="application/octet-stream"?b=yield p.blob():y==="text/event-stream"?b=p:y==="multipart/form-data"?b=yield p.formData():b=yield p.text(),{data:b,error:null,response:p}}catch(o){return{data:null,error:o,response:o instanceof pf||o instanceof hf?o.context:void 0}}})}}var vn={},Xc={},Xa={},xi={},Za={},el={},gy=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},fs=gy();const yy=fs.fetch,sm=fs.fetch.bind(fs),im=fs.Headers,vy=fs.Request,xy=fs.Response,ys=Object.freeze(Object.defineProperty({__proto__:null,Headers:im,Request:vy,Response:xy,default:sm,fetch:yy},Symbol.toStringTag,{value:"Module"})),by=$m(ys);var tl={};Object.defineProperty(tl,"__esModule",{value:!0});let wy=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};tl.default=wy;var am=Fn&&Fn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(el,"__esModule",{value:!0});const Sy=am(by),_y=am(tl);let ky=class{constructor(e){var n,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(n=e.shouldThrowOnError)!==null&&n!==void 0?n:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Sy.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,n){return this.headers=new Headers(this.headers),this.headers.set(e,n),this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const r=this.fetch;let o=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var i,l,u,c;let d=null,p=null,h=null,y=s.status,b=s.statusText;if(s.ok){if(this.method!=="HEAD"){const f=await s.text();f===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((i=this.headers.get("Accept"))===null||i===void 0)&&i.includes("application/vnd.pgrst.plan+text"))?p=f:p=JSON.parse(f))}const S=(l=this.headers.get("Prefer"))===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),g=(u=s.headers.get("content-range"))===null||u===void 0?void 0:u.split("/");S&&g&&g.length>1&&(h=parseInt(g[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(p)&&(p.length>1?(d={code:"PGRST116",details:`Results contain ${p.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},p=null,h=null,y=406,b="Not Acceptable"):p.length===1?p=p[0]:p=null)}else{const S=await s.text();try{d=JSON.parse(S),Array.isArray(d)&&s.status===404&&(p=[],d=null,y=200,b="OK")}catch{s.status===404&&S===""?(y=204,b="No Content"):d={message:S}}if(d&&this.isMaybeSingle&&(!((c=d==null?void 0:d.details)===null||c===void 0)&&c.includes("0 rows"))&&(d=null,y=200,b="OK"),d&&this.shouldThrowOnError)throw new _y.default(d)}return{error:d,data:p,count:h,status:y,statusText:b}});return this.shouldThrowOnError||(o=o.catch(s=>{var i,l,u;return{error:{message:`${(i=s==null?void 0:s.name)!==null&&i!==void 0?i:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(l=s==null?void 0:s.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(u=s==null?void 0:s.code)!==null&&u!==void 0?u:""}`},data:null,count:null,status:0,statusText:""}})),o.then(e,n)}returns(){return this}overrideTypes(){return this}};el.default=ky;var Ey=Fn&&Fn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Za,"__esModule",{value:!0});const jy=Ey(el);let Cy=class extends jy.default{select(e){let n=!1;const r=(e??"*").split("").map(o=>/\s/.test(o)&&!n?"":(o==='"'&&(n=!n),o)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:n=!0,nullsFirst:r,foreignTable:o,referencedTable:s=o}={}){const i=s?`${s}.order`:"order",l=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${l?`${l},`:""}${e}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:r=n}={}){const o=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(o,`${e}`),this}range(e,n,{foreignTable:r,referencedTable:o=r}={}){const s=typeof o>"u"?"offset":`${o}.offset`,i=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(i,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:n=!1,settings:r=!1,buffers:o=!1,wal:s=!1,format:i="text"}={}){var l;const u=[e?"analyze":null,n?"verbose":null,r?"settings":null,o?"buffers":null,s?"wal":null].filter(Boolean).join("|"),c=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${c}"; options=${u};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};Za.default=Cy;var Ry=Fn&&Fn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(xi,"__esModule",{value:!0});const Ny=Ry(Za);let Dy=class extends Ny.default{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const r=Array.from(new Set(n)).map(o=>typeof o=="string"&&new RegExp("[,()]").test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:r,type:o}={}){let s="";o==="plain"?s="pl":o==="phrase"?s="ph":o==="websearch"&&(s="w");const i=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${s}fts${i}.${n}`),this}match(e){return Object.entries(e).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(e,n,r){return this.url.searchParams.append(e,`not.${n}.${r}`),this}or(e,{foreignTable:n,referencedTable:r=n}={}){const o=r?`${r}.or`:"or";return this.url.searchParams.append(o,`(${e})`),this}filter(e,n,r){return this.url.searchParams.append(e,`${n}.${r}`),this}};xi.default=Dy;var Ay=Fn&&Fn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Xa,"__esModule",{value:!0});const Ns=Ay(xi);let Oy=class{constructor(e,{headers:n={},schema:r,fetch:o}){this.url=e,this.headers=new Headers(n),this.schema=r,this.fetch=o}select(e,{head:n=!1,count:r}={}){const o=n?"HEAD":"GET";let s=!1;const i=(e??"*").split("").map(l=>/\s/.test(l)&&!s?"":(l==='"'&&(s=!s),l)).join("");return this.url.searchParams.set("select",i),r&&this.headers.append("Prefer",`count=${r}`),new Ns.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:n,defaultToNull:r=!0}={}){var o;const s="POST";if(n&&this.headers.append("Prefer",`count=${n}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const i=e.reduce((l,u)=>l.concat(Object.keys(u)),[]);if(i.length>0){const l=[...new Set(i)].map(u=>`"${u}"`);this.url.searchParams.set("columns",l.join(","))}}return new Ns.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}upsert(e,{onConflict:n,ignoreDuplicates:r=!1,count:o,defaultToNull:s=!0}={}){var i;const l="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),n!==void 0&&this.url.searchParams.set("on_conflict",n),o&&this.headers.append("Prefer",`count=${o}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const u=e.reduce((c,d)=>c.concat(Object.keys(d)),[]);if(u.length>0){const c=[...new Set(u)].map(d=>`"${d}"`);this.url.searchParams.set("columns",c.join(","))}}return new Ns.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(e,{count:n}={}){var r;const o="PATCH";return n&&this.headers.append("Prefer",`count=${n}`),new Ns.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var n;const r="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new Ns.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}};Xa.default=Oy;var lm=Fn&&Fn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Xc,"__esModule",{value:!0});const Ty=lm(Xa),Py=lm(xi);let Ly=class um{constructor(e,{headers:n={},schema:r,fetch:o}={}){this.url=e,this.headers=new Headers(n),this.schemaName=r,this.fetch=o}from(e){const n=new URL(`${this.url}/${e}`);return new Ty.default(n,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new um(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:r=!1,get:o=!1,count:s}={}){var i;let l;const u=new URL(`${this.url}/rpc/${e}`);let c;r||o?(l=r?"HEAD":"GET",Object.entries(n).filter(([p,h])=>h!==void 0).map(([p,h])=>[p,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([p,h])=>{u.searchParams.append(p,h)})):(l="POST",c=n);const d=new Headers(this.headers);return s&&d.set("Prefer",`count=${s}`),new Py.default({method:l,url:u,headers:d,schema:this.schemaName,body:c,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};Xc.default=Ly;var vs=Fn&&Fn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(vn,"__esModule",{value:!0});vn.PostgrestError=vn.PostgrestBuilder=vn.PostgrestTransformBuilder=vn.PostgrestFilterBuilder=vn.PostgrestQueryBuilder=vn.PostgrestClient=void 0;const cm=vs(Xc);vn.PostgrestClient=cm.default;const dm=vs(Xa);vn.PostgrestQueryBuilder=dm.default;const fm=vs(xi);vn.PostgrestFilterBuilder=fm.default;const hm=vs(Za);vn.PostgrestTransformBuilder=hm.default;const pm=vs(el);vn.PostgrestBuilder=pm.default;const mm=vs(tl);vn.PostgrestError=mm.default;var Iy=vn.default={PostgrestClient:cm.default,PostgrestQueryBuilder:dm.default,PostgrestFilterBuilder:fm.default,PostgrestTransformBuilder:hm.default,PostgrestBuilder:pm.default,PostgrestError:mm.default};const{PostgrestClient:$y,PostgrestQueryBuilder:zb,PostgrestFilterBuilder:Wb,PostgrestTransformBuilder:Vb,PostgrestBuilder:Gb,PostgrestError:qb}=Iy;class My{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const r=n.node,o=parseInt(r.replace(/^v/,"").split(".")[0]);return o>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${o} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${o} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const r=this.getWebSocketConstructor();return new r(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const By="2.15.5",Uy=`realtime-js/${By}`,Fy="1.0.0",Wu=1e4,zy=1e3,Wy=100;var Gs;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Gs||(Gs={}));var It;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(It||(It={}));var Kn;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Kn||(Kn={}));var Vu;(function(t){t.websocket="websocket"})(Vu||(Vu={}));var co;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(co||(co={}));class Vy{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const o=n.getUint8(1),s=n.getUint8(2);let i=this.HEADER_LENGTH+2;const l=r.decode(e.slice(i,i+o));i=i+o;const u=r.decode(e.slice(i,i+s));i=i+s;const c=JSON.parse(r.decode(e.slice(i,e.byteLength)));return{ref:null,topic:l,event:u,payload:c}}}class gm{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ut;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(ut||(ut={}));const mf=(t,e,n={})=>{var r;const o=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((s,i)=>(s[i]=Gy(i,t,e,o),s),{})},Gy=(t,e,n,r)=>{const o=e.find(l=>l.name===t),s=o==null?void 0:o.type,i=n[t];return s&&!r.includes(s)?ym(s,i):Gu(i)},ym=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return Jy(e,n)}switch(t){case ut.bool:return qy(e);case ut.float4:case ut.float8:case ut.int2:case ut.int4:case ut.int8:case ut.numeric:case ut.oid:return Hy(e);case ut.json:case ut.jsonb:return Ky(e);case ut.timestamp:return Yy(e);case ut.abstime:case ut.date:case ut.daterange:case ut.int4range:case ut.int8range:case ut.money:case ut.reltime:case ut.text:case ut.time:case ut.timestamptz:case ut.timetz:case ut.tsrange:case ut.tstzrange:return Gu(e);default:return Gu(e)}},Gu=t=>t,qy=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Hy=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Ky=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},Jy=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let s;const i=t.slice(1,n);try{s=JSON.parse("["+i+"]")}catch{s=i?i.split(","):[]}return s.map(l=>ym(e,l))}return t},Yy=t=>typeof t=="string"?t.replace(" ","T"):t,vm=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class Pl{constructor(e,n,r={},o=Wu){this.channel=e,this.event=n,this.payload=r,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var gf;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(gf||(gf={}));class qs{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},o=>{const{onJoin:s,onLeave:i,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=qs.syncState(this.state,o,s,i),this.pendingDiffs.forEach(u=>{this.state=qs.syncDiff(this.state,u,s,i)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},o=>{const{onJoin:s,onLeave:i,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(o):(this.state=qs.syncDiff(this.state,o,s,i),l())}),this.onJoin((o,s,i)=>{this.channel._trigger("presence",{event:"join",key:o,currentPresences:s,newPresences:i})}),this.onLeave((o,s,i)=>{this.channel._trigger("presence",{event:"leave",key:o,currentPresences:s,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,o){const s=this.cloneDeep(e),i=this.transformState(n),l={},u={};return this.map(s,(c,d)=>{i[c]||(u[c]=d)}),this.map(i,(c,d)=>{const p=s[c];if(p){const h=d.map(S=>S.presence_ref),y=p.map(S=>S.presence_ref),b=d.filter(S=>y.indexOf(S.presence_ref)<0),v=p.filter(S=>h.indexOf(S.presence_ref)<0);b.length>0&&(l[c]=b),v.length>0&&(u[c]=v)}else l[c]=d}),this.syncDiff(s,{joins:l,leaves:u},r,o)}static syncDiff(e,n,r,o){const{joins:s,leaves:i}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),o||(o=()=>{}),this.map(s,(l,u)=>{var c;const d=(c=e[l])!==null&&c!==void 0?c:[];if(e[l]=this.cloneDeep(u),d.length>0){const p=e[l].map(y=>y.presence_ref),h=d.filter(y=>p.indexOf(y.presence_ref)<0);e[l].unshift(...h)}r(l,d,u)}),this.map(i,(l,u)=>{let c=e[l];if(!c)return;const d=u.map(p=>p.presence_ref);c=c.filter(p=>d.indexOf(p.presence_ref)<0),e[l]=c,o(l,c,u),c.length===0&&delete e[l]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const o=e[r];return"metas"in o?n[r]=o.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):n[r]=o,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var yf;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(yf||(yf={}));var Hs;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Hs||(Hs={}));var pr;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(pr||(pr={}));class Zc{constructor(e,n={config:{}},r){this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=It.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Pl(this,Kn.join,this.params,this.timeout),this.rejoinTimer=new gm(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=It.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=It.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=It.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=It.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=It.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Kn.reply,{},(o,s)=>{this._trigger(this._replyEventName(s),o)}),this.presence=new qs(this),this.broadcastEndpointURL=vm(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var r,o,s;if(this.socket.isConnected()||this.socket.connect(),this.state==It.closed){const{config:{broadcast:i,presence:l,private:u}}=this.params,c=(o=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(y=>y.filter))!==null&&o!==void 0?o:[],d=!!this.bindings[Hs.PRESENCE]&&this.bindings[Hs.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,p={},h={broadcast:i,presence:Object.assign(Object.assign({},l),{enabled:d}),postgres_changes:c,private:u};this.socket.accessTokenValue&&(p.access_token=this.socket.accessTokenValue),this._onError(y=>e==null?void 0:e(pr.CHANNEL_ERROR,y)),this._onClose(()=>e==null?void 0:e(pr.CLOSED)),this.updateJoinPayload(Object.assign({config:h},p)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:y})=>{var b;if(this.socket.setAuth(),y===void 0){e==null||e(pr.SUBSCRIBED);return}else{const v=this.bindings.postgres_changes,S=(b=v==null?void 0:v.length)!==null&&b!==void 0?b:0,g=[];for(let f=0;f<S;f++){const m=v[f],{filter:{event:w,schema:_,table:R,filter:D}}=m,k=y&&y[f];if(k&&k.event===w&&k.schema===_&&k.table===R&&k.filter===D)g.push(Object.assign(Object.assign({},m),{id:k.id}));else{this.unsubscribe(),this.state=It.errored,e==null||e(pr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,e&&e(pr.SUBSCRIBED);return}}).receive("error",y=>{this.state=It.errored,e==null||e(pr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(y).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(pr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this.state===It.joined&&e===Hs.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,n,r)}async send(e,n={}){var r,o;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:i}=e,u={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((o=c.body)===null||o===void 0?void 0:o.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var i,l,u;const c=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((u=(l=(i=this.params)===null||i===void 0?void 0:i.config)===null||l===void 0?void 0:l.broadcast)===null||u===void 0)&&u.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=It.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Kn.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(o=>{r=new Pl(this,Kn.leave,{},e),r.receive("ok",()=>{n(),o("ok")}).receive("timeout",()=>{n(),o("timed out")}).receive("error",()=>{o("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=It.closed,this.bindings={}}async _fetchWithTimeout(e,n,r){const o=new AbortController,s=setTimeout(()=>o.abort(),r),i=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:o.signal}));return clearTimeout(s),i}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new Pl(this,e,n,r);return this._canPush()?o.send():this._addToPushBuffer(o),o}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Wy){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var o,s;const i=e.toLocaleLowerCase(),{close:l,error:u,leave:c,join:d}=Kn;if(r&&[l,u,c,d].indexOf(i)>=0&&r!==this._joinRef())return;let h=this._onMessage(i,n,r);if(n&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(o=this.bindings.postgres_changes)===null||o===void 0||o.filter(y=>{var b,v,S;return((b=y.filter)===null||b===void 0?void 0:b.event)==="*"||((S=(v=y.filter)===null||v===void 0?void 0:v.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===i}).map(y=>y.callback(h,r)):(s=this.bindings[i])===null||s===void 0||s.filter(y=>{var b,v,S,g,f,m;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in y){const w=y.id,_=(b=y.filter)===null||b===void 0?void 0:b.event;return w&&((v=n.ids)===null||v===void 0?void 0:v.includes(w))&&(_==="*"||(_==null?void 0:_.toLocaleLowerCase())===((S=n.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))}else{const w=(f=(g=y==null?void 0:y.filter)===null||g===void 0?void 0:g.event)===null||f===void 0?void 0:f.toLocaleLowerCase();return w==="*"||w===((m=n==null?void 0:n.event)===null||m===void 0?void 0:m.toLocaleLowerCase())}else return y.type.toLocaleLowerCase()===i}).map(y=>{if(typeof h=="object"&&"ids"in h){const b=h.data,{schema:v,table:S,commit_timestamp:g,type:f,errors:m}=b;h=Object.assign(Object.assign({},{schema:v,table:S,commit_timestamp:g,eventType:f,new:{},old:{},errors:m}),this._getPayloadRecords(b))}y.callback(h,r)})}_isClosed(){return this.state===It.closed}_isJoined(){return this.state===It.joined}_isJoining(){return this.state===It.joining}_isLeaving(){return this.state===It.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const o=e.toLocaleLowerCase(),s={type:o,filter:n,callback:r};return this.bindings[o]?this.bindings[o].push(s):this.bindings[o]=[s],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(o=>{var s;return!(((s=o.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===r&&Zc.isEqual(o.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Kn.close,{},e)}_onError(e){this._on(Kn.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=It.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=mf(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=mf(e.columns,e.old_record)),n}}const Ll=()=>{},Fi={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Qy=[1e3,2e3,5e3,1e4],Xy=1e4,Zy=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class ev{constructor(e,n){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Wu,this.transport=null,this.heartbeatIntervalMs=Fi.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ll,this.ref=0,this.reconnectTimer=null,this.logger=Ll,this.conn=null,this.sendBuffer=[],this.serializer=new Vy,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=o=>{let s;return o?s=o:typeof fetch>"u"?s=(...i)=>vi(async()=>{const{default:l}=await Promise.resolve().then(()=>ys);return{default:l}},void 0).then(({default:l})=>l(...i)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):s=fetch,(...i)=>s(...i)},!(!((r=n==null?void 0:n.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${Vu.websocket}`,this.httpEndpoint=vm(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=My.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Fy}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Gs.connecting:return co.Connecting;case Gs.open:return co.Open;case Gs.closing:return co.Closing;default:return co.Closed}}isConnected(){return this.connectionState()===co.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const r=`realtime:${e}`,o=this.getChannels().find(s=>s.topic===r);if(o)return o;{const s=new Zc(`realtime:${e}`,n,this);return this.channels.push(s),s}}push(e){const{topic:n,event:r,payload:o,ref:s}=e,i=()=>{this.encode(e,l=>{var u;(u=this.conn)===null||u===void 0||u.send(l)})};this.log("push",`${n} ${r} (${s})`,o),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(zy,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},Fi.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:o,payload:s,ref:i}=n,l=i?`(${i})`:"",u=s.status||"";this.log("receive",`${u} ${r} ${o} ${l}`.trim(),s),this.channels.filter(c=>c._isMember(r)).forEach(c=>c._trigger(o,s,i)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Kn.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",o=new URLSearchParams(n);return`${e}${r}${o}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([Zy],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n;e?n=e:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const o={access_token:n,version:Uy};n&&r.updateJoinPayload(o),r.joinedOnce&&r._isJoined()&&r._push(Kn.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(n)}catch(o){this.log("error",`error in ${e} callback`,o)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new gm(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Fi.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,r,o,s,i,l,u,c,d;if(this.transport=(n=e==null?void 0:e.transport)!==null&&n!==void 0?n:null,this.timeout=(r=e==null?void 0:e.timeout)!==null&&r!==void 0?r:Wu,this.heartbeatIntervalMs=(o=e==null?void 0:e.heartbeatIntervalMs)!==null&&o!==void 0?o:Fi.HEARTBEAT_INTERVAL,this.worker=(s=e==null?void 0:e.worker)!==null&&s!==void 0?s:!1,this.accessToken=(i=e==null?void 0:e.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(l=e==null?void 0:e.heartbeatCallback)!==null&&l!==void 0?l:Ll,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=e==null?void 0:e.reconnectAfterMs)!==null&&u!==void 0?u:p=>Qy[p-1]||Xy,this.encode=(c=e==null?void 0:e.encode)!==null&&c!==void 0?c:(p,h)=>h(JSON.stringify(p)),this.decode=(d=e==null?void 0:e.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class ed extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function $t(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class tv extends ed{constructor(e,n,r){super(e),this.name="StorageApiError",this.status=n,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class qu extends ed{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var nv=function(t,e,n,r){function o(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function l(d){try{c(r.next(d))}catch(p){i(p)}}function u(d){try{c(r.throw(d))}catch(p){i(p)}}function c(d){d.done?s(d.value):o(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};const xm=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>vi(async()=>{const{default:r}=await Promise.resolve().then(()=>ys);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},rv=()=>nv(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield vi(()=>Promise.resolve().then(()=>ys),void 0)).Response:Response}),Hu=t=>{if(Array.isArray(t))return t.map(n=>Hu(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const o=n.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[o]=Hu(r)}),e},ov=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var Co=function(t,e,n,r){function o(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function l(d){try{c(r.next(d))}catch(p){i(p)}}function u(d){try{c(r.throw(d))}catch(p){i(p)}}function c(d){d.done?s(d.value):o(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};const Il=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),sv=(t,e,n)=>Co(void 0,void 0,void 0,function*(){const r=yield rv();t instanceof r&&!(n!=null&&n.noResolveJson)?t.json().then(o=>{const s=t.status||500,i=(o==null?void 0:o.statusCode)||s+"";e(new tv(Il(o),s,i))}).catch(o=>{e(new qu(Il(o),o))}):e(new qu(Il(t),t))}),iv=(t,e,n,r)=>{const o={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!r?o:(ov(r)?(o.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),o.body=JSON.stringify(r)):o.body=r,e!=null&&e.duplex&&(o.duplex=e.duplex),Object.assign(Object.assign({},o),n))};function bi(t,e,n,r,o,s){return Co(this,void 0,void 0,function*(){return new Promise((i,l)=>{t(n,iv(e,r,o,s)).then(u=>{if(!u.ok)throw u;return r!=null&&r.noResolveJson?u:u.json()}).then(u=>i(u)).catch(u=>sv(u,l,r))})})}function Oa(t,e,n,r){return Co(this,void 0,void 0,function*(){return bi(t,"GET",e,n,r)})}function sr(t,e,n,r,o){return Co(this,void 0,void 0,function*(){return bi(t,"POST",e,r,o,n)})}function Ku(t,e,n,r,o){return Co(this,void 0,void 0,function*(){return bi(t,"PUT",e,r,o,n)})}function av(t,e,n,r){return Co(this,void 0,void 0,function*(){return bi(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function bm(t,e,n,r,o){return Co(this,void 0,void 0,function*(){return bi(t,"DELETE",e,r,o,n)})}var rn=function(t,e,n,r){function o(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function l(d){try{c(r.next(d))}catch(p){i(p)}}function u(d){try{c(r.throw(d))}catch(p){i(p)}}function c(d){d.done?s(d.value):o(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};const lv={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},vf={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class uv{constructor(e,n={},r,o){this.shouldThrowOnError=!1,this.url=e,this.headers=n,this.bucketId=r,this.fetch=xm(o)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,n,r,o){return rn(this,void 0,void 0,function*(){try{let s;const i=Object.assign(Object.assign({},vf),o);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(i.upsert)});const u=i.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),u&&s.append("metadata",this.encodeMetadata(u)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.append("cacheControl",i.cacheControl),u&&s.append("metadata",this.encodeMetadata(u))):(s=r,l["cache-control"]=`max-age=${i.cacheControl}`,l["content-type"]=i.contentType,u&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(u)))),o!=null&&o.headers&&(l=Object.assign(Object.assign({},l),o.headers));const c=this._removeEmptyFolders(n),d=this._getFinalPath(c),p=yield(e=="PUT"?Ku:sr)(this.fetch,`${this.url}/object/${d}`,s,Object.assign({headers:l},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:c,id:p.Id,fullPath:p.Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if($t(s))return{data:null,error:s};throw s}})}upload(e,n,r){return rn(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,o){return rn(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),i=this._getFinalPath(s),l=new URL(this.url+`/object/upload/sign/${i}`);l.searchParams.set("token",n);try{let u;const c=Object.assign({upsert:vf.upsert},o),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&r instanceof Blob?(u=new FormData,u.append("cacheControl",c.cacheControl),u.append("",r)):typeof FormData<"u"&&r instanceof FormData?(u=r,u.append("cacheControl",c.cacheControl)):(u=r,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType);const p=yield Ku(this.fetch,l.toString(),u,{headers:d});return{data:{path:s,fullPath:p.Key},error:null}}catch(u){if(this.shouldThrowOnError)throw u;if($t(u))return{data:null,error:u};throw u}})}createSignedUploadUrl(e,n){return rn(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const o=Object.assign({},this.headers);n!=null&&n.upsert&&(o["x-upsert"]="true");const s=yield sr(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:o}),i=new URL(this.url+s.url),l=i.searchParams.get("token");if(!l)throw new ed("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:l},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if($t(r))return{data:null,error:r};throw r}})}update(e,n,r){return rn(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return rn(this,void 0,void 0,function*(){try{return{data:yield sr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if($t(o))return{data:null,error:o};throw o}})}copy(e,n,r){return rn(this,void 0,void 0,function*(){try{return{data:{path:(yield sr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if($t(o))return{data:null,error:o};throw o}})}createSignedUrl(e,n,r){return rn(this,void 0,void 0,function*(){try{let o=this._getFinalPath(e),s=yield sr(this.fetch,`${this.url}/object/sign/${o}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${i}`)},{data:s,error:null}}catch(o){if(this.shouldThrowOnError)throw o;if($t(o))return{data:null,error:o};throw o}})}createSignedUrls(e,n,r){return rn(this,void 0,void 0,function*(){try{const o=yield sr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:o.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${s}`):null})),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if($t(o))return{data:null,error:o};throw o}})}download(e,n){return rn(this,void 0,void 0,function*(){const o=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),i=s?`?${s}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield Oa(this.fetch,`${this.url}/${o}/${l}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if($t(l))return{data:null,error:l};throw l}})}info(e){return rn(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const r=yield Oa(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Hu(r),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if($t(r))return{data:null,error:r};throw r}})}exists(e){return rn(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield av(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if($t(r)&&r instanceof qu){const o=r.originalError;if([400,404].includes(o==null?void 0:o.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,n){const r=this._getFinalPath(e),o=[],s=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";s!==""&&o.push(s);const l=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",u=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});u!==""&&o.push(u);let c=o.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${c}`)}}}remove(e){return rn(this,void 0,void 0,function*(){try{return{data:yield bm(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if($t(n))return{data:null,error:n};throw n}})}list(e,n,r){return rn(this,void 0,void 0,function*(){try{const o=Object.assign(Object.assign(Object.assign({},lv),n),{prefix:e||""});return{data:yield sr(this.fetch,`${this.url}/object/list/${this.bucketId}`,o,{headers:this.headers},r),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if($t(o))return{data:null,error:o};throw o}})}listV2(e,n){return rn(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield sr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},n),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if($t(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const cv="2.12.1",dv={"X-Client-Info":`storage-js/${cv}`};var To=function(t,e,n,r){function o(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function l(d){try{c(r.next(d))}catch(p){i(p)}}function u(d){try{c(r.throw(d))}catch(p){i(p)}}function c(d){d.done?s(d.value):o(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};class fv{constructor(e,n={},r,o){this.shouldThrowOnError=!1;const s=new URL(e);o!=null&&o.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href,this.headers=Object.assign(Object.assign({},dv),n),this.fetch=xm(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return To(this,void 0,void 0,function*(){try{return{data:yield Oa(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if($t(e))return{data:null,error:e};throw e}})}getBucket(e){return To(this,void 0,void 0,function*(){try{return{data:yield Oa(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if($t(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return To(this,void 0,void 0,function*(){try{return{data:yield sr(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if($t(r))return{data:null,error:r};throw r}})}updateBucket(e,n){return To(this,void 0,void 0,function*(){try{return{data:yield Ku(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if($t(r))return{data:null,error:r};throw r}})}emptyBucket(e){return To(this,void 0,void 0,function*(){try{return{data:yield sr(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if($t(n))return{data:null,error:n};throw n}})}deleteBucket(e){return To(this,void 0,void 0,function*(){try{return{data:yield bm(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if($t(n))return{data:null,error:n};throw n}})}}class hv extends fv{constructor(e,n={},r,o){super(e,n,r,o)}from(e){return new uv(this.url,this.headers,e,this.fetch)}}const pv="2.57.4";let Ls="";typeof Deno<"u"?Ls="deno":typeof document<"u"?Ls="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ls="react-native":Ls="node";const mv={"X-Client-Info":`supabase-js-${Ls}/${pv}`},gv={headers:mv},yv={schema:"public"},vv={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},xv={};var bv=function(t,e,n,r){function o(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function l(d){try{c(r.next(d))}catch(p){i(p)}}function u(d){try{c(r.throw(d))}catch(p){i(p)}}function c(d){d.done?s(d.value):o(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};const wv=t=>{let e;return t?e=t:typeof fetch>"u"?e=sm:e=fetch,(...n)=>e(...n)},Sv=()=>typeof Headers>"u"?im:Headers,_v=(t,e,n)=>{const r=wv(n),o=Sv();return(s,i)=>bv(void 0,void 0,void 0,function*(){var l;const u=(l=yield e())!==null&&l!==void 0?l:t;let c=new o(i==null?void 0:i.headers);return c.has("apikey")||c.set("apikey",t),c.has("Authorization")||c.set("Authorization",`Bearer ${u}`),r(s,Object.assign(Object.assign({},i),{headers:c}))})};var kv=function(t,e,n,r){function o(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function l(d){try{c(r.next(d))}catch(p){i(p)}}function u(d){try{c(r.throw(d))}catch(p){i(p)}}function c(d){d.done?s(d.value):o(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};function Ev(t){return t.endsWith("/")?t:t+"/"}function jv(t,e){var n,r;const{db:o,auth:s,realtime:i,global:l}=t,{db:u,auth:c,realtime:d,global:p}=e,h={db:Object.assign(Object.assign({},u),o),auth:Object.assign(Object.assign({},c),s),realtime:Object.assign(Object.assign({},d),i),storage:{},global:Object.assign(Object.assign(Object.assign({},p),l),{headers:Object.assign(Object.assign({},(n=p==null?void 0:p.headers)!==null&&n!==void 0?n:{}),(r=l==null?void 0:l.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>kv(this,void 0,void 0,function*(){return""})};return t.accessToken?h.accessToken=t.accessToken:delete h.accessToken,h}function Cv(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Ev(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const wm="2.71.1",Mo=30*1e3,Ju=3,$l=Ju*Mo,Rv="http://localhost:9999",Nv="supabase.auth.token",Dv={"X-Client-Info":`gotrue-js/${wm}`},Yu="X-Supabase-Api-Version",Sm={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Av=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Ov=10*60*1e3;class td extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function Ce(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class Tv extends td{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function Pv(t){return Ce(t)&&t.name==="AuthApiError"}class _m extends td{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Qr extends td{constructor(e,n,r,o){super(e,r,o),this.name=n,this.status=r}}class Dr extends Qr{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Lv(t){return Ce(t)&&t.name==="AuthSessionMissingError"}class zi extends Qr{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Wi extends Qr{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Vi extends Qr{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Iv(t){return Ce(t)&&t.name==="AuthImplicitGrantRedirectError"}class xf extends Qr{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Qu extends Qr{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function Ml(t){return Ce(t)&&t.name==="AuthRetryableFetchError"}class bf extends Qr{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class Xu extends Qr{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ta="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),wf=` 	
\r=`.split(""),$v=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<wf.length;e+=1)t[wf[e].charCodeAt(0)]=-2;for(let e=0;e<Ta.length;e+=1)t[Ta[e].charCodeAt(0)]=e;return t})();function Sf(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(Ta[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(Ta[r]),e.queuedBits-=6}}function km(t,e,n){const r=$v[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function _f(t){const e=[],n=i=>{e.push(String.fromCodePoint(i))},r={utf8seq:0,codepoint:0},o={queue:0,queuedBits:0},s=i=>{Uv(i,r,n)};for(let i=0;i<t.length;i+=1)km(t.charCodeAt(i),o,s);return e.join("")}function Mv(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function Bv(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const o=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|o)+65536,n+=1}Mv(r,e)}}function Uv(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if(!(t>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function Fv(t){const e=[],n={queue:0,queuedBits:0},r=o=>{e.push(o)};for(let o=0;o<t.length;o+=1)km(t.charCodeAt(o),n,r);return new Uint8Array(e)}function zv(t){const e=[];return Bv(t,n=>e.push(n)),new Uint8Array(e)}function Wv(t){const e=[],n={queue:0,queuedBits:0},r=o=>{e.push(o)};return t.forEach(o=>Sf(o,n,r)),Sf(null,n,r),e.join("")}function Vv(t){return Math.round(Date.now()/1e3)+t}function Gv(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Gn=()=>typeof window<"u"&&typeof document<"u",so={tested:!1,writable:!1},Em=()=>{if(!Gn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(so.tested)return so.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),so.tested=!0,so.writable=!0}catch{so.tested=!0,so.writable=!1}return so.writable};function qv(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((o,s)=>{e[s]=o})}catch{}return n.searchParams.forEach((r,o)=>{e[o]=r}),e}const jm=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>vi(async()=>{const{default:r}=await Promise.resolve().then(()=>ys);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},Hv=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",Bo=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},io=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Rr=async(t,e)=>{await t.removeItem(e)};class nl{constructor(){this.promise=new nl.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}nl.promiseConstructor=Promise;function Bl(t){const e=t.split(".");if(e.length!==3)throw new Xu("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!Av.test(e[r]))throw new Xu("JWT not in base64url format");return{header:JSON.parse(_f(e[0])),payload:JSON.parse(_f(e[1])),signature:Fv(e[2]),raw:{header:e[0],payload:e[1]}}}async function Kv(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function Jv(t,e){return new Promise((r,o)=>{(async()=>{for(let s=0;s<1/0;s++)try{const i=await t(s);if(!e(s,null,i)){r(i);return}}catch(i){if(!e(s,i)){o(i);return}}})()})}function Yv(t){return("0"+t.toString(16)).substr(-2)}function Qv(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let o="";for(let s=0;s<56;s++)o+=n.charAt(Math.floor(Math.random()*r));return o}return crypto.getRandomValues(e),Array.from(e,Yv).join("")}async function Xv(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),o=new Uint8Array(r);return Array.from(o).map(s=>String.fromCharCode(s)).join("")}async function Zv(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await Xv(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Po(t,e,n=!1){const r=Qv();let o=r;n&&(o+="/PASSWORD_RECOVERY"),await Bo(t,`${e}-code-verifier`,o);const s=await Zv(r);return[s,r===s?"plain":"s256"]}const ex=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function tx(t){const e=t.headers.get(Yu);if(!e||!e.match(ex))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function nx(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function rx(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const ox=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Lo(t){if(!ox.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Ul(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function kf(t){return JSON.parse(JSON.stringify(t))}var sx=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const uo=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),ix=[502,503,504];async function Ef(t){var e;if(!Hv(t))throw new Qu(uo(t),0);if(ix.includes(t.status))throw new Qu(uo(t),t.status);let n;try{n=await t.json()}catch(s){throw new _m(uo(s),s)}let r;const o=tx(t);if(o&&o.getTime()>=Sm["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new bf(uo(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new Dr}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((s,i)=>s&&typeof i=="string",!0))throw new bf(uo(n),t.status,n.weak_password.reasons);throw new Tv(uo(n),t.status||500,r)}const ax=(t,e,n,r)=>{const o={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),o.body=JSON.stringify(r),Object.assign(Object.assign({},o),n))};async function Le(t,e,n,r){var o;const s=Object.assign({},r==null?void 0:r.headers);s[Yu]||(s[Yu]=Sm["2024-01-01"].name),r!=null&&r.jwt&&(s.Authorization=`Bearer ${r.jwt}`);const i=(o=r==null?void 0:r.query)!==null&&o!==void 0?o:{};r!=null&&r.redirectTo&&(i.redirect_to=r.redirectTo);const l=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",u=await lx(t,e,n+l,{headers:s,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(u):{data:Object.assign({},u),error:null}}async function lx(t,e,n,r,o,s){const i=ax(e,r,o,s);let l;try{l=await t(n,Object.assign({},i))}catch(u){throw console.error(u),new Qu(uo(u),0)}if(l.ok||await Ef(l),r!=null&&r.noResolveJson)return l;try{return await l.json()}catch(u){await Ef(u)}}function fr(t){var e;let n=null;fx(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=Vv(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function jf(t){const e=fr(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Lr(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function ux(t){return{data:t,error:null}}function cx(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:o,verification_type:s}=t,i=sx(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:n,hashed_token:r,redirect_to:o,verification_type:s},u=Object.assign({},i);return{data:{properties:l,user:u},error:null}}function dx(t){return t}function fx(t){return t.access_token&&t.refresh_token&&t.expires_in}const Fl=["global","local","others"];var hx=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};class px{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=jm(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n=Fl[0]){if(Fl.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Fl.join(", ")}`);try{return await Le(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Ce(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await Le(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Lr})}catch(r){if(Ce(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=hx(e,["options"]),o=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(o.new_email=r==null?void 0:r.newEmail,delete o.newEmail),await Le(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:o,headers:this.headers,xform:cx,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(Ce(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await Le(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Lr})}catch(n){if(Ce(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,o,s,i,l,u;try{const c={nextPage:null,lastPage:0,total:0},d=await Le(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(s=(o=e==null?void 0:e.perPage)===null||o===void 0?void 0:o.toString())!==null&&s!==void 0?s:""},xform:dx});if(d.error)throw d.error;const p=await d.json(),h=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,y=(u=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&u!==void 0?u:[];return y.length>0&&(y.forEach(b=>{const v=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(b.split(";")[1].split("=")[1]);c[`${S}Page`]=v}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},p),c),error:null}}catch(c){if(Ce(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){Lo(e);try{return await Le(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Lr})}catch(n){if(Ce(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){Lo(e);try{return await Le(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Lr})}catch(r){if(Ce(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){Lo(e);try{return await Le(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Lr})}catch(r){if(Ce(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Lo(e.userId);try{const{data:n,error:r}=await Le(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:o=>({data:{factors:o},error:null})});return{data:n,error:r}}catch(n){if(Ce(n))return{data:null,error:n};throw n}}async _deleteFactor(e){Lo(e.userId),Lo(e.id);try{return{data:await Le(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(Ce(n))return{data:null,error:n};throw n}}}function Cf(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function mx(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Io={debug:!!(globalThis&&Em()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Cm extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class gx extends Cm{}async function yx(t,e,n){Io.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Io.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async o=>{if(o){Io.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,o.name);try{return await n()}finally{Io.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,o.name)}}else{if(e===0)throw Io.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new gx(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Io.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}mx();const vx={url:Rv,storageKey:Nv,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Dv,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Rf(t,e,n){return await n()}const $o={};class fi{constructor(e){var n,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=fi.nextInstanceID,fi.nextInstanceID+=1,this.instanceID>0&&Gn()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const o=Object.assign(Object.assign({},vx),e);if(this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.persistSession=o.persistSession,this.storageKey=o.storageKey,this.autoRefreshToken=o.autoRefreshToken,this.admin=new px({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=jm(o.fetch),this.lock=o.lock||Rf,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,o.lock?this.lock=o.lock:Gn()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=yx:this.lock=Rf,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:Em()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Cf(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=Cf(this.memoryStorage)),Gn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}get jwks(){var e,n;return(n=(e=$o[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){$o[this.storageKey]=Object.assign(Object.assign({},$o[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=$o[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){$o[this.storageKey]=Object.assign(Object.assign({},$o[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${wm}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=qv(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),Gn()&&this.detectSessionInUrl&&r!=="none"){const{data:o,error:s}=await this._getSessionFromURL(n,r);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),Iv(s)){const u=(e=s.details)===null||e===void 0?void 0:e.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:i,redirectType:l}=o;return this._debug("#_initialize()","detected session in URL",i,"redirect type",l),await this._saveSession(i),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Ce(n)?{error:n}:{error:new _m("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,o;try{const s=await Le(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(o=e==null?void 0:e.options)===null||o===void 0?void 0:o.captchaToken}},xform:fr}),{data:i,error:l}=s;if(l||!i)return{data:{user:null,session:null},error:l};const u=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(s){if(Ce(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var n,r,o;try{let s;if("email"in e){const{email:d,password:p,options:h}=e;let y=null,b=null;this.flowType==="pkce"&&([y,b]=await Po(this.storage,this.storageKey)),s=await Le(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:d,password:p,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:y,code_challenge_method:b},xform:fr})}else if("phone"in e){const{phone:d,password:p,options:h}=e;s=await Le(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:p,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},channel:(o=h==null?void 0:h.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:fr})}else throw new Wi("You must provide either an email or phone number and a password");const{data:i,error:l}=s;if(l||!i)return{data:{user:null,session:null},error:l};const u=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(s){if(Ce(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let n;if("email"in e){const{email:s,password:i,options:l}=e;n=await Le(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:jf})}else if("phone"in e){const{phone:s,password:i,options:l}=e;n=await Le(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:jf})}else throw new Wi("You must provide either an email or phone number and a password");const{data:r,error:o}=n;return o?{data:{user:null,session:null},error:o}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new zi}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:o})}catch(n){if(Ce(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,r,o,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(o=e.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;if(n==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(e){var n,r,o,s,i,l,u,c,d,p,h,y;let b,v;if("message"in e)b=e.message,v=e.signature;else{const{chain:S,wallet:g,statement:f,options:m}=e;let w;if(Gn())if(typeof g=="object")w=g;else{const R=window;if("solana"in R&&typeof R.solana=="object"&&("signIn"in R.solana&&typeof R.solana.signIn=="function"||"signMessage"in R.solana&&typeof R.solana.signMessage=="function"))w=R.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!(m!=null&&m.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=g}const _=new URL((n=m==null?void 0:m.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in w&&w.signIn){const R=await w.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},m==null?void 0:m.signInWithSolana),{version:"1",domain:_.host,uri:_.href}),f?{statement:f}:null));let D;if(Array.isArray(R)&&R[0]&&typeof R[0]=="object")D=R[0];else if(R&&typeof R=="object"&&"signedMessage"in R&&"signature"in R)D=R;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in D&&"signature"in D&&(typeof D.signedMessage=="string"||D.signedMessage instanceof Uint8Array)&&D.signature instanceof Uint8Array)b=typeof D.signedMessage=="string"?D.signedMessage:new TextDecoder().decode(D.signedMessage),v=D.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in w)||typeof w.signMessage!="function"||!("publicKey"in w)||typeof w!="object"||!w.publicKey||!("toBase58"in w.publicKey)||typeof w.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");b=[`${_.host} wants you to sign in with your Solana account:`,w.publicKey.toBase58(),...f?["",f,""]:[""],"Version: 1",`URI: ${_.href}`,`Issued At: ${(o=(r=m==null?void 0:m.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&o!==void 0?o:new Date().toISOString()}`,...!((s=m==null?void 0:m.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${m.signInWithSolana.notBefore}`]:[],...!((i=m==null?void 0:m.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${m.signInWithSolana.expirationTime}`]:[],...!((l=m==null?void 0:m.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${m.signInWithSolana.chainId}`]:[],...!((u=m==null?void 0:m.signInWithSolana)===null||u===void 0)&&u.nonce?[`Nonce: ${m.signInWithSolana.nonce}`]:[],...!((c=m==null?void 0:m.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${m.signInWithSolana.requestId}`]:[],...!((p=(d=m==null?void 0:m.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||p===void 0)&&p.length?["Resources",...m.signInWithSolana.resources.map(D=>`- ${D}`)]:[]].join(`
`);const R=await w.signMessage(new TextEncoder().encode(b),"utf8");if(!R||!(R instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=R}}try{const{data:S,error:g}=await Le(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:b,signature:Wv(v)},!((h=e.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(y=e.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:fr});if(g)throw g;return!S||!S.session||!S.user?{data:{user:null,session:null},error:new zi}:(S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),{data:Object.assign({},S),error:g})}catch(S){if(Ce(S))return{data:{user:null,session:null},error:S};throw S}}async _exchangeCodeForSession(e){const n=await io(this.storage,`${this.storageKey}-code-verifier`),[r,o]=(n??"").split("/");try{const{data:s,error:i}=await Le(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:fr});if(await Rr(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new zi}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:o??null}),error:i})}catch(s){if(Ce(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{const{options:n,provider:r,token:o,access_token:s,nonce:i}=e,l=await Le(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:o,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:fr}),{data:u,error:c}=l;return c?{data:{user:null,session:null},error:c}:!u||!u.session||!u.user?{data:{user:null,session:null},error:new zi}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:u,error:c})}catch(n){if(Ce(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,r,o,s,i;try{if("email"in e){const{email:l,options:u}=e;let c=null,d=null;this.flowType==="pkce"&&([c,d]=await Po(this.storage,this.storageKey));const{error:p}=await Le(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(n=u==null?void 0:u.data)!==null&&n!==void 0?n:{},create_user:(r=u==null?void 0:u.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},code_challenge:c,code_challenge_method:d},redirectTo:u==null?void 0:u.emailRedirectTo});return{data:{user:null,session:null},error:p}}if("phone"in e){const{phone:l,options:u}=e,{data:c,error:d}=await Le(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(o=u==null?void 0:u.data)!==null&&o!==void 0?o:{},create_user:(s=u==null?void 0:u.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},channel:(i=u==null?void 0:u.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:d}}throw new Wi("You must provide either an email or phone number.")}catch(l){if(Ce(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var n,r;try{let o,s;"options"in e&&(o=(n=e.options)===null||n===void 0?void 0:n.redirectTo,s=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:i,error:l}=await Le(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:o,xform:fr});if(l)throw l;if(!i)throw new Error("An error occurred on token verification.");const u=i.session,c=i.user;return u!=null&&u.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(o){if(Ce(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithSSO(e){var n,r,o;try{let s=null,i=null;return this.flowType==="pkce"&&([s,i]=await Po(this.storage,this.storageKey)),await Le(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((o=e==null?void 0:e.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:i}),headers:this.headers,xform:ux})}catch(s){if(Ce(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new Dr;const{error:o}=await Le(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:o}})}catch(e){if(Ce(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:o,options:s}=e,{error:i}=await Le(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:o,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in e){const{phone:r,type:o,options:s}=e,{data:i,error:l}=await Le(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:o,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:l}}throw new Wi("You must provide either an email or phone number and a type")}catch(n){if(Ce(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await io(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<$l:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const i=await io(this.userStorage,this.storageKey+"-user");i!=null&&i.user?e.user=i.user:e.user=Ul()}if(this.storage.isServer&&e.user){let i=this.suppressGetSessionWarning;e=new Proxy(e,{get:(u,c,d)=>(!i&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(u,c,d))})}return{data:{session:e},error:null}}const{session:o,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:o},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Le(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Lr}):await this._useSession(async n=>{var r,o,s;const{data:i,error:l}=n;if(l)throw l;return!(!((r=i.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Dr}:await Le(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(o=i.session)===null||o===void 0?void 0:o.access_token)!==null&&s!==void 0?s:void 0,xform:Lr})})}catch(n){if(Ce(n))return Lv(n)&&(await this._removeSession(),await Rr(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:o,error:s}=r;if(s)throw s;if(!o.session)throw new Dr;const i=o.session;let l=null,u=null;this.flowType==="pkce"&&e.email!=null&&([l,u]=await Po(this.storage,this.storageKey));const{data:c,error:d}=await Le(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:u}),jwt:i.access_token,xform:Lr});if(d)throw d;return i.user=c.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(r){if(Ce(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Dr;const n=Date.now()/1e3;let r=n,o=!0,s=null;const{payload:i}=Bl(e.access_token);if(i.exp&&(r=i.exp,o=r<=n),o){const{session:l,error:u}=await this._callRefreshToken(e.refresh_token);if(u)return{data:{user:null,session:null},error:u};if(!l)return{data:{user:null,session:null},error:null};s=l}else{const{data:l,error:u}=await this._getUser(e.access_token);if(u)throw u;s={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(n){if(Ce(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:i,error:l}=n;if(l)throw l;e=(r=i.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new Dr;const{session:o,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:o?{data:{user:o.user,session:o},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(Ce(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!Gn())throw new Vi("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Vi(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new xf("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Vi("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new xf("No code detected.");const{data:f,error:m}=await this._exchangeCodeForSession(e.code);if(m)throw m;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:f.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:o,access_token:s,refresh_token:i,expires_in:l,expires_at:u,token_type:c}=e;if(!s||!l||!i||!c)throw new Vi("No session defined in URL");const d=Math.round(Date.now()/1e3),p=parseInt(l);let h=d+p;u&&(h=parseInt(u));const y=h-d;y*1e3<=Mo&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${y}s, should have been closer to ${p}s`);const b=h-p;d-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,h,d):d-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,h,d);const{data:v,error:S}=await this._getUser(s);if(S)throw S;const g={provider_token:r,provider_refresh_token:o,access_token:s,expires_in:p,expires_at:h,refresh_token:i,token_type:c,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:e.type},error:null}}catch(r){if(Ce(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await io(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:o,error:s}=n;if(s)return{error:s};const i=(r=o.session)===null||r===void 0?void 0:r.access_token;if(i){const{error:l}=await this.admin.signOut(i,e);if(l&&!(Pv(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await Rr(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=Gv(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,o;try{const{data:{session:s},error:i}=n;if(i)throw i;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((o=this.stateChangeEmitters.get(e))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,n={}){let r=null,o=null;this.flowType==="pkce"&&([r,o]=await Po(this.storage,this.storageKey,!0));try{return await Le(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:o,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(s){if(Ce(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(Ce(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:r,error:o}=await this._useSession(async s=>{var i,l,u,c,d;const{data:p,error:h}=s;if(h)throw h;const y=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(u=e.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await Le(this.fetch,"GET",y,{headers:this.headers,jwt:(d=(c=p.session)===null||c===void 0?void 0:c.access_token)!==null&&d!==void 0?d:void 0})});if(o)throw o;return Gn()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(Ce(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,o;const{data:s,error:i}=n;if(i)throw i;return await Le(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(o=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&o!==void 0?o:void 0})})}catch(n){if(Ce(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await Jv(async o=>(o>0&&await Kv(200*Math.pow(2,o-1)),this._debug(n,"refreshing attempt",o),await Le(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:fr})),(o,s)=>{const i=200*Math.pow(2,o);return s&&Ml(s)&&Date.now()+i-r<Mo})}catch(r){if(this._debug(n,"error",r),Ce(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),Gn()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const o=await io(this.storage,this.storageKey);if(o&&this.userStorage){let i=await io(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:o.user},await Bo(this.userStorage,this.storageKey+"-user",i)),o.user=(e=i==null?void 0:i.user)!==null&&e!==void 0?e:Ul()}else if(o&&!o.user&&!o.user){const i=await io(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(o.user=i.user,await Rr(this.storage,this.storageKey+"-user"),await Bo(this.storage,this.storageKey,o)):o.user=Ul()}if(this._debug(r,"session from storage",o),!this._isValidSession(o)){this._debug(r,"session is not valid"),o!==null&&await this._removeSession();return}const s=((n=o.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<$l;if(this._debug(r,`session has${s?"":" not"} expired with margin of ${$l}s`),s){if(this.autoRefreshToken&&o.refresh_token){const{error:i}=await this._callRefreshToken(o.refresh_token);i&&(console.error(i),Ml(i)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(o.user&&o.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:l}=await this._getUser(o.access_token);!l&&(i!=null&&i.user)?(o.user=i.user,await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(r,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",o)}catch(o){this._debug(r,"error",o),console.error(o);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new Dr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new nl;const{data:s,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!s.session)throw new Dr;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const l={session:s.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(s){if(this._debug(o,"error",s),Ce(s)){const i={session:null,error:s};return Ml(s)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(i),i}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(s),s}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(e,n,r=!0){const o=`#_notifyAllSubscribers(${e})`;this._debug(o,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const s=[],i=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,n)}catch(u){s.push(u)}});if(await Promise.all(i),s.length>0){for(let l=0;l<s.length;l+=1)console.error(s[l]);throw s[0]}}finally{this._debug(o,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const n=Object.assign({},e),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await Bo(this.userStorage,this.storageKey+"-user",{user:n.user});const o=Object.assign({},n);delete o.user;const s=kf(o);await Bo(this.storage,this.storageKey,s)}else{const o=kf(n);await Bo(this.storage,this.storageKey,o)}}async _removeSession(){this._debug("#_removeSession()"),await Rr(this.storage,this.storageKey),await Rr(this.storage,this.storageKey+"-code-verifier"),await Rr(this.storage,this.storageKey+"-user"),this.userStorage&&await Rr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Gn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Mo);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const o=Math.floor((r.expires_at*1e3-e)/Mo);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${Mo}ms, refresh threshold is ${Ju} ticks`),o<=Ju&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Cm)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Gn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const o=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&o.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&o.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[s,i]=await Po(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(i)}`});o.push(l.toString())}if(r!=null&&r.queryParams){const s=new URLSearchParams(r.queryParams);o.push(s.toString())}return r!=null&&r.skipBrowserRedirect&&o.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${o.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:o,error:s}=n;return s?{data:null,error:s}:await Le(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(Ce(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,o;const{data:s,error:i}=n;if(i)return{data:null,error:i};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:u,error:c}=await Le(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((o=u==null?void 0:u.totp)===null||o===void 0)&&o.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),{data:u,error:null})})}catch(n){if(Ce(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:o,error:s}=n;if(s)return{data:null,error:s};const{data:i,error:l}=await Le(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:l})})}catch(n){if(Ce(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:o,error:s}=n;return s?{data:null,error:s}:await Le(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(Ce(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(e==null?void 0:e.factors)||[],o=r.filter(i=>i.factor_type==="totp"&&i.status==="verified"),s=r.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:r,totp:o,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,r;const{data:{session:o},error:s}=e;if(s)return{data:null,error:s};if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=Bl(o.access_token);let l=null;i.aal&&(l=i.aal);let u=l;((r=(n=o.user.factors)===null||n===void 0?void 0:n.filter(p=>p.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(u="aal2");const d=i.amr||[];return{data:{currentLevel:l,nextLevel:u,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(l=>l.kid===e);if(r)return r;const o=Date.now();if(r=this.jwks.keys.find(l=>l.kid===e),r&&this.jwks_cached_at+Ov>o)return r;const{data:s,error:i}=await Le(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=o,r=s.keys.find(l=>l.kid===e),!r)?null:r}async getClaims(e,n={}){try{let r=e;if(!r){const{data:y,error:b}=await this.getSession();if(b||!y.session)return{data:null,error:b};r=y.session.access_token}const{header:o,payload:s,signature:i,raw:{header:l,payload:u}}=Bl(r);n!=null&&n.allowExpired||nx(s.exp);const c=!o.alg||o.alg.startsWith("HS")||!o.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(o.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!c){const{error:y}=await this.getUser(r);if(y)throw y;return{data:{claims:s,header:o,signature:i},error:null}}const d=rx(o.alg),p=await crypto.subtle.importKey("jwk",c,d,!0,["verify"]);if(!await crypto.subtle.verify(d,p,i,zv(`${l}.${u}`)))throw new Xu("Invalid JWT signature");return{data:{claims:s,header:o,signature:i},error:null}}catch(r){if(Ce(r))return{data:null,error:r};throw r}}}fi.nextInstanceID=0;const xx=fi;class bx extends xx{constructor(e){super(e)}}var wx=function(t,e,n,r){function o(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function l(d){try{c(r.next(d))}catch(p){i(p)}}function u(d){try{c(r.throw(d))}catch(p){i(p)}}function c(d){d.done?s(d.value):o(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};class Sx{constructor(e,n,r){var o,s,i;this.supabaseUrl=e,this.supabaseKey=n;const l=Cv(e);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const u=`sb-${l.hostname.split(".")[0]}-auth-token`,c={db:yv,realtime:xv,auth:Object.assign(Object.assign({},vv),{storageKey:u}),global:gv},d=jv(r??{},c);this.storageKey=(o=d.auth.storageKey)!==null&&o!==void 0?o:"",this.headers=(s=d.global.headers)!==null&&s!==void 0?s:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(p,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=d.auth)!==null&&i!==void 0?i:{},this.headers,d.global.fetch),this.fetch=_v(n,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new $y(new URL("rest/v1",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new hv(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new my(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r={}){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return wx(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:o,userStorage:s,storageKey:i,flowType:l,lock:u,debug:c},d,p){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new bx({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),d),storageKey:i,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:o,userStorage:s,flowType:l,lock:u,debug:c,fetch:p,hasCustomAuthorizationHeader:Object.keys(this.headers).some(y=>y.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new ev(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const _x=(t,e,n)=>new Sx(t,e,n);function kx(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}kx()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Ex="https://wjylzxsfevdlhqunvfqc.supabase.co",jx="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndqeWx6eHNmZXZkbGhxdW52ZnFjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg2ODMwOTEsImV4cCI6MjA3NDI1OTA5MX0.SuB0gd7-gefwpUHFnKsupDgo8P2VeLuMbdlsU6AMrLw",Nf=globalThis,Be=Nf.__sg_supabase||(Nf.__sg_supabase=_x(Ex,jx,{auth:{persistSession:!0,autoRefreshToken:!0,storageKey:"salesgame-auth"},realtime:{params:{eventsPerSecond:10}}}));function Cx(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,8)}`}function hs(){const t="sg_tab_player_id";let e=sessionStorage.getItem(t);return e||(e=Cx(),sessionStorage.setItem(t,e)),e}function _o(t="Jogador"){const e="sg_tab_player_name";let n=sessionStorage.getItem(e);if(!n){const r=String(t||"Jogador");if(r.trim().toLowerCase()==="jogador"){const o=hs();n=`Jogador-${String(o||"").slice(-4).toUpperCase()||"XXXX"}`}else n=r;sessionStorage.setItem(e,n)}return n}function Rx(t){return sessionStorage.setItem("sg_tab_player_name",t??"Jogador"),t}const Nx="/dynamic-data-visualization-3d.jpg",Dx="/SalesGame_Logo-removebg-preview.png",Ax="/Multiplier-Copia.png",Ox="/WhatsApp_Image_2025-06-24_at_16.47.00-removebg-preview.png";function Tx({onEnter:t}){const[e,n]=E.useState(_o("")),r=E.useRef(null);E.useEffect(()=>{var i;(i=r.current)==null||i.focus()},[]);function o(){const i=(e||"").trim();i&&(Rx(i),t==null||t(i))}function s(i){i.key==="Enter"&&o()}return a.jsxs("div",{className:"start",children:[a.jsx("img",{className:"startBg",src:Nx,alt:""}),a.jsx("div",{className:"startShade"}),a.jsx("div",{className:"startHeader",children:a.jsx("img",{className:"startLogo",src:Dx,alt:"Sales GAME"})}),a.jsx("div",{className:"startCenter",children:a.jsxs("div",{className:"startCard",children:[a.jsx("label",{className:"startLabel",htmlFor:"playerName",children:"Nome do Jogador"}),a.jsx("input",{id:"playerName",ref:r,className:"startInput",placeholder:"Digite seu nome",value:e,onChange:i=>n(i.target.value),onKeyDown:s,maxLength:30}),a.jsx("button",{className:"startBtn",onClick:o,children:"Entrar"})]})}),a.jsxs("div",{className:"startFooter",children:[a.jsxs("div",{className:"startLinks",children:[a.jsx("div",{children:"@multiplier.educacao"}),a.jsx("div",{children:"https://multipliereducacao.com.br/"})]}),a.jsx("div",{className:"startBrand",children:a.jsx("img",{className:"startBrandLogo",src:Ax,alt:"Multiplier"})})]}),a.jsx("img",{className:"startCoach",src:Ox,alt:"",draggable:"false"})]})}async function Px(){const{data:t,error:e}=await Be.from("lobbies").select(`
      id,
      name,
      max_players,
      status,
      created_at,
      lobby_players!left(count)
    `).order("created_at",{ascending:!0});if(e)throw e;return(t||[]).map(n=>{var r,o;return{id:n.id,name:n.name,max:n.max_players,status:n.status||"open",players:(((o=(r=n.lobby_players)==null?void 0:r[0])==null?void 0:o.count)??0)|0}})}function Lx(t){const e=Be.channel("lobbies-list").on("postgres_changes",{event:"*",schema:"public",table:"lobbies"},()=>t==null?void 0:t()).on("postgres_changes",{event:"*",schema:"public",table:"lobby_players"},()=>t==null?void 0:t()).subscribe();return()=>Be.removeChannel(e)}async function Ix({name:t,hostId:e,max:n=4}){if(!e)throw new Error("hostId obrigatrio em createLobby");const o={id:typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,8)}`,name:t,host_id:e,max_players:Number(n)||4,status:"open",created_at:new Date().toISOString()},{data:s,error:i}=await Be.from("lobbies").insert(o).select("id").single();if(i)throw i;return s.id}async function Zu({lobbyId:t,playerId:e,playerName:n,ready:r=!1}){const{data:o,error:s}=await Be.from("lobbies").select("id, max_players, status, host_id").eq("id",t).single();if(s)throw s;if(o.status!=="open")throw new Error("Sala fechada.");const{count:i,error:l}=await Be.from("lobby_players").select("lobby_id",{count:"exact",head:!0}).eq("lobby_id",t);if(l)throw l;if((i||0)>=o.max_players)throw new Error("Sala cheia.");try{window.__MY_UID=e}catch{}const{error:u}=await Be.from("lobby_players").upsert({lobby_id:t,player_id:e,player_name:n,ready:!!r,joined_at:new Date().toISOString()},{onConflict:"lobby_id,player_id"});if(u)throw u;o.host_id||await Be.from("lobbies").update({host_id:e}).eq("id",t)}async function Df({lobbyId:t,playerId:e}){var l;const{data:n,error:r}=await Be.from("lobbies").select("id, host_id").eq("id",t).single();if(r)throw r;const{error:o}=await Be.from("lobby_players").delete().match({lobby_id:t,player_id:e});if(o)throw o;const{data:s,error:i}=await Be.from("lobby_players").select("player_id, joined_at").eq("lobby_id",t).order("joined_at",{ascending:!0});if(i)throw i;if(!s||s.length===0){await Be.from("lobbies").delete().eq("id",t);return}if((n==null?void 0:n.host_id)===e){const u=(l=s[0])==null?void 0:l.player_id;u&&await Be.from("lobbies").update({host_id:u}).eq("id",t)}}async function Af(t){const{data:e,error:n}=await Be.from("lobby_players").select("player_id, player_name, ready, joined_at").eq("lobby_id",t).order("joined_at",{ascending:!0});if(n)throw n;return e||[]}async function $x({lobbyId:t,playerId:e,ready:n}){const{error:r}=await Be.from("lobby_players").update({ready:n}).match({lobby_id:t,player_id:e});if(r)throw r}async function Mx(t,e,n){return $x({lobbyId:t,playerId:e,ready:n})}async function Bx({lobbyId:t,playerId:e,playerName:n}){const{error:r}=await Be.from("lobby_players").update({player_name:n}).match({lobby_id:t,player_id:e});if(r)throw r}async function Of(t,e){const{error:n}=await Be.from("lobbies").update({status:e}).eq("id",t);if(n)throw n}function Ux(t,e){let n=0;const r=()=>{n&&cancelAnimationFrame(n),n=requestAnimationFrame(()=>e==null?void 0:e())},o=Be.channel(`lobby-${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"lobby_players",filter:`lobby_id=eq.${t}`},s=>{console.debug("[rt] lobby_players:INSERT",s.new),r()}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"lobby_players",filter:`lobby_id=eq.${t}`},s=>{console.debug("[rt] lobby_players:UPDATE",s.new),r()}).on("postgres_changes",{event:"DELETE",schema:"public",table:"lobby_players",filter:`lobby_id=eq.${t}`},s=>{console.debug("[rt] lobby_players:DELETE",s.old),r()}).on("postgres_changes",{event:"*",schema:"public",table:"lobbies",filter:`id=eq.${t}`},s=>{console.debug("[rt] lobbies:*",s.new||s.old),r()}).subscribe();return()=>{n&&cancelAnimationFrame(n),Be.removeChannel(o)}}async function Fx(t){const{data:e,error:n}=await Be.from("lobbies").select("id,name,status,max_players,host_id,created_at").eq("id",t).single();if(n)throw n;return e}async function zx({lobbyId:t}){var o;const{data:e}=await Be.from("lobby_players").select("player_id, player_name, ready").eq("lobby_id",t),{data:n,error:r}=await Be.from("matches").insert({lobby_id:t,host_id:((o=e==null?void 0:e[0])==null?void 0:o.player_id)||null,state:{players:e},created_at:new Date().toISOString()}).select("id").single();if(r)throw r;return n}async function Wx(t){const{data:e,error:n}=await Be.from("matches").select("id, lobby_id, created_at").eq("lobby_id",t).order("created_at",{ascending:!1}).limit(1);if(n)throw n;return(e==null?void 0:e[0])||null}async function zl({roomCode:t,playerId:e}){if(!t||!e){console.log("[leaveRoom] Parmetros invlidos:",{roomCode:t,playerId:e});return}try{console.log(`[leaveRoom] Tentando remover jogador ${e} da sala ${t}`);const{data:n,error:r}=await Be.from("lobbies").select("id, name, host_id").eq("id",t).single();if(r){console.warn("[leaveRoom] Erro ao buscar lobby:",r);return}if(!n){console.log(`[leaveRoom] Lobby ${t} no encontrado`);return}console.log("[leaveRoom] Lobby encontrado:",n);const{error:o}=await Be.from("lobby_players").delete().match({lobby_id:t,player_id:e});o?console.warn("[leaveRoom] Erro ao remover jogador:",o):console.log(`[leaveRoom] Jogador ${e} removido do lobby ${t}`);const{data:s,error:i}=await Be.from("lobby_players").select("player_id").eq("lobby_id",t);if(i){console.warn("[leaveRoom] Erro ao contar jogadores restantes:",i);return}if(!s||s.length===0){const{error:l}=await Be.from("lobbies").delete().eq("id",t);l?console.warn("[leaveRoom] Erro ao deletar lobby vazio:",l):console.log(`[leaveRoom] Lobby ${t} deletado com sucesso (sem jogadores)`)}else if(console.log(`[leaveRoom] Jogador ${e} saiu do lobby ${t}. Restam ${s.length} jogadores.`),n.host_id===e&&s.length>0){const l=s[0].player_id,{error:u}=await Be.from("lobbies").update({host_id:l}).eq("id",t);u?console.warn("[leaveRoom] Erro ao transferir host:",u):console.log(`[leaveRoom] Host transferido para ${l}`)}}catch(n){console.error("[leaveRoom] Erro inesperado:",n)}}function Vx({onEnterRoom:t}){const[e,n]=E.useState([]),[r,o]=E.useState(!1);async function s(){o(!0);try{const c=await Px();n(c)}finally{o(!1)}}E.useEffect(()=>(s(),Lx(()=>s())),[]);async function i(){const c=_o("Jogador"),d=`Sala de ${c}`,p=prompt("Nome do lobby:",d)||d,h=hs();try{const y=await Ix({name:p,hostId:h,max:4});await Zu({lobbyId:y,playerId:h,playerName:c,ready:!1}),t==null||t(y)}catch(y){alert(y.message||"No foi possvel criar o lobby."),await s()}}async function l(c){try{const d=_o("Jogador"),p=hs();await Zu({lobbyId:c,playerId:p,playerName:d,ready:!1}),t==null||t(c)}catch(d){alert(d.message||"No foi possvel entrar no lobby.")}}const u={page:{minHeight:"100vh",background:"#0f0f12",color:"#e9ecf1",padding:"32px 16px",display:"flex",justifyContent:"center"},container:{width:"100%",maxWidth:980},headerRow:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:16,marginBottom:16,flexWrap:"wrap"},title:{fontSize:28,fontWeight:800,color:"#fff"},actions:{display:"flex",gap:10},btn:{padding:"12px 16px",border:0,borderRadius:12,fontWeight:800,cursor:"pointer"},btnPrimary:{background:"#4f46e5",color:"#fff",boxShadow:"0 8px 24px rgba(79,70,229,.25)"},btnSecondary:{background:"#20222a",color:"#fff",border:"1px solid #2b2e38"},grid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:14},card:{background:"linear-gradient(180deg, rgba(255,255,255,0.02) 0%, rgba(255,255,255,0.00) 100%)",border:"1px solid rgba(255,255,255,.08)",borderRadius:16,padding:16,display:"flex",flexDirection:"column",gap:12,boxShadow:"0 10px 20px rgba(0,0,0,.25)"},cardHeader:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:10},lobbyName:{fontSize:18,fontWeight:800,color:"#fff",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:1},meta:{fontSize:13,color:"#b8c0cc"},joinBtn:{padding:"10px 14px",borderRadius:10,border:0,background:"#7c3aed",color:"#fff",fontWeight:800,cursor:"pointer",boxShadow:"0 10px 20px rgba(124,58,237,.25)"},disabled:{opacity:.6,cursor:"not-allowed",filter:"grayscale(.3)"},empty:{marginTop:24,padding:18,borderRadius:12,border:"1px dashed rgba(255,255,255,.12)",color:"#c7cfdb",textAlign:"center"}};return a.jsx("div",{style:u.page,children:a.jsxs("div",{style:u.container,children:[a.jsxs("div",{style:u.headerRow,children:[a.jsx("h2",{style:u.title,children:"SalesGame  Lobbies"}),a.jsxs("div",{style:u.actions,children:[a.jsx("button",{style:{...u.btn,...u.btnPrimary},onClick:i,children:"Criar Lobby"}),a.jsx("button",{style:{...u.btn,...u.btnSecondary},onClick:s,disabled:r,children:r?"Atualizando":"Atualizar"})]})]}),e.length===0&&!r?a.jsxs("div",{style:u.empty,children:["Nenhuma sala criada ainda. Clique em ",a.jsx("b",{children:"Criar Lobby"})," para comear."]}):a.jsx("div",{style:u.grid,children:e.map(c=>{const d=(c.players??0)>=(c.max??4),p=(c.status??"open")==="open",h=d||!p;return a.jsxs("div",{style:u.card,children:[a.jsxs("div",{style:u.cardHeader,children:[a.jsx("div",{style:u.lobbyName,title:c.name,children:c.name}),a.jsxs("span",{style:u.meta,children:[c.players??0,"/",c.max??4]})]}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("span",{style:u.meta,children:["status: ",c.status??"open"]}),a.jsx("button",{style:{...u.joinBtn,...h?u.disabled:{}},disabled:h,onClick:()=>l(c.id),title:h?d?"Sala cheia":"Sala no est aberta":"Entrar na sala",children:"Entrar"})]})]},c.id)})})]})})}function Gx({lobbyId:t,onBack:e,onStartGame:n}){const r=hs(),o=_o("Jogador"),[s,i]=E.useState(null),[l,u]=E.useState([]),[c,d]=E.useState(!0),[p,h]=E.useState(!1),y=E.useRef(!1),b=E.useRef(!0),v=E.useRef(!1),S=E.useRef(!1),g=E.useMemo(()=>(s==null?void 0:s.host_id)===r,[s,r]),f=E.useMemo(()=>l.find(j=>j.player_id===r),[l,r]),m=E.useMemo(()=>l.filter(j=>j.ready).length,[l]),w=E.useMemo(()=>{const j=l.map(L=>String(L.player_name||"").trim().toLowerCase()).filter(Boolean);return new Set(j).size!==j.length},[l]),_=g&&(s==null?void 0:s.status)==="open"&&l.length>=1&&m===l.length;console.log("[PlayersLobby] Debug:",{players:l.length,readyCount:m,lobbyStatus:s==null?void 0:s.status,amHost:g,canStart:_,meId:r,meName:o});async function R(j){if(S.current)return;const L=await Wx(t);if(L!=null&&L.id){S.current=!0;const U=(j||[]).map((B,q)=>({id:B.player_id,name:B.player_name,index:q}));n==null||n({lobbyId:t,matchId:L==null?void 0:L.id,players:U,me:{id:r,name:o}})}}async function D(){b.current&&d(!0);try{console.log("[PlayersLobby] refreshAll - buscando lobby:",t);const[j,L]=await Promise.all([Fx(t),Af(t)]);console.log("[PlayersLobby] refreshAll - lobby:",j,"players:",L),i(j),u(L);const U=L.find(B=>B.player_id===r);if(console.log("[PlayersLobby] refreshAll - mine:",U,"meId:",r),!U&&!y.current&&(j==null?void 0:j.status)==="open"){console.log("[PlayersLobby] refreshAll - entrando na sala"),y.current=!0;try{await Zu({lobbyId:t,playerId:r,playerName:o,ready:!1}),console.log("[PlayersLobby] refreshAll - entrada na sala bem-sucedida");const B=await Af(t);console.log("[PlayersLobby] refreshAll - jogadores aps entrada:",B),u(B)}catch(B){console.error("[PlayersLobby] refreshAll - erro ao entrar na sala:",B)}}if(U&&!v.current&&o&&U.player_name!==o){console.log("[PlayersLobby] refreshAll - sincronizando nome"),v.current=!0;try{await Bx({lobbyId:t,playerId:r,playerName:o})}catch{}}await R(L)}catch(j){console.error("[PlayersLobby] refreshAll - erro:",j)}finally{b.current&&(b.current=!1,d(!1))}}E.useEffect(()=>{const j=()=>{Df({lobbyId:t,playerId:r}).catch(()=>{})},L=()=>j();return window.addEventListener("pagehide",L),window.addEventListener("beforeunload",L),()=>{window.removeEventListener("pagehide",L),window.removeEventListener("beforeunload",L)}},[t,r]),E.useEffect(()=>(y.current=!1,b.current=!0,v.current=!1,S.current=!1,D(),Ux(t,()=>D())),[t]);async function k(j){if(!f)return;h(!0);const L=f.ready;u(U=>U.map(B=>B.player_id===r?{...B,ready:j}:B));try{await Mx(t,r,j)}catch(U){u(B=>B.map(q=>q.player_id===r?{...q,ready:L}:q)),console.error("setReadyUI failed",U)}finally{h(!1)}}async function N(){try{await Df({lobbyId:t,playerId:r})}finally{e==null||e()}}async function x(){if(!_)return;const j=s==null?void 0:s.status;await Of(t,"locked");try{const L=await zx({lobbyId:t});S.current=!0;const U=l.map((B,q)=>({id:B.player_id,name:B.player_name,index:q}));n==null||n({lobbyId:t,matchId:L==null?void 0:L.id,players:U,me:{id:r,name:o}})}catch(L){console.error("startMatch failed",L),await Of(t,j||"open")}}return a.jsx("div",{style:We.page,children:a.jsxs("div",{style:We.container,children:[a.jsxs("div",{style:We.top,children:[a.jsx("button",{style:We.backBtn,onClick:N,children:" Voltar"}),a.jsxs("h2",{style:We.title,children:["SalesGame  ",(s==null?void 0:s.name)||"..."]})]}),a.jsxs("div",{style:We.table,children:[a.jsxs("div",{style:We.thead,children:[a.jsx("div",{style:We.colPlayer,children:"Jogador"}),a.jsx("div",{style:We.colReady,children:"Pronto?"})]}),c?a.jsx("div",{style:We.loading,children:"Carregando..."}):l.map(j=>a.jsxs("div",{style:We.row,children:[a.jsxs("div",{style:We.colPlayer,children:[a.jsx("span",{style:We.avatar,children:(j.player_name||"?").slice(0,2).toLowerCase()}),a.jsx("span",{children:j.player_name||"Annimo"}),(s==null?void 0:s.host_id)===j.player_id&&a.jsx("span",{style:We.badgeHost,children:"Host"}),j.player_id===r&&a.jsx("span",{style:We.badgeYou,children:"Voc"})]}),a.jsx("div",{style:We.colReady,children:j.player_id===r?a.jsxs("div",{style:{display:"flex",gap:8},children:[a.jsx("button",{style:{...We.btn,...f!=null&&f.ready?We.btnGhost:We.btnDark},onClick:()=>k(!1),disabled:p||!(f!=null&&f.ready),children:"No pronto"}),a.jsxs("button",{style:{...We.btn,...f!=null&&f.ready?We.btnPrimary:We.btnPurple},onClick:()=>k(!0),disabled:p||!!(f!=null&&f.ready),children:[" ",f!=null&&f.ready?"Pronto":"Ficar pronto"]})]}):a.jsx("span",{style:j.ready?We.pillReady:We.pillWait,children:j.ready?"Pronto":"Aguardando"})})]},j.player_id))]}),a.jsxs("div",{style:We.footer,children:[a.jsxs("div",{style:We.statusWrap,children:[a.jsx("span",{style:{...We.dot,background:(s==null?void 0:s.status)==="open"?"#22c55e":"#f59e0b"}}),a.jsxs("span",{children:["status: ",(s==null?void 0:s.status)||"..."]}),a.jsxs("span",{style:{marginLeft:12},children:["Prontos: ",m,"/",l.length]})]}),w&&a.jsx("div",{style:{marginTop:8,color:"#ffd54f",fontWeight:800},children:" Aviso: existe nome duplicado na sala. (A identidade  pelo ID; renomear evita confuso.)"}),a.jsxs("div",{style:{display:"flex",gap:12},children:[a.jsx("button",{style:{...We.btn,..._?We.btnPrimary:We.disabled},onClick:x,disabled:!_,children:"Iniciar partida"}),a.jsx("button",{style:{...We.btn,...We.btnDark},onClick:N,children:"Sair da sala"})]})]})]})})}const We={page:{minHeight:"100vh",background:"#0f0f12",color:"#e9ecf1",padding:"24px 16px",display:"flex",justifyContent:"center"},container:{width:"100%",maxWidth:980},top:{display:"flex",alignItems:"center",gap:12,marginBottom:16},backBtn:{padding:"10px 14px",background:"#20222a",border:"1px solid #2b2e38",borderRadius:12,color:"#fff",cursor:"pointer"},title:{margin:0,fontSize:28,fontWeight:800},table:{background:"rgba(255,255,255,.02)",border:"1px solid rgba(255,255,255,.08)",borderRadius:16,overflow:"hidden"},thead:{display:"grid",gridTemplateColumns:"1fr 220px",padding:"12px 16px",borderBottom:"1px solid rgba(255,255,255,.08)",color:"#c7cfdb"},row:{display:"grid",gridTemplateColumns:"1fr 220px",padding:"12px 16px",borderBottom:"1px solid rgba(255,255,255,.06)"},colPlayer:{display:"flex",alignItems:"center",gap:10,minWidth:0},colReady:{display:"flex",alignItems:"center",justifyContent:"flex-end"},avatar:{width:28,height:28,borderRadius:999,background:"#1f2430",display:"grid",placeItems:"center",color:"#c7cfdb",fontSize:12,textTransform:"lowercase"},badgeHost:{marginLeft:8,fontSize:12,background:"#fde68a",color:"#111827",padding:"2px 8px",borderRadius:999,fontWeight:800},badgeYou:{marginLeft:8,fontSize:12,background:"#bfdbfe",color:"#111827",padding:"2px 8px",borderRadius:999,fontWeight:800},loading:{padding:16,color:"#c7cfdb"},pillReady:{background:"rgba(34,197,94,.15)",color:"#22c55e",padding:"6px 10px",borderRadius:999,fontWeight:700},pillWait:{background:"rgba(245,158,11,.14)",color:"#f59e0b",padding:"6px 10px",borderRadius:999,fontWeight:700},footer:{display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:16},statusWrap:{display:"flex",alignItems:"center",gap:6,color:"#c7cfdb"},dot:{width:8,height:8,borderRadius:"50%"},btn:{padding:"12px 16px",border:0,borderRadius:12,fontWeight:800,cursor:"pointer"},btnPrimary:{background:"#4f46e5",color:"#fff",boxShadow:"0 8px 24px rgba(79,70,229,.25)"},btnPurple:{background:"#7c3aed",color:"#fff"},btnDark:{background:"#20222a",color:"#fff",border:"1px solid #2b2e38"},btnGhost:{background:"transparent",color:"#e9ecf1",border:"1px solid rgba(255,255,255,.15)"},disabled:{opacity:.5,cursor:"not-allowed",filter:"grayscale(.25)"}},qx="/board.jpg",ec=800,tc=700,rl=[{nx:.9278494291885221,ny:.9008218764923216},{nx:.8188460351743289,ny:.9120818357755046},{nx:.7145819191607529,ny:.920124663834921},{nx:.6016291268127121,ny:.920124663834921},{nx:.49104597346497997,ny:.9233417950586875},{nx:.37888306078370876,ny:.920124663834921},{nx:.24618327676643012,ny:.9152989669992712},{nx:.21695772909595804,ny:.7994822429436751},{nx:.1853625424251774,ny:.7270967904089275},{nx:.1340203640851589,ny:.6354085505315806},{nx:.12851782363977485,ny:.5145797598627787},{nx:.12664165103189493,ny:.37392795883361923},{nx:.05347091932457786,ny:.30017152658662094},{nx:.051594746716697934,ny:.20240137221269297},{nx:.14540337711069418,ny:.12006861063464837},{nx:.23921200750469043,ny:.11663807890222985},{nx:.3771106941838649,ny:.11663807890222985},{nx:.5037523452157598,ny:.12006861063464837},{nx:.5975609756097561,ny:.1320754716981132},{nx:.5984990619136961,ny:.24356775300171526},{nx:.5065666041275797,ny:.2692967409948542},{nx:.398686679174484,ny:.27101200686106347},{nx:.28893058161350843,ny:.27101200686106347},{nx:.2373358348968105,ny:.3687821612349914},{nx:.23921200750469043,ny:.48027444253859347},{nx:.24202626641651032,ny:.5660377358490566},{nx:.26454033771106944,ny:.6895368782161235},{nx:.3330206378986867,ny:.6946826758147513},{nx:.35647279549718575,ny:.5831903945111492},{nx:.35647279549718575,ny:.4716981132075472},{nx:.3818011257035647,ny:.37735849056603776},{nx:.5225140712945591,ny:.3653516295025729},{nx:.6238273921200751,ny:.3687821612349914},{nx:.7223264540337712,ny:.40308747855917665},{nx:.6613508442776735,ny:.5197255574614065},{nx:.5300187617260788,ny:.5025728987993139},{nx:.4427767354596623,ny:.5694682675814752},{nx:.4896810506566604,ny:.6861063464837049},{nx:.6163227016885553,ny:.6861063464837049},{nx:.724202626641651,ny:.6861063464837049},{nx:.8273921200750469,ny:.660377358490566},{nx:.8395872420262664,ny:.5368782161234992},{nx:.8395872420262664,ny:.4339622641509434},{nx:.8283302063789869,ny:.313893653516295},{nx:.7176360225140713,ny:.30017152658662094},{nx:.6876172607879925,ny:.22298456260720412},{nx:.698874296435272,ny:.1457975986277873},{nx:.8020637898686679,ny:.11663807890222985},{nx:.8958724202626641,ny:.11663807890222985},{nx:.9446529080675422,ny:.21783876500857632},{nx:.9446529080675422,ny:.3293310463121784},{nx:.9380863039399625,ny:.45797598627787306},{nx:.9409005628517824,ny:.5711835334476844},{nx:.950281425891182,ny:.6723842195540308},{nx:.9540337711069419,ny:.7804459691252144}],mo=rl.length;function Rm(t,e,n){return{x:t.nx*e,y:t.ny*n}}rl.map(t=>[t.nx*ec,t.ny*tc]);function Hx({visible:t=!0,boardWidth:e,boardHeight:n}){return t?a.jsx("div",{className:"markersLayer",children:rl.map((r,o)=>{const{x:s,y:i}=Rm(r,e,n);return a.jsx("div",{className:"marker",style:{left:s,top:i},title:`Casa ${o+1}`,children:o+1},o)})}):null}function Kx({boardRef:t,expected:e=55,onFinish:n,initial:r=[]}){const[o,s]=E.useState(r);function i(y){if(!(t!=null&&t.current))return;const b=t.current.getBoundingClientRect(),v=y.clientX-b.left,S=y.clientY-b.top,g=v/b.width,f=S/b.height;s(m=>m.length>=e?m:[...m,{nx:g,ny:f}])}function l(){s(y=>y.slice(0,-1))}function u(){s([])}const c=E.useMemo(()=>JSON.stringify(o,null,2),[o]);async function d(){try{await navigator.clipboard.writeText(c),alert("Copiado para a rea de transferncia!")}catch{alert("No foi possvel copiar. Use o boto Baixar.")}}function p(){const y=new Blob([c],{type:"application/json"}),b=URL.createObjectURL(y),v=document.createElement("a");v.href=b,v.download="track-points-55.json",document.body.appendChild(v),v.click(),v.remove(),URL.revokeObjectURL(b)}function h(){n==null||n(o),console.log(`TRACK_POINTS_NORM (cole em src/data/track.js):
`,c),alert("Finalizado! O JSON foi impresso no console. Copie e cole em src/data/track.js")}return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"recLayer",onClick:i}),a.jsx("div",{className:"recDotsLayer",pointerEvents:"none",children:o.map((y,b)=>a.jsx("div",{className:"recDot",style:{left:`${y.nx*100}%`,top:`${y.ny*100}%`},title:`Casa ${b+1}`,children:b+1},b))}),a.jsxs("div",{className:"recToolbar",children:[a.jsxs("div",{className:"recInfo",children:[a.jsx("b",{children:"Gravando trilha"}),"  clique nas casas na ordem.",a.jsxs("span",{children:["Marcados: ",a.jsx("b",{children:o.length})," / ",e]})]}),a.jsxs("div",{className:"recBtns",children:[a.jsx("button",{onClick:l,disabled:!o.length,children:"Desfazer"}),a.jsx("button",{onClick:u,disabled:!o.length,children:"Limpar"}),a.jsx("button",{onClick:d,disabled:!o.length,children:"Copiar JSON"}),a.jsx("button",{onClick:p,disabled:!o.length,children:"Baixar .json"}),a.jsx("button",{onClick:h,disabled:o.length!==e,children:"Finalizar"})]})]})]})}const Jx=40,Yx=1.15,Qx=3,Xx="0 8px 18px rgba(0,0,0,.35)",Tf={cash:18e3,possibAt:0,clientsAt:0,faturamento:770,manutencao:1150,emprestimos:0,vendedoresComuns:0,fieldSales:0,insideSales:0,mixDBens:4e3,erpClientes:0,manualOnboarding:!0,azul:0,amarelo:0,roxo:0,gestores:0};function Zx({players:t,turnIdx:e,recordTrack:n=!1,matchId:r,me:o,onMeHud:s}){const i=E.useRef(null),[l,u]=E.useState({w:ec,h:tc}),c=(o==null?void 0:o.id)||hs(),d=_o("Jogador"),p=E.useMemo(()=>(t==null?void 0:t.find(w=>w.id===c))||null,[t,c]),h=(o==null?void 0:o.name)||(p==null?void 0:p.name)||d,y=(p==null?void 0:p.color)||"#6c5ce7",b=E.useMemo(()=>`sg_stats_v1:${r||"local"}:${c}`,[r,c]),[v,S]=E.useState(()=>{try{const w=sessionStorage.getItem(b);return w?JSON.parse(w):Tf}catch{return Tf}});E.useEffect(()=>{try{sessionStorage.setItem(b,JSON.stringify(v))}catch{}},[b,v]),E.useEffect(()=>{const w={id:c,name:h,color:y,cash:v.cash,possibAt:v.possibAt,clientsAt:v.clientsAt,matchId:r||"local"};s==null||s(w),document.dispatchEvent(new CustomEvent("sg:meHud",{detail:w}))},[c,h,y,v.cash,v.possibAt,v.clientsAt,r]),E.useLayoutEffect(()=>{if(!i.current)return;const w=i.current,_=new ResizeObserver(R=>{for(const D of R){const k=D.contentRect;u({w:k.width,h:k.height})}});return _.observe(w),()=>_.disconnect()},[]);const g=l.w/ec,f=l.h/tc,m=Math.min(g,f);return a.jsxs("div",{className:"board",ref:i,children:[a.jsx("img",{src:qx,alt:"Board",className:"boardImg"}),n&&a.jsx(Kx,{boardRef:i,expected:55,onFinish:w=>{console.log("TRACK_POINTS_NORM (cole em src/data/track.js):",JSON.stringify(w,null,2))}}),!n&&a.jsxs(a.Fragment,{children:[a.jsx(Hx,{visible:!1,boardWidth:l.w,boardHeight:l.h}),t.map((w,_)=>{const R=_===e,D=(w.pos%mo+mo)%mo,k=rl[D],N=Rm(k,l.w,l.h),x=_*12*m,L=Jx*m*(R?Yx:1),U=Math.max(2,Qx*m),B=["","","","","","","",""],q=B[_%B.length];return a.jsx("div",{className:"token",style:{position:"absolute",left:N.x+x,top:N.y-x,transform:"translate(-50%, -50%)",width:L,height:L,borderRadius:"50%",background:w.color,border:`${U}px solid rgba(255,255,255,.95)`,boxShadow:Xx,pointerEvents:"none",display:"grid",placeItems:"center",color:"#000",fontWeight:900,userSelect:"none",zIndex:R?4:3,fontSize:`${Math.max(16,L*.6)}px`},title:`${w.name}  Casa ${D+1}`,"aria-label":`${w.name} est na casa ${D+1}`,children:R?"":q},w.id)})]})]})}function eb({totals:t,players:e}){return E.useEffect(()=>{console.groupCollapsed("[HUD] totals"),console.log(t),console.groupEnd()},[t]),a.jsxs("div",{className:"hud",children:[a.jsxs("div",{className:"panel",children:[a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Faturamento:"})," ",a.jsxs("span",{className:"pos",children:["$ ",t.faturamento]})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Manuteno:"})," ",a.jsxs("span",{className:"neg",children:["$ ",t.manutencao]})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Emprstimos:"})," ",a.jsxs("span",{children:["$ ",t.emprestimos]})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Vendedores Comuns:"})," ",a.jsx("span",{children:t.vendedoresComuns})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Field Sales:"})," ",a.jsx("span",{children:t.fieldSales})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Inside Sales:"})," ",a.jsx("span",{children:t.insideSales})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Mix Produtos:"})," ",a.jsx("span",{children:t.mixProdutos})," ",a.jsx("b",{children:" Bens:"})," ",a.jsxs("span",{children:["$ ",t.bens]})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"ERP/Sistemas:"})," ",a.jsx("span",{children:t.erpSistemas})," ",a.jsx("b",{children:" Clientes:"})," ",a.jsx("span",{children:t.clientes})]}),a.jsxs("div",{children:[a.jsx("b",{children:"Manual Onboarding:"})," "]}),a.jsxs("div",{children:[a.jsx("b",{children:"Azul:"})," ",a.jsx("span",{children:t.az||0})," ",a.jsx("b",{children:" Amarelo: "}),a.jsx("span",{children:t.am||0})," ",a.jsx("b",{children:"Roxo:"})," ",a.jsx("span",{children:t.rox||0})]}),a.jsxs("div",{children:[a.jsx("b",{children:"Gestores Comerciais:"})," ",a.jsx("span",{children:t.gestores??t.gestoresComerciais??0})]}),a.jsxs("div",{children:[a.jsx("b",{children:"Capacidade:"})," ",a.jsx("span",{children:t.possibAt??0}),"  ",a.jsx("b",{children:"Em Atendimento:"})," ",a.jsx("span",{children:t.clientsAt??0})]})]}),a.jsxs("div",{className:"score",children:[a.jsx("div",{className:"title",children:"Placar"}),e.map(n=>a.jsxs("div",{className:"row",children:[a.jsx("span",{children:n.name}),a.jsx("span",{children:n.cash})]},n.id))]})]})}function tb({onAction:t,current:e,isMyTurn:n=!1,myUid:r,turnPlayerId:o,turnLock:s=!1,lockOwner:i=null,modalLocks:l=0,gameOver:u=!1}){const c=!!(e!=null&&e.bankrupt),d=o!=null&&r!=null&&String(o)===String(r),p=!!o&&d&&s===!1&&Number(l||0)===0&&u!==!0&&!c;E.useEffect(()=>{console.log("[CAN_ROLL_CHECK]",{myUid:r,turnPlayerId:o,isMyTurn:d,turnLock:s,modalLocks:l,gameOver:u,bankrupt:c,result:p})},[r,o,d,s,l,u,c,p]);const h=()=>{if(console.log("[Controls] click => Rolar Dado & Andar (canRoll=%s)",p),!p)return;if(o!=null&&r!=null&&String(o)!==String(r)){console.warn("[ROLL_BLOCK][Controls] not my turn",{turnPlayerId:o,myUid:r});return}if(s)return;const v=Math.floor(Math.random()*6)+1,S=0,g=`Dado: ${v}`;console.log("[Controls] onAction ROLL => steps=%d cashDelta=%d note=%s",v,S,g),t==null||t({type:"ROLL",steps:v,cashDelta:S,note:g})},y=async()=>{c||(console.log("[Controls] click => Recuperao Financeira"),t==null||t({type:"RECOVERY_MODAL"}))},b=async()=>{c||(console.log("[Controls] click => Declarar Falncia"),t==null||t({type:"BANKRUPT_MODAL"}))};return a.jsxs("div",{className:`controls ${p?"":"is-wait"} ${c?"is-bankrupt":""}`,children:[a.jsx("button",{className:"btn primary",onClick:y,disabled:c,"aria-disabled":c,children:"RECUPERAO FINANCEIRA"}),a.jsx("button",{className:"btn dark",onClick:b,disabled:c,"aria-disabled":c,children:"DECLARAR FALNCIA"}),a.jsxs("div",{className:"turnBox",children:[a.jsxs("div",{children:["Vez de: ",a.jsx("b",{children:e==null?void 0:e.name})]}),a.jsx("button",{className:"btn go",onClick:h,disabled:!p,"aria-disabled":!p,children:"Rolar Dado & Andar"})]})]})}function wi({children:t,onClose:e,zIndex:n=3e3}){const r=()=>{typeof e=="function"&&e()};return a.jsx("div",{className:"sg-modal-backdrop",style:{position:"fixed",inset:0,background:"rgba(8,10,16,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:n},onClick:r,children:a.jsx("div",{className:"sg-modal-card",style:{position:"relative",background:"#0f1420",border:"1px solid rgba(255,255,255,.1)",borderRadius:14,width:"min(780px, 92vw)",maxWidth:"92vw",color:"#fff",boxShadow:"0 20px 60px rgba(0,0,0,.45)"},onClick:o=>o.stopPropagation(),children:t})})}function nb({players:t=[],onExit:e,onResolve:n}){const r=E.useMemo(()=>{const u=[...t].map(c=>({...c,patrimonio:(Number(c.cash)||0)+(Number(c.bens)||0)})).sort((c,d)=>d.patrimonio-c.patrimonio);return[u[1],u[0],u[2]]},[t]),o=r==null?void 0:r[1],s=r==null?void 0:r[0],i=r==null?void 0:r[2],l=()=>{n?n({action:"EXIT"}):e==null||e()};return a.jsx(wi,{zIndex:2147483647,onClose:()=>{},children:a.jsxs("div",{style:Yn.wrap,children:[a.jsx("h1",{style:Yn.title,children:" Fim da 5 Rodada"}),a.jsxs("p",{style:Yn.subtitle,children:["Vence quem tiver ",a.jsx("b",{children:"Saldo + Bens"}),". Eis o pdio:"]}),a.jsxs("div",{style:Yn.podium,children:[a.jsx(Wl,{place:"second",player:s}),a.jsx(Wl,{place:"first",player:o,big:!0}),a.jsx(Wl,{place:"third",player:i})]}),a.jsx("div",{style:{display:"flex",gap:12,marginTop:18,flexWrap:"wrap",justifyContent:"center"},children:a.jsx("button",{style:Yn.btn,onClick:l,children:" Voltar aos Lobbies"})})]})})}function Wl({place:t,player:e,big:n}){if(!e)return a.jsx("div",{style:{width:220}});const r={first:Vl("#d4af37","#f5d76e"),second:Vl("#9fa4ad","#cfd4db"),third:Vl("#b87333","#d28c45")},o={first:"1",second:"2",third:"3"}[t],s=r[t].ring,i=r[t].face;return a.jsxs("div",{style:{...Yn.medalCol,transform:n?"translateY(-18px)":"none"},children:[a.jsx("div",{style:Yn.ribbon}),a.jsx("div",{style:{...Yn.medal,...s,width:n?180:150,height:n?180:150},children:a.jsx("div",{style:{...Yn.medalFace,...i},children:a.jsx("div",{style:Yn.medalNumber,children:o})})}),a.jsxs("div",{style:Yn.cardBelow,children:[a.jsx("div",{style:{fontWeight:900,fontSize:16,lineHeight:1.2,textAlign:"center"},children:e.name}),a.jsxs("div",{style:{opacity:.9,fontSize:13,marginTop:4,textAlign:"center"},children:["Saldo: ",a.jsxs("b",{children:["$ ",Number(e.cash||0).toLocaleString()]}),a.jsx("br",{}),"Bens: ",a.jsxs("b",{children:["$ ",Number(e.bens||0).toLocaleString()]})]}),a.jsxs("div",{style:{marginTop:6,fontWeight:900,textAlign:"center"},children:["Patrimnio: ",a.jsxs("b",{children:["$ ",Number(e.patrimonio||0).toLocaleString()]})]})]})]})}function Vl(t,e){return{ring:{background:`radial-gradient(circle at 35% 30%, ${e} 0%, ${t} 65%, #000 120%)`,boxShadow:"0 12px 30px rgba(0,0,0,.35), inset 0 0 12px rgba(255,255,255,.12)"},face:{background:`conic-gradient(from 0deg, ${e}, ${t}, ${e})`}}}const Yn={wrap:{pointerEvents:"auto",border:"1px solid rgba(255,255,255,.15)",background:"#11161f",color:"#eef1f6",borderRadius:16,padding:20,width:"min(900px, 92vw)",maxWidth:"92vw",textAlign:"center"},title:{margin:"0 0 6px",fontWeight:900,fontSize:28},subtitle:{margin:"0 0 14px",opacity:.9},podium:{display:"flex",alignItems:"flex-end",justifyContent:"center",gap:24,padding:"10px 0",flexWrap:"wrap"},medalCol:{display:"flex",flexDirection:"column",alignItems:"center"},ribbon:{width:16,height:70,background:"linear-gradient(#e41f1f,#9e1313)",borderRadius:4,marginBottom:-12},medal:{borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",border:"3px solid rgba(255,255,255,.18)"},medalFace:{width:"85%",height:"85%",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"inset 0 8px 18px rgba(0,0,0,.35), inset 0 -6px 10px rgba(255,255,255,.08)"},medalNumber:{fontWeight:900,fontSize:28,letterSpacing:1,textShadow:"0 2px 4px rgba(0,0,0,.45)"},cardBelow:{background:"#19202c",border:"1px solid rgba(255,255,255,.12)",borderRadius:12,padding:"10px 12px",width:220,marginTop:10},btn:{background:"#2a3342",color:"#fff",border:"1px solid rgba(255,255,255,.18)",borderRadius:10,padding:"10px 14px",fontWeight:800,cursor:"pointer"}},Nm=E.createContext(null);function rb({children:t}){const[e,n]=E.useState([]),r=E.useRef(null),o=d=>{const p=r.current;r.current=null,n(h=>h.slice(0,-1)),p&&p(d)},s=()=>o({action:"SKIP"}),i=()=>o(!1),l=d=>{var y;const p=((y=crypto==null?void 0:crypto.randomUUID)==null?void 0:y.call(crypto))||String(Date.now()+Math.random()),h=ue.cloneElement(d,{onResolve:b=>o(b)});n(b=>[...b,{id:p,el:h}])},u=()=>new Promise(d=>{r.current=d}),c=E.useMemo(()=>({pushModal:l,awaitTop:u,resolveTop:o,closeModal:s,popModal:i}),[]);return a.jsxs(Nm.Provider,{value:c,children:[t,e.map(({id:d,el:p})=>a.jsx(ue.Fragment,{children:p},d))]})}const un=()=>E.useContext(Nm);function ob({playerName:t="Jogador"}){const{resolveTop:e,closeModal:n}=un();return a.jsx(wi,{width:700,onClose:n,children:a.jsx("div",{className:"bankruptcyModal",children:a.jsxs("div",{className:"paper",style:{padding:24},children:[a.jsx("h2",{style:{marginTop:0},children:"Declarar Falncia"}),a.jsxs("p",{children:["Tem certeza que deseja declarar ",a.jsx("b",{children:"Falncia"}),", ",a.jsx("b",{children:t}),"?",a.jsx("br",{}),"Esta ao  irreversvel e voc no poder mais jogar."]}),a.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end",marginTop:24},children:[a.jsx("button",{onClick:()=>{n(),e(!1)},className:"btn",children:"Cancelar"}),a.jsx("button",{onClick:()=>{n(),e(!0)},className:"btn btn-danger",children:"Sim, declarar falncia"})]})]})})})}const Ae={comum:{cap:2,baseFat:600,incFat:100,baseDesp:1e3,incDesp:100},inside:{cap:5,baseFat:1500,incFat:500,baseDesp:2e3,incDesp:100},field:{cap:5,baseFat:1500,incFat:500,baseDesp:2e3,incDesp:100},gestor:{baseDesp:3e3,incDesp:500}},ir={A:{fat:1e3,desp:400},B:{fat:500,desp:200},C:{fat:200,desp:100},D:{fat:70,desp:50}},ar={A:{fatPerClient:1200,despPerClient:700},B:{fatPerClient:600,despPerClient:400},C:{fatPerClient:300,despPerClient:200},D:{fatPerClient:100,despPerClient:50}},Pa=[0,.2,.3,.4,.6],Dm=7,an=t=>Number(t||0),vr=(t={},e)=>{var n;return new Set(((n=t==null?void 0:t.trainingsByVendor)==null?void 0:n[e])||[]).size},sb=t=>vr(t,"gestor");function La(t={}){const e=Math.max(0,an(t.vendedoresComuns)),n=Math.max(0,an(t.insideSales)),r=Math.max(0,an(t.fieldSales)),o=e*Ae.comum.cap,s=n*Ae.inside.cap,i=r*Ae.field.cap,l=o+s+i,u=Math.max(0,an(t.clients)),c=Math.min(u,l);return{cap:l,inAtt:c}}function ol(t={}){var k,N;const e=an(t.vendedoresComuns),n=an(t.insideSales),r=an(t.fieldSales),o=an(t.gestores??t.gestoresComerciais??t.managers),s=vr(t,"comum"),i=vr(t,"inside"),l=vr(t,"field"),u=vr(t,"gestor"),c=e*(Ae.comum.baseFat+Ae.comum.incFat*s),d=n*(Ae.inside.baseFat+Ae.inside.incFat*i),p=r*(Ae.field.baseFat+Ae.field.incFat*l);let h=c+d+p;const y=e+n+r,b=y>0?Math.min(1,o*Dm/y):0,v=Math.max(0,u),S=Pa[Math.min(v,Pa.length-1)]||0;h=h*(1+b*S);const g=String(t.mixProdutos||"D").toUpperCase(),f=(((k=ar[g])==null?void 0:k.fatPerClient)||0)*an(t.clients),m=String(t.erpLevel||"D").toUpperCase(),w=y+o,_=(((N=ir[m])==null?void 0:N.fat)||0)*w,R=an(t.revenue);return Math.max(0,Math.floor(h+f+_+R))}function sl(t={}){var _,R;const e=an(t.vendedoresComuns),n=an(t.insideSales),r=an(t.fieldSales),o=an(t.gestores??t.gestoresComerciais??t.managers),s=vr(t,"comum"),i=vr(t,"inside"),l=vr(t,"field"),u=vr(t,"gestor"),c=e*(Ae.comum.baseDesp+Ae.comum.incDesp*s),d=n*(Ae.inside.baseDesp+Ae.inside.incDesp*i),p=r*(Ae.field.baseDesp+Ae.field.incDesp*l),h=o*(Ae.gestor.baseDesp+Ae.gestor.incDesp*u),y=String(t.mixProdutos||"D").toUpperCase(),b=(((_=ar[y])==null?void 0:_.despPerClient)||0)*an(t.clients),v=String(t.erpLevel||"D").toUpperCase(),S=e+n+r+o,g=(((R=ir[v])==null?void 0:R.desp)||0)*S;return Math.max(0,Math.floor(c+d+p+h+b+g+0+1e3))}function Ft(t,e={}){var o,s;const n={...t},r=(i,l)=>{n[i]=(n[i]??0)+l};if(Number.isFinite(e.cashDelta)&&r("cash",Number(e.cashDelta)),Number.isFinite(e.clientsDelta)&&r("clients",Number(e.clientsDelta)),Number.isFinite(e.manutencaoDelta)&&r("manutencao",Number(e.manutencaoDelta)),Number.isFinite(e.bensDelta)&&r("bens",Number(e.bensDelta)),Number.isFinite(e.vendedoresComunsDelta)&&r("vendedoresComuns",Number(e.vendedoresComunsDelta)),Number.isFinite(e.fieldSalesDelta)&&r("fieldSales",Number(e.fieldSalesDelta)),Number.isFinite(e.insideSalesDelta)&&r("insideSales",Number(e.insideSalesDelta)),Number.isFinite(e.gestoresDelta)){const i=Number(e.gestoresDelta);n.gestores=(n.gestores??0)+i,n.gestoresComerciais=(n.gestoresComerciais??0)+i,n.managers=(n.managers??0)+i}if(Number.isFinite(e.revenueDelta)&&r("revenue",Number(e.revenueDelta)),typeof e.mixProdutosSet<"u"){n.mixProdutos=e.mixProdutosSet;const i=String(e.mixProdutosSet).toUpperCase();["A","B","C","D"].includes(i)&&(n.mixOwned={...n.mixOwned||{},[i]:!0},(o=n.reducedLevels)!=null&&o.MIX&&(n.reducedLevels={...n.reducedLevels,MIX:n.reducedLevels.MIX.filter(l=>l!==i)}))}if(e.mixBaseSet&&(n.mixBase={...n.mixBase||{},...e.mixBaseSet}),typeof e.erpLevelSet<"u"){n.erpLevel=e.erpLevelSet;const i=String(e.erpLevelSet).toUpperCase();["A","B","C","D"].includes(i)&&(n.erpOwned={...n.erpOwned||{},[i]:!0},(s=n.reducedLevels)!=null&&s.ERP&&(n.reducedLevels={...n.reducedLevels,ERP:n.reducedLevels.ERP.filter(l=>l!==i)}))}return Array.isArray(e.trainingsPush)&&e.trainingsPush.length&&(n.trainings=[...n.trainings||[],...e.trainingsPush]),Array.isArray(e.directBuysPush)&&e.directBuysPush.length&&(n.directBuys=[...n.directBuys||[],...e.directBuysPush]),n}function Pf(t,e){const{purchases:n=[],grandTotal:r=0}=e||{},o={personalizado:"az",fieldsales:"am",imersaomultiplier:"rox"},s={...t};return s.cash=(s.cash??0)-Number(r||0),s.bens=(s.bens??0)+Number(r||0),s.onboarding=!0,n.forEach(i=>{var p;const{vendorType:l,items:u=[]}=i||{};u.forEach(h=>{const y=o[h==null?void 0:h.id];y&&(s[y]=(s[y]??0)+1)});const c=String(l||"comum"),d=new Set(((p=s.trainingsByVendor)==null?void 0:p[c])||[]);u.forEach(h=>{h!=null&&h.id&&d.add(h.id)}),s.trainingsByVendor={...s.trainingsByVendor||{},[c]:Array.from(d)}}),s}function Gl(t,e,n){return t===e?!1:t<e?n>t&&n<=e:n>t||n<=e}function Ks(t){return t.reduce((e,n)=>e+(n!=null&&n.bankrupt?0:1),0)}function Ds(t,e){var s;const n=t.length;if(n===0)return 0;let r=(e+1)%n,o=0;for(;o<n;){if(!((s=t[r])!=null&&s.bankrupt))return r;r=(r+1)%n,o++}return e}class Am{constructor(){this.errors=[],this.warnings=[]}validateGameState(e,n,r,o,s){return this.errors=[],this.warnings=[],this.validatePlayers(e),this.validateTurnState(e,n),this.validateGameOverState(e,o,s),this.validateRoundState(e,r),{isValid:this.errors.length===0,errors:this.errors,warnings:this.warnings}}validatePlayers(e){if(!Array.isArray(e)||e.length===0){this.addError("Jogadores invlidos: deve ser um array no vazio");return}e.forEach((n,r)=>{this.validatePlayer(n,r)}),this.validatePlayerUniqueness(e),this.validateAlivePlayers(e)}validatePlayer(e,n){const r=`Jogador ${n+1} (${e.name||"Sem nome"})`;e.id||this.addError(`${r}: ID  obrigatrio`),(typeof e.cash!="number"||e.cash<0)&&this.addError(`${r}: Cash deve ser um nmero no negativo (atual: ${e.cash})`),(typeof e.clients!="number"||e.clients<0)&&this.addError(`${r}: Clientes deve ser um nmero no negativo (atual: ${e.clients})`),this.validateResourceCounts(e,r),this.validateCalculations(e,r)}validateResourceCounts(e,n){["vendedoresComuns","fieldSales","insideSales","gestores","gestoresComerciais","managers"].forEach(s=>{const i=e[s];i!==void 0&&(typeof i!="number"||i<0)&&this.addError(`${n}: ${s} deve ser um nmero no negativo (atual: ${i})`)}),["az","am","rox"].forEach(s=>{const i=e[s];i!==void 0&&(typeof i!="number"||i<0)&&this.addError(`${n}: Certificado ${s} deve ser um nmero no negativo (atual: ${i})`)})}validateCalculations(e,n){try{const r=ol(e),o=sl(e),{cap:s,inAtt:i}=La(e);(typeof r!="number"||r<0)&&this.addError(`${n}: Faturamento calculado invlido: ${r}`),(typeof o!="number"||o<0)&&this.addError(`${n}: Manuteno calculada invlida: ${o}`),(typeof s!="number"||s<0)&&this.addError(`${n}: Capacidade calculada invlida: ${s}`),(typeof i!="number"||i<0||i>s)&&this.addError(`${n}: Clientes em atendimento invlido: ${i} (capacidade: ${s})`),this.isInitialState(e)&&o!==1150&&this.addError(`${n}: Manuteno inicial deve ser 1150, mas  ${o}`)}catch(r){this.addError(`${n}: Erro ao calcular faturamento/manuteno: ${r.message}`)}}isInitialState(e){return e.vendedoresComuns===1&&e.clients===1&&e.fieldSales===0&&e.insideSales===0&&e.gestores===0&&e.mixProdutos==="D"&&e.erpLevel==="D"&&(e.az||0)===0&&(e.am||0)===0&&(e.rox||0)===0}validatePlayerUniqueness(e){const n=e.map(o=>o.id).filter(Boolean),r=new Set(n);n.length!==r.size&&this.addError("IDs de jogadores devem ser nicos")}validateAlivePlayers(e){const n=Ks(e);n===0&&this.addError("No pode haver zero jogadores vivos"),n===1&&this.addWarning("Apenas 1 jogador vivo - jogo deve terminar")}validateTurnState(e,n){if(typeof n!="number"||n<0||n>=e.length){this.addError(`TurnIdx invlido: ${n} (deve estar entre 0 e ${e.length-1})`);return}const r=e[n];if(!r){this.addError(`Jogador do turno no encontrado no ndice ${n}`);return}r.bankrupt&&this.addError(`Jogador do turno (${r.name}) est falido`)}validateGameOverState(e,n,r){const o=Ks(e);n&&o>1&&this.addError("Jogo marcado como terminado mas h mais de 1 jogador vivo"),n&&!r&&this.addError("Jogo terminado mas no h vencedor definido"),r&&!n&&this.addError("H vencedor definido mas jogo no terminou"),r&&r.bankrupt&&this.addError("Vencedor no pode estar falido")}validateRoundState(e,n){(typeof n!="number"||n<1)&&this.addError(`Rodada invlida: ${n} (deve ser >= 1)`),n>10&&this.addWarning(`Rodada muito alta: ${n} (jogo pode estar travado)`)}validateAction(e,n,r){switch(this.errors=[],this.warnings=[],e.type){case"MOVE":this.validateMoveAction(e,n);break;case"BUY":this.validateBuyAction(e,n);break;case"HIRE":this.validateHireAction(e,n);break;case"BANKRUPT":this.validateBankruptAction(e,n);break;default:this.addWarning(`Tipo de ao no reconhecido: ${e.type}`)}return{isValid:this.errors.length===0,errors:this.errors,warnings:this.warnings}}validateMoveAction(e,n){(typeof e.steps!="number"||e.steps<1||e.steps>6)&&this.addError(`Passos invlidos: ${e.steps} (deve estar entre 1 e 6)`)}validateBuyAction(e,n){const r=e.cost||e.price||0;r>n.cash&&this.addError(`Saldo insuficiente: precisa de ${r}, tem ${n.cash}`)}validateHireAction(e,n){const r=e.cost||0;r>n.cash&&this.addError(`Saldo insuficiente para contratao: precisa de ${r}, tem ${n.cash}`)}validateBankruptAction(e,n){n.bankrupt||this.addWarning("Jogador declarando falncia mas no est marcado como falido")}addError(e){this.errors.push(e)}addWarning(e){this.warnings.push(e)}}function ib(t,e,n,r,o){return new Am().validateGameState(t,e,n,r,o)}function ab(t,e,n){return new Am().validateAction(t,e,n)}class lb{constructor(){this.enabled=!1,this.logs=[],this.maxLogs=1e4,this.originalConsole={log:console.log,warn:console.warn,error:console.error,debug:console.debug,info:console.info},this.prefixes=["[DEBUG]","[NET]","[App]","[SG]","[Controls]","[HUD]","[DEBUG MODE]","[PlayersLobby]","[leaveRoom]","[GameNet]","[useTurnEngine]","[useGameSync]"]}shouldCapture(e){if(!this.enabled)return!1;const n=e.map(r=>{if(typeof r=="object")try{return JSON.stringify(r)}catch{return String(r)}return String(r)}).join(" ");return this.prefixes.some(r=>n.includes(r))}addLog(e,n){this.logs.length>=this.maxLogs&&(this.logs=this.logs.slice(-Math.floor(this.maxLogs*.9)));const r=Date.now(),o={timestamp:r,time:new Date(r).toISOString(),level:e,args:n.map(s=>{if(typeof s=="object"&&s!==null)try{return JSON.parse(JSON.stringify(s,(i,l)=>typeof l=="function"?"[Function]":l===void 0?"[undefined]":Array.isArray(l)&&l.length>100?`[Array(${l.length}) - truncado]`:l))}catch{return String(s)}return s}),message:n.map(s=>{if(typeof s=="object")try{return JSON.stringify(s)}catch{return String(s)}return String(s)}).join(" ")};this.logs.push(o)}interceptLog(...e){this.shouldCapture(e)&&this.addLog("log",e),this.originalConsole.log.apply(console,e)}interceptWarn(...e){this.shouldCapture(e)&&this.addLog("warn",e),this.originalConsole.warn.apply(console,e)}interceptError(...e){this.addLog("error",e),this.originalConsole.error.apply(console,e)}interceptDebug(...e){this.shouldCapture(e)&&this.addLog("debug",e),this.originalConsole.debug.apply(console,e)}interceptInfo(...e){this.shouldCapture(e)&&this.addLog("info",e),this.originalConsole.info.apply(console,e)}enable(){this.enabled||(this.enabled=!0,console.log=this.interceptLog.bind(this),console.warn=this.interceptWarn.bind(this),console.error=this.interceptError.bind(this),console.debug=this.interceptDebug.bind(this),console.info=this.interceptInfo.bind(this),console.log("[LogCapture]  Captura de logs ativada"))}disable(){this.enabled&&(this.enabled=!1,console.log=this.originalConsole.log,console.warn=this.originalConsole.warn,console.error=this.originalConsole.error,console.debug=this.originalConsole.debug,console.info=this.originalConsole.info,console.log("[LogCapture]  Captura de logs desativada"))}clear(){this.logs=[],console.log("[LogCapture]  Histrico de logs limpo")}getLogs(){return[...this.logs]}getStats(){const e=this.logs.length,n={log:0,warn:0,error:0,debug:0,info:0};return this.logs.forEach(r=>{n[r.level]=(n[r.level]||0)+1}),{total:e,byLevel:n,enabled:this.enabled}}exportAsText(){const e=["=".repeat(80),"RELATRIO DE LOGS - Sales Game","=".repeat(80),`Data/Hora: ${new Date().toISOString()}`,`Total de logs: ${this.logs.length}`,`Estatsticas: ${JSON.stringify(this.getStats(),null,2)}`,"=".repeat(80),""];return this.logs.forEach(n=>{const r={log:"",warn:"",error:"",debug:"",info:""}[n.level]||"";e.push(`[${n.time}] ${r} [${n.level.toUpperCase()}]`),n.args.forEach((o,s)=>{typeof o=="object"?e.push(`  Arg ${s+1}: ${JSON.stringify(o,null,2)}`):e.push(`  Arg ${s+1}: ${o}`)}),e.push("")}),e.join(`
`)}exportAsJSON(){return{timestamp:new Date().toISOString(),stats:this.getStats(),logs:this.logs}}exportFull(){return{timestamp:new Date().toISOString(),stats:this.getStats(),text:this.exportAsText(),json:this.exportAsJSON()}}}const ur=new lb,ub=()=>ur.clear(),nc=()=>ur.getStats(),cb=()=>ur.exportAsText(),db=()=>ur.exportAsJSON();class fb{constructor(){this.enabled=!1,this.validationHistory=[],this.maxHistorySize=100}toggle(){return this.enabled=!this.enabled,this.enabled&&ur.enable(),console.log(`[DEBUG MODE] ${this.enabled?"ATIVADO":"DESATIVADO"}`),this.enabled}validateGameState(e,n,r,o,s,i=""){if(!this.enabled)return;const l=ib(e,n,r,o,s);return this.addToHistory({type:"GAME_STATE",context:i,timestamp:Date.now(),result:l}),l.isValid||console.error("[DEBUG MODE]  Estado do jogo invlido:",l.errors),l.warnings.length>0&&console.warn("[DEBUG MODE]  Avisos:",l.warnings),l}validateAction(e,n,r,o=""){if(!this.enabled)return;const s=ab(e,n,r);return this.addToHistory({type:"ACTION",context:o,timestamp:Date.now(),action:e.type,player:n.name,result:s}),s.isValid||console.error(`[DEBUG MODE]  Ao invlida (${e.type}):`,s.errors),s}validateResourceChange(e,n,r,o){if(!this.enabled)return;const s=[],i=[];if(n.clients!==r.clients){const c=r.clients-n.clients;r.clients<0&&s.push(`Clientes no pode ser negativo: ${r.clients}`),Math.abs(c)>10&&i.push(`Mudana grande de clientes: ${c}`)}if(n.cash!==r.cash){const c=r.cash-n.cash;r.cash<0&&s.push(`Cash no pode ser negativo: ${r.cash}`),Math.abs(c)>5e4&&i.push(`Mudana grande de cash: ${c}`)}["vendedoresComuns","fieldSales","insideSales","gestores"].forEach(c=>{if(n[c]!==r[c]){const d=r[c]-n[c];r[c]<0&&s.push(`${c} no pode ser negativo: ${r[c]}`),Math.abs(d)>5&&i.push(`Mudana grande de ${c}: ${d}`)}});const u={isValid:s.length===0,errors:s,warnings:i};return this.addToHistory({type:"RESOURCE_CHANGE",context:o,timestamp:Date.now(),player:e.name,oldState:n,newState:r,result:u}),u.isValid||console.error("[DEBUG MODE]  Mudana de recurso invlida:",u.errors),u}validateCalculations(e,n=""){if(this.enabled)try{const r=ol(e),o=sl(e),{cap:s,inAtt:i}=La(e),l=[],u=[];(typeof r!="number"||r<0)&&l.push(`Faturamento invlido: ${r}`),(typeof o!="number"||o<0)&&l.push(`Manuteno invlida: ${o}`),(typeof s!="number"||s<0)&&l.push(`Capacidade invlida: ${s}`),(typeof i!="number"||i<0||i>s)&&l.push(`Clientes em atendimento invlido: ${i} (capacidade: ${s})`),this.isInitialState(e)&&o!==1150&&l.push(`Manuteno inicial deve ser 1150, mas  ${o}`);const c={isValid:l.length===0,errors:l,warnings:u,calculations:{faturamento:r,manutencao:o,cap:s,inAtt:i}};return this.addToHistory({type:"CALCULATIONS",context:n,timestamp:Date.now(),player:e.name,result:c}),c.isValid||console.error("[DEBUG MODE]  Clculos invlidos:",c.errors),c}catch(r){return console.error("[DEBUG MODE]  Erro ao validar clculos:",r),{isValid:!1,errors:[r.message],warnings:[]}}}isInitialState(e){return e.vendedoresComuns===1&&e.clients===1&&e.fieldSales===0&&e.insideSales===0&&e.gestores===0&&e.mixProdutos==="D"&&e.erpLevel==="D"}addToHistory(e){this.validationHistory.unshift(e),this.validationHistory.length>this.maxHistorySize&&(this.validationHistory=this.validationHistory.slice(0,this.maxHistorySize))}getHistory(){return this.validationHistory}clearHistory(){this.validationHistory=[]}getStats(){const e=this.validationHistory.length,n=this.validationHistory.filter(o=>!o.result.isValid).length,r=this.validationHistory.filter(o=>o.result.warnings.length>0).length;return{total:e,errors:n,warnings:r,errorRate:e>0?n/e*100:0,warningRate:e>0?r/e*100:0}}exportReport(){const e=this.getStats(),n={timestamp:new Date().toISOString(),stats:e,history:this.validationHistory};return console.log("[DEBUG MODE]  Relatrio de validao:",n),n}exportFullReport(){const e=this.exportReport(),n=ur.exportFull();return{timestamp:new Date().toISOString(),validation:e,logs:n,text:this.exportFullReportAsText(e,n)}}exportFullReportAsText(e,n){return["=".repeat(80),"RELATRIO COMPLETO DE DEBUG - Sales Game","=".repeat(80),`Data/Hora: ${new Date().toISOString()}`,"","--- VALIDAES ---",`Total de validaes: ${e.stats.total}`,`Erros: ${e.stats.errors}`,`Avisos: ${e.stats.warnings}`,`Taxa de erro: ${e.stats.errorRate.toFixed(2)}%`,"","--- LOGS CAPTURADOS ---",`Total de logs: ${n.stats.total}`,`Logs por nvel: ${JSON.stringify(n.stats.byLevel,null,2)}`,"","--- HISTRICO DE VALIDAES ---",...e.history.map(o=>`[${new Date(o.timestamp).toISOString()}] ${o.type} - ${o.context||""} - ${JSON.stringify(o.result,null,2)}`),"","--- LOGS DETALHADOS ---",n.text,"=".repeat(80)].join(`
`)}}const ko=new fb,hb=(t,e,n,r,o,s)=>ko.validateGameState(t,e,n,r,o,s),pb=(t,e)=>ko.validateCalculations(t,e),Lf=()=>ko.getStats(),mb=()=>ko.exportReport(),Om=()=>ko.exportFullReport(),ql="__CASH_AUDIT__";function xs(){return typeof window>"u"?null:(window[ql]||(window[ql]={enabled:!1,entries:[],maxEntries:5e3,currentMeta:null}),window[ql])}function Tm(t={}){const e=xs();return e?(typeof t.enabled=="boolean"&&(e.enabled=t.enabled),Number.isFinite(t.maxEntries)&&t.maxEntries>0&&(e.maxEntries=Math.floor(t.maxEntries)),{enabled:e.enabled,maxEntries:e.maxEntries,size:e.entries.length}):{enabled:!1}}function gb(t){const e=xs();e&&(e.currentMeta=t||null)}function Pm(t){const e=Number(t.beforeCash),n=Number(t.afterCash),r=Number(t.delta);if(!Number.isFinite(n)||Number.isNaN(n)||!Number.isFinite(r)||Number.isNaN(r)||n<-1e9||n>1e9)return"ERROR";const o=String(t.actionType||""),s=/PAY|EXPENSE|OPS|DEBT/i.test(o);return Math.abs(r)>=5e3||s&&r>0||Number.isFinite(e)&&Number.isFinite(n)&&n-e!==r?"WARN":"INFO"}function If(t){const e=xs();if(!e||!e.enabled)return;const n={...t};if(n.traceId=n.traceId||"unknown",n.ts=n.ts||new Date().toISOString(),n.severity=n.severity||Pm(n),n.severity==="ERROR"&&!n.stack)try{n.stack=new Error("cashAudit").stack}catch{}e.entries.push(n),e.entries.length>e.maxEntries&&e.entries.splice(0,e.entries.length-e.maxEntries);const r=Number(n.delta||0),o=Number(n.afterCash||0),s=n.playerName||n.playerId,i=n.reason||"UNKNOWN_CASH_CHANGE",l=n.severity||"INFO";console.groupCollapsed(`[CASH] ${l} ${r} -> ${o} | ${s} | ${i}`),console.log(n),console.groupEnd()}function $f(t){return Array.isArray(t)?t:t&&Array.isArray(t.players)?t.players:null}function yb(t,e,n=null){var h;const r=xs();if(!r||!r.enabled)return;const o=$f(t)||[],s=$f(e)||[],i=new Map(o.map(y=>[String(y==null?void 0:y.id),y||{}])),l=new Map(s.map(y=>[String(y==null?void 0:y.id),y||{}])),u=new Set([...i.keys(),...l.keys()]),c=n||r.currentMeta||{},d=c.origin||{},p=c.context||{};for(const y of u){const b=i.get(y),v=l.get(y);if(!b&&v){If({ts:new Date().toISOString(),traceId:c.traceId||"unknown",actionType:c.actionType||"PLAYER_ADDED",reason:c.reason||"PLAYER_ADDED",severity:"INFO",playerId:y,playerName:v==null?void 0:v.name,beforeCash:0,afterCash:Number((v==null?void 0:v.cash)||0),delta:Number((v==null?void 0:v.cash)||0),origin:d,context:p});continue}if(!v&&b)continue;const S=Number((b==null?void 0:b.cash)||0),g=Number((v==null?void 0:v.cash)||0);if(S===g)continue;const f=g-S,m={ts:new Date().toISOString(),traceId:c.traceId||"unknown",actionType:c.actionType||"UNKNOWN",reason:c.reason||"UNKNOWN_CASH_CHANGE",playerId:y,playerName:v==null?void 0:v.name,beforeCash:S,afterCash:g,delta:f,origin:{...d,file:d.file,fn:d.fn,modal:d.modal,component:d.component},context:{round:p.round,pos:Number.isFinite(Number(v==null?void 0:v.pos))?Number(v.pos):p.pos,tile:p.tile,debt:p.debt,loanPending:Number(((h=v==null?void 0:v.loanPending)==null?void 0:h.amount)||0)||p.loanPending,opsExpense:p.opsExpense,revenue:p.revenue}};m.severity=Pm(m),If(m)}}function vb({download:t=!1,filename:e}={}){var s;const n=xs(),r={exportedAt:new Date().toISOString(),enabled:!!(n!=null&&n.enabled),size:((s=n==null?void 0:n.entries)==null?void 0:s.length)||0,entries:(n==null?void 0:n.entries)||[]},o=JSON.stringify(r,null,2);if(t&&typeof window<"u")try{const i=new Blob([o],{type:"application/json"}),l=URL.createObjectURL(i),u=document.createElement("a");u.href=l,u.download=e||`cash-audit-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.json`,u.click(),URL.revokeObjectURL(l)}catch(i){console.warn("[cashAudit] download failed",i)}return o}function xb(){const t=xs();t&&(t.entries=[])}function bb({players:t,turnIdx:e,round:n,gameOver:r,winner:o}){var j,L;const[s,i]=E.useState(!1),[l,u]=E.useState({total:0,errors:0,warnings:0,errorRate:0,warningRate:0}),[c,d]=E.useState({total:0,byLevel:{},enabled:!1}),[p,h]=E.useState(!1),[y,b]=E.useState({x:0,y:0}),[v,S]=E.useState({x:0,y:0}),g=E.useRef(null);E.useEffect(()=>{const U=()=>{u(Lf()),d(nc())};U();const B=setInterval(U,1e3);return()=>clearInterval(B)},[]);const f=()=>{const U=ko.toggle();i(U)},m=()=>{const U=mb(),B=new Blob([JSON.stringify(U,null,2)],{type:"application/json"}),q=URL.createObjectURL(B),Ue=document.createElement("a");Ue.href=q,Ue.download=`debug-report-${new Date().toISOString().slice(0,19)}.json`,Ue.click(),URL.revokeObjectURL(q)},w=()=>{const U=Om(),B=new Blob([U.text],{type:"text/plain;charset=utf-8"}),q=URL.createObjectURL(B),Ue=document.createElement("a");Ue.href=q,Ue.download=`debug-logs-completo-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.txt`,Ue.click(),URL.revokeObjectURL(q);const wt=new Blob([JSON.stringify(U,null,2)],{type:"application/json"}),Z=URL.createObjectURL(wt),F=document.createElement("a");F.href=Z,F.download=`debug-logs-completo-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.json`,F.click(),URL.revokeObjectURL(Z),console.log("[DebugPanel]  Relatrio completo exportado (texto + JSON)")},_=()=>{ko.clearHistory(),ub(),xb(),u(Lf()),d(nc()),console.log("[DebugPanel]  Todos os logs foram limpos")},R=()=>{const U=vb({download:!0});console.log("[CashAudit] export json:",U)},D=()=>{var B;const U=!!((B=window.__CASH_AUDIT__)!=null&&B.enabled);Tm({enabled:!U}),console.log("[CashAudit] enabled =",!U)},k=U=>{if(U.target.closest("button"))return;h(!0);const B=g.current.getBoundingClientRect();S({x:U.clientX-B.left,y:U.clientY-B.top})},N=U=>{p&&b({x:U.clientX-v.x,y:U.clientY-v.y})},x=()=>{h(!1)};return E.useEffect(()=>{if(p)return document.addEventListener("mousemove",N),document.addEventListener("mouseup",x),()=>{document.removeEventListener("mousemove",N),document.removeEventListener("mouseup",x)}},[p,v]),s?a.jsxs("div",{ref:g,style:{position:"fixed",top:y.y||10,left:y.x||10,zIndex:9999,background:"#1a1a1a",color:"#fff",padding:"12px",borderRadius:"8px",border:"1px solid #333",minWidth:"300px",maxHeight:"80vh",overflow:"auto",fontSize:"12px",fontFamily:"monospace",cursor:p?"grabbing":"grab",userSelect:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},onMouseDown:k,children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[a.jsx("h3",{style:{margin:0,color:"#4CAF50"},children:" Debug Panel"}),a.jsx("button",{onClick:f,style:{background:"#ff4444",color:"#fff",border:"none",borderRadius:"4px",padding:"4px 8px",cursor:"pointer",fontSize:"10px"},children:""})]}),a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("h4",{style:{margin:"0 0 8px 0",color:"#FFC107"},children:" Estatsticas de Validao"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px"},children:[a.jsxs("div",{children:["Total: ",l.total]}),a.jsxs("div",{style:{color:l.errors>0?"#ff4444":"#4CAF50"},children:["Erros: ",l.errors]}),a.jsxs("div",{style:{color:l.warnings>0?"#FFC107":"#4CAF50"},children:["Avisos: ",l.warnings]}),a.jsxs("div",{children:["Taxa Erro: ",l.errorRate.toFixed(1),"%"]})]})]}),a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("h4",{style:{margin:"0 0 8px 0",color:"#FFC107"},children:" Estatsticas de Logs"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px"},children:[a.jsxs("div",{children:["Total: ",c.total]}),a.jsxs("div",{style:{color:c.enabled?"#4CAF50":"#ff4444"},children:["Status: ",c.enabled?" Ativo":" Inativo"]}),c.byLevel&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:["Logs: ",c.byLevel.log||0]}),a.jsxs("div",{style:{color:"#FFC107"},children:["Warns: ",c.byLevel.warn||0]}),a.jsxs("div",{style:{color:"#ff4444"},children:["Errors: ",c.byLevel.error||0]}),a.jsxs("div",{children:["Debug: ",c.byLevel.debug||0]})]})]})]}),a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("h4",{style:{margin:"0 0 8px 0",color:"#FFC107"},children:" Estado do Jogo"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px"},children:[a.jsxs("div",{children:["Jogadores: ",t.length]}),a.jsxs("div",{children:["Turno: ",e+1]}),a.jsxs("div",{children:["Rodada: ",n]}),a.jsxs("div",{style:{color:r?"#ff4444":"#4CAF50"},children:["Status: ",r?"Fim":"Ativo"]}),o&&a.jsxs("div",{children:["Vencedor: ",o.name]})]})]}),a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("h4",{style:{margin:"0 0 8px 0",color:"#FFC107"},children:" Jogadores"}),t.map((U,B)=>{var q;return a.jsxs("div",{style:{background:B===e?"#333":"transparent",padding:"4px",borderRadius:"4px",marginBottom:"2px",border:U.bankrupt?"1px solid #ff4444":"1px solid transparent"},children:[a.jsxs("div",{style:{fontWeight:"bold"},children:[U.name," ",U.bankrupt?"":""," ",B===e?"":""]}),a.jsxs("div",{style:{fontSize:"10px",opacity:.8},children:["Cash: $",((q=U.cash)==null?void 0:q.toLocaleString())||0," | Clientes: ",U.clients||0," | Vendedores: ",U.vendedoresComuns||0]})]},U.id)})]}),a.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[a.jsx("button",{onClick:w,style:{background:"#2196F3",color:"#fff",border:"none",borderRadius:"4px",padding:"6px 12px",cursor:"pointer",fontSize:"10px",fontWeight:"bold"},title:"Exporta relatrio completo com todos os logs (texto + JSON)",children:" Exportar Logs Completos"}),a.jsx("button",{onClick:m,style:{background:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",padding:"6px 12px",cursor:"pointer",fontSize:"10px"},title:"Exporta apenas relatrio de validao (JSON)",children:" Exportar Validao"}),a.jsx("button",{onClick:_,style:{background:"#FF9800",color:"#fff",border:"none",borderRadius:"4px",padding:"6px 12px",cursor:"pointer",fontSize:"10px"},title:"Limpa todos os logs e histrico de validao",children:" Limpar Tudo"}),a.jsx("button",{onClick:R,style:{background:"#8e44ad",color:"#fff",border:"none",borderRadius:"4px",padding:"6px 12px",cursor:"pointer",fontSize:"10px"},title:"Exporta o audit log de saldo (JSON)",children:" Exportar Cash Audit"}),a.jsx("button",{onClick:D,style:{background:(j=window.__CASH_AUDIT__)!=null&&j.enabled?"#2ecc71":"#7f8c8d",color:"#111",border:"none",borderRadius:"4px",padding:"6px 12px",cursor:"pointer",fontSize:"10px",fontWeight:800},title:"Ativa/desativa auditoria de saldo (runtime)",children:(L=window.__CASH_AUDIT__)!=null&&L.enabled?" Cash Audit ON":" Cash Audit OFF"})]}),a.jsxs("div",{style:{marginTop:"12px",padding:"8px",background:"#333",borderRadius:"4px",fontSize:"10px"},children:[a.jsx("div",{style:{color:"#FFC107",marginBottom:"4px"},children:" Instrues:"}),a.jsx("div",{children:' Clique em " Debug" para ativar/desativar'}),a.jsx("div",{children:" Logs so capturados automaticamente quando debug est ativo"}),a.jsx("div",{children:' " Exportar Logs Completos" gera arquivo .txt e .json'}),a.jsx("div",{children:" Compartilhe o arquivo .txt para anlise de problemas"}),a.jsx("div",{children:" Todos os console.log com prefixos [DEBUG], [NET], [App], etc. so capturados"})]})]}):a.jsx("div",{style:{background:"#1a1a1a",color:"#fff",padding:"6px 10px",borderRadius:"4px",border:"1px solid #333",cursor:"pointer",fontSize:"11px",fontFamily:"monospace",display:"inline-block",userSelect:"none"},onClick:f,children:" Debug"})}function kr({onResolve:t,requiredAmount:e=0,currentCash:n=0,title:r="Saldo insuficiente",message:o="Seu saldo atual no  suficiente para concluir esta compra.",okLabel:s="OK",showRecoveryOptions:i=!1,canClose:l=!0}){const u=E.useRef(null),c=E.useMemo(()=>Math.max(0,Number(e||0)-Number(n||0)),[e,n]),d=v=>`$ ${Number(v||0).toLocaleString()}`,p=v=>{var S,g;(S=v==null?void 0:v.preventDefault)==null||S.call(v),(g=v==null?void 0:v.stopPropagation)==null||g.call(v),t==null||t({action:"ACK"})},h=v=>{var S,g;(S=v==null?void 0:v.preventDefault)==null||S.call(v),(g=v==null?void 0:v.stopPropagation)==null||g.call(v),!(i||!l)&&(t==null||t({action:"SKIP"}))},y=v=>{var S,g;(S=v==null?void 0:v.preventDefault)==null||S.call(v),(g=v==null?void 0:v.stopPropagation)==null||g.call(v),t==null||t({action:"RECOVERY"})},b=v=>{var S,g;(S=v==null?void 0:v.preventDefault)==null||S.call(v),(g=v==null?void 0:v.stopPropagation)==null||g.call(v),t==null||t({action:"BANKRUPT"})};return E.useEffect(()=>{const v=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var S,g;return(g=(S=u.current)==null?void 0:S.focus)==null?void 0:g.call(S)},0),()=>{document.body.style.overflow=v}},[]),a.jsx("div",{style:pn.wrap,role:"dialog","aria-modal":"true",onMouseDown:v=>{v.target===v.currentTarget&&v.stopPropagation()},children:a.jsxs("div",{style:pn.card,onMouseDown:v=>v.stopPropagation(),children:[!i&&l&&a.jsx("button",{type:"button",style:pn.close,onClick:h,"aria-label":"Fechar",children:""}),a.jsx("div",{style:pn.icon,children:""}),a.jsx("h2",{style:pn.title,children:r}),a.jsx("p",{style:pn.msg,children:o}),a.jsxs("div",{style:pn.grid,children:[a.jsxs("div",{style:pn.row,children:[a.jsx("span",{children:"Necessrio:"}),a.jsx("b",{children:d(e)})]}),a.jsxs("div",{style:pn.row,children:[a.jsx("span",{children:"Seu saldo:"}),a.jsx("b",{children:d(n)})]}),a.jsxs("div",{style:{...pn.row,color:"#fca5a5"},children:[a.jsx("span",{children:"Faltam:"}),a.jsx("b",{children:d(c)})]})]}),a.jsx("div",{style:pn.actions,children:i?a.jsxs(a.Fragment,{children:[a.jsx("button",{type:"button",style:{...pn.btn,background:"#f59e0b",color:"#fff",marginRight:"8px"},onClick:y,children:"Recuperao Financeira"}),a.jsx("button",{type:"button",style:{...pn.btn,background:"#dc2626",color:"#fff"},onClick:b,children:"Declarar Falncia"})]}):a.jsx("button",{ref:u,type:"button",style:{...pn.btn,background:"#6b7280",color:"#fff"},onClick:p,children:s})})]})})}const pn={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"grid",placeItems:"center",zIndex:1100},card:{width:"min(440px, 92vw)",background:"#1f2330",color:"#e9ecf1",borderRadius:16,padding:"18px 18px 16px",border:"1px solid rgba(255,255,255,.12)",boxShadow:"0 18px 50px rgba(0,0,0,.5)",position:"relative"},close:{position:"absolute",right:10,top:10,width:34,height:34,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},icon:{fontSize:28,lineHeight:1,marginBottom:6},title:{margin:"2px 0 6px",fontWeight:900,fontSize:20},msg:{opacity:.95,margin:"0 0 10px"},grid:{border:"1px solid rgba(255,255,255,.15)",borderRadius:12,padding:"10px 12px",marginBottom:12,background:"#171b26"},row:{display:"flex",justifyContent:"space-between",padding:"4px 0"},actions:{display:"flex",justifyContent:"center",marginTop:6},btn:{minWidth:120,padding:"10px 16px",borderRadius:10,border:"none",fontWeight:900,cursor:"pointer"}},mn={A:{compra:1e4,despesa:ir.A.desp,faturamento:ir.A.fat,color:"#1d4ed8",pill:"NVEL A"},B:{compra:4e3,despesa:ir.B.desp,faturamento:ir.B.fat,color:"#16a34a",pill:"NVEL B"},C:{compra:1500,despesa:ir.C.desp,faturamento:ir.C.fat,color:"#f59e0b",pill:"NVEL C"},D:{compra:500,despesa:ir.D.desp,faturamento:ir.D.fat,color:"#6b7280",pill:"NVEL D"}};function Mf({onResolve:t,currentCash:e=0,currentLevel:n=null,erpOwned:r=null}){const o=E.useRef(null),{pushModal:s,awaitTop:i}=un(),l=c=>{var d,p;(d=c==null?void 0:c.preventDefault)==null||d.call(c),(p=c==null?void 0:c.stopPropagation)==null||p.call(c),t==null||t({action:"SKIP"})},u=async c=>{if(r?r[c]===!0:n===c)return;const p=mn[c],h=Number((p==null?void 0:p.compra)||0),y=Number(e||0);if(y<h){s(a.jsx(kr,{requiredAmount:h,currentCash:y,title:"Saldo insuficiente para comprar ERP",message:`Voc precisa de $ ${h.toLocaleString()} para o ERP nvel ${c}, mas possui $ ${y.toLocaleString()}.`,okLabel:"Entendi"})),await i();return}t==null||t({action:"BUY",level:c,values:p})};return E.useEffect(()=>{const c=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var d,p;return(p=(d=o.current)==null?void 0:d.focus)==null?void 0:p.call(d)},0),()=>{document.body.style.overflow=c}},[]),a.jsx("div",{style:it.wrap,role:"dialog","aria-modal":"true","aria-label":"ERP/Sistemas",children:a.jsxs("div",{style:it.card,children:[a.jsx("button",{ref:o,type:"button",style:it.close,onClick:l,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:it.title,children:["Escolha o nvel de ",a.jsx("b",{children:"ERP / Sistemas"}),":"]}),a.jsxs("div",{style:it.note,children:[a.jsx("div",{style:{fontWeight:900,marginBottom:4},children:"ERP / SISTEMAS"}),a.jsxs("div",{children:[a.jsx("b",{children:"Impacto mensal:"})," adiciona ",a.jsx("b",{children:"Despesa"})," e ",a.jsx("b",{children:"Faturamento"})," de acordo com o nvel."]}),a.jsxs("div",{children:["O nvel ",a.jsx("b",{children:"D"})," tambm pode ser adquirido."]})]}),a.jsxs("div",{style:it.saldo,children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",Number(e||0).toLocaleString()]})]}),a.jsxs("div",{style:it.table,children:[a.jsxs("div",{style:it.trHead,children:[a.jsx("div",{style:it.th}),a.jsx("div",{style:{...it.th,background:"#10214d"},children:"Nvel A"}),a.jsx("div",{style:{...it.th,background:"#0f3a1c"},children:"Nvel B"}),a.jsx("div",{style:{...it.th,background:"#4a3705"},children:"Nvel C"}),a.jsx("div",{style:{...it.th,background:"#2a2f3b"},children:"Nvel D"})]}),a.jsx(Hl,{label:"COMPRA",fmt:!0,vA:mn.A.compra,vB:mn.B.compra,vC:mn.C.compra,vD:mn.D.compra}),a.jsx(Hl,{label:"DESPESA",fmt:!0,vA:mn.A.despesa,vB:mn.B.despesa,vC:mn.C.despesa,vD:mn.D.despesa}),a.jsx(Hl,{label:"FATURAMENTO",fmt:!0,vA:mn.A.faturamento,vB:mn.B.faturamento,vC:mn.C.faturamento,vD:mn.D.faturamento})]}),a.jsx("div",{style:it.cards,children:["A","B","C","D"].map(c=>{const d=mn[c],p=r?r[c]===!0:n===c,h=p;return a.jsxs("div",{style:{...it.cardItem,borderColor:p?"#16a34a":"rgba(255,255,255,.15)",opacity:h?.6:1},children:[a.jsx("div",{style:{...it.pill,background:p?"#16a34a":"#fff",color:p?"#fff":"#111"},children:p?" ADQUIRIDO":d.pill}),a.jsx("div",{style:{...it.cardBadge,background:d.color}}),a.jsxs("ul",{style:it.lines,children:[a.jsxs("li",{children:["Compra: ",a.jsxs("b",{children:["$ ",d.compra.toLocaleString()]})]}),a.jsxs("li",{children:["Despesa: ",a.jsxs("b",{children:["$ ",d.despesa.toLocaleString()]})]}),a.jsxs("li",{children:["Faturamento: ",a.jsxs("b",{children:["$ ",d.faturamento.toLocaleString()]})]})]}),a.jsx("button",{type:"button",style:{...it.buyBtn,background:h?"#6b7280":"#2442f9",cursor:h?"not-allowed":"pointer"},onClick:()=>u(c),disabled:h,title:h?`ERP nvel ${c} j adquirido`:`Comprar ERP nvel ${c}`,children:h?"J Adquirido":`Comprar ${c}`})]},c)})}),a.jsx("div",{style:it.actions,children:a.jsx("button",{type:"button",style:{...it.bigBtn,background:"#444"},onClick:l,children:"No comprar"})})]})})}function Hl({label:t,vA:e,vB:n,vC:r,vD:o,fmt:s}){const i=l=>s?`$ ${Number(l).toLocaleString()}`:l;return a.jsxs("div",{style:it.tr,children:[a.jsx("div",{style:{...it.td,fontWeight:700},children:t}),a.jsx("div",{style:it.td,children:i(e)}),a.jsx("div",{style:it.td,children:i(n)}),a.jsx("div",{style:it.td,children:i(r)}),a.jsx("div",{style:it.td,children:i(o)})]})}const it={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(980px, 94vw)",background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:900},note:{background:"#2a2f3b",border:"1px solid rgba(255,255,255,.15)",borderRadius:12,padding:"10px 12px",margin:"0 0 10px"},saldo:{margin:"0 0 10px",padding:"8px 12px",border:"1px dashed rgba(255,255,255,.25)",borderRadius:10},table:{border:"1px solid rgba(255,255,255,.12)",borderRadius:12,overflow:"hidden",marginBottom:12},trHead:{display:"grid",gridTemplateColumns:"1fr repeat(4, 1fr)",background:"#121621"},th:{padding:"10px 12px",fontWeight:800,borderLeft:"1px solid rgba(255,255,255,.06)"},tr:{display:"grid",gridTemplateColumns:"1fr repeat(4, 1fr)",background:"#0f1320"},td:{padding:"10px 12px",borderTop:"1px solid rgba(255,255,255,.06)",borderLeft:"1px solid rgba(255,255,255/.06)"},cards:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:12,marginTop:8},cardItem:{background:"#0f1320",border:"1px solid",borderRadius:14,padding:"12px",display:"flex",flexDirection:"column",gap:8},cardBadge:{width:"100%",height:6,borderRadius:999,opacity:.9},pill:{alignSelf:"flex-start",fontSize:12,fontWeight:900,padding:"4px 8px",borderRadius:999,color:"#111"},lines:{margin:0,padding:"0 0 0 16px",lineHeight:1.35},buyBtn:{marginTop:"auto",padding:"10px 12px",borderRadius:10,border:"none",fontWeight:900,cursor:"pointer",background:"#2442f9",color:"#fff"},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:14},bigBtn:{minWidth:160,padding:"14px 18px",borderRadius:12,border:"none",color:"#fff",fontWeight:900,cursor:"pointer"}},Gi=[{id:"personalizado",label:`Treinamento de venda personalizado
Casagrande Consultores`,price:500,cert:"azul",colors:{bg:"#0f2848",border:"#3b82f6",pill:"#60a5fa"}},{id:"fieldsales",label:`Curso Field Sales Collab
Multiplier Educao e
Casagrande Consultores`,price:500,cert:"amarelo",colors:{bg:"#3a3202",border:"#facc15",pill:"#fde047"}},{id:"imersaomultiplier",label:`Pacote Imerses
Multiplier Educao`,price:500,cert:"roxo",colors:{bg:"#2b0840",border:"#a855f7",pill:"#c084fc"}}];function Bf({onResolve:t,ownedByType:e={},canTrain:n={}}){const r=k=>typeof k=="string"&&k.trim()!==""&&!Number.isNaN(Number(k))?Number(k):k,o=k=>{const N=r(k);return typeof N=="number"?N>0:!!N},s=E.useMemo(()=>({comum:o(n.comum),field:o(n.field),inside:o(n.inside),gestor:o(n.gestor)}),[n]),i=Gi.map(k=>k.id),l=E.useMemo(()=>[{id:"comum",label:"Vend. Comum"},{id:"field",label:"Field Sales"},{id:"inside",label:"Inside Sales"},{id:"gestor",label:"Gestor"}].filter(k=>s[k.id]).filter(k=>{const N=e[k.id]instanceof Set?e[k.id]:new Set(e[k.id]||[]);return i.some(x=>!N.has(x))}),[e,s]),[u,c]=E.useState(()=>new Set),[d,p]=E.useState(()=>new Set);E.useEffect(()=>{u.size===0&&l.length>0&&c(new Set([l[0].id]))},[l,u.size]);const h=E.useRef(null),y=E.useMemo(()=>{const k=[];if(d.size>0){const N=Array.from(d).map(j=>Gi.find(L=>L.id===j)).filter(Boolean),x=N.reduce((j,L)=>j+((L==null?void 0:L.price)||0),0);u.forEach(j=>{k.push({vendorType:j,items:N,total:x})})}return k},[u,d]),b=E.useMemo(()=>y.reduce((k,N)=>k+N.total,0),[y]),v=E.useMemo(()=>{const k={azul:0,amarelo:0,roxo:0};return d.size>0&&Array.from(d).map(x=>Gi.find(j=>j.id===x)).filter(Boolean).forEach(x=>{k[x.cert]=(k[x.cert]||0)+u.size}),k},[d,u.size]),S=E.useMemo(()=>{const k={};if(d.size>0){const N=Array.from(d);u.forEach(x=>{k[x]=N})}return k},[d,u]),g=k=>{c(N=>{const x=new Set(N);return x.has(k)?x.delete(k):x.add(k),x})},f=k=>{Array.from(u).some(x=>(e[x]instanceof Set?e[x]:new Set(e[x]||[])).has(k))||p(x=>{const j=new Set(x);return j.has(k)?j.delete(k):j.add(k),j})},m=()=>{y.length!==0&&(t==null||t({action:"BUY",purchases:y,grandTotal:b,bensDelta:b,certsCount:v,ownedUpdate:S}))},w=()=>{c(new Set),p(new Set)},_=k=>{var N,x;(N=k==null?void 0:k.preventDefault)==null||N.call(k),(x=k==null?void 0:k.stopPropagation)==null||x.call(k),t==null||t({action:"SKIP"})};E.useEffect(()=>{const k=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var N,x;return(x=(N=h.current)==null?void 0:N.focus)==null?void 0:x.call(N)},0),()=>{document.body.style.overflow=k}},[]);const R=l.length===0,D=!Object.values(s).some(Boolean);return a.jsx("div",{style:on.wrap,role:"dialog","aria-modal":"true",children:a.jsxs("div",{style:on.card,children:[a.jsx("button",{ref:h,type:"button",style:on.close,onClick:_,"aria-label":"Fechar",children:""}),a.jsx("h2",{style:on.title,children:"Escolha os vendedores e treinamentos que deseja comprar:"}),R?a.jsx("div",{style:on.allDoneBox,children:D?"Nenhum profissional disponvel para treinar no momento.":"Todos os treinamentos j foram comprados para os profissionais disponveis."}):a.jsx(a.Fragment,{children:a.jsxs("div",{style:{marginBottom:"16px"},children:[a.jsx("p",{style:{margin:"0 0 8px",opacity:.9,fontSize:"14px"},children:"Selecione os tipos de vendedores que deseja treinar:"}),a.jsx("div",{style:{...on.vendorRow,gridTemplateColumns:`repeat(${l.length}, minmax(0,1fr))`},children:l.map(k=>a.jsx("button",{type:"button",onClick:()=>g(k.id),style:{...on.vendorBtn,background:u.has(k.id)?"#6f5bd6":"#2a2f3b",borderColor:u.has(k.id)?"rgba(255,255,255,.35)":"rgba(255,255,255,.15)"},children:k.label},k.id))})]})}),!R&&u.size>0&&a.jsxs(a.Fragment,{children:[a.jsx("p",{style:{margin:"10px 2px 14px",opacity:.9},children:"Escolha os treinamentos que sero aplicados a todos os tipos selecionados:"}),a.jsxs("div",{style:{marginBottom:"16px"},children:[a.jsxs("div",{style:{marginBottom:"12px",padding:"8px 12px",background:"#2a2f3b",borderRadius:"8px",border:"1px solid rgba(255,255,255,.15)"},children:[a.jsx("div",{style:{fontWeight:"bold",marginBottom:"4px"},children:"Tipos selecionados:"}),a.jsx("div",{style:{fontSize:"14px",opacity:.9},children:Array.from(u).map(k=>{const N=l.find(x=>x.id===k);return N==null?void 0:N.label}).join(", ")})]}),a.jsx("div",{style:on.products,children:Gi.map(k=>{const N=d.has(k.id),x=Array.from(u).some(j=>(e[j]instanceof Set?e[j]:new Set(e[j]||[])).has(k.id));return a.jsxs("button",{type:"button",onClick:()=>f(k.id),disabled:x,style:{...on.productCard,background:k.colors.bg,borderColor:k.colors.border,boxShadow:N?`0 0 0 3px ${k.colors.pill}`:"none",opacity:x?.45:1,cursor:x?"not-allowed":"pointer"},title:x?"J adquirido para algum tipo selecionado":void 0,children:[a.jsxs("div",{style:on.pill(k.colors.pill),children:["Certificado ",k.cert==="azul"?"Azul":k.cert==="amarelo"?"Amarelo":"Roxo"]}),a.jsx("div",{style:{whiteSpace:"pre-line",fontWeight:800,marginBottom:10},children:k.label}),a.jsxs("div",{style:{fontSize:22,fontWeight:900},children:["$ ",k.price.toLocaleString()]})]},k.id)})})]}),a.jsxs("div",{style:on.actionsRow,children:[a.jsx("button",{type:"button",style:{...on.smallBtn,background:"#3a4152"},onClick:w,children:"Limpar Tudo"}),a.jsx("div",{style:{flex:1}}),a.jsxs("div",{style:{fontWeight:900},children:["Total: $ ",b.toLocaleString(),u.size>1&&a.jsxs("span",{style:{fontSize:"12px",opacity:.8,marginLeft:"8px"},children:["(",d.size," treinamentos  ",u.size," tipos)"]})]})]}),a.jsxs("div",{style:on.btnRow,children:[a.jsx("button",{type:"button",style:{...on.bigBtn,background:"#444"},onClick:_,children:"No comprar"}),a.jsxs("button",{type:"button",disabled:y.length===0,style:{...on.bigBtn,background:y.length>0?"#6f5bd6":"#3a3a3a",opacity:y.length>0?1:.6,cursor:y.length>0?"pointer":"not-allowed"},onClick:m,children:["Comprar (",y.length," tipo",y.length!==1?"s":"",")"]})]})]})]})})}const on={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(980px, 94vw)",maxWidth:980,background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:900},allDoneBox:{background:"#0f1320",border:"1px solid rgba(255,255,255,.15)",borderRadius:12,padding:"14px",fontWeight:800,textAlign:"center"},vendorRow:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:10,marginBottom:12},vendorBtn:{padding:"10px 12px",borderRadius:10,border:"1px solid",color:"#fff",fontWeight:800,cursor:"pointer"},products:{display:"grid",gridTemplateColumns:"repeat(3, minmax(0,1fr))",gap:12,margin:"4px 0 10px"},productCard:{textAlign:"center",padding:"16px 14px",borderRadius:14,border:"2px solid",color:"#fff"},pill:t=>({display:"inline-block",background:t,color:"#111",fontWeight:900,padding:"4px 8px",borderRadius:999,marginBottom:8}),actionsRow:{display:"flex",alignItems:"center",gap:12,margin:"6px 0 6px"},smallBtn:{padding:"10px 14px",borderRadius:10,border:"none",color:"#fff",fontWeight:800,cursor:"pointer"},btnRow:{display:"flex",gap:12,justifyContent:"flex-end",marginTop:12},bigBtn:{minWidth:160,padding:"14px 18px",borderRadius:12,border:"none",color:"#fff",fontWeight:900,cursor:"pointer"}};function wb({onResolve:t,currentCash:e=0}){const n=E.useRef(null),r=i=>{var l,u;(l=i==null?void 0:i.preventDefault)==null||l.call(i),(u=i==null?void 0:i.stopPropagation)==null||u.call(i),t==null||t({action:"SKIP"})};E.useEffect(()=>{const i=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var l,u;return(u=(l=n.current)==null?void 0:l.focus)==null?void 0:u.call(l)},0),()=>{document.body.style.overflow=i}},[]);const o=i=>()=>{t==null||t({action:"OPEN",open:String(i).toUpperCase()})},s=[{key:"mix",title:"Mix Produtos",lines:["Nvel A: $12000","Nvel B: $6000","Nvel C: $3000","Nvel D: $1000"],onBuy:o("MIX")},{key:"gestor",title:"Gestor Comercial",lines:["Contratao: $5000","Manuteno: $3000"],onBuy:o("MANAGER")},{key:"inside",title:"Inside Sales",lines:["Contratao: $3000","Manuteno: $2000"],onBuy:o("INSIDE")},{key:"field",title:"Field Sales",lines:["Contratao: $3000","Manuteno: $2000"],onBuy:o("FIELD")},{key:"vendedor",title:"Vendedor Comum",lines:["Contratao: $1500","Despesas: $1000"],onBuy:o("COMMON")},{key:"erp",title:"ERP/Sistemas",lines:["Nvel A: $10000","Nvel B: $4000","Nvel C: $1500","Nvel D: $500"],onBuy:o("ERP")},{key:"carteira",title:"Carteira de Clientes",lines:["Aquisio: $1000"],onBuy:o("CLIENTS")},{key:"training",title:"Treinamento",lines:["Azul: $500","Amarelo: $500","Roxo: $500"],onBuy:o("TRAINING")}];return a.jsx("div",{style:rr.wrap,role:"dialog","aria-modal":"true",children:a.jsxs("div",{style:rr.card,children:[a.jsx("button",{ref:n,type:"button",style:rr.close,onClick:r,"aria-label":"Fechar",children:""}),a.jsx("h2",{style:rr.title,children:"Direto de Compra  escolha uma casa para adquirir:"}),a.jsxs("div",{style:{marginBottom:8,opacity:.8,fontSize:13},children:["Saldo atual: ",a.jsxs("b",{children:["$",Number(e).toLocaleString()]})]}),a.jsx("div",{style:rr.grid,children:s.map(i=>a.jsxs("div",{style:rr.cell,children:[a.jsx("div",{style:rr.cellTitle,children:i.title}),a.jsx("ul",{style:rr.lines,children:i.lines.map((l,u)=>a.jsx("li",{children:l},u))}),a.jsx("button",{type:"button",style:rr.buyBtn,onClick:i.onBuy,children:"Comprar"})]},i.key))}),a.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:16},children:a.jsx("button",{type:"button",style:{...rr.buyBtn,background:"#666"},onClick:r,children:"No Comprar"})})]})})}const rr={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(1000px, 94vw)",background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 16px",fontWeight:800},grid:{display:"grid",gridTemplateColumns:"repeat(4, minmax(180px, 1fr))",gap:12},cell:{background:"#0f1320",border:"1px solid rgba(255,255,255,.08)",borderRadius:12,padding:12,display:"flex",flexDirection:"column",gap:8,minHeight:160},cellTitle:{fontWeight:800,marginBottom:4},lines:{margin:0,padding:"0 0 0 16px",opacity:.85,lineHeight:1.3},buyBtn:{marginTop:"auto",alignSelf:"center",minWidth:140,padding:"10px 14px",borderRadius:10,border:"none",background:"#3fbf49",color:"#09110f",fontWeight:900,cursor:"pointer"}};function Uf({onResolve:t,currentCash:e=0}){const n=E.useRef(null),[r,o]=E.useState(""),{pushModal:s,awaitTop:i}=un(),l=3e3,u=Ae.inside.baseDesp,c=Ae.inside.baseFat,d=_=>`$ ${Number(_||0).toLocaleString()}`,p=_=>Ae.inside.baseDesp+Ae.inside.incDesp*Math.max(0,_),h=_=>Ae.inside.baseFat+Ae.inside.incFat*Math.max(0,_),y=E.useMemo(()=>{const _=Number(r);return Number.isFinite(_)&&_>0?Math.floor(_):0},[r]),b=y*l,v=y>0,S=Math.max(0,Math.floor(Number(e||0)/l)),g=_=>{var R,D;(R=_==null?void 0:_.preventDefault)==null||R.call(_),(D=_==null?void 0:_.stopPropagation)==null||D.call(_),t==null||t({action:"SKIP"})},f=_=>{const R=Number(r)||0,D=Math.min(S||1/0,R+_);o(D||"")},m=()=>o(S||""),w=async()=>{if(!v)return;const _=Number(e||0),R=Number(b||0);if(_<R){s(a.jsx(kr,{requiredAmount:R,currentCash:_,title:"Saldo insuficiente para contratar Inside Sales",message:`Voc precisa de $ ${R.toLocaleString()} mas possui $ ${_.toLocaleString()}.`,okLabel:"Entendi"})),await i();return}t==null||t({action:"BUY",qty:y,headcount:y,unitHire:l,total:b,cost:b,totalCost:b,baseExpense:u,baseRevenue:c})};return E.useEffect(()=>{const _=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var R,D;return(D=(R=n.current)==null?void 0:R.focus)==null?void 0:D.call(R)},0),()=>{document.body.style.overflow=_}},[]),a.jsx("div",{style:kt.wrap,role:"dialog","aria-modal":"true","aria-label":"Inside Sales",children:a.jsxs("div",{style:kt.card,children:[a.jsx("button",{ref:n,type:"button",style:kt.close,onClick:g,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:kt.title,children:["Voc pode escolher quantos ",a.jsx("b",{children:"Inside Sales"})," quer comprar:"]}),a.jsxs("div",{style:kt.note,children:[a.jsx("div",{style:{fontWeight:900,marginBottom:4},children:"INSIDE SALES (SDR/BDR + CLOSER + CS)"}),a.jsxs("div",{children:[a.jsx("b",{children:"Base para clculo despesa:"}),"  quantidade ",a.jsx("b",{children:"field sales"})," ou ",a.jsx("b",{children:"inside sales"}),"."]}),a.jsxs("div",{children:[a.jsx("b",{children:"Base para clculo faturamento:"}),"  quantidade ",a.jsx("b",{children:"mxima de clientes que cada vendedor pode atender"}),"."]})]}),a.jsxs("div",{style:kt.saldoRow,children:[a.jsxs("div",{children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",Number(e||0).toLocaleString()]})]}),a.jsxs("div",{children:["Mximo por saldo: ",a.jsx("b",{children:S})]})]}),a.jsxs("div",{style:kt.inputRow,children:[a.jsx("input",{type:"number",inputMode:"numeric",min:1,placeholder:"Digite o nmero de Inside Sales",value:r,onChange:_=>o(_.target.value),style:kt.input}),a.jsxs("div",{style:kt.quickBtns,children:[a.jsx("button",{type:"button",style:kt.quickBtn,onClick:()=>f(1),children:"+1"}),a.jsx("button",{type:"button",style:kt.quickBtn,onClick:()=>f(5),children:"+5"}),a.jsx("button",{type:"button",style:kt.quickBtn,onClick:()=>f(10),children:"+10"}),a.jsx("button",{type:"button",style:{...kt.quickBtn,fontWeight:900},onClick:m,children:"Mx"})]}),a.jsxs("div",{style:kt.totalBox,children:["Total contratar: ",a.jsxs("b",{children:["$ ",Number(b).toLocaleString()]})]})]}),a.jsxs("div",{style:kt.cards,children:[a.jsx(qi,{title:"Sem certificado",bg:"#2a2f3b",pill:"BASE",lines:[`Contratao: $ ${l.toLocaleString()}`,`Despesa: ${d(p(0))}`,`Faturamento: ${d(h(0))}`]}),a.jsx(qi,{title:"1 certificado",bg:"#f1c40f",pill:"NVEL 1",dark:!0,lines:["Contratao: ",`Despesa: ${d(p(1))}`,`Faturamento: ${d(h(1))}`]}),a.jsx(qi,{title:"2 certificados",bg:"#a78bfa",pill:"NVEL 2",dark:!0,lines:["Contratao: ",`Despesa: ${d(p(2))}`,`Faturamento: ${d(h(2))}`]}),a.jsx(qi,{title:"3 certificados",bg:"#8b5cf6",pill:"NVEL 3",dark:!0,lines:["Contratao: ",`Despesa: ${d(p(3))}`,`Faturamento: ${d(h(3))}`]})]}),a.jsxs("div",{style:kt.actions,children:[a.jsx("button",{type:"button",style:{...kt.bigBtn,background:"#666",color:"#fff"},onClick:g,children:"No comprar"}),a.jsxs("button",{type:"button",style:{...kt.bigBtn,background:v?"#3fbf49":"#2f5d33",color:"#09110f"},onClick:w,disabled:!v,title:v?void 0:"Informe uma quantidade vlida",children:["Comprar ",v?`($ ${b.toLocaleString()})`:""]})]})]})})}function qi({title:t,pill:e,lines:n,bg:r,dark:o=!1}){return a.jsxs("div",{style:{...kt.cardItem,background:r,color:o?"#111":"#fff",borderColor:"rgba(255,255,255,.15)"},children:[a.jsxs("div",{style:kt.cardHeader,children:[a.jsx("span",{style:{...kt.pill,background:o?"#111":"#fff",color:o?"#fff":"#111"},children:e}),a.jsx("div",{style:{fontWeight:900},children:t})]}),a.jsx("ul",{style:kt.lines,children:n.map((s,i)=>a.jsx("li",{children:s},i))})]})}const kt={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(980px, 94vw)",background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:900},note:{background:"#2a2f3b",border:"1px solid rgba(255,255,255,.15)",borderRadius:12,padding:"10px 12px",margin:"0 0 10px"},saldoRow:{display:"flex",justifyContent:"space-between",gap:12,padding:"8px 12px",border:"1px dashed rgba(255,255,255,.25)",borderRadius:10,marginBottom:8},inputRow:{display:"grid",gridTemplateColumns:"1fr auto auto",alignItems:"center",gap:10,marginBottom:12},input:{height:42,borderRadius:10,padding:"0 12px",border:"1px solid rgba(255,255,255,.18)",background:"#0f1320",color:"#fff",outline:"none"},quickBtns:{display:"flex",gap:6},quickBtn:{minWidth:44,height:42,borderRadius:10,border:"1px solid rgba(255,255,255,.18)",background:"#2a2f3b",color:"#fff",fontWeight:800,cursor:"pointer",padding:"0 10px"},totalBox:{padding:"8px 12px",borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#0f1320",fontWeight:900},cards:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:12,margin:"8px 0 14px"},cardItem:{border:"1px solid",borderRadius:14,padding:"14px"},cardHeader:{display:"flex",alignItems:"center",gap:8,marginBottom:8},pill:{fontSize:12,fontWeight:900,padding:"4px 8px",borderRadius:999},lines:{margin:0,padding:"0 0 0 16px",lineHeight:1.35},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:8},bigBtn:{minWidth:180,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function Ff({onResolve:t,unitAcquisition:e=1e3,unitMaintenance:n=50,currentCash:r=0}){const o=E.useRef(null),s=E.useRef(null),{pushModal:i,awaitTop:l}=un(),[u,c]=E.useState(""),d=E.useMemo(()=>{const _=Math.floor(Number(u));return Number.isFinite(_)&&_>0?_:0},[u]),p=Number(e||0),h=Number(n||0),y=Number(r||0),b=E.useMemo(()=>p<=0?0:Math.max(0,Math.floor(y/p)),[y,p]),v=d*p,S=d*h,g=d>0,f=_=>{var R,D;(R=_==null?void 0:_.preventDefault)==null||R.call(_),(D=_==null?void 0:_.stopPropagation)==null||D.call(_),t==null||t({action:"SKIP"})},m=async()=>{if(g){if(y<v){i(a.jsx(kr,{requiredAmount:v,currentCash:y,title:"Saldo insuficiente para comprar clientes",message:"Voc no possui saldo suficiente para concluir esta aquisio.",okLabel:"Entendi"})),await l();return}t==null||t({action:"BUY",qty:d,unitAcquisition:p,totalCost:v,unitMaintenance:h,maintenanceDelta:S,bensDelta:v,clientsAdded:d,source:{modal:"BuyClientsModal",file:"src/modals/BuyClientsModal.jsx"}})}};E.useEffect(()=>{const _=document.body.style.overflow;document.body.style.overflow="hidden";const R=setTimeout(()=>{var N,x;return(x=(N=o.current)==null?void 0:N.focus)==null?void 0:x.call(N)},0),D=setTimeout(()=>{var N,x;return(x=(N=s.current)==null?void 0:N.focus)==null?void 0:x.call(N)},50),k=N=>{N.key==="Enter"&&(N.preventDefault(),m())};return window.addEventListener("keydown",k),()=>{document.body.style.overflow=_,window.removeEventListener("keydown",k),clearTimeout(R),clearTimeout(D)}},[]);const w=_=>{const R=Math.max(0,Math.min(Math.floor(Number(_)||0),1e6));c(String(R))};return a.jsx("div",{style:zt.wrap,role:"dialog","aria-modal":"true",onMouseDown:_=>{_.target===_.currentTarget&&_.stopPropagation()},children:a.jsxs("div",{style:zt.card,onMouseDown:_=>_.stopPropagation(),children:[a.jsx("button",{ref:o,type:"button",style:zt.close,onClick:f,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:zt.title,children:["Voc pode escolher quantos clientes quer comprar,",a.jsx("br",{}),"Digite o nmero de clientes:"]}),a.jsxs("p",{style:zt.warn,children:[a.jsx("b",{children:"Mas cuidado com a capacidade de atendimento da sua equipe!"}),a.jsx("br",{}),"Se o jogador adquirir mais clientes do que os vendedores podem atender, assim que passar na casa ",a.jsx("i",{children:"Faturamento do Ms"})," no receber o faturamento dos clientes excedentes e perder o(s) cliente(s) que no foram atendidos."]}),a.jsxs("div",{style:zt.inlineInfo,children:[a.jsxs("div",{children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",y.toLocaleString()]})]}),a.jsxs("div",{children:["Mximo por saldo: ",a.jsx("b",{children:b})]})]}),a.jsxs("div",{style:zt.qtyRow,children:[a.jsx("input",{ref:s,type:"number",inputMode:"numeric",min:1,placeholder:"Digite o nmero de Clientes",value:u,onChange:_=>w(_.target.value),style:zt.input}),a.jsxs("div",{style:zt.quickBtns,children:[a.jsx("button",{type:"button",style:zt.qbtn,onClick:()=>w(d+1),children:"+1"}),a.jsx("button",{type:"button",style:zt.qbtn,onClick:()=>w(d+5),children:"+5"}),a.jsx("button",{type:"button",style:zt.qbtn,onClick:()=>w(d+10),children:"+10"}),a.jsx("button",{type:"button",style:zt.qbtn,onClick:()=>w(b),title:"Comprar o mximo possvel com o saldo atual",children:"Mx"})]})]}),a.jsxs("div",{style:zt.summary,children:[a.jsxs("div",{children:["Preo por cliente: ",a.jsxs("b",{children:["$ ",p.toLocaleString()]})]}),a.jsxs("div",{children:["Despesa mensal por cliente: ",a.jsxs("b",{children:["$ ",h.toLocaleString()]})]})]}),a.jsxs("div",{style:zt.summaryStrong,children:[a.jsxs("div",{children:["Total compra: ",a.jsxs("b",{children:["$ ",Number(v).toLocaleString()]})]}),a.jsxs("div",{children:["Manuteno mensal adicionada: ",a.jsxs("b",{children:["$ ",Number(S).toLocaleString()]})]})]}),a.jsxs("div",{style:zt.actions,children:[a.jsx("button",{type:"button",style:{...zt.bigBtn,background:"#666",color:"#fff"},onClick:f,children:"No comprar"}),a.jsxs("button",{type:"button",style:{...zt.bigBtn,background:g?"#3fbf49":"#2f5d33",color:"#09110f"},onClick:m,disabled:!g,title:g?y<v?"Saldo insuficiente":void 0:"Informe uma quantidade vlida",children:["Comprar ",g?`($ ${v.toLocaleString()})`:""]})]})]})})}const zt={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(820px, 92vw)",maxWidth:820,background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px 20px 16px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:800,lineHeight:1.3},warn:{background:"#271c12",border:"1px solid rgba(255,180,0,.35)",color:"#ffd489",borderRadius:10,padding:"10px 12px",margin:"0 0 12px"},inlineInfo:{display:"flex",justifyContent:"space-between",gap:10,margin:"0 0 8px",opacity:.95,fontWeight:700,flexWrap:"wrap"},qtyRow:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},input:{flex:"1 1 260px",height:42,borderRadius:10,padding:"0 12px",border:"1px solid rgba(255,255,255,.18)",background:"#0f1320",color:"#fff",outline:"none"},quickBtns:{display:"flex",gap:6,flexWrap:"wrap"},qbtn:{height:42,padding:"0 12px",borderRadius:10,border:"1px solid rgba(255,255,255,.18)",background:"#2a2f3b",color:"#fff",cursor:"pointer",fontWeight:800},summary:{display:"flex",justifyContent:"space-between",gap:10,border:"1px dashed rgba(255,255,255,.2)",borderRadius:10,padding:"8px 12px",marginBottom:8,fontWeight:700,flexWrap:"wrap"},summaryStrong:{display:"flex",justifyContent:"space-between",gap:10,border:"1px solid rgba(255,255,255,.25)",borderRadius:10,padding:"10px 12px",marginBottom:10,fontWeight:800,flexWrap:"wrap"},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:4,flexWrap:"wrap"},bigBtn:{minWidth:180,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function zf({onResolve:t,unitHire:e=5e3,unitExpense:n=Ae.gestor.baseDesp,managesUpTo:r=Dm,currentCash:o=0}){const s=E.useRef(null),i=E.useRef(null),{pushModal:l,awaitTop:u}=un(),[c,d]=E.useState(""),p=Number(e||0),h=Number(n||0),y=Number(o||0),b=E.useMemo(()=>{const N=Math.floor(Number(c));return Number.isFinite(N)&&N>0?N:0},[c]),v=E.useMemo(()=>p<=0?0:Math.max(0,Math.floor(y/p)),[y,p]),S=b*p,g=b*h,f=b>0,m=N=>`$ ${Number(N||0).toLocaleString()}`,w=N=>Ae.gestor.baseDesp+Ae.gestor.incDesp*Math.max(0,N),_=N=>{const x=Math.max(0,N);return(Pa[Math.min(x,Pa.length-1)]||0)*100},R=N=>{const x=Math.floor(Number(N)||0),j=Math.max(0,Math.min(x,1e6));d(String(j))},D=N=>{var x,j;(x=N==null?void 0:N.preventDefault)==null||x.call(N),(j=N==null?void 0:N.stopPropagation)==null||j.call(N),t==null||t({action:"SKIP"})},k=async()=>{if(f){if(y<S){l(a.jsx(kr,{requiredAmount:S,currentCash:y,title:"Saldo insuficiente para contratar Gestores",message:"Voc no possui saldo suficiente para concluir esta contratao.",okLabel:"Entendi"})),await u();return}t==null||t({action:"BUY",role:"MANAGER",qty:b,headcount:b,gestoresDelta:b,unitHire:p,unitExpense:h,totalHire:S,totalExpense:g,cost:S,total:S,cashDelta:-S,expenseDelta:g,hudUpdate:{category:"Gestores Comerciais",addQty:b}})}};return E.useEffect(()=>{const N=document.body.style.overflow;document.body.style.overflow="hidden";const x=setTimeout(()=>{var U,B;return(B=(U=s.current)==null?void 0:U.focus)==null?void 0:B.call(U)},0),j=setTimeout(()=>{var U,B;return(B=(U=i.current)==null?void 0:U.focus)==null?void 0:B.call(U)},60),L=U=>{U.key==="Enter"&&(U.preventDefault(),k())};return window.addEventListener("keydown",L),()=>{document.body.style.overflow=N,window.removeEventListener("keydown",L),clearTimeout(x),clearTimeout(j)}},[]),a.jsx("div",{style:Ye.wrap,role:"dialog","aria-modal":"true",onMouseDown:N=>{N.target===N.currentTarget&&N.stopPropagation()},children:a.jsxs("div",{style:Ye.card,onMouseDown:N=>N.stopPropagation(),children:[a.jsx("button",{ref:s,type:"button",style:Ye.close,onClick:D,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:Ye.title,children:["Voc pode escolher quantos ",a.jsx("b",{children:"Gestores"})," quer comprar,",a.jsx("br",{}),"Digite o nmero de gestores:"]}),a.jsxs("div",{style:Ye.inlineInfo,children:[a.jsxs("div",{children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",y.toLocaleString()]})]}),a.jsxs("div",{children:["Mximo por saldo: ",a.jsx("b",{children:v})]})]}),a.jsxs("div",{style:Ye.qtyRow,children:[a.jsx("input",{ref:i,type:"number",inputMode:"numeric",min:1,placeholder:"Digite o nmero de Gestores",value:c,onChange:N=>R(N.target.value),style:Ye.input}),a.jsxs("div",{style:Ye.quickBtns,children:[a.jsx("button",{type:"button",style:Ye.qbtn,onClick:()=>R(b+1),children:"+1"}),a.jsx("button",{type:"button",style:Ye.qbtn,onClick:()=>R(b+5),children:"+5"}),a.jsx("button",{type:"button",style:Ye.qbtn,onClick:()=>R(b+10),children:"+10"}),a.jsx("button",{type:"button",style:Ye.qbtn,onClick:()=>R(v),title:"Comprar o mximo possvel com o saldo atual",children:"Mx"})]})]}),a.jsxs("div",{style:Ye.infoBox,children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"GESTOR COMERCIAL"}),a.jsxs("div",{style:{opacity:.9,marginBottom:8},children:["Base para clculo de despesa: ",a.jsx("b",{children:"x quantidade de Gestores"}),".",a.jsx("br",{}),"Cada Gestor gerencia at ",a.jsx("b",{children:r})," colaboradores."]}),a.jsxs("div",{style:Ye.table,children:[a.jsxs("div",{style:Ye.trHead,children:[a.jsx("div",{style:Ye.th,children:"Certificao"}),a.jsx("div",{style:Ye.th,children:"Contratao"}),a.jsx("div",{style:Ye.th,children:"Despesa"}),a.jsx("div",{style:Ye.th,children:"Efeito"})]}),a.jsx(Hi,{label:"Sem Certificado",hire:m(e),expense:m(w(0)),revenue:`potencializa colaboradores em ${_(0)}%`}),a.jsx(Hi,{label:"Com 1 certificado",hire:"-",expense:m(w(1)),revenue:`potencializa colaboradores em ${_(1)}%`}),a.jsx(Hi,{label:"Com 2 certificados",hire:"-",expense:m(w(2)),revenue:`potencializa colaboradores em ${_(2)}%`}),a.jsx(Hi,{label:"Com 3 certificados",hire:"-",expense:m(w(3)),revenue:`potencializa colaboradores em ${_(3)}%`})]})]}),a.jsxs("div",{style:Ye.summary,children:[a.jsxs("div",{children:["Custo de contratao (pagamento nico): ",a.jsxs("b",{children:["$ ",Number(e).toLocaleString()]})," / gestor"]}),a.jsxs("div",{children:["Despesa mensal recorrente (OPEX): ",a.jsxs("b",{children:["$ ",Number(n).toLocaleString()]})," / gestor"]})]}),a.jsxs("div",{style:Ye.summaryStrong,children:[a.jsxs("div",{children:["Total contratar: ",a.jsxs("b",{children:["$ ",Number(S).toLocaleString()]})]}),a.jsxs("div",{children:["Despesa mensal total: ",a.jsxs("b",{children:["$ ",Number(g).toLocaleString()]})]})]}),a.jsxs("div",{style:Ye.actions,children:[a.jsx("button",{type:"button",style:{...Ye.bigBtn,background:"#666",color:"#fff"},onClick:D,children:"No comprar"}),a.jsxs("button",{type:"button",style:{...Ye.bigBtn,background:f?"#3fbf49":"#2f5d33",color:"#09110f"},onClick:k,disabled:!f,title:f?y<S?"Saldo insuficiente":void 0:"Informe uma quantidade vlida",children:["Comprar ",f?`(${b})`:""]})]})]})})}function Hi({label:t,hire:e,expense:n,revenue:r}){const o=s=>typeof s=="number"?`$ ${Number(s).toLocaleString()}`:s;return a.jsxs("div",{style:Ye.tr,children:[a.jsx("div",{style:Ye.td,children:t}),a.jsx("div",{style:Ye.td,children:o(e)}),a.jsx("div",{style:Ye.td,children:o(n)}),a.jsx("div",{style:Ye.td,children:r})]})}const Ye={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(880px, 92vw)",maxWidth:880,background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px 20px 16px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:800,lineHeight:1.3},inlineInfo:{display:"flex",justifyContent:"space-between",gap:10,margin:"0 0 8px",opacity:.95,fontWeight:700,flexWrap:"wrap"},qtyRow:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},input:{flex:"1 1 260px",height:42,borderRadius:10,padding:"0 12px",border:"1px solid rgba(255,255,255,.18)",background:"#0f1320",color:"#fff",outline:"none"},quickBtns:{display:"flex",gap:6,flexWrap:"wrap"},qbtn:{height:42,padding:"0 12px",borderRadius:10,border:"1px solid rgba(255,255,255,.18)",background:"#2a2f3b",color:"#fff",cursor:"pointer",fontWeight:800},infoBox:{border:"1px solid rgba(255,255,255,.12)",borderRadius:12,padding:"12px",background:"#101522",marginBottom:12},table:{border:"1px solid rgba(255,255,255,.12)",borderRadius:10,overflow:"hidden"},trHead:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 3fr",background:"#121621"},th:{padding:"10px 12px",fontWeight:800,borderLeft:"1px solid rgba(255,255,255,.06)"},tr:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 3fr",background:"#0f1320"},td:{padding:"10px 12px",borderTop:"1px solid rgba(255,255,255,.06)",borderLeft:"1px solid rgba(255,255,255,.06)"},summary:{display:"flex",justifyContent:"space-between",border:"1px dashed rgba(255,255,255,.2)",borderRadius:10,padding:"8px 12px",marginTop:10,flexWrap:"wrap",gap:10},summaryStrong:{display:"flex",justifyContent:"space-between",border:"1px solid rgba(255,255,255,.25)",borderRadius:10,padding:"10px 12px",marginTop:8,fontWeight:800,flexWrap:"wrap",gap:10},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:12,flexWrap:"wrap"},bigBtn:{minWidth:180,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function Wf({onResolve:t,unitHire:e=3e3,unitExpense:n=Ae.field.baseDesp,attendsUpTo:r=Ae.field.cap,currentCash:o=0}){const s=E.useRef(null),i=E.useRef(null),{pushModal:l,awaitTop:u}=un(),[c,d]=E.useState(""),p=Number(e||0),h=Number(n||0),y=Number(o||0),b=E.useMemo(()=>{const j=Math.floor(Number(c));return Number.isFinite(j)&&j>0?j:0},[c]),v=E.useMemo(()=>p<=0?0:Math.max(0,Math.floor(y/p)),[y,p]),S=b*p,g=b*h,f=Ae.field.baseFat,m=b*f,w=b>0,_=j=>`$ ${Number(j||0).toLocaleString()}`,R=j=>Ae.field.baseDesp+Ae.field.incDesp*Math.max(0,j),D=j=>Ae.field.baseFat+Ae.field.incFat*Math.max(0,j),k=j=>{const L=Math.floor(Number(j)||0),U=Math.max(0,Math.min(L,1e6));d(String(U))},N=j=>{var L,U;(L=j==null?void 0:j.preventDefault)==null||L.call(j),(U=j==null?void 0:j.stopPropagation)==null||U.call(j),t==null||t({action:"SKIP"})},x=async()=>{if(w){if(y<S){l(a.jsx(kr,{requiredAmount:S,currentCash:y,title:"Saldo insuficiente para contratar Field Sales",message:"Voc no possui saldo suficiente para concluir esta contratao.",okLabel:"Entendi"})),await u();return}t==null||t({action:"BUY",qty:b,unitHire:p,unitExpense:h,totalHire:S,totalExpense:g,cashDelta:-S,expenseDelta:g,revenueDelta:m,cost:S,total:S,role:"FIELD"})}};return E.useEffect(()=>{const j=document.body.style.overflow;document.body.style.overflow="hidden";const L=setTimeout(()=>{var q,Ue;return(Ue=(q=s.current)==null?void 0:q.focus)==null?void 0:Ue.call(q)},0),U=setTimeout(()=>{var q,Ue;return(Ue=(q=i.current)==null?void 0:q.focus)==null?void 0:Ue.call(q)},50),B=q=>{q.key==="Enter"&&(q.preventDefault(),x())};return window.addEventListener("keydown",B),()=>{document.body.style.overflow=j,window.removeEventListener("keydown",B),clearTimeout(L),clearTimeout(U)}},[]),a.jsx("div",{style:Qe.wrap,role:"dialog","aria-modal":"true",onMouseDown:j=>{j.target===j.currentTarget&&j.stopPropagation()},children:a.jsxs("div",{style:Qe.card,onMouseDown:j=>j.stopPropagation(),children:[a.jsx("button",{ref:s,type:"button",style:Qe.close,onClick:N,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:Qe.title,children:["Voc pode escolher quantos ",a.jsx("b",{children:"Field Sales"})," quer comprar,",a.jsx("br",{}),"Digite o nmero de vendedores:"]}),a.jsxs("div",{style:Qe.inlineInfo,children:[a.jsxs("div",{children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",y.toLocaleString()]})]}),a.jsxs("div",{children:["Mximo por saldo: ",a.jsx("b",{children:v})]})]}),a.jsxs("div",{style:Qe.qtyRow,children:[a.jsx("input",{ref:i,type:"number",inputMode:"numeric",min:1,placeholder:"Digite o nmero de Field Sales",value:c,onChange:j=>k(j.target.value),style:Qe.input}),a.jsxs("div",{style:Qe.quickBtns,children:[a.jsx("button",{type:"button",style:Qe.qbtn,onClick:()=>k(b+1),children:"+1"}),a.jsx("button",{type:"button",style:Qe.qbtn,onClick:()=>k(b+5),children:"+5"}),a.jsx("button",{type:"button",style:Qe.qbtn,onClick:()=>k(b+10),children:"+10"}),a.jsx("button",{type:"button",style:Qe.qbtn,onClick:()=>k(v),title:"Comprar o mximo possvel com o saldo atual",children:"Mx"})]})]}),a.jsxs("div",{style:Qe.infoBox,children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"FIELD SALES (REPRESENTANTES COMERCIAIS)"}),a.jsxs("div",{style:{opacity:.9,marginBottom:8},children:["Base para clculo de despesa: ",a.jsx("b",{children:"x quantidade de Field Sales"}),".",a.jsx("br",{}),"Base para clculo de faturamento: ",a.jsx("b",{children:"x quantidade mxima de clientes que cada vendedor pode atender"}),".",a.jsx("br",{}),"Cada vendedor atende at ",a.jsx("b",{children:r})," clientes."]}),a.jsxs("div",{style:Qe.table,children:[a.jsxs("div",{style:Qe.trHead,children:[a.jsx("div",{style:Qe.th,children:"Certificao"}),a.jsx("div",{style:Qe.th,children:"Contratao"}),a.jsx("div",{style:Qe.th,children:"Despesa"}),a.jsx("div",{style:Qe.th,children:"Faturamento"})]}),a.jsx(Ki,{label:"S/ Certificado",hire:_(e),expense:_(R(0)),revenue:_(D(0))}),a.jsx(Ki,{label:"Com 1 certificado",hire:"-",expense:_(R(1)),revenue:_(D(1))}),a.jsx(Ki,{label:"Com 2 certificados",hire:"-",expense:_(R(2)),revenue:_(D(2))}),a.jsx(Ki,{label:"Com 3 certificados",hire:"-",expense:_(R(3)),revenue:_(D(3))})]})]}),a.jsxs("div",{style:Qe.summary,children:[a.jsxs("div",{children:["Custo de contratao (pagamento nico): ",a.jsxs("b",{children:["$ ",Number(e).toLocaleString()]})," / vendedor"]}),a.jsxs("div",{children:["Despesa mensal recorrente (OPEX): ",a.jsxs("b",{children:["$ ",Number(n).toLocaleString()]})," / vendedor"]})]}),a.jsxs("div",{style:Qe.summaryStrong,children:[a.jsxs("div",{children:["Total contratar: ",a.jsxs("b",{children:["$ ",Number(S).toLocaleString()]})]}),a.jsxs("div",{children:["Despesa mensal total: ",a.jsxs("b",{children:["$ ",Number(g).toLocaleString()]})]})]}),a.jsxs("div",{style:Qe.actions,children:[a.jsx("button",{type:"button",style:{...Qe.bigBtn,background:"#666",color:"#fff"},onClick:N,children:"No comprar"}),a.jsxs("button",{type:"button",style:{...Qe.bigBtn,background:w?"#75e16c":"#365b31",color:"#0b120a"},onClick:x,disabled:!w,title:w?y<S?"Saldo insuficiente":void 0:"Informe uma quantidade vlida",children:["Comprar ",w?`(${b})`:""]})]})]})})}function Ki({label:t,hire:e,expense:n,revenue:r}){return a.jsxs("div",{style:Qe.tr,children:[a.jsx("div",{style:Qe.td,children:t}),a.jsx("div",{style:Qe.td,children:e}),a.jsx("div",{style:Qe.td,children:n}),a.jsx("div",{style:Qe.td,children:r})]})}const Qe={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(880px, 92vw)",maxWidth:880,background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px 20px 16px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:800,lineHeight:1.3},inlineInfo:{display:"flex",justifyContent:"space-between",gap:10,margin:"0 0 8px",opacity:.95,fontWeight:700,flexWrap:"wrap"},qtyRow:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},input:{flex:"1 1 260px",height:42,borderRadius:10,padding:"0 12px",border:"1px solid rgba(255,255,255,.18)",background:"#0f1320",color:"#fff",outline:"none"},quickBtns:{display:"flex",gap:6,flexWrap:"wrap"},qbtn:{height:42,padding:"0 12px",borderRadius:10,border:"1px solid rgba(255,255,255,.18)",background:"#2a2f3b",color:"#fff",cursor:"pointer",fontWeight:800},infoBox:{border:"1px solid rgba(255,255,255,.12)",borderRadius:12,padding:"12px",background:"#101522",marginBottom:12},table:{border:"1px solid rgba(255,255,255,.12)",borderRadius:10,overflow:"hidden"},trHead:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",background:"#121621"},th:{padding:"10px 12px",fontWeight:800,borderLeft:"1px solid rgba(255,255,255,.06)"},tr:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",background:"#0f1320"},td:{padding:"10px 12px",borderTop:"1px solid rgba(255,255,255,.06)",borderLeft:"1px solid rgba(255,255,255,.06)"},summary:{display:"flex",justifyContent:"space-between",border:"1px dashed rgba(255,255,255,.2)",borderRadius:10,padding:"8px 12px",marginTop:10,flexWrap:"wrap",gap:10},summaryStrong:{display:"flex",justifyContent:"space-between",border:"1px solid rgba(255,255,255,.25)",borderRadius:10,padding:"10px 12px",marginTop:8,fontWeight:800,flexWrap:"wrap",gap:10},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:12,flexWrap:"wrap"},bigBtn:{minWidth:180,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function Vf({onResolve:t,unitHire:e=1500,unitExpense:n=Ae.comum.baseDesp,attendsUpTo:r=Ae.comum.cap,currentCash:o=0}){const[s,i]=E.useState(""),l=E.useRef(null),u=E.useRef(null),{pushModal:c,awaitTop:d}=un(),p=Number(e||0),h=Number(n||0),y=Number(o||0),b=Ae.comum.baseFat,v=x=>`$ ${Number(x||0).toLocaleString()}`,S=x=>Ae.comum.baseDesp+Ae.comum.incDesp*Math.max(0,x),g=x=>Ae.comum.baseFat+Ae.comum.incFat*Math.max(0,x),f=E.useMemo(()=>{const x=Math.floor(Number(s));return Number.isFinite(x)&&x>0?x:0},[s]),m=E.useMemo(()=>p<=0?0:Math.max(0,Math.floor(y/p)),[y,p]),w=E.useMemo(()=>f*p,[f,p]),_=E.useMemo(()=>f*h,[f,h]),R=f>0,D=x=>{const j=Math.floor(Number(x)||0),L=Math.max(0,Math.min(j,1e6));i(String(L))},k=x=>{var j;(j=x==null?void 0:x.stopPropagation)==null||j.call(x),t==null||t({action:"SKIP"})},N=async()=>{if(!R)return;if(y<w){c(a.jsx(kr,{requiredAmount:w,currentCash:y,title:"Saldo insuficiente para contratar vendedores",message:"Voc no possui saldo suficiente para concluir esta contratao.",okLabel:"Entendi"})),await d();return}const x={action:"BUY",role:"COMMON",qty:f,headcount:f,unitHire:p,unitExpense:h,totalHire:w,totalExpense:_,total:w,cost:w,attendsUpTo:r,cashDelta:-w,expenseDelta:_,revenueDelta:b*f,revenuePerSeller:b,hudUpdate:{category:"Vendedores Comuns",addQty:f}};t==null||t(x)};return E.useEffect(()=>{const x=document.body.style.overflow;document.body.style.overflow="hidden";const j=setTimeout(()=>{var B,q;return(q=(B=l.current)==null?void 0:B.focus)==null?void 0:q.call(B)},0),L=setTimeout(()=>{var B,q;return(q=(B=u.current)==null?void 0:B.focus)==null?void 0:q.call(B)},50),U=B=>{B.key==="Enter"&&(B.preventDefault(),N())};return window.addEventListener("keydown",U),()=>{document.body.style.overflow=x,window.removeEventListener("keydown",U),clearTimeout(j),clearTimeout(L)}},[]),a.jsx("div",{style:Xe.wrap,role:"dialog","aria-modal":"true","aria-label":"Comprar Vendedores Comuns",onMouseDown:x=>{x.target===x.currentTarget&&x.stopPropagation()},children:a.jsxs("div",{style:Xe.card,onMouseDown:x=>x.stopPropagation(),children:[a.jsx("button",{ref:l,type:"button",style:Xe.close,onClick:k,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:Xe.title,children:["Voc pode escolher quantos ",a.jsx("b",{children:"Vendedores Comuns"})," quer comprar,",a.jsx("br",{}),"Digite o nmero de vendedores:"]}),a.jsxs("div",{style:Xe.inlineInfo,children:[a.jsxs("div",{children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",y.toLocaleString()]})]}),a.jsxs("div",{children:["Mximo por saldo: ",a.jsx("b",{children:m})]})]}),a.jsxs("div",{style:Xe.qtyRow,children:[a.jsx("input",{ref:u,type:"number",inputMode:"numeric",min:1,placeholder:"Digite o nmero de Vendedores Comuns",value:s,onChange:x=>D(x.target.value),style:Xe.input}),a.jsxs("div",{style:Xe.quickBtns,children:[a.jsx("button",{type:"button",style:Xe.qbtn,onClick:()=>D(f+1),children:"+1"}),a.jsx("button",{type:"button",style:Xe.qbtn,onClick:()=>D(f+5),children:"+5"}),a.jsx("button",{type:"button",style:Xe.qbtn,onClick:()=>D(f+10),children:"+10"}),a.jsx("button",{type:"button",style:Xe.qbtn,onClick:()=>D(m),title:"Comprar o mximo possvel com o saldo atual",children:"Mx"})]})]}),a.jsxs("div",{style:Xe.infoBox,children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"VENDEDOR COMUM (FAZ TUDO)"}),a.jsxs("div",{style:{opacity:.9,marginBottom:8},children:["Base para clculo despesa: ",a.jsx("b",{children:"x quantidade vendedor comum"}),".",a.jsx("br",{}),"Base para clculo faturamento: ",a.jsx("b",{children:"x quantidade mxima de clientes que cada vendedor pode atender"}),".",a.jsx("br",{}),a.jsxs("b",{children:["Atende at ",r," clientes"]}),"."]}),a.jsxs("div",{style:Xe.table,children:[a.jsxs("div",{style:Xe.trHead,children:[a.jsx("div",{style:Xe.th,children:"Certificao"}),a.jsx("div",{style:Xe.th,children:"Contratao"}),a.jsx("div",{style:Xe.th,children:"Despesa"}),a.jsx("div",{style:Xe.th,children:"Faturamento"})]}),a.jsx(Ji,{label:"S/ Certificado",hire:v(e),expense:v(S(0)),revenue:v(g(0))}),a.jsx(Ji,{label:"Com 1 certificado",hire:"-",expense:v(S(1)),revenue:v(g(1))}),a.jsx(Ji,{label:"Com 2 certificados",hire:"-",expense:v(S(2)),revenue:v(g(2))}),a.jsx(Ji,{label:"Com 3 certificados",hire:"-",expense:v(S(3)),revenue:v(g(3))})]})]}),a.jsxs("div",{style:Xe.summary,children:[a.jsxs("div",{children:["Custo de contratao (pagamento nico): ",a.jsxs("b",{children:["$ ",Number(e).toLocaleString()]})," / vendedor"]}),a.jsxs("div",{children:["Despesa mensal recorrente (OPEX): ",a.jsxs("b",{children:["$ ",Number(n).toLocaleString()]})," / vendedor"]})]}),a.jsxs("div",{style:Xe.summaryStrong,children:[a.jsxs("div",{children:["Total contratar: ",a.jsxs("b",{children:["$ ",Number(w).toLocaleString()]})]}),a.jsxs("div",{children:["Despesa mensal total: ",a.jsxs("b",{children:["$ ",Number(_).toLocaleString()]})]})]}),a.jsxs("div",{style:Xe.actions,children:[a.jsx("button",{type:"button",style:{...Xe.bigBtn,background:"#666",color:"#fff"},onClick:k,children:"No comprar"}),a.jsx("button",{type:"button",disabled:!R,style:{...Xe.bigBtn,background:R?"#7cbe1a":"#3a3f4a",color:"#0d1200",fontWeight:900},onClick:N,title:R?y<w?"Saldo insuficiente":void 0:"Informe uma quantidade vlida",children:"Comprar"})]})]})})}function Ji({label:t,hire:e,expense:n,revenue:r}){return a.jsxs("div",{style:Xe.tr,children:[a.jsx("div",{style:Xe.td,children:t}),a.jsx("div",{style:Xe.td,children:e}),a.jsx("div",{style:Xe.td,children:n}),a.jsx("div",{style:Xe.td,children:r})]})}const Xe={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(880px, 92vw)",maxWidth:880,background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px 20px 16px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:800,lineHeight:1.3},inlineInfo:{display:"flex",justifyContent:"space-between",gap:10,margin:"0 0 8px",opacity:.95,fontWeight:700,flexWrap:"wrap"},qtyRow:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},input:{flex:"1 1 260px",height:42,borderRadius:10,padding:"0 12px",border:"1px solid rgba(255,255,255,.18)",background:"#111522",color:"#eef2f7",outline:"none"},quickBtns:{display:"flex",gap:6,flexWrap:"wrap"},qbtn:{height:42,padding:"0 12px",borderRadius:10,border:"1px solid rgba(255,255,255,.18)",background:"#2a2f3b",color:"#fff",cursor:"pointer",fontWeight:800},infoBox:{background:"#161a28",border:"1px solid rgba(255,255,255,.12)",borderRadius:14,padding:14,marginTop:6},table:{border:"1px solid rgba(255,255,255,.12)",borderRadius:12,overflow:"hidden",marginTop:8},trHead:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",background:"#121621"},th:{padding:"10px 12px",fontWeight:800,borderLeft:"1px solid rgba(255,255,255,.06)"},tr:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",background:"#0f1320"},td:{padding:"10px 12px",borderTop:"1px solid rgba(255,255,255,.06)",borderLeft:"1px solid rgba(255,255,255,.06)"},summary:{display:"flex",justifyContent:"space-between",border:"1px dashed rgba(255,255,255,.2)",borderRadius:10,padding:"8px 12px",marginTop:10,flexWrap:"wrap",gap:10},summaryStrong:{display:"flex",justifyContent:"space-between",border:"1px solid rgba(255,255,255,.25)",borderRadius:10,padding:"10px 12px",marginTop:8,fontWeight:800,flexWrap:"wrap",gap:10},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:12,flexWrap:"wrap"},bigBtn:{minWidth:180,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function Gf({onResolve:t,currentCash:e,currentLevel:n=null,mixOwned:r=null}){const o=E.useRef(null),{pushModal:s,awaitTop:i}=un(),l={A:{compra:12e3,despesa:ar.A.despPerClient,faturamento:ar.A.fatPerClient,color:"#1d4ed8",pill:"NVEL A",label:"100 produtos"},B:{compra:6e3,despesa:ar.B.despPerClient,faturamento:ar.B.fatPerClient,color:"#16a34a",pill:"NVEL B",label:"50 produtos"},C:{compra:3e3,despesa:ar.C.despPerClient,faturamento:ar.C.fatPerClient,color:"#f59e0b",pill:"NVEL C",label:"20 produtos"},D:{compra:1e3,despesa:ar.D.despPerClient,faturamento:ar.D.fatPerClient,color:"#6b7280",pill:"NVEL D",label:"5 produtos"}};async function u(d){if(r?r[d]===!0:n===d)return;const h=l[d],y=Number((h==null?void 0:h.compra)||0),b=Number(e);if(Number.isFinite(b)&&b>=0&&b<y){s(a.jsx(kr,{requiredAmount:y,currentCash:b,title:"Saldo insuficiente para adquirir o Mix de Produtos",message:`Voc precisa de $ ${y.toLocaleString()} mas possui $ ${b.toLocaleString()}.`,okLabel:"Entendi"})),await i();return}t==null||t({action:"BUY",level:d,...h})}function c(){t==null||t({action:"SKIP"})}return E.useEffect(()=>{const d=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var p,h;return(h=(p=o.current)==null?void 0:p.focus)==null?void 0:h.call(p)},0),()=>{document.body.style.overflow=d}},[]),a.jsx("div",{style:gn.wrap,role:"dialog","aria-modal":"true","aria-label":"Mix de Produtos",children:a.jsxs("div",{style:gn.card,children:[a.jsx("button",{ref:o,type:"button",style:gn.close,onClick:c,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:gn.title,children:["Escolha um ",a.jsx("b",{children:"mix de produtos"}),":"]}),a.jsxs("div",{style:gn.note,children:[a.jsx("div",{style:{fontWeight:900,marginBottom:4},children:"MIX DE PRODUTOS"}),a.jsxs("div",{children:["Base para clculo de ",a.jsx("b",{children:"Despesa"}),"/",a.jsx("b",{children:"Faturamento"}),": multiplicar pela ",a.jsx("b",{children:"quantidade total de clientes"}),"."]})]}),Number.isFinite(Number(e))&&a.jsxs("div",{style:gn.saldo,children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",Number(e||0).toLocaleString()]})]}),a.jsx("div",{style:gn.cards,children:["A","B","C","D"].map(d=>{const p=l[d],h=r?r[d]===!0:n===d,y=h;return a.jsxs("div",{style:{...gn.cardItem,borderColor:h?"#16a34a":"rgba(255,255,255,.15)",opacity:y?.6:1},children:[a.jsx("div",{style:{...gn.pill,background:h?"#16a34a":"#fff",color:h?"#fff":"#111"},children:h?" ADQUIRIDO":p.pill}),a.jsx("div",{style:{...gn.cardBadge,background:p.color}}),a.jsxs("ul",{style:gn.lines,children:[a.jsx("li",{children:a.jsx("b",{children:p.label})}),a.jsxs("li",{children:["Compra: ",a.jsxs("b",{children:["$ ",p.compra.toLocaleString()]})]}),a.jsxs("li",{children:["Despesa: ",a.jsxs("b",{children:["$ ",p.despesa.toLocaleString()]})]}),a.jsxs("li",{children:["Faturamento: ",a.jsxs("b",{children:["$ ",p.faturamento.toLocaleString()]})]})]}),a.jsx("button",{type:"button",style:{...gn.buyBtn,background:y?"#6b7280":"#2442f9",cursor:y?"not-allowed":"pointer"},onClick:()=>u(d),disabled:y,title:y?`Mix nvel ${d} j adquirido`:`Comprar Mix de Produtos ${d}`,children:y?"J Adquirido":`Comprar ${d}`})]},d)})}),a.jsx("div",{style:gn.actions,children:a.jsx("button",{type:"button",style:{...gn.bigBtn,background:"#444",color:"#fff"},onClick:c,children:"No comprar"})})]})})}const gn={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(980px, 94vw)",background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:900},note:{background:"#2a2f3b",border:"1px solid rgba(255,255,255,.15)",borderRadius:12,padding:"10px 12px",margin:"0 0 10px"},saldo:{margin:"0 0 10px",padding:"8px 12px",border:"1px dashed rgba(255,255,255,.25)",borderRadius:10},cards:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:12,marginTop:8},cardItem:{background:"#0f1320",border:"1px solid",borderRadius:14,padding:"12px",display:"flex",flexDirection:"column",gap:8},cardBadge:{width:"100%",height:6,borderRadius:999,opacity:.9},pill:{alignSelf:"flex-start",fontSize:12,fontWeight:900,padding:"4px 8px",borderRadius:999,color:"#111"},lines:{margin:0,padding:"0 0 0 16px",lineHeight:1.35},buyBtn:{marginTop:"auto",padding:"10px 12px",borderRadius:10,border:"none",fontWeight:900,cursor:"pointer",background:"#2442f9",color:"#fff"},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:14},bigBtn:{minWidth:160,padding:"14px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function Sb({onResolve:t,player:e={}}){const n=E.useRef(null),r=(f,m=0)=>Number.isFinite(Number(f))?Number(f):m,o=f=>r(f.am,0)>0,s=f=>r(f.az,0)>0,i=f=>{var w,_;const m=(f==null?void 0:f.certPurple)??((w=f==null?void 0:f.certs)==null?void 0:w.purple)??((_=f==null?void 0:f.certificates)==null?void 0:_.purple)??(f==null?void 0:f.cert_roxo)??(f==null?void 0:f.rox)??0;return m===!0||Number(m)>0},l=f=>{var w;const m=(f==null?void 0:f.mixLevel)??((w=f==null?void 0:f.mixProdutos)==null?void 0:w.level)??(f==null?void 0:f.mixProdutos)??(f==null?void 0:f.mix)??"D";return String(m||"D").toUpperCase()},u=f=>l(f)==="A",c=f=>String(f.erpLevel||f.erpSistemas||"D").toUpperCase()==="A",d=f=>{const m=String(f.mixProdutos||"D").toUpperCase();return m==="A"||m==="B"},p=f=>{var w;const m=_=>{if(!_)return 0;try{const R=Array.isArray(_)?_:Object.values(_);return new Set(R).size}catch{return 0}};return(w=f.trainingsByVendor)!=null&&w.gestor?m(f.trainingsByVendor.gestor):r(f.gestoresCertificados,0)},h=f=>r(f.vendedoresComuns)+r(f.insideSales)+r(f.fieldSales)+r(f.gestores??f.gestoresComerciais??f.managers),y=E.useMemo(()=>[{id:"gov_fgts",kind:"SORTE",title:"Ao Governamental Positiva",text:"Liberao de FGTS aumentou o poder de compra. Receba 5 novos clientes (se tiver equipe para atender).",clientsDelta:5},{id:"referral_bonus",kind:"SORTE",title:"Indicao Lucrativa",text:"Um cliente indicou amigos e a primeira compra foi tima. Receba R$ 800,00.",cashDelta:800},{id:"network_cert_mgr",kind:"SORTE",title:"Rede Estratgica",text:"Para cada gestor com certificado, receba R$ 5.000,00.",_compute:f=>({cashDelta:5e3*p(f)})},{id:"innovation_invest",kind:"SORTE",title:"Inovao Premiada",text:"Se tiver infraestrutura (mix/sistemas) nvel A ou B, receba aporte de R$ 25.000,00.",_compute:f=>({cashDelta:d(f)?25e3:0})},{id:"segmentation",kind:"SORTE",title:"Segmentao Inteligente",text:"Novo segmento lucrativo. Receba R$ 1.000,00.",cashDelta:1e3},{id:"casa_bonus_10k",kind:"SORTE",title:"Casagrande Insights",text:"Implementao bem-sucedida. Receba R$ 10.000,00.",cashDelta:1e4},{id:"casa_network_7k",kind:"SORTE",title:"Rede de Contatos Valiosa",text:"Parceria estratgica. Ganhe R$ 7.000,00.",cashDelta:7e3},{id:"casa_strategy_5k",kind:"SORTE",title:"Estratgia Personalizada",text:"Processos melhorados. Receba R$ 5.000,00.",cashDelta:5e3},{id:"casa_best_practices_8k",kind:"SORTE",title:"Melhores Prticas",text:"Eficincia aumentada. Receba R$ 8.000,00.",cashDelta:8e3},{id:"casa_start_6k",kind:"SORTE",title:"Satisfao do Cliente em Alta",text:"Fidelidade e vendas sobem. Receba R$ 6.000,00.",cashDelta:6e3},{id:"casa_change_cert_blue",kind:"SORTE",title:"Gesto de Mudanas Bem-sucedida",text:"Um vendedor generalista concluiu todos os treinamentos. Ganhe um certificado AZUL para esse vendedor.",_compute:()=>({certDelta:{az:1}})},{id:"training_roi_team",kind:"SORTE",title:"Treinamento Personalizado",text:"Receba R$ 500,00 por membro participante.",_compute:f=>({cashDelta:500*Math.max(0,h(f))})},{id:"purple_award_25k",kind:"SORTE",title:"Profissional do Ano (Roxo)",text:"Se houver pelo menos um colaborador com certificado roxo, receba R$ 25.000,00.",_compute:f=>({cashDelta:i(f)?25e3:0})},{id:"reputation_1500",kind:"SORTE",title:"Reputao Impecvel",text:"timas avaliaes elevam a confiana. Receba R$ 1.500,00.",cashDelta:1500},{id:"client_cheer_per_client",kind:"SORTE",title:"Cliente Promotor",text:"Ganhe R$ 500,00 por cada cliente atual.",_compute:f=>({cashDelta:500*Math.max(0,r(f.clients))})},{id:"big_order_freight_save",kind:"SORTE",title:"Grande Pedido + Frete Econmico",text:"Receba R$ 1.500,00.",cashDelta:1500},{id:"sales_win_2k",kind:"SORTE",title:"Vitria de Vendas",text:"Venda aguardada foi fechada. Receba R$ 2.000,00.",cashDelta:2e3},{id:"missed_admission",kind:"REVES",title:"Admisso No Reportada",text:"Multa governamental. Pague R$ 3.000,00.",cashDelta:-3e3},{id:"no_mix_a_pay_7000",kind:"REVES",title:"Mix A Ausente",text:"Se no tiver Mix nvel A, pague R$ 7.000,00.",_compute:f=>({cashDelta:u(f)?0:-7e3})},{id:"env_fine_20k",kind:"REVES",title:"Impacto Ambiental",text:"Multa ambiental. Pague R$ 20.000,00.",cashDelta:-2e4},{id:"key_client_at_risk",kind:"REVES",title:"Cliente Chave em Risco",text:"Sem certificado AMARELO: perca 1 cliente e pague R$ 2.000,00.",_compute:f=>o(f)?{clientsDelta:0,cashDelta:0,_overrideText:"Voc possui certificado amarelo. Nada acontece."}:{clientsDelta:-1,cashDelta:-2e3}},{id:"social_crisis",kind:"REVES",title:"Crise nas Redes",text:"Pague R$ 400,00 e perca 2 clientes.",cashDelta:-400,clientsDelta:-2},{id:"car_break",kind:"REVES",title:"Carro Quebrou",text:"Conserto urgente. Pague R$ 1.000,00.",cashDelta:-1e3},{id:"service_improvement_1k",kind:"REVES",title:"Aprimoramentos de Servio",text:"Pague R$ 1.000,00.",cashDelta:-1e3},{id:"recovery_failed_5k",kind:"REVES",title:"Recuperao Mal Sucedida",text:"Cancele grande pedido. Pague R$ 5.000,00.",cashDelta:-5e3},{id:"discount_pressure_1k",kind:"REVES",title:"Descontos Forados",text:"Presso por descontos reduziu sua margem. Pague R$ 1.000,00.",cashDelta:-1e3},{id:"domino_2k",kind:"REVES",title:"Efeito Domin",text:"Cancelamentos em cadeia. Perca R$ 2.000,00.",cashDelta:-2e3},{id:"needs_change_lose4",kind:"REVES",title:"Necessidades Mudaram",text:"Sem certificado AZUL: perca 4 clientes.",_compute:f=>s(f)?{clientsDelta:0,_overrideText:"Voc possui certificado azul. Nada acontece."}:{clientsDelta:-4}},{id:"payroll_error_1k",kind:"REVES",title:"Erro na Folha",text:"Corrigir problema. Pague R$ 1.000,00.",cashDelta:-1e3},{id:"strike_lose5",kind:"REVES",title:"Greve Inesperada",text:"Atrasos e perdas. Perca 5 clientes.",clientsDelta:-5},{id:"customs_hold_3k",kind:"REVES",title:"Alfndega",text:"Pague R$ 3.000,00.",cashDelta:-3e3},{id:"cyber_breach_7k_or_A",kind:"REVES",title:"Falha de Segurana",text:"Se NO tiver sistemas nvel A, pague R$ 7.000,00.",_compute:f=>({cashDelta:c(f)?0:-7e3})},{id:"supplier_issue_2k",kind:"REVES",title:"Fornecedor em Crise",text:"Expedio expressa. Pague R$ 2.000,00.",cashDelta:-2e3},{id:"reg_change_30k",kind:"REVES",title:"Regulamentao Nova",text:"Adequao de processos. Pague R$ 30.000,00.",cashDelta:-3e4},{id:"bad_mix_2500",kind:"REVES",title:"Mix de Produtos Desequilibrado",text:"Descontos e liquidaes. Pague R$ 2.500,00.",cashDelta:-2500},{id:"quality_crisis",kind:"REVES",title:"Crise de Qualidade",text:"Perca 1 cliente e pague R$ 1.000,00.",cashDelta:-1e3,clientsDelta:-1}],[]),[b]=E.useState(()=>y[Math.floor(Math.random()*y.length)]),v=E.useMemo(()=>{const f={action:"APPLY_CARD",kind:b.kind,id:b.id,title:b.title};if(typeof b._compute=="function"){const w=b._compute(e||{}),{_overrideText:_,...R}=w||{};return{text:_||b.text,payload:{...f,...R}}}const m={};return Number.isFinite(b.cashDelta)&&(m.cashDelta=Number(b.cashDelta)),Number.isFinite(b.clientsDelta)&&(m.clientsDelta=Number(b.clientsDelta)),{text:b.text,payload:{...f,...m}}},[b,e]),S=()=>t==null?void 0:t(v.payload),g=()=>t==null?void 0:t({action:"SKIP"});return E.useEffect(()=>{const f=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var m,w;return(w=(m=n.current)==null?void 0:m.focus)==null?void 0:w.call(m)},0),()=>{document.body.style.overflow=f}},[]),a.jsx("div",{style:Nr.wrap,role:"dialog","aria-modal":"true","aria-label":"Sorte e Revs",children:a.jsxs("div",{style:Nr.card,children:[a.jsx("button",{ref:n,style:Nr.close,onClick:g,"aria-label":"Fechar",children:""}),a.jsx("div",{style:Nr.badge(b.kind),children:b.kind==="SORTE"?"SORTE":"REVS"}),b.title&&a.jsx("h2",{style:Nr.title,children:b.title}),a.jsx("p",{style:Nr.text,children:v.text}),a.jsx("div",{style:Nr.footer,children:a.jsx("button",{type:"button",style:Nr.okBtn,onClick:S,children:"OK"})})]})})}const Nr={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(760px, 92vw)",background:"#1b1f2a",color:"#e9ecf1",borderRadius:18,padding:"22px",border:"1px solid rgba(255,255,255,.12)",boxShadow:"0 10px 40px rgba(0,0,0,.4)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},badge:t=>({display:"inline-block",padding:"6px 12px",borderRadius:999,fontWeight:900,marginBottom:8,background:t==="SORTE"?"#22c55e":"#ef4444",color:"#111"}),title:{margin:"2px 0 6px",fontWeight:900},text:{fontSize:18,lineHeight:1.5,opacity:.95,margin:"6px 0 14px"},footer:{display:"flex",justifyContent:"center"},okBtn:{minWidth:140,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer",background:"#fff",color:"#111"}};function _b({value:t=0,onResolve:e}){const n=Number(t||0),r=o=>{var s,i;(s=o==null?void 0:o.preventDefault)==null||s.call(o),(i=o==null?void 0:o.stopPropagation)==null||i.call(o),e==null||e({action:"OK",value:n,source:{modal:"FaturamentoMesModal",file:"src/modals/FaturamentoMesModal.jsx"}})};return a.jsx(wi,{zIndex:2147483647,onClose:()=>e==null?void 0:e({action:"CLOSE",value:n,source:{modal:"FaturamentoMesModal",file:"src/modals/FaturamentoMesModal.jsx"}}),children:a.jsxs("div",{style:{padding:28,textAlign:"center",pointerEvents:"auto"},children:[a.jsx("div",{style:{fontWeight:900,fontSize:28,color:"#4caf50",letterSpacing:.5,marginBottom:6},children:"FATURAMENTO DO MS"}),a.jsx("div",{style:{opacity:.9,marginBottom:16},children:"Ser creditado o valor do Faturamento ao seu Saldo"}),a.jsxs("div",{style:{fontSize:18,marginBottom:24},children:["no valor de: ",a.jsxs("b",{children:["$ ",n.toLocaleString()]})]}),a.jsx("button",{type:"button",onClick:r,className:"btn",style:{minWidth:120,background:"#8bd65a",color:"#1a1f2a",fontWeight:800,borderRadius:10},children:"OK"})]})})}function kb({expense:t=0,loanCharge:e=0,onResolve:n}){const r=Number(t||0)+Number(e||0),o=s=>{var i,l;(i=s==null?void 0:s.preventDefault)==null||i.call(s),(l=s==null?void 0:s.stopPropagation)==null||l.call(s),n==null||n({action:"OK",expense:Number(t||0),loanCharge:Number(e||0),total:Number(r||0),source:{modal:"DespesasOperacionaisModal",file:"src/modals/DespesasOperacionaisModal.jsx"}})};return a.jsx(wi,{zIndex:2147483647,onClose:()=>n==null?void 0:n({action:"CLOSE",source:{modal:"DespesasOperacionaisModal",file:"src/modals/DespesasOperacionaisModal.jsx"}}),children:a.jsxs("div",{style:{padding:28,textAlign:"center",pointerEvents:"auto"},children:[a.jsx("div",{style:{fontWeight:900,fontSize:26,color:"#ffb74d",letterSpacing:.5,marginBottom:6},children:"DESPESAS DO MS"}),a.jsxs("div",{style:{marginBottom:8},children:["Despesas operacionais:",a.jsxs("b",{children:["-$ ",Number(t).toLocaleString()]})]}),Number(e)>0&&a.jsxs("div",{style:{marginBottom:8,color:"#ffd54f"},children:["Emprstimo cobrado nesta rodada:",a.jsxs("b",{children:["-$ ",Number(e).toLocaleString()]})]}),a.jsxs("div",{style:{margin:"6px 0 18px",opacity:.85},children:["Total a debitar: ",a.jsxs("b",{children:["-$ ",r.toLocaleString()]})]}),a.jsx("button",{type:"button",onClick:o,className:"btn",style:{minWidth:120,background:"#ffcc80",color:"#1a1f2a",fontWeight:800,borderRadius:10},children:"OK"})]})})}const Me={backdrop:{position:"fixed",inset:0,background:"rgba(0,0,0,.6)",display:"grid",placeItems:"center",zIndex:9999},card:{width:"min(920px, 96vw)",maxHeight:"90vh",overflow:"auto",background:"#15161a",color:"#e9ecf1",border:"1px solid rgba(255,255,255,.08)",borderRadius:20,boxShadow:"0 20px 50px rgba(0,0,0,.5)"},header:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"14px 16px",borderBottom:"1px solid rgba(255,255,255,.08)"},closeBtn:{width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"transparent",color:"#fff",fontSize:20,cursor:"pointer"},body:{padding:16},lead:{opacity:.95,lineHeight:1.5},bullets:{margin:"8px 0 16px 18px"},rowBtns:{display:"flex",gap:12,justifyContent:"flex-end",marginTop:12,flexWrap:"wrap"},cta:{padding:"12px 16px",border:0,borderRadius:12,color:"#fff",fontWeight:900,cursor:"pointer",boxShadow:"0 10px 24px rgba(0,0,0,.25)"},back:{padding:"10px 14px",borderRadius:12,border:"1px solid rgba(255,255,255,.15)",background:"transparent",color:"#e9ecf1",cursor:"pointer"},subHeader:{marginBottom:8},infoRow:{display:"flex",gap:8,alignItems:"baseline",margin:"4px 0"},input:{width:"100%",padding:"12px 12px",borderRadius:12,background:"#0f1115",color:"#fff",border:"1px solid rgba(255,255,255,.15)",marginTop:10},option:{padding:16,background:"rgba(255,255,255,.04)",border:"1px solid rgba(255,255,255,.08)",borderRadius:14,textAlign:"center",cursor:"pointer"},spin:{width:34,height:34,borderRadius:8,border:"1px solid rgba(255,255,255,.15)",background:"transparent",color:"#fff",fontSize:18,cursor:"pointer"}};function Eb({playerName:t,loanAvailable:e,hasPendingLoan:n,onGoLoan:r,onGoReduce:o,onGoFire:s,onDeclareBankruptcy:i}){return a.jsxs("div",{style:Me.body,children:[a.jsxs("p",{style:Me.lead,children:["Voc est sem dinheiro, ",t,". Escolha uma das opes:"]}),n&&a.jsx("div",{style:{...Me.lead,color:"#ef4444",fontWeight:"bold",marginBottom:"16px"},children:" Voc j possui um emprstimo pendente. Cada jogador s pode ter um emprstimo por vez."}),a.jsxs("ul",{style:Me.bullets,children:[a.jsxs("li",{children:["Pedir ",a.jsx("b",{children:"emprstimo"})," nico com 50% de juros garantido por 50% dos seus ",a.jsx("b",{children:"BENS"})," (limite ",`$ ${e}`,")."]}),a.jsxs("li",{children:[a.jsx("b",{children:"Reduzir"})," nveis de ",a.jsx("b",{children:"MIX de Produtos"})," ou ",a.jsx("b",{children:"ERP/Sistemas"})," e receber 50% do valor pago."]}),a.jsxs("li",{children:[a.jsx("b",{children:"Demitir"})," funcionrios e receber 50% do valor total."]})]}),a.jsxs("div",{style:Me.rowBtns,children:[a.jsx("button",{style:{...Me.cta,background:"#ef4444"},onClick:s,children:"DEMITIR"}),a.jsx("button",{style:{...Me.cta,background:"#a16207"},onClick:o,children:"REDUZIR"}),a.jsx("button",{style:{...Me.cta,background:n?"#6b7280":"#16a34a",cursor:n?"not-allowed":"pointer"},onClick:n?void 0:r,disabled:n,children:n?"EMPRSTIMO (J REALIZADO)":"EMPRSTIMO"}),a.jsx("button",{style:{...Me.cta,background:"#d32f2f",fontWeight:"bold"},onClick:i,children:"DECLARAR FALNCIA"})]})]})}function jb({loanAvailable:t,alreadyHasLoan:e=!1,onBack:n,onConfirm:r}){const[o,s]=E.useState(""),i=E.useMemo(()=>Math.max(0,Math.floor(Number(o)||0)),[o]),l=!e&&i>0&&i<=Number(t||0),u=()=>{if(e){r==null||r({type:"LOAN_DENIED",reason:"ALREADY_TAKEN"});return}const c=Math.max(0,Math.floor(Number(t)||0)),d=Math.max(0,Math.min(c,i));if(d>0){const p={type:"LOAN",amount:d,cashDelta:d,loan:{amount:d,charged:!1}};console.log("[DEBUG] RecoveryLoan enviando payload:",p),r==null||r(p)}else r==null||r({type:"LOAN_DENIED",reason:"INVALID_AMOUNT"})};return a.jsxs("div",{style:Me.body,children:[a.jsx("div",{style:Me.subHeader,children:a.jsx("b",{style:{fontSize:20},children:"EMPRSTIMO"})}),a.jsxs("p",{children:["Voc pode realizar um emprstimo colocando ",a.jsx("b",{children:"50% dos seus BENS"})," como garantia (pago na prxima Despesas Operacionais)."]}),a.jsxs("div",{style:Me.infoRow,children:[a.jsx("span",{children:"Valor disponvel:"})," ",a.jsxs("b",{children:["$",Number(t||0)]})]}),a.jsxs("div",{style:Me.infoRow,children:[a.jsx("span",{children:"Valor garantia:"})," ",a.jsxs("b",{children:["$",Number(t||0)]})]}),e&&a.jsx("div",{style:{...Me.infoRow,color:"#fca5a5",border:"1px solid rgba(255,0,0,.25)",padding:"8px 10px",borderRadius:8,background:"rgba(255,0,0,.06)"},children:"Voc j possui um emprstimo ativo. No  possvel pegar outro."}),a.jsx("input",{style:Me.input,type:"number",min:0,max:Math.max(0,Number(t||0)),placeholder:"Digite o valor que quer emprestar",value:o,onChange:c=>s(c.target.value),disabled:e}),a.jsxs("div",{style:{fontSize:12,opacity:.8,marginTop:6},children:["Mx: $",Number(t||0),"  valor ser somado ao seu saldo e cobrado na prxima Despesas Operacionais."]}),a.jsxs("div",{style:Me.rowBtns,children:[a.jsx("button",{style:Me.back,onClick:n,children:" Voltar"}),a.jsx("button",{style:{...Me.cta,background:"#16a34a",opacity:l?1:.6,cursor:l?"pointer":"not-allowed"},onClick:u,disabled:!l,children:"Pegar Emprstimo"})]})]})}function Cb(t){const{options:e=[],optionsMix:n,optionsErp:r,mixOwned:o,erpOwned:s,credits:i,snapshot:l,onBack:u,onConfirm:c}=t,d=(...x)=>console.log("[RecoveryReduce]",...x),p={MIX:{accent:"#06B6D4",soft:"rgba(6,182,212,.14)",ring:"rgba(6,182,212,.45)",glow:"rgba(6,182,212,.35)",pillBg:"rgba(6,182,212,.18)",pillFg:"#9FF1FF"},ERP:{accent:"#8B5CF6",soft:"rgba(139,92,246,.14)",ring:"rgba(139,92,246,.45)",glow:"rgba(139,92,246,.35)",pillBg:"rgba(139,92,246,.18)",pillFg:"#E9D5FF"}},h=["A","B","C","D"],y=(x,j,L)=>h.map(U=>({key:`${x}-${U}`,group:x,level:U,label:`Nvel ${U}`,credit:Number((j==null?void 0:j[U])??0),owned:!!(L!=null&&L[U])})),b=E.useMemo(()=>Array.isArray(n)&&n.length?n:i!=null&&i.MIX?y("MIX",i.MIX,o):y("MIX",{A:0,B:0,C:0,D:0},o),[n,i,o]),v=E.useMemo(()=>Array.isArray(r)&&r.length?r:i!=null&&i.ERP?y("ERP",i.ERP,s):y("ERP",{A:0,B:0,C:0,D:0},s),[r,i,s]);E.useEffect(()=>{console.groupCollapsed("[RecoveryReduce] props snapshot"),console.log("mixCards:",b),console.log("erpCards:",v),console.log("mixOwned:",o),console.log("erpOwned:",s),console.log("credits:",i),console.groupEnd()},[b,v,o,s,i]);const[S,g]=E.useState([]),[f,m]=E.useState(new Set),[w,_]=E.useState(!1),R=x=>{x.level!=="D"&&(!x.owned||x.owned===!1||f.has(x.key)||x.alreadyReduced||g(j=>j.some(U=>U.key===x.key)?j.filter(U=>U.key!==x.key):[...j,x]))},D=E.useMemo(()=>S.reduce((x,j)=>x+Number(j.credit||0),0),[S]),k=x=>S.some(j=>j.key===x.key),N=x=>{var ge,Re;const j=k(x),L=x.level==="D",U=x.owned===!0,B=L||!U||f.has(x.key)||x.alreadyReduced||w,q=p[x.group]||p.MIX,Ue={...Me.option,position:"relative",borderRadius:14,background:B?"rgba(148,163,184,.12)":q.soft,border:j?`2.5px solid ${q.accent}`:"1px solid rgba(148,163,184,.25)",boxShadow:j?`0 0 0 2px ${q.ring}, 0 10px 24px ${q.glow}`:"none",cursor:B?"not-allowed":"pointer",opacity:B?.35:1,transition:"transform .06s ease-out, box-shadow .12s ease-out, border-color .12s"},wt={fontWeight:900,fontSize:16,marginBottom:8,color:B?"#CBD5E1":"#E5F9FF"},Z={fontWeight:700,marginTop:2,color:B?"#A1A1AA":"#FFFFFF"},F={position:"absolute",top:8,right:8,fontSize:11,padding:"3px 8px",borderRadius:999,background:B?"rgba(148,163,184,.22)":q.pillBg,color:B?"#E5E7EB":q.pillFg,border:`1px solid ${B?"rgba(148,163,184,.35)":q.ring}`,letterSpacing:.2};return a.jsxs("button",{onClick:()=>R(x),disabled:B,"aria-pressed":j,style:Ue,title:L?"Nvel D  o bsico e no pode ser reduzido.":U?f.has(x.key)?"Nvel j reduzido nesta sesso.":x.alreadyReduced?"Este nvel j foi reduzido anteriormente. Compre o nvel novamente para poder reduzir.":"":"Este nvel no est disponvel. Compre o nvel novamente para poder reduzir.",onMouseDown:pe=>!B&&(pe.currentTarget.style.transform="translateY(1px)"),onMouseUp:pe=>pe.currentTarget.style.transform="translateY(0)",onMouseLeave:pe=>pe.currentTarget.style.transform="translateY(0)",children:[a.jsx("span",{style:F,children:L?"bsico":U?f.has(x.key)?"vendido":x.alreadyReduced?"j reduzido":"adquirido":"zerado"}),a.jsx("div",{style:wt,children:x.label}),a.jsx("div",{style:{color:B?"#A1A1AA":"#BFEFFF"},children:"Crdito ao reduzir:"}),a.jsxs("div",{style:Z,children:["$",((Re=(ge=x.credit).toLocaleString)==null?void 0:Re.call(ge))??x.credit]})]},x.key)};return a.jsxs("div",{style:Me.body,children:[a.jsx("div",{style:Me.subHeader,children:a.jsx("b",{style:{fontSize:20},children:"REDUZIR NVEL MIX/ERP"})}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[a.jsxs("div",{style:{padding:8,borderRadius:8,background:"rgba(255,255,255,0.05)"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"MIX PRODUTOS"}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:12},children:b.map(N)})]}),a.jsxs("div",{style:{padding:8,borderRadius:8,background:"rgba(255,255,255,0.05)"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"ERP/SISTEMAS"}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:12},children:v.map(N)})]})]}),a.jsxs("div",{style:{marginTop:10,display:"flex",justifyContent:"space-between",alignItems:"center",opacity:.92},children:[a.jsxs("div",{children:["Selecionados: ",a.jsx("b",{children:S.length}),"    Total: ",a.jsxs("b",{children:["$",D.toLocaleString()]})]}),a.jsx("div",{style:{fontSize:12,opacity:.7},children:"S  possvel selecionar nveis adquiridos."})]}),a.jsxs("div",{style:Me.rowBtns,children:[a.jsx("button",{style:Me.back,onClick:u,disabled:w,children:" Voltar"}),a.jsx("button",{style:{...Me.cta,background:"#F59E0B",color:"#101010",fontWeight:900,opacity:S.length&&!w?1:.55},onClick:()=>{if(!S.length||w)return;_(!0),m(j=>{const L=new Set(j);return S.forEach(U=>L.add(U.key)),L});const x={items:S.map(j=>({...j,selected:!0})),total:D};d("confirm payload =>",x),c==null||c(x),g([]),_(!1)},disabled:!S.length||w,children:"REDUZIR"})]})]})}function Rb({roles:t=[],onBack:e,onConfirm:n}){const r=E.useMemo(()=>t.map(h=>{const y=Number(h.unit??h.total??0),b=Number(h.owned??h.qty??0);return{...h,unit:y,owned:b}}),[t]),[o,s]=E.useState(()=>{const h={};return r.forEach(y=>{h[y.key]=0}),h}),i=h=>`R$ ${Number(h||0).toLocaleString("pt-BR")}`,l=h=>Math.floor(Number(h||0)*.5),u=(h,y)=>{s(b=>{const v=r.find(f=>f.key===h);if(!v)return b;const S=Number(b[h]||0),g=Math.max(0,Math.min(v.owned,S+y));return g===S?b:{...b,[h]:g}})},c=E.useMemo(()=>{const h={};return r.forEach(y=>{const b=Number(o[y.key]||0);h[y.key]=l(y.unit)*b}),h},[o,r]),d=E.useMemo(()=>Object.values(c).reduce((h,y)=>h+y,0),[c]),p=()=>{if(d<=0)return;const h={};r.forEach(y=>{h[y.key]=Number(o[y.key]||0)}),n==null||n({type:"FIRE",items:h,creditByRole:c,totalCredit:d,amount:d,note:`Demisses +${i(d)}`})};return a.jsxs("div",{style:Me.body,children:[a.jsx("div",{style:Me.subHeader,children:a.jsx("b",{style:{fontSize:20},children:"DEMITIR FUNCIONRIOS"})}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1.2fr 1fr 1.2fr 1fr",gap:8,opacity:.9,fontWeight:700,marginBottom:6},children:[a.jsx("div",{children:"Cargo"}),a.jsx("div",{children:"Valor Unitrio"}),a.jsx("div",{children:"Qtd demitir"}),a.jsx("div",{children:"Crdito"})]}),a.jsx("div",{style:{display:"grid",gap:12},children:r.map(h=>{const y=Number(o[h.key]||0),b=Number(h.unit||0),v=Number(h.owned||0),S=l(b),g=S*y,f=y<=0,m=y>=v||v<=0;return a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1.2fr 1fr 1.2fr 1fr",alignItems:"center",gap:8},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:800},children:h.label}),a.jsxs("div",{style:{opacity:.75,fontSize:12},children:["Possui: ",a.jsx("b",{children:v})]})]}),a.jsxs("div",{children:[a.jsx("div",{children:a.jsx("b",{children:i(b)})}),a.jsxs("div",{style:{opacity:.75,fontSize:12},children:["Crdito por un.: ",a.jsx("b",{children:i(S)})]})]}),a.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center"},children:[a.jsx("button",{style:{...Me.spin,opacity:f?.5:1,cursor:f?"not-allowed":"pointer"},disabled:f,onClick:()=>u(h.key,-1),children:"-"}),a.jsx("div",{style:{minWidth:28,textAlign:"center",fontWeight:800},children:y}),a.jsx("button",{style:{...Me.spin,opacity:m?.5:1,cursor:m?"not-allowed":"pointer"},disabled:m,onClick:()=>u(h.key,1),children:"+"})]}),a.jsx("div",{children:a.jsx("b",{children:i(g)})})]},h.key)})}),a.jsxs("div",{style:{marginTop:12,textAlign:"right",fontWeight:900},children:["Total a resgatar: ",a.jsx("b",{children:i(d)})]}),a.jsxs("div",{style:Me.rowBtns,children:[a.jsx("button",{style:Me.back,onClick:e,children:" Voltar"}),a.jsx("button",{style:{...Me.cta,background:"#ef4444",opacity:d>0?1:.6},onClick:p,disabled:d<=0,children:"DEMITIR"})]})]})}function qf({playerName:t="Jogador",bens:e=0,currentPlayer:n,canClose:r=!0}){var N;const{resolveTop:o,popModal:s}=(un==null?void 0:un())||{},[i,l]=E.useState("menu"),u=()=>{r&&(s?s(!1):o==null||o(null))},c=E.useMemo(()=>({A:12e3,B:6e3,C:3e3,D:1e3}),[]),d=E.useMemo(()=>({A:1e4,B:4e3,C:1500,D:500}),[]),p=x=>{if(x==null)return"";const j=String(x).trim().toUpperCase();if(["A","B","C","D"].includes(j))return j;const L=Number(j);return L===1?"A":L===2?"B":L===3?"C":L===4?"D":""},h=E.useMemo(()=>{const x=n||{};return{name:x.name??t,bens:Number(x.bens??e??0),vendedoresComuns:Number(x.vendedoresComuns??0),fieldSales:Number(x.fieldSales??0),insideSales:Number(x.insideSales??0),gestores:Number(x.gestores??x.gestoresComerciais??0),raw:x}},[n,t,e]);E.useEffect(()=>{console.group("[RecoveryModal] mount snapshot"),console.log("raw player =>",h.raw),console.groupEnd()},[h.raw]);const y=E.useMemo(()=>Math.max(0,Math.floor(h.bens*.5)),[h.bens]),b=E.useMemo(()=>{var j;const x=(j=h.raw)==null?void 0:j.loanPending;return x&&Number(x.amount)>0},[(N=h.raw)==null?void 0:N.loanPending]),v=E.useMemo(()=>[{key:"mix",label:"MIX PRODUTOS",credit:1500},{key:"erp",label:"ERP/SISTEMAS",credit:1500}],[]),S=E.useMemo(()=>[{key:"comum",label:"Vendedor Comum",unit:1500,owned:h.vendedoresComuns},{key:"field",label:"Field Sales",unit:3e3,owned:h.fieldSales},{key:"inside",label:"Inside Sales",unit:3e3,owned:h.insideSales},{key:"gestor",label:"Gestor",unit:5e3,owned:h.gestores}],[h]),g=E.useMemo(()=>{const x=h.raw||{};return p(x.mixProdutosLetter??x.mixProdutos??x.mixProducts??x.mixLevelLetter??x.mixLevel??x.mix_level??x.mix??x.mix_produtos??x.mix_products)},[h.raw]),f=E.useMemo(()=>{var j;const x=h.raw||{};return p(x.erpSistemasLetter??x.erpSistemas??((j=x.erpSystems)==null?void 0:j.level)??x.erpSystemsLetter??x.erpLevelLetter??x.erpLevel??x.erp_level??x.erp??x.erp_sistemas)},[h.raw]),m=E.useMemo(()=>{const x=h.raw||{},j=x.mixOwned??x.mix??{},L=new Set;return typeof j=="object"&&!Array.isArray(j)&&j!==null&&(j.A===!0&&L.add("A"),j.B===!0&&L.add("B"),j.C===!0&&L.add("C"),j.D===!0&&L.add("D")),L.size===0&&g&&(L.add("D"),g==="A"?(L.add("A"),L.add("B"),L.add("C")):g==="B"?(L.add("B"),L.add("C")):g==="C"&&L.add("C")),L.size===0&&L.add("D"),L},[h.raw,g]),w=E.useMemo(()=>{const x=h.raw||{},j=x.erpOwned??x.erp??{},L=new Set;return typeof j=="object"&&!Array.isArray(j)&&j!==null&&(j.A===!0&&L.add("A"),j.B===!0&&L.add("B"),j.C===!0&&L.add("C"),j.D===!0&&L.add("D")),L.size===0&&f&&(L.add("D"),f==="A"?(L.add("A"),L.add("B"),L.add("C")):f==="B"?(L.add("B"),L.add("C")):f==="C"&&L.add("C")),L.size===0&&L.add("D"),L},[h.raw,f]);E.useEffect(()=>{console.group("[RecoveryModal] owned detect"),console.log("mixLetter(panel):",g," -> ownedMix =",Object.fromEntries(["A","B","C","D"].map(x=>[x,m.has(x)]))),console.log("erpLetter(panel):",f," -> ownedErp =",Object.fromEntries(["A","B","C","D"].map(x=>[x,w.has(x)]))),console.groupEnd()},[g,f,m,w]);const _=E.useMemo(()=>{var j,L;const x=h.raw||{};return{MIX:Array.isArray((j=x.reducedLevels)==null?void 0:j.MIX)?x.reducedLevels.MIX:[],ERP:Array.isArray((L=x.reducedLevels)==null?void 0:L.ERP)?x.reducedLevels.ERP:[]}},[h.raw]),R=E.useMemo(()=>["A","B","C","D"].map(x=>({key:`mix-${x}`,group:"MIX",level:x,label:`Nvel ${x}`,credit:(c[x]||0)/2,owned:m.has(x),alreadyReduced:_.MIX.includes(x)})),[m,c,_.MIX]),D=E.useMemo(()=>["A","B","C","D"].map(x=>({key:`erp-${x}`,group:"ERP",level:x,label:`Nvel ${x}`,credit:(d[x]||0)/2,owned:w.has(x),alreadyReduced:_.ERP.includes(x)})),[w,d,_.ERP]),k=E.useMemo(()=>({MIX:{A:c.A/2,B:c.B/2,C:c.C/2,D:c.D/2},ERP:{A:d.A/2,B:d.B/2,C:d.C/2,D:d.D/2}}),[c,d]);return a.jsx("div",{style:Me.backdrop,children:a.jsxs("div",{style:Me.card,children:[a.jsxs("div",{style:Me.header,children:[a.jsx("div",{style:{fontWeight:900,fontSize:22},children:"RECUPERAO FINANCEIRA"}),r&&a.jsx("button",{onClick:u,style:Me.closeBtn,children:""})]}),i==="menu"&&a.jsx(Eb,{playerName:h.name,loanAvailable:y,hasPendingLoan:b,onGoLoan:()=>l("loan"),onGoReduce:()=>l("reduce"),onGoFire:()=>l("fire"),onDeclareBankruptcy:()=>o==null?void 0:o({type:"TRIGGER_BANKRUPTCY",source:{modal:"RecoveryModal",file:"src/modals/RecoveryModal.jsx"}})}),i==="loan"&&a.jsx(jb,{loanAvailable:y,onBack:()=>l("menu"),onConfirm:x=>{console.log("[DEBUG] RecoveryModal recebeu payload do RecoveryLoan:",x),console.log("[DEBUG] RecoveryModal chamando resolveTop com:",x);const j=o==null?void 0:o({...x||{},source:{modal:"RecoveryModal",file:"src/modals/RecoveryModal.jsx"}});console.log("[DEBUG] RecoveryModal resolveTop retornou:",j)}}),i==="reduce"&&a.jsx(Cb,{options:v,optionsMix:R,optionsErp:D,mixOwned:{A:m.has("A"),B:m.has("B"),C:m.has("C"),D:m.has("D")},erpOwned:{A:w.has("A"),B:w.has("B"),C:w.has("C"),D:w.has("D")},credits:k,snapshot:h,onBack:()=>l("menu"),onConfirm:x=>{if(Array.isArray(x==null?void 0:x.items)){const U=Number(x.total??x.items.filter(B=>B.selected).reduce((B,q)=>B+Number(q.credit||0),0));o==null||o({type:"REDUCE",amount:U,items:x.items,note:`Reduo mltipla +R$ ${U.toLocaleString()}`,source:{modal:"RecoveryModal",file:"src/modals/RecoveryModal.jsx"}});return}const j=Number((x==null?void 0:x.credit)||(x==null?void 0:x.amount)||0),L=x&&x.group&&x.level?{group:String(x.group).toUpperCase(),level:String(x.level).toUpperCase(),credit:j}:null;o==null||o({type:"REDUCE",amount:j,group:L==null?void 0:L.group,level:L==null?void 0:L.level,selection:L,note:L?`Reduo ${L.group} nvel ${L.level} +R$ ${j.toLocaleString()}`:`Reduo +R$ ${j.toLocaleString()}`,source:{modal:"RecoveryModal",file:"src/modals/RecoveryModal.jsx"}})}}),i==="fire"&&a.jsx(Rb,{roles:S,onBack:()=>l("menu"),onConfirm:x=>o==null?void 0:o({...x||{},source:{modal:"RecoveryModal",file:"src/modals/RecoveryModal.jsx"}})})]},i)})}function Nb({playerName:t="Jogador",balanceText:e=""}){const{resolveTop:n,closeModal:r}=un(),o=E.useRef(null);E.useEffect(()=>{var c;const u=document.body.style.overflow;return document.body.style.overflow="hidden",(c=o.current)==null||c.focus(),()=>{document.body.style.overflow=u}},[]),E.useEffect(()=>{const u=c=>{(c.key==="Escape"||c.key==="Enter"||c.key===" ")&&(c.preventDefault(),c.stopPropagation())};return document.addEventListener("keydown",u,!0),()=>document.removeEventListener("keydown",u,!0)},[]);const s=u=>{u.preventDefault(),u.stopPropagation()},i=()=>{n(!1),r==null||r()},l=()=>{n(!0),r==null||r()};return a.jsxs(wi,{width:780,onClose:i,children:[a.jsx("style",{children:`
        .sg-modal-panel {
          background:#111827; border:1px solid rgba(255,255,255,0.08);
          border-radius:16px; padding:20px 22px 18px; color:#e5e7eb;
          position:relative; box-shadow:0 10px 35px rgba(0,0,0,.55);
        }
        .sg-modal-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
        .sg-modal-title{font-size:22px;font-weight:700;margin:0}
        .sg-icon-close{background:transparent;border:0;color:#9ca3af;font-size:24px;line-height:1;cursor:pointer}
        .sg-icon-close:hover{color:#e5e7eb}

        .sg-modal-infos{display:flex;justify-content:space-between;align-items:center;
          font-size:14px;color:#cbd5e1;margin:6px 0 12px}
        .sg-modal-infos .right{opacity:.8}

        .sg-callout-warning{
          background:rgba(250,204,21,.12); border:1px solid rgba(250,204,21,.45);
          border-radius:12px; padding:14px 16px; margin-bottom:14px
        }
        .sg-callout-title{font-weight:700;margin-bottom:6px;color:#fde68a}
        .sg-muted{opacity:.7}

        .sg-modal-body{margin:8px 2px 14px;font-size:15px;line-height:1.5}

        .sg-modal-actions{display:flex;justify-content:space-between;gap:12px;margin-top:10px}
        .sg-btn{font-weight:600;border:0;cursor:pointer;padding:12px 18px}
        .sg-pill{border-radius:999px}
        .sg-btn-neutral{background:#374151;color:#e5e7eb}
        .sg-btn-neutral:hover{background:#4b5563}
        .sg-btn-danger{background:#b91c1c;color:#fff}
        .sg-btn-danger:hover{background:#991b1b}
        .sg-btn:focus{outline:2px solid rgba(255,255,255,.35);outline-offset:2px}
      `}),a.jsxs("div",{className:"sg-modal-panel",role:"dialog","aria-modal":"true","aria-labelledby":"bk-title","aria-describedby":"bk-desc",onClick:s,onMouseDown:s,onKeyDown:s,children:[a.jsxs("div",{className:"sg-modal-header",children:[a.jsx("h2",{id:"bk-title",className:"sg-modal-title",children:"Declarar Falncia"}),a.jsx("button",{className:"sg-icon-close","aria-label":"Fechar",onClick:i,children:""})]}),a.jsxs("div",{className:"sg-modal-infos",children:[a.jsx("div",{className:"left",children:e?a.jsxs(a.Fragment,{children:["Saldo disponvel: ",a.jsx("b",{children:e})]}):a.jsx(a.Fragment,{children:""})}),a.jsx("div",{className:"right",children:"Ao permanente nesta partida"})]}),a.jsxs("div",{className:"sg-callout-warning",id:"bk-desc",children:[a.jsx("div",{className:"sg-callout-title",children:"Ateno"}),a.jsxs("p",{children:[t,", ao confirmar, voc ser marcado como ",a.jsx("b",{children:"FALIDO"}),". Seu turno ser ",a.jsx("b",{children:"sempre pulado"})," e voc no poder mais executar aes."]}),a.jsx("p",{className:"sg-muted",children:"Esta deciso  irreversvel at o fim da partida."})]}),a.jsx("div",{className:"sg-modal-body",children:a.jsxs("p",{children:["Confirme abaixo para encerrar sua participao ativa. Voc continuar visvel no placar como ",a.jsx("b",{children:"FALIDO"}),"."]})}),a.jsxs("div",{className:"sg-modal-actions",children:[a.jsx("button",{className:"sg-btn sg-pill sg-btn-neutral",onClick:i,children:"Cancelar"}),a.jsx("button",{ref:o,className:"sg-btn sg-pill sg-btn-danger",onClick:l,children:"Declarar Falncia"})]})]})]})}function Db({traceId:t="unknown",actionType:e="UNKNOWN",reason:n="UNKNOWN_CASH_CHANGE",origin:r={},context:o={}}={}){return{traceId:t||"unknown",actionType:e||"UNKNOWN",reason:n||"UNKNOWN_CASH_CHANGE",origin:{file:r.file,fn:r.fn,modal:r.modal,component:r.component},context:{round:o.round,pos:o.pos,tile:o.tile,debt:o.debt,loanPending:o.loanPending,opsExpense:o.opsExpense,revenue:o.revenue}}}const Rn=5;function Ab({players:t,setPlayers:e,round:n,setRound:r,turnIdx:o,setTurnIdx:s,turnPlayerId:i,setTurnPlayerId:l,roundFlags:u,setRoundFlags:c,isMyTurn:d,isMine:p,myUid:h,meId:y,myCash:b,current:v,broadcastState:S,appendLog:g,turnLock:f,setTurnLockBroadcast:m,gameOver:w,setGameOver:_,winner:R,setWinner:D,setShowBankruptOverlay:k}){const{pushModal:N,awaitTop:x,closeTop:j}=(un==null?void 0:un())||{},[L,U]=ue.useState(0),B=ue.useRef(0);ue.useEffect(()=>{B.current=L},[L]);const q=ue.useRef(!1),Ue=ue.useRef(!1),wt=ue.useRef(Promise.resolve()),Z=ue.useCallback(Y=>{const ve=async()=>{Ue.current=!0;try{return await Y()}finally{Ue.current=!1}},Ee=wt.current.then(ve,ve);return wt.current=Ee.catch(V=>{console.error("[DEBUG] actionQueue error:",V)}),Ee},[]),F=ue.useRef(!1),ge=ue.useRef(null),Re=ue.useRef(null),pe=ue.useRef(null),at=ue.useRef(null),Pt=ue.useRef(Promise.resolve()),_n=ue.useCallback(Y=>{if(!Array.isArray(Y)||Y.length===0)return Y;const ve=[...Y].filter(Boolean);let V=ve.every(Ne=>Number.isInteger(Ne.seat))?ve.sort((Ne,we)=>Ne.seat-we.seat):ve.sort((Ne,we)=>String((Ne==null?void 0:Ne.id)??(Ne==null?void 0:Ne.player_id)??"").localeCompare(String((we==null?void 0:we.id)??(we==null?void 0:we.player_id)??""))),He=0;const oe=new Set(V.filter(Ne=>Number.isInteger(Ne.seat)).map(Ne=>Ne.seat));return V=V.map(Ne=>{if(Number.isInteger(Ne.seat))return Ne;for(;oe.has(He);)He++;return oe.add(He),{...Ne,seat:He++}}),V=V.sort((Ne,we)=>Ne.seat-we.seat),V},[]),se=ue.useMemo(()=>_n(t),[t,_n]),en=ue.useCallback((Y,ve)=>(Y||[]).findIndex(Ee=>String(Ee==null?void 0:Ee.id)===String(ve)),[]),qe=ue.useCallback((Y,ve)=>(Y||[]).find(Ee=>String(Ee==null?void 0:Ee.id)===String(ve)),[]),re=ue.useCallback((Y,ve,Ee)=>(Y||[]).map(V=>String(V==null?void 0:V.id)===String(ve)?Ee(V):V),[]);ue.useEffect(()=>{d?console.log("[DEBUG] modalLocks sync - isMyTurn:",d,"modalLocks:",L):L>0&&(console.log("[DEBUG] modalLocks sync - resetando modalLocks para 0 (no  minha vez)"),U(0),B.current=0,q.current=!1)},[d,L]),ue.useEffect(()=>(f?(pe.current&&clearTimeout(pe.current),pe.current=setTimeout(()=>{const Y=ot.current,ve=String(Y||"")===String(h),Ee=B.current,V=q.current;console.warn("[DEBUG]  TIMEOUT DE SEGURANA - turnLock ativo h mais de 30s",{isLockOwner:ve,currentModalLocks:Ee,currentOpening:V,lockOwner:Y}),(ve&&Ee===0&&!V||Y==null&&Ee===0&&!V)&&(console.warn("[DEBUG]  FORANDO LIBERAO DO TURNLOCK (timeout de segurana)",{isLockOwner:ve,lockOwner:Y,modalLocks:Ee,opening:V}),m(!1),F.current=!1)},3e4)):pe.current&&(clearTimeout(pe.current),pe.current=null),()=>{pe.current&&(clearTimeout(pe.current),pe.current=null)}),[f,h,m]);const[Xr,Ro]=ue.useState(null),ot=ue.useRef(null);ue.useEffect(()=>{ot.current=Xr},[Xr]);const mt=ue.useRef(null),fe=ue.useRef(n);ue.useEffect(()=>{fe.current=n,console.log("[DEBUG]  currentRoundRef atualizado para:",n)},[n]);const Rt=ue.useRef(t);ue.useEffect(()=>{Rt.current=t},[t]);const er=ue.useRef(o);ue.useEffect(()=>{er.current=o},[o]);const Gt=ue.useRef(w);ue.useEffect(()=>{Gt.current=w},[w]);const Zr=ue.useRef(!1),eo=ue.useRef(!1);ue.useEffect(()=>{const Y=t[o];Y&&String(Y.id)===String(h)?mt.current&&(mt.current.nextTurnIdx===o?(console.log("[DEBUG] Limpando pendingTurnDataRef - turno j foi processado (nextTurnIdx === turnIdx)"),mt.current=null):console.log("[DEBUG] Mantendo pendingTurnDataRef - prximo turno:",mt.current.nextTurnIdx,"turno atual:",o)):mt.current&&mt.current.nextTurnIdx!==o&&(console.log("[DEBUG] Limpando pendingTurnDataRef - no  minha vez e dados no so para turno atual"),mt.current=null)},[o,t,h]);const et=ue.useCallback(Y=>{if(!N||!x)return Promise.resolve(null);const ve=async()=>{let V=!1;try{q.current=!0,U(Ne=>{const we=Ne+1;return B.current=we,at.current=null,console.log("[DEBUG] openModalAndWait - ABRINDO modal, modalLocks:",Ne,"->",we,"openingModalRef:",q.current),we}),N(Y),await new Promise(Ne=>setTimeout(Ne,100)),q.current=!1,console.log("[DEBUG] openModalAndWait - Modal renderizada, openingModalRef:",q.current);const He=new Promise((Ne,we)=>setTimeout(()=>we(new Error("Modal timeout")),15e3)),oe=await Promise.race([x(),He]);return V=!0,await new Promise(Ne=>setTimeout(Ne,50)),oe??null}catch(He){if(console.error("[DEBUG] openModalAndWait - erro aguardando modal:",He),He.message==="Modal timeout"){console.warn("[WARN] modal timeout -> auto-close");try{j==null||j({action:"SKIP"})}catch{}}return V=!0,null}finally{q.current=!1,V&&U(He=>{const oe=Math.max(0,He-1);return B.current=oe,oe===0&&(at.current=Date.now(),console.log("[DEBUG] openModalAndWait - LTIMA MODAL FECHADA - timestamp:",at.current)),console.log("[DEBUG] openModalAndWait - FECHANDO modal, modalLocks:",He,"->",oe),oe})}},Ee=Pt.current.then(ve,ve);return Pt.current=Ee.catch(()=>{}),Ee},[N,x,j]),No=ue.useCallback((Y,ve)=>{const Ee=t[Y],V=Math.max(0,Number(ve||0));return Number((Ee==null?void 0:Ee.cash)||0)>=V},[t]),Nt=ue.useCallback((Y,ve,Ee)=>{const V=No(Y,ve);return V||g(`Saldo insuficiente${Ee?" para "+Ee:""}. Use RECUPERAO (demitir / emprestar / reduzir) ou declare FALNCIA.`),V},[No,g]),Si=ue.useCallback((Y,ve,Ee)=>{var Ne;if(ve<=Rn)return{finished:!1,winner:null,finalRound:ve};const V=(Y||[]).filter(we=>!(we!=null&&we.bankrupt));if(V.length===0)return console.log("[DEBUG]  FIM DE JOGO - Nenhum jogador vivo restante"),{finished:!0,winner:null,finalRound:Rn};const oe=((Ne=V.map(we=>({player:we,patrimonio:(we.cash||0)+(we.bens||0),cash:we.cash||0})).sort((we,Ut)=>{var kn,O;return Ut.patrimonio-we.patrimonio||Ut.cash-we.cash||String(((kn=we.player)==null?void 0:kn.name)||"").localeCompare(String(((O=Ut.player)==null?void 0:O.name)||""))})[0])==null?void 0:Ne.player)||null;return console.log("[ENDGAME] finalizando: vencedor=",(oe==null?void 0:oe.name)||"N/A",", round=",Rn),{finished:!0,winner:oe,finalRound:Rn}},[]),bs=ue.useCallback((Y,ve,Ee)=>{if(console.log("[DEBUG]  advanceAndMaybeLap chamada - steps:",Y,"deltaCash:",ve,"note:",Ee),!(Gt.current||Zr.current||eo.current||!t.length)){if(F.current){console.warn("[DEBUG]  advanceAndMaybeLap - mudana de turno j em progresso, ignorando");return}if(B.current>0||q.current){if(console.warn("[DEBUG]  advanceAndMaybeLap - h modais abertas, aguardando...",{modalLocks:B.current,opening:q.current}),Re.current={steps:Y,deltaCash:ve,note:Ee},ge.current)return;ge.current=setTimeout(()=>{ge.current=null;const V=Re.current;Re.current=null,V&&B.current===0&&!q.current&&bs(V.steps,V.deltaCash,V.note)},200);return}F.current=!0,m(!0,String(h)),Ro(String(h));try{const V=o,He=se[V];if(!He){m(!1),F.current=!1;return}const oe=String(He.id);console.log("[DEBUG]  POSIO INICIAL - Jogador:",He.name,"Posio:",He.pos,"Saldo:",He.cash);const Ne=async(T,K,te,W=t)=>{var ee,me,Je,_t,Dt,De,At,Te,tn,Ot;const xe=qe(W,oe)||{},ye=Number((xe==null?void 0:xe.cash)||0);if(ye>=T){console.log("[DEBUG]  Saldo suficiente! Processando pagamento de:",T);const be=_n(W).map(je=>String(je.id)!==oe?je:{...je,cash:Math.max(0,(je.cash||0)-T),pos:je.pos});return e(be),S(be,o,fe.current),!0}q.current=!0;const X=await et(a.jsx(kr,{requiredAmount:T,currentCash:ye,title:`Saldo insuficiente para ${te} ${K}`,message:`Voc precisa ${te} R$ ${T.toLocaleString()} mas possui apenas R$ ${ye.toLocaleString()}.`,showRecoveryOptions:!0}));if(!X)return m(!1),!1;if(X.action==="RECOVERY"){console.log("[DEBUG] Abrindo RecoveryModal para jogador:",xe);const be=await et(a.jsx(qf,{currentPlayer:xe,canClose:!1}));if(console.log("[DEBUG] RecoveryModal retornou:",be),be){console.log("[DEBUG] recoveryModalRes existe, tipo:",be.type,"action:",be.action);let je=W;if(be.type==="FIRE"){console.log("[DEBUG]  Condio FIRE atendida! Processando demisses:",be);const rt={cashDelta:Number(be.amount||0),vendedoresComunsDelta:-Number(((ee=be.items)==null?void 0:ee.comum)||0),fieldSalesDelta:-Number(((me=be.items)==null?void 0:me.field)||0),insideSalesDelta:-Number(((Je=be.items)==null?void 0:Je.inside)||0),gestoresDelta:-Number(((_t=be.items)==null?void 0:_t.gestor)||0)};console.log("[DEBUG] Deltas de demisso:",rt),je=re(W,oe,Ke=>({...Ft(Ke,rt),pos:Ke.pos})),console.log("[DEBUG] Novo saldo aps demisses:",(Dt=qe(je,oe))==null?void 0:Dt.cash),e(je),S(je,o,fe.current)}else if(be.type==="LOAN"){console.log("[DEBUG]  Condio LOAN atendida! Processando emprstimo:",be);const rt=(qe(W,oe)||{}).loanPending;if(rt&&Number(rt.amount)>0){console.log("[DEBUG]  Jogador j possui emprstimo pendente:",rt);const lt=await et(a.jsx(kr,{requiredAmount:T,currentCash:Number((qe(W,oe)||{}).cash||0),title:"Emprstimo j realizado",message:`Voc j possui um emprstimo pendente de R$ ${Number(rt.amount).toLocaleString()}. Cada jogador s pode ter um emprstimo por vez.`,showRecoveryOptions:!1,canClose:!1}));if(!lt||lt.action!=="BANKRUPT")return m(!1),!1;const M=re(W,oe,$e=>({...$e,bankrupt:!0}));if(Ks(M)<=1){const $e=M.findIndex(ht=>!(ht!=null&&ht.bankrupt));return D($e>=0?M[$e]:null),e(M),_(!0),m(!1),S(M,o,n,!0,$e>=0?M[$e]:null),!1}const de=en(M,oe),_e=Ds(M,de>=0?de:V),Pe=M[_e],ke=Pe!=null&&Pe.id?String(Pe.id):null;return e(M),s(_e),l&&l(ke),m(!1),S(M,_e,fe.current,!1,null,{turnPlayerId:ke}),!1}const Ke=Number(be.amount||0);console.log("[DEBUG] Valor do emprstimo:",Ke),console.log("[DEBUG] Saldo atual do jogador:",Number((qe(W,oe)||{}).cash||0)),je=re(W,oe,lt=>({...lt,cash:(Number(lt.cash)||0)+Ke,loanPending:{amount:Ke,charged:!1,shouldChargeOnNextExpenses:!0},pos:lt.pos})),console.log("[DEBUG] Novo saldo do jogador:",(De=qe(je,oe))==null?void 0:De.cash),console.log("[DEBUG] Novo loanPending:",(At=qe(je,oe))==null?void 0:At.loanPending),e(je),S(je,o,fe.current)}else if(be.type==="REDUCE"){console.log("[DEBUG]  Condio REDUCE atendida! Processando reduo:",be);const rt=be.items||[];let Ke=0;console.log("[DEBUG] Selees para reduzir:",rt);const lt=M=>(M==null?void 0:M.A)===!0?"A":(M==null?void 0:M.B)===!0?"B":(M==null?void 0:M.C)===!0?"C":"D";je=re(W,oe,M=>{let ce={...M},de={A:!1,B:!1,C:!1,D:!1,...ce.mixOwned||ce.mix||{}},_e={A:!1,B:!1,C:!1,D:!1,...ce.erpOwned||ce.erp||{}};const Pe=String(ce.mixProdutos||"D").toUpperCase(),ke=String(ce.erpLevel||ce.erpSistemas||"D").toUpperCase();!de.A&&!de.B&&!de.C&&!de.D&&Pe&&(Pe==="A"?de={A:!0,B:!0,C:!0,D:!0}:Pe==="B"?de={A:!1,B:!0,C:!0,D:!0}:Pe==="C"?de={A:!1,B:!1,C:!0,D:!0}:de={A:!1,B:!1,C:!1,D:!0}),!_e.A&&!_e.B&&!_e.C&&!_e.D&&ke&&(ke==="A"?_e={A:!0,B:!0,C:!0,D:!0}:ke==="B"?_e={A:!1,B:!0,C:!0,D:!0}:ke==="C"?_e={A:!1,B:!1,C:!0,D:!0}:_e={A:!1,B:!1,C:!1,D:!0});let $e=Pe,ht=ke;for(const jr of rt)if(jr.selected){if(Ke+=Number(jr.credit||0),jr.group==="MIX"){if(de[jr.level]=!1,jr.level===$e){const no=["A","B","C","D"],al=no.indexOf($e);for(let ro=al+1;ro<no.length;ro++){const oo=no[ro];if(de[oo]||oo==="D"){$e=oo;break}}}}else if(jr.group==="ERP"&&(_e[jr.level]=!1,jr.level===ht)){const no=["A","B","C","D"],al=no.indexOf(ht);for(let ro=al+1;ro<no.length;ro++){const oo=no[ro];if(_e[oo]||oo==="D"){ht=oo;break}}}}const nn=lt(de)||$e||"D",_i=lt(_e)||ht||"D";return ce.mixOwned=de,ce.mix=de,ce.erpOwned=_e,ce.erp=_e,ce.mixProdutos=nn,ce.erpLevel=_i,ce.erpSistemas=_i,ce.mixLevel=nn,ce.mixProducts=nn,ce.mixLevelLetter=nn,ce.erpLevelLetter=_i,ce.cash=(Number(ce.cash)||0)+Ke,ce.pos=M.pos,console.log("[DEBUG] Reduo aplicada - mixProdutos:",nn,"erpLevel:",_i,"crdito:",Ke),ce}),console.log("[DEBUG] Total de crdito da reduo:",Ke),console.log("[DEBUG] Novo saldo aps reduo:",(Te=qe(je,oe))==null?void 0:Te.cash),console.log("[DEBUG] Novo mixProdutos:",(tn=qe(je,oe))==null?void 0:tn.mixProdutos,"Novo erpLevel:",(Ot=qe(je,oe))==null?void 0:Ot.erpLevel),e(je),S(je,o,fe.current)}else console.log("[DEBUG]  Nenhuma condio foi atendida! Tipo:",be.type,"Action:",be.action);const hn=Number((qe(je,oe)||{}).cash||0);if(console.log("[DEBUG] Verificando saldo aps recuperao - Novo saldo:",hn,"Necessrio:",T),hn>=T){console.log("[DEBUG]  Saldo suficiente aps recuperao! Processando pagamento de:",T);const rt=re(je,oe,Ke=>({...Ke,cash:Math.max(0,(Ke.cash||0)-T),pos:Ke.pos}));return console.log("[DEBUG]  PAGAMENTO - Saldo antes:",Number((qe(je,oe)||{}).cash||0),"Valor a pagar:",T,"Saldo aps:",Number((qe(rt,oe)||{}).cash||0)),e(rt),S(rt,o,fe.current),!0}else return console.log("[DEBUG]  Saldo ainda insuficiente aps recuperao. Continuando recurso..."),await Ne(T,K,te,je)}else return m(!1),!1}else if(X.action==="BANKRUPT"){const be=re(W,oe,M=>({...M,bankrupt:!0}));if(Ks(be)<=1){const M=be.findIndex(ce=>!(ce!=null&&ce.bankrupt));return D(M>=0?be[M]:null),e(be),_(!0),m(!1),S(be,o,n,!0,M>=0?be[M]:null),!1}const hn=en(be,oe),rt=Ds(be,hn>=0?hn:V),Ke=be[rt],lt=Ke!=null&&Ke.id?String(Ke.id):null;return e(be),s(rt),l&&l(lt),m(!1),S(be,rt,fe.current,!1,null,{turnPlayerId:lt}),!1}else return m(!1),!1},we=He.pos,Ut=(we+Y)%mo,kn=Ut<we,O=kn&&we>=mo-1;console.log("[DEBUG]  MOVIMENTO - De posio:",we,"Para posio:",Ut,"Steps:",Y,"Lap:",kn,"CompletedLap:",O);const A=Gl(we,Ut,0)||kn,$=fe.current,Q=t.filter(T=>!(T!=null&&T.bankrupt)).length,C=_n(t).map(T=>{if(String(T.id)!==oe)return T;const K=(T.cash||0)+(ve||0),te=Number(T.lastRevenueRound)||0,W=T.waitingAtRevenue===!0;let xe=te,ye=$===Rn?W:!1,X=ye?0:Ut;return A&&(xe=Math.max(te,$),$===Rn&&Q>1&&(ye=!0,X=0)),{...T,pos:X,cash:Math.max(0,K),lastRevenueRound:xe,waitingAtRevenue:ye}}),I=C.find(T=>String(T.id)===oe);console.log("[DEBUG]  APS MOVIMENTO - Jogador:",I==null?void 0:I.name,"Posio:",I==null?void 0:I.pos,"Saldo:",I==null?void 0:I.cash,"lastRevenueRound:",I==null?void 0:I.lastRevenueRound,"waitingAtRevenue:",I==null?void 0:I.waitingAtRevenue);let J=fe.current,P=[...u],H=!1,gt=!1;if(kn){console.log("[DEBUG]  VOLTA COMPLETA DETECTADA (lap=true) - Jogador completou uma volta completa!",{jogador:He.name,posicaoAnterior:we,posicaoNova:Ut,rodadaAtual:fe.current}),P.length<t.length&&(P=[...P,...new Array(t.length-P.length).fill(!1)]);const T=se.findIndex(K=>String(K.id)===oe);T>=0&&(P[T]=!0),console.log("[DEBUG]  Flag marcada por volta completa (lap) - Flags:",P.map((K,te)=>{var W;return`${(W=se[te])==null?void 0:W.name}:${K}`}).join(", "))}if(A){P.length<t.length&&(P=[...P,...new Array(t.length-P.length).fill(!1)]);const T=se.findIndex(X=>String(X.id)===oe);T>=0&&(P[T]?console.log("[DEBUG]  Jogador j tinha flag marcada (por lap) - Flags:",P.map((X,ee)=>{var me;return`${(me=se[ee])==null?void 0:me.name}:${X}`}).join(", ")):(P[T]=!0,console.log("[DEBUG]  Jogador passou pela casa 0 (crossedStart1ForRound) - Flags:",P.map((X,ee)=>{var me;return`${(me=se[ee])==null?void 0:me.name}:${X}`}).join(", "))));const K=C.filter(X=>!(X!=null&&X.bankrupt)),te=C.map((X,ee)=>X!=null&&X.bankrupt?-1:ee).filter(X=>X>=0),W=C.filter(X=>!(X!=null&&X.bankrupt)),xe=W.length>0&&W.every(X=>(Number(X.lastRevenueRound)||0)>=$);console.log("[DEBUG]  Verificando allAliveDone - Rodada atual:",$,"Jogadores vivos:",W.map(X=>({name:X.name,lastRevenueRound:X.lastRevenueRound})));const ye=C.find(X=>String(X.id)===oe);if(console.log("[DEBUG]  Verificao de rodada - Jogador:",ye==null?void 0:ye.name,"Rodada atual:",$,"round do closure:",n),console.log("[DEBUG]  Jogadores vivos:",te.map(X=>{const ee=C[X],me=se.findIndex(Je=>String(Je.id)===String(ee==null?void 0:ee.id));return`${ee==null?void 0:ee.name}:${me>=0?P[me]:!1}`}).join(", ")),console.log("[DEBUG]  Total de jogadores vivos:",te.length),console.log("[DEBUG]  Flags completas:",P.map((X,ee)=>{var me;return`${(me=C[ee])==null?void 0:me.name}:${X?"":""}`}).join(", ")),console.log("[DEBUG]  Todos passaram pela casa 0?",xe),xe)$<Rn?(J=$+1,H=!0):gt=!0,H?(P=P.map((X,ee)=>{var me;return(me=C[ee])!=null&&me.bankrupt?P[ee]:!1}),console.log("[DEBUG]  RODADA INCREMENTADA - Nova rodada:",J,"Rodada anterior:",$,"Jogadores vivos:",W.length),console.log("[DEBUG]  Flags resetadas:",P.map((X,ee)=>{var me;return`${(me=C[ee])==null?void 0:me.name}:${X}`}).join(", ")),g(` Rodada ${J} iniciada! Todos os jogadores vivos passaram pela casa de faturamento.`)):gt&&console.log("[DEBUG]  FIM DE JOGO - Rodada 5 completa, todos os jogadores vivos chegaram!");else{const X=W.filter(ee=>(Number(ee.lastRevenueRound)||0)<$).map(ee=>ee.name);console.log("[DEBUG]  Rodada NO incrementada - ainda faltam jogadores completarem o ms:",X.join(", "))}}c(P),console.log("[DEBUG] roundFlags updated / round closed:",P.map((T,K)=>{var te;return`${(te=C[K])==null?void 0:te.name}:${T}`}).join(", "));let Ve=Ds(C,V);if(fe.current===5){let T=0;for(;T<C.length;){const K=C[Ve];if(!K.bankrupt&&K.waitingAtRevenue!==!0)break;Ve=(Ve+1)%C.length,T++}}ve&&g(`${He.name} ${ve>0?"ganhou":"pagou"} $${Math.abs(ve).toLocaleString()}`),Ee&&g(Ee),e(C),r(T=>{const K=Math.min(Rn,J),te=Math.min(Rn,Math.max(T,K));return H&&te>T&&(console.log("[ROUND] allAliveDone=true -> round",T,"->",te),g(` Rodada ${te} iniciada! Todos os jogadores vivos passaram pela casa de faturamento.`)),te!==T&&console.log("[ROUND]",T,"->",te),fe.current=te,te});const tt=J,qt=P,nt=C[Ve],le=nt!=null&&nt.id?String(nt.id):null;mt.current={nextPlayers:C,nextTurnIdx:Ve,nextTurnPlayerId:le,nextRound:tt,nextRoundFlags:qt,timestamp:Date.now(),shouldIncrementRound:H,endGame:gt},console.log("[DEBUG]  pendingTurnDataRef preenchido - prximo turno:",Ve,"rodada atual:",n,"prxima rodada:",tt,"nextRound calculado:",J,"shouldIncrementRound:",H,"rodada foi incrementada?",J>n,"roundFlags:",qt.map((T,K)=>{var te;return`${(te=C[K])==null?void 0:te.name}:${T}`}).join(", "));const ie=Ut+1,Se=Gl(we,Ut,0),st=Gl(we,Ut,22);let z=!1;(ie===6||ie===16||ie===32||ie===49)&&d&&N&&x&&(z=!0,q.current=!0,(async()=>{var xe,ye,X,ee,me;const T=((xe=t[V])==null?void 0:xe.erpLevel)||null,K=((ye=t[V])==null?void 0:ye.erpOwned)||((X=t[V])==null?void 0:X.erp)||{},te=await et(a.jsx(Mf,{currentCash:((ee=C[V])==null?void 0:ee.cash)??b,currentLevel:T,erpOwned:K}));if(!te||te.action!=="BUY")return;const W=Number(((me=te.values)==null?void 0:me.compra)||0);if(!Nt(V,W,"comprar ERP")){m(!1);return}e(Je=>{const _t=re(Je,oe,Dt=>Ft(Dt,{cashDelta:-W,erpLevelSet:te.level}));return S(_t,o,fe.current),_t})})()),(ie===2||ie===11||ie===19||ie===47)&&d&&N&&x&&(q.current=!0,(async()=>{var W,xe,ye,X;const T=t.find(p)||C[V],K=await et(a.jsx(Bf,{canTrain:{comum:Number(T==null?void 0:T.vendedoresComuns)||0,field:Number(T==null?void 0:T.fieldSales)||0,inside:Number(T==null?void 0:T.insideSales)||0,gestor:Number((T==null?void 0:T.gestores)??(T==null?void 0:T.gestoresComerciais)??(T==null?void 0:T.managers))||0},ownedByType:{comum:((W=T==null?void 0:T.trainingsByVendor)==null?void 0:W.comum)||[],field:((xe=T==null?void 0:T.trainingsByVendor)==null?void 0:xe.field)||[],inside:((ye=T==null?void 0:T.trainingsByVendor)==null?void 0:ye.inside)||[],gestor:((X=T==null?void 0:T.trainingsByVendor)==null?void 0:X.gestor)||[]}}));if(!K||K.action!=="BUY")return;const te=Number(K.grandTotal||0);if(!Nt(V,te,"comprar Treinamento")){m(!1);return}e(ee=>{const me=re(ee,oe,Je=>Pf(Je,K));return S(me,o,fe.current),me})})()),(ie===5||ie===10||ie===43)&&d&&N&&x&&(q.current=!0,(async()=>{var te,W,xe,ye,X,ee,me,Je,_t,Dt,De,At,Te,tn,Ot,be,je,hn,rt,Ke;const T=((te=C[V])==null?void 0:te.cash)??b,K=await et(a.jsx(wb,{currentCash:T}));if(K){if(K.action==="OPEN"){const lt=String(K.open||"").toUpperCase();if(lt==="MIX"){const M=((W=t[V])==null?void 0:W.mixProdutos)||null,ce=((xe=t[V])==null?void 0:xe.mixOwned)||((ye=t[V])==null?void 0:ye.mix)||{},de=await et(a.jsx(Gf,{currentCash:((X=C[V])==null?void 0:X.cash)??b,currentLevel:M,mixOwned:ce}));if(de&&de.action==="BUY"){const _e=Number(de.compra||0),Pe=String(de.level||"D");if(!Nt(V,_e,"comprar MIX")){m(!1);return}const ke=Math.max(0,- -_e);e($e=>{const ht=re($e,oe,nn=>Ft(nn,{cashDelta:-_e,bensDelta:ke,mixProdutosSet:Pe,mixBaseSet:{despesaPorCliente:Number(de.despesa||0),faturamentoPorCliente:Number(de.faturamento||0)}}));return S(ht,o,fe.current),ht})}return}if(lt==="MANAGER"){const M=await et(a.jsx(zf,{currentCash:((ee=C[V])==null?void 0:ee.cash)??b}));if(M&&(M.action==="BUY"||M.action==="HIRE")){const ce=Number(M.headcount??M.qty??M.managersQty??1),de=Number(typeof M.cashDelta<"u"?M.cashDelta:-Number(M.cost??M.total??M.totalHire??0)),_e=de<0?-de:0;if(_e>0&&!Nt(V,_e,"contratar Gestor")){m(!1);return}const Pe=Number(M.expenseDelta??M.totalExpense??M.maintenanceDelta??0);e(ke=>{const $e=re(ke,oe,ht=>Ft(ht,{cashDelta:de,gestoresDelta:ce,manutencaoDelta:Pe}));return S($e,o,fe.current),$e})}return}if(lt==="INSIDE"){const M=await et(a.jsx(Uf,{currentCash:((me=C[V])==null?void 0:me.cash)??b}));if(M&&(M.action==="BUY"||M.action==="HIRE")){const ce=Number(M.cost??M.total??0);if(!Nt(V,ce,"contratar Inside Sales")){m(!1);return}const de=Number(M.headcount??M.qty??1);e(_e=>{const Pe=re(_e,oe,ke=>Ft(ke,{cashDelta:-ce,insideSalesDelta:de}));return S(Pe,o,fe.current),Pe})}return}if(lt==="FIELD"){const M=await et(a.jsx(Wf,{currentCash:((Je=C[V])==null?void 0:Je.cash)??b}));if(M&&(M.action==="HIRE"||M.action==="BUY")){const ce=Number(M.headcount??M.qty??1),de={cashDelta:Number(M.cashDelta??-Number(M.totalHire??M.total??M.cost??0)),manutencaoDelta:Number(M.expenseDelta??M.totalExpense??0),revenueDelta:Number(M.revenueDelta??0),fieldSalesDelta:ce},_e=de.cashDelta<0?-de.cashDelta:0;if(_e>0&&!Nt(V,_e,"contratar Field Sales")){m(!1);return}e(Pe=>{const ke=re(Pe,oe,$e=>Ft($e,de));return S(ke,o,fe.current),ke})}return}if(lt==="COMMON"){const M=await et(a.jsx(Vf,{currentCash:((_t=C[V])==null?void 0:_t.cash)??b}));if(M&&M.action==="BUY"){const ce=Number(M.headcount??M.qty??0),de={cashDelta:Number(M.cashDelta??-Number(M.totalHire??M.total??M.cost??0)),vendedoresComunsDelta:ce,manutencaoDelta:Number(M.expenseDelta??M.totalExpense??0),revenueDelta:Number(M.revenueDelta??0)},_e=de.cashDelta<0?-de.cashDelta:0;if(_e>0&&!Nt(V,_e,"contratar Vendedores Comuns")){m(!1);return}e(Pe=>{const ke=re(Pe,oe,$e=>Ft($e,de));return S(ke,o,fe.current),ke})}return}if(lt==="ERP"){const M=((Dt=t[V])==null?void 0:Dt.erpLevel)||null,ce=((De=t[V])==null?void 0:De.erpOwned)||((At=t[V])==null?void 0:At.erp)||{},de=await et(a.jsx(Mf,{currentCash:((Te=C[V])==null?void 0:Te.cash)??b,currentLevel:M,erpOwned:ce}));if(de&&de.action==="BUY"){const _e=Number(((tn=de.values)==null?void 0:tn.compra)||0);if(!Nt(V,_e,"comprar ERP")){m(!1);return}e(Pe=>{const ke=re(Pe,oe,$e=>Ft($e,{cashDelta:-_e,erpLevelSet:de.level}));return S(ke,o,fe.current),ke})}return}if(lt==="CLIENTS"){const M=Number(((Ot=C.find(de=>String(de.id)===oe))==null?void 0:Ot.cash)??b),ce=await et(a.jsx(Ff,{currentCash:M}));if(ce&&ce.action==="BUY"){const de=Number(ce.totalCost||0);if(M<de){g("Saldo insuficiente para comprar Clientes."),m(!1);return}const _e=Number(ce.qty||0),Pe=Number(ce.maintenanceDelta||0),ke=Number(ce.bensDelta||de);e($e=>{const ht=$e.map(nn=>String(nn.id)!==oe?nn:Ft(nn,{cashDelta:-de,clientsDelta:_e,manutencaoDelta:Pe,bensDelta:ke}));return S(ht,o,fe.current),ht})}return}if(lt==="TRAINING"){const M=t.find(p)||C[V],ce=await et(a.jsx(Bf,{canTrain:{comum:Number(M==null?void 0:M.vendedoresComuns)||0,field:Number(M==null?void 0:M.fieldSales)||0,inside:Number(M==null?void 0:M.insideSales)||0,gestor:Number((M==null?void 0:M.gestores)??(M==null?void 0:M.gestoresComerciais)??(M==null?void 0:M.managers))||0},ownedByType:{comum:((be=M==null?void 0:M.trainingsByVendor)==null?void 0:be.comum)||[],field:((je=M==null?void 0:M.trainingsByVendor)==null?void 0:je.field)||[],inside:((hn=M==null?void 0:M.trainingsByVendor)==null?void 0:hn.inside)||[],gestor:((rt=M==null?void 0:M.trainingsByVendor)==null?void 0:rt.gestor)||[]}}));if(ce&&ce.action==="BUY"){const de=Number(ce.grandTotal||0);if(!Nt(V,de,"comprar Treinamento")){m(!1);return}e(_e=>{const Pe=re(_e,oe,ke=>Pf(ke,ce));return S(Pe,o,fe.current),Pe})}return}}if(K.action==="BUY"){if(K.kind==="CLIENTS"||K.modal==="CLIENTS"||typeof K.clientsQty<"u"||typeof K.numClients<"u"||typeof K.totalCost<"u"||typeof K.maintenanceDelta<"u"){const ce=Number(K.totalCost??K.total??K.amount??0);if(Number(((Ke=C.find($e=>String($e.id)===oe))==null?void 0:Ke.cash)??b)<ce){g("Saldo insuficiente para comprar Clientes."),m(!1);return}const _e=Number(K.clientsQty??K.numClients??K.qty??0),Pe=Number(K.maintenanceDelta??K.maintenance??K.mexp??0),ke=Number(K.bensDelta??ce);e($e=>{const ht=$e.map(nn=>String(nn.id)!==oe?nn:Ft(nn,{cashDelta:-ce,clientsDelta:_e,manutencaoDelta:Pe,bensDelta:ke}));return S(ht,o,fe.current),ht});return}const M=Number(K.total??K.amount??0);if(!Nt(V,M,"esta compra")){m(!1);return}e(ce=>{const de=ce.map((_e,Pe)=>Pe!==V?_e:Ft(_e,{cashDelta:-M,directBuysPush:[K.item||{total:M}]}));return S(de,o,fe.current),de})}}})()),(ie===12||ie===21||ie===30||ie===42||ie===53)&&d&&N&&x&&(q.current=!0,(async()=>{var W;const T=await et(a.jsx(Uf,{currentCash:((W=C[V])==null?void 0:W.cash)??b}));if(!T||T.action!=="HIRE"&&T.action!=="BUY")return;const K=Number(T.cost??T.total??0);if(!Nt(V,K,"contratar Inside Sales")){m(!1);return}const te=Number(T.headcount??T.qty??1);e(xe=>{const ye=re(xe,oe,X=>Ft(X,{cashDelta:-K,insideSalesDelta:te}));return S(ye,o,fe.current),ye})})()),[4,8,15,17,20,27,34,36,39,46,52,55].includes(ie)&&d&&N&&x&&(q.current=!0,(async()=>{var X;const T=Number(((X=C.find(ee=>String(ee.id)===oe))==null?void 0:X.cash)??b),K=await et(a.jsx(Ff,{currentCash:T}));if(!K||K.action!=="BUY")return;const te=Number(K.totalCost||0);if(T<te){g("Saldo insuficiente para comprar Clientes."),m(!1);return}const W=Number(K.qty||0),xe=Number(K.maintenanceDelta||0),ye=Number(K.bensDelta||te);e(ee=>{const me=ee.map(Je=>String(Je.id)!==oe?Je:Ft(Je,{cashDelta:-te,clientsDelta:W,manutencaoDelta:xe,bensDelta:ye}));return S(me,o,fe.current),me})})()),[18,24,29,51].includes(ie)&&d&&N&&x&&(q.current=!0,(async()=>{var ye;const T=await et(a.jsx(zf,{currentCash:((ye=C[V])==null?void 0:ye.cash)??b}));if(!T||T.action!=="BUY"&&T.action!=="HIRE")return;const K=Number(T.headcount??T.qty??T.managersQty??1),te=Number(typeof T.cashDelta<"u"?T.cashDelta:-Number(T.cost??T.total??T.totalHire??0)),W=te<0?-te:0;if(W>0&&!Nt(V,W,"contratar Gestor")){m(!1);return}const xe=Number(T.expenseDelta??T.totalExpense??T.maintenanceDelta??0);e(X=>{const ee=re(X,oe,me=>Ft(me,{cashDelta:te,gestoresDelta:K,manutencaoDelta:xe}));return S(ee,o,fe.current),ee})})()),[13,25,33,38,50].includes(ie)&&d&&N&&x&&(q.current=!0,(async()=>{var K;const T=await et(a.jsx(Wf,{currentCash:((K=C[V])==null?void 0:K.cash)??b}));if(T&&(T.action==="HIRE"||T.action==="BUY")){const te=Number(T.headcount??T.qty??1),W={cashDelta:Number(T.cashDelta??-Number(T.totalHire??T.total??T.cost??0)),manutencaoDelta:Number(T.expenseDelta??T.totalExpense??0),revenueDelta:Number(T.revenueDelta??0),fieldSalesDelta:te},xe=W.cashDelta<0?-W.cashDelta:0;if(xe>0&&!Nt(V,xe,"contratar Field Sales")){m(!1);return}e(ye=>{const X=re(ye,oe,ee=>Ft(ee,W));return S(X,o,fe.current),X})}})()),[9,28,40,45].includes(ie)&&d&&N&&x&&(q.current=!0,(async()=>{var xe;const T=await et(a.jsx(Vf,{currentCash:((xe=C[V])==null?void 0:xe.cash)??b}));if(!T||T.action!=="BUY")return;const K=Number(T.headcount??T.qty??0),te={cashDelta:Number(T.cashDelta??-Number(T.totalHire??T.total??T.cost??0)),vendedoresComunsDelta:K,manutencaoDelta:Number(T.expenseDelta??T.totalExpense??0),revenueDelta:Number(T.revenueDelta??0)},W=te.cashDelta<0?-te.cashDelta:0;if(W>0&&!Nt(V,W,"contratar Vendedores Comuns")){m(!1);return}e(ye=>{const X=re(ye,oe,ee=>Ft(ee,te));return S(X,o,fe.current),X})})()),[7,31,44].includes(ie)&&d&&N&&x&&(q.current=!0,(async()=>{var X,ee,me,Je;const T=((X=t[V])==null?void 0:X.mixProdutos)||null,K=((ee=t[V])==null?void 0:ee.mixOwned)||((me=t[V])==null?void 0:me.mix)||{},te=await et(a.jsx(Gf,{currentCash:((Je=C[V])==null?void 0:Je.cash)??b,currentLevel:T,mixOwned:K}));if(!te||te.action!=="BUY")return;const W=Number(te.compra||0);if(!Nt(V,W,"comprar MIX")){m(!1);return}const xe=String(te.level||"D"),ye=Math.max(0,W);e(_t=>{const Dt=_t.map((De,At)=>At!==V?De:Ft(De,{cashDelta:-W,bensDelta:ye,mixProdutosSet:xe,mixBaseSet:{despesaPorCliente:Number(te.despesa||0),faturamentoPorCliente:Number(te.faturamento||0)}}));return S(Dt,o,fe.current),Dt})})());const fn=[3,14,22,26,35,41,48,54].includes(ie);if(d&&!!N&&!!x&&(Se||st||fn)){const T=mt.current;T._once=T._once||{};const K=(W,xe,ye)=>{const X=(xe-W+ye)%ye;return X===0?ye:X},te=[];Se&&!T._once.faturamento&&(T._once.faturamento=!0,te.push({type:"REVENUE",at:K(we,0,mo)})),st&&!T._once.expenses23&&(T._once.expenses23=!0,te.push({type:"EXPENSES",at:K(we,22,mo)})),fn&&!T._once.luck&&(T._once.luck=!0,te.push({type:"LUCK",at:Y})),te.sort((W,xe)=>W.at-xe.at),Z(async()=>{let W=Array.isArray(Rt.current)?Rt.current:C;for(const xe of te){const ye=qe(W,oe)||{};if(!(ye!=null&&ye.id))break;if(xe.type==="REVENUE"){q.current=!0;const X=Math.max(0,Math.floor(ol(ye)));await et(a.jsx(_b,{value:X})),W=re(W,oe,ee=>({...ee,cash:(Number(ee.cash)||0)+X})),e(W),S(W,er.current,fe.current),g(`${ye.name} recebeu faturamento do ms: +$${X.toLocaleString()}`);continue}if(xe.type==="EXPENSES"){q.current=!0;const X=Math.max(0,Math.floor(sl(ye))),ee=ye.loanPending||{},me=Number(ee.amount)>0&&!ee.charged&&ee.shouldChargeOnNextExpenses===!0,Je=me?Math.max(0,Math.floor(Number(ee.amount))):0;await et(a.jsx(kb,{expense:X,loanCharge:Je}));const _t=X+Je;if(!await Ne(_t,"Despesas Operacionais","pagar",W))return;W=Array.isArray(Rt.current)?Rt.current:W,me&&(W=re(W,oe,De=>({...De,loanPending:{...De.loanPending||{},charged:!0,chargedAtRound:fe.current,shouldChargeOnNextExpenses:!1}})),e(W),S(W,er.current,fe.current)),g(`${ye.name} pagou despesas operacionais: -$${X.toLocaleString()}`),Je>0&&g(`${ye.name} teve emprstimo cobrado: -$${Je.toLocaleString()}`);continue}if(xe.type==="LUCK"){q.current=!0;const X=qe(Array.isArray(Rt.current)?Rt.current:W,oe)||qe(W,oe)||ye,ee=await et(a.jsx(Sb,{player:X}));if(!ee||ee.action!=="APPLY_CARD")continue;let me=Number.isFinite(ee.cashDelta)?Number(ee.cashDelta):0;const Je=Number.isFinite(ee.clientsDelta)?Number(ee.clientsDelta):0;if(me<0){if(!await Ne(Math.abs(me),"Sorte & Revs","pagar",W))return;me=0,W=Array.isArray(Rt.current)?Rt.current:W}if(W=re(W,oe,Dt=>{var At;let De={...Dt};if(me&&(De.cash=Math.max(0,(Number(De.cash)||0)+me)),Je&&(De.clients=Math.max(0,(Number(De.clients)||0)+Je)),ee.gainSpecialCell&&(De.fieldSales=(De.fieldSales||0)+(ee.gainSpecialCell.fieldSales||0),De.support=(De.support||0)+(ee.gainSpecialCell.support||0),De.gestores=(De.gestores||0)+(ee.gainSpecialCell.manager||0),De.gestoresComerciais=(De.gestoresComerciais||0)+(ee.gainSpecialCell.manager||0),De.managers=(De.managers||0)+(ee.gainSpecialCell.manager||0)),ee.id==="casa_change_cert_blue"){De.az=(De.az||0)+1;const Te=new Set(((At=De.trainingsByVendor)==null?void 0:At.comum)||[]);Te.add("personalizado"),De.trainingsByVendor={...De.trainingsByVendor||{},comum:Array.from(Te)}}return De}),e(W),S(W,er.current,fe.current),ee.perClientBonus||ee.perCertifiedManagerBonus||ee.mixLevelBonusABOnly){const Dt=qe(W,oe)||{};let De=0;if(ee.perClientBonus&&(De+=(Number(Dt.clients)||0)*Number(ee.perClientBonus||0)),ee.perCertifiedManagerBonus&&(De+=sb(Dt)*Number(ee.perCertifiedManagerBonus||0)),ee.mixLevelBonusABOnly){const At=String(Dt.mixProdutos||"").toUpperCase();(At==="A"||At==="B")&&(De+=Number(ee.mixLevelBonusABOnly||0))}De&&(W=re(W,oe,At=>({...At,cash:(Number(At.cash)||0)+De})),e(W),S(W,er.current,fe.current))}}}})}const Ao=Date.now();let tr=0;const to=200,Cn=()=>{var ee,me,Je;if(tr++,tr>to){console.warn("[DEBUG]  TIMEOUT - excedeu tentativas mximas, forando desbloqueio");const _t=ot.current;String(_t||"")===String(h)&&(m(!1),F.current=!1,B.current>0&&(console.warn("[DEBUG]  Forando modalLocks para 0 (timeout)"),B.current=0,U(0)),q.current=!1);return}const T=B.current,K=q.current||Ue.current,te=ot.current,W=String(te||"")===String(h);if(console.log("[DEBUG] tick - tentativa:",tr,"modalLocks:",T,"openingModalRef:",K,"lockOwner:",te,"myUid:",h,"isLockOwner:",W),K){console.log("[DEBUG]  tick - modal est sendo aberta, aguardando..."),setTimeout(Cn,150);return}const xe=at.current?Date.now()-at.current:1/0;if(T===0&&(xe>=200||!at.current)){const _t=mt.current;if(!!(_t!=null&&_t.endGame||Zr.current)&&!eo.current){eo.current=!0,Zr.current=!1;const Te=Array.isArray(Rt.current)?Rt.current:(_t==null?void 0:_t.nextPlayers)||[],tn=(Te||[]).filter(be=>!(be!=null&&be.bankrupt));let Ot=null;tn.length>0&&(Ot=((ee=tn.map(je=>({p:je,patrimonio:(Number(je.cash)||0)+(Number(je.bens)||0),cash:Number(je.cash)||0})).sort((je,hn)=>{var rt,Ke;return hn.patrimonio-je.patrimonio||hn.cash-je.cash||String(((rt=je.p)==null?void 0:rt.name)||"").localeCompare(String(((Ke=hn.p)==null?void 0:Ke.name)||""))})[0])==null?void 0:ee.p)||null),console.log("[ENDGAME] finalizando: vencedor=%s, round=5",(Ot==null?void 0:Ot.name)||""),e(Te||[]),_(!0),D(Ot),r(5),fe.current=5,mt.current=null,F.current=!1,q.current=!1,m(!1),S(Te||[],er.current,5,!0,Ot,{round:5,gameOver:!0,winner:Ot});return}const De=t[o],At=De&&String(De.id)===String(h);if(W||At&&!te){const Te=mt.current;if(console.log("[DEBUG]  tick - verificando pendingTurnDataRef:",Te?`prximo turno: ${Te.nextTurnIdx}`:"null"),Te){const tn=Array.isArray(Rt.current)&&Rt.current.length?Rt.current:Te.nextPlayers||[],Ot=B.current,be=q.current,je=o,hn=ot.current,rt=String(hn||"")===String(h),Ke=at.current?Date.now()-at.current:1/0,lt=Ot===0&&!be&&(Ke>=200||!at.current);if(lt&&je===o&&rt){console.log("[DEBUG]  Mudando turno - de:",o,"para:",Te.nextTurnIdx,"finalModalLocks:",Ot,"finalOpening:",be,"timeSinceLastModalClosed:",Ke);const M=fe.current===5&&Te.shouldIncrementRound,ce=Te.endGame===!0;if(M||ce||Te.shouldIncrementRound&&Te.nextRound>Rn){console.log("[ENDGAME] detectado: fim da 5 - currentRound:",fe.current,"shouldIncrementRound:",Te.shouldIncrementRound,"nextRound:",Te.nextRound);const ke=Si(tn,Te.nextRound,o);if(ke.finished){console.log("[DEBUG]  FIM DE JOGO finalizando - Rodada:",ke.finalRound,"Vencedor:",((me=ke.winner)==null?void 0:me.name)||null),e(tn),D(ke.winner),_(!0),r(ke.finalRound),fe.current=ke.finalRound,g(`Fim de jogo! ${Rn} rodadas completas. Vencedor: ${((Je=ke.winner)==null?void 0:Je.name)||""}`);const $e={};Te.nextRoundFlags&&($e.roundFlags=Te.nextRoundFlags),$e.round=ke.finalRound,$e.gameOver=!0,$e.winner=ke.winner,S(tn,o,ke.finalRound,!0,ke.winner,$e),mt.current=null,m(!1),F.current=!1;return}}F.current=!0;const de=Te.nextRound,_e=Te.shouldIncrementRound||!1;console.log("[DEBUG]  Broadcast - Rodada a ser transmitida:",de,"Rodada atual no estado:",n,"shouldIncrement:",_e),s(Te.nextTurnIdx),l&&l(Te.nextTurnPlayerId??null),r(ke=>{const $e=Math.min(Rn,de),ht=Math.min(Rn,Math.max(ke,$e));return ht!==ke&&console.log("[DEBUG]  Rodada atualizada no tick - de:",ke,"para:",ht),fe.current=ht,ht});const Pe={};Te.nextRoundFlags&&(Pe.roundFlags=Te.nextRoundFlags),Te.shouldIncrementRound&&(Pe.round=de),Te.nextTurnPlayerId&&(Pe.turnPlayerId=Te.nextTurnPlayerId),S(tn,Te.nextTurnIdx,de,w,R,Pe),mt.current=null,m(!1),F.current=!1,console.log("[DEBUG]  Turno mudado com sucesso - Rodada:",de)}else{console.log("[DEBUG]  tick - condies no atendidas, no mudando turno",{finalModalLocks:Ot,finalOpening:be,finalCanChangeTurn:lt,timeSinceLastModalClosed:Ke,finalTurnIdx:je,turnIdx:o,finalIsLockOwner:rt,isLockOwner:W}),console.log("[DEBUG]  tick - condies no atendidas, no mudando turno",{finalModalLocks:Ot,finalOpening:be,finalTurnIdx:je,turnIdx:o,finalIsLockOwner:rt,isLockOwner:W}),setTimeout(Cn,150);return}}else{console.log("[DEBUG]  tick - turnData  null, no mudando turno. turnIdx atual:",o,"lockOwner:",te,"isLockOwner:",W);const tn=at.current?Date.now()-at.current:1/0,Ot=T===0&&(tn>=200||!at.current);if(W&&Ot&&!K)if(tr<10){console.log("[DEBUG]  tick - tentando novamente em 200ms (pode ser que pendingTurnDataRef ainda no foi preenchido)"),setTimeout(Cn,200);return}else console.warn("[DEBUG]  tick - excedeu tentativas de retry, liberando turnLock"),m(!1),F.current=!1;else m(!1),F.current=!1}}else console.log("[DEBUG]  tick - no sou o dono do cadeado e no  minha vez, no mudando turno",{isLockOwner:W,isCurrentPlayerMe:At,currentLockOwner:te,myUid:h,turnIdx:o}),At||(m(!1),F.current=!1);return}setTimeout(Cn,100)};let Ln=0;const Fe=50,In=()=>{Ln++;const T=q.current,K=B.current>0;if((T||K)&&Ln<Fe){Ln%5===1&&console.log("[DEBUG]  checkBeforeTick - aguardando modais...",{hasOpening:T,hasLocks:K,modalLocks:B.current,attempt:Ln});const te=Math.min(1e3,Math.floor(150*Math.pow(1.35,Ln)));setTimeout(In,te);return}Ln>=Fe&&(console.warn("[DEBUG]  checkBeforeTick - excedeu tentativas, forando avano do turno",{hasOpening:T,hasLocks:K,modalLocks:B.current}),B.current>0&&(console.warn("[DEBUG]  checkBeforeTick - forando modalLocks para 0"),B.current=0,U(0)),q.current=!1),console.log("[DEBUG]  checkBeforeTick - iniciando tick, sem modais abertas"),Cn()};setTimeout(In,500)}catch(V){throw console.error("[DEBUG] Erro em advanceAndMaybeLap:",V),ot.current===String(h)&&m(!1),V}finally{ot.current===String(h)?setTimeout(()=>{ot.current===String(h)&&(m(!1),F.current=!1)},100):F.current=!1}}},[t,n,o,u,d,p,h,b,w,g,S,e,r,s,c,m,Nt,Si,N,x,j]),il=ue.useCallback(()=>{if(w||!t.length)return;const Y=Ds(t,o),ve=t[Y],Ee=ve!=null&&ve.id?String(ve.id):null;s(Y),l&&l(Ee),S(t,Y,fe.current,!1,null,{turnPlayerId:Ee})},[S,w,t,n,s,l,o]),Lt=ue.useCallback(Y=>{var ve,Ee,V,He,oe,Ne,we,Ut,kn,O;if(!(!(Y!=null&&Y.type)||Gt.current||Zr.current||eo.current)){if(Y.type==="ROLL"){if(!i||String(i)!==String(h)){console.warn("[ROLL_BLOCK] not my turn (turnPlayerId mismatch)",{turnPlayerId:i,myUid:h});return}if(!d){console.warn("[DEBUG]  onAction ROLL - no  minha vez, ignorando");return}if(f){console.warn("[DEBUG]  onAction ROLL - turnLock ativo, ignorando");return}const A=ot.current;if(f&&A&&String(A)!==String(h)){console.warn("[ROLL_BLOCK] locked by other",{lockOwner:A,myUid:h});return}if(B.current>0){console.warn("[DEBUG]  onAction ROLL - h modais abertas, ignorando");return}try{const $=`ROLL:r${fe.current}:t${er.current}:${Date.now()}`;gb(Db({traceId:$,actionType:"ROLL",reason:Y.note||"ROLL",origin:{file:"src/game/useTurnEngine.jsx",fn:"onAction(ROLL)"},context:{round:fe.current}}))}catch{}try{bs(Y.steps,Y.cashDelta,Y.note)}catch($){console.error("[DEBUG] Erro em advanceAndMaybeLap:",$),ot.current===String(h)&&m(!1)}return}if(Y.type==="RECOVERY"){const A=Math.floor(Math.random()*3e3)+1e3,$=t.find(p);if(!$)return;const Q=t.map(C=>p(C)?{...C,cash:C.cash+A}:C);g(`${$.name} ativou Recuperao Financeira (+$${A})`),e(Q),S(Q,o,fe.current);return}if(Y.type==="RECOVERY_CUSTOM"){const A=Number(Y.amount||0),$=t.find(p);if(!$)return;const Q=t.map(C=>p(C)?{...C,cash:C.cash+A}:C);g(`${$.name} recuperou +$${A}`),e(Q),S(Q,o,fe.current);return}if(Y.type==="RECOVERY_MODAL"){if(!d||!N||!x)return;(async()=>{const A=await et(a.jsx(qf,{playerName:(v==null?void 0:v.name)||"Jogador",currentPlayer:v}));if(A){if(A&&A.type==="TRIGGER_BANKRUPTCY"){Lt({type:"BANKRUPT"});return}switch(A.type){case"FIRE":Lt==null||Lt({type:"RECOVERY_FIRE",items:A.items,amount:A.totalCredit??A.amount??0,note:A.note,creditByRole:A.creditByRole});break;case"REDUCE":{const $=Array.isArray(A.items)&&A.items.length>0,Q=$?A.items.map((P,H)=>({...P,group:String(P.group||P.tipo||"").toUpperCase(),level:String(P.level||P.nivel||"").toUpperCase(),credit:Number(P.credit??P.amount??0),selected:H===0?!0:!!P.selected})):void 0,C=$&&(Q==null?void 0:Q[0])||A.selection||A.sel||(A.group&&A.level?{group:String(A.group).toUpperCase(),level:String(A.level).toUpperCase(),credit:Number(A.credit??A.amount??0)}:null),I=Number(($?A.total??A.totalCredit:void 0)??(C==null?void 0:C.credit)??A.amount??0),J=A.note||($?`Reduo mltipla +R$ ${I.toLocaleString()}`:C?`Reduo ${C.group} nvel ${C.level} +R$ ${I.toLocaleString()}`:`Reduo +R$ ${I.toLocaleString()}`);Lt==null||Lt({type:"RECOVERY_REDUCE",items:Q,selection:C||null,amount:I,note:J});break}case"LOAN":{const $=typeof A.amount=="object"&&A.amount!==null?A.amount:{amount:Number(A.amount??0),cashDelta:Number(A.cashDelta??A.amount??0),loan:A.loan},Q=Number($.amount??0),C=Number($.cashDelta??Q??0),I=$.loan??A.loan??{};Lt==null||Lt({type:"RECOVERY_LOAN",amount:Q,cashDelta:C,loan:I,note:A.note});break}default:A.amount>0&&(Lt==null||Lt({type:"RECOVERY_CUSTOM",amount:A.amount,note:A.note}))}}})();return}if(Y.type==="BANKRUPT_MODAL"){if(!d||!N||!x)return;(async()=>await et(a.jsx(Nb,{playerName:(v==null?void 0:v.name)||"Jogador"}))&&(Lt==null||Lt({type:"BANKRUPT"})))();return}if(Y.type==="RECOVERY_FIRE"){const A=Number(Y.amount||0),$=Y.items||{},Q={cashDelta:A,vendedoresComunsDelta:-Number($.comum||0),fieldSalesDelta:-Number($.field||0),insideSalesDelta:-Number($.inside||0),gestoresDelta:-Number($.gestor||0)},C=o,I=String(((ve=t[C])==null?void 0:ve.id)??"");e(J=>{const P=I?re(J,I,H=>Ft(H,Q)):J;return S(P,o,fe.current),P}),g(`${((Ee=t[C])==null?void 0:Ee.name)||"Jogador"}: ${Y.note||"Demisses"}`);return}if(Y.type==="RECOVERY_LOAN"){const A=Math.max(0,Number(Y.amount||0));if(!A)return;const $=o,Q=t[$];if(Q!=null&&Q.loanPending&&!Q.loanPending.charged){g(`${(Q==null?void 0:Q.name)||"Jogador"} j possui um emprstimo pendente.`);return}e(C=>{const I=C.map((J,P)=>P!==$?J:{...J,cash:(Number(J.cash)||0)+A,loanPending:{amount:A,charged:!1,shouldChargeOnNextExpenses:!0}});return S(I,o,fe.current),I}),g(`${(Q==null?void 0:Q.name)||"Jogador"} pegou emprstimo: +$${A.toLocaleString()}`);return}if(Y.type==="BUY_MIX"||Y.kind==="MIX_BUY"||Y.type==="DIRECT_BUY_MIX"){const A=String(Y.level||"").toUpperCase(),$=Math.max(0,Number(Y.price??0));if(!["A","B","C","D"].includes(A)){m(!1);return}const Q=o;if(!No(Q,$)){g("Saldo insuficiente para comprar MIX"),m(!1);return}e(C=>{const I=C.map((J,P)=>{if(P!==Q)return J;const H={...J.mixOwned||J.mix||{},D:!0};return H[A]=!0,{...J,cash:Math.max(0,(Number(J.cash)||0)-$),bens:(Number(J.bens)||0)+$,mixOwned:H,mix:H,mixLevel:A,mixProdutos:A}});return S(I,o,fe.current),I}),g(`${((V=t[Q])==null?void 0:V.name)||"Jogador"} comprou MIX nvel ${A} por -$${$.toLocaleString()}`),m(!1);return}if(Y.type==="BUY_ERP"||Y.kind==="ERP_BUY"||Y.type==="DIRECT_BUY_ERP"){const A=String(Y.level||"").toUpperCase(),$=Math.max(0,Number(Y.price??0));if(!["A","B","C","D"].includes(A)){m(!1);return}const Q=o;if(!No(Q,$)){g("Saldo insuficiente para comprar ERP"),m(!1);return}e(C=>{const I=C.map((J,P)=>{if(P!==Q)return J;const H={...J.erpOwned||J.erp||{},D:!0};return H[A]=!0,{...J,cash:Math.max(0,(Number(J.cash)||0)-$),erpOwned:H,erp:H,erpLevel:A,erpSystems:{...J.erpSystems||{},level:A}}});return S(I,o,fe.current),I}),g(`${((He=t[Q])==null?void 0:He.name)||"Jogador"} comprou ERP nvel ${A} por -$${$.toLocaleString()}`),m(!1);return}if(Y.type==="RECOVERY_REDUCE"){const A=le=>String(le||"").toUpperCase(),$=le=>{const ie=String(le||"").toUpperCase();return ie==="MIX"||ie==="ERP"?ie:ie.includes("MIX")?"MIX":ie.includes("ERP")?"ERP":""},C=(()=>{if(Array.isArray(Y.items)&&Y.items.length)return Y.items.filter(ie=>(ie==null?void 0:ie.selected)??!0).map(ie=>({group:$(ie.group||ie.kind),level:A(ie.level),credit:Math.max(0,Number(ie.credit??ie.amount??0))})).filter(ie=>(ie.group==="MIX"||ie.group==="ERP")&&["A","B","C"].includes(ie.level));const le=Y.selection||Y.target||null;if(le){const ie={group:$(le.group||le.kind),level:A(le.level),credit:Math.max(0,Number(le.credit??le.amount??Y.amount??0))};if((ie.group==="MIX"||ie.group==="ERP")&&["A","B","C"].includes(ie.level))return[ie]}return[]})();if(!C.length){const le=Math.max(0,Number(Y.amount??0));if(le>0){const ie=o;e(Se=>{const st=Se.map((z,ne)=>ne!==ie?z:{...z,cash:(Number(z.cash)||0)+le});return S(st,o,fe.current),st})}return}const I=(le,ie)=>{const Se={A:!1,B:!1,C:!1,D:!1,...le||{}},st=A(ie);return!Se.A&&!Se.B&&!Se.C&&!Se.D&&(["A","B","C","D"].includes(st)?Se[st]=!0:Se.D=!0),Se},J=le=>le!=null&&le.A?"A":le!=null&&le.B?"B":le!=null&&le.C?"C":le!=null&&le.D?"D":"-",P=o,H=t[P];if(C.some(le=>le.level==="D")){g("No  possvel reduzir o nvel D (bsico).");return}const Ve=Array.isArray((oe=H.reducedLevels)==null?void 0:oe.MIX)?H.reducedLevels.MIX:[],tt=Array.isArray((Ne=H.reducedLevels)==null?void 0:Ne.ERP)?H.reducedLevels.ERP:[];if(C.some(le=>le.group==="MIX"&&Ve.includes(le.level)||le.group==="ERP"&&tt.includes(le.level))){g("No  possvel reduzir um nvel que j foi reduzido anteriormente.");return}e(le=>{const ie=le.map((Se,st)=>{var Cn,Ln;if(st!==P)return Se;let z={A:!1,B:!1,C:!1,D:!1,...Se.mixOwned||Se.mix||{}},ne={A:!1,B:!1,C:!1,D:!1,...Se.erpOwned||Se.erp||{}};z=I(z,Se.mixProdutos),ne=I(ne,Se.erpSistemas);const Oe=[...Array.isArray((Cn=Se.reducedLevels)==null?void 0:Cn.MIX)?Se.reducedLevels.MIX:[]],Ge=[...Array.isArray((Ln=Se.reducedLevels)==null?void 0:Ln.ERP)?Se.reducedLevels.ERP:[]];let he=0,yt=String(Se.mixProdutos||"D").toUpperCase(),St=String(Se.erpLevel||Se.erpSistemas||"D").toUpperCase();for(const Fe of C)if(he+=Math.max(0,Number(Fe.credit||0)),Fe.group==="MIX"){if(Fe.level===yt){const In=["A","B","C","D"],T=In.indexOf(yt);for(let K=T+1;K<In.length;K++){const te=In[K];if(z[te]||te==="D"){yt=te;break}}}delete z[Fe.level],z[Fe.level]=!1,Oe.includes(Fe.level)||Oe.push(Fe.level)}else if(Fe.group==="ERP"){if(Fe.level===St){const In=["A","B","C","D"],T=In.indexOf(St);for(let K=T+1;K<In.length;K++){const te=In[K];if(ne[te]||te==="D"){St=te;break}}}delete ne[Fe.level],ne[Fe.level]=!1,Ge.includes(Fe.level)||Ge.push(Fe.level)}z.A||z.B||z.C||(z.D=!0,z.A=!1,z.B=!1,z.C=!1),ne.A||ne.B||ne.C||(ne.D=!0,ne.A=!1,ne.B=!1,ne.C=!1);const jn=J(z),fn=J(ne),Do=jn!=="-"?jn:yt||"D",Ao=fn!=="-"?fn:St||"D",tr={...z},to={...ne};return{...Se,cash:(Number(Se.cash)||0)+he,mixOwned:tr,erpOwned:to,mix:tr,erp:to,mixProdutos:Do,erpLevel:Ao,erpSistemas:Ao,reducedLevels:{MIX:Oe,ERP:Ge}}});return S(ie,o,fe.current),ie});const nt=C.reduce((le,ie)=>le+Math.max(0,Number(ie.credit||0)),0);if(C.length===1){const le=C[0];g(`${(H==null?void 0:H.name)||"Jogador"} reduziu ${le.group} nvel ${le.level} e recebeu +$${nt.toLocaleString()}`)}else g(`${(H==null?void 0:H.name)||"Jogador"} reduziu ${C.length} nveis e recebeu +$${nt.toLocaleString()}`);return}if(Y.type==="BANKRUPT"){const A=o;try{String((we=t[A])==null?void 0:we.id)===String(h)&&(k==null||k(!0))}catch{}const $=t.map((I,J)=>J===A?{...I,bankrupt:!0}:I);if(g(`${((Ut=t[A])==null?void 0:Ut.name)||"Jogador"} declarou FALNCIA.`),Ks($)<=1){const I=$.findIndex(J=>!(J!=null&&J.bankrupt));D(I>=0?$[I]:null),e($),_(!0),m(!1),S($,o,n,!0,I>=0?$[I]:null);return}const C=Ds($,A);if(e($),s(C),l){const I=$[C];l(I!=null&&I.id?String(I.id):null)}m(!1),S($,C,fe.current),console.log("[DEBUG]  advanceAndMaybeLap finalizada (falncia) - posio final:",(kn=$[C])==null?void 0:kn.pos);return}console.log("[DEBUG]  advanceAndMaybeLap finalizada normalmente - posio final:",(O=nextPlayers[curIdx])==null?void 0:O.pos)}},[t,n,o,d,p,h,b,w,g,S,e,r,s,m,_,D,Nt,N,x,j,k]);return ue.useEffect(()=>{if(L===0&&f&&!q.current){const Y=ot.current;String(Y||"")===String(h)?(console.log("[DEBUG]  Destravando turnLock - modalLocks: 0, sou o lockOwner"),m(!1),F.current=!1):d||(console.log("[DEBUG]  Destravando turnLock - no  minha vez e no sou lockOwner"),m(!1),F.current=!1)}},[L,f,Xr,h,d,m]),ue.useEffect(()=>{if(d&&L===0&&f&&!q.current){const Y=ot.current;String(Y||"")===String(h)?(console.log("[DEBUG]  Destravando turnLock -  minha vez e sou o lockOwner"),m(!1),F.current=!1):Y||(console.log("[DEBUG]  Destravando turnLock -  minha vez mas no h lockOwner"),m(!1),F.current=!1)}},[d,L,f,Xr,h,m]),ue.useEffect(()=>()=>{pe.current&&(clearTimeout(pe.current),pe.current=null),F.current=!1,q.current=!1},[]),{advanceAndMaybeLap:bs,onAction:Lt,nextTurn:il,modalLocks:L,lockOwner:Xr}}const Lm=E.createContext(null),Ob=()=>E.useContext(Lm);function Tb({roomCode:t,hostId:e,children:n}){const r=!!Be&&!!t,o=String(t||"").trim(),[s,i]=E.useState(!1),[l,u]=E.useState({}),[c,d]=E.useState(0),[p,h]=E.useState(null),y=E.useRef(l),b=E.useRef(c),v=E.useRef(p),S=E.useRef(0),g=E.useRef(null),f=E.useRef(null);E.useEffect(()=>{y.current=l},[l]),E.useEffect(()=>{b.current=c},[c]),E.useEffect(()=>{v.current=p},[p]);const m=async R=>{const{data:D,error:k}=await Be.from("rooms").select("id, code, host_id, state, version, updated_at").eq("code",R).order("updated_at",{ascending:!1}).limit(1).maybeSingle();return k?(console.warn("[NET] getLatestRoomByCode error:",k.message||k),null):D};E.useEffect(()=>{if(!r)return;let R=!1;return(async()=>{let D=await m(o);if(!D){const k={code:o,state:{},version:0,host_id:e||null},{data:N,error:x}=await Be.from("rooms").insert(k).select("id, code, host_id, state, version, updated_at").maybeSingle();if(x){console.warn("[NET] rooms/create:",x.message||x);return}if(R)return;N?D=N:D=await m(o)}R||(D&&(g.current=D.id,f.current=D.updated_at,u(D.state||{}),d(D.version??0)),i(!0))})(),()=>{R=!0}},[r,o,e]),E.useEffect(()=>{if(!r)return;const R=Be.channel(`rooms:${o}`).on("postgres_changes",{event:"*",schema:"public",table:"rooms",filter:`code=eq.${o}`},D=>{const k=D.new||D.old||{},N=typeof k.version=="number"?k.version:null,x=k.state||null,j=(x==null?void 0:x.stateId)??null;(N!=null&&N>b.current||N!=null&&N===b.current&&j&&j!==v.current)&&(N!=null&&d(N),x&&u(x),j&&h(String(j)),k.updated_at&&(f.current=k.updated_at),k.id&&(g.current=k.id),S.current=Date.now(),N===b.current&&j&&j!==v.current?console.warn("[NET]  applied remote (same version, different stateId)",{version:N,stateId:j}):console.log("[NET]  applied remote v=%d (realtime)",N))}).subscribe();return()=>{try{Be.removeChannel(R)}catch{}}},[r,o]),E.useEffect(()=>{if(!r)return;const R=setInterval(async()=>{var k;if(Date.now()-(S.current||0)<2e3)return;const D=await m(o);if(D){const N=((k=D.state)==null?void 0:k.stateId)??null;(D.version>b.current||D.version===b.current&&N&&N!==v.current)&&(d(D.version),u(D.state||{}),N&&h(String(N)),D.updated_at&&(f.current=D.updated_at),D.id&&(g.current=D.id))}},700);return()=>clearInterval(R)},[r,o]);const w=async R=>{var x,j,L;if(!r||!s)return;const D=3,k=new Date().toISOString();for(let U=1;U<=D;U++){let B=await m(o);if(!B){const Re={code:o,state:{},version:0,host_id:e||null},{data:pe,error:at}=await Be.from("rooms").insert(Re).select("id, code, host_id, state, version, updated_at").maybeSingle();if(at){if(console.warn(`[NET] commit - insert failed (attempt ${U}/${D}):`,at.message||at),U<D){await new Promise(Pt=>setTimeout(Pt,50*U));continue}return}if(pe)B=pe,g.current=B.id,f.current=B.updated_at;else if(B=await m(o),!B){if(console.warn(`[NET] commit - no row after insert (attempt ${U}/${D})`),U<D){await new Promise(Pt=>setTimeout(Pt,50*U));continue}return}}B.id&&(g.current=B.id);let q=B.state||{},Ue=typeof R=="function"?R(q)||{}:R||{};const wt=g.current||B.id;if(!wt){if(console.warn("[NET] commit - no target ID available"),U<D){await new Promise(Re=>setTimeout(Re,50*U));continue}return}const{data:Z,error:F}=await Be.from("rooms").update({state:Ue,version:(B.version||0)+1,updated_at:k}).eq("id",wt).eq("version",B.version).select("state, version, updated_at").maybeSingle();if(!F&&Z){u(Z.state||{}),d(Z.version??(B.version||0)+1),Z.updated_at&&(f.current=Z.updated_at),U>1&&console.log(`[NET] commit succeeded on attempt ${U}/${D}`);return}if(((F==null?void 0:F.code)==="PGRST116"||(F==null?void 0:F.status)===406||((x=F==null?void 0:F.message)==null?void 0:x.includes("0 rows"))||((j=F==null?void 0:F.message)==null?void 0:j.includes("Cannot coerce"))||(F==null?void 0:F.code)==="23505"||(F==null?void 0:F.message)&&F.message.includes("version")||!Z)&&U<D){console.warn(`[NET] commit conflict (attempt ${U}/${D}):`,(F==null?void 0:F.message)||F||"no rows updated","- retrying with merge monotnico...");const Re=await m(o);if(Re){B=Re,g.current=Re.id,f.current=Re.updated_at,q=Re.state||{};const pe=typeof R=="function"?R(q)||{}:R||{},at=((L=Re.state)==null?void 0:L.stateVersion)??0,Pt=(pe==null?void 0:pe.stateVersion)??0,_n=Math.max(at,Pt)+1;Ue={...q,...pe,stateVersion:_n}}await new Promise(pe=>setTimeout(pe,50*U));continue}console.warn(`[NET] commit conflict (attempt ${U}/${D}):`,(F==null?void 0:F.message)||F||"no rows updated")}const N=await m(o);N?(u(N.state||{}),d(N.version??0),N.updated_at&&(f.current=N.updated_at),N.id&&(g.current=N.id),console.warn("[NET] commit failed after retries, resynced to latest state")):console.warn("[NET] commit fallback resync failed: no row found")},_=E.useMemo(()=>({enabled:r,ready:s,state:l,version:c,stateId:p,commit:w}),[r,s,l,c,p]);return a.jsx(Lm.Provider,{value:_,children:n})}const Uo=5,Kl=t=>{const e=Number(t);return Number.isFinite(e)?Math.min(Uo,Math.max(1,e)):1};function Pb(){var Ne,we,Ut,kn;const[t,e]=E.useState("start"),[n,r]=E.useState(null),o=E.useMemo(()=>hs(),[]),s=E.useMemo(()=>_o(""),[]),[i,l]=E.useState(o);E.useMemo(()=>Object.freeze({mixProdutos:"D",erpLevel:"D",clients:1,vendedoresComuns:1}),[]);const u=(O={})=>({...O,mixProdutos:O.mixProdutos??"D",erpLevel:O.erpLevel??"D",clients:O.clients??1,vendedoresComuns:O.vendedoresComuns??1}),c=O=>{if(!Array.isArray(O)||O.length===0)return O;const A=[...O].filter(Boolean),$=A.every(P=>Number.isInteger(P.joinOrder)),Q=A.every(P=>Number.isInteger(P.seat));let C=$?A.sort((P,H)=>P.joinOrder-H.joinOrder||String((P==null?void 0:P.id)??"").localeCompare(String((H==null?void 0:H.id)??""))):Q?A.sort((P,H)=>P.seat-H.seat||String((P==null?void 0:P.id)??"").localeCompare(String((H==null?void 0:H.id)??""))):A.sort((P,H)=>String((P==null?void 0:P.id)??(P==null?void 0:P.player_id)??"").localeCompare(String((H==null?void 0:H.id)??(H==null?void 0:H.player_id)??""))),I=0;const J=new Set(C.filter(P=>Number.isInteger(P.seat)).map(P=>P.seat));return C=C.map(P=>{if(Number.isInteger(P.seat))return P;for(;J.has(I);)I++;return J.add(I),{...P,seat:I++}}),C=C.map(P=>Number.isInteger(P.joinOrder)?P:Number.isInteger(P.seat)?{...P,joinOrder:P.seat}:{...P,joinOrder:0}),C=C.sort((P,H)=>P.joinOrder-H.joinOrder||String((P==null?void 0:P.id)??"").localeCompare(String((H==null?void 0:H.id)??""))),console.log("[App] normalizePlayers - ordenados:",C.map(P=>({id:P.id,name:P.name,seat:P.seat}))),C},[d,p]=E.useState([u({id:o,name:s||"Jogador",cash:18e3,pos:0,color:"#ffd54f",bens:4e3})]),h=ue.useCallback((O,A={})=>{p($=>{var C;const Q=typeof O=="function"?O($):O;yb($,Q,null);try{const I=(A==null?void 0:A.source)||"UNKNOWN",J=new Map(($||[]).map(P=>[String(P==null?void 0:P.id),P]));for(const P of Q||[]){const H=String(P==null?void 0:P.id),gt=(C=J.get(H))==null?void 0:C.pos,Ve=P==null?void 0:P.pos;Ve!==void 0&&gt!==void 0&&Number(gt)!==Number(Ve)&&console.log("[POS_CHANGE]",{playerId:H,from:gt,to:Ve,source:I})}}catch{}return Q})},[]);E.useEffect(()=>{let O=!1;try{O=!1}catch{}try{new URL(window.location.href).searchParams.get("cashAudit")==="1"&&(O=!0)}catch{}Tm({enabled:O})},[]);const[y,b]=E.useState(1),[v,S]=E.useState(0),[g,f]=E.useState(null),[m,w]=E.useState(new Array(1).fill(!1)),[_,R]=E.useState(!1),[D,k]=E.useState(null),[N,x]=E.useState({id:o,name:((Ne=d[0])==null?void 0:Ne.name)||"Jogador",color:((we=d[0])==null?void 0:we.color)||"#6c5ce7",cash:((Ut=d[0])==null?void 0:Ut.cash)??18e3,possibAt:0,clientsAt:0,matchId:"local"}),[j,L]=E.useState(["Bem-vindo ao Sales Game!"]),U=O=>L(A=>[O,...A].slice(0,12)),[B,q]=E.useState(!1),[Ue,wt]=E.useState(null),Z=E.useRef(null),F=E.useRef(!1),ge=E.useRef(null),Re=E.useRef(0);E.useEffect(()=>{B&&(Ue||(g?(console.warn("[LOCK_INVARIANT] turnLock=true com lockOwner=null -> corrigindo owner para turnPlayerId",{turnPlayerId:g}),wt(String(g))):(console.warn("[LOCK_INVARIANT] turnLock=true sem turnPlayerId -> desligando turnLock"),q(!1))))},[B,Ue,g]);const pe=ue.useCallback(O=>!!O&&String(O.id)===String(i),[i]),at=E.useMemo(()=>{var O;return((O=d.find(pe))==null?void 0:O.cash)??0},[d,pe]);E.useEffect(()=>{var O;try{const A=new URL(window.location.href),$=A.searchParams.get("room"),Q=localStorage.getItem("sg:lastRoomName"),C=$||Q;if(Q&&!$&&localStorage.removeItem("sg:lastRoomName"),C&&$){r(C),(O=window.__setRoomCode)==null||O.call(window,C);try{A.searchParams.set("room",String(C)),history.replaceState(null,"",A.toString())}catch{}}}catch{}},[]);const Pt=E.useMemo(()=>`sg-sync:${n||"local"}`,[n]);E.useEffect(()=>{var O,A;try{(A=(O=Z.current)==null?void 0:O.close)==null||A.call(O);const $=new BroadcastChannel(Pt);return $.onmessage=Q=>{var I,J,P,H,gt,Ve;const C=Q.data||{};if(String(C.source)!==String(o)){if(C.type==="START"){if(se!=null&&se.enabled&&(se!=null&&se.ready)){console.log("[INIT_GUARD] init skipped: net enabled/ready (BC START ignored)");return}if(F.current){console.log("[INIT_GUARD] init skipped: hydratedFromNet=true (BC START ignored)");return}const tt=Array.isArray(C.players)?C.players.map(u):[];if(!tt.length)return;const qt=c(tt);try{const le=window.__MY_UID||window.__myUid||window.__playerId||null;le&&l(String(le))}catch{}h(qt,{source:"BC_START"}),S(0);const nt=(I=qt[0])!=null&&I.id?String(qt[0].id):null;f(nt),b(1),w(new Array(Math.max(1,qt.length)).fill(!1)),R(!1),k(null),e("game"),L(["Jogo iniciado!"]);return}if(C.type==="TURNLOCK"){q(!!C.value),C.value?C.owner&&wt(String(C.owner)):wt(null);return}if(C.type==="SYNC"&&t==="game"){if(se!=null&&se.enabled&&(se!=null&&se.ready)&&re){console.log("[App] SYNC ignorado - netState ativo, usando Supabase como autoridade nica");return}const tt=Number(C.version||0),qt=Number(C.timestamp||0),nt=fe.current;if(console.log("[App] SYNC recebido - verso remota:",tt,"verso local:",nt,"turnIdx:",C.turnIdx,"round:",C.round,"source:",C.source),console.log("[App] SYNC - meu turnIdx atual:",v,"meu myUid:",i),tt>0&&nt>0&&tt<nt){console.log("[App] SYNC -  REJEITANDO estado remoto - verso antiga:",tt,"< verso local:",nt);return}const le=Date.now(),ie=ot.current;if(tt>nt&&(fe.current=tt,console.log("[App] SYNC -  Aceitando verso remota:",tt,"> verso local:",nt)),C.turnIdx!==v&&(!(se!=null&&se.enabled)||!(se!=null&&se.ready)))if(C.turnPlayerId!==void 0&&C.turnPlayerId!==null){f(C.turnPlayerId);const ne=c(C.players||d).findIndex(Oe=>String(Oe.id)===String(C.turnPlayerId));ne>=0&&(S(ne),console.log("[App] SYNC (BC) - turnIdx derivado de turnPlayerId:",ne,"turnPlayerId:",C.turnPlayerId))}else C.turnIdx>=0&&C.turnIdx<(((J=C.players)==null?void 0:J.length)||d.length)&&(S(C.turnIdx),console.log("[App] SYNC (BC) - Sincronizando turnIdx",{local:v,remote:C.turnIdx}));if(Array.isArray(C.roundFlags)&&C.roundFlags.length>0&&w(z=>{const ne=C.roundFlags.map((Oe,Ge)=>z[Ge]||!1||Oe);for(;ne.length<z.length;)ne.push(z[ne.length]||!1);return console.log("[App] SYNC - roundFlags sincronizado:",ne.map((Oe,Ge)=>{var he;return`${(he=d[Ge])==null?void 0:he.name}:${Oe}`}).join(", ")),ne}),C.round!==y){const z=Kl(C.round);if(ie&&le-ie.timestamp<3e3){const ne=ie.round!==y;b(ne?Oe=>{const Ge=Math.min(Uo,Math.max(Oe,z));return Ge>Oe&&console.log("[App] SYNC round aplicado (clamp): local=",Oe,"remote=",z,"final=",Ge),Ge}:z)}else b(ne=>{const Oe=Math.min(Uo,Math.max(ne,z));return console.log("[App] SYNC round aplicado (clamp): local=",ne,"remote=",z,"final=",Oe),Oe})}(C.gameOver===!0||C.winner)&&b(Uo);const Se=d,st=C.players.map(z=>{const ne=Se.find(Ge=>Ge.id===z.id);if(!ne)return z;if(String(z.id)===String(i)){const Ge=Number(ne.clients||0),he=Number(z.clients||0),yt=Number(ne.vendedoresComuns||0),St=Number(z.vendedoresComuns||0),jt=Number(ne.fieldSales||0),En=Number(z.fieldSales||0),jn=Number(ne.insideSales||0),fn=Number(z.insideSales||0);return Ge>he||yt>St||jt>En||jn>fn||ne.mixProdutos&&ne.mixProdutos!==z.mixProdutos&&ne.mixProdutos!=="D"||ne.erpLevel&&ne.erpLevel!==z.erpLevel&&ne.erpLevel!=="D"?(console.log("[App] SYNC - Detectadas compras locais, preservando estado local completo",{localClients:Ge,remoteClients:he,localVendedores:yt,remoteVendedores:St}),{...ne,pos:z.pos,bankrupt:z.bankrupt??ne.bankrupt,az:ne.az||z.az||0,am:ne.am||z.am||0,rox:ne.rox||z.rox||0,trainingsByVendor:ne.trainingsByVendor||z.trainingsByVendor||{},onboarding:ne.onboarding||z.onboarding||!1}):{...z,cash:Number(z.cash||0),clients:he,mixProdutos:z.mixProdutos,erpLevel:z.erpLevel,vendedoresComuns:St,fieldSales:En,insideSales:fn,gestores:Number(z.gestores??z.gestoresComerciais??z.managers??0),gestoresComerciais:Number(z.gestoresComerciais??z.gestores??z.managers??0),managers:Number(z.managers??z.gestores??z.gestoresComerciais??0),bens:Number(z.bens||0),manutencao:z.manutencao,loanPending:z.loanPending,az:ne.az||z.az||0,am:ne.am||z.am||0,rox:ne.rox||z.rox||0,trainingsByVendor:ne.trainingsByVendor||z.trainingsByVendor||{},onboarding:ne.onboarding||z.onboarding||!1}}return{...z,az:ne.az||z.az||0,am:ne.am||z.am||0,rox:ne.rox||z.rox||0,trainingsByVendor:ne.trainingsByVendor||z.trainingsByVendor||{},onboarding:ne.onboarding||z.onboarding||!1}});h(st,{source:"BC_SYNC"}),console.log("[App] SYNC aplicado - novo turnIdx:",C.turnIdx),console.log("[App] SYNC - jogador da vez:",(P=st[C.turnIdx])==null?void 0:P.name,"id:",(H=st[C.turnIdx])==null?void 0:H.id),console.log("[App] SYNC -  minha vez?",String((gt=st[C.turnIdx])==null?void 0:gt.id)===String(i)),R(z=>z||!!C.gameOver),k(z=>(_||C.gameOver)&&z&&!C.winner?z:C.winner??z),C.gameOver===!0&&console.log(`[App] [ENDGAME] estado remoto aplicado: gameOver=true winner=${((Ve=C.winner)==null?void 0:Ve.name)??C.winner??"N/A"}`)}}},Z.current=$,()=>$.close()}catch($){console.warn("[App] BroadcastChannel init failed:",$)}},[Pt,o,t]),E.useEffect(()=>{const O=async()=>{if(console.log(`[App] handleLeaveRoom chamado - fase: ${t}, currentLobbyId: ${n}, myUid: ${i}`),(t==="lobbies"||t==="playersLobby"||t==="game")&&n&&i)try{console.log(`[App] Saindo da sala ${n} na fase ${t}`),await zl({roomCode:n,playerId:i})}catch(Q){console.warn("[App] Erro ao sair da sala:",Q)}else console.log("[App] No executando leaveRoom - condies no atendidas")},A=()=>{O()},$=()=>{O()};return window.addEventListener("beforeunload",A),window.addEventListener("pagehide",$),()=>{window.removeEventListener("beforeunload",A),window.removeEventListener("pagehide",$)}},[t,n,i]);const _n=(O,A=void 0)=>{var C,I;const $=!!O,Q=$?String(A??i??g??""):null;q($),$?Q&&wt(Q):wt(null);try{(I=(C=Z.current)==null?void 0:C.postMessage)==null||I.call(C,{type:"TURNLOCK",value:$,owner:Q,ts:Date.now(),source:o})}catch{}try{se!=null&&se.enabled&&(se!=null&&se.ready)&&typeof en=="function"&&Zr({playersDeltaById:{},statePatch:{kind:"LOCK",turnLock:$,lockOwner:Q,lockTs:Date.now()}})}catch{}},se=Ob(),en=se==null?void 0:se.commit,qe=se==null?void 0:se.version,re=se==null?void 0:se.state,Xr=se==null?void 0:se.stateId,Ro=E.useMemo(()=>{const O=String(i||o||"");return!O||!g?!1:String(g)===O},[g,i,o]);E.useEffect(()=>{var O,A;if(d!=null&&d.length){if(g){const $=d.findIndex(Q=>String(Q.id)===String(g));$>=0&&$!==v&&S($)}else if(!(se!=null&&se.enabled)||!(se!=null&&se.ready)){const $=((O=d[v])==null?void 0:O.id)||((A=d[0])==null?void 0:A.id);$&&f(String($))}}},[d,g,v]),ue.useRef(null);const ot=ue.useRef(null),mt=ue.useRef(0),fe=ue.useRef(0),Rt=ue.useRef(0),er=ue.useRef(null),Gt=ue.useRef(null),Zr=ue.useCallback(({playersDeltaById:O={},statePatch:A={}})=>{if(typeof en!="function")return;mt.current=mt.current+1;const $=mt.current,Q=Date.now();try{en(C=>{var ie;const I=C||{},J=$,P=I.stateVersion??0,H=Math.max(J,P)+1,gt=Array.isArray(I.players)&&I.players.length>0?I.players:Array.isArray((ie=ot.current)==null?void 0:ie.players)&&ot.current.players.length>0?ot.current.players:Array.isArray(Gt.current)&&Gt.current.length>0?Gt.current:[],Ve=c(gt),tt=new Map(Ve.map(Se=>[String(Se.id),Se]));for(const[Se,st]of Object.entries(O)){const z=String(Se),ne=tt.get(z);if(ne){const Oe=(st==null?void 0:st._actionId)||(A==null?void 0:A.actionId)||null;if(Oe){const Ge=ne.lastActions&&typeof ne.lastActions=="object"?ne.lastActions:{};if(Ge[Oe]){console.warn("[IDEMPOTENCY] ignorando delta j aplicado",{playerId:z,actionId:Oe});continue}const he={...Ge,[Oe]:Q},yt=Object.keys(he);yt.length>50&&yt.sort((jn,fn)=>Number(he[jn]||0)-Number(he[fn]||0)).slice(0,yt.length-50).forEach(jn=>{try{delete he[jn]}catch{}});const{_actionId:St,...jt}=st||{},En={...ne};for(const[jn,fn]of Object.entries(jt))fn!==void 0&&(En[jn]=fn);tt.set(z,u({...En,lastActions:he}))}else{const{_actionId:Ge,...he}=st||{},yt={...ne};for(const[St,jt]of Object.entries(he))jt!==void 0&&(yt[St]=jt);tt.set(z,u(yt))}}else{const{_actionId:Oe,...Ge}=st||{};tt.set(z,u({id:z,...Ge}))}}const qt=c(Array.from(tt.values())),nt={...A,stateVersion:H,updatedAt:Q,updatedBy:i};Object.keys(O).length>0&&(nt.players=qt);const le={...I,...nt};try{delete le.turnIdx}catch{}return le.players&&(le.players=c(le.players)),console.log("[NET]  commitGamePatch - tipo:",A.turnPlayerId?"TURN":A.round?"ROUND":"PLAYER_DELTA","playersDeltaIds:",Object.keys(O).join(","),"statePatchKeys:",Object.keys(A).join(","),"stateVersion:",H,"(local:",J,"remote:",P,")"),le})}catch(C){console.warn("[NET] commitGamePatch failed:",(C==null?void 0:C.message)||C)}},[en,i]);ue.useEffect(()=>{const O=ot.current,A=!O||O.turnIdx!==v,$=!O||O.round!==y,Q=!O||JSON.stringify(O.players)!==JSON.stringify(d);if(A||$||Q){const C=Date.now();(O?C-O.timestamp:1/0)>100?(ot.current={...O||{},players:d,turnIdx:v,round:y,timestamp:C,stateVersion:(O==null?void 0:O.stateVersion)??mt.current??0},A&&console.log("[App] lastLocalStateRef atualizado via useEffect - turnIdx mudou:",O==null?void 0:O.turnIdx,"->",v)):ot.current={...ot.current,players:d,turnIdx:v,round:y}}},[d,v,y]),E.useEffect(()=>{var Q,C;if(!(se!=null&&se.enabled)||!(se!=null&&se.ready)||!re)return;if(typeof qe=="number"){const I=mt.current??((Q=ot.current)==null?void 0:Q.stateVersion)??0,J=(re==null?void 0:re.stateVersion)??0,P=String((re==null?void 0:re.stateId)??(re==null?void 0:re.actionId)??Xr??""),H=String(er.current??"");if(qe<Rt.current){console.log("[NET]  IGNORADO - netVersion regressivo:",{netVersion:qe,lastApplied:Rt.current});return}if(qe===Rt.current)if(P&&P!==H)console.warn("[NET] same version but different stateId -> applying",{netVersion:qe,incomingStateId:P,lastStateId:H});else{console.log("[NET]  IGNORADO - same version and same stateId:",{netVersion:qe,stateId:P||"(empty)"});return}if(J>0&&I>0&&J<I){console.warn("[NET]  IGNORANDO rollback de stateVersion:",{remoteStateVersion:J,localStateVersion:I,netVersion:qe}),Rt.current=qe;return}Rt.current=qe,P&&(er.current=P)}else return;const O=Array.isArray(re.players)?re.players:null,A=Number.isInteger(re.round)?re.round:null,$=re.turnPlayerId!==void 0&&re.turnPlayerId!==null&&String(re.turnPlayerId)!==""?String(re.turnPlayerId):null;if($&&String(g||"")!==$&&f($),O){const I=c(O);if(h(I,{source:"SNAPSHOT"}),Gt.current=JSON.parse(JSON.stringify(I)),console.log("[NET]  Aplicado players (snapshot autoritativo) - netVersion:",qe,"playersOrdered:",I.map(J=>({id:J.id,seat:J.seat}))),$){const J=I.findIndex(P=>String(P.id)===String($));J>=0&&J!==v&&(console.log("[NET]  derived turnIdx from turnPlayerId:",J,"turnPlayerId:",$),S(J))}}if(A!==null){const I=A===1&&Array.isArray(O)&&O.length>0&&O.every(P=>Number((P==null?void 0:P.pos)??0)===0)&&(re.gameOver===!1||re.gameOver==null),J=Kl(A);b(P=>I?1:Math.min(Uo,Math.max(P,J)))}if((re.gameOver===!0||re.winner)&&b(Uo),re.roundFlags!==void 0){if(Array.isArray(re.roundFlags))w(re.roundFlags),console.log("[NET] applied remote includes roundFlags?",!0,"length:",re.roundFlags.length);else if(typeof re.roundFlags=="object"){const I=Object.values(re.roundFlags);w(I),console.log("[NET] applied remote includes roundFlags?",!0,"converted from object, length:",I.length)}}typeof re.turnLock<"u"&&q(!!re.turnLock),typeof re.lockOwner<"u"&&wt(re.lockOwner?String(re.lockOwner):null),re.turnLock===!0&&!re.lockOwner&&$&&wt($),Re.current=Date.now(),R(I=>I||!!re.gameOver),k(I=>(!!re.gameOver||!!re.winner)&&I&&!re.winner?I:re.winner??I),re.gameOver===!0&&console.log(`[App] [ENDGAME] estado remoto aplicado: gameOver=true winner=${((C=re.winner)==null?void 0:C.name)??re.winner??"N/A"}`),console.log("[NET]  applied remote snapshot - netVersion:",qe,"turnPlayerId:",re.turnPlayerId,"round:",A);try{const I=Array.isArray(re.players)&&re.players.length>0,J=re.turnPlayerId!==void 0&&re.turnPlayerId!==null&&String(re.turnPlayerId)!=="";I&&J&&(F.current=!0)}catch{}},[qe,re,se==null?void 0:se.enabled,se==null?void 0:se.ready]),E.useEffect(()=>{if(!B){ge.current=null;return}ge.current||(ge.current=Date.now());const O=setInterval(()=>{const A=Date.now(),$=ge.current?A-ge.current:0,Q=d[v],C=Q&&String(Q.id)===String(i),I=Ro&&C,J=Ue===i;$>8e3&&I&&!J&&Ue!=null&&(console.warn("[LOCK-WATCHDOG] stole lock - turnLock travado por",$,"ms, liberando...",{isMyTurn:I,lockOwner:Ue,myUid:i}),eo({turnLock:!1,lockOwner:i}),_n(!1),wt(i),ge.current=null)},1e3);return()=>clearInterval(O)},[B,Ro,v,d,Ue,i,en]);async function eo(O){if(typeof en=="function")try{await en(A=>{const $=A||{},Q=O||{};if(Q.players&&Array.isArray(Q.players)){const H=Gt.current||$.players||[],gt=$.players||[],Ve=Q.players,tt=new Map(H.map(he=>[String(he==null?void 0:he.id),he])),qt=new Map(gt.map(he=>[String(he==null?void 0:he.id),he])),nt=new Map(Ve.map(he=>[String(he==null?void 0:he.id),he])),le=[],ie=new Set([...tt.keys(),...qt.keys(),...nt.keys()]);for(const he of ie){const yt=tt.get(he),St=qt.get(he),jt=nt.get(he);yt&&jt&&JSON.stringify(yt)!==JSON.stringify(jt)&&jt?le.push(u(jt)):St?le.push(u(St)):jt&&le.push(u(jt))}const Se=[],st=Ve.map(he=>String(he==null?void 0:he.id));for(const he of st){const yt=le.find(St=>String(St==null?void 0:St.id)===he);yt&&Se.push(yt)}for(const he of le)st.includes(String(he==null?void 0:he.id))||Se.push(he);Gt.current=null;const z=Q.stateVersion??0,ne=$.stateVersion??0,Oe=Math.max(z,ne)+1,Ge={...$,...Q,players:Se.length>0?Se:Ve,stateVersion:Oe};try{delete Ge.turnIdx}catch{}return Ge}const C=Q.stateVersion??0,I=$.stateVersion??0,J=Math.max(C,I)+1,P={...$,...Q,stateVersion:J};try{delete P.turnIdx}catch{}return P})}catch(A){console.warn("[NET] commit failed:",(A==null?void 0:A.message)||A),Gt.current=null}}function et(O,A,$,Q=_,C=D,I={}){var Do,Ao,tr,to,Cn,Ln;Gt.current||(Gt.current=JSON.parse(JSON.stringify(d)),console.log("[App] broadcastState - baseline capturado (estado atual antes da mudana):",Gt.current.length,"players")),mt.current=mt.current+1;const J=mt.current,P=I.roundFlags!==void 0?I.roundFlags:m,H=I.turnLock!==void 0?I.turnLock:B,gt=((Do=ot.current)==null?void 0:Do.lockOwner)??null,Ve=I.lockOwner!==void 0?I.lockOwner:gt,tt=I.gameOver!==void 0?I.gameOver:Q,nt=!!_||!!((Ao=ot.current)!=null&&Ao.gameOver)?!0:!!tt,le=I.winner!==void 0?I.winner:C,ie=D??((tr=ot.current)==null?void 0:tr.winner)??null,Se=nt?le??ie:le,st=I.round!==void 0?I.round:$,z=Kl(Math.max(Number(st||1),Number(y||1),Number(((to=ot.current)==null?void 0:to.round)||1)));Gt.current||(Gt.current=JSON.parse(JSON.stringify(d)),console.log("[App] broadcastState - baseline capturado (fallback):",Gt.current.length,"players"));const ne=c(O),Oe=I.turnPlayerId!==void 0&&I.turnPlayerId!==null?String(I.turnPlayerId):String(g||"");if(Oe!=null){const Fe=String(Oe);String(g||"")!==Fe&&f(Fe)}const Ge=!Oe||Oe===g?g:(I.turnPlayerId!==void 0||z!==y,Oe),he=I.kind||(I.turnPlayerId!==void 0?"TURN":"PLAYER_DELTA"),yt=()=>{try{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID()}catch{}return`${String(i||"anon")}-${Date.now()}-${Math.random().toString(16).slice(2)}`},St=String(I.stateId||yt()),jt=String(I.actionId||`${String(i||"anon")}-${Date.now()}-${J}`),En=Date.now(),jn=Oe?ne.findIndex(Fe=>String(Fe.id)===String(Oe)):A;if(ot.current={players:ne,turnIdx:jn,turnPlayerId:Ge,round:z,gameOver:nt,winner:Se,lockOwner:Ve,timestamp:En,version:J,stateVersion:J,updatedAt:En,updatedBy:i},fe.current=J,I.isStartGame===!0||z===1&&A===0&&ne.every(Fe=>Number((Fe==null?void 0:Fe.pos)??0)===0))console.log("[App] broadcastState (START) - verso:",J,"turnPlayerId:",Ge,"round:",z),eo({players:ne,turnPlayerId:Ge,round:z,roundFlags:P,stateId:St,actionId:jt,kind:"START",stateVersion:J,updatedAt:En,updatedBy:i});else{const Fe={},In=new Map(d.map(W=>[String(W.id),W]));for(const W of ne){const xe=String(W.id),ye=In.get(xe);if(!ye)Fe[xe]={...W,_actionId:jt};else{const X={},ee=["pos","cash","bankrupt","clients","vendedoresComuns","fieldSales","insideSales","gestores","gestoresComerciais","manutencao","bens","mixProdutos","erpLevel","az","am","rox","onboarding","trainingByVendor","trainingsByVendor","loanPending","waitingAtRevenue","revenue","erpOwned","erp","mixOwned","mix","lastRevenueRound","directBuys","directBuysPush","trainings","mixBase"];for(const me of ee)JSON.stringify(ye[me])!==JSON.stringify(W[me])&&(X[me]=W[me]);Object.keys(X).length>0&&(Fe[xe]={...X,_actionId:jt})}}const T=Object.keys(Fe).length>0,K=he==="TURN"||he==="LOCK"||I.round!==void 0||I.roundFlags!==void 0||I.gameOver!==void 0||I.winner!==void 0;if(!T&&!K){console.log("[App] broadcastState skipped (no-op)",{actionId:jt,patchKind:he});return}const te={kind:he,actionId:jt,stateId:St,...nt?{gameOver:!0,winner:Se}:{},...he==="TURN"?{turnPlayerId:Oe,round:z,roundFlags:P,gameOver:nt,winner:Se}:{},...he==="LOCK"?{turnLock:H,lockOwner:Ve,lockTs:Date.now()}:{}};Zr({playersDeltaById:Fe,statePatch:te}),console.log("[App] broadcastState (PATCH) - kind:",he,"playersDeltaIds:",Object.keys(Fe).join(","),"turnPlayerId:",Ge,"round:",z)}try{(Ln=(Cn=Z.current)==null?void 0:Cn.postMessage)==null||Ln.call(Cn,{type:"SYNC",version:J,players:ne,round:z,roundFlags:P,turnLock:H,lockOwner:Ve,gameOver:nt,winner:Se,source:o,timestamp:En})}catch(Fe){console.warn("[App] broadcastState failed:",Fe)}}function No(O){var C,I,J;let A=c(O);const $=A.findIndex(P=>String(P==null?void 0:P.id)===String(i));$>0&&(A=[A[$],...A.slice(0,$),...A.slice($+1)]);const Q=(C=A[0])!=null&&C.id?String(A[0].id):null;et(A,0,1,!1,null,{turnPlayerId:Q,roundFlags:Array(A.length).fill(!1),isStartGame:!0});try{(J=(I=Z.current)==null?void 0:I.postMessage)==null||J.call(I,{type:"START",players:A,source:o})}catch(P){console.warn("[App] broadcastStart failed:",P)}}const Nt=d[v];E.useEffect(()=>{t==="game"&&hb(d,v,y,_,D,"Game State Update")},[d,v,y,_,D,t]),E.useEffect(()=>{const O=d.find(pe);if(!O)return;const{cap:A,inAtt:$}=La(O);x(Q=>({...Q,cash:O.cash,possibAt:A,clientsAt:$,name:O.name,color:O.color}))},[d,pe]);const Si=E.useMemo(()=>{const O=d.find(pe)||d[0]||{},A=ol(O),$=sl(O),{cap:Q,inAtt:C}=La(O),I=String(O.erpLevel||"D").toUpperCase(),J=Number(O.gestores??O.gestoresComerciais??O.managers??0);return console.log("[App] Totals recalculado - me:",O.name,"clients:",O.clients,"faturamento:",A,"manutencao:",$,"vendedoresComuns:",O.vendedoresComuns,"fieldSales:",O.fieldSales,"insideSales:",O.insideSales),pb(O,"HUD Totals"),{faturamento:A,manutencao:$,emprestimos:O.loanPending&&!O.loanPending.charged?Number(O.loanPending.amount||0):0,vendedoresComuns:O.vendedoresComuns||0,fieldSales:O.fieldSales||0,insideSales:O.insideSales||0,mixProdutos:O.mixProdutos||"D",bens:O.bens??0,erpSistemas:I,clientes:O.clients||0,onboarding:!!O.onboarding,az:O.az||0,am:O.am||0,rox:O.rox||0,gestores:J,gestoresComerciais:J,possibAt:Q,clientsAt:C}},[d,pe]),[bs,il]=E.useState(!1),{onAction:Lt,modalLocks:Y}=Ab({players:d,setPlayers:h,round:y,setRound:b,turnIdx:v,setTurnIdx:S,turnPlayerId:g,setTurnPlayerId:f,roundFlags:m,setRoundFlags:w,isMyTurn:Ro,isMine:pe,myUid:i,meId:o,myCash:at,current:Nt,broadcastState:et,appendLog:U,turnLock:B,setTurnLockBroadcast:_n,gameOver:_,setGameOver:R,winner:D,setWinner:k,setShowBankruptOverlay:il});if(t==="start")return a.jsx(Tx,{onEnter:O=>{const A=_o(O||"Jogador");h([u({id:o,name:A,cash:18e3,pos:0,color:"#ffd54f",bens:4e3})],{source:"START"}),b(1),S(0),R(!1),k(null),w(new Array(1).fill(!1)),e("lobbies"),x($=>({...$,name:A})),L([`Bem-vindo, ${A}!`])}});if(t==="lobbies")return a.jsx(Vx,{onEnterRoom:O=>{var A;r(O),(A=window.__setRoomCode)==null||A.call(window,O);try{localStorage.setItem("sg:lastRoomName",String(O));const $=new URL(window.location.href);$.searchParams.set("room",String(O)),history.replaceState(null,"",$.toString())}catch{}e("playersLobby")}});if(t==="playersLobby")return a.jsx(Gx,{lobbyId:n,onBack:()=>{var O;(O=window.__setRoomCode)==null||O.call(window,null),e("lobbies")},onStartGame:O=>{var J;const A=(O==null?void 0:O.lobbyName)||((J=O==null?void 0:O.lobby)==null?void 0:J.name)||(O==null?void 0:O.name)||n||"sala-demo";try{localStorage.setItem("sg:lastRoomName",String(A));const P=new URL(window.location.href);if(P.searchParams.set("room",String(A)),history.replaceState(null,"",P.toString()),!sessionStorage.getItem("sg:room-reloaded")){sessionStorage.setItem("sg:room-reloaded","1"),location.reload();return}}catch{}const C=[...Array.isArray(O)?O:(O==null?void 0:O.players)??(O==null?void 0:O.lobbyPlayers)??[]].sort((P,H)=>{const gt=P.created_at||P.joined_at||P.createdAt||P.joinedAt,Ve=H.created_at||H.joined_at||H.createdAt||H.joinedAt;if(gt&&Ve)return new Date(gt)-new Date(Ve);const tt=String(P.id??P.player_id??""),qt=String(H.id??H.player_id??"");return tt.localeCompare(qt)}).map((P,H)=>u({id:String(P.id??P.player_id),name:P.name??P.player_name,cash:18e3,pos:0,bens:4e3,color:["#ffd54f","#90caf9","#a5d6a7","#ffab91"][H%4],seat:H}));if(C.length===0)return;const I=c(C);try{I.find(H=>String(H.id)===String(o))&&l(String(o))}catch{}h(I,{source:"START_GAME"}),S(0),b(1),w(new Array(I.length).fill(!1)),R(!1),k(null),x(P=>{var gt,Ve;const H=I.find(pe);return{...P,name:(H==null?void 0:H.name)||((gt=I[0])==null?void 0:gt.name)||"Jogador",color:(H==null?void 0:H.color)||((Ve=I[0])==null?void 0:Ve.color)||"#6c5ce7",cash:(H==null?void 0:H.cash)??18e3,possibAt:0,clientsAt:0}}),L(["Jogo iniciado!"]),No(I),e("game")}});const ve=d[v],Ee=(ve==null?void 0:ve.bankrupt)===!0;ve&&(String(ve.id),String(i));const V=y===5&&((kn=d[v])==null?void 0:kn.waitingAtRevenue),He=g!=null&&i!=null&&String(g)===String(i),oe=!!g&&d.length>0&&He&&B===!1&&Number(Y||0)===0&&_!==!0&&Ee!==!0&&V!==!0;return E.useEffect(()=>{console.log("[CAN_ROLL_CHECK]",{myUid:i,turnPlayerId:g,isMyTurn:He,turnLock:B,modalLocks:Y,gameOver:_,bankrupt:Ee,result:oe})},[i,g,He,B,Y,_,Ee,oe]),a.jsxs("div",{className:"page",children:[a.jsxs("header",{className:"topbar",children:[a.jsxs("div",{className:"status",style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[a.jsx("span",{style:{width:18,height:18,borderRadius:"50%",border:"2px solid rgba(255,255,255,.9)",boxShadow:"0 0 0 2px rgba(0,0,0,.25)",background:N.color}}),a.jsxs("span",{style:{background:"#1f2430",border:"1px solid rgba(255,255,255,.12)",borderRadius:10,padding:"4px 10px",fontWeight:800},children:[" ",N.name]}),a.jsxs("span",{children:["Possib. Atendimento: ",a.jsx("b",{children:N.possibAt??0})]}),a.jsxs("span",{children:["Clientes em Atendimento: ",a.jsx("b",{children:N.clientsAt??0})]}),a.jsx(bb,{players:d,turnIdx:v,round:y,gameOver:_,winner:D})]}),a.jsxs("div",{className:"status",style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[a.jsxs("span",{children:["Rodada: ",y]}),a.jsxs("span",{className:"money",children:[" $ ",Number(at).toLocaleString()]})]})]}),a.jsxs("main",{className:"content",children:[a.jsx("div",{className:"boardWrap",children:a.jsx(Zx,{players:d,turnIdx:v,onMeHud:x})}),a.jsxs("aside",{className:"side",children:[a.jsx(eb,{totals:Si,players:d}),a.jsxs("div",{className:"controlsSticky",children:[a.jsx(tb,{onAction:O=>{Lt(O)},current:Nt,isMyTurn:Ro,myUid:i,turnPlayerId:g,turnLock:B,lockOwner:Ue,modalLocks:Y,gameOver:_}),a.jsx("div",{style:{marginTop:10},children:a.jsx("button",{className:"btn dark",onClick:async()=>{var O;if(n&&i)try{await zl({roomCode:n,playerId:i})}catch(A){console.warn("[App] Erro ao sair da sala:",A)}(O=window.__setRoomCode)==null||O.call(window,null),e("lobbies")},children:"Sair para Lobbies"})})]}),_&&a.jsx(nb,{players:d,onExit:async()=>{var O;if(n&&i)try{await zl({roomCode:n,playerId:i})}catch(A){console.warn("[App] Erro ao sair da sala:",A)}(O=window.__setRoomCode)==null||O.call(window,null),e("lobbies")},onRestart:()=>{const O=d.map(A=>u({...A,cash:18e3,bens:4e3,pos:0}));h(O,{source:"RESTART"}),S(0),b(1),w(new Array(O.length).fill(!1)),L(["Novo jogo iniciado!"]),R(!1),k(null)}})]})]}),a.jsx("footer",{className:"foot",children:a.jsxs("small",{children:["Desenvolvido por ",a.jsx("a",{href:"https://www.tironitech.com",target:"_blank",rel:"noreferrer",children:"tironitech.com"})]})}),bs&&a.jsx(ob,{})]})}function Lb(){const e=new URLSearchParams(window.location.search).get("room");return e&&String(e).trim()||null}function Ib(){const[t,e]=ue.useState(Lb());return ue.useEffect(()=>(window.__setRoomCode=n=>{const r=String(n||"").trim()||null;e(r);const o=new URL(window.location.href);r?o.searchParams.set("room",r):o.searchParams.delete("room"),window.history.replaceState({},"",o)},()=>{delete window.__setRoomCode}),[]),ue.useEffect(()=>(window.exportLogs=()=>{const n=Om(),r=new Blob([n.text],{type:"text/plain;charset=utf-8"}),o=URL.createObjectURL(r),s=document.createElement("a");return s.href=o,s.download=`debug-logs-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.txt`,s.click(),URL.revokeObjectURL(o),console.log(" Logs exportados! Arquivo .txt baixado."),n},window.getLogsText=()=>cb(),window.getLogsJSON=()=>db(),window.getLogStats=()=>nc(),window.toggleLogCapture=()=>(ur.enabled?(ur.disable(),console.log(" Captura de logs DESATIVADA")):(ur.enable(),console.log(" Captura de logs ATIVADA")),ur.enabled),console.log("%c FUNES DE EXPORT DE LOGS DISPONVEIS:","color: #4CAF50; font-weight: bold; font-size: 14px"),console.log("%cexportLogs()","color: #2196F3; font-weight: bold","- Exporta logs completos (baixa arquivo .txt)"),console.log("%cgetLogsText()","color: #2196F3; font-weight: bold","- Retorna logs como string de texto"),console.log("%cgetLogsJSON()","color: #2196F3; font-weight: bold","- Retorna logs como objeto JSON"),console.log("%cgetLogStats()","color: #2196F3; font-weight: bold","- Retorna estatsticas dos logs"),console.log("%ctoggleLogCapture()","color: #2196F3; font-weight: bold","- Ativa/desativa captura de logs"),()=>{delete window.exportLogs,delete window.getLogsText,delete window.getLogsJSON,delete window.getLogStats,delete window.toggleLogCapture}),[]),a.jsx(rb,{children:a.jsx(Tb,{roomCode:t,children:a.jsx(Pb,{})})})}Jl.createRoot(document.getElementById("root")).render(a.jsx(ue.StrictMode,{children:a.jsx(Ib,{})}));
//# sourceMappingURL=index-C4kSrp_G.js.map
