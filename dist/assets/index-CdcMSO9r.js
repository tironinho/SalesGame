(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();var $n=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function hm(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function pm(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var o=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,o.get?o:{enumerable:!0,get:function(){return t[r]}})}),n}var kf={exports:{}},ya={},Ef={exports:{}},Ie={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qs=Symbol.for("react.element"),mm=Symbol.for("react.portal"),gm=Symbol.for("react.fragment"),ym=Symbol.for("react.strict_mode"),vm=Symbol.for("react.profiler"),xm=Symbol.for("react.provider"),bm=Symbol.for("react.context"),wm=Symbol.for("react.forward_ref"),Sm=Symbol.for("react.suspense"),_m=Symbol.for("react.memo"),km=Symbol.for("react.lazy"),Lc=Symbol.iterator;function Em(t){return t===null||typeof t!="object"?null:(t=Lc&&t[Lc]||t["@@iterator"],typeof t=="function"?t:null)}var jf={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Cf=Object.assign,Rf={};function Qo(t,e,n){this.props=t,this.context=e,this.refs=Rf,this.updater=n||jf}Qo.prototype.isReactComponent={};Qo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Qo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Nf(){}Nf.prototype=Qo.prototype;function $u(t,e,n){this.props=t,this.context=e,this.refs=Rf,this.updater=n||jf}var Iu=$u.prototype=new Nf;Iu.constructor=$u;Cf(Iu,Qo.prototype);Iu.isPureReactComponent=!0;var $c=Array.isArray,Df=Object.prototype.hasOwnProperty,Mu={current:null},Af={key:!0,ref:!0,__self:!0,__source:!0};function Of(t,e,n){var r,o={},s=null,i=null;if(e!=null)for(r in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(s=""+e.key),e)Df.call(e,r)&&!Af.hasOwnProperty(r)&&(o[r]=e[r]);var l=arguments.length-2;if(l===1)o.children=n;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];o.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)o[r]===void 0&&(o[r]=l[r]);return{$$typeof:Qs,type:t,key:s,ref:i,props:o,_owner:Mu.current}}function jm(t,e){return{$$typeof:Qs,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Bu(t){return typeof t=="object"&&t!==null&&t.$$typeof===Qs}function Cm(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Ic=/\/+/g;function za(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Cm(""+t.key):e.toString(36)}function Oi(t,e,n,r,o){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case Qs:case mm:i=!0}}if(i)return i=t,o=o(i),t=r===""?"."+za(i,0):r,$c(o)?(n="",t!=null&&(n=t.replace(Ic,"$&/")+"/"),Oi(o,e,n,"",function(c){return c})):o!=null&&(Bu(o)&&(o=jm(o,n+(!o.key||i&&i.key===o.key?"":(""+o.key).replace(Ic,"$&/")+"/")+t)),e.push(o)),1;if(i=0,r=r===""?".":r+":",$c(t))for(var l=0;l<t.length;l++){s=t[l];var u=r+za(s,l);i+=Oi(s,e,n,u,o)}else if(u=Em(t),typeof u=="function")for(t=u.call(t),l=0;!(s=t.next()).done;)s=s.value,u=r+za(s,l++),i+=Oi(s,e,n,u,o);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function ii(t,e,n){if(t==null)return t;var r=[],o=0;return Oi(t,r,"","",function(s){return e.call(n,s,o++)}),r}function Rm(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var rn={current:null},Ti={transition:null},Nm={ReactCurrentDispatcher:rn,ReactCurrentBatchConfig:Ti,ReactCurrentOwner:Mu};function Tf(){throw Error("act(...) is not supported in production builds of React.")}Ie.Children={map:ii,forEach:function(t,e,n){ii(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return ii(t,function(){e++}),e},toArray:function(t){return ii(t,function(e){return e})||[]},only:function(t){if(!Bu(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ie.Component=Qo;Ie.Fragment=gm;Ie.Profiler=vm;Ie.PureComponent=$u;Ie.StrictMode=ym;Ie.Suspense=Sm;Ie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Nm;Ie.act=Tf;Ie.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Cf({},t.props),o=t.key,s=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,i=Mu.current),e.key!==void 0&&(o=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)Df.call(e,u)&&!Af.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];r.children=l}return{$$typeof:Qs,type:t.type,key:o,ref:s,props:r,_owner:i}};Ie.createContext=function(t){return t={$$typeof:bm,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:xm,_context:t},t.Consumer=t};Ie.createElement=Of;Ie.createFactory=function(t){var e=Of.bind(null,t);return e.type=t,e};Ie.createRef=function(){return{current:null}};Ie.forwardRef=function(t){return{$$typeof:wm,render:t}};Ie.isValidElement=Bu;Ie.lazy=function(t){return{$$typeof:km,_payload:{_status:-1,_result:t},_init:Rm}};Ie.memo=function(t,e){return{$$typeof:_m,type:t,compare:e===void 0?null:e}};Ie.startTransition=function(t){var e=Ti.transition;Ti.transition={};try{t()}finally{Ti.transition=e}};Ie.unstable_act=Tf;Ie.useCallback=function(t,e){return rn.current.useCallback(t,e)};Ie.useContext=function(t){return rn.current.useContext(t)};Ie.useDebugValue=function(){};Ie.useDeferredValue=function(t){return rn.current.useDeferredValue(t)};Ie.useEffect=function(t,e){return rn.current.useEffect(t,e)};Ie.useId=function(){return rn.current.useId()};Ie.useImperativeHandle=function(t,e,n){return rn.current.useImperativeHandle(t,e,n)};Ie.useInsertionEffect=function(t,e){return rn.current.useInsertionEffect(t,e)};Ie.useLayoutEffect=function(t,e){return rn.current.useLayoutEffect(t,e)};Ie.useMemo=function(t,e){return rn.current.useMemo(t,e)};Ie.useReducer=function(t,e,n){return rn.current.useReducer(t,e,n)};Ie.useRef=function(t){return rn.current.useRef(t)};Ie.useState=function(t){return rn.current.useState(t)};Ie.useSyncExternalStore=function(t,e,n){return rn.current.useSyncExternalStore(t,e,n)};Ie.useTransition=function(){return rn.current.useTransition()};Ie.version="18.3.1";Ef.exports=Ie;var E=Ef.exports;const ge=hm(E);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dm=E,Am=Symbol.for("react.element"),Om=Symbol.for("react.fragment"),Tm=Object.prototype.hasOwnProperty,Pm=Dm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Lm={key:!0,ref:!0,__self:!0,__source:!0};function Pf(t,e,n){var r,o={},s=null,i=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(i=e.ref);for(r in e)Tm.call(e,r)&&!Lm.hasOwnProperty(r)&&(o[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)o[r]===void 0&&(o[r]=e[r]);return{$$typeof:Am,type:t,key:s,ref:i,props:o,_owner:Pm.current}}ya.Fragment=Om;ya.jsx=Pf;ya.jsxs=Pf;kf.exports=ya;var a=kf.exports,Cl={},Lf={exports:{}},Cn={},$f={exports:{}},If={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(F,ue){var ae=F.length;F.push(ue);e:for(;0<ae;){var Oe=ae-1>>>1,je=F[Oe];if(0<o(je,ue))F[Oe]=ue,F[ae]=je,ae=Oe;else break e}}function n(F){return F.length===0?null:F[0]}function r(F){if(F.length===0)return null;var ue=F[0],ae=F.pop();if(ae!==ue){F[0]=ae;e:for(var Oe=0,je=F.length,re=je>>>1;Oe<re;){var we=2*(Oe+1)-1,wn=F[we],Et=we+1,Y=F[Et];if(0>o(wn,ae))Et<je&&0>o(Y,wn)?(F[Oe]=Y,F[Et]=ae,Oe=Et):(F[Oe]=wn,F[we]=ae,Oe=we);else if(Et<je&&0>o(Y,ae))F[Oe]=Y,F[Et]=ae,Oe=Et;else break e}}return ue}function o(F,ue){var ae=F.sortIndex-ue.sortIndex;return ae!==0?ae:F.id-ue.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var i=Date,l=i.now();t.unstable_now=function(){return i.now()-l}}var u=[],c=[],d=1,h=null,f=3,x=!1,y=!1,b=!1,_=typeof setTimeout=="function"?setTimeout:null,p=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(F){for(var ue=n(c);ue!==null;){if(ue.callback===null)r(c);else if(ue.startTime<=F)r(c),ue.sortIndex=ue.expirationTime,e(u,ue);else break;ue=n(c)}}function w(F){if(b=!1,g(F),!y)if(n(u)!==null)y=!0,ut(j);else{var ue=n(c);ue!==null&&nt(w,ue.startTime-F)}}function j(F,ue){y=!1,b&&(b=!1,p(S),S=-1),x=!0;var ae=f;try{for(g(ue),h=n(u);h!==null&&(!(h.expirationTime>ue)||F&&!D());){var Oe=h.callback;if(typeof Oe=="function"){h.callback=null,f=h.priorityLevel;var je=Oe(h.expirationTime<=ue);ue=t.unstable_now(),typeof je=="function"?h.callback=je:h===n(u)&&r(u),g(ue)}else r(u);h=n(u)}if(h!==null)var re=!0;else{var we=n(c);we!==null&&nt(w,we.startTime-ue),re=!1}return re}finally{h=null,f=ae,x=!1}}var R=!1,C=null,S=-1,A=5,v=-1;function D(){return!(t.unstable_now()-v<A)}function O(){if(C!==null){var F=t.unstable_now();v=F;var ue=!0;try{ue=C(!0,F)}finally{ue?M():(R=!1,C=null)}}else R=!1}var M;if(typeof m=="function")M=function(){m(O)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,ne=te.port2;te.port1.onmessage=O,M=function(){ne.postMessage(null)}}else M=function(){_(O,0)};function ut(F){C=F,R||(R=!0,M())}function nt(F,ue){S=_(function(){F(t.unstable_now())},ue)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(F){F.callback=null},t.unstable_continueExecution=function(){y||x||(y=!0,ut(j))},t.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<F?Math.floor(1e3/F):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(F){switch(f){case 1:case 2:case 3:var ue=3;break;default:ue=f}var ae=f;f=ue;try{return F()}finally{f=ae}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(F,ue){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var ae=f;f=F;try{return ue()}finally{f=ae}},t.unstable_scheduleCallback=function(F,ue,ae){var Oe=t.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?Oe+ae:Oe):ae=Oe,F){case 1:var je=-1;break;case 2:je=250;break;case 5:je=1073741823;break;case 4:je=1e4;break;default:je=5e3}return je=ae+je,F={id:d++,callback:ue,priorityLevel:F,startTime:ae,expirationTime:je,sortIndex:-1},ae>Oe?(F.sortIndex=ae,e(c,F),n(u)===null&&F===n(c)&&(b?(p(S),S=-1):b=!0,nt(w,ae-Oe))):(F.sortIndex=je,e(u,F),y||x||(y=!0,ut(j))),F},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(F){var ue=f;return function(){var ae=f;f=ue;try{return F.apply(this,arguments)}finally{f=ae}}}})(If);$f.exports=If;var $m=$f.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Im=E,jn=$m;function U(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Mf=new Set,Os={};function ho(t,e){Wo(t,e),Wo(t+"Capture",e)}function Wo(t,e){for(Os[t]=e,t=0;t<e.length;t++)Mf.add(e[t])}var pr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Rl=Object.prototype.hasOwnProperty,Mm=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Mc={},Bc={};function Bm(t){return Rl.call(Bc,t)?!0:Rl.call(Mc,t)?!1:Mm.test(t)?Bc[t]=!0:(Mc[t]=!0,!1)}function Um(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Fm(t,e,n,r){if(e===null||typeof e>"u"||Um(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function on(t,e,n,r,o,s,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=i}var zt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){zt[t]=new on(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];zt[e]=new on(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){zt[t]=new on(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){zt[t]=new on(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){zt[t]=new on(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){zt[t]=new on(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){zt[t]=new on(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){zt[t]=new on(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){zt[t]=new on(t,5,!1,t.toLowerCase(),null,!1,!1)});var Uu=/[\-:]([a-z])/g;function Fu(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Uu,Fu);zt[e]=new on(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Uu,Fu);zt[e]=new on(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Uu,Fu);zt[e]=new on(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){zt[t]=new on(t,1,!1,t.toLowerCase(),null,!1,!1)});zt.xlinkHref=new on("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){zt[t]=new on(t,1,!1,t.toLowerCase(),null,!0,!0)});function zu(t,e,n,r){var o=zt.hasOwnProperty(e)?zt[e]:null;(o!==null?o.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Fm(e,n,o,r)&&(n=null),r||o===null?Bm(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):o.mustUseProperty?t[o.propertyName]=n===null?o.type===3?!1:"":n:(e=o.attributeName,r=o.attributeNamespace,n===null?t.removeAttribute(e):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var xr=Im.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ai=Symbol.for("react.element"),Eo=Symbol.for("react.portal"),jo=Symbol.for("react.fragment"),Wu=Symbol.for("react.strict_mode"),Nl=Symbol.for("react.profiler"),Bf=Symbol.for("react.provider"),Uf=Symbol.for("react.context"),Vu=Symbol.for("react.forward_ref"),Dl=Symbol.for("react.suspense"),Al=Symbol.for("react.suspense_list"),Gu=Symbol.for("react.memo"),Er=Symbol.for("react.lazy"),Ff=Symbol.for("react.offscreen"),Uc=Symbol.iterator;function rs(t){return t===null||typeof t!="object"?null:(t=Uc&&t[Uc]||t["@@iterator"],typeof t=="function"?t:null)}var pt=Object.assign,Wa;function hs(t){if(Wa===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Wa=e&&e[1]||""}return`
`+Wa+t}var Va=!1;function Ga(t,e){if(!t||Va)return"";Va=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var o=c.stack.split(`
`),s=r.stack.split(`
`),i=o.length-1,l=s.length-1;1<=i&&0<=l&&o[i]!==s[l];)l--;for(;1<=i&&0<=l;i--,l--)if(o[i]!==s[l]){if(i!==1||l!==1)do if(i--,l--,0>l||o[i]!==s[l]){var u=`
`+o[i].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=i&&0<=l);break}}}finally{Va=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?hs(t):""}function zm(t){switch(t.tag){case 5:return hs(t.type);case 16:return hs("Lazy");case 13:return hs("Suspense");case 19:return hs("SuspenseList");case 0:case 2:case 15:return t=Ga(t.type,!1),t;case 11:return t=Ga(t.type.render,!1),t;case 1:return t=Ga(t.type,!0),t;default:return""}}function Ol(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case jo:return"Fragment";case Eo:return"Portal";case Nl:return"Profiler";case Wu:return"StrictMode";case Dl:return"Suspense";case Al:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Uf:return(t.displayName||"Context")+".Consumer";case Bf:return(t._context.displayName||"Context")+".Provider";case Vu:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Gu:return e=t.displayName||null,e!==null?e:Ol(t.type)||"Memo";case Er:e=t._payload,t=t._init;try{return Ol(t(e))}catch{}}return null}function Wm(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Ol(e);case 8:return e===Wu?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ur(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function zf(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Vm(t){var e=zf(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return o.call(this)},set:function(i){r=""+i,s.call(this,i)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function li(t){t._valueTracker||(t._valueTracker=Vm(t))}function Wf(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=zf(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Vi(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Tl(t,e){var n=e.checked;return pt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Fc(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ur(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Vf(t,e){e=e.checked,e!=null&&zu(t,"checked",e,!1)}function Pl(t,e){Vf(t,e);var n=Ur(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Ll(t,e.type,n):e.hasOwnProperty("defaultValue")&&Ll(t,e.type,Ur(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function zc(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Ll(t,e,n){(e!=="number"||Vi(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var ps=Array.isArray;function Io(t,e,n,r){if(t=t.options,e){e={};for(var o=0;o<n.length;o++)e["$"+n[o]]=!0;for(n=0;n<t.length;n++)o=e.hasOwnProperty("$"+t[n].value),t[n].selected!==o&&(t[n].selected=o),o&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ur(n),e=null,o=0;o<t.length;o++){if(t[o].value===n){t[o].selected=!0,r&&(t[o].defaultSelected=!0);return}e!==null||t[o].disabled||(e=t[o])}e!==null&&(e.selected=!0)}}function $l(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(U(91));return pt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Wc(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(U(92));if(ps(n)){if(1<n.length)throw Error(U(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ur(n)}}function Gf(t,e){var n=Ur(e.value),r=Ur(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Vc(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function qf(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Il(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?qf(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ui,Hf=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,o){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,o)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ui=ui||document.createElement("div"),ui.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ui.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ts(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var vs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Gm=["Webkit","ms","Moz","O"];Object.keys(vs).forEach(function(t){Gm.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),vs[e]=vs[t]})});function Kf(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||vs.hasOwnProperty(t)&&vs[t]?(""+e).trim():e+"px"}function Jf(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,o=Kf(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,o):t[n]=o}}var qm=pt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ml(t,e){if(e){if(qm[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(U(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(U(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(U(61))}if(e.style!=null&&typeof e.style!="object")throw Error(U(62))}}function Bl(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ul=null;function qu(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Fl=null,Mo=null,Bo=null;function Gc(t){if(t=ei(t)){if(typeof Fl!="function")throw Error(U(280));var e=t.stateNode;e&&(e=Sa(e),Fl(t.stateNode,t.type,e))}}function Yf(t){Mo?Bo?Bo.push(t):Bo=[t]:Mo=t}function Qf(){if(Mo){var t=Mo,e=Bo;if(Bo=Mo=null,Gc(t),e)for(t=0;t<e.length;t++)Gc(e[t])}}function Xf(t,e){return t(e)}function Zf(){}var qa=!1;function eh(t,e,n){if(qa)return t(e,n);qa=!0;try{return Xf(t,e,n)}finally{qa=!1,(Mo!==null||Bo!==null)&&(Zf(),Qf())}}function Ps(t,e){var n=t.stateNode;if(n===null)return null;var r=Sa(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(U(231,e,typeof n));return n}var zl=!1;if(pr)try{var os={};Object.defineProperty(os,"passive",{get:function(){zl=!0}}),window.addEventListener("test",os,os),window.removeEventListener("test",os,os)}catch{zl=!1}function Hm(t,e,n,r,o,s,i,l,u){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(d){this.onError(d)}}var xs=!1,Gi=null,qi=!1,Wl=null,Km={onError:function(t){xs=!0,Gi=t}};function Jm(t,e,n,r,o,s,i,l,u){xs=!1,Gi=null,Hm.apply(Km,arguments)}function Ym(t,e,n,r,o,s,i,l,u){if(Jm.apply(this,arguments),xs){if(xs){var c=Gi;xs=!1,Gi=null}else throw Error(U(198));qi||(qi=!0,Wl=c)}}function po(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function th(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function qc(t){if(po(t)!==t)throw Error(U(188))}function Qm(t){var e=t.alternate;if(!e){if(e=po(t),e===null)throw Error(U(188));return e!==t?null:t}for(var n=t,r=e;;){var o=n.return;if(o===null)break;var s=o.alternate;if(s===null){if(r=o.return,r!==null){n=r;continue}break}if(o.child===s.child){for(s=o.child;s;){if(s===n)return qc(o),t;if(s===r)return qc(o),e;s=s.sibling}throw Error(U(188))}if(n.return!==r.return)n=o,r=s;else{for(var i=!1,l=o.child;l;){if(l===n){i=!0,n=o,r=s;break}if(l===r){i=!0,r=o,n=s;break}l=l.sibling}if(!i){for(l=s.child;l;){if(l===n){i=!0,n=s,r=o;break}if(l===r){i=!0,r=s,n=o;break}l=l.sibling}if(!i)throw Error(U(189))}}if(n.alternate!==r)throw Error(U(190))}if(n.tag!==3)throw Error(U(188));return n.stateNode.current===n?t:e}function nh(t){return t=Qm(t),t!==null?rh(t):null}function rh(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=rh(t);if(e!==null)return e;t=t.sibling}return null}var oh=jn.unstable_scheduleCallback,Hc=jn.unstable_cancelCallback,Xm=jn.unstable_shouldYield,Zm=jn.unstable_requestPaint,wt=jn.unstable_now,eg=jn.unstable_getCurrentPriorityLevel,Hu=jn.unstable_ImmediatePriority,sh=jn.unstable_UserBlockingPriority,Hi=jn.unstable_NormalPriority,tg=jn.unstable_LowPriority,ih=jn.unstable_IdlePriority,va=null,or=null;function ng(t){if(or&&typeof or.onCommitFiberRoot=="function")try{or.onCommitFiberRoot(va,t,void 0,(t.current.flags&128)===128)}catch{}}var Hn=Math.clz32?Math.clz32:sg,rg=Math.log,og=Math.LN2;function sg(t){return t>>>=0,t===0?32:31-(rg(t)/og|0)|0}var ci=64,di=4194304;function ms(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ki(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,o=t.suspendedLanes,s=t.pingedLanes,i=n&268435455;if(i!==0){var l=i&~o;l!==0?r=ms(l):(s&=i,s!==0&&(r=ms(s)))}else i=n&~o,i!==0?r=ms(i):s!==0&&(r=ms(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&o)&&(o=r&-r,s=e&-e,o>=s||o===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Hn(e),o=1<<n,r|=t[n],e&=~o;return r}function ig(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ag(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,o=t.expirationTimes,s=t.pendingLanes;0<s;){var i=31-Hn(s),l=1<<i,u=o[i];u===-1?(!(l&n)||l&r)&&(o[i]=ig(l,e)):u<=e&&(t.expiredLanes|=l),s&=~l}}function Vl(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function ah(){var t=ci;return ci<<=1,!(ci&4194240)&&(ci=64),t}function Ha(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Xs(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Hn(e),t[e]=n}function lg(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var o=31-Hn(n),s=1<<o;e[o]=0,r[o]=-1,t[o]=-1,n&=~s}}function Ku(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Hn(n),o=1<<r;o&e|t[r]&e&&(t[r]|=e),n&=~o}}var Qe=0;function lh(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var uh,Ju,ch,dh,fh,Gl=!1,fi=[],Or=null,Tr=null,Pr=null,Ls=new Map,$s=new Map,Cr=[],ug="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Kc(t,e){switch(t){case"focusin":case"focusout":Or=null;break;case"dragenter":case"dragleave":Tr=null;break;case"mouseover":case"mouseout":Pr=null;break;case"pointerover":case"pointerout":Ls.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":$s.delete(e.pointerId)}}function ss(t,e,n,r,o,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[o]},e!==null&&(e=ei(e),e!==null&&Ju(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,o!==null&&e.indexOf(o)===-1&&e.push(o),t)}function cg(t,e,n,r,o){switch(e){case"focusin":return Or=ss(Or,t,e,n,r,o),!0;case"dragenter":return Tr=ss(Tr,t,e,n,r,o),!0;case"mouseover":return Pr=ss(Pr,t,e,n,r,o),!0;case"pointerover":var s=o.pointerId;return Ls.set(s,ss(Ls.get(s)||null,t,e,n,r,o)),!0;case"gotpointercapture":return s=o.pointerId,$s.set(s,ss($s.get(s)||null,t,e,n,r,o)),!0}return!1}function hh(t){var e=eo(t.target);if(e!==null){var n=po(e);if(n!==null){if(e=n.tag,e===13){if(e=th(n),e!==null){t.blockedOn=e,fh(t.priority,function(){ch(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Pi(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=ql(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Ul=r,n.target.dispatchEvent(r),Ul=null}else return e=ei(n),e!==null&&Ju(e),t.blockedOn=n,!1;e.shift()}return!0}function Jc(t,e,n){Pi(t)&&n.delete(e)}function dg(){Gl=!1,Or!==null&&Pi(Or)&&(Or=null),Tr!==null&&Pi(Tr)&&(Tr=null),Pr!==null&&Pi(Pr)&&(Pr=null),Ls.forEach(Jc),$s.forEach(Jc)}function is(t,e){t.blockedOn===e&&(t.blockedOn=null,Gl||(Gl=!0,jn.unstable_scheduleCallback(jn.unstable_NormalPriority,dg)))}function Is(t){function e(o){return is(o,t)}if(0<fi.length){is(fi[0],t);for(var n=1;n<fi.length;n++){var r=fi[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Or!==null&&is(Or,t),Tr!==null&&is(Tr,t),Pr!==null&&is(Pr,t),Ls.forEach(e),$s.forEach(e),n=0;n<Cr.length;n++)r=Cr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Cr.length&&(n=Cr[0],n.blockedOn===null);)hh(n),n.blockedOn===null&&Cr.shift()}var Uo=xr.ReactCurrentBatchConfig,Ji=!0;function fg(t,e,n,r){var o=Qe,s=Uo.transition;Uo.transition=null;try{Qe=1,Yu(t,e,n,r)}finally{Qe=o,Uo.transition=s}}function hg(t,e,n,r){var o=Qe,s=Uo.transition;Uo.transition=null;try{Qe=4,Yu(t,e,n,r)}finally{Qe=o,Uo.transition=s}}function Yu(t,e,n,r){if(Ji){var o=ql(t,e,n,r);if(o===null)rl(t,e,r,Yi,n),Kc(t,r);else if(cg(o,t,e,n,r))r.stopPropagation();else if(Kc(t,r),e&4&&-1<ug.indexOf(t)){for(;o!==null;){var s=ei(o);if(s!==null&&uh(s),s=ql(t,e,n,r),s===null&&rl(t,e,r,Yi,n),s===o)break;o=s}o!==null&&r.stopPropagation()}else rl(t,e,r,null,n)}}var Yi=null;function ql(t,e,n,r){if(Yi=null,t=qu(r),t=eo(t),t!==null)if(e=po(t),e===null)t=null;else if(n=e.tag,n===13){if(t=th(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Yi=t,null}function ph(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(eg()){case Hu:return 1;case sh:return 4;case Hi:case tg:return 16;case ih:return 536870912;default:return 16}default:return 16}}var Dr=null,Qu=null,Li=null;function mh(){if(Li)return Li;var t,e=Qu,n=e.length,r,o="value"in Dr?Dr.value:Dr.textContent,s=o.length;for(t=0;t<n&&e[t]===o[t];t++);var i=n-t;for(r=1;r<=i&&e[n-r]===o[s-r];r++);return Li=o.slice(t,1<r?1-r:void 0)}function $i(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function hi(){return!0}function Yc(){return!1}function Rn(t){function e(n,r,o,s,i){this._reactName=n,this._targetInst=o,this.type=r,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?hi:Yc,this.isPropagationStopped=Yc,this}return pt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=hi)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=hi)},persist:function(){},isPersistent:hi}),e}var Xo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xu=Rn(Xo),Zs=pt({},Xo,{view:0,detail:0}),pg=Rn(Zs),Ka,Ja,as,xa=pt({},Zs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zu,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==as&&(as&&t.type==="mousemove"?(Ka=t.screenX-as.screenX,Ja=t.screenY-as.screenY):Ja=Ka=0,as=t),Ka)},movementY:function(t){return"movementY"in t?t.movementY:Ja}}),Qc=Rn(xa),mg=pt({},xa,{dataTransfer:0}),gg=Rn(mg),yg=pt({},Zs,{relatedTarget:0}),Ya=Rn(yg),vg=pt({},Xo,{animationName:0,elapsedTime:0,pseudoElement:0}),xg=Rn(vg),bg=pt({},Xo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),wg=Rn(bg),Sg=pt({},Xo,{data:0}),Xc=Rn(Sg),_g={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Eg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jg(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Eg[t])?!!e[t]:!1}function Zu(){return jg}var Cg=pt({},Zs,{key:function(t){if(t.key){var e=_g[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=$i(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?kg[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zu,charCode:function(t){return t.type==="keypress"?$i(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?$i(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Rg=Rn(Cg),Ng=pt({},xa,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zc=Rn(Ng),Dg=pt({},Zs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zu}),Ag=Rn(Dg),Og=pt({},Xo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Tg=Rn(Og),Pg=pt({},xa,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Lg=Rn(Pg),$g=[9,13,27,32],ec=pr&&"CompositionEvent"in window,bs=null;pr&&"documentMode"in document&&(bs=document.documentMode);var Ig=pr&&"TextEvent"in window&&!bs,gh=pr&&(!ec||bs&&8<bs&&11>=bs),ed=" ",td=!1;function yh(t,e){switch(t){case"keyup":return $g.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vh(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Co=!1;function Mg(t,e){switch(t){case"compositionend":return vh(e);case"keypress":return e.which!==32?null:(td=!0,ed);case"textInput":return t=e.data,t===ed&&td?null:t;default:return null}}function Bg(t,e){if(Co)return t==="compositionend"||!ec&&yh(t,e)?(t=mh(),Li=Qu=Dr=null,Co=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return gh&&e.locale!=="ko"?null:e.data;default:return null}}var Ug={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function nd(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Ug[t.type]:e==="textarea"}function xh(t,e,n,r){Yf(r),e=Qi(e,"onChange"),0<e.length&&(n=new Xu("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var ws=null,Ms=null;function Fg(t){Dh(t,0)}function ba(t){var e=Do(t);if(Wf(e))return t}function zg(t,e){if(t==="change")return e}var bh=!1;if(pr){var Qa;if(pr){var Xa="oninput"in document;if(!Xa){var rd=document.createElement("div");rd.setAttribute("oninput","return;"),Xa=typeof rd.oninput=="function"}Qa=Xa}else Qa=!1;bh=Qa&&(!document.documentMode||9<document.documentMode)}function od(){ws&&(ws.detachEvent("onpropertychange",wh),Ms=ws=null)}function wh(t){if(t.propertyName==="value"&&ba(Ms)){var e=[];xh(e,Ms,t,qu(t)),eh(Fg,e)}}function Wg(t,e,n){t==="focusin"?(od(),ws=e,Ms=n,ws.attachEvent("onpropertychange",wh)):t==="focusout"&&od()}function Vg(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ba(Ms)}function Gg(t,e){if(t==="click")return ba(e)}function qg(t,e){if(t==="input"||t==="change")return ba(e)}function Hg(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Jn=typeof Object.is=="function"?Object.is:Hg;function Bs(t,e){if(Jn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!Rl.call(e,o)||!Jn(t[o],e[o]))return!1}return!0}function sd(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function id(t,e){var n=sd(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=sd(n)}}function Sh(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Sh(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function _h(){for(var t=window,e=Vi();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Vi(t.document)}return e}function tc(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Kg(t){var e=_h(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Sh(n.ownerDocument.documentElement,n)){if(r!==null&&tc(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var o=n.textContent.length,s=Math.min(r.start,o);r=r.end===void 0?s:Math.min(r.end,o),!t.extend&&s>r&&(o=r,r=s,s=o),o=id(n,s);var i=id(n,r);o&&i&&(t.rangeCount!==1||t.anchorNode!==o.node||t.anchorOffset!==o.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(o.node,o.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Jg=pr&&"documentMode"in document&&11>=document.documentMode,Ro=null,Hl=null,Ss=null,Kl=!1;function ad(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Kl||Ro==null||Ro!==Vi(r)||(r=Ro,"selectionStart"in r&&tc(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ss&&Bs(Ss,r)||(Ss=r,r=Qi(Hl,"onSelect"),0<r.length&&(e=new Xu("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Ro)))}function pi(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var No={animationend:pi("Animation","AnimationEnd"),animationiteration:pi("Animation","AnimationIteration"),animationstart:pi("Animation","AnimationStart"),transitionend:pi("Transition","TransitionEnd")},Za={},kh={};pr&&(kh=document.createElement("div").style,"AnimationEvent"in window||(delete No.animationend.animation,delete No.animationiteration.animation,delete No.animationstart.animation),"TransitionEvent"in window||delete No.transitionend.transition);function wa(t){if(Za[t])return Za[t];if(!No[t])return t;var e=No[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in kh)return Za[t]=e[n];return t}var Eh=wa("animationend"),jh=wa("animationiteration"),Ch=wa("animationstart"),Rh=wa("transitionend"),Nh=new Map,ld="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zr(t,e){Nh.set(t,e),ho(e,[t])}for(var el=0;el<ld.length;el++){var tl=ld[el],Yg=tl.toLowerCase(),Qg=tl[0].toUpperCase()+tl.slice(1);zr(Yg,"on"+Qg)}zr(Eh,"onAnimationEnd");zr(jh,"onAnimationIteration");zr(Ch,"onAnimationStart");zr("dblclick","onDoubleClick");zr("focusin","onFocus");zr("focusout","onBlur");zr(Rh,"onTransitionEnd");Wo("onMouseEnter",["mouseout","mouseover"]);Wo("onMouseLeave",["mouseout","mouseover"]);Wo("onPointerEnter",["pointerout","pointerover"]);Wo("onPointerLeave",["pointerout","pointerover"]);ho("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ho("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ho("onBeforeInput",["compositionend","keypress","textInput","paste"]);ho("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ho("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ho("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var gs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Xg=new Set("cancel close invalid load scroll toggle".split(" ").concat(gs));function ud(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Ym(r,e,void 0,t),t.currentTarget=null}function Dh(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],o=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var i=r.length-1;0<=i;i--){var l=r[i],u=l.instance,c=l.currentTarget;if(l=l.listener,u!==s&&o.isPropagationStopped())break e;ud(o,l,c),s=u}else for(i=0;i<r.length;i++){if(l=r[i],u=l.instance,c=l.currentTarget,l=l.listener,u!==s&&o.isPropagationStopped())break e;ud(o,l,c),s=u}}}if(qi)throw t=Wl,qi=!1,Wl=null,t}function at(t,e){var n=e[Zl];n===void 0&&(n=e[Zl]=new Set);var r=t+"__bubble";n.has(r)||(Ah(e,t,2,!1),n.add(r))}function nl(t,e,n){var r=0;e&&(r|=4),Ah(n,t,r,e)}var mi="_reactListening"+Math.random().toString(36).slice(2);function Us(t){if(!t[mi]){t[mi]=!0,Mf.forEach(function(n){n!=="selectionchange"&&(Xg.has(n)||nl(n,!1,t),nl(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[mi]||(e[mi]=!0,nl("selectionchange",!1,e))}}function Ah(t,e,n,r){switch(ph(e)){case 1:var o=fg;break;case 4:o=hg;break;default:o=Yu}n=o.bind(null,e,n,t),o=void 0,!zl||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(o=!0),r?o!==void 0?t.addEventListener(e,n,{capture:!0,passive:o}):t.addEventListener(e,n,!0):o!==void 0?t.addEventListener(e,n,{passive:o}):t.addEventListener(e,n,!1)}function rl(t,e,n,r,o){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var l=r.stateNode.containerInfo;if(l===o||l.nodeType===8&&l.parentNode===o)break;if(i===4)for(i=r.return;i!==null;){var u=i.tag;if((u===3||u===4)&&(u=i.stateNode.containerInfo,u===o||u.nodeType===8&&u.parentNode===o))return;i=i.return}for(;l!==null;){if(i=eo(l),i===null)return;if(u=i.tag,u===5||u===6){r=s=i;continue e}l=l.parentNode}}r=r.return}eh(function(){var c=s,d=qu(n),h=[];e:{var f=Nh.get(t);if(f!==void 0){var x=Xu,y=t;switch(t){case"keypress":if($i(n)===0)break e;case"keydown":case"keyup":x=Rg;break;case"focusin":y="focus",x=Ya;break;case"focusout":y="blur",x=Ya;break;case"beforeblur":case"afterblur":x=Ya;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=Qc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=gg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=Ag;break;case Eh:case jh:case Ch:x=xg;break;case Rh:x=Tg;break;case"scroll":x=pg;break;case"wheel":x=Lg;break;case"copy":case"cut":case"paste":x=wg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=Zc}var b=(e&4)!==0,_=!b&&t==="scroll",p=b?f!==null?f+"Capture":null:f;b=[];for(var m=c,g;m!==null;){g=m;var w=g.stateNode;if(g.tag===5&&w!==null&&(g=w,p!==null&&(w=Ps(m,p),w!=null&&b.push(Fs(m,w,g)))),_)break;m=m.return}0<b.length&&(f=new x(f,y,null,n,d),h.push({event:f,listeners:b}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",x=t==="mouseout"||t==="pointerout",f&&n!==Ul&&(y=n.relatedTarget||n.fromElement)&&(eo(y)||y[mr]))break e;if((x||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,x?(y=n.relatedTarget||n.toElement,x=c,y=y?eo(y):null,y!==null&&(_=po(y),y!==_||y.tag!==5&&y.tag!==6)&&(y=null)):(x=null,y=c),x!==y)){if(b=Qc,w="onMouseLeave",p="onMouseEnter",m="mouse",(t==="pointerout"||t==="pointerover")&&(b=Zc,w="onPointerLeave",p="onPointerEnter",m="pointer"),_=x==null?f:Do(x),g=y==null?f:Do(y),f=new b(w,m+"leave",x,n,d),f.target=_,f.relatedTarget=g,w=null,eo(d)===c&&(b=new b(p,m+"enter",y,n,d),b.target=g,b.relatedTarget=_,w=b),_=w,x&&y)t:{for(b=x,p=y,m=0,g=b;g;g=yo(g))m++;for(g=0,w=p;w;w=yo(w))g++;for(;0<m-g;)b=yo(b),m--;for(;0<g-m;)p=yo(p),g--;for(;m--;){if(b===p||p!==null&&b===p.alternate)break t;b=yo(b),p=yo(p)}b=null}else b=null;x!==null&&cd(h,f,x,b,!1),y!==null&&_!==null&&cd(h,_,y,b,!0)}}e:{if(f=c?Do(c):window,x=f.nodeName&&f.nodeName.toLowerCase(),x==="select"||x==="input"&&f.type==="file")var j=zg;else if(nd(f))if(bh)j=qg;else{j=Vg;var R=Wg}else(x=f.nodeName)&&x.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(j=Gg);if(j&&(j=j(t,c))){xh(h,j,n,d);break e}R&&R(t,f,c),t==="focusout"&&(R=f._wrapperState)&&R.controlled&&f.type==="number"&&Ll(f,"number",f.value)}switch(R=c?Do(c):window,t){case"focusin":(nd(R)||R.contentEditable==="true")&&(Ro=R,Hl=c,Ss=null);break;case"focusout":Ss=Hl=Ro=null;break;case"mousedown":Kl=!0;break;case"contextmenu":case"mouseup":case"dragend":Kl=!1,ad(h,n,d);break;case"selectionchange":if(Jg)break;case"keydown":case"keyup":ad(h,n,d)}var C;if(ec)e:{switch(t){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else Co?yh(t,n)&&(S="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(S="onCompositionStart");S&&(gh&&n.locale!=="ko"&&(Co||S!=="onCompositionStart"?S==="onCompositionEnd"&&Co&&(C=mh()):(Dr=d,Qu="value"in Dr?Dr.value:Dr.textContent,Co=!0)),R=Qi(c,S),0<R.length&&(S=new Xc(S,t,null,n,d),h.push({event:S,listeners:R}),C?S.data=C:(C=vh(n),C!==null&&(S.data=C)))),(C=Ig?Mg(t,n):Bg(t,n))&&(c=Qi(c,"onBeforeInput"),0<c.length&&(d=new Xc("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:c}),d.data=C))}Dh(h,e)})}function Fs(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Qi(t,e){for(var n=e+"Capture",r=[];t!==null;){var o=t,s=o.stateNode;o.tag===5&&s!==null&&(o=s,s=Ps(t,n),s!=null&&r.unshift(Fs(t,s,o)),s=Ps(t,e),s!=null&&r.push(Fs(t,s,o))),t=t.return}return r}function yo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function cd(t,e,n,r,o){for(var s=e._reactName,i=[];n!==null&&n!==r;){var l=n,u=l.alternate,c=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&c!==null&&(l=c,o?(u=Ps(n,s),u!=null&&i.unshift(Fs(n,u,l))):o||(u=Ps(n,s),u!=null&&i.push(Fs(n,u,l)))),n=n.return}i.length!==0&&t.push({event:e,listeners:i})}var Zg=/\r\n?/g,e0=/\u0000|\uFFFD/g;function dd(t){return(typeof t=="string"?t:""+t).replace(Zg,`
`).replace(e0,"")}function gi(t,e,n){if(e=dd(e),dd(t)!==e&&n)throw Error(U(425))}function Xi(){}var Jl=null,Yl=null;function Ql(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Xl=typeof setTimeout=="function"?setTimeout:void 0,t0=typeof clearTimeout=="function"?clearTimeout:void 0,fd=typeof Promise=="function"?Promise:void 0,n0=typeof queueMicrotask=="function"?queueMicrotask:typeof fd<"u"?function(t){return fd.resolve(null).then(t).catch(r0)}:Xl;function r0(t){setTimeout(function(){throw t})}function ol(t,e){var n=e,r=0;do{var o=n.nextSibling;if(t.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(r===0){t.removeChild(o),Is(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=o}while(n);Is(e)}function Lr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function hd(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Zo=Math.random().toString(36).slice(2),nr="__reactFiber$"+Zo,zs="__reactProps$"+Zo,mr="__reactContainer$"+Zo,Zl="__reactEvents$"+Zo,o0="__reactListeners$"+Zo,s0="__reactHandles$"+Zo;function eo(t){var e=t[nr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[mr]||n[nr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=hd(t);t!==null;){if(n=t[nr])return n;t=hd(t)}return e}t=n,n=t.parentNode}return null}function ei(t){return t=t[nr]||t[mr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Do(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(U(33))}function Sa(t){return t[zs]||null}var eu=[],Ao=-1;function Wr(t){return{current:t}}function lt(t){0>Ao||(t.current=eu[Ao],eu[Ao]=null,Ao--)}function ot(t,e){Ao++,eu[Ao]=t.current,t.current=e}var Fr={},Kt=Wr(Fr),vn=Wr(!1),so=Fr;function Vo(t,e){var n=t.type.contextTypes;if(!n)return Fr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var o={},s;for(s in n)o[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function xn(t){return t=t.childContextTypes,t!=null}function Zi(){lt(vn),lt(Kt)}function pd(t,e,n){if(Kt.current!==Fr)throw Error(U(168));ot(Kt,e),ot(vn,n)}function Oh(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var o in r)if(!(o in e))throw Error(U(108,Wm(t)||"Unknown",o));return pt({},n,r)}function ea(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Fr,so=Kt.current,ot(Kt,t),ot(vn,vn.current),!0}function md(t,e,n){var r=t.stateNode;if(!r)throw Error(U(169));n?(t=Oh(t,e,so),r.__reactInternalMemoizedMergedChildContext=t,lt(vn),lt(Kt),ot(Kt,t)):lt(vn),ot(vn,n)}var ur=null,_a=!1,sl=!1;function Th(t){ur===null?ur=[t]:ur.push(t)}function i0(t){_a=!0,Th(t)}function Vr(){if(!sl&&ur!==null){sl=!0;var t=0,e=Qe;try{var n=ur;for(Qe=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ur=null,_a=!1}catch(o){throw ur!==null&&(ur=ur.slice(t+1)),oh(Hu,Vr),o}finally{Qe=e,sl=!1}}return null}var Oo=[],To=0,ta=null,na=0,On=[],Tn=0,io=null,cr=1,dr="";function Yr(t,e){Oo[To++]=na,Oo[To++]=ta,ta=t,na=e}function Ph(t,e,n){On[Tn++]=cr,On[Tn++]=dr,On[Tn++]=io,io=t;var r=cr;t=dr;var o=32-Hn(r)-1;r&=~(1<<o),n+=1;var s=32-Hn(e)+o;if(30<s){var i=o-o%5;s=(r&(1<<i)-1).toString(32),r>>=i,o-=i,cr=1<<32-Hn(e)+o|n<<o|r,dr=s+t}else cr=1<<s|n<<o|r,dr=t}function nc(t){t.return!==null&&(Yr(t,1),Ph(t,1,0))}function rc(t){for(;t===ta;)ta=Oo[--To],Oo[To]=null,na=Oo[--To],Oo[To]=null;for(;t===io;)io=On[--Tn],On[Tn]=null,dr=On[--Tn],On[Tn]=null,cr=On[--Tn],On[Tn]=null}var En=null,kn=null,dt=!1,Gn=null;function Lh(t,e){var n=Pn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function gd(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,En=t,kn=Lr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,En=t,kn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=io!==null?{id:cr,overflow:dr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Pn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,En=t,kn=null,!0):!1;default:return!1}}function tu(t){return(t.mode&1)!==0&&(t.flags&128)===0}function nu(t){if(dt){var e=kn;if(e){var n=e;if(!gd(t,e)){if(tu(t))throw Error(U(418));e=Lr(n.nextSibling);var r=En;e&&gd(t,e)?Lh(r,n):(t.flags=t.flags&-4097|2,dt=!1,En=t)}}else{if(tu(t))throw Error(U(418));t.flags=t.flags&-4097|2,dt=!1,En=t}}}function yd(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;En=t}function yi(t){if(t!==En)return!1;if(!dt)return yd(t),dt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Ql(t.type,t.memoizedProps)),e&&(e=kn)){if(tu(t))throw $h(),Error(U(418));for(;e;)Lh(t,e),e=Lr(e.nextSibling)}if(yd(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(U(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){kn=Lr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}kn=null}}else kn=En?Lr(t.stateNode.nextSibling):null;return!0}function $h(){for(var t=kn;t;)t=Lr(t.nextSibling)}function Go(){kn=En=null,dt=!1}function oc(t){Gn===null?Gn=[t]:Gn.push(t)}var a0=xr.ReactCurrentBatchConfig;function ls(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(U(309));var r=n.stateNode}if(!r)throw Error(U(147,t));var o=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(i){var l=o.refs;i===null?delete l[s]:l[s]=i},e._stringRef=s,e)}if(typeof t!="string")throw Error(U(284));if(!n._owner)throw Error(U(290,t))}return t}function vi(t,e){throw t=Object.prototype.toString.call(e),Error(U(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function vd(t){var e=t._init;return e(t._payload)}function Ih(t){function e(p,m){if(t){var g=p.deletions;g===null?(p.deletions=[m],p.flags|=16):g.push(m)}}function n(p,m){if(!t)return null;for(;m!==null;)e(p,m),m=m.sibling;return null}function r(p,m){for(p=new Map;m!==null;)m.key!==null?p.set(m.key,m):p.set(m.index,m),m=m.sibling;return p}function o(p,m){return p=Br(p,m),p.index=0,p.sibling=null,p}function s(p,m,g){return p.index=g,t?(g=p.alternate,g!==null?(g=g.index,g<m?(p.flags|=2,m):g):(p.flags|=2,m)):(p.flags|=1048576,m)}function i(p){return t&&p.alternate===null&&(p.flags|=2),p}function l(p,m,g,w){return m===null||m.tag!==6?(m=fl(g,p.mode,w),m.return=p,m):(m=o(m,g),m.return=p,m)}function u(p,m,g,w){var j=g.type;return j===jo?d(p,m,g.props.children,w,g.key):m!==null&&(m.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Er&&vd(j)===m.type)?(w=o(m,g.props),w.ref=ls(p,m,g),w.return=p,w):(w=Wi(g.type,g.key,g.props,null,p.mode,w),w.ref=ls(p,m,g),w.return=p,w)}function c(p,m,g,w){return m===null||m.tag!==4||m.stateNode.containerInfo!==g.containerInfo||m.stateNode.implementation!==g.implementation?(m=hl(g,p.mode,w),m.return=p,m):(m=o(m,g.children||[]),m.return=p,m)}function d(p,m,g,w,j){return m===null||m.tag!==7?(m=oo(g,p.mode,w,j),m.return=p,m):(m=o(m,g),m.return=p,m)}function h(p,m,g){if(typeof m=="string"&&m!==""||typeof m=="number")return m=fl(""+m,p.mode,g),m.return=p,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case ai:return g=Wi(m.type,m.key,m.props,null,p.mode,g),g.ref=ls(p,null,m),g.return=p,g;case Eo:return m=hl(m,p.mode,g),m.return=p,m;case Er:var w=m._init;return h(p,w(m._payload),g)}if(ps(m)||rs(m))return m=oo(m,p.mode,g,null),m.return=p,m;vi(p,m)}return null}function f(p,m,g,w){var j=m!==null?m.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return j!==null?null:l(p,m,""+g,w);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case ai:return g.key===j?u(p,m,g,w):null;case Eo:return g.key===j?c(p,m,g,w):null;case Er:return j=g._init,f(p,m,j(g._payload),w)}if(ps(g)||rs(g))return j!==null?null:d(p,m,g,w,null);vi(p,g)}return null}function x(p,m,g,w,j){if(typeof w=="string"&&w!==""||typeof w=="number")return p=p.get(g)||null,l(m,p,""+w,j);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ai:return p=p.get(w.key===null?g:w.key)||null,u(m,p,w,j);case Eo:return p=p.get(w.key===null?g:w.key)||null,c(m,p,w,j);case Er:var R=w._init;return x(p,m,g,R(w._payload),j)}if(ps(w)||rs(w))return p=p.get(g)||null,d(m,p,w,j,null);vi(m,w)}return null}function y(p,m,g,w){for(var j=null,R=null,C=m,S=m=0,A=null;C!==null&&S<g.length;S++){C.index>S?(A=C,C=null):A=C.sibling;var v=f(p,C,g[S],w);if(v===null){C===null&&(C=A);break}t&&C&&v.alternate===null&&e(p,C),m=s(v,m,S),R===null?j=v:R.sibling=v,R=v,C=A}if(S===g.length)return n(p,C),dt&&Yr(p,S),j;if(C===null){for(;S<g.length;S++)C=h(p,g[S],w),C!==null&&(m=s(C,m,S),R===null?j=C:R.sibling=C,R=C);return dt&&Yr(p,S),j}for(C=r(p,C);S<g.length;S++)A=x(C,p,S,g[S],w),A!==null&&(t&&A.alternate!==null&&C.delete(A.key===null?S:A.key),m=s(A,m,S),R===null?j=A:R.sibling=A,R=A);return t&&C.forEach(function(D){return e(p,D)}),dt&&Yr(p,S),j}function b(p,m,g,w){var j=rs(g);if(typeof j!="function")throw Error(U(150));if(g=j.call(g),g==null)throw Error(U(151));for(var R=j=null,C=m,S=m=0,A=null,v=g.next();C!==null&&!v.done;S++,v=g.next()){C.index>S?(A=C,C=null):A=C.sibling;var D=f(p,C,v.value,w);if(D===null){C===null&&(C=A);break}t&&C&&D.alternate===null&&e(p,C),m=s(D,m,S),R===null?j=D:R.sibling=D,R=D,C=A}if(v.done)return n(p,C),dt&&Yr(p,S),j;if(C===null){for(;!v.done;S++,v=g.next())v=h(p,v.value,w),v!==null&&(m=s(v,m,S),R===null?j=v:R.sibling=v,R=v);return dt&&Yr(p,S),j}for(C=r(p,C);!v.done;S++,v=g.next())v=x(C,p,S,v.value,w),v!==null&&(t&&v.alternate!==null&&C.delete(v.key===null?S:v.key),m=s(v,m,S),R===null?j=v:R.sibling=v,R=v);return t&&C.forEach(function(O){return e(p,O)}),dt&&Yr(p,S),j}function _(p,m,g,w){if(typeof g=="object"&&g!==null&&g.type===jo&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case ai:e:{for(var j=g.key,R=m;R!==null;){if(R.key===j){if(j=g.type,j===jo){if(R.tag===7){n(p,R.sibling),m=o(R,g.props.children),m.return=p,p=m;break e}}else if(R.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Er&&vd(j)===R.type){n(p,R.sibling),m=o(R,g.props),m.ref=ls(p,R,g),m.return=p,p=m;break e}n(p,R);break}else e(p,R);R=R.sibling}g.type===jo?(m=oo(g.props.children,p.mode,w,g.key),m.return=p,p=m):(w=Wi(g.type,g.key,g.props,null,p.mode,w),w.ref=ls(p,m,g),w.return=p,p=w)}return i(p);case Eo:e:{for(R=g.key;m!==null;){if(m.key===R)if(m.tag===4&&m.stateNode.containerInfo===g.containerInfo&&m.stateNode.implementation===g.implementation){n(p,m.sibling),m=o(m,g.children||[]),m.return=p,p=m;break e}else{n(p,m);break}else e(p,m);m=m.sibling}m=hl(g,p.mode,w),m.return=p,p=m}return i(p);case Er:return R=g._init,_(p,m,R(g._payload),w)}if(ps(g))return y(p,m,g,w);if(rs(g))return b(p,m,g,w);vi(p,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,m!==null&&m.tag===6?(n(p,m.sibling),m=o(m,g),m.return=p,p=m):(n(p,m),m=fl(g,p.mode,w),m.return=p,p=m),i(p)):n(p,m)}return _}var qo=Ih(!0),Mh=Ih(!1),ra=Wr(null),oa=null,Po=null,sc=null;function ic(){sc=Po=oa=null}function ac(t){var e=ra.current;lt(ra),t._currentValue=e}function ru(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Fo(t,e){oa=t,sc=Po=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(yn=!0),t.firstContext=null)}function In(t){var e=t._currentValue;if(sc!==t)if(t={context:t,memoizedValue:e,next:null},Po===null){if(oa===null)throw Error(U(308));Po=t,oa.dependencies={lanes:0,firstContext:t}}else Po=Po.next=t;return e}var to=null;function lc(t){to===null?to=[t]:to.push(t)}function Bh(t,e,n,r){var o=e.interleaved;return o===null?(n.next=n,lc(e)):(n.next=o.next,o.next=n),e.interleaved=n,gr(t,r)}function gr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var jr=!1;function uc(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Uh(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function hr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function $r(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,qe&2){var o=r.pending;return o===null?e.next=e:(e.next=o.next,o.next=e),r.pending=e,gr(t,n)}return o=r.interleaved,o===null?(e.next=e,lc(r)):(e.next=o.next,o.next=e),r.interleaved=e,gr(t,n)}function Ii(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ku(t,n)}}function xd(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var o=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?o=s=i:s=s.next=i,n=n.next}while(n!==null);s===null?o=s=e:s=s.next=e}else o=s=e;n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function sa(t,e,n,r){var o=t.updateQueue;jr=!1;var s=o.firstBaseUpdate,i=o.lastBaseUpdate,l=o.shared.pending;if(l!==null){o.shared.pending=null;var u=l,c=u.next;u.next=null,i===null?s=c:i.next=c,i=u;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==i&&(l===null?d.firstBaseUpdate=c:l.next=c,d.lastBaseUpdate=u))}if(s!==null){var h=o.baseState;i=0,d=c=u=null,l=s;do{var f=l.lane,x=l.eventTime;if((r&f)===f){d!==null&&(d=d.next={eventTime:x,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var y=t,b=l;switch(f=e,x=n,b.tag){case 1:if(y=b.payload,typeof y=="function"){h=y.call(x,h,f);break e}h=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=b.payload,f=typeof y=="function"?y.call(x,h,f):y,f==null)break e;h=pt({},h,f);break e;case 2:jr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,f=o.effects,f===null?o.effects=[l]:f.push(l))}else x={eventTime:x,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(c=d=x,u=h):d=d.next=x,i|=f;if(l=l.next,l===null){if(l=o.shared.pending,l===null)break;f=l,l=f.next,f.next=null,o.lastBaseUpdate=f,o.shared.pending=null}}while(!0);if(d===null&&(u=h),o.baseState=u,o.firstBaseUpdate=c,o.lastBaseUpdate=d,e=o.shared.interleaved,e!==null){o=e;do i|=o.lane,o=o.next;while(o!==e)}else s===null&&(o.shared.lanes=0);lo|=i,t.lanes=i,t.memoizedState=h}}function bd(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],o=r.callback;if(o!==null){if(r.callback=null,r=n,typeof o!="function")throw Error(U(191,o));o.call(r)}}}var ti={},sr=Wr(ti),Ws=Wr(ti),Vs=Wr(ti);function no(t){if(t===ti)throw Error(U(174));return t}function cc(t,e){switch(ot(Vs,e),ot(Ws,t),ot(sr,ti),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Il(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Il(e,t)}lt(sr),ot(sr,e)}function Ho(){lt(sr),lt(Ws),lt(Vs)}function Fh(t){no(Vs.current);var e=no(sr.current),n=Il(e,t.type);e!==n&&(ot(Ws,t),ot(sr,n))}function dc(t){Ws.current===t&&(lt(sr),lt(Ws))}var ft=Wr(0);function ia(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var il=[];function fc(){for(var t=0;t<il.length;t++)il[t]._workInProgressVersionPrimary=null;il.length=0}var Mi=xr.ReactCurrentDispatcher,al=xr.ReactCurrentBatchConfig,ao=0,ht=null,Rt=null,Lt=null,aa=!1,_s=!1,Gs=0,l0=0;function Gt(){throw Error(U(321))}function hc(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Jn(t[n],e[n]))return!1;return!0}function pc(t,e,n,r,o,s){if(ao=s,ht=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Mi.current=t===null||t.memoizedState===null?f0:h0,t=n(r,o),_s){s=0;do{if(_s=!1,Gs=0,25<=s)throw Error(U(301));s+=1,Lt=Rt=null,e.updateQueue=null,Mi.current=p0,t=n(r,o)}while(_s)}if(Mi.current=la,e=Rt!==null&&Rt.next!==null,ao=0,Lt=Rt=ht=null,aa=!1,e)throw Error(U(300));return t}function mc(){var t=Gs!==0;return Gs=0,t}function er(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Lt===null?ht.memoizedState=Lt=t:Lt=Lt.next=t,Lt}function Mn(){if(Rt===null){var t=ht.alternate;t=t!==null?t.memoizedState:null}else t=Rt.next;var e=Lt===null?ht.memoizedState:Lt.next;if(e!==null)Lt=e,Rt=t;else{if(t===null)throw Error(U(310));Rt=t,t={memoizedState:Rt.memoizedState,baseState:Rt.baseState,baseQueue:Rt.baseQueue,queue:Rt.queue,next:null},Lt===null?ht.memoizedState=Lt=t:Lt=Lt.next=t}return Lt}function qs(t,e){return typeof e=="function"?e(t):e}function ll(t){var e=Mn(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=Rt,o=r.baseQueue,s=n.pending;if(s!==null){if(o!==null){var i=o.next;o.next=s.next,s.next=i}r.baseQueue=o=s,n.pending=null}if(o!==null){s=o.next,r=r.baseState;var l=i=null,u=null,c=s;do{var d=c.lane;if((ao&d)===d)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(l=u=h,i=r):u=u.next=h,ht.lanes|=d,lo|=d}c=c.next}while(c!==null&&c!==s);u===null?i=r:u.next=l,Jn(r,e.memoizedState)||(yn=!0),e.memoizedState=r,e.baseState=i,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){o=t;do s=o.lane,ht.lanes|=s,lo|=s,o=o.next;while(o!==t)}else o===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function ul(t){var e=Mn(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=n.dispatch,o=n.pending,s=e.memoizedState;if(o!==null){n.pending=null;var i=o=o.next;do s=t(s,i.action),i=i.next;while(i!==o);Jn(s,e.memoizedState)||(yn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function zh(){}function Wh(t,e){var n=ht,r=Mn(),o=e(),s=!Jn(r.memoizedState,o);if(s&&(r.memoizedState=o,yn=!0),r=r.queue,gc(qh.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Lt!==null&&Lt.memoizedState.tag&1){if(n.flags|=2048,Hs(9,Gh.bind(null,n,r,o,e),void 0,null),$t===null)throw Error(U(349));ao&30||Vh(n,e,o)}return o}function Vh(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ht.updateQueue,e===null?(e={lastEffect:null,stores:null},ht.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Gh(t,e,n,r){e.value=n,e.getSnapshot=r,Hh(e)&&Kh(t)}function qh(t,e,n){return n(function(){Hh(e)&&Kh(t)})}function Hh(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Jn(t,n)}catch{return!0}}function Kh(t){var e=gr(t,1);e!==null&&Kn(e,t,1,-1)}function wd(t){var e=er();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:qs,lastRenderedState:t},e.queue=t,t=t.dispatch=d0.bind(null,ht,t),[e.memoizedState,t]}function Hs(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ht.updateQueue,e===null?(e={lastEffect:null,stores:null},ht.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Jh(){return Mn().memoizedState}function Bi(t,e,n,r){var o=er();ht.flags|=t,o.memoizedState=Hs(1|e,n,void 0,r===void 0?null:r)}function ka(t,e,n,r){var o=Mn();r=r===void 0?null:r;var s=void 0;if(Rt!==null){var i=Rt.memoizedState;if(s=i.destroy,r!==null&&hc(r,i.deps)){o.memoizedState=Hs(e,n,s,r);return}}ht.flags|=t,o.memoizedState=Hs(1|e,n,s,r)}function Sd(t,e){return Bi(8390656,8,t,e)}function gc(t,e){return ka(2048,8,t,e)}function Yh(t,e){return ka(4,2,t,e)}function Qh(t,e){return ka(4,4,t,e)}function Xh(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Zh(t,e,n){return n=n!=null?n.concat([t]):null,ka(4,4,Xh.bind(null,e,t),n)}function yc(){}function ep(t,e){var n=Mn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&hc(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function tp(t,e){var n=Mn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&hc(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function np(t,e,n){return ao&21?(Jn(n,e)||(n=ah(),ht.lanes|=n,lo|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,yn=!0),t.memoizedState=n)}function u0(t,e){var n=Qe;Qe=n!==0&&4>n?n:4,t(!0);var r=al.transition;al.transition={};try{t(!1),e()}finally{Qe=n,al.transition=r}}function rp(){return Mn().memoizedState}function c0(t,e,n){var r=Mr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},op(t))sp(e,n);else if(n=Bh(t,e,n,r),n!==null){var o=tn();Kn(n,t,r,o),ip(n,e,r)}}function d0(t,e,n){var r=Mr(t),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(op(t))sp(e,o);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var i=e.lastRenderedState,l=s(i,n);if(o.hasEagerState=!0,o.eagerState=l,Jn(l,i)){var u=e.interleaved;u===null?(o.next=o,lc(e)):(o.next=u.next,u.next=o),e.interleaved=o;return}}catch{}finally{}n=Bh(t,e,o,r),n!==null&&(o=tn(),Kn(n,t,r,o),ip(n,e,r))}}function op(t){var e=t.alternate;return t===ht||e!==null&&e===ht}function sp(t,e){_s=aa=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function ip(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Ku(t,n)}}var la={readContext:In,useCallback:Gt,useContext:Gt,useEffect:Gt,useImperativeHandle:Gt,useInsertionEffect:Gt,useLayoutEffect:Gt,useMemo:Gt,useReducer:Gt,useRef:Gt,useState:Gt,useDebugValue:Gt,useDeferredValue:Gt,useTransition:Gt,useMutableSource:Gt,useSyncExternalStore:Gt,useId:Gt,unstable_isNewReconciler:!1},f0={readContext:In,useCallback:function(t,e){return er().memoizedState=[t,e===void 0?null:e],t},useContext:In,useEffect:Sd,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Bi(4194308,4,Xh.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Bi(4194308,4,t,e)},useInsertionEffect:function(t,e){return Bi(4,2,t,e)},useMemo:function(t,e){var n=er();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=er();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=c0.bind(null,ht,t),[r.memoizedState,t]},useRef:function(t){var e=er();return t={current:t},e.memoizedState=t},useState:wd,useDebugValue:yc,useDeferredValue:function(t){return er().memoizedState=t},useTransition:function(){var t=wd(!1),e=t[0];return t=u0.bind(null,t[1]),er().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ht,o=er();if(dt){if(n===void 0)throw Error(U(407));n=n()}else{if(n=e(),$t===null)throw Error(U(349));ao&30||Vh(r,e,n)}o.memoizedState=n;var s={value:n,getSnapshot:e};return o.queue=s,Sd(qh.bind(null,r,s,t),[t]),r.flags|=2048,Hs(9,Gh.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=er(),e=$t.identifierPrefix;if(dt){var n=dr,r=cr;n=(r&~(1<<32-Hn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Gs++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=l0++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},h0={readContext:In,useCallback:ep,useContext:In,useEffect:gc,useImperativeHandle:Zh,useInsertionEffect:Yh,useLayoutEffect:Qh,useMemo:tp,useReducer:ll,useRef:Jh,useState:function(){return ll(qs)},useDebugValue:yc,useDeferredValue:function(t){var e=Mn();return np(e,Rt.memoizedState,t)},useTransition:function(){var t=ll(qs)[0],e=Mn().memoizedState;return[t,e]},useMutableSource:zh,useSyncExternalStore:Wh,useId:rp,unstable_isNewReconciler:!1},p0={readContext:In,useCallback:ep,useContext:In,useEffect:gc,useImperativeHandle:Zh,useInsertionEffect:Yh,useLayoutEffect:Qh,useMemo:tp,useReducer:ul,useRef:Jh,useState:function(){return ul(qs)},useDebugValue:yc,useDeferredValue:function(t){var e=Mn();return Rt===null?e.memoizedState=t:np(e,Rt.memoizedState,t)},useTransition:function(){var t=ul(qs)[0],e=Mn().memoizedState;return[t,e]},useMutableSource:zh,useSyncExternalStore:Wh,useId:rp,unstable_isNewReconciler:!1};function zn(t,e){if(t&&t.defaultProps){e=pt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function ou(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:pt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Ea={isMounted:function(t){return(t=t._reactInternals)?po(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=tn(),o=Mr(t),s=hr(r,o);s.payload=e,n!=null&&(s.callback=n),e=$r(t,s,o),e!==null&&(Kn(e,t,o,r),Ii(e,t,o))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=tn(),o=Mr(t),s=hr(r,o);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=$r(t,s,o),e!==null&&(Kn(e,t,o,r),Ii(e,t,o))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=tn(),r=Mr(t),o=hr(n,r);o.tag=2,e!=null&&(o.callback=e),e=$r(t,o,r),e!==null&&(Kn(e,t,r,n),Ii(e,t,r))}};function _d(t,e,n,r,o,s,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,i):e.prototype&&e.prototype.isPureReactComponent?!Bs(n,r)||!Bs(o,s):!0}function ap(t,e,n){var r=!1,o=Fr,s=e.contextType;return typeof s=="object"&&s!==null?s=In(s):(o=xn(e)?so:Kt.current,r=e.contextTypes,s=(r=r!=null)?Vo(t,o):Fr),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ea,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=o,t.__reactInternalMemoizedMaskedChildContext=s),e}function kd(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Ea.enqueueReplaceState(e,e.state,null)}function su(t,e,n,r){var o=t.stateNode;o.props=n,o.state=t.memoizedState,o.refs={},uc(t);var s=e.contextType;typeof s=="object"&&s!==null?o.context=In(s):(s=xn(e)?so:Kt.current,o.context=Vo(t,s)),o.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(ou(t,e,s,n),o.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(e=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),e!==o.state&&Ea.enqueueReplaceState(o,o.state,null),sa(t,n,o,r),o.state=t.memoizedState),typeof o.componentDidMount=="function"&&(t.flags|=4194308)}function Ko(t,e){try{var n="",r=e;do n+=zm(r),r=r.return;while(r);var o=n}catch(s){o=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:o,digest:null}}function cl(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function iu(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var m0=typeof WeakMap=="function"?WeakMap:Map;function lp(t,e,n){n=hr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){ca||(ca=!0,gu=r),iu(t,e)},n}function up(t,e,n){n=hr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var o=e.value;n.payload=function(){return r(o)},n.callback=function(){iu(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){iu(t,e),typeof r!="function"&&(Ir===null?Ir=new Set([this]):Ir.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),n}function Ed(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new m0;var o=new Set;r.set(e,o)}else o=r.get(e),o===void 0&&(o=new Set,r.set(e,o));o.has(n)||(o.add(n),t=N0.bind(null,t,e,n),e.then(t,t))}function jd(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Cd(t,e,n,r,o){return t.mode&1?(t.flags|=65536,t.lanes=o,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=hr(-1,1),e.tag=2,$r(n,e,1))),n.lanes|=1),t)}var g0=xr.ReactCurrentOwner,yn=!1;function Xt(t,e,n,r){e.child=t===null?Mh(e,null,n,r):qo(e,t.child,n,r)}function Rd(t,e,n,r,o){n=n.render;var s=e.ref;return Fo(e,o),r=pc(t,e,n,r,s,o),n=mc(),t!==null&&!yn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~o,yr(t,e,o)):(dt&&n&&nc(e),e.flags|=1,Xt(t,e,r,o),e.child)}function Nd(t,e,n,r,o){if(t===null){var s=n.type;return typeof s=="function"&&!Ec(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,cp(t,e,s,r,o)):(t=Wi(n.type,null,r,e,e.mode,o),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&o)){var i=s.memoizedProps;if(n=n.compare,n=n!==null?n:Bs,n(i,r)&&t.ref===e.ref)return yr(t,e,o)}return e.flags|=1,t=Br(s,r),t.ref=e.ref,t.return=e,e.child=t}function cp(t,e,n,r,o){if(t!==null){var s=t.memoizedProps;if(Bs(s,r)&&t.ref===e.ref)if(yn=!1,e.pendingProps=r=s,(t.lanes&o)!==0)t.flags&131072&&(yn=!0);else return e.lanes=t.lanes,yr(t,e,o)}return au(t,e,n,r,o)}function dp(t,e,n){var r=e.pendingProps,o=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ot($o,_n),_n|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ot($o,_n),_n|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,ot($o,_n),_n|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,ot($o,_n),_n|=r;return Xt(t,e,o,n),e.child}function fp(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function au(t,e,n,r,o){var s=xn(n)?so:Kt.current;return s=Vo(e,s),Fo(e,o),n=pc(t,e,n,r,s,o),r=mc(),t!==null&&!yn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~o,yr(t,e,o)):(dt&&r&&nc(e),e.flags|=1,Xt(t,e,n,o),e.child)}function Dd(t,e,n,r,o){if(xn(n)){var s=!0;ea(e)}else s=!1;if(Fo(e,o),e.stateNode===null)Ui(t,e),ap(e,n,r),su(e,n,r,o),r=!0;else if(t===null){var i=e.stateNode,l=e.memoizedProps;i.props=l;var u=i.context,c=n.contextType;typeof c=="object"&&c!==null?c=In(c):(c=xn(n)?so:Kt.current,c=Vo(e,c));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";h||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==r||u!==c)&&kd(e,i,r,c),jr=!1;var f=e.memoizedState;i.state=f,sa(e,r,i,o),u=e.memoizedState,l!==r||f!==u||vn.current||jr?(typeof d=="function"&&(ou(e,n,d,r),u=e.memoizedState),(l=jr||_d(e,n,l,r,f,u,c))?(h||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),i.props=r,i.state=u,i.context=c,r=l):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{i=e.stateNode,Uh(t,e),l=e.memoizedProps,c=e.type===e.elementType?l:zn(e.type,l),i.props=c,h=e.pendingProps,f=i.context,u=n.contextType,typeof u=="object"&&u!==null?u=In(u):(u=xn(n)?so:Kt.current,u=Vo(e,u));var x=n.getDerivedStateFromProps;(d=typeof x=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==h||f!==u)&&kd(e,i,r,u),jr=!1,f=e.memoizedState,i.state=f,sa(e,r,i,o);var y=e.memoizedState;l!==h||f!==y||vn.current||jr?(typeof x=="function"&&(ou(e,n,x,r),y=e.memoizedState),(c=jr||_d(e,n,c,r,f,y,u)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,y,u),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,y,u)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=y),i.props=r,i.state=y,i.context=u,r=c):(typeof i.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return lu(t,e,n,r,s,o)}function lu(t,e,n,r,o,s){fp(t,e);var i=(e.flags&128)!==0;if(!r&&!i)return o&&md(e,n,!1),yr(t,e,s);r=e.stateNode,g0.current=e;var l=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&i?(e.child=qo(e,t.child,null,s),e.child=qo(e,null,l,s)):Xt(t,e,l,s),e.memoizedState=r.state,o&&md(e,n,!0),e.child}function hp(t){var e=t.stateNode;e.pendingContext?pd(t,e.pendingContext,e.pendingContext!==e.context):e.context&&pd(t,e.context,!1),cc(t,e.containerInfo)}function Ad(t,e,n,r,o){return Go(),oc(o),e.flags|=256,Xt(t,e,n,r),e.child}var uu={dehydrated:null,treeContext:null,retryLane:0};function cu(t){return{baseLanes:t,cachePool:null,transitions:null}}function pp(t,e,n){var r=e.pendingProps,o=ft.current,s=!1,i=(e.flags&128)!==0,l;if((l=i)||(l=t!==null&&t.memoizedState===null?!1:(o&2)!==0),l?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(o|=1),ot(ft,o&1),t===null)return nu(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=r.children,t=r.fallback,s?(r=e.mode,s=e.child,i={mode:"hidden",children:i},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=Ra(i,r,0,null),t=oo(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=cu(n),e.memoizedState=uu,t):vc(e,i));if(o=t.memoizedState,o!==null&&(l=o.dehydrated,l!==null))return y0(t,e,i,r,l,o,n);if(s){s=r.fallback,i=e.mode,o=t.child,l=o.sibling;var u={mode:"hidden",children:r.children};return!(i&1)&&e.child!==o?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Br(o,u),r.subtreeFlags=o.subtreeFlags&14680064),l!==null?s=Br(l,s):(s=oo(s,i,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,i=t.child.memoizedState,i=i===null?cu(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=t.childLanes&~n,e.memoizedState=uu,r}return s=t.child,t=s.sibling,r=Br(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function vc(t,e){return e=Ra({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function xi(t,e,n,r){return r!==null&&oc(r),qo(e,t.child,null,n),t=vc(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function y0(t,e,n,r,o,s,i){if(n)return e.flags&256?(e.flags&=-257,r=cl(Error(U(422))),xi(t,e,i,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,o=e.mode,r=Ra({mode:"visible",children:r.children},o,0,null),s=oo(s,o,i,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&qo(e,t.child,null,i),e.child.memoizedState=cu(i),e.memoizedState=uu,s);if(!(e.mode&1))return xi(t,e,i,null);if(o.data==="$!"){if(r=o.nextSibling&&o.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error(U(419)),r=cl(s,r,void 0),xi(t,e,i,r)}if(l=(i&t.childLanes)!==0,yn||l){if(r=$t,r!==null){switch(i&-i){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(r.suspendedLanes|i)?0:o,o!==0&&o!==s.retryLane&&(s.retryLane=o,gr(t,o),Kn(r,t,o,-1))}return kc(),r=cl(Error(U(421))),xi(t,e,i,r)}return o.data==="$?"?(e.flags|=128,e.child=t.child,e=D0.bind(null,t),o._reactRetry=e,null):(t=s.treeContext,kn=Lr(o.nextSibling),En=e,dt=!0,Gn=null,t!==null&&(On[Tn++]=cr,On[Tn++]=dr,On[Tn++]=io,cr=t.id,dr=t.overflow,io=e),e=vc(e,r.children),e.flags|=4096,e)}function Od(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),ru(t.return,e,n)}function dl(t,e,n,r,o){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=o)}function mp(t,e,n){var r=e.pendingProps,o=r.revealOrder,s=r.tail;if(Xt(t,e,r.children,n),r=ft.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Od(t,n,e);else if(t.tag===19)Od(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(ot(ft,r),!(e.mode&1))e.memoizedState=null;else switch(o){case"forwards":for(n=e.child,o=null;n!==null;)t=n.alternate,t!==null&&ia(t)===null&&(o=n),n=n.sibling;n=o,n===null?(o=e.child,e.child=null):(o=n.sibling,n.sibling=null),dl(e,!1,o,n,s);break;case"backwards":for(n=null,o=e.child,e.child=null;o!==null;){if(t=o.alternate,t!==null&&ia(t)===null){e.child=o;break}t=o.sibling,o.sibling=n,n=o,o=t}dl(e,!0,n,null,s);break;case"together":dl(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Ui(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function yr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),lo|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(U(153));if(e.child!==null){for(t=e.child,n=Br(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Br(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function v0(t,e,n){switch(e.tag){case 3:hp(e),Go();break;case 5:Fh(e);break;case 1:xn(e.type)&&ea(e);break;case 4:cc(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,o=e.memoizedProps.value;ot(ra,r._currentValue),r._currentValue=o;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(ot(ft,ft.current&1),e.flags|=128,null):n&e.child.childLanes?pp(t,e,n):(ot(ft,ft.current&1),t=yr(t,e,n),t!==null?t.sibling:null);ot(ft,ft.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return mp(t,e,n);e.flags|=128}if(o=e.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),ot(ft,ft.current),r)break;return null;case 22:case 23:return e.lanes=0,dp(t,e,n)}return yr(t,e,n)}var gp,du,yp,vp;gp=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};du=function(){};yp=function(t,e,n,r){var o=t.memoizedProps;if(o!==r){t=e.stateNode,no(sr.current);var s=null;switch(n){case"input":o=Tl(t,o),r=Tl(t,r),s=[];break;case"select":o=pt({},o,{value:void 0}),r=pt({},r,{value:void 0}),s=[];break;case"textarea":o=$l(t,o),r=$l(t,r),s=[];break;default:typeof o.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Xi)}Ml(n,r);var i;n=null;for(c in o)if(!r.hasOwnProperty(c)&&o.hasOwnProperty(c)&&o[c]!=null)if(c==="style"){var l=o[c];for(i in l)l.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Os.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var u=r[c];if(l=o!=null?o[c]:void 0,r.hasOwnProperty(c)&&u!==l&&(u!=null||l!=null))if(c==="style")if(l){for(i in l)!l.hasOwnProperty(i)||u&&u.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in u)u.hasOwnProperty(i)&&l[i]!==u[i]&&(n||(n={}),n[i]=u[i])}else n||(s||(s=[]),s.push(c,n)),n=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(s=s||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(s=s||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Os.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&at("scroll",t),s||l===u||(s=[])):(s=s||[]).push(c,u))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};vp=function(t,e,n,r){n!==r&&(e.flags|=4)};function us(t,e){if(!dt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function qt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var o=t.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags&14680064,r|=o.flags&14680064,o.return=t,o=o.sibling;else for(o=t.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=t,o=o.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function x0(t,e,n){var r=e.pendingProps;switch(rc(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qt(e),null;case 1:return xn(e.type)&&Zi(),qt(e),null;case 3:return r=e.stateNode,Ho(),lt(vn),lt(Kt),fc(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(yi(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Gn!==null&&(xu(Gn),Gn=null))),du(t,e),qt(e),null;case 5:dc(e);var o=no(Vs.current);if(n=e.type,t!==null&&e.stateNode!=null)yp(t,e,n,r,o),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(U(166));return qt(e),null}if(t=no(sr.current),yi(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[nr]=e,r[zs]=s,t=(e.mode&1)!==0,n){case"dialog":at("cancel",r),at("close",r);break;case"iframe":case"object":case"embed":at("load",r);break;case"video":case"audio":for(o=0;o<gs.length;o++)at(gs[o],r);break;case"source":at("error",r);break;case"img":case"image":case"link":at("error",r),at("load",r);break;case"details":at("toggle",r);break;case"input":Fc(r,s),at("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},at("invalid",r);break;case"textarea":Wc(r,s),at("invalid",r)}Ml(n,s),o=null;for(var i in s)if(s.hasOwnProperty(i)){var l=s[i];i==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&gi(r.textContent,l,t),o=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&gi(r.textContent,l,t),o=["children",""+l]):Os.hasOwnProperty(i)&&l!=null&&i==="onScroll"&&at("scroll",r)}switch(n){case"input":li(r),zc(r,s,!0);break;case"textarea":li(r),Vc(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Xi)}r=o,e.updateQueue=r,r!==null&&(e.flags|=4)}else{i=o.nodeType===9?o:o.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=qf(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=i.createElement(n,{is:r.is}):(t=i.createElement(n),n==="select"&&(i=t,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):t=i.createElementNS(t,n),t[nr]=e,t[zs]=r,gp(t,e,!1,!1),e.stateNode=t;e:{switch(i=Bl(n,r),n){case"dialog":at("cancel",t),at("close",t),o=r;break;case"iframe":case"object":case"embed":at("load",t),o=r;break;case"video":case"audio":for(o=0;o<gs.length;o++)at(gs[o],t);o=r;break;case"source":at("error",t),o=r;break;case"img":case"image":case"link":at("error",t),at("load",t),o=r;break;case"details":at("toggle",t),o=r;break;case"input":Fc(t,r),o=Tl(t,r),at("invalid",t);break;case"option":o=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},o=pt({},r,{value:void 0}),at("invalid",t);break;case"textarea":Wc(t,r),o=$l(t,r),at("invalid",t);break;default:o=r}Ml(n,o),l=o;for(s in l)if(l.hasOwnProperty(s)){var u=l[s];s==="style"?Jf(t,u):s==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Hf(t,u)):s==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Ts(t,u):typeof u=="number"&&Ts(t,""+u):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Os.hasOwnProperty(s)?u!=null&&s==="onScroll"&&at("scroll",t):u!=null&&zu(t,s,u,i))}switch(n){case"input":li(t),zc(t,r,!1);break;case"textarea":li(t),Vc(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ur(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Io(t,!!r.multiple,s,!1):r.defaultValue!=null&&Io(t,!!r.multiple,r.defaultValue,!0);break;default:typeof o.onClick=="function"&&(t.onclick=Xi)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return qt(e),null;case 6:if(t&&e.stateNode!=null)vp(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(U(166));if(n=no(Vs.current),no(sr.current),yi(e)){if(r=e.stateNode,n=e.memoizedProps,r[nr]=e,(s=r.nodeValue!==n)&&(t=En,t!==null))switch(t.tag){case 3:gi(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&gi(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[nr]=e,e.stateNode=r}return qt(e),null;case 13:if(lt(ft),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(dt&&kn!==null&&e.mode&1&&!(e.flags&128))$h(),Go(),e.flags|=98560,s=!1;else if(s=yi(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(U(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(U(317));s[nr]=e}else Go(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;qt(e),s=!1}else Gn!==null&&(xu(Gn),Gn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ft.current&1?Nt===0&&(Nt=3):kc())),e.updateQueue!==null&&(e.flags|=4),qt(e),null);case 4:return Ho(),du(t,e),t===null&&Us(e.stateNode.containerInfo),qt(e),null;case 10:return ac(e.type._context),qt(e),null;case 17:return xn(e.type)&&Zi(),qt(e),null;case 19:if(lt(ft),s=e.memoizedState,s===null)return qt(e),null;if(r=(e.flags&128)!==0,i=s.rendering,i===null)if(r)us(s,!1);else{if(Nt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=ia(t),i!==null){for(e.flags|=128,us(s,!1),r=i.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,t=i.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ot(ft,ft.current&1|2),e.child}t=t.sibling}s.tail!==null&&wt()>Jo&&(e.flags|=128,r=!0,us(s,!1),e.lanes=4194304)}else{if(!r)if(t=ia(i),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),us(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!dt)return qt(e),null}else 2*wt()-s.renderingStartTime>Jo&&n!==1073741824&&(e.flags|=128,r=!0,us(s,!1),e.lanes=4194304);s.isBackwards?(i.sibling=e.child,e.child=i):(n=s.last,n!==null?n.sibling=i:e.child=i,s.last=i)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=wt(),e.sibling=null,n=ft.current,ot(ft,r?n&1|2:n&1),e):(qt(e),null);case 22:case 23:return _c(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?_n&1073741824&&(qt(e),e.subtreeFlags&6&&(e.flags|=8192)):qt(e),null;case 24:return null;case 25:return null}throw Error(U(156,e.tag))}function b0(t,e){switch(rc(e),e.tag){case 1:return xn(e.type)&&Zi(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ho(),lt(vn),lt(Kt),fc(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return dc(e),null;case 13:if(lt(ft),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(U(340));Go()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return lt(ft),null;case 4:return Ho(),null;case 10:return ac(e.type._context),null;case 22:case 23:return _c(),null;case 24:return null;default:return null}}var bi=!1,Ht=!1,w0=typeof WeakSet=="function"?WeakSet:Set,ee=null;function Lo(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){xt(t,e,r)}else n.current=null}function fu(t,e,n){try{n()}catch(r){xt(t,e,r)}}var Td=!1;function S0(t,e){if(Jl=Ji,t=_h(),tc(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var o=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var i=0,l=-1,u=-1,c=0,d=0,h=t,f=null;t:for(;;){for(var x;h!==n||o!==0&&h.nodeType!==3||(l=i+o),h!==s||r!==0&&h.nodeType!==3||(u=i+r),h.nodeType===3&&(i+=h.nodeValue.length),(x=h.firstChild)!==null;)f=h,h=x;for(;;){if(h===t)break t;if(f===n&&++c===o&&(l=i),f===s&&++d===r&&(u=i),(x=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=x}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Yl={focusedElem:t,selectionRange:n},Ji=!1,ee=e;ee!==null;)if(e=ee,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ee=t;else for(;ee!==null;){e=ee;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var b=y.memoizedProps,_=y.memoizedState,p=e.stateNode,m=p.getSnapshotBeforeUpdate(e.elementType===e.type?b:zn(e.type,b),_);p.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var g=e.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(U(163))}}catch(w){xt(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,ee=t;break}ee=e.return}return y=Td,Td=!1,y}function ks(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&t)===t){var s=o.destroy;o.destroy=void 0,s!==void 0&&fu(e,n,s)}o=o.next}while(o!==r)}}function ja(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function hu(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function xp(t){var e=t.alternate;e!==null&&(t.alternate=null,xp(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[nr],delete e[zs],delete e[Zl],delete e[o0],delete e[s0])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function bp(t){return t.tag===5||t.tag===3||t.tag===4}function Pd(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||bp(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function pu(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Xi));else if(r!==4&&(t=t.child,t!==null))for(pu(t,e,n),t=t.sibling;t!==null;)pu(t,e,n),t=t.sibling}function mu(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(mu(t,e,n),t=t.sibling;t!==null;)mu(t,e,n),t=t.sibling}var Ut=null,Wn=!1;function wr(t,e,n){for(n=n.child;n!==null;)wp(t,e,n),n=n.sibling}function wp(t,e,n){if(or&&typeof or.onCommitFiberUnmount=="function")try{or.onCommitFiberUnmount(va,n)}catch{}switch(n.tag){case 5:Ht||Lo(n,e);case 6:var r=Ut,o=Wn;Ut=null,wr(t,e,n),Ut=r,Wn=o,Ut!==null&&(Wn?(t=Ut,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ut.removeChild(n.stateNode));break;case 18:Ut!==null&&(Wn?(t=Ut,n=n.stateNode,t.nodeType===8?ol(t.parentNode,n):t.nodeType===1&&ol(t,n),Is(t)):ol(Ut,n.stateNode));break;case 4:r=Ut,o=Wn,Ut=n.stateNode.containerInfo,Wn=!0,wr(t,e,n),Ut=r,Wn=o;break;case 0:case 11:case 14:case 15:if(!Ht&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){o=r=r.next;do{var s=o,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&fu(n,e,i),o=o.next}while(o!==r)}wr(t,e,n);break;case 1:if(!Ht&&(Lo(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){xt(n,e,l)}wr(t,e,n);break;case 21:wr(t,e,n);break;case 22:n.mode&1?(Ht=(r=Ht)||n.memoizedState!==null,wr(t,e,n),Ht=r):wr(t,e,n);break;default:wr(t,e,n)}}function Ld(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new w0),e.forEach(function(r){var o=A0.bind(null,t,r);n.has(r)||(n.add(r),r.then(o,o))})}}function Un(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var o=n[r];try{var s=t,i=e,l=i;e:for(;l!==null;){switch(l.tag){case 5:Ut=l.stateNode,Wn=!1;break e;case 3:Ut=l.stateNode.containerInfo,Wn=!0;break e;case 4:Ut=l.stateNode.containerInfo,Wn=!0;break e}l=l.return}if(Ut===null)throw Error(U(160));wp(s,i,o),Ut=null,Wn=!1;var u=o.alternate;u!==null&&(u.return=null),o.return=null}catch(c){xt(o,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Sp(e,t),e=e.sibling}function Sp(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Un(e,t),Xn(t),r&4){try{ks(3,t,t.return),ja(3,t)}catch(b){xt(t,t.return,b)}try{ks(5,t,t.return)}catch(b){xt(t,t.return,b)}}break;case 1:Un(e,t),Xn(t),r&512&&n!==null&&Lo(n,n.return);break;case 5:if(Un(e,t),Xn(t),r&512&&n!==null&&Lo(n,n.return),t.flags&32){var o=t.stateNode;try{Ts(o,"")}catch(b){xt(t,t.return,b)}}if(r&4&&(o=t.stateNode,o!=null)){var s=t.memoizedProps,i=n!==null?n.memoizedProps:s,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&Vf(o,s),Bl(l,i);var c=Bl(l,s);for(i=0;i<u.length;i+=2){var d=u[i],h=u[i+1];d==="style"?Jf(o,h):d==="dangerouslySetInnerHTML"?Hf(o,h):d==="children"?Ts(o,h):zu(o,d,h,c)}switch(l){case"input":Pl(o,s);break;case"textarea":Gf(o,s);break;case"select":var f=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!s.multiple;var x=s.value;x!=null?Io(o,!!s.multiple,x,!1):f!==!!s.multiple&&(s.defaultValue!=null?Io(o,!!s.multiple,s.defaultValue,!0):Io(o,!!s.multiple,s.multiple?[]:"",!1))}o[zs]=s}catch(b){xt(t,t.return,b)}}break;case 6:if(Un(e,t),Xn(t),r&4){if(t.stateNode===null)throw Error(U(162));o=t.stateNode,s=t.memoizedProps;try{o.nodeValue=s}catch(b){xt(t,t.return,b)}}break;case 3:if(Un(e,t),Xn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Is(e.containerInfo)}catch(b){xt(t,t.return,b)}break;case 4:Un(e,t),Xn(t);break;case 13:Un(e,t),Xn(t),o=t.child,o.flags&8192&&(s=o.memoizedState!==null,o.stateNode.isHidden=s,!s||o.alternate!==null&&o.alternate.memoizedState!==null||(wc=wt())),r&4&&Ld(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(Ht=(c=Ht)||d,Un(e,t),Ht=c):Un(e,t),Xn(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!d&&t.mode&1)for(ee=t,d=t.child;d!==null;){for(h=ee=d;ee!==null;){switch(f=ee,x=f.child,f.tag){case 0:case 11:case 14:case 15:ks(4,f,f.return);break;case 1:Lo(f,f.return);var y=f.stateNode;if(typeof y.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(b){xt(r,n,b)}}break;case 5:Lo(f,f.return);break;case 22:if(f.memoizedState!==null){Id(h);continue}}x!==null?(x.return=f,ee=x):Id(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{o=h.stateNode,c?(s=o.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=h.stateNode,u=h.memoizedProps.style,i=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=Kf("display",i))}catch(b){xt(t,t.return,b)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(b){xt(t,t.return,b)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Un(e,t),Xn(t),r&4&&Ld(t);break;case 21:break;default:Un(e,t),Xn(t)}}function Xn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(bp(n)){var r=n;break e}n=n.return}throw Error(U(160))}switch(r.tag){case 5:var o=r.stateNode;r.flags&32&&(Ts(o,""),r.flags&=-33);var s=Pd(t);mu(t,s,o);break;case 3:case 4:var i=r.stateNode.containerInfo,l=Pd(t);pu(t,l,i);break;default:throw Error(U(161))}}catch(u){xt(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function _0(t,e,n){ee=t,_p(t)}function _p(t,e,n){for(var r=(t.mode&1)!==0;ee!==null;){var o=ee,s=o.child;if(o.tag===22&&r){var i=o.memoizedState!==null||bi;if(!i){var l=o.alternate,u=l!==null&&l.memoizedState!==null||Ht;l=bi;var c=Ht;if(bi=i,(Ht=u)&&!c)for(ee=o;ee!==null;)i=ee,u=i.child,i.tag===22&&i.memoizedState!==null?Md(o):u!==null?(u.return=i,ee=u):Md(o);for(;s!==null;)ee=s,_p(s),s=s.sibling;ee=o,bi=l,Ht=c}$d(t)}else o.subtreeFlags&8772&&s!==null?(s.return=o,ee=s):$d(t)}}function $d(t){for(;ee!==null;){var e=ee;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ht||ja(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ht)if(n===null)r.componentDidMount();else{var o=e.elementType===e.type?n.memoizedProps:zn(e.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&bd(e,s,r);break;case 3:var i=e.updateQueue;if(i!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}bd(e,i,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Is(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(U(163))}Ht||e.flags&512&&hu(e)}catch(f){xt(e,e.return,f)}}if(e===t){ee=null;break}if(n=e.sibling,n!==null){n.return=e.return,ee=n;break}ee=e.return}}function Id(t){for(;ee!==null;){var e=ee;if(e===t){ee=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ee=n;break}ee=e.return}}function Md(t){for(;ee!==null;){var e=ee;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{ja(4,e)}catch(u){xt(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var o=e.return;try{r.componentDidMount()}catch(u){xt(e,o,u)}}var s=e.return;try{hu(e)}catch(u){xt(e,s,u)}break;case 5:var i=e.return;try{hu(e)}catch(u){xt(e,i,u)}}}catch(u){xt(e,e.return,u)}if(e===t){ee=null;break}var l=e.sibling;if(l!==null){l.return=e.return,ee=l;break}ee=e.return}}var k0=Math.ceil,ua=xr.ReactCurrentDispatcher,xc=xr.ReactCurrentOwner,Ln=xr.ReactCurrentBatchConfig,qe=0,$t=null,kt=null,Ft=0,_n=0,$o=Wr(0),Nt=0,Ks=null,lo=0,Ca=0,bc=0,Es=null,mn=null,wc=0,Jo=1/0,ar=null,ca=!1,gu=null,Ir=null,wi=!1,Ar=null,da=0,js=0,yu=null,Fi=-1,zi=0;function tn(){return qe&6?wt():Fi!==-1?Fi:Fi=wt()}function Mr(t){return t.mode&1?qe&2&&Ft!==0?Ft&-Ft:a0.transition!==null?(zi===0&&(zi=ah()),zi):(t=Qe,t!==0||(t=window.event,t=t===void 0?16:ph(t.type)),t):1}function Kn(t,e,n,r){if(50<js)throw js=0,yu=null,Error(U(185));Xs(t,n,r),(!(qe&2)||t!==$t)&&(t===$t&&(!(qe&2)&&(Ca|=n),Nt===4&&Rr(t,Ft)),bn(t,r),n===1&&qe===0&&!(e.mode&1)&&(Jo=wt()+500,_a&&Vr()))}function bn(t,e){var n=t.callbackNode;ag(t,e);var r=Ki(t,t===$t?Ft:0);if(r===0)n!==null&&Hc(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Hc(n),e===1)t.tag===0?i0(Bd.bind(null,t)):Th(Bd.bind(null,t)),n0(function(){!(qe&6)&&Vr()}),n=null;else{switch(lh(r)){case 1:n=Hu;break;case 4:n=sh;break;case 16:n=Hi;break;case 536870912:n=ih;break;default:n=Hi}n=Ap(n,kp.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function kp(t,e){if(Fi=-1,zi=0,qe&6)throw Error(U(327));var n=t.callbackNode;if(zo()&&t.callbackNode!==n)return null;var r=Ki(t,t===$t?Ft:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=fa(t,r);else{e=r;var o=qe;qe|=2;var s=jp();($t!==t||Ft!==e)&&(ar=null,Jo=wt()+500,ro(t,e));do try{C0();break}catch(l){Ep(t,l)}while(!0);ic(),ua.current=s,qe=o,kt!==null?e=0:($t=null,Ft=0,e=Nt)}if(e!==0){if(e===2&&(o=Vl(t),o!==0&&(r=o,e=vu(t,o))),e===1)throw n=Ks,ro(t,0),Rr(t,r),bn(t,wt()),n;if(e===6)Rr(t,r);else{if(o=t.current.alternate,!(r&30)&&!E0(o)&&(e=fa(t,r),e===2&&(s=Vl(t),s!==0&&(r=s,e=vu(t,s))),e===1))throw n=Ks,ro(t,0),Rr(t,r),bn(t,wt()),n;switch(t.finishedWork=o,t.finishedLanes=r,e){case 0:case 1:throw Error(U(345));case 2:Qr(t,mn,ar);break;case 3:if(Rr(t,r),(r&130023424)===r&&(e=wc+500-wt(),10<e)){if(Ki(t,0)!==0)break;if(o=t.suspendedLanes,(o&r)!==r){tn(),t.pingedLanes|=t.suspendedLanes&o;break}t.timeoutHandle=Xl(Qr.bind(null,t,mn,ar),e);break}Qr(t,mn,ar);break;case 4:if(Rr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,o=-1;0<r;){var i=31-Hn(r);s=1<<i,i=e[i],i>o&&(o=i),r&=~s}if(r=o,r=wt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*k0(r/1960))-r,10<r){t.timeoutHandle=Xl(Qr.bind(null,t,mn,ar),r);break}Qr(t,mn,ar);break;case 5:Qr(t,mn,ar);break;default:throw Error(U(329))}}}return bn(t,wt()),t.callbackNode===n?kp.bind(null,t):null}function vu(t,e){var n=Es;return t.current.memoizedState.isDehydrated&&(ro(t,e).flags|=256),t=fa(t,e),t!==2&&(e=mn,mn=n,e!==null&&xu(e)),t}function xu(t){mn===null?mn=t:mn.push.apply(mn,t)}function E0(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var o=n[r],s=o.getSnapshot;o=o.value;try{if(!Jn(s(),o))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Rr(t,e){for(e&=~bc,e&=~Ca,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Hn(e),r=1<<n;t[n]=-1,e&=~r}}function Bd(t){if(qe&6)throw Error(U(327));zo();var e=Ki(t,0);if(!(e&1))return bn(t,wt()),null;var n=fa(t,e);if(t.tag!==0&&n===2){var r=Vl(t);r!==0&&(e=r,n=vu(t,r))}if(n===1)throw n=Ks,ro(t,0),Rr(t,e),bn(t,wt()),n;if(n===6)throw Error(U(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Qr(t,mn,ar),bn(t,wt()),null}function Sc(t,e){var n=qe;qe|=1;try{return t(e)}finally{qe=n,qe===0&&(Jo=wt()+500,_a&&Vr())}}function uo(t){Ar!==null&&Ar.tag===0&&!(qe&6)&&zo();var e=qe;qe|=1;var n=Ln.transition,r=Qe;try{if(Ln.transition=null,Qe=1,t)return t()}finally{Qe=r,Ln.transition=n,qe=e,!(qe&6)&&Vr()}}function _c(){_n=$o.current,lt($o)}function ro(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,t0(n)),kt!==null)for(n=kt.return;n!==null;){var r=n;switch(rc(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Zi();break;case 3:Ho(),lt(vn),lt(Kt),fc();break;case 5:dc(r);break;case 4:Ho();break;case 13:lt(ft);break;case 19:lt(ft);break;case 10:ac(r.type._context);break;case 22:case 23:_c()}n=n.return}if($t=t,kt=t=Br(t.current,null),Ft=_n=e,Nt=0,Ks=null,bc=Ca=lo=0,mn=Es=null,to!==null){for(e=0;e<to.length;e++)if(n=to[e],r=n.interleaved,r!==null){n.interleaved=null;var o=r.next,s=n.pending;if(s!==null){var i=s.next;s.next=o,r.next=i}n.pending=r}to=null}return t}function Ep(t,e){do{var n=kt;try{if(ic(),Mi.current=la,aa){for(var r=ht.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}aa=!1}if(ao=0,Lt=Rt=ht=null,_s=!1,Gs=0,xc.current=null,n===null||n.return===null){Nt=1,Ks=e,kt=null;break}e:{var s=t,i=n.return,l=n,u=e;if(e=Ft,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var x=jd(i);if(x!==null){x.flags&=-257,Cd(x,i,l,s,e),x.mode&1&&Ed(s,c,e),e=x,u=c;var y=e.updateQueue;if(y===null){var b=new Set;b.add(u),e.updateQueue=b}else y.add(u);break e}else{if(!(e&1)){Ed(s,c,e),kc();break e}u=Error(U(426))}}else if(dt&&l.mode&1){var _=jd(i);if(_!==null){!(_.flags&65536)&&(_.flags|=256),Cd(_,i,l,s,e),oc(Ko(u,l));break e}}s=u=Ko(u,l),Nt!==4&&(Nt=2),Es===null?Es=[s]:Es.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var p=lp(s,u,e);xd(s,p);break e;case 1:l=u;var m=s.type,g=s.stateNode;if(!(s.flags&128)&&(typeof m.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Ir===null||!Ir.has(g)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=up(s,l,e);xd(s,w);break e}}s=s.return}while(s!==null)}Rp(n)}catch(j){e=j,kt===n&&n!==null&&(kt=n=n.return);continue}break}while(!0)}function jp(){var t=ua.current;return ua.current=la,t===null?la:t}function kc(){(Nt===0||Nt===3||Nt===2)&&(Nt=4),$t===null||!(lo&268435455)&&!(Ca&268435455)||Rr($t,Ft)}function fa(t,e){var n=qe;qe|=2;var r=jp();($t!==t||Ft!==e)&&(ar=null,ro(t,e));do try{j0();break}catch(o){Ep(t,o)}while(!0);if(ic(),qe=n,ua.current=r,kt!==null)throw Error(U(261));return $t=null,Ft=0,Nt}function j0(){for(;kt!==null;)Cp(kt)}function C0(){for(;kt!==null&&!Xm();)Cp(kt)}function Cp(t){var e=Dp(t.alternate,t,_n);t.memoizedProps=t.pendingProps,e===null?Rp(t):kt=e,xc.current=null}function Rp(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=b0(n,e),n!==null){n.flags&=32767,kt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Nt=6,kt=null;return}}else if(n=x0(n,e,_n),n!==null){kt=n;return}if(e=e.sibling,e!==null){kt=e;return}kt=e=t}while(e!==null);Nt===0&&(Nt=5)}function Qr(t,e,n){var r=Qe,o=Ln.transition;try{Ln.transition=null,Qe=1,R0(t,e,n,r)}finally{Ln.transition=o,Qe=r}return null}function R0(t,e,n,r){do zo();while(Ar!==null);if(qe&6)throw Error(U(327));n=t.finishedWork;var o=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(U(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(lg(t,s),t===$t&&(kt=$t=null,Ft=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||wi||(wi=!0,Ap(Hi,function(){return zo(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Ln.transition,Ln.transition=null;var i=Qe;Qe=1;var l=qe;qe|=4,xc.current=null,S0(t,n),Sp(n,t),Kg(Yl),Ji=!!Jl,Yl=Jl=null,t.current=n,_0(n),Zm(),qe=l,Qe=i,Ln.transition=s}else t.current=n;if(wi&&(wi=!1,Ar=t,da=o),s=t.pendingLanes,s===0&&(Ir=null),ng(n.stateNode),bn(t,wt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)o=e[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(ca)throw ca=!1,t=gu,gu=null,t;return da&1&&t.tag!==0&&zo(),s=t.pendingLanes,s&1?t===yu?js++:(js=0,yu=t):js=0,Vr(),null}function zo(){if(Ar!==null){var t=lh(da),e=Ln.transition,n=Qe;try{if(Ln.transition=null,Qe=16>t?16:t,Ar===null)var r=!1;else{if(t=Ar,Ar=null,da=0,qe&6)throw Error(U(331));var o=qe;for(qe|=4,ee=t.current;ee!==null;){var s=ee,i=s.child;if(ee.flags&16){var l=s.deletions;if(l!==null){for(var u=0;u<l.length;u++){var c=l[u];for(ee=c;ee!==null;){var d=ee;switch(d.tag){case 0:case 11:case 15:ks(8,d,s)}var h=d.child;if(h!==null)h.return=d,ee=h;else for(;ee!==null;){d=ee;var f=d.sibling,x=d.return;if(xp(d),d===c){ee=null;break}if(f!==null){f.return=x,ee=f;break}ee=x}}}var y=s.alternate;if(y!==null){var b=y.child;if(b!==null){y.child=null;do{var _=b.sibling;b.sibling=null,b=_}while(b!==null)}}ee=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,ee=i;else e:for(;ee!==null;){if(s=ee,s.flags&2048)switch(s.tag){case 0:case 11:case 15:ks(9,s,s.return)}var p=s.sibling;if(p!==null){p.return=s.return,ee=p;break e}ee=s.return}}var m=t.current;for(ee=m;ee!==null;){i=ee;var g=i.child;if(i.subtreeFlags&2064&&g!==null)g.return=i,ee=g;else e:for(i=m;ee!==null;){if(l=ee,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:ja(9,l)}}catch(j){xt(l,l.return,j)}if(l===i){ee=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,ee=w;break e}ee=l.return}}if(qe=o,Vr(),or&&typeof or.onPostCommitFiberRoot=="function")try{or.onPostCommitFiberRoot(va,t)}catch{}r=!0}return r}finally{Qe=n,Ln.transition=e}}return!1}function Ud(t,e,n){e=Ko(n,e),e=lp(t,e,1),t=$r(t,e,1),e=tn(),t!==null&&(Xs(t,1,e),bn(t,e))}function xt(t,e,n){if(t.tag===3)Ud(t,t,n);else for(;e!==null;){if(e.tag===3){Ud(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ir===null||!Ir.has(r))){t=Ko(n,t),t=up(e,t,1),e=$r(e,t,1),t=tn(),e!==null&&(Xs(e,1,t),bn(e,t));break}}e=e.return}}function N0(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=tn(),t.pingedLanes|=t.suspendedLanes&n,$t===t&&(Ft&n)===n&&(Nt===4||Nt===3&&(Ft&130023424)===Ft&&500>wt()-wc?ro(t,0):bc|=n),bn(t,e)}function Np(t,e){e===0&&(t.mode&1?(e=di,di<<=1,!(di&130023424)&&(di=4194304)):e=1);var n=tn();t=gr(t,e),t!==null&&(Xs(t,e,n),bn(t,n))}function D0(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Np(t,n)}function A0(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,o=t.memoizedState;o!==null&&(n=o.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(U(314))}r!==null&&r.delete(e),Np(t,n)}var Dp;Dp=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||vn.current)yn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return yn=!1,v0(t,e,n);yn=!!(t.flags&131072)}else yn=!1,dt&&e.flags&1048576&&Ph(e,na,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Ui(t,e),t=e.pendingProps;var o=Vo(e,Kt.current);Fo(e,n),o=pc(null,e,r,t,o,n);var s=mc();return e.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,xn(r)?(s=!0,ea(e)):s=!1,e.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,uc(e),o.updater=Ea,e.stateNode=o,o._reactInternals=e,su(e,r,t,n),e=lu(null,e,r,!0,s,n)):(e.tag=0,dt&&s&&nc(e),Xt(null,e,o,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Ui(t,e),t=e.pendingProps,o=r._init,r=o(r._payload),e.type=r,o=e.tag=T0(r),t=zn(r,t),o){case 0:e=au(null,e,r,t,n);break e;case 1:e=Dd(null,e,r,t,n);break e;case 11:e=Rd(null,e,r,t,n);break e;case 14:e=Nd(null,e,r,zn(r.type,t),n);break e}throw Error(U(306,r,""))}return e;case 0:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:zn(r,o),au(t,e,r,o,n);case 1:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:zn(r,o),Dd(t,e,r,o,n);case 3:e:{if(hp(e),t===null)throw Error(U(387));r=e.pendingProps,s=e.memoizedState,o=s.element,Uh(t,e),sa(e,r,null,n);var i=e.memoizedState;if(r=i.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){o=Ko(Error(U(423)),e),e=Ad(t,e,r,n,o);break e}else if(r!==o){o=Ko(Error(U(424)),e),e=Ad(t,e,r,n,o);break e}else for(kn=Lr(e.stateNode.containerInfo.firstChild),En=e,dt=!0,Gn=null,n=Mh(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Go(),r===o){e=yr(t,e,n);break e}Xt(t,e,r,n)}e=e.child}return e;case 5:return Fh(e),t===null&&nu(e),r=e.type,o=e.pendingProps,s=t!==null?t.memoizedProps:null,i=o.children,Ql(r,o)?i=null:s!==null&&Ql(r,s)&&(e.flags|=32),fp(t,e),Xt(t,e,i,n),e.child;case 6:return t===null&&nu(e),null;case 13:return pp(t,e,n);case 4:return cc(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=qo(e,null,r,n):Xt(t,e,r,n),e.child;case 11:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:zn(r,o),Rd(t,e,r,o,n);case 7:return Xt(t,e,e.pendingProps,n),e.child;case 8:return Xt(t,e,e.pendingProps.children,n),e.child;case 12:return Xt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,o=e.pendingProps,s=e.memoizedProps,i=o.value,ot(ra,r._currentValue),r._currentValue=i,s!==null)if(Jn(s.value,i)){if(s.children===o.children&&!vn.current){e=yr(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){i=s.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(s.tag===1){u=hr(-1,n&-n),u.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}s.lanes|=n,u=s.alternate,u!==null&&(u.lanes|=n),ru(s.return,n,e),l.lanes|=n;break}u=u.next}}else if(s.tag===10)i=s.type===e.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(U(341));i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),ru(i,n,e),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===e){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}Xt(t,e,o.children,n),e=e.child}return e;case 9:return o=e.type,r=e.pendingProps.children,Fo(e,n),o=In(o),r=r(o),e.flags|=1,Xt(t,e,r,n),e.child;case 14:return r=e.type,o=zn(r,e.pendingProps),o=zn(r.type,o),Nd(t,e,r,o,n);case 15:return cp(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:zn(r,o),Ui(t,e),e.tag=1,xn(r)?(t=!0,ea(e)):t=!1,Fo(e,n),ap(e,r,o),su(e,r,o,n),lu(null,e,r,!0,t,n);case 19:return mp(t,e,n);case 22:return dp(t,e,n)}throw Error(U(156,e.tag))};function Ap(t,e){return oh(t,e)}function O0(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Pn(t,e,n,r){return new O0(t,e,n,r)}function Ec(t){return t=t.prototype,!(!t||!t.isReactComponent)}function T0(t){if(typeof t=="function")return Ec(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Vu)return 11;if(t===Gu)return 14}return 2}function Br(t,e){var n=t.alternate;return n===null?(n=Pn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Wi(t,e,n,r,o,s){var i=2;if(r=t,typeof t=="function")Ec(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case jo:return oo(n.children,o,s,e);case Wu:i=8,o|=8;break;case Nl:return t=Pn(12,n,e,o|2),t.elementType=Nl,t.lanes=s,t;case Dl:return t=Pn(13,n,e,o),t.elementType=Dl,t.lanes=s,t;case Al:return t=Pn(19,n,e,o),t.elementType=Al,t.lanes=s,t;case Ff:return Ra(n,o,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Bf:i=10;break e;case Uf:i=9;break e;case Vu:i=11;break e;case Gu:i=14;break e;case Er:i=16,r=null;break e}throw Error(U(130,t==null?t:typeof t,""))}return e=Pn(i,n,e,o),e.elementType=t,e.type=r,e.lanes=s,e}function oo(t,e,n,r){return t=Pn(7,t,r,e),t.lanes=n,t}function Ra(t,e,n,r){return t=Pn(22,t,r,e),t.elementType=Ff,t.lanes=n,t.stateNode={isHidden:!1},t}function fl(t,e,n){return t=Pn(6,t,null,e),t.lanes=n,t}function hl(t,e,n){return e=Pn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function P0(t,e,n,r,o){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ha(0),this.expirationTimes=Ha(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ha(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function jc(t,e,n,r,o,s,i,l,u){return t=new P0(t,e,n,l,u),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Pn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},uc(s),t}function L0(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Eo,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Op(t){if(!t)return Fr;t=t._reactInternals;e:{if(po(t)!==t||t.tag!==1)throw Error(U(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(xn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(U(171))}if(t.tag===1){var n=t.type;if(xn(n))return Oh(t,n,e)}return e}function Tp(t,e,n,r,o,s,i,l,u){return t=jc(n,r,!0,t,o,s,i,l,u),t.context=Op(null),n=t.current,r=tn(),o=Mr(n),s=hr(r,o),s.callback=e??null,$r(n,s,o),t.current.lanes=o,Xs(t,o,r),bn(t,r),t}function Na(t,e,n,r){var o=e.current,s=tn(),i=Mr(o);return n=Op(n),e.context===null?e.context=n:e.pendingContext=n,e=hr(s,i),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=$r(o,e,i),t!==null&&(Kn(t,o,i,s),Ii(t,o,i)),i}function ha(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Fd(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Cc(t,e){Fd(t,e),(t=t.alternate)&&Fd(t,e)}function $0(){return null}var Pp=typeof reportError=="function"?reportError:function(t){console.error(t)};function Rc(t){this._internalRoot=t}Da.prototype.render=Rc.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(U(409));Na(t,e,null,null)};Da.prototype.unmount=Rc.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;uo(function(){Na(null,t,null,null)}),e[mr]=null}};function Da(t){this._internalRoot=t}Da.prototype.unstable_scheduleHydration=function(t){if(t){var e=dh();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Cr.length&&e!==0&&e<Cr[n].priority;n++);Cr.splice(n,0,t),n===0&&hh(t)}};function Nc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Aa(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function zd(){}function I0(t,e,n,r,o){if(o){if(typeof r=="function"){var s=r;r=function(){var c=ha(i);s.call(c)}}var i=Tp(e,r,t,0,null,!1,!1,"",zd);return t._reactRootContainer=i,t[mr]=i.current,Us(t.nodeType===8?t.parentNode:t),uo(),i}for(;o=t.lastChild;)t.removeChild(o);if(typeof r=="function"){var l=r;r=function(){var c=ha(u);l.call(c)}}var u=jc(t,0,!1,null,null,!1,!1,"",zd);return t._reactRootContainer=u,t[mr]=u.current,Us(t.nodeType===8?t.parentNode:t),uo(function(){Na(e,u,n,r)}),u}function Oa(t,e,n,r,o){var s=n._reactRootContainer;if(s){var i=s;if(typeof o=="function"){var l=o;o=function(){var u=ha(i);l.call(u)}}Na(e,i,t,o)}else i=I0(n,e,t,o,r);return ha(i)}uh=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ms(e.pendingLanes);n!==0&&(Ku(e,n|1),bn(e,wt()),!(qe&6)&&(Jo=wt()+500,Vr()))}break;case 13:uo(function(){var r=gr(t,1);if(r!==null){var o=tn();Kn(r,t,1,o)}}),Cc(t,1)}};Ju=function(t){if(t.tag===13){var e=gr(t,134217728);if(e!==null){var n=tn();Kn(e,t,134217728,n)}Cc(t,134217728)}};ch=function(t){if(t.tag===13){var e=Mr(t),n=gr(t,e);if(n!==null){var r=tn();Kn(n,t,e,r)}Cc(t,e)}};dh=function(){return Qe};fh=function(t,e){var n=Qe;try{return Qe=t,e()}finally{Qe=n}};Fl=function(t,e,n){switch(e){case"input":if(Pl(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var o=Sa(r);if(!o)throw Error(U(90));Wf(r),Pl(r,o)}}}break;case"textarea":Gf(t,n);break;case"select":e=n.value,e!=null&&Io(t,!!n.multiple,e,!1)}};Xf=Sc;Zf=uo;var M0={usingClientEntryPoint:!1,Events:[ei,Do,Sa,Yf,Qf,Sc]},cs={findFiberByHostInstance:eo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},B0={bundleType:cs.bundleType,version:cs.version,rendererPackageName:cs.rendererPackageName,rendererConfig:cs.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:xr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=nh(t),t===null?null:t.stateNode},findFiberByHostInstance:cs.findFiberByHostInstance||$0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Si=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Si.isDisabled&&Si.supportsFiber)try{va=Si.inject(B0),or=Si}catch{}}Cn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M0;Cn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Nc(e))throw Error(U(200));return L0(t,e,null,n)};Cn.createRoot=function(t,e){if(!Nc(t))throw Error(U(299));var n=!1,r="",o=Pp;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(o=e.onRecoverableError)),e=jc(t,1,!1,null,null,n,!1,r,o),t[mr]=e.current,Us(t.nodeType===8?t.parentNode:t),new Rc(e)};Cn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(U(188)):(t=Object.keys(t).join(","),Error(U(268,t)));return t=nh(e),t=t===null?null:t.stateNode,t};Cn.flushSync=function(t){return uo(t)};Cn.hydrate=function(t,e,n){if(!Aa(e))throw Error(U(200));return Oa(null,t,e,!0,n)};Cn.hydrateRoot=function(t,e,n){if(!Nc(t))throw Error(U(405));var r=n!=null&&n.hydratedSources||null,o=!1,s="",i=Pp;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),e=Tp(e,null,t,1,n??null,o,!1,s,i),t[mr]=e.current,Us(t),r)for(t=0;t<r.length;t++)n=r[t],o=n._getVersion,o=o(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,o]:e.mutableSourceEagerHydrationData.push(n,o);return new Da(e)};Cn.render=function(t,e,n){if(!Aa(e))throw Error(U(200));return Oa(null,t,e,!1,n)};Cn.unmountComponentAtNode=function(t){if(!Aa(t))throw Error(U(40));return t._reactRootContainer?(uo(function(){Oa(null,null,t,!1,function(){t._reactRootContainer=null,t[mr]=null})}),!0):!1};Cn.unstable_batchedUpdates=Sc;Cn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Aa(n))throw Error(U(200));if(t==null||t._reactInternals===void 0)throw Error(U(38));return Oa(t,e,n,!1,r)};Cn.version="18.3.1-next-f1338f8080-20240426";function Lp(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Lp)}catch(t){console.error(t)}}Lp(),Lf.exports=Cn;var U0=Lf.exports,Wd=U0;Cl.createRoot=Wd.createRoot,Cl.hydrateRoot=Wd.hydrateRoot;const F0="modulepreload",z0=function(t){return"/"+t},Vd={},ni=function(e,n,r){let o=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));o=Promise.allSettled(n.map(u=>{if(u=z0(u),u in Vd)return;Vd[u]=!0;const c=u.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":F0,c||(h.as="script"),h.crossOrigin="",h.href=u,l&&h.setAttribute("nonce",l),document.head.appendChild(h),c)return new Promise((f,x)=>{h.addEventListener("load",f),h.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return o.then(i=>{for(const l of i||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})},W0=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>ni(async()=>{const{default:r}=await Promise.resolve().then(()=>es);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)};class Dc extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class V0 extends Dc{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Gd extends Dc{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class qd extends Dc{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var bu;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(bu||(bu={}));var G0=function(t,e,n,r){function o(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?s(d.value):o(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};class q0{constructor(e,{headers:n={},customFetch:r,region:o=bu.Any}={}){this.url=e,this.headers=n,this.region=o,this.fetch=W0(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var r;return G0(this,void 0,void 0,function*(){try{const{headers:o,method:s,body:i}=n;let l={},{region:u}=n;u||(u=this.region);const c=new URL(`${this.url}/${e}`);u&&u!=="any"&&(l["x-region"]=u,c.searchParams.set("forceFunctionRegion",u));let d;i&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",d=i):typeof i=="string"?(l["Content-Type"]="text/plain",d=i):typeof FormData<"u"&&i instanceof FormData?d=i:(l["Content-Type"]="application/json",d=JSON.stringify(i)));const h=yield this.fetch(c.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),o),body:d}).catch(b=>{throw new V0(b)}),f=h.headers.get("x-relay-error");if(f&&f==="true")throw new Gd(h);if(!h.ok)throw new qd(h);let x=((r=h.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),y;return x==="application/json"?y=yield h.json():x==="application/octet-stream"?y=yield h.blob():x==="text/event-stream"?y=h:x==="multipart/form-data"?y=yield h.formData():y=yield h.text(),{data:y,error:null,response:h}}catch(o){return{data:null,error:o,response:o instanceof qd||o instanceof Gd?o.context:void 0}}})}}var gn={},Ac={},Ta={},ri={},Pa={},La={},H0=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Yo=H0();const K0=Yo.fetch,$p=Yo.fetch.bind(Yo),Ip=Yo.Headers,J0=Yo.Request,Y0=Yo.Response,es=Object.freeze(Object.defineProperty({__proto__:null,Headers:Ip,Request:J0,Response:Y0,default:$p,fetch:K0},Symbol.toStringTag,{value:"Module"})),Q0=pm(es);var $a={};Object.defineProperty($a,"__esModule",{value:!0});let X0=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};$a.default=X0;var Mp=$n&&$n.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(La,"__esModule",{value:!0});const Z0=Mp(Q0),ey=Mp($a);let ty=class{constructor(e){var n,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(n=e.shouldThrowOnError)!==null&&n!==void 0?n:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Z0.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,n){return this.headers=new Headers(this.headers),this.headers.set(e,n),this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const r=this.fetch;let o=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var i,l,u,c;let d=null,h=null,f=null,x=s.status,y=s.statusText;if(s.ok){if(this.method!=="HEAD"){const m=await s.text();m===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((i=this.headers.get("Accept"))===null||i===void 0)&&i.includes("application/vnd.pgrst.plan+text"))?h=m:h=JSON.parse(m))}const _=(l=this.headers.get("Prefer"))===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),p=(u=s.headers.get("content-range"))===null||u===void 0?void 0:u.split("/");_&&p&&p.length>1&&(f=parseInt(p[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(h)&&(h.length>1?(d={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,f=null,x=406,y="Not Acceptable"):h.length===1?h=h[0]:h=null)}else{const _=await s.text();try{d=JSON.parse(_),Array.isArray(d)&&s.status===404&&(h=[],d=null,x=200,y="OK")}catch{s.status===404&&_===""?(x=204,y="No Content"):d={message:_}}if(d&&this.isMaybeSingle&&(!((c=d==null?void 0:d.details)===null||c===void 0)&&c.includes("0 rows"))&&(d=null,x=200,y="OK"),d&&this.shouldThrowOnError)throw new ey.default(d)}return{error:d,data:h,count:f,status:x,statusText:y}});return this.shouldThrowOnError||(o=o.catch(s=>{var i,l,u;return{error:{message:`${(i=s==null?void 0:s.name)!==null&&i!==void 0?i:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(l=s==null?void 0:s.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(u=s==null?void 0:s.code)!==null&&u!==void 0?u:""}`},data:null,count:null,status:0,statusText:""}})),o.then(e,n)}returns(){return this}overrideTypes(){return this}};La.default=ty;var ny=$n&&$n.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Pa,"__esModule",{value:!0});const ry=ny(La);let oy=class extends ry.default{select(e){let n=!1;const r=(e??"*").split("").map(o=>/\s/.test(o)&&!n?"":(o==='"'&&(n=!n),o)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:n=!0,nullsFirst:r,foreignTable:o,referencedTable:s=o}={}){const i=s?`${s}.order`:"order",l=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${l?`${l},`:""}${e}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:r=n}={}){const o=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(o,`${e}`),this}range(e,n,{foreignTable:r,referencedTable:o=r}={}){const s=typeof o>"u"?"offset":`${o}.offset`,i=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(i,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:n=!1,settings:r=!1,buffers:o=!1,wal:s=!1,format:i="text"}={}){var l;const u=[e?"analyze":null,n?"verbose":null,r?"settings":null,o?"buffers":null,s?"wal":null].filter(Boolean).join("|"),c=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${c}"; options=${u};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};Pa.default=oy;var sy=$n&&$n.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ri,"__esModule",{value:!0});const iy=sy(Pa);let ay=class extends iy.default{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const r=Array.from(new Set(n)).map(o=>typeof o=="string"&&new RegExp("[,()]").test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:r,type:o}={}){let s="";o==="plain"?s="pl":o==="phrase"?s="ph":o==="websearch"&&(s="w");const i=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${s}fts${i}.${n}`),this}match(e){return Object.entries(e).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(e,n,r){return this.url.searchParams.append(e,`not.${n}.${r}`),this}or(e,{foreignTable:n,referencedTable:r=n}={}){const o=r?`${r}.or`:"or";return this.url.searchParams.append(o,`(${e})`),this}filter(e,n,r){return this.url.searchParams.append(e,`${n}.${r}`),this}};ri.default=ay;var ly=$n&&$n.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ta,"__esModule",{value:!0});const ds=ly(ri);let uy=class{constructor(e,{headers:n={},schema:r,fetch:o}){this.url=e,this.headers=new Headers(n),this.schema=r,this.fetch=o}select(e,{head:n=!1,count:r}={}){const o=n?"HEAD":"GET";let s=!1;const i=(e??"*").split("").map(l=>/\s/.test(l)&&!s?"":(l==='"'&&(s=!s),l)).join("");return this.url.searchParams.set("select",i),r&&this.headers.append("Prefer",`count=${r}`),new ds.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:n,defaultToNull:r=!0}={}){var o;const s="POST";if(n&&this.headers.append("Prefer",`count=${n}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const i=e.reduce((l,u)=>l.concat(Object.keys(u)),[]);if(i.length>0){const l=[...new Set(i)].map(u=>`"${u}"`);this.url.searchParams.set("columns",l.join(","))}}return new ds.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}upsert(e,{onConflict:n,ignoreDuplicates:r=!1,count:o,defaultToNull:s=!0}={}){var i;const l="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),n!==void 0&&this.url.searchParams.set("on_conflict",n),o&&this.headers.append("Prefer",`count=${o}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const u=e.reduce((c,d)=>c.concat(Object.keys(d)),[]);if(u.length>0){const c=[...new Set(u)].map(d=>`"${d}"`);this.url.searchParams.set("columns",c.join(","))}}return new ds.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(e,{count:n}={}){var r;const o="PATCH";return n&&this.headers.append("Prefer",`count=${n}`),new ds.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var n;const r="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new ds.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}};Ta.default=uy;var Bp=$n&&$n.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ac,"__esModule",{value:!0});const cy=Bp(Ta),dy=Bp(ri);let fy=class Up{constructor(e,{headers:n={},schema:r,fetch:o}={}){this.url=e,this.headers=new Headers(n),this.schemaName=r,this.fetch=o}from(e){const n=new URL(`${this.url}/${e}`);return new cy.default(n,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Up(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:r=!1,get:o=!1,count:s}={}){var i;let l;const u=new URL(`${this.url}/rpc/${e}`);let c;r||o?(l=r?"HEAD":"GET",Object.entries(n).filter(([h,f])=>f!==void 0).map(([h,f])=>[h,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([h,f])=>{u.searchParams.append(h,f)})):(l="POST",c=n);const d=new Headers(this.headers);return s&&d.set("Prefer",`count=${s}`),new dy.default({method:l,url:u,headers:d,schema:this.schemaName,body:c,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};Ac.default=fy;var ts=$n&&$n.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(gn,"__esModule",{value:!0});gn.PostgrestError=gn.PostgrestBuilder=gn.PostgrestTransformBuilder=gn.PostgrestFilterBuilder=gn.PostgrestQueryBuilder=gn.PostgrestClient=void 0;const Fp=ts(Ac);gn.PostgrestClient=Fp.default;const zp=ts(Ta);gn.PostgrestQueryBuilder=zp.default;const Wp=ts(ri);gn.PostgrestFilterBuilder=Wp.default;const Vp=ts(Pa);gn.PostgrestTransformBuilder=Vp.default;const Gp=ts(La);gn.PostgrestBuilder=Gp.default;const qp=ts($a);gn.PostgrestError=qp.default;var hy=gn.default={PostgrestClient:Fp.default,PostgrestQueryBuilder:zp.default,PostgrestFilterBuilder:Wp.default,PostgrestTransformBuilder:Vp.default,PostgrestBuilder:Gp.default,PostgrestError:qp.default};const{PostgrestClient:py,PostgrestQueryBuilder:pb,PostgrestFilterBuilder:mb,PostgrestTransformBuilder:gb,PostgrestBuilder:yb,PostgrestError:vb}=hy;class my{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const r=n.node,o=parseInt(r.replace(/^v/,"").split(".")[0]);return o>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${o} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${o} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const r=this.getWebSocketConstructor();return new r(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const gy="2.15.5",yy=`realtime-js/${gy}`,vy="1.0.0",wu=1e4,xy=1e3,by=100;var Cs;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Cs||(Cs={}));var jt;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(jt||(jt={}));var Vn;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Vn||(Vn={}));var Su;(function(t){t.websocket="websocket"})(Su||(Su={}));var Zr;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Zr||(Zr={}));class wy{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const o=n.getUint8(1),s=n.getUint8(2);let i=this.HEADER_LENGTH+2;const l=r.decode(e.slice(i,i+o));i=i+o;const u=r.decode(e.slice(i,i+s));i=i+s;const c=JSON.parse(r.decode(e.slice(i,e.byteLength)));return{ref:null,topic:l,event:u,payload:c}}}class Hp{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var rt;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(rt||(rt={}));const Hd=(t,e,n={})=>{var r;const o=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((s,i)=>(s[i]=Sy(i,t,e,o),s),{})},Sy=(t,e,n,r)=>{const o=e.find(l=>l.name===t),s=o==null?void 0:o.type,i=n[t];return s&&!r.includes(s)?Kp(s,i):_u(i)},Kp=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return jy(e,n)}switch(t){case rt.bool:return _y(e);case rt.float4:case rt.float8:case rt.int2:case rt.int4:case rt.int8:case rt.numeric:case rt.oid:return ky(e);case rt.json:case rt.jsonb:return Ey(e);case rt.timestamp:return Cy(e);case rt.abstime:case rt.date:case rt.daterange:case rt.int4range:case rt.int8range:case rt.money:case rt.reltime:case rt.text:case rt.time:case rt.timestamptz:case rt.timetz:case rt.tsrange:case rt.tstzrange:return _u(e);default:return _u(e)}},_u=t=>t,_y=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},ky=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Ey=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},jy=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let s;const i=t.slice(1,n);try{s=JSON.parse("["+i+"]")}catch{s=i?i.split(","):[]}return s.map(l=>Kp(e,l))}return t},Cy=t=>typeof t=="string"?t.replace(" ","T"):t,Jp=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class pl{constructor(e,n,r={},o=wu){this.channel=e,this.event=n,this.payload=r,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Kd;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Kd||(Kd={}));class Rs{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},o=>{const{onJoin:s,onLeave:i,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Rs.syncState(this.state,o,s,i),this.pendingDiffs.forEach(u=>{this.state=Rs.syncDiff(this.state,u,s,i)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},o=>{const{onJoin:s,onLeave:i,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(o):(this.state=Rs.syncDiff(this.state,o,s,i),l())}),this.onJoin((o,s,i)=>{this.channel._trigger("presence",{event:"join",key:o,currentPresences:s,newPresences:i})}),this.onLeave((o,s,i)=>{this.channel._trigger("presence",{event:"leave",key:o,currentPresences:s,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,o){const s=this.cloneDeep(e),i=this.transformState(n),l={},u={};return this.map(s,(c,d)=>{i[c]||(u[c]=d)}),this.map(i,(c,d)=>{const h=s[c];if(h){const f=d.map(_=>_.presence_ref),x=h.map(_=>_.presence_ref),y=d.filter(_=>x.indexOf(_.presence_ref)<0),b=h.filter(_=>f.indexOf(_.presence_ref)<0);y.length>0&&(l[c]=y),b.length>0&&(u[c]=b)}else l[c]=d}),this.syncDiff(s,{joins:l,leaves:u},r,o)}static syncDiff(e,n,r,o){const{joins:s,leaves:i}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),o||(o=()=>{}),this.map(s,(l,u)=>{var c;const d=(c=e[l])!==null&&c!==void 0?c:[];if(e[l]=this.cloneDeep(u),d.length>0){const h=e[l].map(x=>x.presence_ref),f=d.filter(x=>h.indexOf(x.presence_ref)<0);e[l].unshift(...f)}r(l,d,u)}),this.map(i,(l,u)=>{let c=e[l];if(!c)return;const d=u.map(h=>h.presence_ref);c=c.filter(h=>d.indexOf(h.presence_ref)<0),e[l]=c,o(l,c,u),c.length===0&&delete e[l]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const o=e[r];return"metas"in o?n[r]=o.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):n[r]=o,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Jd;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Jd||(Jd={}));var Ns;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Ns||(Ns={}));var lr;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(lr||(lr={}));class Oc{constructor(e,n={config:{}},r){this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=jt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new pl(this,Vn.join,this.params,this.timeout),this.rejoinTimer=new Hp(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=jt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=jt.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=jt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=jt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=jt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Vn.reply,{},(o,s)=>{this._trigger(this._replyEventName(s),o)}),this.presence=new Rs(this),this.broadcastEndpointURL=Jp(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var r,o,s;if(this.socket.isConnected()||this.socket.connect(),this.state==jt.closed){const{config:{broadcast:i,presence:l,private:u}}=this.params,c=(o=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(x=>x.filter))!==null&&o!==void 0?o:[],d=!!this.bindings[Ns.PRESENCE]&&this.bindings[Ns.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,h={},f={broadcast:i,presence:Object.assign(Object.assign({},l),{enabled:d}),postgres_changes:c,private:u};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(x=>e==null?void 0:e(lr.CHANNEL_ERROR,x)),this._onClose(()=>e==null?void 0:e(lr.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:x})=>{var y;if(this.socket.setAuth(),x===void 0){e==null||e(lr.SUBSCRIBED);return}else{const b=this.bindings.postgres_changes,_=(y=b==null?void 0:b.length)!==null&&y!==void 0?y:0,p=[];for(let m=0;m<_;m++){const g=b[m],{filter:{event:w,schema:j,table:R,filter:C}}=g,S=x&&x[m];if(S&&S.event===w&&S.schema===j&&S.table===R&&S.filter===C)p.push(Object.assign(Object.assign({},g),{id:S.id}));else{this.unsubscribe(),this.state=jt.errored,e==null||e(lr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=p,e&&e(lr.SUBSCRIBED);return}}).receive("error",x=>{this.state=jt.errored,e==null||e(lr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(x).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(lr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this.state===jt.joined&&e===Ns.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,n,r)}async send(e,n={}){var r,o;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:i}=e,u={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((o=c.body)===null||o===void 0?void 0:o.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var i,l,u;const c=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((u=(l=(i=this.params)===null||i===void 0?void 0:i.config)===null||l===void 0?void 0:l.broadcast)===null||u===void 0)&&u.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=jt.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Vn.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(o=>{r=new pl(this,Vn.leave,{},e),r.receive("ok",()=>{n(),o("ok")}).receive("timeout",()=>{n(),o("timed out")}).receive("error",()=>{o("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=jt.closed,this.bindings={}}async _fetchWithTimeout(e,n,r){const o=new AbortController,s=setTimeout(()=>o.abort(),r),i=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:o.signal}));return clearTimeout(s),i}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new pl(this,e,n,r);return this._canPush()?o.send():this._addToPushBuffer(o),o}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>by){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var o,s;const i=e.toLocaleLowerCase(),{close:l,error:u,leave:c,join:d}=Vn;if(r&&[l,u,c,d].indexOf(i)>=0&&r!==this._joinRef())return;let f=this._onMessage(i,n,r);if(n&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(o=this.bindings.postgres_changes)===null||o===void 0||o.filter(x=>{var y,b,_;return((y=x.filter)===null||y===void 0?void 0:y.event)==="*"||((_=(b=x.filter)===null||b===void 0?void 0:b.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===i}).map(x=>x.callback(f,r)):(s=this.bindings[i])===null||s===void 0||s.filter(x=>{var y,b,_,p,m,g;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in x){const w=x.id,j=(y=x.filter)===null||y===void 0?void 0:y.event;return w&&((b=n.ids)===null||b===void 0?void 0:b.includes(w))&&(j==="*"||(j==null?void 0:j.toLocaleLowerCase())===((_=n.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const w=(m=(p=x==null?void 0:x.filter)===null||p===void 0?void 0:p.event)===null||m===void 0?void 0:m.toLocaleLowerCase();return w==="*"||w===((g=n==null?void 0:n.event)===null||g===void 0?void 0:g.toLocaleLowerCase())}else return x.type.toLocaleLowerCase()===i}).map(x=>{if(typeof f=="object"&&"ids"in f){const y=f.data,{schema:b,table:_,commit_timestamp:p,type:m,errors:g}=y;f=Object.assign(Object.assign({},{schema:b,table:_,commit_timestamp:p,eventType:m,new:{},old:{},errors:g}),this._getPayloadRecords(y))}x.callback(f,r)})}_isClosed(){return this.state===jt.closed}_isJoined(){return this.state===jt.joined}_isJoining(){return this.state===jt.joining}_isLeaving(){return this.state===jt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const o=e.toLocaleLowerCase(),s={type:o,filter:n,callback:r};return this.bindings[o]?this.bindings[o].push(s):this.bindings[o]=[s],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(o=>{var s;return!(((s=o.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===r&&Oc.isEqual(o.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Vn.close,{},e)}_onError(e){this._on(Vn.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=jt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=Hd(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=Hd(e.columns,e.old_record)),n}}const ml=()=>{},_i={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Ry=[1e3,2e3,5e3,1e4],Ny=1e4,Dy=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Ay{constructor(e,n){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=wu,this.transport=null,this.heartbeatIntervalMs=_i.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ml,this.ref=0,this.reconnectTimer=null,this.logger=ml,this.conn=null,this.sendBuffer=[],this.serializer=new wy,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=o=>{let s;return o?s=o:typeof fetch>"u"?s=(...i)=>ni(async()=>{const{default:l}=await Promise.resolve().then(()=>es);return{default:l}},void 0).then(({default:l})=>l(...i)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):s=fetch,(...i)=>s(...i)},!(!((r=n==null?void 0:n.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${Su.websocket}`,this.httpEndpoint=Jp(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=my.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:vy}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Cs.connecting:return Zr.Connecting;case Cs.open:return Zr.Open;case Cs.closing:return Zr.Closing;default:return Zr.Closed}}isConnected(){return this.connectionState()===Zr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const r=`realtime:${e}`,o=this.getChannels().find(s=>s.topic===r);if(o)return o;{const s=new Oc(`realtime:${e}`,n,this);return this.channels.push(s),s}}push(e){const{topic:n,event:r,payload:o,ref:s}=e,i=()=>{this.encode(e,l=>{var u;(u=this.conn)===null||u===void 0||u.send(l)})};this.log("push",`${n} ${r} (${s})`,o),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(xy,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},_i.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:o,payload:s,ref:i}=n,l=i?`(${i})`:"",u=s.status||"";this.log("receive",`${u} ${r} ${o} ${l}`.trim(),s),this.channels.filter(c=>c._isMember(r)).forEach(c=>c._trigger(o,s,i)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Vn.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",o=new URLSearchParams(n);return`${e}${r}${o}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([Dy],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n;e?n=e:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const o={access_token:n,version:yy};n&&r.updateJoinPayload(o),r.joinedOnce&&r._isJoined()&&r._push(Vn.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(n)}catch(o){this.log("error",`error in ${e} callback`,o)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new Hp(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},_i.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,r,o,s,i,l,u,c,d;if(this.transport=(n=e==null?void 0:e.transport)!==null&&n!==void 0?n:null,this.timeout=(r=e==null?void 0:e.timeout)!==null&&r!==void 0?r:wu,this.heartbeatIntervalMs=(o=e==null?void 0:e.heartbeatIntervalMs)!==null&&o!==void 0?o:_i.HEARTBEAT_INTERVAL,this.worker=(s=e==null?void 0:e.worker)!==null&&s!==void 0?s:!1,this.accessToken=(i=e==null?void 0:e.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(l=e==null?void 0:e.heartbeatCallback)!==null&&l!==void 0?l:ml,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=e==null?void 0:e.reconnectAfterMs)!==null&&u!==void 0?u:h=>Ry[h-1]||Ny,this.encode=(c=e==null?void 0:e.encode)!==null&&c!==void 0?c:(h,f)=>f(JSON.stringify(h)),this.decode=(d=e==null?void 0:e.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class Tc extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Ct(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class Oy extends Tc{constructor(e,n,r){super(e),this.name="StorageApiError",this.status=n,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class ku extends Tc{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var Ty=function(t,e,n,r){function o(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?s(d.value):o(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};const Yp=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>ni(async()=>{const{default:r}=await Promise.resolve().then(()=>es);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},Py=()=>Ty(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield ni(()=>Promise.resolve().then(()=>es),void 0)).Response:Response}),Eu=t=>{if(Array.isArray(t))return t.map(n=>Eu(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const o=n.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[o]=Eu(r)}),e},Ly=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var mo=function(t,e,n,r){function o(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?s(d.value):o(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};const gl=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),$y=(t,e,n)=>mo(void 0,void 0,void 0,function*(){const r=yield Py();t instanceof r&&!(n!=null&&n.noResolveJson)?t.json().then(o=>{const s=t.status||500,i=(o==null?void 0:o.statusCode)||s+"";e(new Oy(gl(o),s,i))}).catch(o=>{e(new ku(gl(o),o))}):e(new ku(gl(t),t))}),Iy=(t,e,n,r)=>{const o={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!r?o:(Ly(r)?(o.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),o.body=JSON.stringify(r)):o.body=r,e!=null&&e.duplex&&(o.duplex=e.duplex),Object.assign(Object.assign({},o),n))};function oi(t,e,n,r,o,s){return mo(this,void 0,void 0,function*(){return new Promise((i,l)=>{t(n,Iy(e,r,o,s)).then(u=>{if(!u.ok)throw u;return r!=null&&r.noResolveJson?u:u.json()}).then(u=>i(u)).catch(u=>$y(u,l,r))})})}function pa(t,e,n,r){return mo(this,void 0,void 0,function*(){return oi(t,"GET",e,n,r)})}function tr(t,e,n,r,o){return mo(this,void 0,void 0,function*(){return oi(t,"POST",e,r,o,n)})}function ju(t,e,n,r,o){return mo(this,void 0,void 0,function*(){return oi(t,"PUT",e,r,o,n)})}function My(t,e,n,r){return mo(this,void 0,void 0,function*(){return oi(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function Qp(t,e,n,r,o){return mo(this,void 0,void 0,function*(){return oi(t,"DELETE",e,r,o,n)})}var Yt=function(t,e,n,r){function o(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?s(d.value):o(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};const By={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Yd={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Uy{constructor(e,n={},r,o){this.shouldThrowOnError=!1,this.url=e,this.headers=n,this.bucketId=r,this.fetch=Yp(o)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,n,r,o){return Yt(this,void 0,void 0,function*(){try{let s;const i=Object.assign(Object.assign({},Yd),o);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(i.upsert)});const u=i.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),u&&s.append("metadata",this.encodeMetadata(u)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.append("cacheControl",i.cacheControl),u&&s.append("metadata",this.encodeMetadata(u))):(s=r,l["cache-control"]=`max-age=${i.cacheControl}`,l["content-type"]=i.contentType,u&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(u)))),o!=null&&o.headers&&(l=Object.assign(Object.assign({},l),o.headers));const c=this._removeEmptyFolders(n),d=this._getFinalPath(c),h=yield(e=="PUT"?ju:tr)(this.fetch,`${this.url}/object/${d}`,s,Object.assign({headers:l},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:c,id:h.Id,fullPath:h.Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ct(s))return{data:null,error:s};throw s}})}upload(e,n,r){return Yt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,o){return Yt(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),i=this._getFinalPath(s),l=new URL(this.url+`/object/upload/sign/${i}`);l.searchParams.set("token",n);try{let u;const c=Object.assign({upsert:Yd.upsert},o),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&r instanceof Blob?(u=new FormData,u.append("cacheControl",c.cacheControl),u.append("",r)):typeof FormData<"u"&&r instanceof FormData?(u=r,u.append("cacheControl",c.cacheControl)):(u=r,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType);const h=yield ju(this.fetch,l.toString(),u,{headers:d});return{data:{path:s,fullPath:h.Key},error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(Ct(u))return{data:null,error:u};throw u}})}createSignedUploadUrl(e,n){return Yt(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const o=Object.assign({},this.headers);n!=null&&n.upsert&&(o["x-upsert"]="true");const s=yield tr(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:o}),i=new URL(this.url+s.url),l=i.searchParams.get("token");if(!l)throw new Tc("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:l},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ct(r))return{data:null,error:r};throw r}})}update(e,n,r){return Yt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return Yt(this,void 0,void 0,function*(){try{return{data:yield tr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Ct(o))return{data:null,error:o};throw o}})}copy(e,n,r){return Yt(this,void 0,void 0,function*(){try{return{data:{path:(yield tr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Ct(o))return{data:null,error:o};throw o}})}createSignedUrl(e,n,r){return Yt(this,void 0,void 0,function*(){try{let o=this._getFinalPath(e),s=yield tr(this.fetch,`${this.url}/object/sign/${o}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${i}`)},{data:s,error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Ct(o))return{data:null,error:o};throw o}})}createSignedUrls(e,n,r){return Yt(this,void 0,void 0,function*(){try{const o=yield tr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:o.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${s}`):null})),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Ct(o))return{data:null,error:o};throw o}})}download(e,n){return Yt(this,void 0,void 0,function*(){const o=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),i=s?`?${s}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield pa(this.fetch,`${this.url}/${o}/${l}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Ct(l))return{data:null,error:l};throw l}})}info(e){return Yt(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const r=yield pa(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Eu(r),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ct(r))return{data:null,error:r};throw r}})}exists(e){return Yt(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield My(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ct(r)&&r instanceof ku){const o=r.originalError;if([400,404].includes(o==null?void 0:o.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,n){const r=this._getFinalPath(e),o=[],s=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";s!==""&&o.push(s);const l=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",u=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});u!==""&&o.push(u);let c=o.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${c}`)}}}remove(e){return Yt(this,void 0,void 0,function*(){try{return{data:yield Qp(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}})}list(e,n,r){return Yt(this,void 0,void 0,function*(){try{const o=Object.assign(Object.assign(Object.assign({},By),n),{prefix:e||""});return{data:yield tr(this.fetch,`${this.url}/object/list/${this.bucketId}`,o,{headers:this.headers},r),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Ct(o))return{data:null,error:o};throw o}})}listV2(e,n){return Yt(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield tr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},n),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ct(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const Fy="2.12.1",zy={"X-Client-Info":`storage-js/${Fy}`};var vo=function(t,e,n,r){function o(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?s(d.value):o(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};class Wy{constructor(e,n={},r,o){this.shouldThrowOnError=!1;const s=new URL(e);o!=null&&o.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href,this.headers=Object.assign(Object.assign({},zy),n),this.fetch=Yp(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return vo(this,void 0,void 0,function*(){try{return{data:yield pa(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Ct(e))return{data:null,error:e};throw e}})}getBucket(e){return vo(this,void 0,void 0,function*(){try{return{data:yield pa(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return vo(this,void 0,void 0,function*(){try{return{data:yield tr(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ct(r))return{data:null,error:r};throw r}})}updateBucket(e,n){return vo(this,void 0,void 0,function*(){try{return{data:yield ju(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ct(r))return{data:null,error:r};throw r}})}emptyBucket(e){return vo(this,void 0,void 0,function*(){try{return{data:yield tr(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}})}deleteBucket(e){return vo(this,void 0,void 0,function*(){try{return{data:yield Qp(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}})}}class Vy extends Wy{constructor(e,n={},r,o){super(e,n,r,o)}from(e){return new Uy(this.url,this.headers,e,this.fetch)}}const Gy="2.57.4";let ys="";typeof Deno<"u"?ys="deno":typeof document<"u"?ys="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ys="react-native":ys="node";const qy={"X-Client-Info":`supabase-js-${ys}/${Gy}`},Hy={headers:qy},Ky={schema:"public"},Jy={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Yy={};var Qy=function(t,e,n,r){function o(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?s(d.value):o(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};const Xy=t=>{let e;return t?e=t:typeof fetch>"u"?e=$p:e=fetch,(...n)=>e(...n)},Zy=()=>typeof Headers>"u"?Ip:Headers,ev=(t,e,n)=>{const r=Xy(n),o=Zy();return(s,i)=>Qy(void 0,void 0,void 0,function*(){var l;const u=(l=yield e())!==null&&l!==void 0?l:t;let c=new o(i==null?void 0:i.headers);return c.has("apikey")||c.set("apikey",t),c.has("Authorization")||c.set("Authorization",`Bearer ${u}`),r(s,Object.assign(Object.assign({},i),{headers:c}))})};var tv=function(t,e,n,r){function o(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?s(d.value):o(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};function nv(t){return t.endsWith("/")?t:t+"/"}function rv(t,e){var n,r;const{db:o,auth:s,realtime:i,global:l}=t,{db:u,auth:c,realtime:d,global:h}=e,f={db:Object.assign(Object.assign({},u),o),auth:Object.assign(Object.assign({},c),s),realtime:Object.assign(Object.assign({},d),i),storage:{},global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(n=h==null?void 0:h.headers)!==null&&n!==void 0?n:{}),(r=l==null?void 0:l.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>tv(this,void 0,void 0,function*(){return""})};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}function ov(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(nv(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Xp="2.71.1",_o=30*1e3,Cu=3,yl=Cu*_o,sv="http://localhost:9999",iv="supabase.auth.token",av={"X-Client-Info":`gotrue-js/${Xp}`},Ru="X-Supabase-Api-Version",Zp={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},lv=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,uv=10*60*1e3;class Pc extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function Ee(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class cv extends Pc{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function dv(t){return Ee(t)&&t.name==="AuthApiError"}class em extends Pc{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Gr extends Pc{constructor(e,n,r,o){super(e,r,o),this.name=n,this.status=r}}class kr extends Gr{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function fv(t){return Ee(t)&&t.name==="AuthSessionMissingError"}class ki extends Gr{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ei extends Gr{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ji extends Gr{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function hv(t){return Ee(t)&&t.name==="AuthImplicitGrantRedirectError"}class Qd extends Gr{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Nu extends Gr{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function vl(t){return Ee(t)&&t.name==="AuthRetryableFetchError"}class Xd extends Gr{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class Du extends Gr{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const ma="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Zd=` 	
\r=`.split(""),pv=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Zd.length;e+=1)t[Zd[e].charCodeAt(0)]=-2;for(let e=0;e<ma.length;e+=1)t[ma[e].charCodeAt(0)]=e;return t})();function ef(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(ma[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(ma[r]),e.queuedBits-=6}}function tm(t,e,n){const r=pv[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function tf(t){const e=[],n=i=>{e.push(String.fromCodePoint(i))},r={utf8seq:0,codepoint:0},o={queue:0,queuedBits:0},s=i=>{yv(i,r,n)};for(let i=0;i<t.length;i+=1)tm(t.charCodeAt(i),o,s);return e.join("")}function mv(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function gv(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const o=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|o)+65536,n+=1}mv(r,e)}}function yv(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if(!(t>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function vv(t){const e=[],n={queue:0,queuedBits:0},r=o=>{e.push(o)};for(let o=0;o<t.length;o+=1)tm(t.charCodeAt(o),n,r);return new Uint8Array(e)}function xv(t){const e=[];return gv(t,n=>e.push(n)),new Uint8Array(e)}function bv(t){const e=[],n={queue:0,queuedBits:0},r=o=>{e.push(o)};return t.forEach(o=>ef(o,n,r)),ef(null,n,r),e.join("")}function wv(t){return Math.round(Date.now()/1e3)+t}function Sv(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Fn=()=>typeof window<"u"&&typeof document<"u",Hr={tested:!1,writable:!1},nm=()=>{if(!Fn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Hr.tested)return Hr.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Hr.tested=!0,Hr.writable=!0}catch{Hr.tested=!0,Hr.writable=!1}return Hr.writable};function _v(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((o,s)=>{e[s]=o})}catch{}return n.searchParams.forEach((r,o)=>{e[o]=r}),e}const rm=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>ni(async()=>{const{default:r}=await Promise.resolve().then(()=>es);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},kv=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",ko=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Kr=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Sr=async(t,e)=>{await t.removeItem(e)};class Ia{constructor(){this.promise=new Ia.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}Ia.promiseConstructor=Promise;function xl(t){const e=t.split(".");if(e.length!==3)throw new Du("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!lv.test(e[r]))throw new Du("JWT not in base64url format");return{header:JSON.parse(tf(e[0])),payload:JSON.parse(tf(e[1])),signature:vv(e[2]),raw:{header:e[0],payload:e[1]}}}async function Ev(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function jv(t,e){return new Promise((r,o)=>{(async()=>{for(let s=0;s<1/0;s++)try{const i=await t(s);if(!e(s,null,i)){r(i);return}}catch(i){if(!e(s,i)){o(i);return}}})()})}function Cv(t){return("0"+t.toString(16)).substr(-2)}function Rv(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let o="";for(let s=0;s<56;s++)o+=n.charAt(Math.floor(Math.random()*r));return o}return crypto.getRandomValues(e),Array.from(e,Cv).join("")}async function Nv(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),o=new Uint8Array(r);return Array.from(o).map(s=>String.fromCharCode(s)).join("")}async function Dv(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await Nv(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function xo(t,e,n=!1){const r=Rv();let o=r;n&&(o+="/PASSWORD_RECOVERY"),await ko(t,`${e}-code-verifier`,o);const s=await Dv(r);return[s,r===s?"plain":"s256"]}const Av=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Ov(t){const e=t.headers.get(Ru);if(!e||!e.match(Av))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Tv(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function Pv(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Lv=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function bo(t){if(!Lv.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function bl(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function nf(t){return JSON.parse(JSON.stringify(t))}var $v=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const Xr=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Iv=[502,503,504];async function rf(t){var e;if(!kv(t))throw new Nu(Xr(t),0);if(Iv.includes(t.status))throw new Nu(Xr(t),t.status);let n;try{n=await t.json()}catch(s){throw new em(Xr(s),s)}let r;const o=Ov(t);if(o&&o.getTime()>=Zp["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new Xd(Xr(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new kr}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((s,i)=>s&&typeof i=="string",!0))throw new Xd(Xr(n),t.status,n.weak_password.reasons);throw new cv(Xr(n),t.status||500,r)}const Mv=(t,e,n,r)=>{const o={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),o.body=JSON.stringify(r),Object.assign(Object.assign({},o),n))};async function $e(t,e,n,r){var o;const s=Object.assign({},r==null?void 0:r.headers);s[Ru]||(s[Ru]=Zp["2024-01-01"].name),r!=null&&r.jwt&&(s.Authorization=`Bearer ${r.jwt}`);const i=(o=r==null?void 0:r.query)!==null&&o!==void 0?o:{};r!=null&&r.redirectTo&&(i.redirect_to=r.redirectTo);const l=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",u=await Bv(t,e,n+l,{headers:s,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(u):{data:Object.assign({},u),error:null}}async function Bv(t,e,n,r,o,s){const i=Mv(e,r,o,s);let l;try{l=await t(n,Object.assign({},i))}catch(u){throw console.error(u),new Nu(Xr(u),0)}if(l.ok||await rf(l),r!=null&&r.noResolveJson)return l;try{return await l.json()}catch(u){await rf(u)}}function ir(t){var e;let n=null;Wv(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=wv(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function of(t){const e=ir(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Nr(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function Uv(t){return{data:t,error:null}}function Fv(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:o,verification_type:s}=t,i=$v(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:n,hashed_token:r,redirect_to:o,verification_type:s},u=Object.assign({},i);return{data:{properties:l,user:u},error:null}}function zv(t){return t}function Wv(t){return t.access_token&&t.refresh_token&&t.expires_in}const wl=["global","local","others"];var Vv=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};class Gv{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=rm(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n=wl[0]){if(wl.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${wl.join(", ")}`);try{return await $e(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Ee(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await $e(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Nr})}catch(r){if(Ee(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=Vv(e,["options"]),o=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(o.new_email=r==null?void 0:r.newEmail,delete o.newEmail),await $e(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:o,headers:this.headers,xform:Fv,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(Ee(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await $e(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Nr})}catch(n){if(Ee(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,o,s,i,l,u;try{const c={nextPage:null,lastPage:0,total:0},d=await $e(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(s=(o=e==null?void 0:e.perPage)===null||o===void 0?void 0:o.toString())!==null&&s!==void 0?s:""},xform:zv});if(d.error)throw d.error;const h=await d.json(),f=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,x=(u=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&u!==void 0?u:[];return x.length>0&&(x.forEach(y=>{const b=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(y.split(";")[1].split("=")[1]);c[`${_}Page`]=b}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(Ee(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){bo(e);try{return await $e(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Nr})}catch(n){if(Ee(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){bo(e);try{return await $e(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Nr})}catch(r){if(Ee(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){bo(e);try{return await $e(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Nr})}catch(r){if(Ee(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){bo(e.userId);try{const{data:n,error:r}=await $e(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:o=>({data:{factors:o},error:null})});return{data:n,error:r}}catch(n){if(Ee(n))return{data:null,error:n};throw n}}async _deleteFactor(e){bo(e.userId),bo(e.id);try{return{data:await $e(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(Ee(n))return{data:null,error:n};throw n}}}function sf(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function qv(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const wo={debug:!!(globalThis&&nm()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class om extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Hv extends om{}async function Kv(t,e,n){wo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),wo.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async o=>{if(o){wo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,o.name);try{return await n()}finally{wo.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,o.name)}}else{if(e===0)throw wo.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new Hv(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(wo.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}qv();const Jv={url:sv,storageKey:iv,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:av,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function af(t,e,n){return await n()}const So={};class Js{constructor(e){var n,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Js.nextInstanceID,Js.nextInstanceID+=1,this.instanceID>0&&Fn()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const o=Object.assign(Object.assign({},Jv),e);if(this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.persistSession=o.persistSession,this.storageKey=o.storageKey,this.autoRefreshToken=o.autoRefreshToken,this.admin=new Gv({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=rm(o.fetch),this.lock=o.lock||af,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,o.lock?this.lock=o.lock:Fn()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=Kv:this.lock=af,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:nm()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=sf(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=sf(this.memoryStorage)),Fn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}get jwks(){var e,n;return(n=(e=So[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){So[this.storageKey]=Object.assign(Object.assign({},So[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=So[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){So[this.storageKey]=Object.assign(Object.assign({},So[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Xp}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=_v(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),Fn()&&this.detectSessionInUrl&&r!=="none"){const{data:o,error:s}=await this._getSessionFromURL(n,r);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),hv(s)){const u=(e=s.details)===null||e===void 0?void 0:e.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:i,redirectType:l}=o;return this._debug("#_initialize()","detected session in URL",i,"redirect type",l),await this._saveSession(i),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Ee(n)?{error:n}:{error:new em("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,o;try{const s=await $e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(o=e==null?void 0:e.options)===null||o===void 0?void 0:o.captchaToken}},xform:ir}),{data:i,error:l}=s;if(l||!i)return{data:{user:null,session:null},error:l};const u=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(s){if(Ee(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var n,r,o;try{let s;if("email"in e){const{email:d,password:h,options:f}=e;let x=null,y=null;this.flowType==="pkce"&&([x,y]=await xo(this.storage,this.storageKey)),s=await $e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:h,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:x,code_challenge_method:y},xform:ir})}else if("phone"in e){const{phone:d,password:h,options:f}=e;s=await $e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},channel:(o=f==null?void 0:f.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:ir})}else throw new Ei("You must provide either an email or phone number and a password");const{data:i,error:l}=s;if(l||!i)return{data:{user:null,session:null},error:l};const u=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(s){if(Ee(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let n;if("email"in e){const{email:s,password:i,options:l}=e;n=await $e(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:of})}else if("phone"in e){const{phone:s,password:i,options:l}=e;n=await $e(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:of})}else throw new Ei("You must provide either an email or phone number and a password");const{data:r,error:o}=n;return o?{data:{user:null,session:null},error:o}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new ki}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:o})}catch(n){if(Ee(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,r,o,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(o=e.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;if(n==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(e){var n,r,o,s,i,l,u,c,d,h,f,x;let y,b;if("message"in e)y=e.message,b=e.signature;else{const{chain:_,wallet:p,statement:m,options:g}=e;let w;if(Fn())if(typeof p=="object")w=p;else{const R=window;if("solana"in R&&typeof R.solana=="object"&&("signIn"in R.solana&&typeof R.solana.signIn=="function"||"signMessage"in R.solana&&typeof R.solana.signMessage=="function"))w=R.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof p!="object"||!(g!=null&&g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=p}const j=new URL((n=g==null?void 0:g.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in w&&w.signIn){const R=await w.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},g==null?void 0:g.signInWithSolana),{version:"1",domain:j.host,uri:j.href}),m?{statement:m}:null));let C;if(Array.isArray(R)&&R[0]&&typeof R[0]=="object")C=R[0];else if(R&&typeof R=="object"&&"signedMessage"in R&&"signature"in R)C=R;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in C&&"signature"in C&&(typeof C.signedMessage=="string"||C.signedMessage instanceof Uint8Array)&&C.signature instanceof Uint8Array)y=typeof C.signedMessage=="string"?C.signedMessage:new TextDecoder().decode(C.signedMessage),b=C.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in w)||typeof w.signMessage!="function"||!("publicKey"in w)||typeof w!="object"||!w.publicKey||!("toBase58"in w.publicKey)||typeof w.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");y=[`${j.host} wants you to sign in with your Solana account:`,w.publicKey.toBase58(),...m?["",m,""]:[""],"Version: 1",`URI: ${j.href}`,`Issued At: ${(o=(r=g==null?void 0:g.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&o!==void 0?o:new Date().toISOString()}`,...!((s=g==null?void 0:g.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${g.signInWithSolana.notBefore}`]:[],...!((i=g==null?void 0:g.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${g.signInWithSolana.expirationTime}`]:[],...!((l=g==null?void 0:g.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${g.signInWithSolana.chainId}`]:[],...!((u=g==null?void 0:g.signInWithSolana)===null||u===void 0)&&u.nonce?[`Nonce: ${g.signInWithSolana.nonce}`]:[],...!((c=g==null?void 0:g.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${g.signInWithSolana.requestId}`]:[],...!((h=(d=g==null?void 0:g.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?["Resources",...g.signInWithSolana.resources.map(C=>`- ${C}`)]:[]].join(`
`);const R=await w.signMessage(new TextEncoder().encode(y),"utf8");if(!R||!(R instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");b=R}}try{const{data:_,error:p}=await $e(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:y,signature:bv(b)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(x=e.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:ir});if(p)throw p;return!_||!_.session||!_.user?{data:{user:null,session:null},error:new ki}:(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),{data:Object.assign({},_),error:p})}catch(_){if(Ee(_))return{data:{user:null,session:null},error:_};throw _}}async _exchangeCodeForSession(e){const n=await Kr(this.storage,`${this.storageKey}-code-verifier`),[r,o]=(n??"").split("/");try{const{data:s,error:i}=await $e(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:ir});if(await Sr(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new ki}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:o??null}),error:i})}catch(s){if(Ee(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{const{options:n,provider:r,token:o,access_token:s,nonce:i}=e,l=await $e(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:o,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:ir}),{data:u,error:c}=l;return c?{data:{user:null,session:null},error:c}:!u||!u.session||!u.user?{data:{user:null,session:null},error:new ki}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:u,error:c})}catch(n){if(Ee(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,r,o,s,i;try{if("email"in e){const{email:l,options:u}=e;let c=null,d=null;this.flowType==="pkce"&&([c,d]=await xo(this.storage,this.storageKey));const{error:h}=await $e(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(n=u==null?void 0:u.data)!==null&&n!==void 0?n:{},create_user:(r=u==null?void 0:u.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},code_challenge:c,code_challenge_method:d},redirectTo:u==null?void 0:u.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:l,options:u}=e,{data:c,error:d}=await $e(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(o=u==null?void 0:u.data)!==null&&o!==void 0?o:{},create_user:(s=u==null?void 0:u.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},channel:(i=u==null?void 0:u.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:d}}throw new Ei("You must provide either an email or phone number.")}catch(l){if(Ee(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var n,r;try{let o,s;"options"in e&&(o=(n=e.options)===null||n===void 0?void 0:n.redirectTo,s=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:i,error:l}=await $e(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:o,xform:ir});if(l)throw l;if(!i)throw new Error("An error occurred on token verification.");const u=i.session,c=i.user;return u!=null&&u.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(o){if(Ee(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithSSO(e){var n,r,o;try{let s=null,i=null;return this.flowType==="pkce"&&([s,i]=await xo(this.storage,this.storageKey)),await $e(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((o=e==null?void 0:e.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:i}),headers:this.headers,xform:Uv})}catch(s){if(Ee(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new kr;const{error:o}=await $e(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:o}})}catch(e){if(Ee(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:o,options:s}=e,{error:i}=await $e(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:o,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in e){const{phone:r,type:o,options:s}=e,{data:i,error:l}=await $e(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:o,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:l}}throw new Ei("You must provide either an email or phone number and a type")}catch(n){if(Ee(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Kr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<yl:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const i=await Kr(this.userStorage,this.storageKey+"-user");i!=null&&i.user?e.user=i.user:e.user=bl()}if(this.storage.isServer&&e.user){let i=this.suppressGetSessionWarning;e=new Proxy(e,{get:(u,c,d)=>(!i&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(u,c,d))})}return{data:{session:e},error:null}}const{session:o,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:o},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await $e(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Nr}):await this._useSession(async n=>{var r,o,s;const{data:i,error:l}=n;if(l)throw l;return!(!((r=i.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new kr}:await $e(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(o=i.session)===null||o===void 0?void 0:o.access_token)!==null&&s!==void 0?s:void 0,xform:Nr})})}catch(n){if(Ee(n))return fv(n)&&(await this._removeSession(),await Sr(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:o,error:s}=r;if(s)throw s;if(!o.session)throw new kr;const i=o.session;let l=null,u=null;this.flowType==="pkce"&&e.email!=null&&([l,u]=await xo(this.storage,this.storageKey));const{data:c,error:d}=await $e(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:u}),jwt:i.access_token,xform:Nr});if(d)throw d;return i.user=c.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(r){if(Ee(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new kr;const n=Date.now()/1e3;let r=n,o=!0,s=null;const{payload:i}=xl(e.access_token);if(i.exp&&(r=i.exp,o=r<=n),o){const{session:l,error:u}=await this._callRefreshToken(e.refresh_token);if(u)return{data:{user:null,session:null},error:u};if(!l)return{data:{user:null,session:null},error:null};s=l}else{const{data:l,error:u}=await this._getUser(e.access_token);if(u)throw u;s={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(n){if(Ee(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:i,error:l}=n;if(l)throw l;e=(r=i.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new kr;const{session:o,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:o?{data:{user:o.user,session:o},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(Ee(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!Fn())throw new ji("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ji(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new Qd("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ji("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Qd("No code detected.");const{data:m,error:g}=await this._exchangeCodeForSession(e.code);if(g)throw g;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:m.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:o,access_token:s,refresh_token:i,expires_in:l,expires_at:u,token_type:c}=e;if(!s||!l||!i||!c)throw new ji("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(l);let f=d+h;u&&(f=parseInt(u));const x=f-d;x*1e3<=_o&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${x}s, should have been closer to ${h}s`);const y=f-h;d-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,f,d):d-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,f,d);const{data:b,error:_}=await this._getUser(s);if(_)throw _;const p={provider_token:r,provider_refresh_token:o,access_token:s,expires_in:h,expires_at:f,refresh_token:i,token_type:c,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:p,redirectType:e.type},error:null}}catch(r){if(Ee(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await Kr(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:o,error:s}=n;if(s)return{error:s};const i=(r=o.session)===null||r===void 0?void 0:r.access_token;if(i){const{error:l}=await this.admin.signOut(i,e);if(l&&!(dv(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await Sr(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=Sv(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,o;try{const{data:{session:s},error:i}=n;if(i)throw i;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((o=this.stateChangeEmitters.get(e))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,n={}){let r=null,o=null;this.flowType==="pkce"&&([r,o]=await xo(this.storage,this.storageKey,!0));try{return await $e(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:o,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(s){if(Ee(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(Ee(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:r,error:o}=await this._useSession(async s=>{var i,l,u,c,d;const{data:h,error:f}=s;if(f)throw f;const x=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(u=e.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await $e(this.fetch,"GET",x,{headers:this.headers,jwt:(d=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&d!==void 0?d:void 0})});if(o)throw o;return Fn()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(Ee(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,o;const{data:s,error:i}=n;if(i)throw i;return await $e(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(o=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&o!==void 0?o:void 0})})}catch(n){if(Ee(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await jv(async o=>(o>0&&await Ev(200*Math.pow(2,o-1)),this._debug(n,"refreshing attempt",o),await $e(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ir})),(o,s)=>{const i=200*Math.pow(2,o);return s&&vl(s)&&Date.now()+i-r<_o})}catch(r){if(this._debug(n,"error",r),Ee(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),Fn()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const o=await Kr(this.storage,this.storageKey);if(o&&this.userStorage){let i=await Kr(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:o.user},await ko(this.userStorage,this.storageKey+"-user",i)),o.user=(e=i==null?void 0:i.user)!==null&&e!==void 0?e:bl()}else if(o&&!o.user&&!o.user){const i=await Kr(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(o.user=i.user,await Sr(this.storage,this.storageKey+"-user"),await ko(this.storage,this.storageKey,o)):o.user=bl()}if(this._debug(r,"session from storage",o),!this._isValidSession(o)){this._debug(r,"session is not valid"),o!==null&&await this._removeSession();return}const s=((n=o.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<yl;if(this._debug(r,`session has${s?"":" not"} expired with margin of ${yl}s`),s){if(this.autoRefreshToken&&o.refresh_token){const{error:i}=await this._callRefreshToken(o.refresh_token);i&&(console.error(i),vl(i)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(o.user&&o.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:l}=await this._getUser(o.access_token);!l&&(i!=null&&i.user)?(o.user=i.user,await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(r,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",o)}catch(o){this._debug(r,"error",o),console.error(o);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new kr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new Ia;const{data:s,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!s.session)throw new kr;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const l={session:s.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(s){if(this._debug(o,"error",s),Ee(s)){const i={session:null,error:s};return vl(s)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(i),i}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(s),s}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(e,n,r=!0){const o=`#_notifyAllSubscribers(${e})`;this._debug(o,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const s=[],i=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,n)}catch(u){s.push(u)}});if(await Promise.all(i),s.length>0){for(let l=0;l<s.length;l+=1)console.error(s[l]);throw s[0]}}finally{this._debug(o,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const n=Object.assign({},e),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await ko(this.userStorage,this.storageKey+"-user",{user:n.user});const o=Object.assign({},n);delete o.user;const s=nf(o);await ko(this.storage,this.storageKey,s)}else{const o=nf(n);await ko(this.storage,this.storageKey,o)}}async _removeSession(){this._debug("#_removeSession()"),await Sr(this.storage,this.storageKey),await Sr(this.storage,this.storageKey+"-code-verifier"),await Sr(this.storage,this.storageKey+"-user"),this.userStorage&&await Sr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Fn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),_o);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const o=Math.floor((r.expires_at*1e3-e)/_o);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${_o}ms, refresh threshold is ${Cu} ticks`),o<=Cu&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof om)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Fn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const o=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&o.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&o.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[s,i]=await xo(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(i)}`});o.push(l.toString())}if(r!=null&&r.queryParams){const s=new URLSearchParams(r.queryParams);o.push(s.toString())}return r!=null&&r.skipBrowserRedirect&&o.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${o.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:o,error:s}=n;return s?{data:null,error:s}:await $e(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(Ee(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,o;const{data:s,error:i}=n;if(i)return{data:null,error:i};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:u,error:c}=await $e(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((o=u==null?void 0:u.totp)===null||o===void 0)&&o.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),{data:u,error:null})})}catch(n){if(Ee(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:o,error:s}=n;if(s)return{data:null,error:s};const{data:i,error:l}=await $e(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:l})})}catch(n){if(Ee(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:o,error:s}=n;return s?{data:null,error:s}:await $e(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(Ee(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(e==null?void 0:e.factors)||[],o=r.filter(i=>i.factor_type==="totp"&&i.status==="verified"),s=r.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:r,totp:o,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,r;const{data:{session:o},error:s}=e;if(s)return{data:null,error:s};if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=xl(o.access_token);let l=null;i.aal&&(l=i.aal);let u=l;((r=(n=o.user.factors)===null||n===void 0?void 0:n.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(u="aal2");const d=i.amr||[];return{data:{currentLevel:l,nextLevel:u,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(l=>l.kid===e);if(r)return r;const o=Date.now();if(r=this.jwks.keys.find(l=>l.kid===e),r&&this.jwks_cached_at+uv>o)return r;const{data:s,error:i}=await $e(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=o,r=s.keys.find(l=>l.kid===e),!r)?null:r}async getClaims(e,n={}){try{let r=e;if(!r){const{data:x,error:y}=await this.getSession();if(y||!x.session)return{data:null,error:y};r=x.session.access_token}const{header:o,payload:s,signature:i,raw:{header:l,payload:u}}=xl(r);n!=null&&n.allowExpired||Tv(s.exp);const c=!o.alg||o.alg.startsWith("HS")||!o.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(o.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!c){const{error:x}=await this.getUser(r);if(x)throw x;return{data:{claims:s,header:o,signature:i},error:null}}const d=Pv(o.alg),h=await crypto.subtle.importKey("jwk",c,d,!0,["verify"]);if(!await crypto.subtle.verify(d,h,i,xv(`${l}.${u}`)))throw new Du("Invalid JWT signature");return{data:{claims:s,header:o,signature:i},error:null}}catch(r){if(Ee(r))return{data:null,error:r};throw r}}}Js.nextInstanceID=0;const Yv=Js;class Qv extends Yv{constructor(e){super(e)}}var Xv=function(t,e,n,r){function o(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?s(d.value):o(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};class Zv{constructor(e,n,r){var o,s,i;this.supabaseUrl=e,this.supabaseKey=n;const l=ov(e);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const u=`sb-${l.hostname.split(".")[0]}-auth-token`,c={db:Ky,realtime:Yy,auth:Object.assign(Object.assign({},Jy),{storageKey:u}),global:Hy},d=rv(r??{},c);this.storageKey=(o=d.auth.storageKey)!==null&&o!==void 0?o:"",this.headers=(s=d.global.headers)!==null&&s!==void 0?s:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(h,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=d.auth)!==null&&i!==void 0?i:{},this.headers,d.global.fetch),this.fetch=ev(n,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new py(new URL("rest/v1",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new Vy(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new q0(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r={}){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return Xv(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:o,userStorage:s,storageKey:i,flowType:l,lock:u,debug:c},d,h){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Qv({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),d),storageKey:i,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:o,userStorage:s,flowType:l,lock:u,debug:c,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(x=>x.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new Ay(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const ex=(t,e,n)=>new Zv(t,e,n);function tx(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}tx()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const nx="https://wjylzxsfevdlhqunvfqc.supabase.co",rx="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndqeWx6eHNmZXZkbGhxdW52ZnFjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg2ODMwOTEsImV4cCI6MjA3NDI1OTA5MX0.SuB0gd7-gefwpUHFnKsupDgo8P2VeLuMbdlsU6AMrLw",lf=globalThis,We=lf.__sg_supabase||(lf.__sg_supabase=ex(nx,rx,{auth:{persistSession:!0,autoRefreshToken:!0,storageKey:"salesgame-auth"},realtime:{params:{eventsPerSecond:10}}}));function ox(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,8)}`}function Ys(){const t="sg_tab_player_id";let e=sessionStorage.getItem(t);return e||(e=ox(),sessionStorage.setItem(t,e)),e}function co(t="Jogador"){const e="sg_tab_player_name";let n=sessionStorage.getItem(e);return n||(n=t,sessionStorage.setItem(e,n)),n}function sx(t){return sessionStorage.setItem("sg_tab_player_name",t??"Jogador"),t}const ix="/dynamic-data-visualization-3d.jpg",ax="/SalesGame_Logo-removebg-preview.png",lx="/Multiplier-Copia.png",ux="/WhatsApp_Image_2025-06-24_at_16.47.00-removebg-preview.png";function cx({onEnter:t}){const[e,n]=E.useState(co("")),r=E.useRef(null);E.useEffect(()=>{var i;(i=r.current)==null||i.focus()},[]);function o(){const i=(e||"").trim();i&&(sx(i),t==null||t(i))}function s(i){i.key==="Enter"&&o()}return a.jsxs("div",{className:"start",children:[a.jsx("img",{className:"startBg",src:ix,alt:""}),a.jsx("div",{className:"startShade"}),a.jsx("div",{className:"startHeader",children:a.jsx("img",{className:"startLogo",src:ax,alt:"Sales GAME"})}),a.jsx("div",{className:"startCenter",children:a.jsxs("div",{className:"startCard",children:[a.jsx("label",{className:"startLabel",htmlFor:"playerName",children:"Nome do Jogador"}),a.jsx("input",{id:"playerName",ref:r,className:"startInput",placeholder:"Digite seu nome",value:e,onChange:i=>n(i.target.value),onKeyDown:s,maxLength:30}),a.jsx("button",{className:"startBtn",onClick:o,children:"Entrar"})]})}),a.jsxs("div",{className:"startFooter",children:[a.jsxs("div",{className:"startLinks",children:[a.jsx("div",{children:"@multiplier.educacao"}),a.jsx("div",{children:"https://multipliereducacao.com.br/"})]}),a.jsx("div",{className:"startBrand",children:a.jsx("img",{className:"startBrandLogo",src:lx,alt:"Multiplier"})})]}),a.jsx("img",{className:"startCoach",src:ux,alt:"",draggable:"false"})]})}async function dx(){const{data:t,error:e}=await We.from("lobbies").select(`
      id,
      name,
      max_players,
      status,
      created_at,
      lobby_players!left(count)
    `).order("created_at",{ascending:!0});if(e)throw e;return(t||[]).map(n=>{var r,o;return{id:n.id,name:n.name,max:n.max_players,status:n.status||"open",players:(((o=(r=n.lobby_players)==null?void 0:r[0])==null?void 0:o.count)??0)|0}})}function fx(t){const e=We.channel("lobbies-list").on("postgres_changes",{event:"*",schema:"public",table:"lobbies"},()=>t==null?void 0:t()).on("postgres_changes",{event:"*",schema:"public",table:"lobby_players"},()=>t==null?void 0:t()).subscribe();return()=>We.removeChannel(e)}async function hx({name:t,hostId:e,max:n=4}){if(!e)throw new Error("hostId obrigatrio em createLobby");const o={id:typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,8)}`,name:t,host_id:e,max_players:Number(n)||4,status:"open",created_at:new Date().toISOString()},{data:s,error:i}=await We.from("lobbies").insert(o).select("id").single();if(i)throw i;return s.id}async function Au({lobbyId:t,playerId:e,playerName:n,ready:r=!1}){const{data:o,error:s}=await We.from("lobbies").select("id, max_players, status, host_id").eq("id",t).single();if(s)throw s;if(o.status!=="open")throw new Error("Sala fechada.");const{count:i,error:l}=await We.from("lobby_players").select("lobby_id",{count:"exact",head:!0}).eq("lobby_id",t);if(l)throw l;if((i||0)>=o.max_players)throw new Error("Sala cheia.");try{window.__MY_UID=e}catch{}const{error:u}=await We.from("lobby_players").upsert({lobby_id:t,player_id:e,player_name:n,ready:!!r,joined_at:new Date().toISOString()},{onConflict:"lobby_id,player_id"});if(u)throw u;o.host_id||await We.from("lobbies").update({host_id:e}).eq("id",t)}async function uf({lobbyId:t,playerId:e}){var l;const{data:n,error:r}=await We.from("lobbies").select("id, host_id").eq("id",t).single();if(r)throw r;const{error:o}=await We.from("lobby_players").delete().match({lobby_id:t,player_id:e});if(o)throw o;const{data:s,error:i}=await We.from("lobby_players").select("player_id, joined_at").eq("lobby_id",t).order("joined_at",{ascending:!0});if(i)throw i;if(!s||s.length===0){await We.from("lobbies").delete().eq("id",t);return}if((n==null?void 0:n.host_id)===e){const u=(l=s[0])==null?void 0:l.player_id;u&&await We.from("lobbies").update({host_id:u}).eq("id",t)}}async function cf(t){const{data:e,error:n}=await We.from("lobby_players").select("player_id, player_name, ready, joined_at").eq("lobby_id",t).order("joined_at",{ascending:!0});if(n)throw n;return e||[]}async function px({lobbyId:t,playerId:e,ready:n}){const{error:r}=await We.from("lobby_players").update({ready:n}).match({lobby_id:t,player_id:e});if(r)throw r}async function mx(t,e,n){return px({lobbyId:t,playerId:e,ready:n})}async function gx({lobbyId:t,playerId:e,playerName:n}){const{error:r}=await We.from("lobby_players").update({player_name:n}).match({lobby_id:t,player_id:e});if(r)throw r}async function df(t,e){const{error:n}=await We.from("lobbies").update({status:e}).eq("id",t);if(n)throw n}function yx(t,e){let n=0;const r=()=>{n&&cancelAnimationFrame(n),n=requestAnimationFrame(()=>e==null?void 0:e())},o=We.channel(`lobby-${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"lobby_players",filter:`lobby_id=eq.${t}`},s=>{console.debug("[rt] lobby_players:INSERT",s.new),r()}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"lobby_players",filter:`lobby_id=eq.${t}`},s=>{console.debug("[rt] lobby_players:UPDATE",s.new),r()}).on("postgres_changes",{event:"DELETE",schema:"public",table:"lobby_players",filter:`lobby_id=eq.${t}`},s=>{console.debug("[rt] lobby_players:DELETE",s.old),r()}).on("postgres_changes",{event:"*",schema:"public",table:"lobbies",filter:`id=eq.${t}`},s=>{console.debug("[rt] lobbies:*",s.new||s.old),r()}).subscribe();return()=>{n&&cancelAnimationFrame(n),We.removeChannel(o)}}async function vx(t){const{data:e,error:n}=await We.from("lobbies").select("id,name,status,max_players,host_id,created_at").eq("id",t).single();if(n)throw n;return e}async function xx({lobbyId:t}){var o;const{data:e}=await We.from("lobby_players").select("player_id, player_name, ready").eq("lobby_id",t),{data:n,error:r}=await We.from("matches").insert({lobby_id:t,host_id:((o=e==null?void 0:e[0])==null?void 0:o.player_id)||null,state:{players:e},created_at:new Date().toISOString()}).select("id").single();if(r)throw r;return n}async function bx(t){const{data:e,error:n}=await We.from("matches").select("id, lobby_id, created_at").eq("lobby_id",t).order("created_at",{ascending:!1}).limit(1);if(n)throw n;return(e==null?void 0:e[0])||null}async function Sl({roomCode:t,playerId:e}){if(!t||!e){console.log("[leaveRoom] Parmetros invlidos:",{roomCode:t,playerId:e});return}try{console.log(`[leaveRoom] Tentando remover jogador ${e} da sala ${t}`);const{data:n,error:r}=await We.from("lobbies").select("id, name, host_id").eq("id",t).single();if(r){console.warn("[leaveRoom] Erro ao buscar lobby:",r);return}if(!n){console.log(`[leaveRoom] Lobby ${t} no encontrado`);return}console.log("[leaveRoom] Lobby encontrado:",n);const{error:o}=await We.from("lobby_players").delete().match({lobby_id:t,player_id:e});o?console.warn("[leaveRoom] Erro ao remover jogador:",o):console.log(`[leaveRoom] Jogador ${e} removido do lobby ${t}`);const{data:s,error:i}=await We.from("lobby_players").select("player_id").eq("lobby_id",t);if(i){console.warn("[leaveRoom] Erro ao contar jogadores restantes:",i);return}if(!s||s.length===0){const{error:l}=await We.from("lobbies").delete().eq("id",t);l?console.warn("[leaveRoom] Erro ao deletar lobby vazio:",l):console.log(`[leaveRoom] Lobby ${t} deletado com sucesso (sem jogadores)`)}else if(console.log(`[leaveRoom] Jogador ${e} saiu do lobby ${t}. Restam ${s.length} jogadores.`),n.host_id===e&&s.length>0){const l=s[0].player_id,{error:u}=await We.from("lobbies").update({host_id:l}).eq("id",t);u?console.warn("[leaveRoom] Erro ao transferir host:",u):console.log(`[leaveRoom] Host transferido para ${l}`)}}catch(n){console.error("[leaveRoom] Erro inesperado:",n)}}function wx({onEnterRoom:t}){const[e,n]=E.useState([]),[r,o]=E.useState(!1);async function s(){o(!0);try{const c=await dx();n(c)}finally{o(!1)}}E.useEffect(()=>(s(),fx(()=>s())),[]);async function i(){const c=co("Jogador"),d=`Sala de ${c}`,h=prompt("Nome do lobby:",d)||d,f=Ys();try{const x=await hx({name:h,hostId:f,max:4});await Au({lobbyId:x,playerId:f,playerName:c,ready:!1}),t==null||t(x)}catch(x){alert(x.message||"No foi possvel criar o lobby."),await s()}}async function l(c){try{const d=co("Jogador"),h=Ys();await Au({lobbyId:c,playerId:h,playerName:d,ready:!1}),t==null||t(c)}catch(d){alert(d.message||"No foi possvel entrar no lobby.")}}const u={page:{minHeight:"100vh",background:"#0f0f12",color:"#e9ecf1",padding:"32px 16px",display:"flex",justifyContent:"center"},container:{width:"100%",maxWidth:980},headerRow:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:16,marginBottom:16,flexWrap:"wrap"},title:{fontSize:28,fontWeight:800,color:"#fff"},actions:{display:"flex",gap:10},btn:{padding:"12px 16px",border:0,borderRadius:12,fontWeight:800,cursor:"pointer"},btnPrimary:{background:"#4f46e5",color:"#fff",boxShadow:"0 8px 24px rgba(79,70,229,.25)"},btnSecondary:{background:"#20222a",color:"#fff",border:"1px solid #2b2e38"},grid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:14},card:{background:"linear-gradient(180deg, rgba(255,255,255,0.02) 0%, rgba(255,255,255,0.00) 100%)",border:"1px solid rgba(255,255,255,.08)",borderRadius:16,padding:16,display:"flex",flexDirection:"column",gap:12,boxShadow:"0 10px 20px rgba(0,0,0,.25)"},cardHeader:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:10},lobbyName:{fontSize:18,fontWeight:800,color:"#fff",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:1},meta:{fontSize:13,color:"#b8c0cc"},joinBtn:{padding:"10px 14px",borderRadius:10,border:0,background:"#7c3aed",color:"#fff",fontWeight:800,cursor:"pointer",boxShadow:"0 10px 20px rgba(124,58,237,.25)"},disabled:{opacity:.6,cursor:"not-allowed",filter:"grayscale(.3)"},empty:{marginTop:24,padding:18,borderRadius:12,border:"1px dashed rgba(255,255,255,.12)",color:"#c7cfdb",textAlign:"center"}};return a.jsx("div",{style:u.page,children:a.jsxs("div",{style:u.container,children:[a.jsxs("div",{style:u.headerRow,children:[a.jsx("h2",{style:u.title,children:"SalesGame  Lobbies"}),a.jsxs("div",{style:u.actions,children:[a.jsx("button",{style:{...u.btn,...u.btnPrimary},onClick:i,children:"Criar Lobby"}),a.jsx("button",{style:{...u.btn,...u.btnSecondary},onClick:s,disabled:r,children:r?"Atualizando":"Atualizar"})]})]}),e.length===0&&!r?a.jsxs("div",{style:u.empty,children:["Nenhuma sala criada ainda. Clique em ",a.jsx("b",{children:"Criar Lobby"})," para comear."]}):a.jsx("div",{style:u.grid,children:e.map(c=>{const d=(c.players??0)>=(c.max??4),h=(c.status??"open")==="open",f=d||!h;return a.jsxs("div",{style:u.card,children:[a.jsxs("div",{style:u.cardHeader,children:[a.jsx("div",{style:u.lobbyName,title:c.name,children:c.name}),a.jsxs("span",{style:u.meta,children:[c.players??0,"/",c.max??4]})]}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("span",{style:u.meta,children:["status: ",c.status??"open"]}),a.jsx("button",{style:{...u.joinBtn,...f?u.disabled:{}},disabled:f,onClick:()=>l(c.id),title:f?d?"Sala cheia":"Sala no est aberta":"Entrar na sala",children:"Entrar"})]})]},c.id)})})]})})}function Sx({lobbyId:t,onBack:e,onStartGame:n}){const r=Ys(),o=co("Jogador"),[s,i]=E.useState(null),[l,u]=E.useState([]),[c,d]=E.useState(!0),[h,f]=E.useState(!1),x=E.useRef(!1),y=E.useRef(!0),b=E.useRef(!1),_=E.useRef(!1),p=E.useMemo(()=>(s==null?void 0:s.host_id)===r,[s,r]),m=E.useMemo(()=>l.find(v=>v.player_id===r),[l,r]),g=E.useMemo(()=>l.filter(v=>v.ready).length,[l]),w=p&&(s==null?void 0:s.status)==="open"&&l.length>=1&&g===l.length;console.log("[PlayersLobby] Debug:",{players:l.length,readyCount:g,lobbyStatus:s==null?void 0:s.status,amHost:p,canStart:w,meId:r,meName:o});async function j(v){if(_.current)return;const D=await bx(t);if(D!=null&&D.id){_.current=!0;const O=(v||[]).map((M,te)=>({id:M.player_id,name:M.player_name,index:te}));n==null||n({lobbyId:t,matchId:D==null?void 0:D.id,players:O,me:{id:r,name:o}})}}async function R(){y.current&&d(!0);try{console.log("[PlayersLobby] refreshAll - buscando lobby:",t);const[v,D]=await Promise.all([vx(t),cf(t)]);console.log("[PlayersLobby] refreshAll - lobby:",v,"players:",D),i(v),u(D);const O=D.find(M=>M.player_id===r);if(console.log("[PlayersLobby] refreshAll - mine:",O,"meId:",r),!O&&!x.current&&(v==null?void 0:v.status)==="open"){console.log("[PlayersLobby] refreshAll - entrando na sala"),x.current=!0;try{await Au({lobbyId:t,playerId:r,playerName:o,ready:!1}),console.log("[PlayersLobby] refreshAll - entrada na sala bem-sucedida");const M=await cf(t);console.log("[PlayersLobby] refreshAll - jogadores aps entrada:",M),u(M)}catch(M){console.error("[PlayersLobby] refreshAll - erro ao entrar na sala:",M)}}if(O&&!b.current&&o&&O.player_name!==o){console.log("[PlayersLobby] refreshAll - sincronizando nome"),b.current=!0;try{await gx({lobbyId:t,playerId:r,playerName:o})}catch{}}await j(D)}catch(v){console.error("[PlayersLobby] refreshAll - erro:",v)}finally{y.current&&(y.current=!1,d(!1))}}E.useEffect(()=>{const v=()=>{uf({lobbyId:t,playerId:r}).catch(()=>{})},D=()=>v();return window.addEventListener("pagehide",D),window.addEventListener("beforeunload",D),()=>{window.removeEventListener("pagehide",D),window.removeEventListener("beforeunload",D)}},[t,r]),E.useEffect(()=>(x.current=!1,y.current=!0,b.current=!1,_.current=!1,R(),yx(t,()=>R())),[t]);async function C(v){if(!m)return;f(!0);const D=m.ready;u(O=>O.map(M=>M.player_id===r?{...M,ready:v}:M));try{await mx(t,r,v)}catch(O){u(M=>M.map(te=>te.player_id===r?{...te,ready:D}:te)),console.error("setReadyUI failed",O)}finally{f(!1)}}async function S(){try{await uf({lobbyId:t,playerId:r})}finally{e==null||e()}}async function A(){if(!w)return;const v=s==null?void 0:s.status;await df(t,"locked");try{const D=await xx({lobbyId:t});_.current=!0;const O=l.map((M,te)=>({id:M.player_id,name:M.player_name,index:te}));n==null||n({lobbyId:t,matchId:D==null?void 0:D.id,players:O,me:{id:r,name:o}})}catch(D){console.error("startMatch failed",D),await df(t,v||"open")}}return a.jsx("div",{style:He.page,children:a.jsxs("div",{style:He.container,children:[a.jsxs("div",{style:He.top,children:[a.jsx("button",{style:He.backBtn,onClick:S,children:" Voltar"}),a.jsxs("h2",{style:He.title,children:["SalesGame  ",(s==null?void 0:s.name)||"..."]})]}),a.jsxs("div",{style:He.table,children:[a.jsxs("div",{style:He.thead,children:[a.jsx("div",{style:He.colPlayer,children:"Jogador"}),a.jsx("div",{style:He.colReady,children:"Pronto?"})]}),c?a.jsx("div",{style:He.loading,children:"Carregando..."}):l.map(v=>a.jsxs("div",{style:He.row,children:[a.jsxs("div",{style:He.colPlayer,children:[a.jsx("span",{style:He.avatar,children:(v.player_name||"?").slice(0,2).toLowerCase()}),a.jsx("span",{children:v.player_name||"Annimo"}),(s==null?void 0:s.host_id)===v.player_id&&a.jsx("span",{style:He.badgeHost,children:"Host"}),v.player_id===r&&a.jsx("span",{style:He.badgeYou,children:"Voc"})]}),a.jsx("div",{style:He.colReady,children:v.player_id===r?a.jsxs("div",{style:{display:"flex",gap:8},children:[a.jsx("button",{style:{...He.btn,...m!=null&&m.ready?He.btnGhost:He.btnDark},onClick:()=>C(!1),disabled:h||!(m!=null&&m.ready),children:"No pronto"}),a.jsxs("button",{style:{...He.btn,...m!=null&&m.ready?He.btnPrimary:He.btnPurple},onClick:()=>C(!0),disabled:h||!!(m!=null&&m.ready),children:[" ",m!=null&&m.ready?"Pronto":"Ficar pronto"]})]}):a.jsx("span",{style:v.ready?He.pillReady:He.pillWait,children:v.ready?"Pronto":"Aguardando"})})]},v.player_id))]}),a.jsxs("div",{style:He.footer,children:[a.jsxs("div",{style:He.statusWrap,children:[a.jsx("span",{style:{...He.dot,background:(s==null?void 0:s.status)==="open"?"#22c55e":"#f59e0b"}}),a.jsxs("span",{children:["status: ",(s==null?void 0:s.status)||"..."]}),a.jsxs("span",{style:{marginLeft:12},children:["Prontos: ",g,"/",l.length]})]}),a.jsxs("div",{style:{display:"flex",gap:12},children:[a.jsx("button",{style:{...He.btn,...w?He.btnPrimary:He.disabled},onClick:A,disabled:!w,children:"Iniciar partida"}),a.jsx("button",{style:{...He.btn,...He.btnDark},onClick:S,children:"Sair da sala"})]})]})]})})}const He={page:{minHeight:"100vh",background:"#0f0f12",color:"#e9ecf1",padding:"24px 16px",display:"flex",justifyContent:"center"},container:{width:"100%",maxWidth:980},top:{display:"flex",alignItems:"center",gap:12,marginBottom:16},backBtn:{padding:"10px 14px",background:"#20222a",border:"1px solid #2b2e38",borderRadius:12,color:"#fff",cursor:"pointer"},title:{margin:0,fontSize:28,fontWeight:800},table:{background:"rgba(255,255,255,.02)",border:"1px solid rgba(255,255,255,.08)",borderRadius:16,overflow:"hidden"},thead:{display:"grid",gridTemplateColumns:"1fr 220px",padding:"12px 16px",borderBottom:"1px solid rgba(255,255,255,.08)",color:"#c7cfdb"},row:{display:"grid",gridTemplateColumns:"1fr 220px",padding:"12px 16px",borderBottom:"1px solid rgba(255,255,255,.06)"},colPlayer:{display:"flex",alignItems:"center",gap:10,minWidth:0},colReady:{display:"flex",alignItems:"center",justifyContent:"flex-end"},avatar:{width:28,height:28,borderRadius:999,background:"#1f2430",display:"grid",placeItems:"center",color:"#c7cfdb",fontSize:12,textTransform:"lowercase"},badgeHost:{marginLeft:8,fontSize:12,background:"#fde68a",color:"#111827",padding:"2px 8px",borderRadius:999,fontWeight:800},badgeYou:{marginLeft:8,fontSize:12,background:"#bfdbfe",color:"#111827",padding:"2px 8px",borderRadius:999,fontWeight:800},loading:{padding:16,color:"#c7cfdb"},pillReady:{background:"rgba(34,197,94,.15)",color:"#22c55e",padding:"6px 10px",borderRadius:999,fontWeight:700},pillWait:{background:"rgba(245,158,11,.14)",color:"#f59e0b",padding:"6px 10px",borderRadius:999,fontWeight:700},footer:{display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:16},statusWrap:{display:"flex",alignItems:"center",gap:6,color:"#c7cfdb"},dot:{width:8,height:8,borderRadius:"50%"},btn:{padding:"12px 16px",border:0,borderRadius:12,fontWeight:800,cursor:"pointer"},btnPrimary:{background:"#4f46e5",color:"#fff",boxShadow:"0 8px 24px rgba(79,70,229,.25)"},btnPurple:{background:"#7c3aed",color:"#fff"},btnDark:{background:"#20222a",color:"#fff",border:"1px solid #2b2e38"},btnGhost:{background:"transparent",color:"#e9ecf1",border:"1px solid rgba(255,255,255,.15)"},disabled:{opacity:.5,cursor:"not-allowed",filter:"grayscale(.25)"}},_x="/board.jpg",Ou=800,Tu=700,Ma=[{nx:.9278494291885221,ny:.9008218764923216},{nx:.8188460351743289,ny:.9120818357755046},{nx:.7145819191607529,ny:.920124663834921},{nx:.6016291268127121,ny:.920124663834921},{nx:.49104597346497997,ny:.9233417950586875},{nx:.37888306078370876,ny:.920124663834921},{nx:.24618327676643012,ny:.9152989669992712},{nx:.21695772909595804,ny:.7994822429436751},{nx:.1853625424251774,ny:.7270967904089275},{nx:.1340203640851589,ny:.6354085505315806},{nx:.12851782363977485,ny:.5145797598627787},{nx:.12664165103189493,ny:.37392795883361923},{nx:.05347091932457786,ny:.30017152658662094},{nx:.051594746716697934,ny:.20240137221269297},{nx:.14540337711069418,ny:.12006861063464837},{nx:.23921200750469043,ny:.11663807890222985},{nx:.3771106941838649,ny:.11663807890222985},{nx:.5037523452157598,ny:.12006861063464837},{nx:.5975609756097561,ny:.1320754716981132},{nx:.5984990619136961,ny:.24356775300171526},{nx:.5065666041275797,ny:.2692967409948542},{nx:.398686679174484,ny:.27101200686106347},{nx:.28893058161350843,ny:.27101200686106347},{nx:.2373358348968105,ny:.3687821612349914},{nx:.23921200750469043,ny:.48027444253859347},{nx:.24202626641651032,ny:.5660377358490566},{nx:.26454033771106944,ny:.6895368782161235},{nx:.3330206378986867,ny:.6946826758147513},{nx:.35647279549718575,ny:.5831903945111492},{nx:.35647279549718575,ny:.4716981132075472},{nx:.3818011257035647,ny:.37735849056603776},{nx:.5225140712945591,ny:.3653516295025729},{nx:.6238273921200751,ny:.3687821612349914},{nx:.7223264540337712,ny:.40308747855917665},{nx:.6613508442776735,ny:.5197255574614065},{nx:.5300187617260788,ny:.5025728987993139},{nx:.4427767354596623,ny:.5694682675814752},{nx:.4896810506566604,ny:.6861063464837049},{nx:.6163227016885553,ny:.6861063464837049},{nx:.724202626641651,ny:.6861063464837049},{nx:.8273921200750469,ny:.660377358490566},{nx:.8395872420262664,ny:.5368782161234992},{nx:.8395872420262664,ny:.4339622641509434},{nx:.8283302063789869,ny:.313893653516295},{nx:.7176360225140713,ny:.30017152658662094},{nx:.6876172607879925,ny:.22298456260720412},{nx:.698874296435272,ny:.1457975986277873},{nx:.8020637898686679,ny:.11663807890222985},{nx:.8958724202626641,ny:.11663807890222985},{nx:.9446529080675422,ny:.21783876500857632},{nx:.9446529080675422,ny:.3293310463121784},{nx:.9380863039399625,ny:.45797598627787306},{nx:.9409005628517824,ny:.5711835334476844},{nx:.950281425891182,ny:.6723842195540308},{nx:.9540337711069419,ny:.7804459691252144}],Ds=Ma.length;function sm(t,e,n){return{x:t.nx*e,y:t.ny*n}}Ma.map(t=>[t.nx*Ou,t.ny*Tu]);function kx({visible:t=!0,boardWidth:e,boardHeight:n}){return t?a.jsx("div",{className:"markersLayer",children:Ma.map((r,o)=>{const{x:s,y:i}=sm(r,e,n);return a.jsx("div",{className:"marker",style:{left:s,top:i},title:`Casa ${o+1}`,children:o+1},o)})}):null}function Ex({boardRef:t,expected:e=55,onFinish:n,initial:r=[]}){const[o,s]=E.useState(r);function i(x){if(!(t!=null&&t.current))return;const y=t.current.getBoundingClientRect(),b=x.clientX-y.left,_=x.clientY-y.top,p=b/y.width,m=_/y.height;s(g=>g.length>=e?g:[...g,{nx:p,ny:m}])}function l(){s(x=>x.slice(0,-1))}function u(){s([])}const c=E.useMemo(()=>JSON.stringify(o,null,2),[o]);async function d(){try{await navigator.clipboard.writeText(c),alert("Copiado para a rea de transferncia!")}catch{alert("No foi possvel copiar. Use o boto Baixar.")}}function h(){const x=new Blob([c],{type:"application/json"}),y=URL.createObjectURL(x),b=document.createElement("a");b.href=y,b.download="track-points-55.json",document.body.appendChild(b),b.click(),b.remove(),URL.revokeObjectURL(y)}function f(){n==null||n(o),console.log(`TRACK_POINTS_NORM (cole em src/data/track.js):
`,c),alert("Finalizado! O JSON foi impresso no console. Copie e cole em src/data/track.js")}return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"recLayer",onClick:i}),a.jsx("div",{className:"recDotsLayer",pointerEvents:"none",children:o.map((x,y)=>a.jsx("div",{className:"recDot",style:{left:`${x.nx*100}%`,top:`${x.ny*100}%`},title:`Casa ${y+1}`,children:y+1},y))}),a.jsxs("div",{className:"recToolbar",children:[a.jsxs("div",{className:"recInfo",children:[a.jsx("b",{children:"Gravando trilha"}),"  clique nas casas na ordem.",a.jsxs("span",{children:["Marcados: ",a.jsx("b",{children:o.length})," / ",e]})]}),a.jsxs("div",{className:"recBtns",children:[a.jsx("button",{onClick:l,disabled:!o.length,children:"Desfazer"}),a.jsx("button",{onClick:u,disabled:!o.length,children:"Limpar"}),a.jsx("button",{onClick:d,disabled:!o.length,children:"Copiar JSON"}),a.jsx("button",{onClick:h,disabled:!o.length,children:"Baixar .json"}),a.jsx("button",{onClick:f,disabled:o.length!==e,children:"Finalizar"})]})]})]})}const jx=40,Cx=1.15,Rx=3,Nx="0 8px 18px rgba(0,0,0,.35)",ff={cash:18e3,possibAt:0,clientsAt:0,faturamento:770,manutencao:1150,emprestimos:0,vendedoresComuns:0,fieldSales:0,insideSales:0,mixDBens:4e3,erpClientes:0,manualOnboarding:!0,azul:0,amarelo:0,roxo:0,gestores:0};function Dx({players:t,turnIdx:e,recordTrack:n=!1,matchId:r,me:o,onMeHud:s}){const i=E.useRef(null),[l,u]=E.useState({w:Ou,h:Tu}),c=(o==null?void 0:o.id)||Ys(),d=co("Jogador"),h=E.useMemo(()=>(t==null?void 0:t.find(w=>w.id===c))||null,[t,c]),f=(o==null?void 0:o.name)||(h==null?void 0:h.name)||d,x=(h==null?void 0:h.color)||"#6c5ce7",y=E.useMemo(()=>`sg_stats_v1:${r||"local"}:${c}`,[r,c]),[b,_]=E.useState(()=>{try{const w=sessionStorage.getItem(y);return w?JSON.parse(w):ff}catch{return ff}});E.useEffect(()=>{try{sessionStorage.setItem(y,JSON.stringify(b))}catch{}},[y,b]),E.useEffect(()=>{const w={id:c,name:f,color:x,cash:b.cash,possibAt:b.possibAt,clientsAt:b.clientsAt,matchId:r||"local"};s==null||s(w),document.dispatchEvent(new CustomEvent("sg:meHud",{detail:w}))},[c,f,x,b.cash,b.possibAt,b.clientsAt,r]),E.useLayoutEffect(()=>{if(!i.current)return;const w=i.current,j=new ResizeObserver(R=>{for(const C of R){const S=C.contentRect;u({w:S.width,h:S.height})}});return j.observe(w),()=>j.disconnect()},[]);const p=l.w/Ou,m=l.h/Tu,g=Math.min(p,m);return a.jsxs("div",{className:"board",ref:i,children:[a.jsx("img",{src:_x,alt:"Board",className:"boardImg"}),n&&a.jsx(Ex,{boardRef:i,expected:55,onFinish:w=>{console.log("TRACK_POINTS_NORM (cole em src/data/track.js):",JSON.stringify(w,null,2))}}),!n&&a.jsxs(a.Fragment,{children:[a.jsx(kx,{visible:!1,boardWidth:l.w,boardHeight:l.h}),t.map((w,j)=>{const R=j===e,C=(w.pos%Ds+Ds)%Ds,S=Ma[C],A=sm(S,l.w,l.h),v=j*12*g,O=jx*g*(R?Cx:1),M=Math.max(2,Rx*g),te=["","","","","","","",""],ne=te[j%te.length];return a.jsx("div",{className:"token",style:{position:"absolute",left:A.x+v,top:A.y-v,transform:"translate(-50%, -50%)",width:O,height:O,borderRadius:"50%",background:w.color,border:`${M}px solid rgba(255,255,255,.95)`,boxShadow:Nx,pointerEvents:"none",display:"grid",placeItems:"center",color:"#000",fontWeight:900,userSelect:"none",zIndex:R?4:3,fontSize:`${Math.max(16,O*.6)}px`},title:`${w.name}  Casa ${C+1}`,"aria-label":`${w.name} est na casa ${C+1}`,children:R?"":ne},w.id)})]})]})}function Ax({totals:t,players:e}){return E.useEffect(()=>{console.groupCollapsed("[HUD] totals"),console.log(t),console.groupEnd()},[t]),a.jsxs("div",{className:"hud",children:[a.jsxs("div",{className:"panel",children:[a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Faturamento:"})," ",a.jsxs("span",{className:"pos",children:["$ ",t.faturamento]})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Manuteno:"})," ",a.jsxs("span",{className:"neg",children:["$ ",t.manutencao]})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Emprstimos:"})," ",a.jsxs("span",{children:["$ ",t.emprestimos]})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Vendedores Comuns:"})," ",a.jsx("span",{children:t.vendedoresComuns})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Field Sales:"})," ",a.jsx("span",{children:t.fieldSales})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Inside Sales:"})," ",a.jsx("span",{children:t.insideSales})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Mix Produtos:"})," ",a.jsx("span",{children:t.mixProdutos})," ",a.jsx("b",{children:" Bens:"})," ",a.jsxs("span",{children:["$ ",t.bens]})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"ERP/Sistemas:"})," ",a.jsx("span",{children:t.erpSistemas})," ",a.jsx("b",{children:" Clientes:"})," ",a.jsx("span",{children:t.clientes})]}),a.jsxs("div",{children:[a.jsx("b",{children:"Manual Onboarding:"})," "]}),a.jsxs("div",{children:[a.jsx("b",{children:"Azul:"})," ",a.jsx("span",{children:t.az||0})," ",a.jsx("b",{children:" Amarelo: "}),a.jsx("span",{children:t.am||0})," ",a.jsx("b",{children:"Roxo:"})," ",a.jsx("span",{children:t.rox||0})]}),a.jsxs("div",{children:[a.jsx("b",{children:"Gestores Comerciais:"})," ",a.jsx("span",{children:t.gestores??t.gestoresComerciais??0})]}),a.jsxs("div",{children:[a.jsx("b",{children:"Capacidade:"})," ",a.jsx("span",{children:t.possibAt??0}),"  ",a.jsx("b",{children:"Em Atendimento:"})," ",a.jsx("span",{children:t.clientsAt??0})]})]}),a.jsxs("div",{className:"score",children:[a.jsx("div",{className:"title",children:"Placar"}),e.map(n=>a.jsxs("div",{className:"row",children:[a.jsx("span",{children:n.name}),a.jsx("span",{children:n.cash})]},n.id))]})]})}function Ox({onAction:t,current:e,isMyTurn:n=!0}){const r=!!(e!=null&&e.bankrupt),o=!!n&&!r;E.useEffect(()=>{console.groupCollapsed("[Controls] render"),console.log("current player:",e),console.log("isMyTurn prop:",n),console.log("isBankrupt:",r),console.log("canRoll (final):",o),console.groupEnd()},[e==null?void 0:e.id,e==null?void 0:e.name,e==null?void 0:e.bankrupt,n,o]);const s=()=>{if(console.log("[Controls] click => Rolar Dado & Andar (canRoll=%s)",o),!o)return;const u=Math.floor(Math.random()*6)+1,c=0,d=`Dado: ${u}`;console.log("[Controls] onAction ROLL => steps=%d cashDelta=%d note=%s",u,c,d),t==null||t({type:"ROLL",steps:u,cashDelta:c,note:d})},i=async()=>{r||(console.log("[Controls] click => Recuperao Financeira"),t==null||t({type:"RECOVERY_MODAL"}))},l=async()=>{r||(console.log("[Controls] click => Declarar Falncia"),t==null||t({type:"BANKRUPT_MODAL"}))};return a.jsxs("div",{className:`controls ${o?"":"is-wait"} ${r?"is-bankrupt":""}`,children:[a.jsx("button",{className:"btn primary",onClick:i,disabled:r,"aria-disabled":r,children:"RECUPERAO FINANCEIRA"}),a.jsx("button",{className:"btn dark",onClick:l,disabled:r,"aria-disabled":r,children:"DECLARAR FALNCIA"}),a.jsxs("div",{className:"turnBox",children:[a.jsxs("div",{children:["Vez de: ",a.jsx("b",{children:e==null?void 0:e.name})]}),a.jsx("button",{className:"btn go",onClick:s,disabled:!o,"aria-disabled":!o,children:"Rolar Dado & Andar"})]})]})}function si({children:t,onClose:e,zIndex:n=3e3}){const r=()=>{typeof e=="function"&&e()};return a.jsx("div",{className:"sg-modal-backdrop",style:{position:"fixed",inset:0,background:"rgba(8,10,16,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:n},onClick:r,children:a.jsx("div",{className:"sg-modal-card",style:{position:"relative",background:"#0f1420",border:"1px solid rgba(255,255,255,.1)",borderRadius:14,width:"min(780px, 92vw)",maxWidth:"92vw",color:"#fff",boxShadow:"0 20px 60px rgba(0,0,0,.45)"},onClick:o=>o.stopPropagation(),children:t})})}function Tx({players:t=[],onExit:e,onResolve:n}){const r=E.useMemo(()=>{const u=[...t].map(c=>({...c,patrimonio:(Number(c.cash)||0)+(Number(c.bens)||0)})).sort((c,d)=>d.patrimonio-c.patrimonio);return[u[1],u[0],u[2]]},[t]),o=r==null?void 0:r[1],s=r==null?void 0:r[0],i=r==null?void 0:r[2],l=()=>{n?n({action:"EXIT"}):e==null||e()};return a.jsx(si,{zIndex:2147483647,onClose:()=>{},children:a.jsxs("div",{style:qn.wrap,children:[a.jsx("h1",{style:qn.title,children:" Fim da 5 Rodada"}),a.jsxs("p",{style:qn.subtitle,children:["Vence quem tiver ",a.jsx("b",{children:"Saldo + Bens"}),". Eis o pdio:"]}),a.jsxs("div",{style:qn.podium,children:[a.jsx(_l,{place:"second",player:s}),a.jsx(_l,{place:"first",player:o,big:!0}),a.jsx(_l,{place:"third",player:i})]}),a.jsx("div",{style:{display:"flex",gap:12,marginTop:18,flexWrap:"wrap",justifyContent:"center"},children:a.jsx("button",{style:qn.btn,onClick:l,children:" Voltar aos Lobbies"})})]})})}function _l({place:t,player:e,big:n}){if(!e)return a.jsx("div",{style:{width:220}});const r={first:kl("#d4af37","#f5d76e"),second:kl("#9fa4ad","#cfd4db"),third:kl("#b87333","#d28c45")},o={first:"1",second:"2",third:"3"}[t],s=r[t].ring,i=r[t].face;return a.jsxs("div",{style:{...qn.medalCol,transform:n?"translateY(-18px)":"none"},children:[a.jsx("div",{style:qn.ribbon}),a.jsx("div",{style:{...qn.medal,...s,width:n?180:150,height:n?180:150},children:a.jsx("div",{style:{...qn.medalFace,...i},children:a.jsx("div",{style:qn.medalNumber,children:o})})}),a.jsxs("div",{style:qn.cardBelow,children:[a.jsx("div",{style:{fontWeight:900,fontSize:16,lineHeight:1.2,textAlign:"center"},children:e.name}),a.jsxs("div",{style:{opacity:.9,fontSize:13,marginTop:4,textAlign:"center"},children:["Saldo: ",a.jsxs("b",{children:["$ ",Number(e.cash||0).toLocaleString()]}),a.jsx("br",{}),"Bens: ",a.jsxs("b",{children:["$ ",Number(e.bens||0).toLocaleString()]})]}),a.jsxs("div",{style:{marginTop:6,fontWeight:900,textAlign:"center"},children:["Patrimnio: ",a.jsxs("b",{children:["$ ",Number(e.patrimonio||0).toLocaleString()]})]})]})]})}function kl(t,e){return{ring:{background:`radial-gradient(circle at 35% 30%, ${e} 0%, ${t} 65%, #000 120%)`,boxShadow:"0 12px 30px rgba(0,0,0,.35), inset 0 0 12px rgba(255,255,255,.12)"},face:{background:`conic-gradient(from 0deg, ${e}, ${t}, ${e})`}}}const qn={wrap:{pointerEvents:"auto",border:"1px solid rgba(255,255,255,.15)",background:"#11161f",color:"#eef1f6",borderRadius:16,padding:20,width:"min(900px, 92vw)",maxWidth:"92vw",textAlign:"center"},title:{margin:"0 0 6px",fontWeight:900,fontSize:28},subtitle:{margin:"0 0 14px",opacity:.9},podium:{display:"flex",alignItems:"flex-end",justifyContent:"center",gap:24,padding:"10px 0",flexWrap:"wrap"},medalCol:{display:"flex",flexDirection:"column",alignItems:"center"},ribbon:{width:16,height:70,background:"linear-gradient(#e41f1f,#9e1313)",borderRadius:4,marginBottom:-12},medal:{borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",border:"3px solid rgba(255,255,255,.18)"},medalFace:{width:"85%",height:"85%",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"inset 0 8px 18px rgba(0,0,0,.35), inset 0 -6px 10px rgba(255,255,255,.08)"},medalNumber:{fontWeight:900,fontSize:28,letterSpacing:1,textShadow:"0 2px 4px rgba(0,0,0,.45)"},cardBelow:{background:"#19202c",border:"1px solid rgba(255,255,255,.12)",borderRadius:12,padding:"10px 12px",width:220,marginTop:10},btn:{background:"#2a3342",color:"#fff",border:"1px solid rgba(255,255,255,.18)",borderRadius:10,padding:"10px 14px",fontWeight:800,cursor:"pointer"}},im=E.createContext(null);function Px({children:t}){const[e,n]=E.useState([]),r=E.useRef(null),o=d=>{const h=r.current;r.current=null,n(f=>f.slice(0,-1)),h&&h(d)},s=()=>o({action:"SKIP"}),i=()=>o(!1),l=d=>{var x;const h=((x=crypto==null?void 0:crypto.randomUUID)==null?void 0:x.call(crypto))||String(Date.now()+Math.random()),f=ge.cloneElement(d,{onResolve:y=>o(y)});n(y=>[...y,{id:h,el:f}])},u=()=>new Promise(d=>{r.current=d}),c=E.useMemo(()=>({pushModal:l,awaitTop:u,resolveTop:o,closeModal:s,popModal:i}),[]);return a.jsxs(im.Provider,{value:c,children:[t,e.map(({id:d,el:h})=>a.jsx(ge.Fragment,{children:h},d))]})}const nn=()=>E.useContext(im);function Lx({playerName:t="Jogador"}){const{resolveTop:e,closeModal:n}=nn();return a.jsx(si,{width:700,onClose:n,children:a.jsx("div",{className:"bankruptcyModal",children:a.jsxs("div",{className:"paper",style:{padding:24},children:[a.jsx("h2",{style:{marginTop:0},children:"Declarar Falncia"}),a.jsxs("p",{children:["Tem certeza que deseja declarar ",a.jsx("b",{children:"Falncia"}),", ",a.jsx("b",{children:t}),"?",a.jsx("br",{}),"Esta ao  irreversvel e voc no poder mais jogar."]}),a.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end",marginTop:24},children:[a.jsx("button",{onClick:()=>{n(),e(!1)},className:"btn",children:"Cancelar"}),a.jsx("button",{onClick:()=>{n(),e(!0)},className:"btn btn-danger",children:"Sim, declarar falncia"})]})]})})})}const Zt={comum:{cap:2,baseFat:600,incFat:100,baseDesp:100,incDesp:100},inside:{cap:5,baseFat:1500,incFat:500,baseDesp:2e3,incDesp:100},field:{cap:5,baseFat:1500,incFat:500,baseDesp:2e3,incDesp:100}},Pu={baseDesp:3e3,incDesp:500,boostByCert:[.2,.3,.4,.6]},am={A:{fat:1200,desp:700},B:{fat:600,desp:400},C:{fat:300,desp:200},D:{fat:100,desp:50}},lm={A:{fat:1e3,desp:400},B:{fat:500,desp:200},C:{fat:200,desp:100},D:{fat:70,desp:50}},en=t=>Number(t||0),fr=(t={},e)=>{var n;return new Set(((n=t==null?void 0:t.trainingsByVendor)==null?void 0:n[e])||[]).size},$x=t=>fr(t,"gestor");function ga(t={}){const e=Math.max(0,en(t.vendedoresComuns)),n=Math.max(0,en(t.insideSales)),r=Math.max(0,en(t.fieldSales)),o=e*Zt.comum.cap,s=n*Zt.inside.cap,i=r*Zt.field.cap,l=o+s+i,u=Math.max(0,en(t.clients)),c=Math.min(u,l);return{cap:l,inAtt:c}}function Ba(t={}){var C,S;const e=en(t.vendedoresComuns),n=en(t.insideSales),r=en(t.fieldSales),o=en(t.gestores??t.gestoresComerciais??t.managers),s=fr(t,"comum"),i=fr(t,"inside"),l=fr(t,"field"),u=fr(t,"gestor"),c=e*(Zt.comum.baseFat+Zt.comum.incFat*s),d=n*(Zt.inside.baseFat+Zt.inside.incFat*i),h=r*(Zt.field.baseFat+Zt.field.incFat*l);let f=c+d+h;const x=e+n+r,y=x>0?Math.min(1,o*7/x):0,b=Pu.boostByCert[Math.min(3,Math.max(0,u))]||0;f=f*(1+y*b);const _=String(t.mixProdutos||"D").toUpperCase(),p=(((C=am[_])==null?void 0:C.fat)||0)*en(t.clients),m=String(t.erpLevel||"D").toUpperCase(),g=x+o,w=(((S=lm[m])==null?void 0:S.fat)||0)*g,j=en(t.revenue);return Math.max(0,Math.floor(f+p+w+j))}function Ua(t={}){var j,R;const e=en(t.vendedoresComuns),n=en(t.insideSales),r=en(t.fieldSales),o=en(t.gestores??t.gestoresComerciais??t.managers),s=fr(t,"comum"),i=fr(t,"inside"),l=fr(t,"field"),u=fr(t,"gestor"),c=e*(Zt.comum.baseDesp+Zt.comum.incDesp*s),d=n*(Zt.inside.baseDesp+Zt.inside.incDesp*i),h=r*(Zt.field.baseDesp+Zt.field.incDesp*l),f=o*(Pu.baseDesp+Pu.incDesp*u),x=String(t.mixProdutos||"D").toUpperCase(),y=(((j=am[x])==null?void 0:j.desp)||0)*en(t.clients),b=String(t.erpLevel||"D").toUpperCase(),_=e+n+r+o,p=(((R=lm[b])==null?void 0:R.desp)||0)*_;return Math.max(0,Math.floor(c+d+h+f+y+p+0+1e3))}function Tt(t,e={}){var o,s;const n={...t},r=(i,l)=>{n[i]=(n[i]??0)+l};if(Number.isFinite(e.cashDelta)&&r("cash",Number(e.cashDelta)),Number.isFinite(e.clientsDelta)&&r("clients",Number(e.clientsDelta)),Number.isFinite(e.manutencaoDelta)&&r("manutencao",Number(e.manutencaoDelta)),Number.isFinite(e.bensDelta)&&r("bens",Number(e.bensDelta)),Number.isFinite(e.vendedoresComunsDelta)&&r("vendedoresComuns",Number(e.vendedoresComunsDelta)),Number.isFinite(e.fieldSalesDelta)&&r("fieldSales",Number(e.fieldSalesDelta)),Number.isFinite(e.insideSalesDelta)&&r("insideSales",Number(e.insideSalesDelta)),Number.isFinite(e.gestoresDelta)){const i=Number(e.gestoresDelta);n.gestores=(n.gestores??0)+i,n.gestoresComerciais=(n.gestoresComerciais??0)+i,n.managers=(n.managers??0)+i}if(Number.isFinite(e.revenueDelta)&&r("revenue",Number(e.revenueDelta)),typeof e.mixProdutosSet<"u"){n.mixProdutos=e.mixProdutosSet;const i=String(e.mixProdutosSet).toUpperCase();["A","B","C","D"].includes(i)&&(n.mixOwned={...n.mixOwned||{},[i]:!0},(o=n.reducedLevels)!=null&&o.MIX&&(n.reducedLevels={...n.reducedLevels,MIX:n.reducedLevels.MIX.filter(l=>l!==i)}))}if(e.mixBaseSet&&(n.mixBase={...n.mixBase||{},...e.mixBaseSet}),typeof e.erpLevelSet<"u"){n.erpLevel=e.erpLevelSet;const i=String(e.erpLevelSet).toUpperCase();["A","B","C","D"].includes(i)&&(n.erpOwned={...n.erpOwned||{},[i]:!0},(s=n.reducedLevels)!=null&&s.ERP&&(n.reducedLevels={...n.reducedLevels,ERP:n.reducedLevels.ERP.filter(l=>l!==i)}))}return Array.isArray(e.trainingsPush)&&e.trainingsPush.length&&(n.trainings=[...n.trainings||[],...e.trainingsPush]),Array.isArray(e.directBuysPush)&&e.directBuysPush.length&&(n.directBuys=[...n.directBuys||[],...e.directBuysPush]),n}function hf(t,e){const{purchases:n=[],grandTotal:r=0}=e||{},o={personalizado:"az",fieldsales:"am",imersaomultiplier:"rox"},s={...t};return s.cash=(s.cash??0)-Number(r||0),s.bens=(s.bens??0)+Number(r||0),s.onboarding=!0,n.forEach(i=>{var h;const{vendorType:l,items:u=[]}=i||{};u.forEach(f=>{const x=o[f==null?void 0:f.id];x&&(s[x]=(s[x]??0)+1)});const c=String(l||"comum"),d=new Set(((h=s.trainingsByVendor)==null?void 0:h[c])||[]);u.forEach(f=>{f!=null&&f.id&&d.add(f.id)}),s.trainingsByVendor={...s.trainingsByVendor||{},[c]:Array.from(d)}}),s}function El(t,e,n){return t===e?!1:t<e?n>t&&n<=e:n>t||n<=e}function As(t){return t.reduce((e,n)=>e+(n!=null&&n.bankrupt?0:1),0)}function fs(t,e){var s;const n=t.length;if(n===0)return 0;let r=(e+1)%n,o=0;for(;o<n;){if(!((s=t[r])!=null&&s.bankrupt))return r;r=(r+1)%n,o++}return e}class um{constructor(){this.errors=[],this.warnings=[]}validateGameState(e,n,r,o,s){return this.errors=[],this.warnings=[],this.validatePlayers(e),this.validateTurnState(e,n),this.validateGameOverState(e,o,s),this.validateRoundState(e,r),{isValid:this.errors.length===0,errors:this.errors,warnings:this.warnings}}validatePlayers(e){if(!Array.isArray(e)||e.length===0){this.addError("Jogadores invlidos: deve ser um array no vazio");return}e.forEach((n,r)=>{this.validatePlayer(n,r)}),this.validatePlayerUniqueness(e),this.validateAlivePlayers(e)}validatePlayer(e,n){const r=`Jogador ${n+1} (${e.name||"Sem nome"})`;e.id||this.addError(`${r}: ID  obrigatrio`),(typeof e.cash!="number"||e.cash<0)&&this.addError(`${r}: Cash deve ser um nmero no negativo (atual: ${e.cash})`),(typeof e.clients!="number"||e.clients<0)&&this.addError(`${r}: Clientes deve ser um nmero no negativo (atual: ${e.clients})`),this.validateResourceCounts(e,r),this.validateCalculations(e,r)}validateResourceCounts(e,n){["vendedoresComuns","fieldSales","insideSales","gestores","gestoresComerciais","managers"].forEach(s=>{const i=e[s];i!==void 0&&(typeof i!="number"||i<0)&&this.addError(`${n}: ${s} deve ser um nmero no negativo (atual: ${i})`)}),["az","am","rox"].forEach(s=>{const i=e[s];i!==void 0&&(typeof i!="number"||i<0)&&this.addError(`${n}: Certificado ${s} deve ser um nmero no negativo (atual: ${i})`)})}validateCalculations(e,n){try{const r=Ba(e),o=Ua(e),{cap:s,inAtt:i}=ga(e);(typeof r!="number"||r<0)&&this.addError(`${n}: Faturamento calculado invlido: ${r}`),(typeof o!="number"||o<0)&&this.addError(`${n}: Manuteno calculada invlida: ${o}`),(typeof s!="number"||s<0)&&this.addError(`${n}: Capacidade calculada invlida: ${s}`),(typeof i!="number"||i<0||i>s)&&this.addError(`${n}: Clientes em atendimento invlido: ${i} (capacidade: ${s})`),this.isInitialState(e)&&o!==1150&&this.addError(`${n}: Manuteno inicial deve ser 1150, mas  ${o}`)}catch(r){this.addError(`${n}: Erro ao calcular faturamento/manuteno: ${r.message}`)}}isInitialState(e){return e.vendedoresComuns===1&&e.clients===1&&e.fieldSales===0&&e.insideSales===0&&e.gestores===0&&e.mixProdutos==="D"&&e.erpLevel==="D"&&(e.az||0)===0&&(e.am||0)===0&&(e.rox||0)===0}validatePlayerUniqueness(e){const n=e.map(o=>o.id).filter(Boolean),r=new Set(n);n.length!==r.size&&this.addError("IDs de jogadores devem ser nicos")}validateAlivePlayers(e){const n=As(e);n===0&&this.addError("No pode haver zero jogadores vivos"),n===1&&this.addWarning("Apenas 1 jogador vivo - jogo deve terminar")}validateTurnState(e,n){if(typeof n!="number"||n<0||n>=e.length){this.addError(`TurnIdx invlido: ${n} (deve estar entre 0 e ${e.length-1})`);return}const r=e[n];if(!r){this.addError(`Jogador do turno no encontrado no ndice ${n}`);return}r.bankrupt&&this.addError(`Jogador do turno (${r.name}) est falido`)}validateGameOverState(e,n,r){const o=As(e);n&&o>1&&this.addError("Jogo marcado como terminado mas h mais de 1 jogador vivo"),n&&!r&&this.addError("Jogo terminado mas no h vencedor definido"),r&&!n&&this.addError("H vencedor definido mas jogo no terminou"),r&&r.bankrupt&&this.addError("Vencedor no pode estar falido")}validateRoundState(e,n){(typeof n!="number"||n<1)&&this.addError(`Rodada invlida: ${n} (deve ser >= 1)`),n>10&&this.addWarning(`Rodada muito alta: ${n} (jogo pode estar travado)`)}validateAction(e,n,r){switch(this.errors=[],this.warnings=[],e.type){case"MOVE":this.validateMoveAction(e,n);break;case"BUY":this.validateBuyAction(e,n);break;case"HIRE":this.validateHireAction(e,n);break;case"BANKRUPT":this.validateBankruptAction(e,n);break;default:this.addWarning(`Tipo de ao no reconhecido: ${e.type}`)}return{isValid:this.errors.length===0,errors:this.errors,warnings:this.warnings}}validateMoveAction(e,n){(typeof e.steps!="number"||e.steps<1||e.steps>6)&&this.addError(`Passos invlidos: ${e.steps} (deve estar entre 1 e 6)`)}validateBuyAction(e,n){const r=e.cost||e.price||0;r>n.cash&&this.addError(`Saldo insuficiente: precisa de ${r}, tem ${n.cash}`)}validateHireAction(e,n){const r=e.cost||0;r>n.cash&&this.addError(`Saldo insuficiente para contratao: precisa de ${r}, tem ${n.cash}`)}validateBankruptAction(e,n){n.bankrupt||this.addWarning("Jogador declarando falncia mas no est marcado como falido")}addError(e){this.errors.push(e)}addWarning(e){this.warnings.push(e)}}function Ix(t,e,n,r,o){return new um().validateGameState(t,e,n,r,o)}function Mx(t,e,n){return new um().validateAction(t,e,n)}class Bx{constructor(){this.enabled=!1,this.logs=[],this.maxLogs=1e4,this.originalConsole={log:console.log,warn:console.warn,error:console.error,debug:console.debug,info:console.info},this.prefixes=["[DEBUG]","[NET]","[App]","[SG]","[Controls]","[HUD]","[DEBUG MODE]","[PlayersLobby]","[leaveRoom]","[GameNet]","[useTurnEngine]","[useGameSync]"]}shouldCapture(e){if(!this.enabled)return!1;const n=e.map(r=>{if(typeof r=="object")try{return JSON.stringify(r)}catch{return String(r)}return String(r)}).join(" ");return this.prefixes.some(r=>n.includes(r))}addLog(e,n){this.logs.length>=this.maxLogs&&(this.logs=this.logs.slice(-Math.floor(this.maxLogs*.9)));const r=Date.now(),o={timestamp:r,time:new Date(r).toISOString(),level:e,args:n.map(s=>{if(typeof s=="object"&&s!==null)try{return JSON.parse(JSON.stringify(s,(i,l)=>typeof l=="function"?"[Function]":l===void 0?"[undefined]":Array.isArray(l)&&l.length>100?`[Array(${l.length}) - truncado]`:l))}catch{return String(s)}return s}),message:n.map(s=>{if(typeof s=="object")try{return JSON.stringify(s)}catch{return String(s)}return String(s)}).join(" ")};this.logs.push(o)}interceptLog(...e){this.shouldCapture(e)&&this.addLog("log",e),this.originalConsole.log.apply(console,e)}interceptWarn(...e){this.shouldCapture(e)&&this.addLog("warn",e),this.originalConsole.warn.apply(console,e)}interceptError(...e){this.addLog("error",e),this.originalConsole.error.apply(console,e)}interceptDebug(...e){this.shouldCapture(e)&&this.addLog("debug",e),this.originalConsole.debug.apply(console,e)}interceptInfo(...e){this.shouldCapture(e)&&this.addLog("info",e),this.originalConsole.info.apply(console,e)}enable(){this.enabled||(this.enabled=!0,console.log=this.interceptLog.bind(this),console.warn=this.interceptWarn.bind(this),console.error=this.interceptError.bind(this),console.debug=this.interceptDebug.bind(this),console.info=this.interceptInfo.bind(this),console.log("[LogCapture]  Captura de logs ativada"))}disable(){this.enabled&&(this.enabled=!1,console.log=this.originalConsole.log,console.warn=this.originalConsole.warn,console.error=this.originalConsole.error,console.debug=this.originalConsole.debug,console.info=this.originalConsole.info,console.log("[LogCapture]  Captura de logs desativada"))}clear(){this.logs=[],console.log("[LogCapture]  Histrico de logs limpo")}getLogs(){return[...this.logs]}getStats(){const e=this.logs.length,n={log:0,warn:0,error:0,debug:0,info:0};return this.logs.forEach(r=>{n[r.level]=(n[r.level]||0)+1}),{total:e,byLevel:n,enabled:this.enabled}}exportAsText(){const e=["=".repeat(80),"RELATRIO DE LOGS - Sales Game","=".repeat(80),`Data/Hora: ${new Date().toISOString()}`,`Total de logs: ${this.logs.length}`,`Estatsticas: ${JSON.stringify(this.getStats(),null,2)}`,"=".repeat(80),""];return this.logs.forEach(n=>{const r={log:"",warn:"",error:"",debug:"",info:""}[n.level]||"";e.push(`[${n.time}] ${r} [${n.level.toUpperCase()}]`),n.args.forEach((o,s)=>{typeof o=="object"?e.push(`  Arg ${s+1}: ${JSON.stringify(o,null,2)}`):e.push(`  Arg ${s+1}: ${o}`)}),e.push("")}),e.join(`
`)}exportAsJSON(){return{timestamp:new Date().toISOString(),stats:this.getStats(),logs:this.logs}}exportFull(){return{timestamp:new Date().toISOString(),stats:this.getStats(),text:this.exportAsText(),json:this.exportAsJSON()}}}const rr=new Bx,Ux=()=>rr.clear(),Lu=()=>rr.getStats(),Fx=()=>rr.exportAsText(),zx=()=>rr.exportAsJSON();class Wx{constructor(){this.enabled=!1,this.validationHistory=[],this.maxHistorySize=100}toggle(){return this.enabled=!this.enabled,this.enabled&&rr.enable(),console.log(`[DEBUG MODE] ${this.enabled?"ATIVADO":"DESATIVADO"}`),this.enabled}validateGameState(e,n,r,o,s,i=""){if(!this.enabled)return;const l=Ix(e,n,r,o,s);return this.addToHistory({type:"GAME_STATE",context:i,timestamp:Date.now(),result:l}),l.isValid||console.error("[DEBUG MODE]  Estado do jogo invlido:",l.errors),l.warnings.length>0&&console.warn("[DEBUG MODE]  Avisos:",l.warnings),l}validateAction(e,n,r,o=""){if(!this.enabled)return;const s=Mx(e,n,r);return this.addToHistory({type:"ACTION",context:o,timestamp:Date.now(),action:e.type,player:n.name,result:s}),s.isValid||console.error(`[DEBUG MODE]  Ao invlida (${e.type}):`,s.errors),s}validateResourceChange(e,n,r,o){if(!this.enabled)return;const s=[],i=[];if(n.clients!==r.clients){const c=r.clients-n.clients;r.clients<0&&s.push(`Clientes no pode ser negativo: ${r.clients}`),Math.abs(c)>10&&i.push(`Mudana grande de clientes: ${c}`)}if(n.cash!==r.cash){const c=r.cash-n.cash;r.cash<0&&s.push(`Cash no pode ser negativo: ${r.cash}`),Math.abs(c)>5e4&&i.push(`Mudana grande de cash: ${c}`)}["vendedoresComuns","fieldSales","insideSales","gestores"].forEach(c=>{if(n[c]!==r[c]){const d=r[c]-n[c];r[c]<0&&s.push(`${c} no pode ser negativo: ${r[c]}`),Math.abs(d)>5&&i.push(`Mudana grande de ${c}: ${d}`)}});const u={isValid:s.length===0,errors:s,warnings:i};return this.addToHistory({type:"RESOURCE_CHANGE",context:o,timestamp:Date.now(),player:e.name,oldState:n,newState:r,result:u}),u.isValid||console.error("[DEBUG MODE]  Mudana de recurso invlida:",u.errors),u}validateCalculations(e,n=""){if(this.enabled)try{const r=Ba(e),o=Ua(e),{cap:s,inAtt:i}=ga(e),l=[],u=[];(typeof r!="number"||r<0)&&l.push(`Faturamento invlido: ${r}`),(typeof o!="number"||o<0)&&l.push(`Manuteno invlida: ${o}`),(typeof s!="number"||s<0)&&l.push(`Capacidade invlida: ${s}`),(typeof i!="number"||i<0||i>s)&&l.push(`Clientes em atendimento invlido: ${i} (capacidade: ${s})`),this.isInitialState(e)&&o!==1150&&l.push(`Manuteno inicial deve ser 1150, mas  ${o}`);const c={isValid:l.length===0,errors:l,warnings:u,calculations:{faturamento:r,manutencao:o,cap:s,inAtt:i}};return this.addToHistory({type:"CALCULATIONS",context:n,timestamp:Date.now(),player:e.name,result:c}),c.isValid||console.error("[DEBUG MODE]  Clculos invlidos:",c.errors),c}catch(r){return console.error("[DEBUG MODE]  Erro ao validar clculos:",r),{isValid:!1,errors:[r.message],warnings:[]}}}isInitialState(e){return e.vendedoresComuns===1&&e.clients===1&&e.fieldSales===0&&e.insideSales===0&&e.gestores===0&&e.mixProdutos==="D"&&e.erpLevel==="D"}addToHistory(e){this.validationHistory.unshift(e),this.validationHistory.length>this.maxHistorySize&&(this.validationHistory=this.validationHistory.slice(0,this.maxHistorySize))}getHistory(){return this.validationHistory}clearHistory(){this.validationHistory=[]}getStats(){const e=this.validationHistory.length,n=this.validationHistory.filter(o=>!o.result.isValid).length,r=this.validationHistory.filter(o=>o.result.warnings.length>0).length;return{total:e,errors:n,warnings:r,errorRate:e>0?n/e*100:0,warningRate:e>0?r/e*100:0}}exportReport(){const e=this.getStats(),n={timestamp:new Date().toISOString(),stats:e,history:this.validationHistory};return console.log("[DEBUG MODE]  Relatrio de validao:",n),n}exportFullReport(){const e=this.exportReport(),n=rr.exportFull();return{timestamp:new Date().toISOString(),validation:e,logs:n,text:this.exportFullReportAsText(e,n)}}exportFullReportAsText(e,n){return["=".repeat(80),"RELATRIO COMPLETO DE DEBUG - Sales Game","=".repeat(80),`Data/Hora: ${new Date().toISOString()}`,"","--- VALIDAES ---",`Total de validaes: ${e.stats.total}`,`Erros: ${e.stats.errors}`,`Avisos: ${e.stats.warnings}`,`Taxa de erro: ${e.stats.errorRate.toFixed(2)}%`,"","--- LOGS CAPTURADOS ---",`Total de logs: ${n.stats.total}`,`Logs por nvel: ${JSON.stringify(n.stats.byLevel,null,2)}`,"","--- HISTRICO DE VALIDAES ---",...e.history.map(o=>`[${new Date(o.timestamp).toISOString()}] ${o.type} - ${o.context||""} - ${JSON.stringify(o.result,null,2)}`),"","--- LOGS DETALHADOS ---",n.text,"=".repeat(80)].join(`
`)}}const fo=new Wx,Vx=(t,e,n,r,o,s)=>fo.validateGameState(t,e,n,r,o,s),Gx=(t,e)=>fo.validateCalculations(t,e),pf=()=>fo.getStats(),qx=()=>fo.exportReport(),cm=()=>fo.exportFullReport();function Hx({players:t,turnIdx:e,round:n,gameOver:r,winner:o}){const[s,i]=E.useState(!1),[l,u]=E.useState({total:0,errors:0,warnings:0,errorRate:0,warningRate:0}),[c,d]=E.useState({total:0,byLevel:{},enabled:!1}),[h,f]=E.useState(!1),[x,y]=E.useState({x:0,y:0}),[b,_]=E.useState({x:0,y:0}),p=E.useRef(null);E.useEffect(()=>{const A=()=>{u(pf()),d(Lu())};A();const v=setInterval(A,1e3);return()=>clearInterval(v)},[]);const m=()=>{const A=fo.toggle();i(A)},g=()=>{const A=qx(),v=new Blob([JSON.stringify(A,null,2)],{type:"application/json"}),D=URL.createObjectURL(v),O=document.createElement("a");O.href=D,O.download=`debug-report-${new Date().toISOString().slice(0,19)}.json`,O.click(),URL.revokeObjectURL(D)},w=()=>{const A=cm(),v=new Blob([A.text],{type:"text/plain;charset=utf-8"}),D=URL.createObjectURL(v),O=document.createElement("a");O.href=D,O.download=`debug-logs-completo-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.txt`,O.click(),URL.revokeObjectURL(D);const M=new Blob([JSON.stringify(A,null,2)],{type:"application/json"}),te=URL.createObjectURL(M),ne=document.createElement("a");ne.href=te,ne.download=`debug-logs-completo-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.json`,ne.click(),URL.revokeObjectURL(te),console.log("[DebugPanel]  Relatrio completo exportado (texto + JSON)")},j=()=>{fo.clearHistory(),Ux(),u(pf()),d(Lu()),console.log("[DebugPanel]  Todos os logs foram limpos")},R=A=>{if(A.target.closest("button"))return;f(!0);const v=p.current.getBoundingClientRect();_({x:A.clientX-v.left,y:A.clientY-v.top})},C=A=>{h&&y({x:A.clientX-b.x,y:A.clientY-b.y})},S=()=>{f(!1)};return E.useEffect(()=>{if(h)return document.addEventListener("mousemove",C),document.addEventListener("mouseup",S),()=>{document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",S)}},[h,b]),s?a.jsxs("div",{ref:p,style:{position:"fixed",top:x.y||10,left:x.x||10,zIndex:9999,background:"#1a1a1a",color:"#fff",padding:"12px",borderRadius:"8px",border:"1px solid #333",minWidth:"300px",maxHeight:"80vh",overflow:"auto",fontSize:"12px",fontFamily:"monospace",cursor:h?"grabbing":"grab",userSelect:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},onMouseDown:R,children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[a.jsx("h3",{style:{margin:0,color:"#4CAF50"},children:" Debug Panel"}),a.jsx("button",{onClick:m,style:{background:"#ff4444",color:"#fff",border:"none",borderRadius:"4px",padding:"4px 8px",cursor:"pointer",fontSize:"10px"},children:""})]}),a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("h4",{style:{margin:"0 0 8px 0",color:"#FFC107"},children:" Estatsticas de Validao"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px"},children:[a.jsxs("div",{children:["Total: ",l.total]}),a.jsxs("div",{style:{color:l.errors>0?"#ff4444":"#4CAF50"},children:["Erros: ",l.errors]}),a.jsxs("div",{style:{color:l.warnings>0?"#FFC107":"#4CAF50"},children:["Avisos: ",l.warnings]}),a.jsxs("div",{children:["Taxa Erro: ",l.errorRate.toFixed(1),"%"]})]})]}),a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("h4",{style:{margin:"0 0 8px 0",color:"#FFC107"},children:" Estatsticas de Logs"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px"},children:[a.jsxs("div",{children:["Total: ",c.total]}),a.jsxs("div",{style:{color:c.enabled?"#4CAF50":"#ff4444"},children:["Status: ",c.enabled?" Ativo":" Inativo"]}),c.byLevel&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:["Logs: ",c.byLevel.log||0]}),a.jsxs("div",{style:{color:"#FFC107"},children:["Warns: ",c.byLevel.warn||0]}),a.jsxs("div",{style:{color:"#ff4444"},children:["Errors: ",c.byLevel.error||0]}),a.jsxs("div",{children:["Debug: ",c.byLevel.debug||0]})]})]})]}),a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("h4",{style:{margin:"0 0 8px 0",color:"#FFC107"},children:" Estado do Jogo"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px"},children:[a.jsxs("div",{children:["Jogadores: ",t.length]}),a.jsxs("div",{children:["Turno: ",e+1]}),a.jsxs("div",{children:["Rodada: ",n]}),a.jsxs("div",{style:{color:r?"#ff4444":"#4CAF50"},children:["Status: ",r?"Fim":"Ativo"]}),o&&a.jsxs("div",{children:["Vencedor: ",o.name]})]})]}),a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("h4",{style:{margin:"0 0 8px 0",color:"#FFC107"},children:" Jogadores"}),t.map((A,v)=>{var D;return a.jsxs("div",{style:{background:v===e?"#333":"transparent",padding:"4px",borderRadius:"4px",marginBottom:"2px",border:A.bankrupt?"1px solid #ff4444":"1px solid transparent"},children:[a.jsxs("div",{style:{fontWeight:"bold"},children:[A.name," ",A.bankrupt?"":""," ",v===e?"":""]}),a.jsxs("div",{style:{fontSize:"10px",opacity:.8},children:["Cash: $",((D=A.cash)==null?void 0:D.toLocaleString())||0," | Clientes: ",A.clients||0," | Vendedores: ",A.vendedoresComuns||0]})]},A.id)})]}),a.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[a.jsx("button",{onClick:w,style:{background:"#2196F3",color:"#fff",border:"none",borderRadius:"4px",padding:"6px 12px",cursor:"pointer",fontSize:"10px",fontWeight:"bold"},title:"Exporta relatrio completo com todos os logs (texto + JSON)",children:" Exportar Logs Completos"}),a.jsx("button",{onClick:g,style:{background:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",padding:"6px 12px",cursor:"pointer",fontSize:"10px"},title:"Exporta apenas relatrio de validao (JSON)",children:" Exportar Validao"}),a.jsx("button",{onClick:j,style:{background:"#FF9800",color:"#fff",border:"none",borderRadius:"4px",padding:"6px 12px",cursor:"pointer",fontSize:"10px"},title:"Limpa todos os logs e histrico de validao",children:" Limpar Tudo"})]}),a.jsxs("div",{style:{marginTop:"12px",padding:"8px",background:"#333",borderRadius:"4px",fontSize:"10px"},children:[a.jsx("div",{style:{color:"#FFC107",marginBottom:"4px"},children:" Instrues:"}),a.jsx("div",{children:' Clique em " Debug" para ativar/desativar'}),a.jsx("div",{children:" Logs so capturados automaticamente quando debug est ativo"}),a.jsx("div",{children:' " Exportar Logs Completos" gera arquivo .txt e .json'}),a.jsx("div",{children:" Compartilhe o arquivo .txt para anlise de problemas"}),a.jsx("div",{children:" Todos os console.log com prefixos [DEBUG], [NET], [App], etc. so capturados"})]})]}):a.jsx("div",{style:{background:"#1a1a1a",color:"#fff",padding:"6px 10px",borderRadius:"4px",border:"1px solid #333",cursor:"pointer",fontSize:"11px",fontFamily:"monospace",display:"inline-block",userSelect:"none"},onClick:m,children:" Debug"})}function vr({onResolve:t,requiredAmount:e=0,currentCash:n=0,title:r="Saldo insuficiente",message:o="Seu saldo atual no  suficiente para concluir esta compra.",okLabel:s="OK",showRecoveryOptions:i=!1,canClose:l=!0}){const u=E.useRef(null),c=E.useMemo(()=>Math.max(0,Number(e||0)-Number(n||0)),[e,n]),d=b=>`$ ${Number(b||0).toLocaleString()}`,h=b=>{var _,p;(_=b==null?void 0:b.preventDefault)==null||_.call(b),(p=b==null?void 0:b.stopPropagation)==null||p.call(b),t==null||t({action:"ACK"})},f=b=>{var _,p;(_=b==null?void 0:b.preventDefault)==null||_.call(b),(p=b==null?void 0:b.stopPropagation)==null||p.call(b),!(i||!l)&&(t==null||t({action:"SKIP"}))},x=b=>{var _,p;(_=b==null?void 0:b.preventDefault)==null||_.call(b),(p=b==null?void 0:b.stopPropagation)==null||p.call(b),t==null||t({action:"RECOVERY"})},y=b=>{var _,p;(_=b==null?void 0:b.preventDefault)==null||_.call(b),(p=b==null?void 0:b.stopPropagation)==null||p.call(b),t==null||t({action:"BANKRUPT"})};return E.useEffect(()=>{const b=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var _,p;return(p=(_=u.current)==null?void 0:_.focus)==null?void 0:p.call(_)},0),()=>{document.body.style.overflow=b}},[]),a.jsx("div",{style:fn.wrap,role:"dialog","aria-modal":"true",onMouseDown:b=>{b.target===b.currentTarget&&b.stopPropagation()},children:a.jsxs("div",{style:fn.card,onMouseDown:b=>b.stopPropagation(),children:[!i&&l&&a.jsx("button",{type:"button",style:fn.close,onClick:f,"aria-label":"Fechar",children:""}),a.jsx("div",{style:fn.icon,children:""}),a.jsx("h2",{style:fn.title,children:r}),a.jsx("p",{style:fn.msg,children:o}),a.jsxs("div",{style:fn.grid,children:[a.jsxs("div",{style:fn.row,children:[a.jsx("span",{children:"Necessrio:"}),a.jsx("b",{children:d(e)})]}),a.jsxs("div",{style:fn.row,children:[a.jsx("span",{children:"Seu saldo:"}),a.jsx("b",{children:d(n)})]}),a.jsxs("div",{style:{...fn.row,color:"#fca5a5"},children:[a.jsx("span",{children:"Faltam:"}),a.jsx("b",{children:d(c)})]})]}),a.jsx("div",{style:fn.actions,children:i?a.jsxs(a.Fragment,{children:[a.jsx("button",{type:"button",style:{...fn.btn,background:"#f59e0b",color:"#fff",marginRight:"8px"},onClick:x,children:"Recuperao Financeira"}),a.jsx("button",{type:"button",style:{...fn.btn,background:"#dc2626",color:"#fff"},onClick:y,children:"Declarar Falncia"})]}):a.jsx("button",{ref:u,type:"button",style:{...fn.btn,background:"#6b7280",color:"#fff"},onClick:h,children:s})})]})})}const fn={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"grid",placeItems:"center",zIndex:1100},card:{width:"min(440px, 92vw)",background:"#1f2330",color:"#e9ecf1",borderRadius:16,padding:"18px 18px 16px",border:"1px solid rgba(255,255,255,.12)",boxShadow:"0 18px 50px rgba(0,0,0,.5)",position:"relative"},close:{position:"absolute",right:10,top:10,width:34,height:34,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},icon:{fontSize:28,lineHeight:1,marginBottom:6},title:{margin:"2px 0 6px",fontWeight:900,fontSize:20},msg:{opacity:.95,margin:"0 0 10px"},grid:{border:"1px solid rgba(255,255,255,.15)",borderRadius:12,padding:"10px 12px",marginBottom:12,background:"#171b26"},row:{display:"flex",justifyContent:"space-between",padding:"4px 0"},actions:{display:"flex",justifyContent:"center",marginTop:6},btn:{minWidth:120,padding:"10px 16px",borderRadius:10,border:"none",fontWeight:900,cursor:"pointer"}},hn={A:{compra:1e4,despesa:400,faturamento:1e3,color:"#1d4ed8",pill:"NVEL A"},B:{compra:4e3,despesa:200,faturamento:500,color:"#16a34a",pill:"NVEL B"},C:{compra:1500,despesa:100,faturamento:200,color:"#f59e0b",pill:"NVEL C"},D:{compra:500,despesa:50,faturamento:70,color:"#6b7280",pill:"NVEL D"}};function mf({onResolve:t,currentCash:e=0,currentLevel:n=null,erpOwned:r=null}){const o=E.useRef(null),{pushModal:s,awaitTop:i}=nn(),l=c=>{var d,h;(d=c==null?void 0:c.preventDefault)==null||d.call(c),(h=c==null?void 0:c.stopPropagation)==null||h.call(c),t==null||t({action:"SKIP"})},u=async c=>{if(r?r[c]===!0:n===c)return;const h=hn[c],f=Number((h==null?void 0:h.compra)||0),x=Number(e||0);if(x<f){s(a.jsx(vr,{requiredAmount:f,currentCash:x,title:"Saldo insuficiente para comprar ERP",message:`Voc precisa de $ ${f.toLocaleString()} para o ERP nvel ${c}, mas possui $ ${x.toLocaleString()}.`,okLabel:"Entendi"})),await i();return}t==null||t({action:"BUY",level:c,values:h})};return E.useEffect(()=>{const c=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var d,h;return(h=(d=o.current)==null?void 0:d.focus)==null?void 0:h.call(d)},0),()=>{document.body.style.overflow=c}},[]),a.jsx("div",{style:tt.wrap,role:"dialog","aria-modal":"true","aria-label":"ERP/Sistemas",children:a.jsxs("div",{style:tt.card,children:[a.jsx("button",{ref:o,type:"button",style:tt.close,onClick:l,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:tt.title,children:["Escolha o nvel de ",a.jsx("b",{children:"ERP / Sistemas"}),":"]}),a.jsxs("div",{style:tt.note,children:[a.jsx("div",{style:{fontWeight:900,marginBottom:4},children:"ERP / SISTEMAS"}),a.jsxs("div",{children:[a.jsx("b",{children:"Impacto mensal:"})," adiciona ",a.jsx("b",{children:"Despesa"})," e ",a.jsx("b",{children:"Faturamento"})," de acordo com o nvel."]}),a.jsxs("div",{children:["O nvel ",a.jsx("b",{children:"D"})," tambm pode ser adquirido."]})]}),a.jsxs("div",{style:tt.saldo,children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",Number(e||0).toLocaleString()]})]}),a.jsxs("div",{style:tt.table,children:[a.jsxs("div",{style:tt.trHead,children:[a.jsx("div",{style:tt.th}),a.jsx("div",{style:{...tt.th,background:"#10214d"},children:"Nvel A"}),a.jsx("div",{style:{...tt.th,background:"#0f3a1c"},children:"Nvel B"}),a.jsx("div",{style:{...tt.th,background:"#4a3705"},children:"Nvel C"}),a.jsx("div",{style:{...tt.th,background:"#2a2f3b"},children:"Nvel D"})]}),a.jsx(jl,{label:"COMPRA",fmt:!0,vA:hn.A.compra,vB:hn.B.compra,vC:hn.C.compra,vD:hn.D.compra}),a.jsx(jl,{label:"DESPESA",fmt:!0,vA:hn.A.despesa,vB:hn.B.despesa,vC:hn.C.despesa,vD:hn.D.despesa}),a.jsx(jl,{label:"FATURAMENTO",fmt:!0,vA:hn.A.faturamento,vB:hn.B.faturamento,vC:hn.C.faturamento,vD:hn.D.faturamento})]}),a.jsx("div",{style:tt.cards,children:["A","B","C","D"].map(c=>{const d=hn[c],h=r?r[c]===!0:n===c,f=h;return a.jsxs("div",{style:{...tt.cardItem,borderColor:h?"#16a34a":"rgba(255,255,255,.15)",opacity:f?.6:1},children:[a.jsx("div",{style:{...tt.pill,background:h?"#16a34a":"#fff",color:h?"#fff":"#111"},children:h?" ADQUIRIDO":d.pill}),a.jsx("div",{style:{...tt.cardBadge,background:d.color}}),a.jsxs("ul",{style:tt.lines,children:[a.jsxs("li",{children:["Compra: ",a.jsxs("b",{children:["$ ",d.compra.toLocaleString()]})]}),a.jsxs("li",{children:["Despesa: ",a.jsxs("b",{children:["$ ",d.despesa.toLocaleString()]})]}),a.jsxs("li",{children:["Faturamento: ",a.jsxs("b",{children:["$ ",d.faturamento.toLocaleString()]})]})]}),a.jsx("button",{type:"button",style:{...tt.buyBtn,background:f?"#6b7280":"#2442f9",cursor:f?"not-allowed":"pointer"},onClick:()=>u(c),disabled:f,title:f?`ERP nvel ${c} j adquirido`:`Comprar ERP nvel ${c}`,children:f?"J Adquirido":`Comprar ${c}`})]},c)})}),a.jsx("div",{style:tt.actions,children:a.jsx("button",{type:"button",style:{...tt.bigBtn,background:"#444"},onClick:l,children:"No comprar"})})]})})}function jl({label:t,vA:e,vB:n,vC:r,vD:o,fmt:s}){const i=l=>s?`$ ${Number(l).toLocaleString()}`:l;return a.jsxs("div",{style:tt.tr,children:[a.jsx("div",{style:{...tt.td,fontWeight:700},children:t}),a.jsx("div",{style:tt.td,children:i(e)}),a.jsx("div",{style:tt.td,children:i(n)}),a.jsx("div",{style:tt.td,children:i(r)}),a.jsx("div",{style:tt.td,children:i(o)})]})}const tt={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(980px, 94vw)",background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:900},note:{background:"#2a2f3b",border:"1px solid rgba(255,255,255,.15)",borderRadius:12,padding:"10px 12px",margin:"0 0 10px"},saldo:{margin:"0 0 10px",padding:"8px 12px",border:"1px dashed rgba(255,255,255,.25)",borderRadius:10},table:{border:"1px solid rgba(255,255,255,.12)",borderRadius:12,overflow:"hidden",marginBottom:12},trHead:{display:"grid",gridTemplateColumns:"1fr repeat(4, 1fr)",background:"#121621"},th:{padding:"10px 12px",fontWeight:800,borderLeft:"1px solid rgba(255,255,255,.06)"},tr:{display:"grid",gridTemplateColumns:"1fr repeat(4, 1fr)",background:"#0f1320"},td:{padding:"10px 12px",borderTop:"1px solid rgba(255,255,255,.06)",borderLeft:"1px solid rgba(255,255,255/.06)"},cards:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:12,marginTop:8},cardItem:{background:"#0f1320",border:"1px solid",borderRadius:14,padding:"12px",display:"flex",flexDirection:"column",gap:8},cardBadge:{width:"100%",height:6,borderRadius:999,opacity:.9},pill:{alignSelf:"flex-start",fontSize:12,fontWeight:900,padding:"4px 8px",borderRadius:999,color:"#111"},lines:{margin:0,padding:"0 0 0 16px",lineHeight:1.35},buyBtn:{marginTop:"auto",padding:"10px 12px",borderRadius:10,border:"none",fontWeight:900,cursor:"pointer",background:"#2442f9",color:"#fff"},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:14},bigBtn:{minWidth:160,padding:"14px 18px",borderRadius:12,border:"none",color:"#fff",fontWeight:900,cursor:"pointer"}},Ci=[{id:"personalizado",label:`Treinamento de venda personalizado
Casagrande Consultores`,price:500,cert:"azul",colors:{bg:"#0f2848",border:"#3b82f6",pill:"#60a5fa"}},{id:"fieldsales",label:`Curso Field Sales Collab
Multiplier Educao e
Casagrande Consultores`,price:500,cert:"amarelo",colors:{bg:"#3a3202",border:"#facc15",pill:"#fde047"}},{id:"imersaomultiplier",label:`Pacote Imerses
Multiplier Educao`,price:500,cert:"roxo",colors:{bg:"#2b0840",border:"#a855f7",pill:"#c084fc"}}];function gf({onResolve:t,ownedByType:e={},canTrain:n={}}){const r=S=>typeof S=="string"&&S.trim()!==""&&!Number.isNaN(Number(S))?Number(S):S,o=S=>{const A=r(S);return typeof A=="number"?A>0:!!A},s=E.useMemo(()=>({comum:o(n.comum),field:o(n.field),inside:o(n.inside),gestor:o(n.gestor)}),[n]),i=Ci.map(S=>S.id),l=E.useMemo(()=>[{id:"comum",label:"Vend. Comum"},{id:"field",label:"Field Sales"},{id:"inside",label:"Inside Sales"},{id:"gestor",label:"Gestor"}].filter(S=>s[S.id]).filter(S=>{const A=e[S.id]instanceof Set?e[S.id]:new Set(e[S.id]||[]);return i.some(v=>!A.has(v))}),[e,s]),[u,c]=E.useState(()=>new Set),[d,h]=E.useState(()=>new Set);E.useEffect(()=>{u.size===0&&l.length>0&&c(new Set([l[0].id]))},[l,u.size]);const f=E.useRef(null),x=E.useMemo(()=>{const S=[];if(d.size>0){const A=Array.from(d).map(D=>Ci.find(O=>O.id===D)).filter(Boolean),v=A.reduce((D,O)=>D+((O==null?void 0:O.price)||0),0);u.forEach(D=>{S.push({vendorType:D,items:A,total:v})})}return S},[u,d]),y=E.useMemo(()=>x.reduce((S,A)=>S+A.total,0),[x]),b=E.useMemo(()=>{const S={azul:0,amarelo:0,roxo:0};return d.size>0&&Array.from(d).map(v=>Ci.find(D=>D.id===v)).filter(Boolean).forEach(v=>{S[v.cert]=(S[v.cert]||0)+u.size}),S},[d,u.size]),_=E.useMemo(()=>{const S={};if(d.size>0){const A=Array.from(d);u.forEach(v=>{S[v]=A})}return S},[d,u]),p=S=>{c(A=>{const v=new Set(A);return v.has(S)?v.delete(S):v.add(S),v})},m=S=>{Array.from(u).some(v=>(e[v]instanceof Set?e[v]:new Set(e[v]||[])).has(S))||h(v=>{const D=new Set(v);return D.has(S)?D.delete(S):D.add(S),D})},g=()=>{x.length!==0&&(t==null||t({action:"BUY",purchases:x,grandTotal:y,bensDelta:y,certsCount:b,ownedUpdate:_}))},w=()=>{c(new Set),h(new Set)},j=S=>{var A,v;(A=S==null?void 0:S.preventDefault)==null||A.call(S),(v=S==null?void 0:S.stopPropagation)==null||v.call(S),t==null||t({action:"SKIP"})};E.useEffect(()=>{const S=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var A,v;return(v=(A=f.current)==null?void 0:A.focus)==null?void 0:v.call(A)},0),()=>{document.body.style.overflow=S}},[]);const R=l.length===0,C=!Object.values(s).some(Boolean);return a.jsx("div",{style:Qt.wrap,role:"dialog","aria-modal":"true",children:a.jsxs("div",{style:Qt.card,children:[a.jsx("button",{ref:f,type:"button",style:Qt.close,onClick:j,"aria-label":"Fechar",children:""}),a.jsx("h2",{style:Qt.title,children:"Escolha os vendedores e treinamentos que deseja comprar:"}),R?a.jsx("div",{style:Qt.allDoneBox,children:C?"Nenhum profissional disponvel para treinar no momento.":"Todos os treinamentos j foram comprados para os profissionais disponveis."}):a.jsx(a.Fragment,{children:a.jsxs("div",{style:{marginBottom:"16px"},children:[a.jsx("p",{style:{margin:"0 0 8px",opacity:.9,fontSize:"14px"},children:"Selecione os tipos de vendedores que deseja treinar:"}),a.jsx("div",{style:{...Qt.vendorRow,gridTemplateColumns:`repeat(${l.length}, minmax(0,1fr))`},children:l.map(S=>a.jsx("button",{type:"button",onClick:()=>p(S.id),style:{...Qt.vendorBtn,background:u.has(S.id)?"#6f5bd6":"#2a2f3b",borderColor:u.has(S.id)?"rgba(255,255,255,.35)":"rgba(255,255,255,.15)"},children:S.label},S.id))})]})}),!R&&u.size>0&&a.jsxs(a.Fragment,{children:[a.jsx("p",{style:{margin:"10px 2px 14px",opacity:.9},children:"Escolha os treinamentos que sero aplicados a todos os tipos selecionados:"}),a.jsxs("div",{style:{marginBottom:"16px"},children:[a.jsxs("div",{style:{marginBottom:"12px",padding:"8px 12px",background:"#2a2f3b",borderRadius:"8px",border:"1px solid rgba(255,255,255,.15)"},children:[a.jsx("div",{style:{fontWeight:"bold",marginBottom:"4px"},children:"Tipos selecionados:"}),a.jsx("div",{style:{fontSize:"14px",opacity:.9},children:Array.from(u).map(S=>{const A=l.find(v=>v.id===S);return A==null?void 0:A.label}).join(", ")})]}),a.jsx("div",{style:Qt.products,children:Ci.map(S=>{const A=d.has(S.id),v=Array.from(u).some(D=>(e[D]instanceof Set?e[D]:new Set(e[D]||[])).has(S.id));return a.jsxs("button",{type:"button",onClick:()=>m(S.id),disabled:v,style:{...Qt.productCard,background:S.colors.bg,borderColor:S.colors.border,boxShadow:A?`0 0 0 3px ${S.colors.pill}`:"none",opacity:v?.45:1,cursor:v?"not-allowed":"pointer"},title:v?"J adquirido para algum tipo selecionado":void 0,children:[a.jsxs("div",{style:Qt.pill(S.colors.pill),children:["Certificado ",S.cert==="azul"?"Azul":S.cert==="amarelo"?"Amarelo":"Roxo"]}),a.jsx("div",{style:{whiteSpace:"pre-line",fontWeight:800,marginBottom:10},children:S.label}),a.jsxs("div",{style:{fontSize:22,fontWeight:900},children:["$ ",S.price.toLocaleString()]})]},S.id)})})]}),a.jsxs("div",{style:Qt.actionsRow,children:[a.jsx("button",{type:"button",style:{...Qt.smallBtn,background:"#3a4152"},onClick:w,children:"Limpar Tudo"}),a.jsx("div",{style:{flex:1}}),a.jsxs("div",{style:{fontWeight:900},children:["Total: $ ",y.toLocaleString(),u.size>1&&a.jsxs("span",{style:{fontSize:"12px",opacity:.8,marginLeft:"8px"},children:["(",d.size," treinamentos  ",u.size," tipos)"]})]})]}),a.jsxs("div",{style:Qt.btnRow,children:[a.jsx("button",{type:"button",style:{...Qt.bigBtn,background:"#444"},onClick:j,children:"No comprar"}),a.jsxs("button",{type:"button",disabled:x.length===0,style:{...Qt.bigBtn,background:x.length>0?"#6f5bd6":"#3a3a3a",opacity:x.length>0?1:.6,cursor:x.length>0?"pointer":"not-allowed"},onClick:g,children:["Comprar (",x.length," tipo",x.length!==1?"s":"",")"]})]})]})]})})}const Qt={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(980px, 94vw)",maxWidth:980,background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:900},allDoneBox:{background:"#0f1320",border:"1px solid rgba(255,255,255,.15)",borderRadius:12,padding:"14px",fontWeight:800,textAlign:"center"},vendorRow:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:10,marginBottom:12},vendorBtn:{padding:"10px 12px",borderRadius:10,border:"1px solid",color:"#fff",fontWeight:800,cursor:"pointer"},products:{display:"grid",gridTemplateColumns:"repeat(3, minmax(0,1fr))",gap:12,margin:"4px 0 10px"},productCard:{textAlign:"center",padding:"16px 14px",borderRadius:14,border:"2px solid",color:"#fff"},pill:t=>({display:"inline-block",background:t,color:"#111",fontWeight:900,padding:"4px 8px",borderRadius:999,marginBottom:8}),actionsRow:{display:"flex",alignItems:"center",gap:12,margin:"6px 0 6px"},smallBtn:{padding:"10px 14px",borderRadius:10,border:"none",color:"#fff",fontWeight:800,cursor:"pointer"},btnRow:{display:"flex",gap:12,justifyContent:"flex-end",marginTop:12},bigBtn:{minWidth:160,padding:"14px 18px",borderRadius:12,border:"none",color:"#fff",fontWeight:900,cursor:"pointer"}};function Kx({onResolve:t,currentCash:e=0}){const n=E.useRef(null),r=i=>{var l,u;(l=i==null?void 0:i.preventDefault)==null||l.call(i),(u=i==null?void 0:i.stopPropagation)==null||u.call(i),t==null||t({action:"SKIP"})};E.useEffect(()=>{const i=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var l,u;return(u=(l=n.current)==null?void 0:l.focus)==null?void 0:u.call(l)},0),()=>{document.body.style.overflow=i}},[]);const o=i=>()=>{t==null||t({action:"OPEN",open:String(i).toUpperCase()})},s=[{key:"mix",title:"Mix Produtos",lines:["Nvel A: $12000","Nvel B: $6000","Nvel C: $3000","Nvel D: $1000"],onBuy:o("MIX")},{key:"gestor",title:"Gestor Comercial",lines:["Contratao: $5000","Manuteno: $3000"],onBuy:o("MANAGER")},{key:"inside",title:"Inside Sales",lines:["Contratao: $3000","Manuteno: $2000"],onBuy:o("INSIDE")},{key:"field",title:"Field Sales",lines:["Contratao: $3000","Manuteno: $2000"],onBuy:o("FIELD")},{key:"vendedor",title:"Vendedor Comum",lines:["Contratao: $1500","Despesas: $1000"],onBuy:o("COMMON")},{key:"erp",title:"ERP/Sistemas",lines:["Nvel A: $10000","Nvel B: $4000","Nvel C: $1500","Nvel D: $500"],onBuy:o("ERP")},{key:"carteira",title:"Carteira de Clientes",lines:["Aquisio: $1000"],onBuy:o("CLIENTS")},{key:"training",title:"Treinamento",lines:["Azul: $500","Amarelo: $500","Roxo: $500"],onBuy:o("TRAINING")}];return a.jsx("div",{style:Zn.wrap,role:"dialog","aria-modal":"true",children:a.jsxs("div",{style:Zn.card,children:[a.jsx("button",{ref:n,type:"button",style:Zn.close,onClick:r,"aria-label":"Fechar",children:""}),a.jsx("h2",{style:Zn.title,children:"Direto de Compra  escolha uma casa para adquirir:"}),a.jsxs("div",{style:{marginBottom:8,opacity:.8,fontSize:13},children:["Saldo atual: ",a.jsxs("b",{children:["$",Number(e).toLocaleString()]})]}),a.jsx("div",{style:Zn.grid,children:s.map(i=>a.jsxs("div",{style:Zn.cell,children:[a.jsx("div",{style:Zn.cellTitle,children:i.title}),a.jsx("ul",{style:Zn.lines,children:i.lines.map((l,u)=>a.jsx("li",{children:l},u))}),a.jsx("button",{type:"button",style:Zn.buyBtn,onClick:i.onBuy,children:"Comprar"})]},i.key))}),a.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:16},children:a.jsx("button",{type:"button",style:{...Zn.buyBtn,background:"#666"},onClick:r,children:"No Comprar"})})]})})}const Zn={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(1000px, 94vw)",background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 16px",fontWeight:800},grid:{display:"grid",gridTemplateColumns:"repeat(4, minmax(180px, 1fr))",gap:12},cell:{background:"#0f1320",border:"1px solid rgba(255,255,255,.08)",borderRadius:12,padding:12,display:"flex",flexDirection:"column",gap:8,minHeight:160},cellTitle:{fontWeight:800,marginBottom:4},lines:{margin:0,padding:"0 0 0 16px",opacity:.85,lineHeight:1.3},buyBtn:{marginTop:"auto",alignSelf:"center",minWidth:140,padding:"10px 14px",borderRadius:10,border:"none",background:"#3fbf49",color:"#09110f",fontWeight:900,cursor:"pointer"}};function yf({onResolve:t,currentCash:e=0}){const n=E.useRef(null),[r,o]=E.useState(""),{pushModal:s,awaitTop:i}=nn(),l=3e3,u=2e3,c=1500,d=E.useMemo(()=>{const m=Number(r);return Number.isFinite(m)&&m>0?Math.floor(m):0},[r]),h=d*l,f=d>0,x=Math.max(0,Math.floor(Number(e||0)/l)),y=m=>{var g,w;(g=m==null?void 0:m.preventDefault)==null||g.call(m),(w=m==null?void 0:m.stopPropagation)==null||w.call(m),t==null||t({action:"SKIP"})},b=m=>{const g=Number(r)||0,w=Math.min(x||1/0,g+m);o(w||"")},_=()=>o(x||""),p=async()=>{if(!f)return;const m=Number(e||0),g=Number(h||0);if(m<g){s(a.jsx(vr,{requiredAmount:g,currentCash:m,title:"Saldo insuficiente para contratar Inside Sales",message:`Voc precisa de $ ${g.toLocaleString()} mas possui $ ${m.toLocaleString()}.`,okLabel:"Entendi"})),await i();return}t==null||t({action:"BUY",qty:d,headcount:d,unitHire:l,total:h,cost:h,totalCost:h,baseExpense:u,baseRevenue:c})};return E.useEffect(()=>{const m=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var g,w;return(w=(g=n.current)==null?void 0:g.focus)==null?void 0:w.call(g)},0),()=>{document.body.style.overflow=m}},[]),a.jsx("div",{style:vt.wrap,role:"dialog","aria-modal":"true","aria-label":"Inside Sales",children:a.jsxs("div",{style:vt.card,children:[a.jsx("button",{ref:n,type:"button",style:vt.close,onClick:y,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:vt.title,children:["Voc pode escolher quantos ",a.jsx("b",{children:"Inside Sales"})," quer comprar:"]}),a.jsxs("div",{style:vt.note,children:[a.jsx("div",{style:{fontWeight:900,marginBottom:4},children:"INSIDE SALES (SDR/BDR + CLOSER + CS)"}),a.jsxs("div",{children:[a.jsx("b",{children:"Base para clculo despesa:"}),"  quantidade ",a.jsx("b",{children:"field sales"})," ou ",a.jsx("b",{children:"inside sales"}),"."]}),a.jsxs("div",{children:[a.jsx("b",{children:"Base para clculo faturamento:"}),"  quantidade ",a.jsx("b",{children:"mxima de clientes que cada vendedor pode atender"}),"."]})]}),a.jsxs("div",{style:vt.saldoRow,children:[a.jsxs("div",{children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",Number(e||0).toLocaleString()]})]}),a.jsxs("div",{children:["Mximo por saldo: ",a.jsx("b",{children:x})]})]}),a.jsxs("div",{style:vt.inputRow,children:[a.jsx("input",{type:"number",inputMode:"numeric",min:1,placeholder:"Digite o nmero de Inside Sales",value:r,onChange:m=>o(m.target.value),style:vt.input}),a.jsxs("div",{style:vt.quickBtns,children:[a.jsx("button",{type:"button",style:vt.quickBtn,onClick:()=>b(1),children:"+1"}),a.jsx("button",{type:"button",style:vt.quickBtn,onClick:()=>b(5),children:"+5"}),a.jsx("button",{type:"button",style:vt.quickBtn,onClick:()=>b(10),children:"+10"}),a.jsx("button",{type:"button",style:{...vt.quickBtn,fontWeight:900},onClick:_,children:"Mx"})]}),a.jsxs("div",{style:vt.totalBox,children:["Total contratar: ",a.jsxs("b",{children:["$ ",Number(h).toLocaleString()]})]})]}),a.jsxs("div",{style:vt.cards,children:[a.jsx(Ri,{title:"Sem certificado",bg:"#2a2f3b",pill:"BASE",lines:[`Contratao: $ ${l.toLocaleString()}`,`Despesa: $ ${u.toLocaleString()}`,`Faturamento: $ ${c.toLocaleString()}`]}),a.jsx(Ri,{title:"1 certificado",bg:"#f1c40f",pill:"NVEL 1",dark:!0,lines:["Contratao: ","Despesa: $ 2.100","Faturamento: $ 2.000"]}),a.jsx(Ri,{title:"2 certificados",bg:"#a78bfa",pill:"NVEL 2",dark:!0,lines:["Contratao: ","Despesa: $ 2.200","Faturamento: $ 2.500"]}),a.jsx(Ri,{title:"3 certificados",bg:"#8b5cf6",pill:"NVEL 3",dark:!0,lines:["Contratao: ","Despesa: $ 2.300","Faturamento: $ 3.000"]})]}),a.jsxs("div",{style:vt.actions,children:[a.jsx("button",{type:"button",style:{...vt.bigBtn,background:"#666",color:"#fff"},onClick:y,children:"No comprar"}),a.jsxs("button",{type:"button",style:{...vt.bigBtn,background:f?"#3fbf49":"#2f5d33",color:"#09110f"},onClick:p,disabled:!f,title:f?void 0:"Informe uma quantidade vlida",children:["Comprar ",f?`($ ${h.toLocaleString()})`:""]})]})]})})}function Ri({title:t,pill:e,lines:n,bg:r,dark:o=!1}){return a.jsxs("div",{style:{...vt.cardItem,background:r,color:o?"#111":"#fff",borderColor:"rgba(255,255,255,.15)"},children:[a.jsxs("div",{style:vt.cardHeader,children:[a.jsx("span",{style:{...vt.pill,background:o?"#111":"#fff",color:o?"#fff":"#111"},children:e}),a.jsx("div",{style:{fontWeight:900},children:t})]}),a.jsx("ul",{style:vt.lines,children:n.map((s,i)=>a.jsx("li",{children:s},i))})]})}const vt={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(980px, 94vw)",background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:900},note:{background:"#2a2f3b",border:"1px solid rgba(255,255,255,.15)",borderRadius:12,padding:"10px 12px",margin:"0 0 10px"},saldoRow:{display:"flex",justifyContent:"space-between",gap:12,padding:"8px 12px",border:"1px dashed rgba(255,255,255,.25)",borderRadius:10,marginBottom:8},inputRow:{display:"grid",gridTemplateColumns:"1fr auto auto",alignItems:"center",gap:10,marginBottom:12},input:{height:42,borderRadius:10,padding:"0 12px",border:"1px solid rgba(255,255,255,.18)",background:"#0f1320",color:"#fff",outline:"none"},quickBtns:{display:"flex",gap:6},quickBtn:{minWidth:44,height:42,borderRadius:10,border:"1px solid rgba(255,255,255,.18)",background:"#2a2f3b",color:"#fff",fontWeight:800,cursor:"pointer",padding:"0 10px"},totalBox:{padding:"8px 12px",borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#0f1320",fontWeight:900},cards:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:12,margin:"8px 0 14px"},cardItem:{border:"1px solid",borderRadius:14,padding:"14px"},cardHeader:{display:"flex",alignItems:"center",gap:8,marginBottom:8},pill:{fontSize:12,fontWeight:900,padding:"4px 8px",borderRadius:999},lines:{margin:0,padding:"0 0 0 16px",lineHeight:1.35},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:8},bigBtn:{minWidth:180,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function vf({onResolve:t,unitAcquisition:e=1e3,unitMaintenance:n=50,currentCash:r=0}){const o=E.useRef(null),s=E.useRef(null),{pushModal:i,awaitTop:l}=nn(),[u,c]=E.useState(""),d=E.useMemo(()=>{const j=Math.floor(Number(u));return Number.isFinite(j)&&j>0?j:0},[u]),h=Number(e||0),f=Number(n||0),x=Number(r||0),y=E.useMemo(()=>h<=0?0:Math.max(0,Math.floor(x/h)),[x,h]),b=d*h,_=d*f,p=d>0,m=j=>{var R,C;(R=j==null?void 0:j.preventDefault)==null||R.call(j),(C=j==null?void 0:j.stopPropagation)==null||C.call(j),t==null||t({action:"SKIP"})},g=async()=>{if(p){if(x<b){i(a.jsx(vr,{requiredAmount:b,currentCash:x,title:"Saldo insuficiente para comprar clientes",message:"Voc no possui saldo suficiente para concluir esta aquisio.",okLabel:"Entendi"})),await l();return}t==null||t({action:"BUY",qty:d,unitAcquisition:h,totalCost:b,unitMaintenance:f,maintenanceDelta:_,bensDelta:b,clientsAdded:d})}};E.useEffect(()=>{const j=document.body.style.overflow;document.body.style.overflow="hidden";const R=setTimeout(()=>{var A,v;return(v=(A=o.current)==null?void 0:A.focus)==null?void 0:v.call(A)},0),C=setTimeout(()=>{var A,v;return(v=(A=s.current)==null?void 0:A.focus)==null?void 0:v.call(A)},50),S=A=>{A.key==="Enter"&&(A.preventDefault(),g())};return window.addEventListener("keydown",S),()=>{document.body.style.overflow=j,window.removeEventListener("keydown",S),clearTimeout(R),clearTimeout(C)}},[]);const w=j=>{const R=Math.max(0,Math.min(Math.floor(Number(j)||0),1e6));c(String(R))};return a.jsx("div",{style:Pt.wrap,role:"dialog","aria-modal":"true",onMouseDown:j=>{j.target===j.currentTarget&&j.stopPropagation()},children:a.jsxs("div",{style:Pt.card,onMouseDown:j=>j.stopPropagation(),children:[a.jsx("button",{ref:o,type:"button",style:Pt.close,onClick:m,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:Pt.title,children:["Voc pode escolher quantos clientes quer comprar,",a.jsx("br",{}),"Digite o nmero de clientes:"]}),a.jsxs("p",{style:Pt.warn,children:[a.jsx("b",{children:"Mas cuidado com a capacidade de atendimento da sua equipe!"}),a.jsx("br",{}),"Se o jogador adquirir mais clientes do que os vendedores podem atender, assim que passar na casa ",a.jsx("i",{children:"Faturamento do Ms"})," no receber o faturamento dos clientes excedentes e perder o(s) cliente(s) que no foram atendidos."]}),a.jsxs("div",{style:Pt.inlineInfo,children:[a.jsxs("div",{children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",x.toLocaleString()]})]}),a.jsxs("div",{children:["Mximo por saldo: ",a.jsx("b",{children:y})]})]}),a.jsxs("div",{style:Pt.qtyRow,children:[a.jsx("input",{ref:s,type:"number",inputMode:"numeric",min:1,placeholder:"Digite o nmero de Clientes",value:u,onChange:j=>w(j.target.value),style:Pt.input}),a.jsxs("div",{style:Pt.quickBtns,children:[a.jsx("button",{type:"button",style:Pt.qbtn,onClick:()=>w(d+1),children:"+1"}),a.jsx("button",{type:"button",style:Pt.qbtn,onClick:()=>w(d+5),children:"+5"}),a.jsx("button",{type:"button",style:Pt.qbtn,onClick:()=>w(d+10),children:"+10"}),a.jsx("button",{type:"button",style:Pt.qbtn,onClick:()=>w(y),title:"Comprar o mximo possvel com o saldo atual",children:"Mx"})]})]}),a.jsxs("div",{style:Pt.summary,children:[a.jsxs("div",{children:["Preo por cliente: ",a.jsxs("b",{children:["$ ",h.toLocaleString()]})]}),a.jsxs("div",{children:["Despesa mensal por cliente: ",a.jsxs("b",{children:["$ ",f.toLocaleString()]})]})]}),a.jsxs("div",{style:Pt.summaryStrong,children:[a.jsxs("div",{children:["Total compra: ",a.jsxs("b",{children:["$ ",Number(b).toLocaleString()]})]}),a.jsxs("div",{children:["Manuteno mensal adicionada: ",a.jsxs("b",{children:["$ ",Number(_).toLocaleString()]})]})]}),a.jsxs("div",{style:Pt.actions,children:[a.jsx("button",{type:"button",style:{...Pt.bigBtn,background:"#666",color:"#fff"},onClick:m,children:"No comprar"}),a.jsxs("button",{type:"button",style:{...Pt.bigBtn,background:p?"#3fbf49":"#2f5d33",color:"#09110f"},onClick:g,disabled:!p,title:p?x<b?"Saldo insuficiente":void 0:"Informe uma quantidade vlida",children:["Comprar ",p?`($ ${b.toLocaleString()})`:""]})]})]})})}const Pt={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(820px, 92vw)",maxWidth:820,background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px 20px 16px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:800,lineHeight:1.3},warn:{background:"#271c12",border:"1px solid rgba(255,180,0,.35)",color:"#ffd489",borderRadius:10,padding:"10px 12px",margin:"0 0 12px"},inlineInfo:{display:"flex",justifyContent:"space-between",gap:10,margin:"0 0 8px",opacity:.95,fontWeight:700,flexWrap:"wrap"},qtyRow:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},input:{flex:"1 1 260px",height:42,borderRadius:10,padding:"0 12px",border:"1px solid rgba(255,255,255,.18)",background:"#0f1320",color:"#fff",outline:"none"},quickBtns:{display:"flex",gap:6,flexWrap:"wrap"},qbtn:{height:42,padding:"0 12px",borderRadius:10,border:"1px solid rgba(255,255,255,.18)",background:"#2a2f3b",color:"#fff",cursor:"pointer",fontWeight:800},summary:{display:"flex",justifyContent:"space-between",gap:10,border:"1px dashed rgba(255,255,255,.2)",borderRadius:10,padding:"8px 12px",marginBottom:8,fontWeight:700,flexWrap:"wrap"},summaryStrong:{display:"flex",justifyContent:"space-between",gap:10,border:"1px solid rgba(255,255,255,.25)",borderRadius:10,padding:"10px 12px",marginBottom:10,fontWeight:800,flexWrap:"wrap"},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:4,flexWrap:"wrap"},bigBtn:{minWidth:180,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function xf({onResolve:t,unitHire:e=5e3,unitExpense:n=3e3,managesUpTo:r=7,currentCash:o=0}){const s=E.useRef(null),i=E.useRef(null),{pushModal:l,awaitTop:u}=nn(),[c,d]=E.useState(""),h=Number(e||0),f=Number(n||0),x=Number(o||0),y=E.useMemo(()=>{const R=Math.floor(Number(c));return Number.isFinite(R)&&R>0?R:0},[c]),b=E.useMemo(()=>h<=0?0:Math.max(0,Math.floor(x/h)),[x,h]),_=y*h,p=y*f,m=y>0,g=R=>{const C=Math.floor(Number(R)||0),S=Math.max(0,Math.min(C,1e6));d(String(S))},w=R=>{var C,S;(C=R==null?void 0:R.preventDefault)==null||C.call(R),(S=R==null?void 0:R.stopPropagation)==null||S.call(R),t==null||t({action:"SKIP"})},j=async()=>{if(m){if(x<_){l(a.jsx(vr,{requiredAmount:_,currentCash:x,title:"Saldo insuficiente para contratar Gestores",message:"Voc no possui saldo suficiente para concluir esta contratao.",okLabel:"Entendi"})),await u();return}t==null||t({action:"BUY",role:"MANAGER",qty:y,headcount:y,gestoresDelta:y,unitHire:h,unitExpense:f,totalHire:_,totalExpense:p,cost:_,total:_,cashDelta:-_,expenseDelta:p,hudUpdate:{category:"Gestores Comerciais",addQty:y}})}};return E.useEffect(()=>{const R=document.body.style.overflow;document.body.style.overflow="hidden";const C=setTimeout(()=>{var v,D;return(D=(v=s.current)==null?void 0:v.focus)==null?void 0:D.call(v)},0),S=setTimeout(()=>{var v,D;return(D=(v=i.current)==null?void 0:v.focus)==null?void 0:D.call(v)},60),A=v=>{v.key==="Enter"&&(v.preventDefault(),j())};return window.addEventListener("keydown",A),()=>{document.body.style.overflow=R,window.removeEventListener("keydown",A),clearTimeout(C),clearTimeout(S)}},[]),a.jsx("div",{style:Ke.wrap,role:"dialog","aria-modal":"true",onMouseDown:R=>{R.target===R.currentTarget&&R.stopPropagation()},children:a.jsxs("div",{style:Ke.card,onMouseDown:R=>R.stopPropagation(),children:[a.jsx("button",{ref:s,type:"button",style:Ke.close,onClick:w,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:Ke.title,children:["Voc pode escolher quantos ",a.jsx("b",{children:"Gestores"})," quer comprar,",a.jsx("br",{}),"Digite o nmero de gestores:"]}),a.jsxs("div",{style:Ke.inlineInfo,children:[a.jsxs("div",{children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",x.toLocaleString()]})]}),a.jsxs("div",{children:["Mximo por saldo: ",a.jsx("b",{children:b})]})]}),a.jsxs("div",{style:Ke.qtyRow,children:[a.jsx("input",{ref:i,type:"number",inputMode:"numeric",min:1,placeholder:"Digite o nmero de Gestores",value:c,onChange:R=>g(R.target.value),style:Ke.input}),a.jsxs("div",{style:Ke.quickBtns,children:[a.jsx("button",{type:"button",style:Ke.qbtn,onClick:()=>g(y+1),children:"+1"}),a.jsx("button",{type:"button",style:Ke.qbtn,onClick:()=>g(y+5),children:"+5"}),a.jsx("button",{type:"button",style:Ke.qbtn,onClick:()=>g(y+10),children:"+10"}),a.jsx("button",{type:"button",style:Ke.qbtn,onClick:()=>g(b),title:"Comprar o mximo possvel com o saldo atual",children:"Mx"})]})]}),a.jsxs("div",{style:Ke.infoBox,children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"GESTOR COMERCIAL"}),a.jsxs("div",{style:{opacity:.9,marginBottom:8},children:["Base para clculo de despesa: ",a.jsx("b",{children:"x quantidade de Gestores"}),".",a.jsx("br",{}),"Cada Gestor gerencia at ",a.jsx("b",{children:r})," colaboradores."]}),a.jsxs("div",{style:Ke.table,children:[a.jsxs("div",{style:Ke.trHead,children:[a.jsx("div",{style:Ke.th,children:"Certificao"}),a.jsx("div",{style:Ke.th,children:"Contratao"}),a.jsx("div",{style:Ke.th,children:"Despesa"}),a.jsx("div",{style:Ke.th,children:"Efeito"})]}),a.jsx(Ni,{label:"Sem Certificado",hire:5e3,expense:3e3,revenue:"potencializa colaboradores em 20%"}),a.jsx(Ni,{label:"Com 1 certificado",hire:"-",expense:3500,revenue:"potencializa colaboradores em 30%"}),a.jsx(Ni,{label:"Com 2 certificados",hire:"-",expense:4e3,revenue:"potencializa colaboradores em 40%"}),a.jsx(Ni,{label:"Com 3 certificados",hire:"-",expense:4500,revenue:"potencializa colaboradores em 60%"})]})]}),a.jsxs("div",{style:Ke.summary,children:[a.jsxs("div",{children:["Custo de contratao: ",a.jsxs("b",{children:["$ ",Number(e).toLocaleString()]})," / gestor"]}),a.jsxs("div",{children:["Despesa mensal: ",a.jsxs("b",{children:["$ ",Number(n).toLocaleString()]})," / gestor"]})]}),a.jsxs("div",{style:Ke.summaryStrong,children:[a.jsxs("div",{children:["Total contratar: ",a.jsxs("b",{children:["$ ",Number(_).toLocaleString()]})]}),a.jsxs("div",{children:["Despesa mensal total: ",a.jsxs("b",{children:["$ ",Number(p).toLocaleString()]})]})]}),a.jsxs("div",{style:Ke.actions,children:[a.jsx("button",{type:"button",style:{...Ke.bigBtn,background:"#666",color:"#fff"},onClick:w,children:"No comprar"}),a.jsxs("button",{type:"button",style:{...Ke.bigBtn,background:m?"#3fbf49":"#2f5d33",color:"#09110f"},onClick:j,disabled:!m,title:m?x<_?"Saldo insuficiente":void 0:"Informe uma quantidade vlida",children:["Comprar ",m?`(${y})`:""]})]})]})})}function Ni({label:t,hire:e,expense:n,revenue:r}){const o=s=>typeof s=="number"?`$ ${Number(s).toLocaleString()}`:s;return a.jsxs("div",{style:Ke.tr,children:[a.jsx("div",{style:Ke.td,children:t}),a.jsx("div",{style:Ke.td,children:o(e)}),a.jsx("div",{style:Ke.td,children:o(n)}),a.jsx("div",{style:Ke.td,children:r})]})}const Ke={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(880px, 92vw)",maxWidth:880,background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px 20px 16px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:800,lineHeight:1.3},inlineInfo:{display:"flex",justifyContent:"space-between",gap:10,margin:"0 0 8px",opacity:.95,fontWeight:700,flexWrap:"wrap"},qtyRow:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},input:{flex:"1 1 260px",height:42,borderRadius:10,padding:"0 12px",border:"1px solid rgba(255,255,255,.18)",background:"#0f1320",color:"#fff",outline:"none"},quickBtns:{display:"flex",gap:6,flexWrap:"wrap"},qbtn:{height:42,padding:"0 12px",borderRadius:10,border:"1px solid rgba(255,255,255,.18)",background:"#2a2f3b",color:"#fff",cursor:"pointer",fontWeight:800},infoBox:{border:"1px solid rgba(255,255,255,.12)",borderRadius:12,padding:"12px",background:"#101522",marginBottom:12},table:{border:"1px solid rgba(255,255,255,.12)",borderRadius:10,overflow:"hidden"},trHead:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 3fr",background:"#121621"},th:{padding:"10px 12px",fontWeight:800,borderLeft:"1px solid rgba(255,255,255,.06)"},tr:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 3fr",background:"#0f1320"},td:{padding:"10px 12px",borderTop:"1px solid rgba(255,255,255,.06)",borderLeft:"1px solid rgba(255,255,255,.06)"},summary:{display:"flex",justifyContent:"space-between",border:"1px dashed rgba(255,255,255,.2)",borderRadius:10,padding:"8px 12px",marginTop:10,flexWrap:"wrap",gap:10},summaryStrong:{display:"flex",justifyContent:"space-between",border:"1px solid rgba(255,255,255,.25)",borderRadius:10,padding:"10px 12px",marginTop:8,fontWeight:800,flexWrap:"wrap",gap:10},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:12,flexWrap:"wrap"},bigBtn:{minWidth:180,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function bf({onResolve:t,unitHire:e=3e3,unitExpense:n=2e3,attendsUpTo:r=5,currentCash:o=0}){const s=E.useRef(null),i=E.useRef(null),{pushModal:l,awaitTop:u}=nn(),[c,d]=E.useState(""),h=Number(e||0),f=Number(n||0),x=Number(o||0),y=E.useMemo(()=>{const S=Math.floor(Number(c));return Number.isFinite(S)&&S>0?S:0},[c]),b=E.useMemo(()=>h<=0?0:Math.max(0,Math.floor(x/h)),[x,h]),_=y*h,p=y*f,g=y*1500,w=y>0,j=S=>{const A=Math.floor(Number(S)||0),v=Math.max(0,Math.min(A,1e6));d(String(v))},R=S=>{var A,v;(A=S==null?void 0:S.preventDefault)==null||A.call(S),(v=S==null?void 0:S.stopPropagation)==null||v.call(S),t==null||t({action:"SKIP"})},C=async()=>{if(w){if(x<_){l(a.jsx(vr,{requiredAmount:_,currentCash:x,title:"Saldo insuficiente para contratar Field Sales",message:"Voc no possui saldo suficiente para concluir esta contratao.",okLabel:"Entendi"})),await u();return}t==null||t({action:"BUY",qty:y,unitHire:h,unitExpense:f,totalHire:_,totalExpense:p,cashDelta:-_,expenseDelta:p,revenueDelta:g,cost:_,total:_,role:"FIELD"})}};return E.useEffect(()=>{const S=document.body.style.overflow;document.body.style.overflow="hidden";const A=setTimeout(()=>{var O,M;return(M=(O=s.current)==null?void 0:O.focus)==null?void 0:M.call(O)},0),v=setTimeout(()=>{var O,M;return(M=(O=i.current)==null?void 0:O.focus)==null?void 0:M.call(O)},50),D=O=>{O.key==="Enter"&&(O.preventDefault(),C())};return window.addEventListener("keydown",D),()=>{document.body.style.overflow=S,window.removeEventListener("keydown",D),clearTimeout(A),clearTimeout(v)}},[]),a.jsx("div",{style:Je.wrap,role:"dialog","aria-modal":"true",onMouseDown:S=>{S.target===S.currentTarget&&S.stopPropagation()},children:a.jsxs("div",{style:Je.card,onMouseDown:S=>S.stopPropagation(),children:[a.jsx("button",{ref:s,type:"button",style:Je.close,onClick:R,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:Je.title,children:["Voc pode escolher quantos ",a.jsx("b",{children:"Field Sales"})," quer comprar,",a.jsx("br",{}),"Digite o nmero de vendedores:"]}),a.jsxs("div",{style:Je.inlineInfo,children:[a.jsxs("div",{children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",x.toLocaleString()]})]}),a.jsxs("div",{children:["Mximo por saldo: ",a.jsx("b",{children:b})]})]}),a.jsxs("div",{style:Je.qtyRow,children:[a.jsx("input",{ref:i,type:"number",inputMode:"numeric",min:1,placeholder:"Digite o nmero de Field Sales",value:c,onChange:S=>j(S.target.value),style:Je.input}),a.jsxs("div",{style:Je.quickBtns,children:[a.jsx("button",{type:"button",style:Je.qbtn,onClick:()=>j(y+1),children:"+1"}),a.jsx("button",{type:"button",style:Je.qbtn,onClick:()=>j(y+5),children:"+5"}),a.jsx("button",{type:"button",style:Je.qbtn,onClick:()=>j(y+10),children:"+10"}),a.jsx("button",{type:"button",style:Je.qbtn,onClick:()=>j(b),title:"Comprar o mximo possvel com o saldo atual",children:"Mx"})]})]}),a.jsxs("div",{style:Je.infoBox,children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"FIELD SALES (REPRESENTANTES COMERCIAIS)"}),a.jsxs("div",{style:{opacity:.9,marginBottom:8},children:["Base para clculo de despesa: ",a.jsx("b",{children:"x quantidade de Field Sales"}),".",a.jsx("br",{}),"Base para clculo de faturamento: ",a.jsx("b",{children:"x quantidade mxima de clientes que cada vendedor pode atender"}),".",a.jsx("br",{}),"Cada vendedor atende at ",a.jsx("b",{children:r})," clientes."]}),a.jsxs("div",{style:Je.table,children:[a.jsxs("div",{style:Je.trHead,children:[a.jsx("div",{style:Je.th,children:"Certificao"}),a.jsx("div",{style:Je.th,children:"Contratao"}),a.jsx("div",{style:Je.th,children:"Despesa"}),a.jsx("div",{style:Je.th,children:"Faturamento"})]}),a.jsx(Di,{label:"S/ Certificado",hire:"$ 3.000",expense:"$ 2.000",revenue:"$ 1.500"}),a.jsx(Di,{label:"Com 1 certificado",hire:"-",expense:"$ 2.100",revenue:"$ 2.000"}),a.jsx(Di,{label:"Com 2 certificados",hire:"-",expense:"$ 2.200",revenue:"$ 2.500"}),a.jsx(Di,{label:"Com 3 certificados",hire:"-",expense:"$ 2.300",revenue:"$ 3.000"})]})]}),a.jsxs("div",{style:Je.summary,children:[a.jsxs("div",{children:["Custo de contratao: ",a.jsxs("b",{children:["$ ",Number(e).toLocaleString()]})," / vendedor"]}),a.jsxs("div",{children:["Despesa mensal: ",a.jsxs("b",{children:["$ ",Number(n).toLocaleString()]})," / vendedor"]})]}),a.jsxs("div",{style:Je.summaryStrong,children:[a.jsxs("div",{children:["Total contratar: ",a.jsxs("b",{children:["$ ",Number(_).toLocaleString()]})]}),a.jsxs("div",{children:["Despesa mensal total: ",a.jsxs("b",{children:["$ ",Number(p).toLocaleString()]})]})]}),a.jsxs("div",{style:Je.actions,children:[a.jsx("button",{type:"button",style:{...Je.bigBtn,background:"#666",color:"#fff"},onClick:R,children:"No comprar"}),a.jsxs("button",{type:"button",style:{...Je.bigBtn,background:w?"#75e16c":"#365b31",color:"#0b120a"},onClick:C,disabled:!w,title:w?x<_?"Saldo insuficiente":void 0:"Informe uma quantidade vlida",children:["Comprar ",w?`(${y})`:""]})]})]})})}function Di({label:t,hire:e,expense:n,revenue:r}){return a.jsxs("div",{style:Je.tr,children:[a.jsx("div",{style:Je.td,children:t}),a.jsx("div",{style:Je.td,children:e}),a.jsx("div",{style:Je.td,children:n}),a.jsx("div",{style:Je.td,children:r})]})}const Je={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(880px, 92vw)",maxWidth:880,background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px 20px 16px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:800,lineHeight:1.3},inlineInfo:{display:"flex",justifyContent:"space-between",gap:10,margin:"0 0 8px",opacity:.95,fontWeight:700,flexWrap:"wrap"},qtyRow:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},input:{flex:"1 1 260px",height:42,borderRadius:10,padding:"0 12px",border:"1px solid rgba(255,255,255,.18)",background:"#0f1320",color:"#fff",outline:"none"},quickBtns:{display:"flex",gap:6,flexWrap:"wrap"},qbtn:{height:42,padding:"0 12px",borderRadius:10,border:"1px solid rgba(255,255,255,.18)",background:"#2a2f3b",color:"#fff",cursor:"pointer",fontWeight:800},infoBox:{border:"1px solid rgba(255,255,255,.12)",borderRadius:12,padding:"12px",background:"#101522",marginBottom:12},table:{border:"1px solid rgba(255,255,255,.12)",borderRadius:10,overflow:"hidden"},trHead:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",background:"#121621"},th:{padding:"10px 12px",fontWeight:800,borderLeft:"1px solid rgba(255,255,255,.06)"},tr:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",background:"#0f1320"},td:{padding:"10px 12px",borderTop:"1px solid rgba(255,255,255,.06)",borderLeft:"1px solid rgba(255,255,255,.06)"},summary:{display:"flex",justifyContent:"space-between",border:"1px dashed rgba(255,255,255,.2)",borderRadius:10,padding:"8px 12px",marginTop:10,flexWrap:"wrap",gap:10},summaryStrong:{display:"flex",justifyContent:"space-between",border:"1px solid rgba(255,255,255,.25)",borderRadius:10,padding:"10px 12px",marginTop:8,fontWeight:800,flexWrap:"wrap",gap:10},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:12,flexWrap:"wrap"},bigBtn:{minWidth:180,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function wf({onResolve:t,unitHire:e=1500,unitExpense:n=1e3,attendsUpTo:r=2,currentCash:o=0}){const[s,i]=E.useState(""),l=E.useRef(null),u=E.useRef(null),{pushModal:c,awaitTop:d}=nn(),h=Number(e||0),f=Number(n||0),x=Number(o||0),y=600,b=E.useMemo(()=>{const C=Math.floor(Number(s));return Number.isFinite(C)&&C>0?C:0},[s]),_=E.useMemo(()=>h<=0?0:Math.max(0,Math.floor(x/h)),[x,h]),p=E.useMemo(()=>b*h,[b,h]),m=E.useMemo(()=>b*f,[b,f]),g=b>0,w=C=>{const S=Math.floor(Number(C)||0),A=Math.max(0,Math.min(S,1e6));i(String(A))},j=C=>{var S;(S=C==null?void 0:C.stopPropagation)==null||S.call(C),t==null||t({action:"SKIP"})},R=async()=>{if(!g)return;if(x<p){c(a.jsx(vr,{requiredAmount:p,currentCash:x,title:"Saldo insuficiente para contratar vendedores",message:"Voc no possui saldo suficiente para concluir esta contratao.",okLabel:"Entendi"})),await d();return}const C={action:"BUY",role:"COMMON",qty:b,headcount:b,unitHire:h,unitExpense:f,totalHire:p,totalExpense:m,total:p,cost:p,attendsUpTo:r,cashDelta:-p,expenseDelta:m,revenueDelta:y*b,revenuePerSeller:y,hudUpdate:{category:"Vendedores Comuns",addQty:b}};t==null||t(C)};return E.useEffect(()=>{const C=document.body.style.overflow;document.body.style.overflow="hidden";const S=setTimeout(()=>{var D,O;return(O=(D=l.current)==null?void 0:D.focus)==null?void 0:O.call(D)},0),A=setTimeout(()=>{var D,O;return(O=(D=u.current)==null?void 0:D.focus)==null?void 0:O.call(D)},50),v=D=>{D.key==="Enter"&&(D.preventDefault(),R())};return window.addEventListener("keydown",v),()=>{document.body.style.overflow=C,window.removeEventListener("keydown",v),clearTimeout(S),clearTimeout(A)}},[]),a.jsx("div",{style:Ye.wrap,role:"dialog","aria-modal":"true","aria-label":"Comprar Vendedores Comuns",onMouseDown:C=>{C.target===C.currentTarget&&C.stopPropagation()},children:a.jsxs("div",{style:Ye.card,onMouseDown:C=>C.stopPropagation(),children:[a.jsx("button",{ref:l,type:"button",style:Ye.close,onClick:j,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:Ye.title,children:["Voc pode escolher quantos ",a.jsx("b",{children:"Vendedores Comuns"})," quer comprar,",a.jsx("br",{}),"Digite o nmero de vendedores:"]}),a.jsxs("div",{style:Ye.inlineInfo,children:[a.jsxs("div",{children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",x.toLocaleString()]})]}),a.jsxs("div",{children:["Mximo por saldo: ",a.jsx("b",{children:_})]})]}),a.jsxs("div",{style:Ye.qtyRow,children:[a.jsx("input",{ref:u,type:"number",inputMode:"numeric",min:1,placeholder:"Digite o nmero de Vendedores Comuns",value:s,onChange:C=>w(C.target.value),style:Ye.input}),a.jsxs("div",{style:Ye.quickBtns,children:[a.jsx("button",{type:"button",style:Ye.qbtn,onClick:()=>w(b+1),children:"+1"}),a.jsx("button",{type:"button",style:Ye.qbtn,onClick:()=>w(b+5),children:"+5"}),a.jsx("button",{type:"button",style:Ye.qbtn,onClick:()=>w(b+10),children:"+10"}),a.jsx("button",{type:"button",style:Ye.qbtn,onClick:()=>w(_),title:"Comprar o mximo possvel com o saldo atual",children:"Mx"})]})]}),a.jsxs("div",{style:Ye.infoBox,children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"VENDEDOR COMUM (FAZ TUDO)"}),a.jsxs("div",{style:{opacity:.9,marginBottom:8},children:["Base para clculo despesa: ",a.jsx("b",{children:"x quantidade vendedor comum"}),".",a.jsx("br",{}),"Base para clculo faturamento: ",a.jsx("b",{children:"x quantidade mxima de clientes que cada vendedor pode atender"}),".",a.jsx("br",{}),a.jsxs("b",{children:["Atende at ",r," clientes"]}),"."]}),a.jsxs("div",{style:Ye.table,children:[a.jsxs("div",{style:Ye.trHead,children:[a.jsx("div",{style:Ye.th,children:"Certificao"}),a.jsx("div",{style:Ye.th,children:"Contratao"}),a.jsx("div",{style:Ye.th,children:"Despesa"}),a.jsx("div",{style:Ye.th,children:"Faturamento"})]}),a.jsx(Ai,{label:"S/ Certificado",hire:"$ 1.500",expense:"$ 1.000",revenue:"$ 600"}),a.jsx(Ai,{label:"Com 1 certificado",hire:"-",expense:"$ 1.100",revenue:"$ 700"}),a.jsx(Ai,{label:"Com 2 certificados",hire:"-",expense:"$ 1.200",revenue:"$ 800"}),a.jsx(Ai,{label:"Com 3 certificados",hire:"-",expense:"$ 1.300",revenue:"$ 900"})]})]}),a.jsxs("div",{style:Ye.summary,children:[a.jsxs("div",{children:["Custo de contratao: ",a.jsxs("b",{children:["$ ",Number(e).toLocaleString()]})," / vendedor"]}),a.jsxs("div",{children:["Despesa mensal: ",a.jsxs("b",{children:["$ ",Number(n).toLocaleString()]})," / vendedor"]})]}),a.jsxs("div",{style:Ye.summaryStrong,children:[a.jsxs("div",{children:["Total contratar: ",a.jsxs("b",{children:["$ ",Number(p).toLocaleString()]})]}),a.jsxs("div",{children:["Despesa mensal total: ",a.jsxs("b",{children:["$ ",Number(m).toLocaleString()]})]})]}),a.jsxs("div",{style:Ye.actions,children:[a.jsx("button",{type:"button",style:{...Ye.bigBtn,background:"#666",color:"#fff"},onClick:j,children:"No comprar"}),a.jsx("button",{type:"button",disabled:!g,style:{...Ye.bigBtn,background:g?"#7cbe1a":"#3a3f4a",color:"#0d1200",fontWeight:900},onClick:R,title:g?x<p?"Saldo insuficiente":void 0:"Informe uma quantidade vlida",children:"Comprar"})]})]})})}function Ai({label:t,hire:e,expense:n,revenue:r}){return a.jsxs("div",{style:Ye.tr,children:[a.jsx("div",{style:Ye.td,children:t}),a.jsx("div",{style:Ye.td,children:e}),a.jsx("div",{style:Ye.td,children:n}),a.jsx("div",{style:Ye.td,children:r})]})}const Ye={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(880px, 92vw)",maxWidth:880,background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px 20px 16px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:800,lineHeight:1.3},inlineInfo:{display:"flex",justifyContent:"space-between",gap:10,margin:"0 0 8px",opacity:.95,fontWeight:700,flexWrap:"wrap"},qtyRow:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},input:{flex:"1 1 260px",height:42,borderRadius:10,padding:"0 12px",border:"1px solid rgba(255,255,255,.18)",background:"#111522",color:"#eef2f7",outline:"none"},quickBtns:{display:"flex",gap:6,flexWrap:"wrap"},qbtn:{height:42,padding:"0 12px",borderRadius:10,border:"1px solid rgba(255,255,255,.18)",background:"#2a2f3b",color:"#fff",cursor:"pointer",fontWeight:800},infoBox:{background:"#161a28",border:"1px solid rgba(255,255,255,.12)",borderRadius:14,padding:14,marginTop:6},table:{border:"1px solid rgba(255,255,255,.12)",borderRadius:12,overflow:"hidden",marginTop:8},trHead:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",background:"#121621"},th:{padding:"10px 12px",fontWeight:800,borderLeft:"1px solid rgba(255,255,255,.06)"},tr:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",background:"#0f1320"},td:{padding:"10px 12px",borderTop:"1px solid rgba(255,255,255,.06)",borderLeft:"1px solid rgba(255,255,255,.06)"},summary:{display:"flex",justifyContent:"space-between",border:"1px dashed rgba(255,255,255,.2)",borderRadius:10,padding:"8px 12px",marginTop:10,flexWrap:"wrap",gap:10},summaryStrong:{display:"flex",justifyContent:"space-between",border:"1px solid rgba(255,255,255,.25)",borderRadius:10,padding:"10px 12px",marginTop:8,fontWeight:800,flexWrap:"wrap",gap:10},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:12,flexWrap:"wrap"},bigBtn:{minWidth:180,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function Sf({onResolve:t,currentCash:e,currentLevel:n=null,mixOwned:r=null}){const o=E.useRef(null),{pushModal:s,awaitTop:i}=nn(),l={A:{compra:12e3,despesa:700,faturamento:1200,color:"#1d4ed8",pill:"NVEL A",label:"100 produtos"},B:{compra:6e3,despesa:400,faturamento:600,color:"#16a34a",pill:"NVEL B",label:"50 produtos"},C:{compra:3e3,despesa:200,faturamento:300,color:"#f59e0b",pill:"NVEL C",label:"20 produtos"},D:{compra:1e3,despesa:50,faturamento:100,color:"#6b7280",pill:"NVEL D",label:"5 produtos"}};async function u(d){if(r?r[d]===!0:n===d)return;const f=l[d],x=Number((f==null?void 0:f.compra)||0),y=Number(e);if(Number.isFinite(y)&&y>=0&&y<x){s(a.jsx(vr,{requiredAmount:x,currentCash:y,title:"Saldo insuficiente para adquirir o Mix de Produtos",message:`Voc precisa de $ ${x.toLocaleString()} mas possui $ ${y.toLocaleString()}.`,okLabel:"Entendi"})),await i();return}t==null||t({action:"BUY",level:d,...f})}function c(){t==null||t({action:"SKIP"})}return E.useEffect(()=>{const d=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var h,f;return(f=(h=o.current)==null?void 0:h.focus)==null?void 0:f.call(h)},0),()=>{document.body.style.overflow=d}},[]),a.jsx("div",{style:pn.wrap,role:"dialog","aria-modal":"true","aria-label":"Mix de Produtos",children:a.jsxs("div",{style:pn.card,children:[a.jsx("button",{ref:o,type:"button",style:pn.close,onClick:c,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:pn.title,children:["Escolha um ",a.jsx("b",{children:"mix de produtos"}),":"]}),a.jsxs("div",{style:pn.note,children:[a.jsx("div",{style:{fontWeight:900,marginBottom:4},children:"MIX DE PRODUTOS"}),a.jsxs("div",{children:["Base para clculo de ",a.jsx("b",{children:"Despesa"}),"/",a.jsx("b",{children:"Faturamento"}),": multiplicar pela ",a.jsx("b",{children:"quantidade total de clientes"}),"."]})]}),Number.isFinite(Number(e))&&a.jsxs("div",{style:pn.saldo,children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",Number(e||0).toLocaleString()]})]}),a.jsx("div",{style:pn.cards,children:["A","B","C","D"].map(d=>{const h=l[d],f=r?r[d]===!0:n===d,x=f;return a.jsxs("div",{style:{...pn.cardItem,borderColor:f?"#16a34a":"rgba(255,255,255,.15)",opacity:x?.6:1},children:[a.jsx("div",{style:{...pn.pill,background:f?"#16a34a":"#fff",color:f?"#fff":"#111"},children:f?" ADQUIRIDO":h.pill}),a.jsx("div",{style:{...pn.cardBadge,background:h.color}}),a.jsxs("ul",{style:pn.lines,children:[a.jsx("li",{children:a.jsx("b",{children:h.label})}),a.jsxs("li",{children:["Compra: ",a.jsxs("b",{children:["$ ",h.compra.toLocaleString()]})]}),a.jsxs("li",{children:["Despesa: ",a.jsxs("b",{children:["$ ",h.despesa.toLocaleString()]})]}),a.jsxs("li",{children:["Faturamento: ",a.jsxs("b",{children:["$ ",h.faturamento.toLocaleString()]})]})]}),a.jsx("button",{type:"button",style:{...pn.buyBtn,background:x?"#6b7280":"#2442f9",cursor:x?"not-allowed":"pointer"},onClick:()=>u(d),disabled:x,title:x?`Mix nvel ${d} j adquirido`:`Comprar Mix de Produtos ${d}`,children:x?"J Adquirido":`Comprar ${d}`})]},d)})}),a.jsx("div",{style:pn.actions,children:a.jsx("button",{type:"button",style:{...pn.bigBtn,background:"#444",color:"#fff"},onClick:c,children:"No comprar"})})]})})}const pn={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(980px, 94vw)",background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:900},note:{background:"#2a2f3b",border:"1px solid rgba(255,255,255,.15)",borderRadius:12,padding:"10px 12px",margin:"0 0 10px"},saldo:{margin:"0 0 10px",padding:"8px 12px",border:"1px dashed rgba(255,255,255,.25)",borderRadius:10},cards:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:12,marginTop:8},cardItem:{background:"#0f1320",border:"1px solid",borderRadius:14,padding:"12px",display:"flex",flexDirection:"column",gap:8},cardBadge:{width:"100%",height:6,borderRadius:999,opacity:.9},pill:{alignSelf:"flex-start",fontSize:12,fontWeight:900,padding:"4px 8px",borderRadius:999,color:"#111"},lines:{margin:0,padding:"0 0 0 16px",lineHeight:1.35},buyBtn:{marginTop:"auto",padding:"10px 12px",borderRadius:10,border:"none",fontWeight:900,cursor:"pointer",background:"#2442f9",color:"#fff"},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:14},bigBtn:{minWidth:160,padding:"14px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function Jx({onResolve:t,player:e={}}){const n=E.useRef(null),r=(_,p=0)=>Number.isFinite(Number(_))?Number(_):p,o=_=>r(_.am,0)>0,s=_=>r(_.az,0)>0,i=_=>r(_.rox,0)>0,l=_=>String(_.erpLevel||_.erpSistemas||"D").toUpperCase()==="A",u=_=>{const p=String(_.mixProdutos||"D").toUpperCase();return p==="A"||p==="B"},c=_=>{var m;const p=g=>{if(!g)return 0;try{const w=Array.isArray(g)?g:Object.values(g);return new Set(w).size}catch{return 0}};return(m=_.trainingsByVendor)!=null&&m.gestor?p(_.trainingsByVendor.gestor):r(_.gestoresCertificados,0)},d=_=>r(_.vendedoresComuns)+r(_.insideSales)+r(_.fieldSales)+r(_.gestores??_.gestoresComerciais??_.managers),h=E.useMemo(()=>[{id:"gov_fgts",kind:"SORTE",title:"Ao Governamental Positiva",text:"Liberao de FGTS aumentou o poder de compra. Receba 5 novos clientes (se tiver equipe para atender).",clientsDelta:5},{id:"referral_bonus",kind:"SORTE",title:"Indicao Lucrativa",text:"Um cliente indicou amigos e a primeira compra foi tima. Receba R$ 800,00.",cashDelta:800},{id:"network_cert_mgr",kind:"SORTE",title:"Rede Estratgica",text:"Para cada gestor com certificado, receba R$ 5.000,00.",_compute:_=>({cashDelta:5e3*c(_)})},{id:"innovation_invest",kind:"SORTE",title:"Inovao Premiada",text:"Se tiver infraestrutura (mix/sistemas) nvel A ou B, receba aporte de R$ 25.000,00.",_compute:_=>({cashDelta:u(_)?25e3:0})},{id:"segmentation",kind:"SORTE",title:"Segmentao Inteligente",text:"Novo segmento lucrativo. Receba R$ 1.000,00.",cashDelta:1e3},{id:"casa_bonus_10k",kind:"SORTE",title:"Casagrande Insights",text:"Implementao bem-sucedida. Receba R$ 10.000,00.",cashDelta:1e4},{id:"casa_network_7k",kind:"SORTE",title:"Rede de Contatos Valiosa",text:"Parceria estratgica. Ganhe R$ 7.000,00.",cashDelta:7e3},{id:"casa_strategy_5k",kind:"SORTE",title:"Estratgia Personalizada",text:"Processos melhorados. Receba R$ 5.000,00.",cashDelta:5e3},{id:"casa_best_practices_8k",kind:"SORTE",title:"Melhores Prticas",text:"Eficincia aumentada. Receba R$ 8.000,00.",cashDelta:8e3},{id:"casa_start_6k",kind:"SORTE",title:"Satisfao do Cliente em Alta",text:"Fidelidade e vendas sobem. Receba R$ 6.000,00.",cashDelta:6e3},{id:"casa_change_cert_blue",kind:"SORTE",title:"Gesto de Mudanas Bem-sucedida",text:"Um vendedor generalista concluiu todos os treinamentos. Ganhe um certificado AZUL para esse vendedor.",_compute:()=>({certDelta:{az:1}})},{id:"training_roi_team",kind:"SORTE",title:"Treinamento Personalizado",text:"Receba R$ 500,00 por membro participante.",_compute:_=>({cashDelta:500*Math.max(0,d(_))})},{id:"purple_award_25k",kind:"SORTE",title:"Profissional do Ano (Roxo)",text:"Se houver pelo menos um colaborador com certificado roxo, receba R$ 25.000,00.",_compute:_=>({cashDelta:i(_)?25e3:0})},{id:"reputation_1500",kind:"SORTE",title:"Reputao Impecvel",text:"timas avaliaes elevam a confiana. Receba R$ 1.500,00.",cashDelta:1500},{id:"client_cheer_per_client",kind:"SORTE",title:"Cliente Promotor",text:"Ganhe R$ 500,00 por cada cliente atual.",_compute:_=>({cashDelta:500*Math.max(0,r(_.clients))})},{id:"big_order_freight_save",kind:"SORTE",title:"Grande Pedido + Frete Econmico",text:"Receba R$ 1.500,00.",cashDelta:1500},{id:"sales_win_2k",kind:"SORTE",title:"Vitria de Vendas",text:"Venda aguardada foi fechada. Receba R$ 2.000,00.",cashDelta:2e3},{id:"missed_admission",kind:"REVES",title:"Admisso No Reportada",text:"Multa governamental. Pague R$ 3.000,00.",cashDelta:-3e3},{id:"office_renovation",kind:"REVES",title:"Renovao Custosa",text:"Gastos de obra. Pague R$ 7.000,00.",cashDelta:-7e3},{id:"env_fine_20k",kind:"REVES",title:"Impacto Ambiental",text:"Multa ambiental. Pague R$ 20.000,00.",cashDelta:-2e4},{id:"key_client_at_risk",kind:"REVES",title:"Cliente Chave em Risco",text:"Sem certificado AMARELO: perca 1 cliente e pague R$ 2.000,00.",_compute:_=>o(_)?{clientsDelta:0,cashDelta:0,_overrideText:"Voc possui certificado amarelo. Nada acontece."}:{clientsDelta:-1,cashDelta:-2e3}},{id:"social_crisis",kind:"REVES",title:"Crise nas Redes",text:"Pague R$ 400,00 e perca 2 clientes.",cashDelta:-400,clientsDelta:-2},{id:"car_break",kind:"REVES",title:"Carro Quebrou",text:"Conserto urgente. Pague R$ 1.000,00.",cashDelta:-1e3},{id:"service_improvement_1k",kind:"REVES",title:"Aprimoramentos de Servio",text:"Pague R$ 1.000,00.",cashDelta:-1e3},{id:"recovery_failed_5k",kind:"REVES",title:"Recuperao Mal Sucedida",text:"Cancele grande pedido. Pague R$ 5.000,00.",cashDelta:-5e3},{id:"discount_pressure_1k",kind:"REVES",title:"Descontos Forados",text:"Sem certificado verde: perca R$ 1.000,00 de lucro.",cashDelta:-1e3},{id:"domino_2k",kind:"REVES",title:"Efeito Domin",text:"Cancelamentos em cadeia. Perca R$ 2.000,00.",cashDelta:-2e3},{id:"needs_change_lose4",kind:"REVES",title:"Necessidades Mudaram",text:"Sem certificado AZUL: perca 4 clientes.",_compute:_=>s(_)?{clientsDelta:0,_overrideText:"Voc possui certificado azul. Nada acontece."}:{clientsDelta:-4}},{id:"payroll_error_1k",kind:"REVES",title:"Erro na Folha",text:"Corrigir problema. Pague R$ 1.000,00.",cashDelta:-1e3},{id:"strike_lose5",kind:"REVES",title:"Greve Inesperada",text:"Atrasos e perdas. Perca 5 clientes.",clientsDelta:-5},{id:"customs_hold_3k",kind:"REVES",title:"Alfndega",text:"Pague R$ 3.000,00.",cashDelta:-3e3},{id:"cyber_breach_7k_or_A",kind:"REVES",title:"Falha de Segurana",text:"Se NO tiver sistemas nvel A, pague R$ 7.000,00.",_compute:_=>({cashDelta:l(_)?0:-7e3})},{id:"supplier_issue_2k",kind:"REVES",title:"Fornecedor em Crise",text:"Expedio expressa. Pague R$ 2.000,00.",cashDelta:-2e3},{id:"reg_change_30k",kind:"REVES",title:"Regulamentao Nova",text:"Adequao de processos. Pague R$ 30.000,00.",cashDelta:-3e4},{id:"bad_mix_2500",kind:"REVES",title:"Mix de Produtos Desequilibrado",text:"Descontos e liquidaes. Pague R$ 2.500,00.",cashDelta:-2500},{id:"quality_crisis",kind:"REVES",title:"Crise de Qualidade",text:"Perca 1 cliente e pague R$ 1.000,00.",cashDelta:-1e3,clientsDelta:-1}],[]),[f]=E.useState(()=>h[Math.floor(Math.random()*h.length)]),x=E.useMemo(()=>{const _={action:"APPLY_CARD",kind:f.kind,id:f.id,title:f.title};if(typeof f._compute=="function"){const m=f._compute(e||{}),{_overrideText:g,...w}=m||{};return{text:g||f.text,payload:{..._,...w}}}const p={};return Number.isFinite(f.cashDelta)&&(p.cashDelta=Number(f.cashDelta)),Number.isFinite(f.clientsDelta)&&(p.clientsDelta=Number(f.clientsDelta)),{text:f.text,payload:{..._,...p}}},[f,e]),y=()=>t==null?void 0:t(x.payload),b=()=>t==null?void 0:t({action:"SKIP"});return E.useEffect(()=>{const _=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var p,m;return(m=(p=n.current)==null?void 0:p.focus)==null?void 0:m.call(p)},0),()=>{document.body.style.overflow=_}},[]),a.jsx("div",{style:_r.wrap,role:"dialog","aria-modal":"true","aria-label":"Sorte e Revs",children:a.jsxs("div",{style:_r.card,children:[a.jsx("button",{ref:n,style:_r.close,onClick:b,"aria-label":"Fechar",children:""}),a.jsx("div",{style:_r.badge(f.kind),children:f.kind==="SORTE"?"SORTE":"REVS"}),f.title&&a.jsx("h2",{style:_r.title,children:f.title}),a.jsx("p",{style:_r.text,children:x.text}),a.jsx("div",{style:_r.footer,children:a.jsx("button",{type:"button",style:_r.okBtn,onClick:y,children:"OK"})})]})})}const _r={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(760px, 92vw)",background:"#1b1f2a",color:"#e9ecf1",borderRadius:18,padding:"22px",border:"1px solid rgba(255,255,255,.12)",boxShadow:"0 10px 40px rgba(0,0,0,.4)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},badge:t=>({display:"inline-block",padding:"6px 12px",borderRadius:999,fontWeight:900,marginBottom:8,background:t==="SORTE"?"#22c55e":"#ef4444",color:"#111"}),title:{margin:"2px 0 6px",fontWeight:900},text:{fontSize:18,lineHeight:1.5,opacity:.95,margin:"6px 0 14px"},footer:{display:"flex",justifyContent:"center"},okBtn:{minWidth:140,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer",background:"#fff",color:"#111"}};function Yx({value:t=0,onResolve:e}){const n=Number(t||0),r=o=>{var s,i;(s=o==null?void 0:o.preventDefault)==null||s.call(o),(i=o==null?void 0:o.stopPropagation)==null||i.call(o),e==null||e({action:"OK"})};return a.jsx(si,{zIndex:2147483647,onClose:()=>e==null?void 0:e({action:"CLOSE"}),children:a.jsxs("div",{style:{padding:28,textAlign:"center",pointerEvents:"auto"},children:[a.jsx("div",{style:{fontWeight:900,fontSize:28,color:"#4caf50",letterSpacing:.5,marginBottom:6},children:"FATURAMENTO DO MS"}),a.jsx("div",{style:{opacity:.9,marginBottom:16},children:"Ser creditado o valor do Faturamento ao seu Saldo"}),a.jsxs("div",{style:{fontSize:18,marginBottom:24},children:["no valor de: ",a.jsxs("b",{children:["$ ",n.toLocaleString()]})]}),a.jsx("button",{type:"button",onClick:r,className:"btn",style:{minWidth:120,background:"#8bd65a",color:"#1a1f2a",fontWeight:800,borderRadius:10},children:"OK"})]})})}function Qx({expense:t=0,loanCharge:e=0,onResolve:n}){const r=Number(t||0)+Number(e||0),o=s=>{var i,l;(i=s==null?void 0:s.preventDefault)==null||i.call(s),(l=s==null?void 0:s.stopPropagation)==null||l.call(s),n==null||n({action:"OK"})};return a.jsx(si,{zIndex:2147483647,onClose:()=>n==null?void 0:n({action:"CLOSE"}),children:a.jsxs("div",{style:{padding:28,textAlign:"center",pointerEvents:"auto"},children:[a.jsx("div",{style:{fontWeight:900,fontSize:26,color:"#ffb74d",letterSpacing:.5,marginBottom:6},children:"DESPESAS DO MS"}),a.jsxs("div",{style:{marginBottom:8},children:["Despesas operacionais:",a.jsxs("b",{children:["-$ ",Number(t).toLocaleString()]})]}),Number(e)>0&&a.jsxs("div",{style:{marginBottom:8,color:"#ffd54f"},children:["Emprstimo cobrado nesta rodada:",a.jsxs("b",{children:["-$ ",Number(e).toLocaleString()]})]}),a.jsxs("div",{style:{margin:"6px 0 18px",opacity:.85},children:["Total a debitar: ",a.jsxs("b",{children:["-$ ",r.toLocaleString()]})]}),a.jsx("button",{type:"button",onClick:o,className:"btn",style:{minWidth:120,background:"#ffcc80",color:"#1a1f2a",fontWeight:800,borderRadius:10},children:"OK"})]})})}const ze={backdrop:{position:"fixed",inset:0,background:"rgba(0,0,0,.6)",display:"grid",placeItems:"center",zIndex:9999},card:{width:"min(920px, 96vw)",maxHeight:"90vh",overflow:"auto",background:"#15161a",color:"#e9ecf1",border:"1px solid rgba(255,255,255,.08)",borderRadius:20,boxShadow:"0 20px 50px rgba(0,0,0,.5)"},header:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"14px 16px",borderBottom:"1px solid rgba(255,255,255,.08)"},closeBtn:{width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"transparent",color:"#fff",fontSize:20,cursor:"pointer"},body:{padding:16},lead:{opacity:.95,lineHeight:1.5},bullets:{margin:"8px 0 16px 18px"},rowBtns:{display:"flex",gap:12,justifyContent:"flex-end",marginTop:12,flexWrap:"wrap"},cta:{padding:"12px 16px",border:0,borderRadius:12,color:"#fff",fontWeight:900,cursor:"pointer",boxShadow:"0 10px 24px rgba(0,0,0,.25)"},back:{padding:"10px 14px",borderRadius:12,border:"1px solid rgba(255,255,255,.15)",background:"transparent",color:"#e9ecf1",cursor:"pointer"},subHeader:{marginBottom:8},infoRow:{display:"flex",gap:8,alignItems:"baseline",margin:"4px 0"},input:{width:"100%",padding:"12px 12px",borderRadius:12,background:"#0f1115",color:"#fff",border:"1px solid rgba(255,255,255,.15)",marginTop:10},option:{padding:16,background:"rgba(255,255,255,.04)",border:"1px solid rgba(255,255,255,.08)",borderRadius:14,textAlign:"center",cursor:"pointer"},spin:{width:34,height:34,borderRadius:8,border:"1px solid rgba(255,255,255,.15)",background:"transparent",color:"#fff",fontSize:18,cursor:"pointer"}};function Xx({playerName:t,loanAvailable:e,hasPendingLoan:n,onGoLoan:r,onGoReduce:o,onGoFire:s,onDeclareBankruptcy:i}){return a.jsxs("div",{style:ze.body,children:[a.jsxs("p",{style:ze.lead,children:["Voc est sem dinheiro, ",t,". Escolha uma das opes:"]}),n&&a.jsx("div",{style:{...ze.lead,color:"#ef4444",fontWeight:"bold",marginBottom:"16px"},children:" Voc j possui um emprstimo pendente. Cada jogador s pode ter um emprstimo por vez."}),a.jsxs("ul",{style:ze.bullets,children:[a.jsxs("li",{children:["Pedir ",a.jsx("b",{children:"emprstimo"})," nico com 50% de juros garantido por 50% dos seus ",a.jsx("b",{children:"BENS"})," (limite ",`$ ${e}`,")."]}),a.jsxs("li",{children:[a.jsx("b",{children:"Reduzir"})," nveis de ",a.jsx("b",{children:"MIX de Produtos"})," ou ",a.jsx("b",{children:"ERP/Sistemas"})," e receber 50% do valor pago."]}),a.jsxs("li",{children:[a.jsx("b",{children:"Demitir"})," funcionrios e receber 50% do valor total."]})]}),a.jsxs("div",{style:ze.rowBtns,children:[a.jsx("button",{style:{...ze.cta,background:"#ef4444"},onClick:s,children:"DEMITIR"}),a.jsx("button",{style:{...ze.cta,background:"#a16207"},onClick:o,children:"REDUZIR"}),a.jsx("button",{style:{...ze.cta,background:n?"#6b7280":"#16a34a",cursor:n?"not-allowed":"pointer"},onClick:n?void 0:r,disabled:n,children:n?"EMPRSTIMO (J REALIZADO)":"EMPRSTIMO"}),a.jsx("button",{style:{...ze.cta,background:"#d32f2f",fontWeight:"bold"},onClick:i,children:"DECLARAR FALNCIA"})]})]})}function Zx({loanAvailable:t,alreadyHasLoan:e=!1,onBack:n,onConfirm:r}){const[o,s]=E.useState(""),i=E.useMemo(()=>Math.max(0,Math.floor(Number(o)||0)),[o]),l=!e&&i>0&&i<=Number(t||0),u=()=>{if(e){r==null||r({type:"LOAN_DENIED",reason:"ALREADY_TAKEN"});return}const c=Math.max(0,Math.floor(Number(t)||0)),d=Math.max(0,Math.min(c,i));if(d>0){const h={type:"LOAN",amount:d,cashDelta:d,loan:{amount:d,charged:!1}};console.log("[DEBUG] RecoveryLoan enviando payload:",h),r==null||r(h)}else r==null||r({type:"LOAN_DENIED",reason:"INVALID_AMOUNT"})};return a.jsxs("div",{style:ze.body,children:[a.jsx("div",{style:ze.subHeader,children:a.jsx("b",{style:{fontSize:20},children:"EMPRSTIMO"})}),a.jsxs("p",{children:["Voc pode realizar um emprstimo colocando ",a.jsx("b",{children:"50% dos seus BENS"})," como garantia (pago na prxima Despesas Operacionais)."]}),a.jsxs("div",{style:ze.infoRow,children:[a.jsx("span",{children:"Valor disponvel:"})," ",a.jsxs("b",{children:["$",Number(t||0)]})]}),a.jsxs("div",{style:ze.infoRow,children:[a.jsx("span",{children:"Valor garantia:"})," ",a.jsxs("b",{children:["$",Number(t||0)]})]}),e&&a.jsx("div",{style:{...ze.infoRow,color:"#fca5a5",border:"1px solid rgba(255,0,0,.25)",padding:"8px 10px",borderRadius:8,background:"rgba(255,0,0,.06)"},children:"Voc j possui um emprstimo ativo. No  possvel pegar outro."}),a.jsx("input",{style:ze.input,type:"number",min:0,max:Math.max(0,Number(t||0)),placeholder:"Digite o valor que quer emprestar",value:o,onChange:c=>s(c.target.value),disabled:e}),a.jsxs("div",{style:{fontSize:12,opacity:.8,marginTop:6},children:["Mx: $",Number(t||0),"  valor ser somado ao seu saldo e cobrado na prxima Despesas Operacionais."]}),a.jsxs("div",{style:ze.rowBtns,children:[a.jsx("button",{style:ze.back,onClick:n,children:" Voltar"}),a.jsx("button",{style:{...ze.cta,background:"#16a34a",opacity:l?1:.6,cursor:l?"pointer":"not-allowed"},onClick:u,disabled:!l,children:"Pegar Emprstimo"})]})]})}function eb(t){const{options:e=[],optionsMix:n,optionsErp:r,mixOwned:o,erpOwned:s,credits:i,snapshot:l,onBack:u,onConfirm:c}=t,d=(...v)=>console.log("[RecoveryReduce]",...v),h={MIX:{accent:"#06B6D4",soft:"rgba(6,182,212,.14)",ring:"rgba(6,182,212,.45)",glow:"rgba(6,182,212,.35)",pillBg:"rgba(6,182,212,.18)",pillFg:"#9FF1FF"},ERP:{accent:"#8B5CF6",soft:"rgba(139,92,246,.14)",ring:"rgba(139,92,246,.45)",glow:"rgba(139,92,246,.35)",pillBg:"rgba(139,92,246,.18)",pillFg:"#E9D5FF"}},f=["A","B","C","D"],x=(v,D,O)=>f.map(M=>({key:`${v}-${M}`,group:v,level:M,label:`Nvel ${M}`,credit:Number((D==null?void 0:D[M])??0),owned:!!(O!=null&&O[M])})),y=E.useMemo(()=>Array.isArray(n)&&n.length?n:i!=null&&i.MIX?x("MIX",i.MIX,o):x("MIX",{A:0,B:0,C:0,D:0},o),[n,i,o]),b=E.useMemo(()=>Array.isArray(r)&&r.length?r:i!=null&&i.ERP?x("ERP",i.ERP,s):x("ERP",{A:0,B:0,C:0,D:0},s),[r,i,s]);E.useEffect(()=>{console.groupCollapsed("[RecoveryReduce] props snapshot"),console.log("mixCards:",y),console.log("erpCards:",b),console.log("mixOwned:",o),console.log("erpOwned:",s),console.log("credits:",i),console.groupEnd()},[y,b,o,s,i]);const[_,p]=E.useState([]),[m,g]=E.useState(new Set),[w,j]=E.useState(!1),R=v=>{v.level!=="D"&&(!v.owned||v.owned===!1||m.has(v.key)||v.alreadyReduced||p(D=>D.some(M=>M.key===v.key)?D.filter(M=>M.key!==v.key):[...D,v]))},C=E.useMemo(()=>_.reduce((v,D)=>v+Number(D.credit||0),0),[_]),S=v=>_.some(D=>D.key===v.key),A=v=>{var ae,Oe;const D=S(v),O=v.level==="D",M=v.owned===!0,te=O||!M||m.has(v.key)||v.alreadyReduced||w,ne=h[v.group]||h.MIX,ut={...ze.option,position:"relative",borderRadius:14,background:te?"rgba(148,163,184,.12)":ne.soft,border:D?`2.5px solid ${ne.accent}`:"1px solid rgba(148,163,184,.25)",boxShadow:D?`0 0 0 2px ${ne.ring}, 0 10px 24px ${ne.glow}`:"none",cursor:te?"not-allowed":"pointer",opacity:te?.35:1,transition:"transform .06s ease-out, box-shadow .12s ease-out, border-color .12s"},nt={fontWeight:900,fontSize:16,marginBottom:8,color:te?"#CBD5E1":"#E5F9FF"},F={fontWeight:700,marginTop:2,color:te?"#A1A1AA":"#FFFFFF"},ue={position:"absolute",top:8,right:8,fontSize:11,padding:"3px 8px",borderRadius:999,background:te?"rgba(148,163,184,.22)":ne.pillBg,color:te?"#E5E7EB":ne.pillFg,border:`1px solid ${te?"rgba(148,163,184,.35)":ne.ring}`,letterSpacing:.2};return a.jsxs("button",{onClick:()=>R(v),disabled:te,"aria-pressed":D,style:ut,title:O?"Nvel D  o bsico e no pode ser reduzido.":M?m.has(v.key)?"Nvel j reduzido nesta sesso.":v.alreadyReduced?"Este nvel j foi reduzido anteriormente. Compre o nvel novamente para poder reduzir.":"":"Este nvel no est disponvel. Compre o nvel novamente para poder reduzir.",onMouseDown:je=>!te&&(je.currentTarget.style.transform="translateY(1px)"),onMouseUp:je=>je.currentTarget.style.transform="translateY(0)",onMouseLeave:je=>je.currentTarget.style.transform="translateY(0)",children:[a.jsx("span",{style:ue,children:O?"bsico":M?m.has(v.key)?"vendido":v.alreadyReduced?"j reduzido":"adquirido":"zerado"}),a.jsx("div",{style:nt,children:v.label}),a.jsx("div",{style:{color:te?"#A1A1AA":"#BFEFFF"},children:"Crdito ao reduzir:"}),a.jsxs("div",{style:F,children:["$",((Oe=(ae=v.credit).toLocaleString)==null?void 0:Oe.call(ae))??v.credit]})]},v.key)};return a.jsxs("div",{style:ze.body,children:[a.jsx("div",{style:ze.subHeader,children:a.jsx("b",{style:{fontSize:20},children:"REDUZIR NVEL MIX/ERP"})}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[a.jsxs("div",{style:{padding:8,borderRadius:8,background:"rgba(255,255,255,0.05)"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"MIX PRODUTOS"}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:12},children:y.map(A)})]}),a.jsxs("div",{style:{padding:8,borderRadius:8,background:"rgba(255,255,255,0.05)"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"ERP/SISTEMAS"}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:12},children:b.map(A)})]})]}),a.jsxs("div",{style:{marginTop:10,display:"flex",justifyContent:"space-between",alignItems:"center",opacity:.92},children:[a.jsxs("div",{children:["Selecionados: ",a.jsx("b",{children:_.length}),"    Total: ",a.jsxs("b",{children:["$",C.toLocaleString()]})]}),a.jsx("div",{style:{fontSize:12,opacity:.7},children:"S  possvel selecionar nveis adquiridos."})]}),a.jsxs("div",{style:ze.rowBtns,children:[a.jsx("button",{style:ze.back,onClick:u,disabled:w,children:" Voltar"}),a.jsx("button",{style:{...ze.cta,background:"#F59E0B",color:"#101010",fontWeight:900,opacity:_.length&&!w?1:.55},onClick:()=>{if(!_.length||w)return;j(!0),g(D=>{const O=new Set(D);return _.forEach(M=>O.add(M.key)),O});const v={items:_.map(D=>({...D,selected:!0})),total:C};d("confirm payload =>",v),c==null||c(v),p([]),j(!1)},disabled:!_.length||w,children:"REDUZIR"})]})]})}function tb({roles:t=[],onBack:e,onConfirm:n}){const r=E.useMemo(()=>t.map(f=>{const x=Number(f.unit??f.total??0),y=Number(f.owned??f.qty??0);return{...f,unit:x,owned:y}}),[t]),[o,s]=E.useState(()=>{const f={};return r.forEach(x=>{f[x.key]=0}),f}),i=f=>`R$ ${Number(f||0).toLocaleString("pt-BR")}`,l=f=>Math.floor(Number(f||0)*.5),u=(f,x)=>{s(y=>{const b=r.find(m=>m.key===f);if(!b)return y;const _=Number(y[f]||0),p=Math.max(0,Math.min(b.owned,_+x));return p===_?y:{...y,[f]:p}})},c=E.useMemo(()=>{const f={};return r.forEach(x=>{const y=Number(o[x.key]||0);f[x.key]=l(x.unit)*y}),f},[o,r]),d=E.useMemo(()=>Object.values(c).reduce((f,x)=>f+x,0),[c]),h=()=>{if(d<=0)return;const f={};r.forEach(x=>{f[x.key]=Number(o[x.key]||0)}),n==null||n({type:"FIRE",items:f,creditByRole:c,totalCredit:d,amount:d,note:`Demisses +${i(d)}`})};return a.jsxs("div",{style:ze.body,children:[a.jsx("div",{style:ze.subHeader,children:a.jsx("b",{style:{fontSize:20},children:"DEMITIR FUNCIONRIOS"})}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1.2fr 1fr 1.2fr 1fr",gap:8,opacity:.9,fontWeight:700,marginBottom:6},children:[a.jsx("div",{children:"Cargo"}),a.jsx("div",{children:"Valor Unitrio"}),a.jsx("div",{children:"Qtd demitir"}),a.jsx("div",{children:"Crdito"})]}),a.jsx("div",{style:{display:"grid",gap:12},children:r.map(f=>{const x=Number(o[f.key]||0),y=Number(f.unit||0),b=Number(f.owned||0),_=l(y),p=_*x,m=x<=0,g=x>=b||b<=0;return a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1.2fr 1fr 1.2fr 1fr",alignItems:"center",gap:8},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:800},children:f.label}),a.jsxs("div",{style:{opacity:.75,fontSize:12},children:["Possui: ",a.jsx("b",{children:b})]})]}),a.jsxs("div",{children:[a.jsx("div",{children:a.jsx("b",{children:i(y)})}),a.jsxs("div",{style:{opacity:.75,fontSize:12},children:["Crdito por un.: ",a.jsx("b",{children:i(_)})]})]}),a.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center"},children:[a.jsx("button",{style:{...ze.spin,opacity:m?.5:1,cursor:m?"not-allowed":"pointer"},disabled:m,onClick:()=>u(f.key,-1),children:"-"}),a.jsx("div",{style:{minWidth:28,textAlign:"center",fontWeight:800},children:x}),a.jsx("button",{style:{...ze.spin,opacity:g?.5:1,cursor:g?"not-allowed":"pointer"},disabled:g,onClick:()=>u(f.key,1),children:"+"})]}),a.jsx("div",{children:a.jsx("b",{children:i(p)})})]},f.key)})}),a.jsxs("div",{style:{marginTop:12,textAlign:"right",fontWeight:900},children:["Total a resgatar: ",a.jsx("b",{children:i(d)})]}),a.jsxs("div",{style:ze.rowBtns,children:[a.jsx("button",{style:ze.back,onClick:e,children:" Voltar"}),a.jsx("button",{style:{...ze.cta,background:"#ef4444",opacity:d>0?1:.6},onClick:h,disabled:d<=0,children:"DEMITIR"})]})]})}function _f({playerName:t="Jogador",bens:e=0,currentPlayer:n,canClose:r=!0}){var A;const{resolveTop:o,popModal:s}=(nn==null?void 0:nn())||{},[i,l]=E.useState("menu"),u=()=>{r&&(s?s(!1):o==null||o(null))},c=E.useMemo(()=>({A:12e3,B:6e3,C:3e3,D:1e3}),[]),d=E.useMemo(()=>({A:1e4,B:4e3,C:1500,D:500}),[]),h=v=>{if(v==null)return"";const D=String(v).trim().toUpperCase();if(["A","B","C","D"].includes(D))return D;const O=Number(D);return O===1?"A":O===2?"B":O===3?"C":O===4?"D":""},f=E.useMemo(()=>{const v=n||{};return{name:v.name??t,bens:Number(v.bens??e??0),vendedoresComuns:Number(v.vendedoresComuns??0),fieldSales:Number(v.fieldSales??0),insideSales:Number(v.insideSales??0),gestores:Number(v.gestores??v.gestoresComerciais??0),raw:v}},[n,t,e]);E.useEffect(()=>{console.group("[RecoveryModal] mount snapshot"),console.log("raw player =>",f.raw),console.groupEnd()},[f.raw]);const x=E.useMemo(()=>Math.max(0,Math.floor(f.bens*.5)),[f.bens]),y=E.useMemo(()=>{var D;const v=(D=f.raw)==null?void 0:D.loanPending;return v&&Number(v.amount)>0},[(A=f.raw)==null?void 0:A.loanPending]),b=E.useMemo(()=>[{key:"mix",label:"MIX PRODUTOS",credit:1500},{key:"erp",label:"ERP/SISTEMAS",credit:1500}],[]),_=E.useMemo(()=>[{key:"comum",label:"Vendedor Comum",unit:1500,owned:f.vendedoresComuns},{key:"field",label:"Field Sales",unit:3e3,owned:f.fieldSales},{key:"inside",label:"Inside Sales",unit:3e3,owned:f.insideSales},{key:"gestor",label:"Gestor",unit:5e3,owned:f.gestores}],[f]),p=E.useMemo(()=>{const v=f.raw||{};return h(v.mixProdutosLetter??v.mixProdutos??v.mixProducts??v.mixLevelLetter??v.mixLevel??v.mix_level??v.mix??v.mix_produtos??v.mix_products)},[f.raw]),m=E.useMemo(()=>{var D;const v=f.raw||{};return h(v.erpSistemasLetter??v.erpSistemas??((D=v.erpSystems)==null?void 0:D.level)??v.erpSystemsLetter??v.erpLevelLetter??v.erpLevel??v.erp_level??v.erp??v.erp_sistemas)},[f.raw]),g=E.useMemo(()=>{const v=f.raw||{},D=v.mixOwned??v.mix??{},O=new Set;return D.A===!0&&O.add("A"),D.B===!0&&O.add("B"),D.C===!0&&O.add("C"),D.D===!0&&O.add("D"),O.size===0&&O.add("D"),O},[f.raw]),w=E.useMemo(()=>{const v=f.raw||{},D=v.erpOwned??v.erp??{},O=new Set;return D.A===!0&&O.add("A"),D.B===!0&&O.add("B"),D.C===!0&&O.add("C"),D.D===!0&&O.add("D"),O.size===0&&O.add("D"),O},[f.raw]);E.useEffect(()=>{console.group("[RecoveryModal] owned detect"),console.log("mixLetter(panel):",p," -> ownedMix =",Object.fromEntries(["A","B","C","D"].map(v=>[v,g.has(v)]))),console.log("erpLetter(panel):",m," -> ownedErp =",Object.fromEntries(["A","B","C","D"].map(v=>[v,w.has(v)]))),console.groupEnd()},[p,m,g,w]);const j=E.useMemo(()=>{var D,O;const v=f.raw||{};return{MIX:Array.isArray((D=v.reducedLevels)==null?void 0:D.MIX)?v.reducedLevels.MIX:[],ERP:Array.isArray((O=v.reducedLevels)==null?void 0:O.ERP)?v.reducedLevels.ERP:[]}},[f.raw]),R=E.useMemo(()=>["A","B","C","D"].map(v=>({key:`mix-${v}`,group:"MIX",level:v,label:`Nvel ${v}`,credit:(c[v]||0)/2,owned:g.has(v),alreadyReduced:j.MIX.includes(v)})),[g,c,j.MIX]),C=E.useMemo(()=>["A","B","C","D"].map(v=>({key:`erp-${v}`,group:"ERP",level:v,label:`Nvel ${v}`,credit:(d[v]||0)/2,owned:w.has(v),alreadyReduced:j.ERP.includes(v)})),[w,d,j.ERP]),S=E.useMemo(()=>({MIX:{A:c.A/2,B:c.B/2,C:c.C/2,D:c.D/2},ERP:{A:d.A/2,B:d.B/2,C:d.C/2,D:d.D/2}}),[c,d]);return a.jsx("div",{style:ze.backdrop,children:a.jsxs("div",{style:ze.card,children:[a.jsxs("div",{style:ze.header,children:[a.jsx("div",{style:{fontWeight:900,fontSize:22},children:"RECUPERAO FINANCEIRA"}),r&&a.jsx("button",{onClick:u,style:ze.closeBtn,children:""})]}),i==="menu"&&a.jsx(Xx,{playerName:f.name,loanAvailable:x,hasPendingLoan:y,onGoLoan:()=>l("loan"),onGoReduce:()=>l("reduce"),onGoFire:()=>l("fire"),onDeclareBankruptcy:()=>o==null?void 0:o({type:"TRIGGER_BANKRUPTCY"})}),i==="loan"&&a.jsx(Zx,{loanAvailable:x,onBack:()=>l("menu"),onConfirm:v=>{console.log("[DEBUG] RecoveryModal recebeu payload do RecoveryLoan:",v),console.log("[DEBUG] RecoveryModal chamando resolveTop com:",v);const D=o==null?void 0:o(v);console.log("[DEBUG] RecoveryModal resolveTop retornou:",D)}}),i==="reduce"&&a.jsx(eb,{options:b,optionsMix:R,optionsErp:C,mixOwned:{A:g.has("A"),B:g.has("B"),C:g.has("C"),D:g.has("D")},erpOwned:{A:w.has("A"),B:w.has("B"),C:w.has("C"),D:w.has("D")},credits:S,snapshot:f,onBack:()=>l("menu"),onConfirm:v=>{if(Array.isArray(v==null?void 0:v.items)){const M=Number(v.total??v.items.filter(te=>te.selected).reduce((te,ne)=>te+Number(ne.credit||0),0));o==null||o({type:"REDUCE",amount:M,items:v.items,note:`Reduo mltipla +R$ ${M.toLocaleString()}`});return}const D=Number((v==null?void 0:v.credit)||(v==null?void 0:v.amount)||0),O=v&&v.group&&v.level?{group:String(v.group).toUpperCase(),level:String(v.level).toUpperCase(),credit:D}:null;o==null||o({type:"REDUCE",amount:D,group:O==null?void 0:O.group,level:O==null?void 0:O.level,selection:O,note:O?`Reduo ${O.group} nvel ${O.level} +R$ ${D.toLocaleString()}`:`Reduo +R$ ${D.toLocaleString()}`})}}),i==="fire"&&a.jsx(tb,{roles:_,onBack:()=>l("menu"),onConfirm:v=>o==null?void 0:o(v)})]},i)})}function nb({playerName:t="Jogador",balanceText:e=""}){const{resolveTop:n,closeModal:r}=nn(),o=E.useRef(null);E.useEffect(()=>{var c;const u=document.body.style.overflow;return document.body.style.overflow="hidden",(c=o.current)==null||c.focus(),()=>{document.body.style.overflow=u}},[]),E.useEffect(()=>{const u=c=>{(c.key==="Escape"||c.key==="Enter"||c.key===" ")&&(c.preventDefault(),c.stopPropagation())};return document.addEventListener("keydown",u,!0),()=>document.removeEventListener("keydown",u,!0)},[]);const s=u=>{u.preventDefault(),u.stopPropagation()},i=()=>{n(!1),r==null||r()},l=()=>{n(!0),r==null||r()};return a.jsxs(si,{width:780,onClose:i,children:[a.jsx("style",{children:`
        .sg-modal-panel {
          background:#111827; border:1px solid rgba(255,255,255,0.08);
          border-radius:16px; padding:20px 22px 18px; color:#e5e7eb;
          position:relative; box-shadow:0 10px 35px rgba(0,0,0,.55);
        }
        .sg-modal-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
        .sg-modal-title{font-size:22px;font-weight:700;margin:0}
        .sg-icon-close{background:transparent;border:0;color:#9ca3af;font-size:24px;line-height:1;cursor:pointer}
        .sg-icon-close:hover{color:#e5e7eb}

        .sg-modal-infos{display:flex;justify-content:space-between;align-items:center;
          font-size:14px;color:#cbd5e1;margin:6px 0 12px}
        .sg-modal-infos .right{opacity:.8}

        .sg-callout-warning{
          background:rgba(250,204,21,.12); border:1px solid rgba(250,204,21,.45);
          border-radius:12px; padding:14px 16px; margin-bottom:14px
        }
        .sg-callout-title{font-weight:700;margin-bottom:6px;color:#fde68a}
        .sg-muted{opacity:.7}

        .sg-modal-body{margin:8px 2px 14px;font-size:15px;line-height:1.5}

        .sg-modal-actions{display:flex;justify-content:space-between;gap:12px;margin-top:10px}
        .sg-btn{font-weight:600;border:0;cursor:pointer;padding:12px 18px}
        .sg-pill{border-radius:999px}
        .sg-btn-neutral{background:#374151;color:#e5e7eb}
        .sg-btn-neutral:hover{background:#4b5563}
        .sg-btn-danger{background:#b91c1c;color:#fff}
        .sg-btn-danger:hover{background:#991b1b}
        .sg-btn:focus{outline:2px solid rgba(255,255,255,.35);outline-offset:2px}
      `}),a.jsxs("div",{className:"sg-modal-panel",role:"dialog","aria-modal":"true","aria-labelledby":"bk-title","aria-describedby":"bk-desc",onClick:s,onMouseDown:s,onKeyDown:s,children:[a.jsxs("div",{className:"sg-modal-header",children:[a.jsx("h2",{id:"bk-title",className:"sg-modal-title",children:"Declarar Falncia"}),a.jsx("button",{className:"sg-icon-close","aria-label":"Fechar",onClick:i,children:""})]}),a.jsxs("div",{className:"sg-modal-infos",children:[a.jsx("div",{className:"left",children:e?a.jsxs(a.Fragment,{children:["Saldo disponvel: ",a.jsx("b",{children:e})]}):a.jsx(a.Fragment,{children:""})}),a.jsx("div",{className:"right",children:"Ao permanente nesta partida"})]}),a.jsxs("div",{className:"sg-callout-warning",id:"bk-desc",children:[a.jsx("div",{className:"sg-callout-title",children:"Ateno"}),a.jsxs("p",{children:[t,", ao confirmar, voc ser marcado como ",a.jsx("b",{children:"FALIDO"}),". Seu turno ser ",a.jsx("b",{children:"sempre pulado"})," e voc no poder mais executar aes."]}),a.jsx("p",{className:"sg-muted",children:"Esta deciso  irreversvel at o fim da partida."})]}),a.jsx("div",{className:"sg-modal-body",children:a.jsxs("p",{children:["Confirme abaixo para encerrar sua participao ativa. Voc continuar visvel no placar como ",a.jsx("b",{children:"FALIDO"}),"."]})}),a.jsxs("div",{className:"sg-modal-actions",children:[a.jsx("button",{className:"sg-btn sg-pill sg-btn-neutral",onClick:i,children:"Cancelar"}),a.jsx("button",{ref:o,className:"sg-btn sg-pill sg-btn-danger",onClick:l,children:"Declarar Falncia"})]})]})]})}const Jr=5;function rb({players:t,setPlayers:e,round:n,setRound:r,turnIdx:o,setTurnIdx:s,roundFlags:i,setRoundFlags:l,isMyTurn:u,isMine:c,myUid:d,meId:h,myCash:f,current:x,broadcastState:y,appendLog:b,turnLock:_,setTurnLockBroadcast:p,gameOver:m,setGameOver:g,winner:w,setWinner:j,setShowBankruptOverlay:R}){const{pushModal:C,awaitTop:S,closeTop:A}=(nn==null?void 0:nn())||{},[v,D]=ge.useState(0),O=ge.useRef(0);ge.useEffect(()=>{O.current=v},[v]);const M=ge.useRef(!1),te=ge.useRef(!1),ne=ge.useRef(null),ut=ge.useRef(null),nt=ge.useCallback(K=>{if(!Array.isArray(K)||K.length===0)return K;const Te=[...K].filter(Boolean);let Ce=Te.every(Pe=>Number.isInteger(Pe.seat))?Te.sort((Pe,Me)=>Pe.seat-Me.seat):Te.sort((Pe,Me)=>String((Pe==null?void 0:Pe.id)??(Pe==null?void 0:Pe.player_id)??"").localeCompare(String((Me==null?void 0:Me.id)??(Me==null?void 0:Me.player_id)??""))),Dt=0;const P=new Set(Ce.filter(Pe=>Number.isInteger(Pe.seat)).map(Pe=>Pe.seat));return Ce=Ce.map(Pe=>{if(Number.isInteger(Pe.seat))return Pe;for(;P.has(Dt);)Dt++;return P.add(Dt),{...Pe,seat:Dt++}}),Ce=Ce.sort((Pe,Me)=>Pe.seat-Me.seat),Ce},[]),F=ge.useMemo(()=>nt(t),[t,nt]);ge.useEffect(()=>{u?console.log("[DEBUG] modalLocks sync - isMyTurn:",u,"modalLocks:",v):v>0&&(console.log("[DEBUG] modalLocks sync - resetando modalLocks para 0 (no  minha vez)"),D(0),O.current=0,M.current=!1)},[u,v]),ge.useEffect(()=>(_?(ne.current&&clearTimeout(ne.current),ne.current=setTimeout(()=>{const K=Oe.current,Te=String(K||"")===String(d),Ve=O.current,Ce=M.current;console.warn("[DEBUG]  TIMEOUT DE SEGURANA - turnLock ativo h mais de 30s",{isLockOwner:Te,currentModalLocks:Ve,currentOpening:Ce,lockOwner:K}),Te&&Ve===0&&!Ce&&(console.warn("[DEBUG]  FORANDO LIBERAO DO TURNLOCK (timeout de segurana)"),p(!1),te.current=!1)},3e4)):ne.current&&(clearTimeout(ne.current),ne.current=null),()=>{ne.current&&(clearTimeout(ne.current),ne.current=null)}),[_,d,p]);const[ue,ae]=ge.useState(null),Oe=ge.useRef(null);ge.useEffect(()=>{Oe.current=ue},[ue]);const je=ge.useRef(null),re=ge.useRef(n);ge.useEffect(()=>{re.current=n,console.log("[DEBUG]  currentRoundRef atualizado para:",n)},[n]);const we=ge.useRef(t);ge.useEffect(()=>{we.current=t},[t]);const wn=ge.useRef(o);ge.useEffect(()=>{wn.current=o},[o]);const Et=ge.useRef(m);ge.useEffect(()=>{Et.current=m},[m]);const Y=ge.useRef(!1),br=ge.useRef(!1);ge.useEffect(()=>{const K=t[o];K&&String(K.id)===String(d)?(console.log("[DEBUG]  minha vez - atualizando lockOwner para:",d,"turnIdx:",o),ae(String(d)),je.current&&(je.current.nextTurnIdx===o?(console.log("[DEBUG] Limpando pendingTurnDataRef - turno j foi processado (nextTurnIdx === turnIdx)"),je.current=null):console.log("[DEBUG] Mantendo pendingTurnDataRef - prximo turno:",je.current.nextTurnIdx,"turno atual:",o))):(ue===String(d)&&(console.log("[DEBUG] No  mais minha vez - limpando lockOwner"),ae(null)),je.current&&je.current.nextTurnIdx!==o&&(console.log("[DEBUG] Limpando pendingTurnDataRef - no  minha vez e dados no so para turno atual"),je.current=null))},[o,t,d,ue]);const De=async K=>{if(!(C&&S))return null;M.current=!0,D(Ve=>{const Ce=Ve+1;return O.current=Ce,ut.current=null,console.log("[DEBUG] openModalAndWait - ABRINDO modal, modalLocks:",Ve,"->",Ce,"openingModalRef:",M.current),Ce});let Te=!1;try{C(K),await new Promise(Ce=>setTimeout(Ce,100)),M.current=!1,console.log("[DEBUG] openModalAndWait - Modal renderizada, openingModalRef:",M.current);const Ve=await S();return Te=!0,await new Promise(Ce=>setTimeout(Ce,50)),Ve}catch(Ve){return console.error("[DEBUG]  ERRO ao abrir/aguardar modal:",Ve),Te=!0,M.current=!1,D(Ce=>{const Dt=Math.max(0,Ce-1);return O.current=Dt,Dt===0&&(ut.current=Date.now()),console.log("[DEBUG] openModalAndWait - ERRO, decrementando modalLocks:",Ce,"->",Dt),Dt}),null}finally{Te||(M.current=!1),Te&&D(Ve=>{const Ce=Math.max(0,Ve-1);return O.current=Ce,Ce===0&&(ut.current=Date.now(),console.log("[DEBUG] openModalAndWait - LTIMA MODAL FECHADA - timestamp:",ut.current)),console.log("[DEBUG] openModalAndWait - FECHANDO modal, modalLocks:",Ve,"->",Ce),Ce})}},Bn=ge.useCallback((K,Te)=>{const Ve=t[K],Ce=Math.max(0,Number(Te||0));return Number((Ve==null?void 0:Ve.cash)||0)>=Ce},[t]),ct=ge.useCallback((K,Te,Ve)=>{const Ce=Bn(K,Te);return Ce||b(`Saldo insuficiente${Ve?" para "+Ve:""}. Use RECUPERAO (demitir / emprestar / reduzir) ou declare FALNCIA.`),Ce},[Bn,b]),go=ge.useCallback((K,Te,Ve)=>{var Pe;if(Te<=Jr)return{finished:!1,winner:null,finalRound:Te};const Ce=(K||[]).filter(Me=>!(Me!=null&&Me.bankrupt));if(Ce.length===0)return console.log("[DEBUG]  FIM DE JOGO - Nenhum jogador vivo restante"),{finished:!0,winner:null,finalRound:Jr};const P=((Pe=Ce.map(Me=>({player:Me,patrimonio:(Me.cash||0)+(Me.bens||0),cash:Me.cash||0})).sort((Me,Wt)=>{var It,W;return Wt.patrimonio-Me.patrimonio||Wt.cash-Me.cash||String(((It=Me.player)==null?void 0:It.name)||"").localeCompare(String(((W=Wt.player)==null?void 0:W.name)||""))})[0])==null?void 0:Pe.player)||null;return console.log("[ENDGAME] finalizando: vencedor=",(P==null?void 0:P.name)||"N/A",", round=",Jr),{finished:!0,winner:P,finalRound:Jr}},[]),sn=ge.useCallback((K,Te,Ve)=>{var Ce,Dt;if(console.log("[DEBUG]  advanceAndMaybeLap chamada - steps:",K,"deltaCash:",Te,"note:",Ve),!(Et.current||Y.current||br.current||!t.length)){if(te.current){console.warn("[DEBUG]  advanceAndMaybeLap - mudana de turno j em progresso, ignorando");return}if(O.current>0||M.current){console.warn("[DEBUG]  advanceAndMaybeLap - h modais abertas, aguardando...",{modalLocks:O.current,opening:M.current}),setTimeout(()=>{O.current===0&&!M.current&&sn(K,Te,Ve)},200);return}te.current=!0,p(!0),ae(String(d));try{const P=o,Pe=F[P];if(!Pe){p(!1),te.current=!1;return}const Me=String(Pe.id);console.log("[DEBUG]  POSIO INICIAL - Jogador:",Pe.name,"Posio:",Pe.pos,"Saldo:",Pe.cash);const Wt=async(k,B,q,H=t)=>{var G,Z,me,de,Le,et,_t,dn,Ae,gt,yt,Bt,Vt,Sn,Dn;const pe=Number(((G=H[P])==null?void 0:G.cash)||0);if(pe>=k){console.log("[DEBUG]  Saldo suficiente! Processando pagamento de:",k);const ye=nt(H).map(T=>String(T.id)!==Me?T:{...T,cash:Math.max(0,(T.cash||0)-k),pos:T.pos});return e(ye),y(ye,o,re.current),!0}M.current=!0;const he=await De(a.jsx(vr,{requiredAmount:k,currentCash:pe,title:`Saldo insuficiente para ${q} ${B}`,message:`Voc precisa ${q} R$ ${k.toLocaleString()} mas possui apenas R$ ${pe.toLocaleString()}.`,showRecoveryOptions:!0}));if(!he)return p(!1),!1;if(he.action==="RECOVERY"){console.log("[DEBUG] Abrindo RecoveryModal para jogador:",H[P]);const ye=await De(a.jsx(_f,{currentPlayer:H[P],canClose:!1}));if(console.log("[DEBUG] RecoveryModal retornou:",ye),ye){console.log("[DEBUG] recoveryModalRes existe, tipo:",ye.type,"action:",ye.action);let T=H;if(ye.type==="FIRE"){console.log("[DEBUG]  Condio FIRE atendida! Processando demisses:",ye);const ie={cashDelta:Number(ye.amount||0),vendedoresComunsDelta:-Number(((Z=ye.items)==null?void 0:Z.comum)||0),fieldSalesDelta:-Number(((me=ye.items)==null?void 0:me.field)||0),insideSalesDelta:-Number(((de=ye.items)==null?void 0:de.inside)||0),gestoresDelta:-Number(((Le=ye.items)==null?void 0:Le.gestor)||0)};console.log("[DEBUG] Deltas de demisso:",ie),T=H.map((se,ce)=>ce!==P?se:{...Tt(se,ie),pos:se.pos}),console.log("[DEBUG] Novo saldo aps demisses:",(et=T[P])==null?void 0:et.cash),e(T),y(T,o,re.current)}else if(ye.type==="LOAN"){console.log("[DEBUG]  Condio LOAN atendida! Processando emprstimo:",ye);const ie=(_t=H[P])==null?void 0:_t.loanPending;if(ie&&Number(ie.amount)>0){console.log("[DEBUG]  Jogador j possui emprstimo pendente:",ie);const ce=await De(a.jsx(vr,{requiredAmount:k,currentCash:((dn=H[P])==null?void 0:dn.cash)||0,title:"Emprstimo j realizado",message:`Voc j possui um emprstimo pendente de R$ ${Number(ie.amount).toLocaleString()}. Cada jogador s pode ter um emprstimo por vez.`,showRecoveryOptions:!1,canClose:!1}));if(!ce||ce.action!=="BANKRUPT")return p(!1),!1;const Se=H.map((qr,ns)=>ns===P?{...qr,bankrupt:!0}:qr);if(As(Se)<=1){const qr=Se.findIndex(ns=>!(ns!=null&&ns.bankrupt));return j(qr>=0?Se[qr]:null),e(Se),g(!0),p(!1),y(Se,o,n,!0,qr>=0?Se[qr]:null),!1}const Xe=fs(Se,P),An=Se[Xe],fm=An!=null&&An.id?String(An.id):null;return e(Se),s(Xe),p(!1),y(Se,Xe,re.current,!1,null,{turnPlayerId:fm}),!1}const se=Number(ye.amount||0);console.log("[DEBUG] Valor do emprstimo:",se),console.log("[DEBUG] Saldo atual do jogador:",(Ae=H[P])==null?void 0:Ae.cash),T=H.map((ce,Se)=>Se!==P?ce:{...ce,cash:(Number(ce.cash)||0)+se,loanPending:{amount:se,charged:!1,shouldChargeOnNextExpenses:!0},pos:ce.pos}),console.log("[DEBUG] Novo saldo do jogador:",(gt=T[P])==null?void 0:gt.cash),console.log("[DEBUG] Novo loanPending:",(yt=T[P])==null?void 0:yt.loanPending),e(T),y(T,o,re.current)}else if(ye.type==="REDUCE"){console.log("[DEBUG]  Condio REDUCE atendida! Processando reduo:",ye);const ie=ye.items||[];let se=0;console.log("[DEBUG] Selees para reduzir:",ie),T=H.map((ce,Se)=>{if(Se!==P)return ce;let Ge={...ce};for(const Xe of ie)Xe.selected&&(se+=Number(Xe.credit||0),Xe.group==="MIX"?Ge.mixOwned={...Ge.mixOwned||{},[Xe.level]:!1}:Xe.group==="ERP"&&(Ge.erpOwned={...Ge.erpOwned||{},[Xe.level]:!1}));return Ge.cash=(Number(Ge.cash)||0)+se,Ge.pos=ce.pos,Ge}),console.log("[DEBUG] Total de crdito da reduo:",se),console.log("[DEBUG] Novo saldo aps reduo:",(Bt=T[P])==null?void 0:Bt.cash),e(T),y(T,o,re.current)}else console.log("[DEBUG]  Nenhuma condio foi atendida! Tipo:",ye.type,"Action:",ye.action);const Be=Number(((Vt=T[P])==null?void 0:Vt.cash)||0);if(console.log("[DEBUG] Verificando saldo aps recuperao - Novo saldo:",Be,"Necessrio:",k),Be>=k){console.log("[DEBUG]  Saldo suficiente aps recuperao! Processando pagamento de:",k);const ie=T.map((se,ce)=>ce!==P?se:{...se,cash:Math.max(0,(se.cash||0)-k),pos:se.pos});return console.log("[DEBUG]  PAGAMENTO - Saldo antes:",(Sn=T[P])==null?void 0:Sn.cash,"Valor a pagar:",k,"Saldo aps:",(Dn=ie[P])==null?void 0:Dn.cash),e(ie),y(ie,o,re.current),!0}else return console.log("[DEBUG]  Saldo ainda insuficiente aps recuperao. Continuando recurso..."),await Wt(k,B,q,T)}else return p(!1),!1}else if(he.action==="BANKRUPT"){const ye=H.map((ce,Se)=>Se===P?{...ce,bankrupt:!0}:ce);if(As(ye)<=1){const ce=ye.findIndex(Se=>!(Se!=null&&Se.bankrupt));return j(ce>=0?ye[ce]:null),e(ye),g(!0),p(!1),y(ye,o,n,!0,ce>=0?ye[ce]:null),!1}const Be=fs(ye,P),ie=ye[Be],se=ie!=null&&ie.id?String(ie.id):null;return e(ye),s(Be),p(!1),y(ye,Be,re.current,!1,null,{turnPlayerId:se}),!1}else return p(!1),!1},It=Pe.pos,W=(It+K)%Ds,fe=W<It,Re=fe&&It>=Ds-1;console.log("[DEBUG]  MOVIMENTO - De posio:",It,"Para posio:",W,"Steps:",K,"Lap:",fe,"CompletedLap:",Re);const ve=El(It,W,0)||fe,Ue=re.current,Fe=t.filter(k=>!(k!=null&&k.bankrupt)).length,J=nt(t).map(k=>{if(String(k.id)!==Me)return k;const B=(k.cash||0)+(Te||0),q=Number(k.lastRevenueRound)||0;let H=!1,pe=W;if(ve){const he=Math.max(q,Ue);return Ue===5&&Fe>1&&(H=!0,pe=0),{...k,pos:pe,cash:Math.max(0,B),lastRevenueRound:he,waitingAtRevenue:H}}return{...k,pos:pe,cash:Math.max(0,B),lastRevenueRound:q,waitingAtRevenue:!1}}),Ne=J.find(k=>String(k.id)===Me);console.log("[DEBUG]  APS MOVIMENTO - Jogador:",Ne==null?void 0:Ne.name,"Posio:",Ne==null?void 0:Ne.pos,"Saldo:",Ne==null?void 0:Ne.cash,"lastRevenueRound:",Ne==null?void 0:Ne.lastRevenueRound,"waitingAtRevenue:",Ne==null?void 0:Ne.waitingAtRevenue);let N=re.current,I=[...i],oe=!1,xe=!1;if(fe){console.log("[DEBUG]  VOLTA COMPLETA DETECTADA (lap=true) - Jogador completou uma volta completa!",{jogador:Pe.name,posicaoAnterior:It,posicaoNova:W,rodadaAtual:re.current}),I.length<t.length&&(I=[...I,...new Array(t.length-I.length).fill(!1)]);const k=F.findIndex(B=>String(B.id)===Me);k>=0&&(I[k]=!0),console.log("[DEBUG]  Flag marcada por volta completa (lap) - Flags:",I.map((B,q)=>{var H;return`${(H=F[q])==null?void 0:H.name}:${B}`}).join(", "))}if(ve){I.length<t.length&&(I=[...I,...new Array(t.length-I.length).fill(!1)]);const k=F.findIndex(G=>String(G.id)===Me);k>=0&&(I[k]?console.log("[DEBUG]  Jogador j tinha flag marcada (por lap) - Flags:",I.map((G,Z)=>{var me;return`${(me=F[Z])==null?void 0:me.name}:${G}`}).join(", ")):(I[k]=!0,console.log("[DEBUG]  Jogador passou pela casa 0 (crossedStart1ForRound) - Flags:",I.map((G,Z)=>{var me;return`${(me=F[Z])==null?void 0:me.name}:${G}`}).join(", "))));const B=J.filter(G=>!(G!=null&&G.bankrupt)),q=J.map((G,Z)=>G!=null&&G.bankrupt?-1:Z).filter(G=>G>=0),H=J.filter(G=>!(G!=null&&G.bankrupt)),pe=H.length>0&&H.every(G=>(Number(G.lastRevenueRound)||0)>=re.current);console.log("[DEBUG]  Verificando allAliveDone - Rodada atual:",re.current,"Jogadores vivos:",H.map(G=>({name:G.name,lastRevenueRound:G.lastRevenueRound})));const he=J.find(G=>String(G.id)===Me);if(console.log("[DEBUG]  Verificao de rodada - Jogador:",he==null?void 0:he.name,"Rodada atual:",re.current,"round do closure:",n),console.log("[DEBUG]  Jogadores vivos:",q.map(G=>{const Z=J[G],me=F.findIndex(de=>String(de.id)===String(Z==null?void 0:Z.id));return`${Z==null?void 0:Z.name}:${me>=0?I[me]:!1}`}).join(", ")),console.log("[DEBUG]  Total de jogadores vivos:",q.length),console.log("[DEBUG]  Flags completas:",I.map((G,Z)=>{var me;return`${(me=J[Z])==null?void 0:me.name}:${G?"":""}`}).join(", ")),console.log("[DEBUG]  Todos passaram pela casa 0?",pe),pe){const G=re.current;N=G+1,oe=!0,console.log("[DEBUG]  Calculando incremento - round (ref):",G,"round (closure):",n,"nextRound:",N),I=I.map((me,de)=>{var Le;return(Le=J[de])!=null&&Le.bankrupt?I[de]:!1}),console.log("[DEBUG]  RODADA INCREMENTADA - Nova rodada:",N,"Rodada anterior (ref):",G,"Rodada anterior (closure):",n,"Jogadores vivos:",H.length),console.log("[DEBUG]  Flags resetadas:",I.map((me,de)=>{var Le;return`${(Le=J[de])==null?void 0:Le.name}:${me}`}).join(", ")),b(` Rodada ${N} iniciada! Todos os jogadores vivos passaram pela casa de faturamento.`)}else{const G=H.filter(Z=>(Number(Z.lastRevenueRound)||0)<re.current).map(Z=>Z.name);console.log("[DEBUG]  Rodada NO incrementada - ainda faltam jogadores completarem o ms:",G.join(", "))}}l(I),console.log("[DEBUG] roundFlags updated / round closed:",I.map((k,B)=>{var q;return`${(q=J[B])==null?void 0:q.name}:${k}`}).join(", "));let L=fs(J,P);if(re.current===5){let k=0;for(;k<J.length;){const B=J[L];if(!B.bankrupt&&B.waitingAtRevenue!==!0)break;L=(L+1)%J.length,k++}}Te&&b(`${Pe.name} ${Te>0?"ganhou":"pagou"} $${Math.abs(Te).toLocaleString()}`),Ve&&b(Ve),e(J),r(k=>{let B=k;return oe?N>k?(B=N,console.log("[DEBUG]  RODADA INCREMENTADA - Rodada anterior:",k,"Nova rodada:",B,"nextRound calculado:",N),console.log("[DEBUG]  Rodada incrementada com sucesso!"),b(` Rodada ${B} iniciada! Todos os jogadores vivos passaram pela casa de faturamento.`)):(B=k+1,console.log("[DEBUG]  RODADA INCREMENTADA (forado) - Rodada anterior:",k,"Nova rodada:",B,"nextRound calculado:",N),console.log("[DEBUG]  Rodada incrementada com sucesso (forado devido a sincronizao)!"),b(` Rodada ${B} iniciada! Todos os jogadores vivos passaram pela casa de faturamento.`)):(B=Math.max(N,k),B!==k&&console.log("[DEBUG]  Rodada atualizada via Math.max - prevRound:",k,"nextRound:",N,"finalRound:",B)),re.current=B,B});const $=N,z=I,V=J[L],_e=V!=null&&V.id?String(V.id):null;je.current={nextPlayers:J,nextTurnIdx:L,nextTurnPlayerId:_e,nextRound:$,nextRoundFlags:z,timestamp:Date.now(),shouldIncrementRound:oe,endGame:xe},console.log("[DEBUG]  pendingTurnDataRef preenchido - prximo turno:",L,"rodada atual:",n,"prxima rodada:",$,"nextRound calculado:",N,"shouldIncrementRound:",oe,"rodada foi incrementada?",N>n,"roundFlags:",z.map((k,B)=>{var q;return`${(q=J[B])==null?void 0:q.name}:${k}`}).join(", "));const le=W+1,ke=El(It,W,0),Ze=El(It,W,22);let mt=!1;if((le===6||le===16||le===32||le===49)&&u&&C&&S&&(mt=!0,M.current=!0,(async()=>{var pe,he,G,Z,me;const k=((pe=t[P])==null?void 0:pe.erpLevel)||null,B=((he=t[P])==null?void 0:he.erpOwned)||((G=t[P])==null?void 0:G.erp)||{},q=await De(a.jsx(mf,{currentCash:((Z=J[P])==null?void 0:Z.cash)??f,currentLevel:k,erpOwned:B}));if(!q||q.action!=="BUY")return;const H=Number(((me=q.values)==null?void 0:me.compra)||0);if(!ct(P,H,"comprar ERP")){p(!1);return}e(de=>{const Le=de.map((et,_t)=>_t!==P?et:Tt(et,{cashDelta:-H,erpLevelSet:q.level}));return y(Le,o,re.current),Le})})()),(le===2||le===11||le===19||le===47)&&u&&C&&S&&(M.current=!0,(async()=>{var H,pe,he,G;const k=t.find(c)||J[P],B=await De(a.jsx(gf,{canTrain:{comum:Number(k==null?void 0:k.vendedoresComuns)||0,field:Number(k==null?void 0:k.fieldSales)||0,inside:Number(k==null?void 0:k.insideSales)||0,gestor:Number((k==null?void 0:k.gestores)??(k==null?void 0:k.gestoresComerciais)??(k==null?void 0:k.managers))||0},ownedByType:{comum:((H=k==null?void 0:k.trainingsByVendor)==null?void 0:H.comum)||[],field:((pe=k==null?void 0:k.trainingsByVendor)==null?void 0:pe.field)||[],inside:((he=k==null?void 0:k.trainingsByVendor)==null?void 0:he.inside)||[],gestor:((G=k==null?void 0:k.trainingsByVendor)==null?void 0:G.gestor)||[]}}));if(!B||B.action!=="BUY")return;const q=Number(B.grandTotal||0);if(!ct(P,q,"comprar Treinamento")){p(!1);return}e(Z=>{const me=Z.map((de,Le)=>Le!==P?de:hf(de,B));return y(me,o,re.current),me})})()),(le===5||le===10||le===43)&&u&&C&&S&&(M.current=!0,(async()=>{var q,H,pe,he,G,Z,me,de,Le,et,_t,dn,Ae,gt,yt,Bt,Vt,Sn,Dn;const k=((q=J[P])==null?void 0:q.cash)??f,B=await De(a.jsx(Kx,{currentCash:k}));if(B){if(B.action==="OPEN"){const ye=String(B.open||"").toUpperCase();if(ye==="MIX"){const T=((H=t[P])==null?void 0:H.mixProdutos)||null,Be=((pe=t[P])==null?void 0:pe.mixOwned)||((he=t[P])==null?void 0:he.mix)||{},ie=await De(a.jsx(Sf,{currentCash:((G=J[P])==null?void 0:G.cash)??f,currentLevel:T,mixOwned:Be}));if(ie&&ie.action==="BUY"){const se=Number(ie.compra||0),ce=String(ie.level||"D");if(!ct(P,se,"comprar MIX")){p(!1);return}e(Se=>{const Ge=Se.map((Xe,An)=>An!==P?Xe:Tt(Xe,{cashDelta:-se,mixProdutosSet:ce,mixBaseSet:{despesaPorCliente:Number(ie.despesa||0),faturamentoPorCliente:Number(ie.faturamento||0)}}));return y(Ge,o,re.current),Ge})}return}if(ye==="MANAGER"){const T=await De(a.jsx(xf,{currentCash:((Z=J[P])==null?void 0:Z.cash)??f}));if(T&&(T.action==="BUY"||T.action==="HIRE")){const Be=Number(T.headcount??T.qty??T.managersQty??1),ie=Number(typeof T.cashDelta<"u"?T.cashDelta:-Number(T.cost??T.total??T.totalHire??0)),se=ie<0?-ie:0;if(se>0&&!ct(P,se,"contratar Gestor")){p(!1);return}const ce=Number(T.expenseDelta??T.totalExpense??T.maintenanceDelta??0);e(Se=>{const Ge=Se.map((Xe,An)=>An!==P?Xe:Tt(Xe,{cashDelta:ie,gestoresDelta:Be,manutencaoDelta:ce}));return y(Ge,o,re.current),Ge})}return}if(ye==="INSIDE"){const T=await De(a.jsx(yf,{currentCash:((me=J[P])==null?void 0:me.cash)??f}));if(T&&(T.action==="BUY"||T.action==="HIRE")){const Be=Number(T.cost??T.total??0);if(!ct(P,Be,"contratar Inside Sales")){p(!1);return}const ie=Number(T.headcount??T.qty??1);e(se=>{const ce=se.map((Se,Ge)=>Ge!==P?Se:Tt(Se,{cashDelta:-Be,insideSalesDelta:ie}));return y(ce,o,re.current),ce})}return}if(ye==="FIELD"){const T=await De(a.jsx(bf,{currentCash:((de=J[P])==null?void 0:de.cash)??f}));if(T&&(T.action==="HIRE"||T.action==="BUY")){const Be=Number(T.headcount??T.qty??1),ie={cashDelta:Number(T.cashDelta??-Number(T.totalHire??T.total??T.cost??0)),manutencaoDelta:Number(T.expenseDelta??T.totalExpense??0),revenueDelta:Number(T.revenueDelta??0),fieldSalesDelta:Be},se=ie.cashDelta<0?-ie.cashDelta:0;if(se>0&&!ct(P,se,"contratar Field Sales")){p(!1);return}e(ce=>{const Se=ce.map((Ge,Xe)=>Xe!==P?Ge:Tt(Ge,ie));return y(Se,o,re.current),Se})}return}if(ye==="COMMON"){const T=await De(a.jsx(wf,{currentCash:((Le=J[P])==null?void 0:Le.cash)??f}));if(T&&T.action==="BUY"){const Be=Number(T.headcount??T.qty??0),ie={cashDelta:Number(T.cashDelta??-Number(T.totalHire??T.total??T.cost??0)),vendedoresComunsDelta:Be,manutencaoDelta:Number(T.expenseDelta??T.totalExpense??0),revenueDelta:Number(T.revenueDelta??0)},se=ie.cashDelta<0?-ie.cashDelta:0;if(se>0&&!ct(P,se,"contratar Vendedores Comuns")){p(!1);return}e(ce=>{const Se=ce.map((Ge,Xe)=>Xe!==P?Ge:Tt(Ge,ie));return y(Se,o,re.current),Se})}return}if(ye==="ERP"){const T=((et=t[P])==null?void 0:et.erpLevel)||null,Be=((_t=t[P])==null?void 0:_t.erpOwned)||((dn=t[P])==null?void 0:dn.erp)||{},ie=await De(a.jsx(mf,{currentCash:((Ae=J[P])==null?void 0:Ae.cash)??f,currentLevel:T,erpOwned:Be}));if(ie&&ie.action==="BUY"){const se=Number(((gt=ie.values)==null?void 0:gt.compra)||0);if(!ct(P,se,"comprar ERP")){p(!1);return}e(ce=>{const Se=ce.map((Ge,Xe)=>Xe!==P?Ge:Tt(Ge,{cashDelta:-se,erpLevelSet:ie.level}));return y(Se,o,re.current),Se})}return}if(ye==="CLIENTS"){const T=await De(a.jsx(vf,{currentCash:((yt=J[P])==null?void 0:yt.cash)??f}));if(T&&T.action==="BUY"){const Be=Number(T.totalCost||0);if(!ct(P,Be,"comprar Clientes")){p(!1);return}const ie=Number(T.qty||0),se=Number(T.maintenanceDelta||0),ce=Number(T.bensDelta||Be);e(Se=>{const Ge=Se.map((Xe,An)=>An!==P?Xe:Tt(Xe,{cashDelta:-Be,clientsDelta:ie,manutencaoDelta:se,bensDelta:ce}));return y(Ge,o,re.current),Ge})}return}if(ye==="TRAINING"){const T=t.find(c)||J[P],Be=await De(a.jsx(gf,{canTrain:{comum:Number(T==null?void 0:T.vendedoresComuns)||0,field:Number(T==null?void 0:T.fieldSales)||0,inside:Number(T==null?void 0:T.insideSales)||0,gestor:Number((T==null?void 0:T.gestores)??(T==null?void 0:T.gestoresComerciais)??(T==null?void 0:T.managers))||0},ownedByType:{comum:((Bt=T==null?void 0:T.trainingsByVendor)==null?void 0:Bt.comum)||[],field:((Vt=T==null?void 0:T.trainingsByVendor)==null?void 0:Vt.field)||[],inside:((Sn=T==null?void 0:T.trainingsByVendor)==null?void 0:Sn.inside)||[],gestor:((Dn=T==null?void 0:T.trainingsByVendor)==null?void 0:Dn.gestor)||[]}}));if(Be&&Be.action==="BUY"){const ie=Number(Be.grandTotal||0);if(!ct(P,ie,"comprar Treinamento")){p(!1);return}e(se=>{const ce=se.map((Se,Ge)=>Ge!==P?Se:hf(Se,Be));return y(ce,o,re.current),ce})}return}}if(B.action==="BUY"){if(B.kind==="CLIENTS"||B.modal==="CLIENTS"||typeof B.clientsQty<"u"||typeof B.numClients<"u"||typeof B.totalCost<"u"||typeof B.maintenanceDelta<"u"){const Be=Number(B.totalCost??B.total??B.amount??0);if(!ct(P,Be,"comprar Clientes")){p(!1);return}const ie=Number(B.clientsQty??B.numClients??B.qty??0),se=Number(B.maintenanceDelta??B.maintenance??B.mexp??0),ce=Number(B.bensDelta??Be);e(Se=>{const Ge=Se.map((Xe,An)=>An!==P?Xe:Tt(Xe,{cashDelta:-Be,clientsDelta:ie,manutencaoDelta:se,bensDelta:ce}));return y(Ge,o,re.current),Ge});return}const T=Number(B.total??B.amount??0);if(!ct(P,T,"esta compra")){p(!1);return}e(Be=>{const ie=Be.map((se,ce)=>ce!==P?se:Tt(se,{cashDelta:-T,directBuysPush:[B.item||{total:T}]}));return y(ie,o,re.current),ie})}}})()),(le===12||le===21||le===30||le===42||le===53)&&u&&C&&S&&(M.current=!0,(async()=>{var H;const k=await De(a.jsx(yf,{currentCash:((H=J[P])==null?void 0:H.cash)??f}));if(!k||k.action!=="HIRE"&&k.action!=="BUY")return;const B=Number(k.cost??k.total??0);if(!ct(P,B,"contratar Inside Sales")){p(!1);return}const q=Number(k.headcount??k.qty??1);e(pe=>{const he=pe.map((G,Z)=>Z!==P?G:Tt(G,{cashDelta:-B,insideSalesDelta:q}));return y(he,o,re.current),he})})()),[4,8,15,17,20,27,34,36,39,46,52,55].includes(le)&&u&&C&&S&&(M.current=!0,(async()=>{var he;const k=await De(a.jsx(vf,{currentCash:((he=J[P])==null?void 0:he.cash)??f}));if(!k||k.action!=="BUY")return;const B=Number(k.totalCost||0);if(!ct(P,B,"comprar Clientes")){p(!1);return}const q=Number(k.qty||0),H=Number(k.maintenanceDelta||0),pe=Number(k.bensDelta||B);e(G=>{const Z=G.map((me,de)=>de!==P?me:Tt(me,{cashDelta:-B,clientsDelta:q,manutencaoDelta:H,bensDelta:pe}));return y(Z,o,re.current),Z})})()),[18,24,29,51].includes(le)&&u&&C&&S&&(M.current=!0,(async()=>{var he;const k=await De(a.jsx(xf,{currentCash:((he=J[P])==null?void 0:he.cash)??f}));if(!k||k.action!=="BUY"&&k.action!=="HIRE")return;const B=Number(k.headcount??k.qty??k.managersQty??1),q=Number(typeof k.cashDelta<"u"?k.cashDelta:-Number(k.cost??k.total??k.totalHire??0)),H=q<0?-q:0;if(H>0&&!ct(P,H,"contratar Gestor")){p(!1);return}const pe=Number(k.expenseDelta??k.totalExpense??k.maintenanceDelta??0);e(G=>{const Z=G.map((me,de)=>de!==P?me:Tt(me,{cashDelta:q,gestoresDelta:B,manutencaoDelta:pe}));return y(Z,o,re.current),Z})})()),[13,25,33,38,50].includes(le)&&u&&C&&S&&(M.current=!0,(async()=>{var B;const k=await De(a.jsx(bf,{currentCash:((B=J[P])==null?void 0:B.cash)??f}));if(k&&(k.action==="HIRE"||k.action==="BUY")){const q=Number(k.headcount??k.qty??1),H={cashDelta:Number(k.cashDelta??-Number(k.totalHire??k.total??k.cost??0)),manutencaoDelta:Number(k.expenseDelta??k.totalExpense??0),revenueDelta:Number(k.revenueDelta??0),fieldSalesDelta:q},pe=H.cashDelta<0?-H.cashDelta:0;if(pe>0&&!ct(P,pe,"contratar Field Sales")){p(!1);return}e(he=>{const G=he.map((Z,me)=>me!==P?Z:Tt(Z,H));return y(G,o,re.current),G})}})()),[9,28,40,45].includes(le)&&u&&C&&S&&(M.current=!0,(async()=>{var pe;const k=await De(a.jsx(wf,{currentCash:((pe=J[P])==null?void 0:pe.cash)??f}));if(!k||k.action!=="BUY")return;const B=Number(k.headcount??k.qty??0),q={cashDelta:Number(k.cashDelta??-Number(k.totalHire??k.total??k.cost??0)),vendedoresComunsDelta:B,manutencaoDelta:Number(k.expenseDelta??k.totalExpense??0),revenueDelta:Number(k.revenueDelta??0)},H=q.cashDelta<0?-q.cashDelta:0;if(H>0&&!ct(P,H,"contratar Vendedores Comuns")){p(!1);return}e(he=>{const G=he.map((Z,me)=>me!==P?Z:Tt(Z,q));return y(G,o,re.current),G})})()),[7,31,44].includes(le)&&u&&C&&S&&(M.current=!0,(async()=>{var he,G,Z,me;const k=((he=t[P])==null?void 0:he.mixProdutos)||null,B=((G=t[P])==null?void 0:G.mixOwned)||((Z=t[P])==null?void 0:Z.mix)||{},q=await De(a.jsx(Sf,{currentCash:((me=J[P])==null?void 0:me.cash)??f,currentLevel:k,mixOwned:B}));if(!q||q.action!=="BUY")return;const H=Number(q.compra||0);if(!ct(P,H,"comprar MIX")){p(!1);return}const pe=String(q.level||"D");e(de=>{const Le=de.map((et,_t)=>_t!==P?et:Tt(et,{cashDelta:-H,mixProdutosSet:pe,mixBaseSet:{despesaPorCliente:Number(q.despesa||0),faturamentoPorCliente:Number(q.faturamento||0)}}));return y(Le,o,re.current),Le})})()),[3,14,22,26,35,41,48,54].includes(le)&&u&&C&&S&&(M.current=!0,(async()=>{const k=await De(a.jsx(Jx,{}));if(!k||k.action!=="APPLY_CARD")return;const B=J[P]||t.find(c)||{};let q=Number.isFinite(k.cashDelta)?Number(k.cashDelta):0,H=Number.isFinite(k.clientsDelta)?Number(k.clientsDelta):0;if(q<0){const he=-q;await Wt(he,"Sorte & Revs","pagar",J)}if(e(he=>{const G=he.map((Z,me)=>{var Le;if(me!==P)return Z;let de={...Z};if(q&&(de.cash=Math.max(0,(de.cash??0)+q)),H){const et=de.clients||0;de.clients=Math.max(0,et+H),console.log("[DEBUG] SorteReves - Clientes alterados:",et,"->",de.clients,"delta:",H)}if(k.gainSpecialCell&&(de.fieldSales=(de.fieldSales||0)+(k.gainSpecialCell.fieldSales||0),de.support=(de.support||0)+(k.gainSpecialCell.support||0),de.gestores=(de.gestores||0)+(k.gainSpecialCell.manager||0),de.gestoresComerciais=(de.gestoresComerciais||0)+(k.gainSpecialCell.manager||0),de.managers=(de.managers||0)+(k.gainSpecialCell.manager||0)),k.id==="casa_change_cert_blue"){de.az=(de.az||0)+1;const et=new Set(((Le=de.trainingsByVendor)==null?void 0:Le.comum)||[]);et.add("personalizado"),de.trainingsByVendor={...de.trainingsByVendor||{},comum:Array.from(et)}}return de});return y(G,o,re.current),G}),k.perClientBonus||k.perCertifiedManagerBonus||k.mixLevelBonusABOnly){const he=J[P]||t.find(c)||{};let G=0;if(k.perClientBonus&&(G+=(Number(he.clients)||0)*Number(k.perClientBonus||0)),k.perCertifiedManagerBonus&&(G+=$x(he)*Number(k.perCertifiedManagerBonus||0)),k.mixLevelBonusABOnly){const Z=String(he.mixProdutos||"").toUpperCase();(Z==="A"||Z==="B")&&(G+=Number(k.mixLevelBonusABOnly||0))}G&&e(Z=>{const me=Z.map((de,Le)=>Le===P?{...de,cash:(Number(de.cash)||0)+G}:de);return y(me,o,re.current),me})}})()),ke&&u&&C&&S){M.current=!0;const k=J[P]||{},B=Math.max(0,Math.floor(Ba(k)));(async()=>{await De(a.jsx(Yx,{value:B})),e(q=>{const H=q.map((pe,he)=>he!==P?pe:{...pe,cash:(pe.cash||0)+B});return y(H,o,re.current),H}),b(`${k.name} recebeu faturamento do ms: +$${B.toLocaleString()}`);try{setTimeout(()=>A==null?void 0:A({action:"AUTO_CLOSE_BELOW"}),0)}catch{}})()}if(Ze&&u&&C&&S){M.current=!0,console.log("[DEBUG]  DESPESAS OPERACIONAIS - Jogador:",(Ce=J[P])==null?void 0:Ce.name,"Posio atual:",(Dt=J[P])==null?void 0:Dt.pos);const k=J[P]||{},B=Math.max(0,Math.floor(Ua(k))),q=k.loanPending||{},H=Number(q.amount)>0&&!q.charged&&q.shouldChargeOnNextExpenses===!0,pe=H?Math.max(0,Math.floor(Number(q.amount))):0;console.log("[DEBUG]  DESPESAS - Valor:",B,"Emprstimo a cobrar:",pe,"Total:",B+pe),console.log("[DEBUG]  EMPRSTIMO - Detalhes:",{amount:Number(q.amount),charged:q.charged,shouldChargeOnNextExpenses:q.shouldChargeOnNextExpenses,currentRound:n,shouldCharge:H}),(async()=>{var Z,me,de;await De(a.jsx(Qx,{expense:B,loanCharge:pe}));const he=B+pe;console.log("[DEBUG]  ANTES handleInsufficientFunds - Saldo atual:",(Z=J[P])==null?void 0:Z.cash,"Total a pagar:",he,"Posio:",(me=J[P])==null?void 0:me.pos);const G=await Wt(he,"Despesas Operacionais","pagar",J);if(console.log("[DEBUG]  APS handleInsufficientFunds - canPayExpenses:",G,"Posio atual:",(de=J[P])==null?void 0:de.pos),!G){console.log("[DEBUG]  canPayExpenses  false - no liberando turno aqui, deixando tick() gerenciar");return}H&&e(Le=>{const et=Le.map((_t,dn)=>{var gt;if(dn!==P)return _t;const Ae={..._t};return Ae.loanPending={..._t.loanPending||{},charged:!0,chargedAtRound:n,shouldChargeOnNextExpenses:!1},Ae.pos=((gt=J[P])==null?void 0:gt.pos)??_t.pos,Ae});return y(et,o,re.current),et}),b(`${k.name} pagou despesas operacionais: -$${B.toLocaleString()}`),pe>0&&b(`${k.name} teve emprstimo cobrado: -$${pe.toLocaleString()}`),e(Le=>{var _t,dn,Ae;const et=Le.map((gt,yt)=>{var Bt;return yt!==P?gt:{...gt,pos:((Bt=J[P])==null?void 0:Bt.pos)??gt.pos}});return console.log("[DEBUG]  DESPESAS FINALIZADAS - Jogador:",(_t=et[P])==null?void 0:_t.name,"Posio final:",(dn=et[P])==null?void 0:dn.pos,"Saldo final:",(Ae=et[P])==null?void 0:Ae.cash),et})})()}const Yn=Date.now();let ln=0;const Qn=200,it=()=>{var Z,me,de;if(ln++,ln>Qn){console.warn("[DEBUG]  TIMEOUT - excedeu tentativas mximas, forando desbloqueio");const Le=Oe.current;String(Le||"")===String(d)&&(p(!1),te.current=!1,O.current>0&&(console.warn("[DEBUG]  Forando modalLocks para 0 (timeout)"),O.current=0,D(0)),M.current=!1);return}const k=O.current,B=M.current,q=Oe.current,H=String(q||"")===String(d);if(console.log("[DEBUG] tick - tentativa:",ln,"modalLocks:",k,"openingModalRef:",B,"lockOwner:",q,"myUid:",d,"isLockOwner:",H),B){console.log("[DEBUG]  tick - modal est sendo aberta, aguardando..."),setTimeout(it,150);return}const pe=ut.current?Date.now()-ut.current:1/0;if(k===0&&(pe>=200||!ut.current)){const Le=je.current;if(!!(Le!=null&&Le.endGame||Y.current)&&!br.current){br.current=!0,Y.current=!1;const Ae=Array.isArray(we.current)?we.current:(Le==null?void 0:Le.nextPlayers)||[],gt=(Ae||[]).filter(Bt=>!(Bt!=null&&Bt.bankrupt));let yt=null;gt.length>0&&(yt=((Z=gt.map(Vt=>({p:Vt,patrimonio:(Number(Vt.cash)||0)+(Number(Vt.bens)||0),cash:Number(Vt.cash)||0})).sort((Vt,Sn)=>{var Dn,ye;return Sn.patrimonio-Vt.patrimonio||Sn.cash-Vt.cash||String(((Dn=Vt.p)==null?void 0:Dn.name)||"").localeCompare(String(((ye=Sn.p)==null?void 0:ye.name)||""))})[0])==null?void 0:Z.p)||null),console.log("[ENDGAME] finalizando: vencedor=%s, round=5",(yt==null?void 0:yt.name)||""),e(Ae||[]),g(!0),j(yt),r(5),re.current=5,je.current=null,te.current=!1,M.current=!1,p(!1),y(Ae||[],wn.current,5,!0,yt,{round:5,gameOver:!0,winner:yt});return}const _t=t[o],dn=_t&&String(_t.id)===String(d);if(H||dn&&!q){const Ae=je.current;if(console.log("[DEBUG]  tick - verificando pendingTurnDataRef:",Ae?`prximo turno: ${Ae.nextTurnIdx}`:"null"),Ae){const gt=O.current,yt=M.current,Bt=o,Vt=Oe.current,Sn=String(Vt||"")===String(d),Dn=ut.current?Date.now()-ut.current:1/0,ye=gt===0&&!yt&&(Dn>=200||!ut.current);if(ye&&Bt===o&&Sn){if(console.log("[DEBUG]  Mudando turno - de:",o,"para:",Ae.nextTurnIdx,"finalModalLocks:",gt,"finalOpening:",yt,"timeSinceLastModalClosed:",Dn),Ae.shouldIncrementRound&&Ae.nextRound>Jr){console.log("[DEBUG]  FIM DE JOGO detectado no tick - prxima rodada seria:",Ae.nextRound,"MAX_ROUNDS:",Jr);const se=go(Ae.nextPlayers,Ae.nextRound,o);if(se.finished){console.log("[DEBUG]  FIM DE JOGO finalizando - Rodada:",se.finalRound,"Vencedor:",((me=se.winner)==null?void 0:me.name)||null),e(Ae.nextPlayers),j(se.winner),g(!0),r(se.finalRound),re.current=se.finalRound,b(`Fim de jogo! ${Jr} rodadas completas. Vencedor: ${((de=se.winner)==null?void 0:de.name)||""}`);const ce={};Ae.nextRoundFlags&&(ce.roundFlags=Ae.nextRoundFlags),ce.round=se.finalRound,ce.gameOver=!0,ce.winner=se.winner,y(Ae.nextPlayers,o,se.finalRound,!0,se.winner,ce),je.current=null,p(!1),te.current=!1;return}}te.current=!0;const T=Ae.nextRound,Be=Ae.shouldIncrementRound||!1;console.log("[DEBUG]  Broadcast - Rodada a ser transmitida:",T,"Rodada atual no estado:",n,"shouldIncrement:",Be),s(Ae.nextTurnIdx),r(se=>{const ce=Math.max(se,T);return ce!==se&&console.log("[DEBUG]  Rodada atualizada no tick - de:",se,"para:",ce),re.current=ce,ce});const ie={};Ae.nextRoundFlags&&(ie.roundFlags=Ae.nextRoundFlags),Ae.shouldIncrementRound&&(ie.round=T),Ae.nextTurnPlayerId&&(ie.turnPlayerId=Ae.nextTurnPlayerId),y(Ae.nextPlayers,Ae.nextTurnIdx,T,m,w,ie),je.current=null,p(!1),te.current=!1,console.log("[DEBUG]  Turno mudado com sucesso - Rodada:",T)}else{console.log("[DEBUG]  tick - condies no atendidas, no mudando turno",{finalModalLocks:gt,finalOpening:yt,finalCanChangeTurn:ye,timeSinceLastModalClosed:Dn,finalTurnIdx:Bt,turnIdx:o,finalIsLockOwner:Sn,isLockOwner:H}),console.log("[DEBUG]  tick - condies no atendidas, no mudando turno",{finalModalLocks:gt,finalOpening:yt,finalTurnIdx:Bt,turnIdx:o,finalIsLockOwner:Sn,isLockOwner:H}),setTimeout(it,150);return}}else{console.log("[DEBUG]  tick - turnData  null, no mudando turno. turnIdx atual:",o,"lockOwner:",q,"isLockOwner:",H);const gt=ut.current?Date.now()-ut.current:1/0,yt=k===0&&(gt>=200||!ut.current);if(H&&yt&&!B)if(ln<10){console.log("[DEBUG]  tick - tentando novamente em 200ms (pode ser que pendingTurnDataRef ainda no foi preenchido)"),setTimeout(it,200);return}else console.warn("[DEBUG]  tick - excedeu tentativas de retry, liberando turnLock"),p(!1),te.current=!1;else p(!1),te.current=!1}}else console.log("[DEBUG]  tick - no sou o dono do cadeado e no  minha vez, no mudando turno",{isLockOwner:H,isCurrentPlayerMe:dn,currentLockOwner:q,myUid:d,turnIdx:o}),dn||(p(!1),te.current=!1);return}setTimeout(it,100)};let Ot=0;const un=50,cn=()=>{Ot++;const k=M.current,B=O.current>0;if((k||B)&&Ot<un){console.log("[DEBUG]  checkBeforeTick - modal sendo aberta ou j aberta, aguardando...",{hasOpening:k,hasLocks:B,modalLocks:O.current,attempt:Ot}),setTimeout(cn,200);return}Ot>=un&&(console.warn("[DEBUG]  checkBeforeTick - excedeu tentativas, forando avano do turno",{hasOpening:k,hasLocks:B,modalLocks:O.current}),O.current>0&&(console.warn("[DEBUG]  checkBeforeTick - forando modalLocks para 0"),O.current=0,D(0)),M.current=!1),console.log("[DEBUG]  checkBeforeTick - iniciando tick, sem modais abertas"),it()};setTimeout(cn,500)}catch(P){throw console.error("[DEBUG] Erro em advanceAndMaybeLap:",P),Oe.current===String(d)&&p(!1),P}finally{Oe.current===String(d)?setTimeout(()=>{Oe.current===String(d)&&(p(!1),te.current=!1)},100):te.current=!1}}},[t,n,o,i,u,c,d,f,m,b,y,e,r,s,l,p,ct,go,C,S,A]),Fa=ge.useCallback(()=>{if(m||!t.length)return;const K=fs(t,o),Te=t[K],Ve=Te!=null&&Te.id?String(Te.id):null;s(K),y(t,K,re.current,!1,null,{turnPlayerId:Ve})},[y,m,t,n,s,o]),St=ge.useCallback(K=>{var Te,Ve,Ce,Dt,P,Pe,Me,Wt,It;if(!(!(K!=null&&K.type)||Et.current||Y.current||br.current)){if(K.type==="ROLL"){if(!u){console.warn("[DEBUG]  onAction ROLL - no  minha vez, ignorando");return}if(_){console.warn("[DEBUG]  onAction ROLL - turnLock ativo, ignorando");return}if(O.current>0){console.warn("[DEBUG]  onAction ROLL - h modais abertas, ignorando");return}try{sn(K.steps,K.cashDelta,K.note)}catch(W){console.error("[DEBUG] Erro em advanceAndMaybeLap:",W),Oe.current===String(d)&&p(!1)}return}if(K.type==="RECOVERY"){const W=Math.floor(Math.random()*3e3)+1e3,fe=t.find(c);if(!fe)return;const Re=t.map(ve=>c(ve)?{...ve,cash:ve.cash+W}:ve);b(`${fe.name} ativou Recuperao Financeira (+$${W})`),e(Re),y(Re,o,re.current);return}if(K.type==="RECOVERY_CUSTOM"){const W=Number(K.amount||0),fe=t.find(c);if(!fe)return;const Re=t.map(ve=>c(ve)?{...ve,cash:ve.cash+W}:ve);b(`${fe.name} recuperou +$${W}`),e(Re),y(Re,o,re.current);return}if(K.type==="RECOVERY_MODAL"){if(!u||!C||!S)return;(async()=>{const W=await De(a.jsx(_f,{playerName:(x==null?void 0:x.name)||"Jogador",currentPlayer:x}));if(W){if(W&&W.type==="TRIGGER_BANKRUPTCY"){St({type:"BANKRUPT"});return}switch(W.type){case"FIRE":St==null||St({type:"RECOVERY_FIRE",items:W.items,amount:W.totalCredit??W.amount??0,note:W.note,creditByRole:W.creditByRole});break;case"REDUCE":{const fe=Array.isArray(W.items)&&W.items.length>0,Re=fe?W.items.map((J,Ne)=>({...J,group:String(J.group||J.tipo||"").toUpperCase(),level:String(J.level||J.nivel||"").toUpperCase(),credit:Number(J.credit??J.amount??0),selected:Ne===0?!0:!!J.selected})):void 0,ve=fe&&(Re==null?void 0:Re[0])||W.selection||W.sel||(W.group&&W.level?{group:String(W.group).toUpperCase(),level:String(W.level).toUpperCase(),credit:Number(W.credit??W.amount??0)}:null),Ue=Number((fe?W.total??W.totalCredit:void 0)??(ve==null?void 0:ve.credit)??W.amount??0),Fe=W.note||(fe?`Reduo mltipla +R$ ${Ue.toLocaleString()}`:ve?`Reduo ${ve.group} nvel ${ve.level} +R$ ${Ue.toLocaleString()}`:`Reduo +R$ ${Ue.toLocaleString()}`);St==null||St({type:"RECOVERY_REDUCE",items:Re,selection:ve||null,amount:Ue,note:Fe});break}case"LOAN":{const fe=typeof W.amount=="object"&&W.amount!==null?W.amount:{amount:Number(W.amount??0),cashDelta:Number(W.cashDelta??W.amount??0),loan:W.loan},Re=Number(fe.amount??0),ve=Number(fe.cashDelta??Re??0),Ue=fe.loan??W.loan??{};St==null||St({type:"RECOVERY_LOAN",amount:Re,cashDelta:ve,loan:Ue,note:W.note});break}default:W.amount>0&&(St==null||St({type:"RECOVERY_CUSTOM",amount:W.amount,note:W.note}))}}})();return}if(K.type==="BANKRUPT_MODAL"){if(!u||!C||!S)return;(async()=>await De(a.jsx(nb,{playerName:(x==null?void 0:x.name)||"Jogador"}))&&(St==null||St({type:"BANKRUPT"})))();return}if(K.type==="RECOVERY_FIRE"){const W=Number(K.amount||0),fe=K.items||{},Re={cashDelta:W,vendedoresComunsDelta:-Number(fe.comum||0),fieldSalesDelta:-Number(fe.field||0),insideSalesDelta:-Number(fe.inside||0),gestoresDelta:-Number(fe.gestor||0)},ve=o;e(Ue=>{const Fe=Ue.map((J,Ne)=>Ne!==ve?J:Tt(J,Re));return y(Fe,o,re.current),Fe}),b(`${((Te=t[ve])==null?void 0:Te.name)||"Jogador"}: ${K.note||"Demisses"}`);return}if(K.type==="RECOVERY_LOAN"){const W=Math.max(0,Number(K.amount||0));if(!W)return;const fe=o,Re=t[fe];if(Re!=null&&Re.loanPending&&!Re.loanPending.charged){b(`${(Re==null?void 0:Re.name)||"Jogador"} j possui um emprstimo pendente.`);return}e(ve=>{const Ue=ve.map((Fe,J)=>J!==fe?Fe:{...Fe,cash:(Number(Fe.cash)||0)+W,loanPending:{amount:W,charged:!1,shouldChargeOnNextExpenses:!0}});return y(Ue,o,re.current),Ue}),b(`${(Re==null?void 0:Re.name)||"Jogador"} pegou emprstimo: +$${W.toLocaleString()}`);return}if(K.type==="BUY_MIX"||K.kind==="MIX_BUY"||K.type==="DIRECT_BUY_MIX"){const W=String(K.level||"").toUpperCase(),fe=Math.max(0,Number(K.price??0));if(!["A","B","C","D"].includes(W)){p(!1);return}const Re=o;if(!Bn(Re,fe)){b("Saldo insuficiente para comprar MIX"),p(!1);return}e(ve=>{const Ue=ve.map((Fe,J)=>{if(J!==Re)return Fe;const Ne={...Fe.mixOwned||Fe.mix||{},D:!0};return Ne[W]=!0,{...Fe,cash:Math.max(0,(Number(Fe.cash)||0)-fe),mixOwned:Ne,mix:Ne,mixLevel:W,mixProdutos:W}});return y(Ue,o,re.current),Ue}),b(`${((Ve=t[Re])==null?void 0:Ve.name)||"Jogador"} comprou MIX nvel ${W} por -$${fe.toLocaleString()}`),p(!1);return}if(K.type==="BUY_ERP"||K.kind==="ERP_BUY"||K.type==="DIRECT_BUY_ERP"){const W=String(K.level||"").toUpperCase(),fe=Math.max(0,Number(K.price??0));if(!["A","B","C","D"].includes(W)){p(!1);return}const Re=o;if(!Bn(Re,fe)){b("Saldo insuficiente para comprar ERP"),p(!1);return}e(ve=>{const Ue=ve.map((Fe,J)=>{if(J!==Re)return Fe;const Ne={...Fe.erpOwned||Fe.erp||{},D:!0};return Ne[W]=!0,{...Fe,cash:Math.max(0,(Number(Fe.cash)||0)-fe),erpOwned:Ne,erp:Ne,erpLevel:W,erpSystems:{...Fe.erpSystems||{},level:W}}});return y(Ue,o,re.current),Ue}),b(`${((Ce=t[Re])==null?void 0:Ce.name)||"Jogador"} comprou ERP nvel ${W} por -$${fe.toLocaleString()}`),p(!1);return}if(K.type==="RECOVERY_REDUCE"){const W=$=>String($||"").toUpperCase(),fe=$=>{const z=String($||"").toUpperCase();return z==="MIX"||z==="ERP"?z:z.includes("MIX")?"MIX":z.includes("ERP")?"ERP":""},ve=(()=>{if(Array.isArray(K.items)&&K.items.length)return K.items.filter(z=>(z==null?void 0:z.selected)??!0).map(z=>({group:fe(z.group||z.kind),level:W(z.level),credit:Math.max(0,Number(z.credit??z.amount??0))})).filter(z=>(z.group==="MIX"||z.group==="ERP")&&["A","B","C"].includes(z.level));const $=K.selection||K.target||null;if($){const z={group:fe($.group||$.kind),level:W($.level),credit:Math.max(0,Number($.credit??$.amount??K.amount??0))};if((z.group==="MIX"||z.group==="ERP")&&["A","B","C"].includes(z.level))return[z]}return[]})();if(!ve.length){const $=Math.max(0,Number(K.amount??0));if($>0){const z=o;e(V=>{const _e=V.map((le,ke)=>ke!==z?le:{...le,cash:(Number(le.cash)||0)+$});return y(_e,o,re.current),_e})}return}const Ue=($,z)=>{const V={A:!1,B:!1,C:!1,D:!1,...$||{}},_e=W(z);return!V.A&&!V.B&&!V.C&&!V.D&&(["A","B","C","D"].includes(_e)?V[_e]=!0:V.D=!0),V},Fe=$=>$!=null&&$.A?"A":$!=null&&$.B?"B":$!=null&&$.C?"C":$!=null&&$.D?"D":"-",J=o,Ne=t[J];if(ve.some($=>$.level==="D")){b("No  possvel reduzir o nvel D (bsico).");return}const I=Array.isArray((Dt=Ne.reducedLevels)==null?void 0:Dt.MIX)?Ne.reducedLevels.MIX:[],oe=Array.isArray((P=Ne.reducedLevels)==null?void 0:P.ERP)?Ne.reducedLevels.ERP:[];if(ve.some($=>$.group==="MIX"&&I.includes($.level)||$.group==="ERP"&&oe.includes($.level))){b("No  possvel reduzir um nvel que j foi reduzido anteriormente.");return}e($=>{const z=$.map((V,_e)=>{var ln,Qn;if(_e!==J)return V;let le={A:!1,B:!1,C:!1,D:!1,...V.mixOwned||V.mix||{}},ke={A:!1,B:!1,C:!1,D:!1,...V.erpOwned||V.erp||{}};le=Ue(le,V.mixProdutos),ke=Ue(ke,V.erpSistemas);const Ze=[...Array.isArray((ln=V.reducedLevels)==null?void 0:ln.MIX)?V.reducedLevels.MIX:[]],mt=[...Array.isArray((Qn=V.reducedLevels)==null?void 0:Qn.ERP)?V.reducedLevels.ERP:[]];let st=0,be=String(V.mixProdutos||"D").toUpperCase(),Mt=String(V.erpLevel||V.erpSistemas||"D").toUpperCase();for(const it of ve)if(st+=Math.max(0,Number(it.credit||0)),it.group==="MIX"){if(it.level===be){const Ot=["A","B","C","D"],un=Ot.indexOf(be);for(let cn=un+1;cn<Ot.length;cn++){const k=Ot[cn];if(le[k]||k==="D"){be=k;break}}}delete le[it.level],le[it.level]=!1,Ze.includes(it.level)||Ze.push(it.level)}else if(it.group==="ERP"){if(it.level===Mt){const Ot=["A","B","C","D"],un=Ot.indexOf(Mt);for(let cn=un+1;cn<Ot.length;cn++){const k=Ot[cn];if(ke[k]||k==="D"){Mt=k;break}}}delete ke[it.level],ke[it.level]=!1,mt.includes(it.level)||mt.push(it.level)}le.A||le.B||le.C||(le.D=!0,le.A=!1,le.B=!1,le.C=!1),ke.A||ke.B||ke.C||(ke.D=!0,ke.A=!1,ke.B=!1,ke.C=!1);const Q=Fe(le),X=Fe(ke),bt=Q!=="-"?Q:be||"D",At=X!=="-"?X:Mt||"D",Nn={...le},Yn={...ke};return{...V,cash:(Number(V.cash)||0)+st,mixOwned:Nn,erpOwned:Yn,mix:Nn,erp:Yn,mixProdutos:bt,erpLevel:At,erpSistemas:At,reducedLevels:{MIX:Ze,ERP:mt}}});return y(z,o,re.current),z});const L=ve.reduce(($,z)=>$+Math.max(0,Number(z.credit||0)),0);if(ve.length===1){const $=ve[0];b(`${(Ne==null?void 0:Ne.name)||"Jogador"} reduziu ${$.group} nvel ${$.level} e recebeu +$${L.toLocaleString()}`)}else b(`${(Ne==null?void 0:Ne.name)||"Jogador"} reduziu ${ve.length} nveis e recebeu +$${L.toLocaleString()}`);return}if(K.type==="BANKRUPT"){const W=o;try{String((Pe=t[W])==null?void 0:Pe.id)===String(d)&&(R==null||R(!0))}catch{}const fe=t.map((Ue,Fe)=>Fe===W?{...Ue,bankrupt:!0}:Ue);if(b(`${((Me=t[W])==null?void 0:Me.name)||"Jogador"} declarou FALNCIA.`),As(fe)<=1){const Ue=fe.findIndex(Fe=>!(Fe!=null&&Fe.bankrupt));j(Ue>=0?fe[Ue]:null),e(fe),g(!0),p(!1),y(fe,o,n,!0,Ue>=0?fe[Ue]:null);return}const ve=fs(fe,W);e(fe),s(ve),p(!1),y(fe,ve,re.current),console.log("[DEBUG]  advanceAndMaybeLap finalizada (falncia) - posio final:",(Wt=fe[ve])==null?void 0:Wt.pos);return}console.log("[DEBUG]  advanceAndMaybeLap finalizada normalmente - posio final:",(It=nextPlayers[curIdx])==null?void 0:It.pos)}},[t,n,o,u,c,d,f,m,b,y,e,r,s,p,g,j,ct,C,S,A,R]);return ge.useEffect(()=>{if(v===0&&_&&!M.current){const K=Oe.current;String(K||"")===String(d)?(console.log("[DEBUG]  Destravando turnLock - modalLocks: 0, sou o lockOwner"),p(!1),te.current=!1):u||(console.log("[DEBUG]  Destravando turnLock - no  minha vez e no sou lockOwner"),p(!1),te.current=!1)}},[v,_,ue,d,u,p]),ge.useEffect(()=>{if(u&&v===0&&_&&!M.current){const K=Oe.current;String(K||"")===String(d)?(console.log("[DEBUG]  Destravando turnLock -  minha vez e sou o lockOwner"),p(!1),te.current=!1):K||(console.log("[DEBUG]  Destravando turnLock -  minha vez mas no h lockOwner"),p(!1),te.current=!1)}},[u,v,_,ue,d,p]),ge.useEffect(()=>()=>{ne.current&&(clearTimeout(ne.current),ne.current=null),te.current=!1,M.current=!1},[]),{advanceAndMaybeLap:sn,onAction:St,nextTurn:Fa,modalLocks:v,lockOwner:ue}}const dm=E.createContext(null),ob=()=>{try{return E.useContext(dm)}catch{return null}};function sb({roomCode:t,hostId:e,children:n}){const r=!!We&&!!t,o=String(t||"").trim(),[s,i]=E.useState(!1),[l,u]=E.useState({}),[c,d]=E.useState(0),h=E.useRef(l),f=E.useRef(c),x=E.useRef(0),y=E.useRef(null),b=E.useRef(null);E.useEffect(()=>{h.current=l},[l]),E.useEffect(()=>{f.current=c},[c]);const _=async g=>{const{data:w,error:j}=await We.from("rooms").select("id, code, host_id, state, version, updated_at").eq("code",g).order("updated_at",{ascending:!1}).limit(1).maybeSingle();return j?(console.warn("[NET] getLatestRoomByCode error:",j.message||j),null):w};E.useEffect(()=>{if(!r)return;let g=!1;return(async()=>{let w=await _(o);if(!w){const j={code:o,state:{},version:0,host_id:e||null},{data:R,error:C}=await We.from("rooms").insert(j).select("id, code, host_id, state, version, updated_at").maybeSingle();if(C){console.warn("[NET] rooms/create:",C.message||C);return}if(g)return;R?w=R:w=await _(o)}g||(w&&(y.current=w.id,b.current=w.updated_at,u(w.state||{}),d(w.version??0)),i(!0))})(),()=>{g=!0}},[r,o,e]),E.useEffect(()=>{if(!r)return;const g=We.channel(`rooms:${o}`).on("postgres_changes",{event:"*",schema:"public",table:"rooms",filter:`code=eq.${o}`},w=>{const j=w.new||w.old||{};typeof j.version=="number"&&j.version>f.current&&(d(j.version),j.state&&u(j.state),j.updated_at&&(b.current=j.updated_at),j.id&&(y.current=j.id),x.current=Date.now(),console.log("[NET]  applied remote v=%d (realtime)",j.version))}).subscribe();return()=>{try{We.removeChannel(g)}catch{}}},[r,o]),E.useEffect(()=>{if(!r)return;const g=setInterval(async()=>{if(Date.now()-(x.current||0)<2e3)return;const w=await _(o);w&&w.version>f.current&&(d(w.version),u(w.state||{}),w.updated_at&&(b.current=w.updated_at),w.id&&(y.current=w.id))},700);return()=>clearInterval(g)},[r,o]);const p=async g=>{var C,S;if(!r||!s)return;const w=3,j=new Date().toISOString();for(let A=1;A<=w;A++){let v=await _(o);if(!v){const nt={code:o,state:{},version:0,host_id:e||null},{data:F,error:ue}=await We.from("rooms").insert(nt).select("id, code, host_id, state, version, updated_at").maybeSingle();if(ue){if(console.warn(`[NET] commit - insert failed (attempt ${A}/${w}):`,ue.message||ue),A<w){await new Promise(ae=>setTimeout(ae,50*A));continue}return}if(F)v=F,y.current=v.id,b.current=v.updated_at;else if(v=await _(o),!v){if(console.warn(`[NET] commit - no row after insert (attempt ${A}/${w})`),A<w){await new Promise(ae=>setTimeout(ae,50*A));continue}return}}v.id&&(y.current=v.id);let D=v.state||{},O=typeof g=="function"?g(D)||{}:g||{};const M=y.current||v.id;if(!M){if(console.warn("[NET] commit - no target ID available"),A<w){await new Promise(nt=>setTimeout(nt,50*A));continue}return}const{data:te,error:ne}=await We.from("rooms").update({state:O,version:(v.version||0)+1,updated_at:j}).eq("id",M).eq("version",v.version).select("state, version, updated_at").maybeSingle();if(!ne&&te){u(te.state||{}),d(te.version??(v.version||0)+1),te.updated_at&&(b.current=te.updated_at),A>1&&console.log(`[NET] commit succeeded on attempt ${A}/${w}`);return}if(((ne==null?void 0:ne.code)==="PGRST116"||((C=ne==null?void 0:ne.message)==null?void 0:C.includes("0 rows"))||((S=ne==null?void 0:ne.message)==null?void 0:S.includes("Cannot coerce"))||(ne==null?void 0:ne.code)==="23505"||(ne==null?void 0:ne.message)&&ne.message.includes("version")||!te)&&A<w){console.warn(`[NET] commit conflict (attempt ${A}/${w}):`,(ne==null?void 0:ne.message)||ne||"no rows updated","- retrying with fresh state...");const nt=await _(o);nt&&(v=nt,y.current=nt.id,b.current=nt.updated_at,D=nt.state||{},O=typeof g=="function"?g(D)||{}:g||{}),await new Promise(F=>setTimeout(F,50*A));continue}console.warn(`[NET] commit conflict (attempt ${A}/${w}):`,(ne==null?void 0:ne.message)||ne||"no rows updated")}const R=await _(o);R?(u(R.state||{}),d(R.version??0),R.updated_at&&(b.current=R.updated_at),R.id&&(y.current=R.id),console.warn("[NET] commit failed after retries, resynced to latest state")):console.warn("[NET] commit fallback resync failed: no row found")},m=E.useMemo(()=>({enabled:r,ready:s,state:l,version:c,commit:p}),[r,s,l,c]);return a.jsx(dm.Provider,{value:m,children:n})}function ib(){var Ue,Fe,J,Ne;const[t,e]=E.useState("start"),[n,r]=E.useState(null),o=E.useMemo(()=>Ys(),[]),s=E.useMemo(()=>co(""),[]),[i,l]=E.useState(o);E.useMemo(()=>Object.freeze({mixProdutos:"D",erpLevel:"D",clients:1,vendedoresComuns:1}),[]);const u=(N={})=>({...N,mixProdutos:N.mixProdutos??"D",erpLevel:N.erpLevel??"D",clients:N.clients??1,vendedoresComuns:N.vendedoresComuns??1}),c=N=>{if(!Array.isArray(N)||N.length===0)return N;const I=[...N].filter(Boolean);let xe=I.every(z=>Number.isInteger(z.seat))?I.sort((z,V)=>z.seat-V.seat):I.sort((z,V)=>String((z==null?void 0:z.id)??(z==null?void 0:z.player_id)??"").localeCompare(String((V==null?void 0:V.id)??(V==null?void 0:V.player_id)??""))),L=0;const $=new Set(xe.filter(z=>Number.isInteger(z.seat)).map(z=>z.seat));return xe=xe.map(z=>{if(Number.isInteger(z.seat))return z;for(;$.has(L);)L++;return $.add(L),{...z,seat:L++}}),xe=xe.sort((z,V)=>z.seat-V.seat),console.log("[App] normalizePlayers - ordenados:",xe.map(z=>({id:z.id,name:z.name,seat:z.seat}))),xe},[d,h]=E.useState([u({id:o,name:s||"Jogador",cash:18e3,pos:0,color:"#ffd54f",bens:4e3})]),[f,x]=E.useState(1),[y,b]=E.useState(0),[_,p]=E.useState(null),[m,g]=E.useState(new Array(1).fill(!1)),[w,j]=E.useState(!1),[R,C]=E.useState(null),[S,A]=E.useState({id:o,name:((Ue=d[0])==null?void 0:Ue.name)||"Jogador",color:((Fe=d[0])==null?void 0:Fe.color)||"#6c5ce7",cash:((J=d[0])==null?void 0:J.cash)??18e3,possibAt:0,clientsAt:0,matchId:"local"}),[v,D]=E.useState(["Bem-vindo ao Sales Game!"]),O=N=>D(I=>[N,...I].slice(0,12)),[M,te]=E.useState(!1),[ne,ut]=E.useState(null),nt=E.useRef(null),F=E.useRef(null),ue=E.useRef(0),ae=ge.useCallback(N=>!!N&&String(N.id)===String(i),[i]),Oe=E.useMemo(()=>{var N;return((N=d.find(ae))==null?void 0:N.cash)??0},[d,ae]);E.useEffect(()=>{var N;try{const I=new URL(window.location.href),oe=I.searchParams.get("room"),xe=localStorage.getItem("sg:lastRoomName"),L=oe||xe;if(xe&&!oe&&localStorage.removeItem("sg:lastRoomName"),L&&oe){r(L),(N=window.__setRoomCode)==null||N.call(window,L);try{I.searchParams.set("room",String(L)),history.replaceState(null,"",I.toString())}catch{}e("playersLobby")}else s&&s.trim()!==""&&e("lobbies")}catch{}},[s]);const je=E.useMemo(()=>`sg-sync:${n||"local"}`,[n]);E.useEffect(()=>{var N,I;try{(I=(N=nt.current)==null?void 0:N.close)==null||I.call(N);const oe=new BroadcastChannel(je);return oe.onmessage=xe=>{var $,z,V,_e,le,ke;const L=xe.data||{};if(String(L.source)!==String(o)){if(L.type==="START"){const Ze=Array.isArray(L.players)?L.players.map(u):[];if(!Ze.length)return;const mt=c(Ze);try{const be=window.__MY_UID||window.__myUid||window.__playerId||null;be&&l(String(be))}catch{}h(mt),b(0);const st=($=mt[0])!=null&&$.id?String(mt[0].id):null;p(st),x(1),g(new Array(Math.max(1,mt.length)).fill(!1)),j(!1),C(null),e("game"),D(["Jogo iniciado!"]);return}if(L.type==="TURNLOCK"){te(!!L.value);return}if(L.type==="SYNC"&&t==="game"){if(we!=null&&we.enabled&&(we!=null&&we.ready)&&Y){console.log("[App] SYNC ignorado - netState ativo, usando Supabase como autoridade nica");return}const Ze=Number(L.version||0),mt=Number(L.timestamp||0),st=ct.current;if(console.log("[App] SYNC recebido - verso remota:",Ze,"verso local:",st,"turnIdx:",L.turnIdx,"round:",L.round,"source:",L.source),console.log("[App] SYNC - meu turnIdx atual:",y,"meu myUid:",i),Ze>0&&st>0&&Ze<st){console.log("[App] SYNC -  REJEITANDO estado remoto - verso antiga:",Ze,"< verso local:",st);return}const be=Date.now(),Mt=De.current;if(Ze>st&&(ct.current=Ze,console.log("[App] SYNC -  Aceitando verso remota:",Ze,"> verso local:",st)),L.turnIdx!==y&&(!(we!=null&&we.enabled)||!(we!=null&&we.ready)))if(L.turnPlayerId!==void 0&&L.turnPlayerId!==null){p(L.turnPlayerId);const X=c(L.players||d).findIndex(bt=>String(bt.id)===String(L.turnPlayerId));X>=0&&(b(X),console.log("[App] SYNC (BC) - turnIdx derivado de turnPlayerId:",X,"turnPlayerId:",L.turnPlayerId))}else L.turnIdx>=0&&L.turnIdx<(((z=L.players)==null?void 0:z.length)||d.length)&&(b(L.turnIdx),console.log("[App] SYNC (BC) - Sincronizando turnIdx",{local:y,remote:L.turnIdx}));if(Array.isArray(L.roundFlags)&&L.roundFlags.length>0&&g(Q=>{const X=L.roundFlags.map((bt,At)=>Q[At]||!1||bt);for(;X.length<Q.length;)X.push(Q[X.length]||!1);return console.log("[App] SYNC - roundFlags sincronizado:",X.map((bt,At)=>{var Nn;return`${(Nn=d[At])==null?void 0:Nn.name}:${bt}`}).join(", ")),X}),L.round!==f)if(Mt&&be-Mt.timestamp<3e3){const Q=Mt.round!==f;x(Q?X=>{const bt=Math.max(X,L.round);return bt>X&&console.log("[App] SYNC - Rodada incrementada via sincronizao:",X,"->",bt),bt}:L.round)}else x(Q=>Math.max(Q,L.round));const an=d,Jt=L.players.map(Q=>{const X=an.find(At=>At.id===Q.id);if(!X)return Q;if(String(Q.id)===String(i)){const At=Number(X.clients||0),Nn=Number(Q.clients||0),Yn=Number(X.vendedoresComuns||0),ln=Number(Q.vendedoresComuns||0),Qn=Number(X.fieldSales||0),it=Number(Q.fieldSales||0),Ot=Number(X.insideSales||0),un=Number(Q.insideSales||0);return At>Nn||Yn>ln||Qn>it||Ot>un||X.mixProdutos&&X.mixProdutos!==Q.mixProdutos&&X.mixProdutos!=="D"||X.erpLevel&&X.erpLevel!==Q.erpLevel&&X.erpLevel!=="D"?(console.log("[App] SYNC - Detectadas compras locais, preservando estado local completo",{localClients:At,remoteClients:Nn,localVendedores:Yn,remoteVendedores:ln}),{...X,pos:Q.pos,bankrupt:Q.bankrupt??X.bankrupt,az:X.az||Q.az||0,am:X.am||Q.am||0,rox:X.rox||Q.rox||0,trainingsByVendor:X.trainingsByVendor||Q.trainingsByVendor||{},onboarding:X.onboarding||Q.onboarding||!1}):{...Q,cash:Math.max(Number(X.cash||0),Number(Q.cash||0)),clients:Math.max(At,Nn),mixProdutos:X.mixProdutos??Q.mixProdutos,erpLevel:X.erpLevel??Q.erpLevel,vendedoresComuns:Math.max(Yn,ln),fieldSales:Math.max(Qn,it),insideSales:Math.max(Ot,un),gestores:Math.max(Number(X.gestores??X.gestoresComerciais??X.managers??0),Number(Q.gestores??Q.gestoresComerciais??Q.managers??0)),gestoresComerciais:Math.max(Number(X.gestoresComerciais??X.gestores??X.managers??0),Number(Q.gestoresComerciais??Q.gestores??Q.managers??0)),managers:Math.max(Number(X.managers??X.gestores??X.gestoresComerciais??0),Number(Q.managers??Q.gestores??Q.gestoresComerciais??0)),bens:Math.max(Number(X.bens||0),Number(Q.bens||0)),manutencao:X.manutencao??Q.manutencao,loanPending:X.loanPending??Q.loanPending,az:X.az||Q.az||0,am:X.am||Q.am||0,rox:X.rox||Q.rox||0,trainingsByVendor:X.trainingsByVendor||Q.trainingsByVendor||{},onboarding:X.onboarding||Q.onboarding||!1}}return{...Q,az:X.az||Q.az||0,am:X.am||Q.am||0,rox:X.rox||Q.rox||0,trainingsByVendor:X.trainingsByVendor||Q.trainingsByVendor||{},onboarding:X.onboarding||Q.onboarding||!1}});h(Jt),console.log("[App] SYNC aplicado - novo turnIdx:",L.turnIdx),console.log("[App] SYNC - jogador da vez:",(V=Jt[L.turnIdx])==null?void 0:V.name,"id:",(_e=Jt[L.turnIdx])==null?void 0:_e.id),console.log("[App] SYNC -  minha vez?",String((le=Jt[L.turnIdx])==null?void 0:le.id)===String(i)),j(Q=>Q||!!L.gameOver),C(Q=>(w||L.gameOver)&&Q&&!L.winner?Q:L.winner??Q),L.gameOver===!0&&console.log(`[App] [ENDGAME] estado remoto aplicado: gameOver=true winner=${((ke=L.winner)==null?void 0:ke.name)??L.winner??"N/A"}`)}}},nt.current=oe,()=>oe.close()}catch(oe){console.warn("[App] BroadcastChannel init failed:",oe)}},[je,o,t]),E.useEffect(()=>{const N=async()=>{if(console.log(`[App] handleLeaveRoom chamado - fase: ${t}, currentLobbyId: ${n}, myUid: ${i}`),(t==="lobbies"||t==="playersLobby"||t==="game")&&n&&i)try{console.log(`[App] Saindo da sala ${n} na fase ${t}`),await Sl({roomCode:n,playerId:i})}catch(xe){console.warn("[App] Erro ao sair da sala:",xe)}else console.log("[App] No executando leaveRoom - condies no atendidas")},I=()=>{N()},oe=()=>{N()};return window.addEventListener("beforeunload",I),window.addEventListener("pagehide",oe),()=>{window.removeEventListener("beforeunload",I),window.removeEventListener("pagehide",oe)}},[t,n,i]);const re=N=>{var oe,xe;const I=!!N;te(I);try{(xe=(oe=nt.current)==null?void 0:oe.postMessage)==null||xe.call(oe,{type:"TURNLOCK",value:I,source:o})}catch{}},we=ob(),wn=we==null?void 0:we.commit,Et=we==null?void 0:we.version,Y=we==null?void 0:we.state,br=E.useMemo(()=>{if(y<0||y>=d.length)return console.warn("[App] isMyTurn - turnIdx invlido:",y,"players.length:",d.length),!1;const N=d[y];if(!N)return console.log("[App] isMyTurn - owner no encontrado, turnIdx:",y,"players.length:",d.length),!1;if(N.bankrupt)return console.log("[App] isMyTurn - owner est falido:",N.name),!1;const I=N.id!=null&&String(N.id)===String(i);return console.log("[App] isMyTurn - owner:",N.name,"id:",N.id,"myUid:",i,"isMine:",I),I},[y,d,i]);ge.useRef(null);const De=ge.useRef(null),Bn=ge.useRef(0),ct=ge.useRef(0),go=ge.useRef(0),sn=ge.useRef(null),Fa=ge.useCallback(({playersDeltaById:N={},statePatch:I={}})=>{if(typeof wn!="function")return;Bn.current=Bn.current+1;const oe=Bn.current,xe=Date.now();try{wn(L=>{const $=L||{},z=c($.players||[]),V=new Map(z.map(Ze=>[String(Ze.id),Ze]));for(const[Ze,mt]of Object.entries(N)){const st=String(Ze),be=V.get(st);be?V.set(st,u({...be,...mt})):V.set(st,u({id:st,...mt}))}const _e=c(Array.from(V.values())),le={...I,stateVersion:oe,updatedAt:xe,updatedBy:i};Object.keys(N).length>0&&(le.players=_e);const ke={...$,...le};return ke.players&&(ke.players=c(ke.players)),console.log("[NET]  commitGamePatch - tipo:",I.turnPlayerId?"TURN":I.round?"ROUND":"PLAYER_DELTA","playersDeltaIds:",Object.keys(N).join(","),"statePatchKeys:",Object.keys(I).join(","),"netVersion ser incrementado pelo commit"),ke})}catch(L){console.warn("[NET] commitGamePatch failed:",(L==null?void 0:L.message)||L)}},[wn,i]);ge.useEffect(()=>{const N=De.current,I=!N||N.turnIdx!==y,oe=!N||N.round!==f,xe=!N||JSON.stringify(N.players)!==JSON.stringify(d);if(I||oe||xe){const L=Date.now();(N?L-N.timestamp:1/0)>100?(De.current={players:d,turnIdx:y,round:f,timestamp:L},I&&console.log("[App] lastLocalStateRef atualizado via useEffect - turnIdx mudou:",N==null?void 0:N.turnIdx,"->",y)):De.current={...De.current,players:d,turnIdx:y,round:f}}},[d,y,f]),E.useEffect(()=>{var xe;if(!(we!=null&&we.enabled)||!(we!=null&&we.ready)||!Y)return;if(typeof Et=="number"){if(Et<=go.current){console.log("[NET]  IGNORADO - netVersion no avanou:",{netVersion:Et,lastApplied:go.current});return}go.current=Et}else return;const N=Array.isArray(Y.players)?Y.players:null,I=Number.isInteger(Y.turnIdx)?Y.turnIdx:null,oe=Number.isInteger(Y.round)?Y.round:null;if(Y.turnPlayerId!==void 0&&Y.turnPlayerId!==null){p(Y.turnPlayerId);const $=c(N||d).findIndex(z=>String(z.id)===String(Y.turnPlayerId));$>=0?$!==y&&(console.log("[NET]  turnIdx derivado de turnPlayerId:",$,"turnPlayerId:",Y.turnPlayerId),b($)):console.warn("[NET]  turnPlayerId no encontrado em players:",Y.turnPlayerId)}else I!==null&&b(I);if(N){const L=c(N);h(L),sn.current=JSON.parse(JSON.stringify(L)),console.log("[NET]  Aplicado players (snapshot autoritativo) - netVersion:",Et,"playersOrdered:",L.map($=>({id:$.id,seat:$.seat})))}if(oe!==null){const L=oe===1&&(I===0||I===null)&&Array.isArray(N)&&N.length>0&&N.every($=>Number(($==null?void 0:$.pos)??0)===0)&&(Y.gameOver===!1||Y.gameOver==null);x($=>L?1:Math.max($,oe))}if(Y.roundFlags!==void 0){if(Array.isArray(Y.roundFlags))g(Y.roundFlags),console.log("[NET] applied remote includes roundFlags?",!0,"length:",Y.roundFlags.length);else if(typeof Y.roundFlags=="object"){const L=Object.values(Y.roundFlags);g(L),console.log("[NET] applied remote includes roundFlags?",!0,"converted from object, length:",L.length)}}if(typeof Y.turnLock=="boolean"&&(te(Y.turnLock),Y.turnLock&&!F.current?F.current=Date.now():Y.turnLock||(F.current=null),Y.turnLock&&Y.lockOwner&&console.log("[LOCK] bloqueado: turnLockBroadcast=true lockOwner=",Y.lockOwner,"myId=",i)),Y.lockOwner!==void 0&&(ut(Y.lockOwner),De.current&&(De.current.lockOwner=Y.lockOwner),console.log("[NET] applied remote includes lockOwner?",!0,"value:",Y.lockOwner)),Y.roundFlags!==void 0){if(Array.isArray(Y.roundFlags))g(Y.roundFlags),console.log("[NET] applied remote includes roundFlags?",!0,"length:",Y.roundFlags.length);else if(typeof Y.roundFlags=="object"){const L=Object.values(Y.roundFlags);g(L),console.log("[NET] applied remote includes roundFlags?",!0,"converted from object, length:",L.length)}}if(typeof Y.turnLock=="boolean"&&(te(Y.turnLock),Y.turnLock&&!F.current?F.current=Date.now():Y.turnLock||(F.current=null),Y.turnLock&&Y.lockOwner&&console.log("[LOCK] bloqueado: turnLockBroadcast=true lockOwner=",Y.lockOwner,"myId=",i)),Y.lockOwner!==void 0&&(ut(Y.lockOwner),De.current&&(De.current.lockOwner=Y.lockOwner),console.log("[NET] applied remote includes lockOwner?",!0,"value:",Y.lockOwner)),ue.current=Date.now(),oe!==null){const L=oe===1&&(I===0||I===null)&&Array.isArray(N)&&N.length>0&&N.every($=>Number(($==null?void 0:$.pos)??0)===0)&&(Y.gameOver===!1||Y.gameOver==null);x($=>L?1:Math.max($,oe))}j(L=>L||!!Y.gameOver),C(L=>(w||Y.gameOver)&&L&&!Y.winner?L:Y.winner??L),Y.gameOver===!0&&console.log(`[App] [ENDGAME] estado remoto aplicado: gameOver=true winner=${((xe=Y.winner)==null?void 0:xe.name)??Y.winner??"N/A"}`),console.log("[NET]  applied remote snapshot - netVersion:",Et,"turnPlayerId:",Y.turnPlayerId,"turnIdx:",I,"round:",oe)},[Et,Y,we==null?void 0:we.enabled,we==null?void 0:we.ready]),E.useEffect(()=>{if(!M){F.current=null;return}F.current||(F.current=Date.now());const N=setInterval(()=>{const I=Date.now(),oe=F.current?I-F.current:0,xe=d[y],L=xe&&String(xe.id)===String(i),$=br&&L,z=ne===i;oe>8e3&&$&&!z&&ne!=null&&(console.warn("[LOCK-WATCHDOG] stole lock - turnLock travado por",oe,"ms, liberando...",{isMyTurn:$,lockOwner:ne,myUid:i}),St({turnLock:!1,lockOwner:i}),re(!1),ut(i),F.current=null)},1e3);return()=>clearInterval(N)},[M,br,y,d,ne,i,wn]);async function St(N){if(typeof wn=="function")try{await wn(I=>{const oe=I||{},xe=N||{};if(xe.players&&Array.isArray(xe.players)){const L=sn.current||oe.players||[],$=oe.players||[],z=xe.players,V=new Map(L.map(be=>[String(be==null?void 0:be.id),be])),_e=new Map($.map(be=>[String(be==null?void 0:be.id),be])),le=new Map(z.map(be=>[String(be==null?void 0:be.id),be])),ke=[],Ze=new Set([...V.keys(),..._e.keys(),...le.keys()]);for(const be of Ze){const Mt=V.get(be),an=_e.get(be),Jt=le.get(be);Mt&&Jt&&JSON.stringify(Mt)!==JSON.stringify(Jt)&&Jt?ke.push(u(Jt)):an?ke.push(u(an)):Jt&&ke.push(u(Jt))}const mt=[],st=z.map(be=>String(be==null?void 0:be.id));for(const be of st){const Mt=ke.find(an=>String(an==null?void 0:an.id)===be);Mt&&mt.push(Mt)}for(const be of ke)st.includes(String(be==null?void 0:be.id))||mt.push(be);return sn.current=null,{...oe,...xe,players:mt.length>0?mt:z}}return{...oe,...xe}})}catch(I){console.warn("[NET] commit failed:",(I==null?void 0:I.message)||I),sn.current=null}}function K(N,I,oe,xe=w,L=R,$={}){var Yn,ln,Qn,it,Ot,un,cn;sn.current||(sn.current=JSON.parse(JSON.stringify(d)),console.log("[App] broadcastState - baseline capturado (estado atual antes da mudana):",sn.current.length,"players")),Bn.current=Bn.current+1;const z=Bn.current,V=$.roundFlags!==void 0?$.roundFlags:m,_e=$.turnLock!==void 0?$.turnLock:M,le=((Yn=De.current)==null?void 0:Yn.lockOwner)??null,ke=$.lockOwner!==void 0?$.lockOwner:le,Ze=$.gameOver!==void 0?$.gameOver:xe,st=!!w||!!((ln=De.current)!=null&&ln.gameOver)?!0:!!Ze,be=$.winner!==void 0?$.winner:L,Mt=R??((Qn=De.current)==null?void 0:Qn.winner)??null,an=st?be??Mt:be,Jt=$.round!==void 0?$.round:oe,Q=Math.max(Number(Jt||1),Number(f||1),Number(((it=De.current)==null?void 0:it.round)||1));sn.current||(sn.current=JSON.parse(JSON.stringify(d)),console.log("[App] broadcastState - baseline capturado (fallback):",sn.current.length,"players"));const X=c(N),bt=$.turnPlayerId!==void 0?$.turnPlayerId:(Ot=X[I])!=null&&Ot.id?String(X[I].id):_,At=Date.now();if(De.current={players:X,turnIdx:I,turnPlayerId:bt,round:Q,gameOver:st,winner:an,lockOwner:ke,timestamp:At,version:z,stateVersion:z,updatedAt:At,updatedBy:i},ct.current=z,$.isStartGame===!0||Q===1&&I===0&&X.every(k=>Number((k==null?void 0:k.pos)??0)===0))console.log("[App] broadcastState (START) - verso:",z,"turnPlayerId:",bt,"round:",Q),St({players:X,turnIdx:I,turnPlayerId:bt,round:Q,roundFlags:V,stateVersion:z,updatedAt:At,updatedBy:i});else{const k={},B=new Map(d.map(q=>[String(q.id),q]));for(const q of X){const H=String(q.id),pe=B.get(H);if(!pe)k[H]=q;else{const he={},G=["pos","cash","bankrupt","clients","vendedoresComuns","fieldSales","insideSales","gestores","gestoresComerciais","manutencao","bens","mixProdutos","erpLevel","az","am","rox","onboarding","trainingByVendor","trainingsByVendor","loanPending","waitingAtRevenue","revenue","erpOwned","erp"];for(const Z of G)JSON.stringify(pe[Z])!==JSON.stringify(q[Z])&&(he[Z]=q[Z]);Object.keys(he).length>0&&(k[H]=he)}}Fa({playersDeltaById:k,statePatch:{turnPlayerId:bt,turnIdx:I,round:Q,roundFlags:V,turnLock:_e,lockOwner:ke,gameOver:st,winner:an}}),console.log("[App] broadcastState (PATCH) - tipo:",bt&&bt!==_?"TURN":"PLAYER_DELTA","playersDeltaIds:",Object.keys(k).join(","),"turnPlayerId:",bt,"round:",Q)}try{(cn=(un=nt.current)==null?void 0:un.postMessage)==null||cn.call(un,{type:"SYNC",version:z,players:X,turnIdx:I,round:Q,roundFlags:V,turnLock:_e,lockOwner:ke,gameOver:st,winner:an,source:o,timestamp:At})}catch(k){console.warn("[App] broadcastState failed:",k)}}function Te(N){var xe,L,$;const I=c(N),oe=(xe=I[0])!=null&&xe.id?String(I[0].id):null;K(I,0,1,!1,null,{turnPlayerId:oe,roundFlags:Array(N.length).fill(!1),isStartGame:!0});try{($=(L=nt.current)==null?void 0:L.postMessage)==null||$.call(L,{type:"START",players:N,source:o})}catch(z){console.warn("[App] broadcastStart failed:",z)}}const Ve=d[y];E.useEffect(()=>{t==="game"&&Vx(d,y,f,w,R,"Game State Update")},[d,y,f,w,R,t]),E.useEffect(()=>{const N=d.find(ae);if(!N)return;const{cap:I,inAtt:oe}=ga(N);A(xe=>({...xe,cash:N.cash,possibAt:I,clientsAt:oe,name:N.name,color:N.color}))},[d,ae]);const Ce=E.useMemo(()=>{const N=d.find(ae)||d[0]||{},I=Ba(N),oe=Ua(N),{cap:xe,inAtt:L}=ga(N),$=String(N.erpLevel||"D").toUpperCase(),z=Number(N.gestores??N.gestoresComerciais??N.managers??0);return console.log("[App] Totals recalculado - me:",N.name,"clients:",N.clients,"faturamento:",I,"manutencao:",oe,"vendedoresComuns:",N.vendedoresComuns,"fieldSales:",N.fieldSales,"insideSales:",N.insideSales),Gx(N,"HUD Totals"),{faturamento:I,manutencao:oe,emprestimos:N.loanPending&&!N.loanPending.charged?Number(N.loanPending.amount||0):0,vendedoresComuns:N.vendedoresComuns||0,fieldSales:N.fieldSales||0,insideSales:N.insideSales||0,mixProdutos:N.mixProdutos||"D",bens:N.bens??0,erpSistemas:$,clientes:N.clients||0,onboarding:!!N.onboarding,az:N.az||0,am:N.am||0,rox:N.rox||0,gestores:z,gestoresComerciais:z,possibAt:xe,clientsAt:L}},[d,ae]),[Dt,P]=E.useState(!1),{onAction:Pe,modalLocks:Me}=rb({players:d,setPlayers:h,round:f,setRound:x,turnIdx:y,setTurnIdx:b,roundFlags:m,setRoundFlags:g,isMyTurn:br,isMine:ae,myUid:i,meId:o,myCash:Oe,current:Ve,broadcastState:K,appendLog:O,turnLock:M,setTurnLockBroadcast:re,gameOver:w,setGameOver:j,winner:R,setWinner:C,setShowBankruptOverlay:P});if(t==="start")return a.jsx(cx,{onEnter:N=>{const I=co(N||"Jogador");h([u({id:o,name:I,cash:18e3,pos:0,color:"#ffd54f",bens:4e3})]),x(1),b(0),j(!1),C(null),g(new Array(1).fill(!1)),e("lobbies"),A(oe=>({...oe,name:I})),D([`Bem-vindo, ${I}!`])}});if(t==="lobbies")return a.jsx(wx,{onEnterRoom:N=>{var I;r(N),(I=window.__setRoomCode)==null||I.call(window,N);try{localStorage.setItem("sg:lastRoomName",String(N));const oe=new URL(window.location.href);oe.searchParams.set("room",String(N)),history.replaceState(null,"",oe.toString())}catch{}e("playersLobby")}});if(t==="playersLobby")return a.jsx(Sx,{lobbyId:n,onBack:()=>{var N;(N=window.__setRoomCode)==null||N.call(window,null),e("lobbies")},onStartGame:N=>{var z;const I=(N==null?void 0:N.lobbyName)||((z=N==null?void 0:N.lobby)==null?void 0:z.name)||(N==null?void 0:N.name)||n||"sala-demo";try{localStorage.setItem("sg:lastRoomName",String(I));const V=new URL(window.location.href);if(V.searchParams.set("room",String(I)),history.replaceState(null,"",V.toString()),!sessionStorage.getItem("sg:room-reloaded")){sessionStorage.setItem("sg:room-reloaded","1"),location.reload();return}}catch{}const L=[...Array.isArray(N)?N:(N==null?void 0:N.players)??(N==null?void 0:N.lobbyPlayers)??[]].sort((V,_e)=>{const le=V.created_at||V.joined_at||V.createdAt||V.joinedAt,ke=_e.created_at||_e.joined_at||_e.createdAt||_e.joinedAt;if(le&&ke)return new Date(le)-new Date(ke);const Ze=String(V.id??V.player_id??""),mt=String(_e.id??_e.player_id??"");return Ze.localeCompare(mt)}).map((V,_e)=>u({id:String(V.id??V.player_id),name:V.name??V.player_name,cash:18e3,pos:0,bens:4e3,color:["#ffd54f","#90caf9","#a5d6a7","#ffab91"][_e%4],seat:_e}));if(L.length===0)return;const $=c(L);try{const V=$.find(_e=>String(_e.name||"").trim().toLowerCase()===String(s||"").trim().toLowerCase());V!=null&&V.id&&l(String(V.id))}catch{}h($),b(0),x(1),g(new Array($.length).fill(!1)),j(!1),C(null),A(V=>{var le,ke;const _e=$.find(ae);return{...V,name:(_e==null?void 0:_e.name)||((le=$[0])==null?void 0:le.name)||"Jogador",color:(_e==null?void 0:_e.color)||((ke=$[0])==null?void 0:ke.color)||"#6c5ce7",cash:(_e==null?void 0:_e.cash)??18e3,possibAt:0,clientsAt:0}}),D(["Jogo iniciado!"]),Te($),e("game")}});const Wt=d[y],It=(Wt==null?void 0:Wt.bankrupt)===!0;Wt&&(String(Wt.id),String(i));const W=_!=null&&String(_)===String(i),fe=f===5&&((Ne=d[y])==null?void 0:Ne.waitingAtRevenue),Re=ne==null||ne===i,ve=W&&Me===0&&!M&&Re&&!It&&!w&&!fe;return console.log("[App] controlsCanRoll - turnPlayerId:",_,"myUid:",i,"isMyTurnFromId:",W,"modalLocks:",Me,"turnLock:",M,"lockOwner:",ne,"lockOwnerOk:",Re,"isBankrupt:",It,"gameOver:",w,"isWaitingRevenue:",fe,"result:",ve),a.jsxs("div",{className:"page",children:[a.jsxs("header",{className:"topbar",children:[a.jsxs("div",{className:"status",style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[a.jsx("span",{style:{width:18,height:18,borderRadius:"50%",border:"2px solid rgba(255,255,255,.9)",boxShadow:"0 0 0 2px rgba(0,0,0,.25)",background:S.color}}),a.jsxs("span",{style:{background:"#1f2430",border:"1px solid rgba(255,255,255,.12)",borderRadius:10,padding:"4px 10px",fontWeight:800},children:[" ",S.name]}),a.jsxs("span",{children:["Possib. Atendimento: ",a.jsx("b",{children:S.possibAt??0})]}),a.jsxs("span",{children:["Clientes em Atendimento: ",a.jsx("b",{children:S.clientsAt??0})]}),a.jsx(Hx,{players:d,turnIdx:y,round:f,gameOver:w,winner:R})]}),a.jsxs("div",{className:"status",style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[a.jsxs("span",{children:["Rodada: ",f]}),a.jsxs("span",{className:"money",children:[" $ ",Number(Oe).toLocaleString()]})]})]}),a.jsxs("main",{className:"content",children:[a.jsx("div",{className:"boardWrap",children:a.jsx(Dx,{players:d,turnIdx:y,onMeHud:A})}),a.jsxs("aside",{className:"side",children:[a.jsx(Ax,{totals:Ce,players:d}),a.jsxs("div",{className:"controlsSticky",children:[a.jsx(Ox,{onAction:N=>{Pe(N)},current:Ve,isMyTurn:ve}),a.jsx("div",{style:{marginTop:10},children:a.jsx("button",{className:"btn dark",onClick:async()=>{var N;if(n&&i)try{await Sl({roomCode:n,playerId:i})}catch(I){console.warn("[App] Erro ao sair da sala:",I)}(N=window.__setRoomCode)==null||N.call(window,null),e("lobbies")},children:"Sair para Lobbies"})})]}),w&&a.jsx(Tx,{players:d,onExit:async()=>{var N;if(n&&i)try{await Sl({roomCode:n,playerId:i})}catch(I){console.warn("[App] Erro ao sair da sala:",I)}(N=window.__setRoomCode)==null||N.call(window,null),e("lobbies")},onRestart:()=>{const N=d.map(I=>u({...I,cash:18e3,bens:4e3,pos:0}));h(N),b(0),x(1),g(new Array(N.length).fill(!1)),D(["Novo jogo iniciado!"]),j(!1),C(null)}})]})]}),a.jsx("footer",{className:"foot",children:a.jsxs("small",{children:["Desenvolvido por ",a.jsx("a",{href:"https://www.tironitech.com",target:"_blank",rel:"noreferrer",children:"tironitech.com"})]})}),Dt&&a.jsx(Lx,{})]})}function ab(){const e=new URLSearchParams(window.location.search).get("room");return e&&String(e).trim()||null}function lb(){const[t,e]=ge.useState(ab());return ge.useEffect(()=>(window.__setRoomCode=n=>{const r=String(n||"").trim()||null;e(r);const o=new URL(window.location.href);r?o.searchParams.set("room",r):o.searchParams.delete("room"),window.history.replaceState({},"",o)},()=>{delete window.__setRoomCode}),[]),ge.useEffect(()=>(window.exportLogs=()=>{const n=cm(),r=new Blob([n.text],{type:"text/plain;charset=utf-8"}),o=URL.createObjectURL(r),s=document.createElement("a");return s.href=o,s.download=`debug-logs-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.txt`,s.click(),URL.revokeObjectURL(o),console.log(" Logs exportados! Arquivo .txt baixado."),n},window.getLogsText=()=>Fx(),window.getLogsJSON=()=>zx(),window.getLogStats=()=>Lu(),window.toggleLogCapture=()=>(rr.enabled?(rr.disable(),console.log(" Captura de logs DESATIVADA")):(rr.enable(),console.log(" Captura de logs ATIVADA")),rr.enabled),console.log("%c FUNES DE EXPORT DE LOGS DISPONVEIS:","color: #4CAF50; font-weight: bold; font-size: 14px"),console.log("%cexportLogs()","color: #2196F3; font-weight: bold","- Exporta logs completos (baixa arquivo .txt)"),console.log("%cgetLogsText()","color: #2196F3; font-weight: bold","- Retorna logs como string de texto"),console.log("%cgetLogsJSON()","color: #2196F3; font-weight: bold","- Retorna logs como objeto JSON"),console.log("%cgetLogStats()","color: #2196F3; font-weight: bold","- Retorna estatsticas dos logs"),console.log("%ctoggleLogCapture()","color: #2196F3; font-weight: bold","- Ativa/desativa captura de logs"),()=>{delete window.exportLogs,delete window.getLogsText,delete window.getLogsJSON,delete window.getLogStats,delete window.toggleLogCapture}),[]),a.jsx(Px,{children:a.jsx(sb,{roomCode:t,children:a.jsx(ib,{})})})}Cl.createRoot(document.getElementById("root")).render(a.jsx(ge.StrictMode,{children:a.jsx(lb,{})}));
//# sourceMappingURL=index-CdcMSO9r.js.map
