(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();var Pn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function fm(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function hm(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var o=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,o.get?o:{enumerable:!0,get:function(){return t[r]}})}),n}var _f={exports:{}},ga={},kf={exports:{}},Ie={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ys=Symbol.for("react.element"),pm=Symbol.for("react.portal"),mm=Symbol.for("react.fragment"),gm=Symbol.for("react.strict_mode"),ym=Symbol.for("react.profiler"),vm=Symbol.for("react.provider"),xm=Symbol.for("react.context"),bm=Symbol.for("react.forward_ref"),wm=Symbol.for("react.suspense"),Sm=Symbol.for("react.memo"),_m=Symbol.for("react.lazy"),Pc=Symbol.iterator;function km(t){return t===null||typeof t!="object"?null:(t=Pc&&t[Pc]||t["@@iterator"],typeof t=="function"?t:null)}var Ef={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},jf=Object.assign,Cf={};function Yo(t,e,n){this.props=t,this.context=e,this.refs=Cf,this.updater=n||Ef}Yo.prototype.isReactComponent={};Yo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Yo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Rf(){}Rf.prototype=Yo.prototype;function Lu(t,e,n){this.props=t,this.context=e,this.refs=Cf,this.updater=n||Ef}var $u=Lu.prototype=new Rf;$u.constructor=Lu;jf($u,Yo.prototype);$u.isPureReactComponent=!0;var Lc=Array.isArray,Nf=Object.prototype.hasOwnProperty,Iu={current:null},Df={key:!0,ref:!0,__self:!0,__source:!0};function Af(t,e,n){var r,o={},s=null,i=null;if(e!=null)for(r in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(s=""+e.key),e)Nf.call(e,r)&&!Df.hasOwnProperty(r)&&(o[r]=e[r]);var l=arguments.length-2;if(l===1)o.children=n;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];o.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)o[r]===void 0&&(o[r]=l[r]);return{$$typeof:Ys,type:t,key:s,ref:i,props:o,_owner:Iu.current}}function Em(t,e){return{$$typeof:Ys,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Mu(t){return typeof t=="object"&&t!==null&&t.$$typeof===Ys}function jm(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var $c=/\/+/g;function Fa(t,e){return typeof t=="object"&&t!==null&&t.key!=null?jm(""+t.key):e.toString(36)}function Ai(t,e,n,r,o){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case Ys:case pm:i=!0}}if(i)return i=t,o=o(i),t=r===""?"."+Fa(i,0):r,Lc(o)?(n="",t!=null&&(n=t.replace($c,"$&/")+"/"),Ai(o,e,n,"",function(c){return c})):o!=null&&(Mu(o)&&(o=Em(o,n+(!o.key||i&&i.key===o.key?"":(""+o.key).replace($c,"$&/")+"/")+t)),e.push(o)),1;if(i=0,r=r===""?".":r+":",Lc(t))for(var l=0;l<t.length;l++){s=t[l];var u=r+Fa(s,l);i+=Ai(s,e,n,u,o)}else if(u=km(t),typeof u=="function")for(t=u.call(t),l=0;!(s=t.next()).done;)s=s.value,u=r+Fa(s,l++),i+=Ai(s,e,n,u,o);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function si(t,e,n){if(t==null)return t;var r=[],o=0;return Ai(t,r,"","",function(s){return e.call(n,s,o++)}),r}function Cm(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var rn={current:null},Oi={transition:null},Rm={ReactCurrentDispatcher:rn,ReactCurrentBatchConfig:Oi,ReactCurrentOwner:Iu};function Of(){throw Error("act(...) is not supported in production builds of React.")}Ie.Children={map:si,forEach:function(t,e,n){si(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return si(t,function(){e++}),e},toArray:function(t){return si(t,function(e){return e})||[]},only:function(t){if(!Mu(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ie.Component=Yo;Ie.Fragment=mm;Ie.Profiler=ym;Ie.PureComponent=Lu;Ie.StrictMode=gm;Ie.Suspense=wm;Ie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Rm;Ie.act=Of;Ie.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=jf({},t.props),o=t.key,s=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,i=Iu.current),e.key!==void 0&&(o=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)Nf.call(e,u)&&!Df.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];r.children=l}return{$$typeof:Ys,type:t.type,key:o,ref:s,props:r,_owner:i}};Ie.createContext=function(t){return t={$$typeof:xm,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:vm,_context:t},t.Consumer=t};Ie.createElement=Af;Ie.createFactory=function(t){var e=Af.bind(null,t);return e.type=t,e};Ie.createRef=function(){return{current:null}};Ie.forwardRef=function(t){return{$$typeof:bm,render:t}};Ie.isValidElement=Mu;Ie.lazy=function(t){return{$$typeof:_m,_payload:{_status:-1,_result:t},_init:Cm}};Ie.memo=function(t,e){return{$$typeof:Sm,type:t,compare:e===void 0?null:e}};Ie.startTransition=function(t){var e=Oi.transition;Oi.transition={};try{t()}finally{Oi.transition=e}};Ie.unstable_act=Of;Ie.useCallback=function(t,e){return rn.current.useCallback(t,e)};Ie.useContext=function(t){return rn.current.useContext(t)};Ie.useDebugValue=function(){};Ie.useDeferredValue=function(t){return rn.current.useDeferredValue(t)};Ie.useEffect=function(t,e){return rn.current.useEffect(t,e)};Ie.useId=function(){return rn.current.useId()};Ie.useImperativeHandle=function(t,e,n){return rn.current.useImperativeHandle(t,e,n)};Ie.useInsertionEffect=function(t,e){return rn.current.useInsertionEffect(t,e)};Ie.useLayoutEffect=function(t,e){return rn.current.useLayoutEffect(t,e)};Ie.useMemo=function(t,e){return rn.current.useMemo(t,e)};Ie.useReducer=function(t,e,n){return rn.current.useReducer(t,e,n)};Ie.useRef=function(t){return rn.current.useRef(t)};Ie.useState=function(t){return rn.current.useState(t)};Ie.useSyncExternalStore=function(t,e,n){return rn.current.useSyncExternalStore(t,e,n)};Ie.useTransition=function(){return rn.current.useTransition()};Ie.version="18.3.1";kf.exports=Ie;var E=kf.exports;const ye=fm(E);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nm=E,Dm=Symbol.for("react.element"),Am=Symbol.for("react.fragment"),Om=Object.prototype.hasOwnProperty,Tm=Nm.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Pm={key:!0,ref:!0,__self:!0,__source:!0};function Tf(t,e,n){var r,o={},s=null,i=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(i=e.ref);for(r in e)Om.call(e,r)&&!Pm.hasOwnProperty(r)&&(o[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)o[r]===void 0&&(o[r]=e[r]);return{$$typeof:Dm,type:t,key:s,ref:i,props:o,_owner:Tm.current}}ga.Fragment=Am;ga.jsx=Tf;ga.jsxs=Tf;_f.exports=ga;var a=_f.exports,jl={},Pf={exports:{}},En={},Lf={exports:{}},$f={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(F,le){var ie=F.length;F.push(le);e:for(;0<ie;){var Pe=ie-1>>>1,_e=F[Pe];if(0<o(_e,le))F[Pe]=le,F[ie]=_e,ie=Pe;else break e}}function n(F){return F.length===0?null:F[0]}function r(F){if(F.length===0)return null;var le=F[0],ie=F.pop();if(ie!==le){F[0]=ie;e:for(var Pe=0,_e=F.length,re=_e>>>1;Pe<re;){var we=2*(Pe+1)-1,bn=F[we],Et=we+1,Y=F[Et];if(0>o(bn,ie))Et<_e&&0>o(Y,bn)?(F[Pe]=Y,F[Et]=ie,Pe=Et):(F[Pe]=bn,F[we]=ie,Pe=we);else if(Et<_e&&0>o(Y,ie))F[Pe]=Y,F[Et]=ie,Pe=Et;else break e}}return le}function o(F,le){var ie=F.sortIndex-le.sortIndex;return ie!==0?ie:F.id-le.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var i=Date,l=i.now();t.unstable_now=function(){return i.now()-l}}var u=[],c=[],d=1,h=null,f=3,x=!1,y=!1,b=!1,_=typeof setTimeout=="function"?setTimeout:null,p=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(F){for(var le=n(c);le!==null;){if(le.callback===null)r(c);else if(le.startTime<=F)r(c),le.sortIndex=le.expirationTime,e(u,le);else break;le=n(c)}}function w(F){if(b=!1,g(F),!y)if(n(u)!==null)y=!0,ct(j);else{var le=n(c);le!==null&&rt(w,le.startTime-F)}}function j(F,le){y=!1,b&&(b=!1,p(S),S=-1),x=!0;var ie=f;try{for(g(le),h=n(u);h!==null&&(!(h.expirationTime>le)||F&&!D());){var Pe=h.callback;if(typeof Pe=="function"){h.callback=null,f=h.priorityLevel;var _e=Pe(h.expirationTime<=le);le=t.unstable_now(),typeof _e=="function"?h.callback=_e:h===n(u)&&r(u),g(le)}else r(u);h=n(u)}if(h!==null)var re=!0;else{var we=n(c);we!==null&&rt(w,we.startTime-le),re=!1}return re}finally{h=null,f=ie,x=!1}}var R=!1,C=null,S=-1,A=5,v=-1;function D(){return!(t.unstable_now()-v<A)}function O(){if(C!==null){var F=t.unstable_now();v=F;var le=!0;try{le=C(!0,F)}finally{le?M():(R=!1,C=null)}}else R=!1}var M;if(typeof m=="function")M=function(){m(O)};else if(typeof MessageChannel<"u"){var te=new MessageChannel,ne=te.port2;te.port1.onmessage=O,M=function(){ne.postMessage(null)}}else M=function(){_(O,0)};function ct(F){C=F,R||(R=!0,M())}function rt(F,le){S=_(function(){F(t.unstable_now())},le)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(F){F.callback=null},t.unstable_continueExecution=function(){y||x||(y=!0,ct(j))},t.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<F?Math.floor(1e3/F):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(F){switch(f){case 1:case 2:case 3:var le=3;break;default:le=f}var ie=f;f=le;try{return F()}finally{f=ie}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(F,le){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var ie=f;f=F;try{return le()}finally{f=ie}},t.unstable_scheduleCallback=function(F,le,ie){var Pe=t.unstable_now();switch(typeof ie=="object"&&ie!==null?(ie=ie.delay,ie=typeof ie=="number"&&0<ie?Pe+ie:Pe):ie=Pe,F){case 1:var _e=-1;break;case 2:_e=250;break;case 5:_e=1073741823;break;case 4:_e=1e4;break;default:_e=5e3}return _e=ie+_e,F={id:d++,callback:le,priorityLevel:F,startTime:ie,expirationTime:_e,sortIndex:-1},ie>Pe?(F.sortIndex=ie,e(c,F),n(u)===null&&F===n(c)&&(b?(p(S),S=-1):b=!0,rt(w,ie-Pe))):(F.sortIndex=_e,e(u,F),y||x||(y=!0,ct(j))),F},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(F){var le=f;return function(){var ie=f;f=le;try{return F.apply(this,arguments)}finally{f=ie}}}})($f);Lf.exports=$f;var Lm=Lf.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $m=E,kn=Lm;function U(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var If=new Set,As={};function ho(t,e){zo(t,e),zo(t+"Capture",e)}function zo(t,e){for(As[t]=e,t=0;t<e.length;t++)If.add(e[t])}var pr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Cl=Object.prototype.hasOwnProperty,Im=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ic={},Mc={};function Mm(t){return Cl.call(Mc,t)?!0:Cl.call(Ic,t)?!1:Im.test(t)?Mc[t]=!0:(Ic[t]=!0,!1)}function Bm(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Um(t,e,n,r){if(e===null||typeof e>"u"||Bm(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function on(t,e,n,r,o,s,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=i}var zt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){zt[t]=new on(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];zt[e]=new on(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){zt[t]=new on(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){zt[t]=new on(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){zt[t]=new on(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){zt[t]=new on(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){zt[t]=new on(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){zt[t]=new on(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){zt[t]=new on(t,5,!1,t.toLowerCase(),null,!1,!1)});var Bu=/[\-:]([a-z])/g;function Uu(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Bu,Uu);zt[e]=new on(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Bu,Uu);zt[e]=new on(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Bu,Uu);zt[e]=new on(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){zt[t]=new on(t,1,!1,t.toLowerCase(),null,!1,!1)});zt.xlinkHref=new on("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){zt[t]=new on(t,1,!1,t.toLowerCase(),null,!0,!0)});function Fu(t,e,n,r){var o=zt.hasOwnProperty(e)?zt[e]:null;(o!==null?o.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Um(e,n,o,r)&&(n=null),r||o===null?Mm(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):o.mustUseProperty?t[o.propertyName]=n===null?o.type===3?!1:"":n:(e=o.attributeName,r=o.attributeNamespace,n===null?t.removeAttribute(e):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var xr=$m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ii=Symbol.for("react.element"),ko=Symbol.for("react.portal"),Eo=Symbol.for("react.fragment"),zu=Symbol.for("react.strict_mode"),Rl=Symbol.for("react.profiler"),Mf=Symbol.for("react.provider"),Bf=Symbol.for("react.context"),Wu=Symbol.for("react.forward_ref"),Nl=Symbol.for("react.suspense"),Dl=Symbol.for("react.suspense_list"),Vu=Symbol.for("react.memo"),Er=Symbol.for("react.lazy"),Uf=Symbol.for("react.offscreen"),Bc=Symbol.iterator;function ns(t){return t===null||typeof t!="object"?null:(t=Bc&&t[Bc]||t["@@iterator"],typeof t=="function"?t:null)}var mt=Object.assign,za;function fs(t){if(za===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);za=e&&e[1]||""}return`
`+za+t}var Wa=!1;function Va(t,e){if(!t||Wa)return"";Wa=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var o=c.stack.split(`
`),s=r.stack.split(`
`),i=o.length-1,l=s.length-1;1<=i&&0<=l&&o[i]!==s[l];)l--;for(;1<=i&&0<=l;i--,l--)if(o[i]!==s[l]){if(i!==1||l!==1)do if(i--,l--,0>l||o[i]!==s[l]){var u=`
`+o[i].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=i&&0<=l);break}}}finally{Wa=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?fs(t):""}function Fm(t){switch(t.tag){case 5:return fs(t.type);case 16:return fs("Lazy");case 13:return fs("Suspense");case 19:return fs("SuspenseList");case 0:case 2:case 15:return t=Va(t.type,!1),t;case 11:return t=Va(t.type.render,!1),t;case 1:return t=Va(t.type,!0),t;default:return""}}function Al(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Eo:return"Fragment";case ko:return"Portal";case Rl:return"Profiler";case zu:return"StrictMode";case Nl:return"Suspense";case Dl:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Bf:return(t.displayName||"Context")+".Consumer";case Mf:return(t._context.displayName||"Context")+".Provider";case Wu:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Vu:return e=t.displayName||null,e!==null?e:Al(t.type)||"Memo";case Er:e=t._payload,t=t._init;try{return Al(t(e))}catch{}}return null}function zm(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Al(e);case 8:return e===zu?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ur(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Ff(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Wm(t){var e=Ff(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return o.call(this)},set:function(i){r=""+i,s.call(this,i)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ai(t){t._valueTracker||(t._valueTracker=Wm(t))}function zf(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Ff(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Wi(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Ol(t,e){var n=e.checked;return mt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Uc(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ur(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Wf(t,e){e=e.checked,e!=null&&Fu(t,"checked",e,!1)}function Tl(t,e){Wf(t,e);var n=Ur(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Pl(t,e.type,n):e.hasOwnProperty("defaultValue")&&Pl(t,e.type,Ur(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Fc(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Pl(t,e,n){(e!=="number"||Wi(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var hs=Array.isArray;function $o(t,e,n,r){if(t=t.options,e){e={};for(var o=0;o<n.length;o++)e["$"+n[o]]=!0;for(n=0;n<t.length;n++)o=e.hasOwnProperty("$"+t[n].value),t[n].selected!==o&&(t[n].selected=o),o&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ur(n),e=null,o=0;o<t.length;o++){if(t[o].value===n){t[o].selected=!0,r&&(t[o].defaultSelected=!0);return}e!==null||t[o].disabled||(e=t[o])}e!==null&&(e.selected=!0)}}function Ll(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(U(91));return mt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function zc(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(U(92));if(hs(n)){if(1<n.length)throw Error(U(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ur(n)}}function Vf(t,e){var n=Ur(e.value),r=Ur(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Wc(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Gf(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function $l(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Gf(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var li,qf=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,o){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,o)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(li=li||document.createElement("div"),li.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=li.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Os(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ys={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Vm=["Webkit","ms","Moz","O"];Object.keys(ys).forEach(function(t){Vm.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ys[e]=ys[t]})});function Hf(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ys.hasOwnProperty(t)&&ys[t]?(""+e).trim():e+"px"}function Kf(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,o=Hf(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,o):t[n]=o}}var Gm=mt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Il(t,e){if(e){if(Gm[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(U(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(U(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(U(61))}if(e.style!=null&&typeof e.style!="object")throw Error(U(62))}}function Ml(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bl=null;function Gu(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Ul=null,Io=null,Mo=null;function Vc(t){if(t=Zs(t)){if(typeof Ul!="function")throw Error(U(280));var e=t.stateNode;e&&(e=wa(e),Ul(t.stateNode,t.type,e))}}function Jf(t){Io?Mo?Mo.push(t):Mo=[t]:Io=t}function Yf(){if(Io){var t=Io,e=Mo;if(Mo=Io=null,Vc(t),e)for(t=0;t<e.length;t++)Vc(e[t])}}function Qf(t,e){return t(e)}function Xf(){}var Ga=!1;function Zf(t,e,n){if(Ga)return t(e,n);Ga=!0;try{return Qf(t,e,n)}finally{Ga=!1,(Io!==null||Mo!==null)&&(Xf(),Yf())}}function Ts(t,e){var n=t.stateNode;if(n===null)return null;var r=wa(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(U(231,e,typeof n));return n}var Fl=!1;if(pr)try{var rs={};Object.defineProperty(rs,"passive",{get:function(){Fl=!0}}),window.addEventListener("test",rs,rs),window.removeEventListener("test",rs,rs)}catch{Fl=!1}function qm(t,e,n,r,o,s,i,l,u){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(d){this.onError(d)}}var vs=!1,Vi=null,Gi=!1,zl=null,Hm={onError:function(t){vs=!0,Vi=t}};function Km(t,e,n,r,o,s,i,l,u){vs=!1,Vi=null,qm.apply(Hm,arguments)}function Jm(t,e,n,r,o,s,i,l,u){if(Km.apply(this,arguments),vs){if(vs){var c=Vi;vs=!1,Vi=null}else throw Error(U(198));Gi||(Gi=!0,zl=c)}}function po(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function eh(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Gc(t){if(po(t)!==t)throw Error(U(188))}function Ym(t){var e=t.alternate;if(!e){if(e=po(t),e===null)throw Error(U(188));return e!==t?null:t}for(var n=t,r=e;;){var o=n.return;if(o===null)break;var s=o.alternate;if(s===null){if(r=o.return,r!==null){n=r;continue}break}if(o.child===s.child){for(s=o.child;s;){if(s===n)return Gc(o),t;if(s===r)return Gc(o),e;s=s.sibling}throw Error(U(188))}if(n.return!==r.return)n=o,r=s;else{for(var i=!1,l=o.child;l;){if(l===n){i=!0,n=o,r=s;break}if(l===r){i=!0,r=o,n=s;break}l=l.sibling}if(!i){for(l=s.child;l;){if(l===n){i=!0,n=s,r=o;break}if(l===r){i=!0,r=s,n=o;break}l=l.sibling}if(!i)throw Error(U(189))}}if(n.alternate!==r)throw Error(U(190))}if(n.tag!==3)throw Error(U(188));return n.stateNode.current===n?t:e}function th(t){return t=Ym(t),t!==null?nh(t):null}function nh(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=nh(t);if(e!==null)return e;t=t.sibling}return null}var rh=kn.unstable_scheduleCallback,qc=kn.unstable_cancelCallback,Qm=kn.unstable_shouldYield,Xm=kn.unstable_requestPaint,wt=kn.unstable_now,Zm=kn.unstable_getCurrentPriorityLevel,qu=kn.unstable_ImmediatePriority,oh=kn.unstable_UserBlockingPriority,qi=kn.unstable_NormalPriority,eg=kn.unstable_LowPriority,sh=kn.unstable_IdlePriority,ya=null,or=null;function tg(t){if(or&&typeof or.onCommitFiberRoot=="function")try{or.onCommitFiberRoot(ya,t,void 0,(t.current.flags&128)===128)}catch{}}var Hn=Math.clz32?Math.clz32:og,ng=Math.log,rg=Math.LN2;function og(t){return t>>>=0,t===0?32:31-(ng(t)/rg|0)|0}var ui=64,ci=4194304;function ps(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Hi(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,o=t.suspendedLanes,s=t.pingedLanes,i=n&268435455;if(i!==0){var l=i&~o;l!==0?r=ps(l):(s&=i,s!==0&&(r=ps(s)))}else i=n&~o,i!==0?r=ps(i):s!==0&&(r=ps(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&o)&&(o=r&-r,s=e&-e,o>=s||o===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Hn(e),o=1<<n,r|=t[n],e&=~o;return r}function sg(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ig(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,o=t.expirationTimes,s=t.pendingLanes;0<s;){var i=31-Hn(s),l=1<<i,u=o[i];u===-1?(!(l&n)||l&r)&&(o[i]=sg(l,e)):u<=e&&(t.expiredLanes|=l),s&=~l}}function Wl(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function ih(){var t=ui;return ui<<=1,!(ui&4194240)&&(ui=64),t}function qa(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Qs(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Hn(e),t[e]=n}function ag(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var o=31-Hn(n),s=1<<o;e[o]=0,r[o]=-1,t[o]=-1,n&=~s}}function Hu(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Hn(n),o=1<<r;o&e|t[r]&e&&(t[r]|=e),n&=~o}}var Ze=0;function ah(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var lh,Ku,uh,ch,dh,Vl=!1,di=[],Or=null,Tr=null,Pr=null,Ps=new Map,Ls=new Map,Cr=[],lg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Hc(t,e){switch(t){case"focusin":case"focusout":Or=null;break;case"dragenter":case"dragleave":Tr=null;break;case"mouseover":case"mouseout":Pr=null;break;case"pointerover":case"pointerout":Ps.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ls.delete(e.pointerId)}}function os(t,e,n,r,o,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[o]},e!==null&&(e=Zs(e),e!==null&&Ku(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,o!==null&&e.indexOf(o)===-1&&e.push(o),t)}function ug(t,e,n,r,o){switch(e){case"focusin":return Or=os(Or,t,e,n,r,o),!0;case"dragenter":return Tr=os(Tr,t,e,n,r,o),!0;case"mouseover":return Pr=os(Pr,t,e,n,r,o),!0;case"pointerover":var s=o.pointerId;return Ps.set(s,os(Ps.get(s)||null,t,e,n,r,o)),!0;case"gotpointercapture":return s=o.pointerId,Ls.set(s,os(Ls.get(s)||null,t,e,n,r,o)),!0}return!1}function fh(t){var e=eo(t.target);if(e!==null){var n=po(e);if(n!==null){if(e=n.tag,e===13){if(e=eh(n),e!==null){t.blockedOn=e,dh(t.priority,function(){uh(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ti(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Gl(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Bl=r,n.target.dispatchEvent(r),Bl=null}else return e=Zs(n),e!==null&&Ku(e),t.blockedOn=n,!1;e.shift()}return!0}function Kc(t,e,n){Ti(t)&&n.delete(e)}function cg(){Vl=!1,Or!==null&&Ti(Or)&&(Or=null),Tr!==null&&Ti(Tr)&&(Tr=null),Pr!==null&&Ti(Pr)&&(Pr=null),Ps.forEach(Kc),Ls.forEach(Kc)}function ss(t,e){t.blockedOn===e&&(t.blockedOn=null,Vl||(Vl=!0,kn.unstable_scheduleCallback(kn.unstable_NormalPriority,cg)))}function $s(t){function e(o){return ss(o,t)}if(0<di.length){ss(di[0],t);for(var n=1;n<di.length;n++){var r=di[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Or!==null&&ss(Or,t),Tr!==null&&ss(Tr,t),Pr!==null&&ss(Pr,t),Ps.forEach(e),Ls.forEach(e),n=0;n<Cr.length;n++)r=Cr[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Cr.length&&(n=Cr[0],n.blockedOn===null);)fh(n),n.blockedOn===null&&Cr.shift()}var Bo=xr.ReactCurrentBatchConfig,Ki=!0;function dg(t,e,n,r){var o=Ze,s=Bo.transition;Bo.transition=null;try{Ze=1,Ju(t,e,n,r)}finally{Ze=o,Bo.transition=s}}function fg(t,e,n,r){var o=Ze,s=Bo.transition;Bo.transition=null;try{Ze=4,Ju(t,e,n,r)}finally{Ze=o,Bo.transition=s}}function Ju(t,e,n,r){if(Ki){var o=Gl(t,e,n,r);if(o===null)nl(t,e,r,Ji,n),Hc(t,r);else if(ug(o,t,e,n,r))r.stopPropagation();else if(Hc(t,r),e&4&&-1<lg.indexOf(t)){for(;o!==null;){var s=Zs(o);if(s!==null&&lh(s),s=Gl(t,e,n,r),s===null&&nl(t,e,r,Ji,n),s===o)break;o=s}o!==null&&r.stopPropagation()}else nl(t,e,r,null,n)}}var Ji=null;function Gl(t,e,n,r){if(Ji=null,t=Gu(r),t=eo(t),t!==null)if(e=po(t),e===null)t=null;else if(n=e.tag,n===13){if(t=eh(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ji=t,null}function hh(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Zm()){case qu:return 1;case oh:return 4;case qi:case eg:return 16;case sh:return 536870912;default:return 16}default:return 16}}var Dr=null,Yu=null,Pi=null;function ph(){if(Pi)return Pi;var t,e=Yu,n=e.length,r,o="value"in Dr?Dr.value:Dr.textContent,s=o.length;for(t=0;t<n&&e[t]===o[t];t++);var i=n-t;for(r=1;r<=i&&e[n-r]===o[s-r];r++);return Pi=o.slice(t,1<r?1-r:void 0)}function Li(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function fi(){return!0}function Jc(){return!1}function jn(t){function e(n,r,o,s,i){this._reactName=n,this._targetInst=o,this.type=r,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(s):s[l]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?fi:Jc,this.isPropagationStopped=Jc,this}return mt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=fi)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=fi)},persist:function(){},isPersistent:fi}),e}var Qo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Qu=jn(Qo),Xs=mt({},Qo,{view:0,detail:0}),hg=jn(Xs),Ha,Ka,is,va=mt({},Xs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xu,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==is&&(is&&t.type==="mousemove"?(Ha=t.screenX-is.screenX,Ka=t.screenY-is.screenY):Ka=Ha=0,is=t),Ha)},movementY:function(t){return"movementY"in t?t.movementY:Ka}}),Yc=jn(va),pg=mt({},va,{dataTransfer:0}),mg=jn(pg),gg=mt({},Xs,{relatedTarget:0}),Ja=jn(gg),yg=mt({},Qo,{animationName:0,elapsedTime:0,pseudoElement:0}),vg=jn(yg),xg=mt({},Qo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),bg=jn(xg),wg=mt({},Qo,{data:0}),Qc=jn(wg),Sg={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_g={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Eg(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=kg[t])?!!e[t]:!1}function Xu(){return Eg}var jg=mt({},Xs,{key:function(t){if(t.key){var e=Sg[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Li(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?_g[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xu,charCode:function(t){return t.type==="keypress"?Li(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Li(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Cg=jn(jg),Rg=mt({},va,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xc=jn(Rg),Ng=mt({},Xs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xu}),Dg=jn(Ng),Ag=mt({},Qo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Og=jn(Ag),Tg=mt({},va,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Pg=jn(Tg),Lg=[9,13,27,32],Zu=pr&&"CompositionEvent"in window,xs=null;pr&&"documentMode"in document&&(xs=document.documentMode);var $g=pr&&"TextEvent"in window&&!xs,mh=pr&&(!Zu||xs&&8<xs&&11>=xs),Zc=" ",ed=!1;function gh(t,e){switch(t){case"keyup":return Lg.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function yh(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var jo=!1;function Ig(t,e){switch(t){case"compositionend":return yh(e);case"keypress":return e.which!==32?null:(ed=!0,Zc);case"textInput":return t=e.data,t===Zc&&ed?null:t;default:return null}}function Mg(t,e){if(jo)return t==="compositionend"||!Zu&&gh(t,e)?(t=ph(),Pi=Yu=Dr=null,jo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return mh&&e.locale!=="ko"?null:e.data;default:return null}}var Bg={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function td(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Bg[t.type]:e==="textarea"}function vh(t,e,n,r){Jf(r),e=Yi(e,"onChange"),0<e.length&&(n=new Qu("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var bs=null,Is=null;function Ug(t){Nh(t,0)}function xa(t){var e=No(t);if(zf(e))return t}function Fg(t,e){if(t==="change")return e}var xh=!1;if(pr){var Ya;if(pr){var Qa="oninput"in document;if(!Qa){var nd=document.createElement("div");nd.setAttribute("oninput","return;"),Qa=typeof nd.oninput=="function"}Ya=Qa}else Ya=!1;xh=Ya&&(!document.documentMode||9<document.documentMode)}function rd(){bs&&(bs.detachEvent("onpropertychange",bh),Is=bs=null)}function bh(t){if(t.propertyName==="value"&&xa(Is)){var e=[];vh(e,Is,t,Gu(t)),Zf(Ug,e)}}function zg(t,e,n){t==="focusin"?(rd(),bs=e,Is=n,bs.attachEvent("onpropertychange",bh)):t==="focusout"&&rd()}function Wg(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return xa(Is)}function Vg(t,e){if(t==="click")return xa(e)}function Gg(t,e){if(t==="input"||t==="change")return xa(e)}function qg(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Jn=typeof Object.is=="function"?Object.is:qg;function Ms(t,e){if(Jn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!Cl.call(e,o)||!Jn(t[o],e[o]))return!1}return!0}function od(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function sd(t,e){var n=od(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=od(n)}}function wh(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?wh(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Sh(){for(var t=window,e=Wi();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Wi(t.document)}return e}function ec(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Hg(t){var e=Sh(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&wh(n.ownerDocument.documentElement,n)){if(r!==null&&ec(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var o=n.textContent.length,s=Math.min(r.start,o);r=r.end===void 0?s:Math.min(r.end,o),!t.extend&&s>r&&(o=r,r=s,s=o),o=sd(n,s);var i=sd(n,r);o&&i&&(t.rangeCount!==1||t.anchorNode!==o.node||t.anchorOffset!==o.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(o.node,o.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Kg=pr&&"documentMode"in document&&11>=document.documentMode,Co=null,ql=null,ws=null,Hl=!1;function id(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Hl||Co==null||Co!==Wi(r)||(r=Co,"selectionStart"in r&&ec(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ws&&Ms(ws,r)||(ws=r,r=Yi(ql,"onSelect"),0<r.length&&(e=new Qu("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Co)))}function hi(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ro={animationend:hi("Animation","AnimationEnd"),animationiteration:hi("Animation","AnimationIteration"),animationstart:hi("Animation","AnimationStart"),transitionend:hi("Transition","TransitionEnd")},Xa={},_h={};pr&&(_h=document.createElement("div").style,"AnimationEvent"in window||(delete Ro.animationend.animation,delete Ro.animationiteration.animation,delete Ro.animationstart.animation),"TransitionEvent"in window||delete Ro.transitionend.transition);function ba(t){if(Xa[t])return Xa[t];if(!Ro[t])return t;var e=Ro[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in _h)return Xa[t]=e[n];return t}var kh=ba("animationend"),Eh=ba("animationiteration"),jh=ba("animationstart"),Ch=ba("transitionend"),Rh=new Map,ad="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zr(t,e){Rh.set(t,e),ho(e,[t])}for(var Za=0;Za<ad.length;Za++){var el=ad[Za],Jg=el.toLowerCase(),Yg=el[0].toUpperCase()+el.slice(1);zr(Jg,"on"+Yg)}zr(kh,"onAnimationEnd");zr(Eh,"onAnimationIteration");zr(jh,"onAnimationStart");zr("dblclick","onDoubleClick");zr("focusin","onFocus");zr("focusout","onBlur");zr(Ch,"onTransitionEnd");zo("onMouseEnter",["mouseout","mouseover"]);zo("onMouseLeave",["mouseout","mouseover"]);zo("onPointerEnter",["pointerout","pointerover"]);zo("onPointerLeave",["pointerout","pointerover"]);ho("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ho("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ho("onBeforeInput",["compositionend","keypress","textInput","paste"]);ho("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ho("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ho("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ms="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qg=new Set("cancel close invalid load scroll toggle".split(" ").concat(ms));function ld(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Jm(r,e,void 0,t),t.currentTarget=null}function Nh(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],o=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var i=r.length-1;0<=i;i--){var l=r[i],u=l.instance,c=l.currentTarget;if(l=l.listener,u!==s&&o.isPropagationStopped())break e;ld(o,l,c),s=u}else for(i=0;i<r.length;i++){if(l=r[i],u=l.instance,c=l.currentTarget,l=l.listener,u!==s&&o.isPropagationStopped())break e;ld(o,l,c),s=u}}}if(Gi)throw t=zl,Gi=!1,zl=null,t}function lt(t,e){var n=e[Xl];n===void 0&&(n=e[Xl]=new Set);var r=t+"__bubble";n.has(r)||(Dh(e,t,2,!1),n.add(r))}function tl(t,e,n){var r=0;e&&(r|=4),Dh(n,t,r,e)}var pi="_reactListening"+Math.random().toString(36).slice(2);function Bs(t){if(!t[pi]){t[pi]=!0,If.forEach(function(n){n!=="selectionchange"&&(Qg.has(n)||tl(n,!1,t),tl(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[pi]||(e[pi]=!0,tl("selectionchange",!1,e))}}function Dh(t,e,n,r){switch(hh(e)){case 1:var o=dg;break;case 4:o=fg;break;default:o=Ju}n=o.bind(null,e,n,t),o=void 0,!Fl||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(o=!0),r?o!==void 0?t.addEventListener(e,n,{capture:!0,passive:o}):t.addEventListener(e,n,!0):o!==void 0?t.addEventListener(e,n,{passive:o}):t.addEventListener(e,n,!1)}function nl(t,e,n,r,o){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var l=r.stateNode.containerInfo;if(l===o||l.nodeType===8&&l.parentNode===o)break;if(i===4)for(i=r.return;i!==null;){var u=i.tag;if((u===3||u===4)&&(u=i.stateNode.containerInfo,u===o||u.nodeType===8&&u.parentNode===o))return;i=i.return}for(;l!==null;){if(i=eo(l),i===null)return;if(u=i.tag,u===5||u===6){r=s=i;continue e}l=l.parentNode}}r=r.return}Zf(function(){var c=s,d=Gu(n),h=[];e:{var f=Rh.get(t);if(f!==void 0){var x=Qu,y=t;switch(t){case"keypress":if(Li(n)===0)break e;case"keydown":case"keyup":x=Cg;break;case"focusin":y="focus",x=Ja;break;case"focusout":y="blur",x=Ja;break;case"beforeblur":case"afterblur":x=Ja;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=Yc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=mg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=Dg;break;case kh:case Eh:case jh:x=vg;break;case Ch:x=Og;break;case"scroll":x=hg;break;case"wheel":x=Pg;break;case"copy":case"cut":case"paste":x=bg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=Xc}var b=(e&4)!==0,_=!b&&t==="scroll",p=b?f!==null?f+"Capture":null:f;b=[];for(var m=c,g;m!==null;){g=m;var w=g.stateNode;if(g.tag===5&&w!==null&&(g=w,p!==null&&(w=Ts(m,p),w!=null&&b.push(Us(m,w,g)))),_)break;m=m.return}0<b.length&&(f=new x(f,y,null,n,d),h.push({event:f,listeners:b}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",x=t==="mouseout"||t==="pointerout",f&&n!==Bl&&(y=n.relatedTarget||n.fromElement)&&(eo(y)||y[mr]))break e;if((x||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,x?(y=n.relatedTarget||n.toElement,x=c,y=y?eo(y):null,y!==null&&(_=po(y),y!==_||y.tag!==5&&y.tag!==6)&&(y=null)):(x=null,y=c),x!==y)){if(b=Yc,w="onMouseLeave",p="onMouseEnter",m="mouse",(t==="pointerout"||t==="pointerover")&&(b=Xc,w="onPointerLeave",p="onPointerEnter",m="pointer"),_=x==null?f:No(x),g=y==null?f:No(y),f=new b(w,m+"leave",x,n,d),f.target=_,f.relatedTarget=g,w=null,eo(d)===c&&(b=new b(p,m+"enter",y,n,d),b.target=g,b.relatedTarget=_,w=b),_=w,x&&y)t:{for(b=x,p=y,m=0,g=b;g;g=go(g))m++;for(g=0,w=p;w;w=go(w))g++;for(;0<m-g;)b=go(b),m--;for(;0<g-m;)p=go(p),g--;for(;m--;){if(b===p||p!==null&&b===p.alternate)break t;b=go(b),p=go(p)}b=null}else b=null;x!==null&&ud(h,f,x,b,!1),y!==null&&_!==null&&ud(h,_,y,b,!0)}}e:{if(f=c?No(c):window,x=f.nodeName&&f.nodeName.toLowerCase(),x==="select"||x==="input"&&f.type==="file")var j=Fg;else if(td(f))if(xh)j=Gg;else{j=Wg;var R=zg}else(x=f.nodeName)&&x.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(j=Vg);if(j&&(j=j(t,c))){vh(h,j,n,d);break e}R&&R(t,f,c),t==="focusout"&&(R=f._wrapperState)&&R.controlled&&f.type==="number"&&Pl(f,"number",f.value)}switch(R=c?No(c):window,t){case"focusin":(td(R)||R.contentEditable==="true")&&(Co=R,ql=c,ws=null);break;case"focusout":ws=ql=Co=null;break;case"mousedown":Hl=!0;break;case"contextmenu":case"mouseup":case"dragend":Hl=!1,id(h,n,d);break;case"selectionchange":if(Kg)break;case"keydown":case"keyup":id(h,n,d)}var C;if(Zu)e:{switch(t){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else jo?gh(t,n)&&(S="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(S="onCompositionStart");S&&(mh&&n.locale!=="ko"&&(jo||S!=="onCompositionStart"?S==="onCompositionEnd"&&jo&&(C=ph()):(Dr=d,Yu="value"in Dr?Dr.value:Dr.textContent,jo=!0)),R=Yi(c,S),0<R.length&&(S=new Qc(S,t,null,n,d),h.push({event:S,listeners:R}),C?S.data=C:(C=yh(n),C!==null&&(S.data=C)))),(C=$g?Ig(t,n):Mg(t,n))&&(c=Yi(c,"onBeforeInput"),0<c.length&&(d=new Qc("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:c}),d.data=C))}Nh(h,e)})}function Us(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Yi(t,e){for(var n=e+"Capture",r=[];t!==null;){var o=t,s=o.stateNode;o.tag===5&&s!==null&&(o=s,s=Ts(t,n),s!=null&&r.unshift(Us(t,s,o)),s=Ts(t,e),s!=null&&r.push(Us(t,s,o))),t=t.return}return r}function go(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function ud(t,e,n,r,o){for(var s=e._reactName,i=[];n!==null&&n!==r;){var l=n,u=l.alternate,c=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&c!==null&&(l=c,o?(u=Ts(n,s),u!=null&&i.unshift(Us(n,u,l))):o||(u=Ts(n,s),u!=null&&i.push(Us(n,u,l)))),n=n.return}i.length!==0&&t.push({event:e,listeners:i})}var Xg=/\r\n?/g,Zg=/\u0000|\uFFFD/g;function cd(t){return(typeof t=="string"?t:""+t).replace(Xg,`
`).replace(Zg,"")}function mi(t,e,n){if(e=cd(e),cd(t)!==e&&n)throw Error(U(425))}function Qi(){}var Kl=null,Jl=null;function Yl(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Ql=typeof setTimeout=="function"?setTimeout:void 0,e0=typeof clearTimeout=="function"?clearTimeout:void 0,dd=typeof Promise=="function"?Promise:void 0,t0=typeof queueMicrotask=="function"?queueMicrotask:typeof dd<"u"?function(t){return dd.resolve(null).then(t).catch(n0)}:Ql;function n0(t){setTimeout(function(){throw t})}function rl(t,e){var n=e,r=0;do{var o=n.nextSibling;if(t.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(r===0){t.removeChild(o),$s(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=o}while(n);$s(e)}function Lr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function fd(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Xo=Math.random().toString(36).slice(2),nr="__reactFiber$"+Xo,Fs="__reactProps$"+Xo,mr="__reactContainer$"+Xo,Xl="__reactEvents$"+Xo,r0="__reactListeners$"+Xo,o0="__reactHandles$"+Xo;function eo(t){var e=t[nr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[mr]||n[nr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=fd(t);t!==null;){if(n=t[nr])return n;t=fd(t)}return e}t=n,n=t.parentNode}return null}function Zs(t){return t=t[nr]||t[mr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function No(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(U(33))}function wa(t){return t[Fs]||null}var Zl=[],Do=-1;function Wr(t){return{current:t}}function ut(t){0>Do||(t.current=Zl[Do],Zl[Do]=null,Do--)}function st(t,e){Do++,Zl[Do]=t.current,t.current=e}var Fr={},Kt=Wr(Fr),yn=Wr(!1),so=Fr;function Wo(t,e){var n=t.type.contextTypes;if(!n)return Fr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var o={},s;for(s in n)o[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function vn(t){return t=t.childContextTypes,t!=null}function Xi(){ut(yn),ut(Kt)}function hd(t,e,n){if(Kt.current!==Fr)throw Error(U(168));st(Kt,e),st(yn,n)}function Ah(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var o in r)if(!(o in e))throw Error(U(108,zm(t)||"Unknown",o));return mt({},n,r)}function Zi(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Fr,so=Kt.current,st(Kt,t),st(yn,yn.current),!0}function pd(t,e,n){var r=t.stateNode;if(!r)throw Error(U(169));n?(t=Ah(t,e,so),r.__reactInternalMemoizedMergedChildContext=t,ut(yn),ut(Kt),st(Kt,t)):ut(yn),st(yn,n)}var ur=null,Sa=!1,ol=!1;function Oh(t){ur===null?ur=[t]:ur.push(t)}function s0(t){Sa=!0,Oh(t)}function Vr(){if(!ol&&ur!==null){ol=!0;var t=0,e=Ze;try{var n=ur;for(Ze=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}ur=null,Sa=!1}catch(o){throw ur!==null&&(ur=ur.slice(t+1)),rh(qu,Vr),o}finally{Ze=e,ol=!1}}return null}var Ao=[],Oo=0,ea=null,ta=0,Dn=[],An=0,io=null,cr=1,dr="";function Yr(t,e){Ao[Oo++]=ta,Ao[Oo++]=ea,ea=t,ta=e}function Th(t,e,n){Dn[An++]=cr,Dn[An++]=dr,Dn[An++]=io,io=t;var r=cr;t=dr;var o=32-Hn(r)-1;r&=~(1<<o),n+=1;var s=32-Hn(e)+o;if(30<s){var i=o-o%5;s=(r&(1<<i)-1).toString(32),r>>=i,o-=i,cr=1<<32-Hn(e)+o|n<<o|r,dr=s+t}else cr=1<<s|n<<o|r,dr=t}function tc(t){t.return!==null&&(Yr(t,1),Th(t,1,0))}function nc(t){for(;t===ea;)ea=Ao[--Oo],Ao[Oo]=null,ta=Ao[--Oo],Ao[Oo]=null;for(;t===io;)io=Dn[--An],Dn[An]=null,dr=Dn[--An],Dn[An]=null,cr=Dn[--An],Dn[An]=null}var _n=null,Sn=null,ft=!1,Gn=null;function Ph(t,e){var n=On(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function md(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,_n=t,Sn=Lr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,_n=t,Sn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=io!==null?{id:cr,overflow:dr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=On(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,_n=t,Sn=null,!0):!1;default:return!1}}function eu(t){return(t.mode&1)!==0&&(t.flags&128)===0}function tu(t){if(ft){var e=Sn;if(e){var n=e;if(!md(t,e)){if(eu(t))throw Error(U(418));e=Lr(n.nextSibling);var r=_n;e&&md(t,e)?Ph(r,n):(t.flags=t.flags&-4097|2,ft=!1,_n=t)}}else{if(eu(t))throw Error(U(418));t.flags=t.flags&-4097|2,ft=!1,_n=t}}}function gd(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;_n=t}function gi(t){if(t!==_n)return!1;if(!ft)return gd(t),ft=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Yl(t.type,t.memoizedProps)),e&&(e=Sn)){if(eu(t))throw Lh(),Error(U(418));for(;e;)Ph(t,e),e=Lr(e.nextSibling)}if(gd(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(U(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Sn=Lr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Sn=null}}else Sn=_n?Lr(t.stateNode.nextSibling):null;return!0}function Lh(){for(var t=Sn;t;)t=Lr(t.nextSibling)}function Vo(){Sn=_n=null,ft=!1}function rc(t){Gn===null?Gn=[t]:Gn.push(t)}var i0=xr.ReactCurrentBatchConfig;function as(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(U(309));var r=n.stateNode}if(!r)throw Error(U(147,t));var o=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(i){var l=o.refs;i===null?delete l[s]:l[s]=i},e._stringRef=s,e)}if(typeof t!="string")throw Error(U(284));if(!n._owner)throw Error(U(290,t))}return t}function yi(t,e){throw t=Object.prototype.toString.call(e),Error(U(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function yd(t){var e=t._init;return e(t._payload)}function $h(t){function e(p,m){if(t){var g=p.deletions;g===null?(p.deletions=[m],p.flags|=16):g.push(m)}}function n(p,m){if(!t)return null;for(;m!==null;)e(p,m),m=m.sibling;return null}function r(p,m){for(p=new Map;m!==null;)m.key!==null?p.set(m.key,m):p.set(m.index,m),m=m.sibling;return p}function o(p,m){return p=Br(p,m),p.index=0,p.sibling=null,p}function s(p,m,g){return p.index=g,t?(g=p.alternate,g!==null?(g=g.index,g<m?(p.flags|=2,m):g):(p.flags|=2,m)):(p.flags|=1048576,m)}function i(p){return t&&p.alternate===null&&(p.flags|=2),p}function l(p,m,g,w){return m===null||m.tag!==6?(m=dl(g,p.mode,w),m.return=p,m):(m=o(m,g),m.return=p,m)}function u(p,m,g,w){var j=g.type;return j===Eo?d(p,m,g.props.children,w,g.key):m!==null&&(m.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Er&&yd(j)===m.type)?(w=o(m,g.props),w.ref=as(p,m,g),w.return=p,w):(w=zi(g.type,g.key,g.props,null,p.mode,w),w.ref=as(p,m,g),w.return=p,w)}function c(p,m,g,w){return m===null||m.tag!==4||m.stateNode.containerInfo!==g.containerInfo||m.stateNode.implementation!==g.implementation?(m=fl(g,p.mode,w),m.return=p,m):(m=o(m,g.children||[]),m.return=p,m)}function d(p,m,g,w,j){return m===null||m.tag!==7?(m=oo(g,p.mode,w,j),m.return=p,m):(m=o(m,g),m.return=p,m)}function h(p,m,g){if(typeof m=="string"&&m!==""||typeof m=="number")return m=dl(""+m,p.mode,g),m.return=p,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case ii:return g=zi(m.type,m.key,m.props,null,p.mode,g),g.ref=as(p,null,m),g.return=p,g;case ko:return m=fl(m,p.mode,g),m.return=p,m;case Er:var w=m._init;return h(p,w(m._payload),g)}if(hs(m)||ns(m))return m=oo(m,p.mode,g,null),m.return=p,m;yi(p,m)}return null}function f(p,m,g,w){var j=m!==null?m.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return j!==null?null:l(p,m,""+g,w);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case ii:return g.key===j?u(p,m,g,w):null;case ko:return g.key===j?c(p,m,g,w):null;case Er:return j=g._init,f(p,m,j(g._payload),w)}if(hs(g)||ns(g))return j!==null?null:d(p,m,g,w,null);yi(p,g)}return null}function x(p,m,g,w,j){if(typeof w=="string"&&w!==""||typeof w=="number")return p=p.get(g)||null,l(m,p,""+w,j);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ii:return p=p.get(w.key===null?g:w.key)||null,u(m,p,w,j);case ko:return p=p.get(w.key===null?g:w.key)||null,c(m,p,w,j);case Er:var R=w._init;return x(p,m,g,R(w._payload),j)}if(hs(w)||ns(w))return p=p.get(g)||null,d(m,p,w,j,null);yi(m,w)}return null}function y(p,m,g,w){for(var j=null,R=null,C=m,S=m=0,A=null;C!==null&&S<g.length;S++){C.index>S?(A=C,C=null):A=C.sibling;var v=f(p,C,g[S],w);if(v===null){C===null&&(C=A);break}t&&C&&v.alternate===null&&e(p,C),m=s(v,m,S),R===null?j=v:R.sibling=v,R=v,C=A}if(S===g.length)return n(p,C),ft&&Yr(p,S),j;if(C===null){for(;S<g.length;S++)C=h(p,g[S],w),C!==null&&(m=s(C,m,S),R===null?j=C:R.sibling=C,R=C);return ft&&Yr(p,S),j}for(C=r(p,C);S<g.length;S++)A=x(C,p,S,g[S],w),A!==null&&(t&&A.alternate!==null&&C.delete(A.key===null?S:A.key),m=s(A,m,S),R===null?j=A:R.sibling=A,R=A);return t&&C.forEach(function(D){return e(p,D)}),ft&&Yr(p,S),j}function b(p,m,g,w){var j=ns(g);if(typeof j!="function")throw Error(U(150));if(g=j.call(g),g==null)throw Error(U(151));for(var R=j=null,C=m,S=m=0,A=null,v=g.next();C!==null&&!v.done;S++,v=g.next()){C.index>S?(A=C,C=null):A=C.sibling;var D=f(p,C,v.value,w);if(D===null){C===null&&(C=A);break}t&&C&&D.alternate===null&&e(p,C),m=s(D,m,S),R===null?j=D:R.sibling=D,R=D,C=A}if(v.done)return n(p,C),ft&&Yr(p,S),j;if(C===null){for(;!v.done;S++,v=g.next())v=h(p,v.value,w),v!==null&&(m=s(v,m,S),R===null?j=v:R.sibling=v,R=v);return ft&&Yr(p,S),j}for(C=r(p,C);!v.done;S++,v=g.next())v=x(C,p,S,v.value,w),v!==null&&(t&&v.alternate!==null&&C.delete(v.key===null?S:v.key),m=s(v,m,S),R===null?j=v:R.sibling=v,R=v);return t&&C.forEach(function(O){return e(p,O)}),ft&&Yr(p,S),j}function _(p,m,g,w){if(typeof g=="object"&&g!==null&&g.type===Eo&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case ii:e:{for(var j=g.key,R=m;R!==null;){if(R.key===j){if(j=g.type,j===Eo){if(R.tag===7){n(p,R.sibling),m=o(R,g.props.children),m.return=p,p=m;break e}}else if(R.elementType===j||typeof j=="object"&&j!==null&&j.$$typeof===Er&&yd(j)===R.type){n(p,R.sibling),m=o(R,g.props),m.ref=as(p,R,g),m.return=p,p=m;break e}n(p,R);break}else e(p,R);R=R.sibling}g.type===Eo?(m=oo(g.props.children,p.mode,w,g.key),m.return=p,p=m):(w=zi(g.type,g.key,g.props,null,p.mode,w),w.ref=as(p,m,g),w.return=p,p=w)}return i(p);case ko:e:{for(R=g.key;m!==null;){if(m.key===R)if(m.tag===4&&m.stateNode.containerInfo===g.containerInfo&&m.stateNode.implementation===g.implementation){n(p,m.sibling),m=o(m,g.children||[]),m.return=p,p=m;break e}else{n(p,m);break}else e(p,m);m=m.sibling}m=fl(g,p.mode,w),m.return=p,p=m}return i(p);case Er:return R=g._init,_(p,m,R(g._payload),w)}if(hs(g))return y(p,m,g,w);if(ns(g))return b(p,m,g,w);yi(p,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,m!==null&&m.tag===6?(n(p,m.sibling),m=o(m,g),m.return=p,p=m):(n(p,m),m=dl(g,p.mode,w),m.return=p,p=m),i(p)):n(p,m)}return _}var Go=$h(!0),Ih=$h(!1),na=Wr(null),ra=null,To=null,oc=null;function sc(){oc=To=ra=null}function ic(t){var e=na.current;ut(na),t._currentValue=e}function nu(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Uo(t,e){ra=t,oc=To=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(gn=!0),t.firstContext=null)}function Ln(t){var e=t._currentValue;if(oc!==t)if(t={context:t,memoizedValue:e,next:null},To===null){if(ra===null)throw Error(U(308));To=t,ra.dependencies={lanes:0,firstContext:t}}else To=To.next=t;return e}var to=null;function ac(t){to===null?to=[t]:to.push(t)}function Mh(t,e,n,r){var o=e.interleaved;return o===null?(n.next=n,ac(e)):(n.next=o.next,o.next=n),e.interleaved=n,gr(t,r)}function gr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var jr=!1;function lc(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Bh(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function hr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function $r(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ge&2){var o=r.pending;return o===null?e.next=e:(e.next=o.next,o.next=e),r.pending=e,gr(t,n)}return o=r.interleaved,o===null?(e.next=e,ac(r)):(e.next=o.next,o.next=e),r.interleaved=e,gr(t,n)}function $i(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Hu(t,n)}}function vd(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var o=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?o=s=i:s=s.next=i,n=n.next}while(n!==null);s===null?o=s=e:s=s.next=e}else o=s=e;n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function oa(t,e,n,r){var o=t.updateQueue;jr=!1;var s=o.firstBaseUpdate,i=o.lastBaseUpdate,l=o.shared.pending;if(l!==null){o.shared.pending=null;var u=l,c=u.next;u.next=null,i===null?s=c:i.next=c,i=u;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==i&&(l===null?d.firstBaseUpdate=c:l.next=c,d.lastBaseUpdate=u))}if(s!==null){var h=o.baseState;i=0,d=c=u=null,l=s;do{var f=l.lane,x=l.eventTime;if((r&f)===f){d!==null&&(d=d.next={eventTime:x,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var y=t,b=l;switch(f=e,x=n,b.tag){case 1:if(y=b.payload,typeof y=="function"){h=y.call(x,h,f);break e}h=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=b.payload,f=typeof y=="function"?y.call(x,h,f):y,f==null)break e;h=mt({},h,f);break e;case 2:jr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,f=o.effects,f===null?o.effects=[l]:f.push(l))}else x={eventTime:x,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(c=d=x,u=h):d=d.next=x,i|=f;if(l=l.next,l===null){if(l=o.shared.pending,l===null)break;f=l,l=f.next,f.next=null,o.lastBaseUpdate=f,o.shared.pending=null}}while(!0);if(d===null&&(u=h),o.baseState=u,o.firstBaseUpdate=c,o.lastBaseUpdate=d,e=o.shared.interleaved,e!==null){o=e;do i|=o.lane,o=o.next;while(o!==e)}else s===null&&(o.shared.lanes=0);lo|=i,t.lanes=i,t.memoizedState=h}}function xd(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],o=r.callback;if(o!==null){if(r.callback=null,r=n,typeof o!="function")throw Error(U(191,o));o.call(r)}}}var ei={},sr=Wr(ei),zs=Wr(ei),Ws=Wr(ei);function no(t){if(t===ei)throw Error(U(174));return t}function uc(t,e){switch(st(Ws,e),st(zs,t),st(sr,ei),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:$l(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=$l(e,t)}ut(sr),st(sr,e)}function qo(){ut(sr),ut(zs),ut(Ws)}function Uh(t){no(Ws.current);var e=no(sr.current),n=$l(e,t.type);e!==n&&(st(zs,t),st(sr,n))}function cc(t){zs.current===t&&(ut(sr),ut(zs))}var ht=Wr(0);function sa(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var sl=[];function dc(){for(var t=0;t<sl.length;t++)sl[t]._workInProgressVersionPrimary=null;sl.length=0}var Ii=xr.ReactCurrentDispatcher,il=xr.ReactCurrentBatchConfig,ao=0,pt=null,Rt=null,$t=null,ia=!1,Ss=!1,Vs=0,a0=0;function Gt(){throw Error(U(321))}function fc(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Jn(t[n],e[n]))return!1;return!0}function hc(t,e,n,r,o,s){if(ao=s,pt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ii.current=t===null||t.memoizedState===null?d0:f0,t=n(r,o),Ss){s=0;do{if(Ss=!1,Vs=0,25<=s)throw Error(U(301));s+=1,$t=Rt=null,e.updateQueue=null,Ii.current=h0,t=n(r,o)}while(Ss)}if(Ii.current=aa,e=Rt!==null&&Rt.next!==null,ao=0,$t=Rt=pt=null,ia=!1,e)throw Error(U(300));return t}function pc(){var t=Vs!==0;return Vs=0,t}function er(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return $t===null?pt.memoizedState=$t=t:$t=$t.next=t,$t}function $n(){if(Rt===null){var t=pt.alternate;t=t!==null?t.memoizedState:null}else t=Rt.next;var e=$t===null?pt.memoizedState:$t.next;if(e!==null)$t=e,Rt=t;else{if(t===null)throw Error(U(310));Rt=t,t={memoizedState:Rt.memoizedState,baseState:Rt.baseState,baseQueue:Rt.baseQueue,queue:Rt.queue,next:null},$t===null?pt.memoizedState=$t=t:$t=$t.next=t}return $t}function Gs(t,e){return typeof e=="function"?e(t):e}function al(t){var e=$n(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=Rt,o=r.baseQueue,s=n.pending;if(s!==null){if(o!==null){var i=o.next;o.next=s.next,s.next=i}r.baseQueue=o=s,n.pending=null}if(o!==null){s=o.next,r=r.baseState;var l=i=null,u=null,c=s;do{var d=c.lane;if((ao&d)===d)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(l=u=h,i=r):u=u.next=h,pt.lanes|=d,lo|=d}c=c.next}while(c!==null&&c!==s);u===null?i=r:u.next=l,Jn(r,e.memoizedState)||(gn=!0),e.memoizedState=r,e.baseState=i,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){o=t;do s=o.lane,pt.lanes|=s,lo|=s,o=o.next;while(o!==t)}else o===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function ll(t){var e=$n(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=n.dispatch,o=n.pending,s=e.memoizedState;if(o!==null){n.pending=null;var i=o=o.next;do s=t(s,i.action),i=i.next;while(i!==o);Jn(s,e.memoizedState)||(gn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function Fh(){}function zh(t,e){var n=pt,r=$n(),o=e(),s=!Jn(r.memoizedState,o);if(s&&(r.memoizedState=o,gn=!0),r=r.queue,mc(Gh.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||$t!==null&&$t.memoizedState.tag&1){if(n.flags|=2048,qs(9,Vh.bind(null,n,r,o,e),void 0,null),It===null)throw Error(U(349));ao&30||Wh(n,e,o)}return o}function Wh(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=pt.updateQueue,e===null?(e={lastEffect:null,stores:null},pt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Vh(t,e,n,r){e.value=n,e.getSnapshot=r,qh(e)&&Hh(t)}function Gh(t,e,n){return n(function(){qh(e)&&Hh(t)})}function qh(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Jn(t,n)}catch{return!0}}function Hh(t){var e=gr(t,1);e!==null&&Kn(e,t,1,-1)}function bd(t){var e=er();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Gs,lastRenderedState:t},e.queue=t,t=t.dispatch=c0.bind(null,pt,t),[e.memoizedState,t]}function qs(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=pt.updateQueue,e===null?(e={lastEffect:null,stores:null},pt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Kh(){return $n().memoizedState}function Mi(t,e,n,r){var o=er();pt.flags|=t,o.memoizedState=qs(1|e,n,void 0,r===void 0?null:r)}function _a(t,e,n,r){var o=$n();r=r===void 0?null:r;var s=void 0;if(Rt!==null){var i=Rt.memoizedState;if(s=i.destroy,r!==null&&fc(r,i.deps)){o.memoizedState=qs(e,n,s,r);return}}pt.flags|=t,o.memoizedState=qs(1|e,n,s,r)}function wd(t,e){return Mi(8390656,8,t,e)}function mc(t,e){return _a(2048,8,t,e)}function Jh(t,e){return _a(4,2,t,e)}function Yh(t,e){return _a(4,4,t,e)}function Qh(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Xh(t,e,n){return n=n!=null?n.concat([t]):null,_a(4,4,Qh.bind(null,e,t),n)}function gc(){}function Zh(t,e){var n=$n();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&fc(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function ep(t,e){var n=$n();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&fc(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function tp(t,e,n){return ao&21?(Jn(n,e)||(n=ih(),pt.lanes|=n,lo|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,gn=!0),t.memoizedState=n)}function l0(t,e){var n=Ze;Ze=n!==0&&4>n?n:4,t(!0);var r=il.transition;il.transition={};try{t(!1),e()}finally{Ze=n,il.transition=r}}function np(){return $n().memoizedState}function u0(t,e,n){var r=Mr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},rp(t))op(e,n);else if(n=Mh(t,e,n,r),n!==null){var o=tn();Kn(n,t,r,o),sp(n,e,r)}}function c0(t,e,n){var r=Mr(t),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(rp(t))op(e,o);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var i=e.lastRenderedState,l=s(i,n);if(o.hasEagerState=!0,o.eagerState=l,Jn(l,i)){var u=e.interleaved;u===null?(o.next=o,ac(e)):(o.next=u.next,u.next=o),e.interleaved=o;return}}catch{}finally{}n=Mh(t,e,o,r),n!==null&&(o=tn(),Kn(n,t,r,o),sp(n,e,r))}}function rp(t){var e=t.alternate;return t===pt||e!==null&&e===pt}function op(t,e){Ss=ia=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function sp(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Hu(t,n)}}var aa={readContext:Ln,useCallback:Gt,useContext:Gt,useEffect:Gt,useImperativeHandle:Gt,useInsertionEffect:Gt,useLayoutEffect:Gt,useMemo:Gt,useReducer:Gt,useRef:Gt,useState:Gt,useDebugValue:Gt,useDeferredValue:Gt,useTransition:Gt,useMutableSource:Gt,useSyncExternalStore:Gt,useId:Gt,unstable_isNewReconciler:!1},d0={readContext:Ln,useCallback:function(t,e){return er().memoizedState=[t,e===void 0?null:e],t},useContext:Ln,useEffect:wd,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Mi(4194308,4,Qh.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Mi(4194308,4,t,e)},useInsertionEffect:function(t,e){return Mi(4,2,t,e)},useMemo:function(t,e){var n=er();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=er();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=u0.bind(null,pt,t),[r.memoizedState,t]},useRef:function(t){var e=er();return t={current:t},e.memoizedState=t},useState:bd,useDebugValue:gc,useDeferredValue:function(t){return er().memoizedState=t},useTransition:function(){var t=bd(!1),e=t[0];return t=l0.bind(null,t[1]),er().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=pt,o=er();if(ft){if(n===void 0)throw Error(U(407));n=n()}else{if(n=e(),It===null)throw Error(U(349));ao&30||Wh(r,e,n)}o.memoizedState=n;var s={value:n,getSnapshot:e};return o.queue=s,wd(Gh.bind(null,r,s,t),[t]),r.flags|=2048,qs(9,Vh.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=er(),e=It.identifierPrefix;if(ft){var n=dr,r=cr;n=(r&~(1<<32-Hn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Vs++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=a0++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},f0={readContext:Ln,useCallback:Zh,useContext:Ln,useEffect:mc,useImperativeHandle:Xh,useInsertionEffect:Jh,useLayoutEffect:Yh,useMemo:ep,useReducer:al,useRef:Kh,useState:function(){return al(Gs)},useDebugValue:gc,useDeferredValue:function(t){var e=$n();return tp(e,Rt.memoizedState,t)},useTransition:function(){var t=al(Gs)[0],e=$n().memoizedState;return[t,e]},useMutableSource:Fh,useSyncExternalStore:zh,useId:np,unstable_isNewReconciler:!1},h0={readContext:Ln,useCallback:Zh,useContext:Ln,useEffect:mc,useImperativeHandle:Xh,useInsertionEffect:Jh,useLayoutEffect:Yh,useMemo:ep,useReducer:ll,useRef:Kh,useState:function(){return ll(Gs)},useDebugValue:gc,useDeferredValue:function(t){var e=$n();return Rt===null?e.memoizedState=t:tp(e,Rt.memoizedState,t)},useTransition:function(){var t=ll(Gs)[0],e=$n().memoizedState;return[t,e]},useMutableSource:Fh,useSyncExternalStore:zh,useId:np,unstable_isNewReconciler:!1};function zn(t,e){if(t&&t.defaultProps){e=mt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function ru(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:mt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var ka={isMounted:function(t){return(t=t._reactInternals)?po(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=tn(),o=Mr(t),s=hr(r,o);s.payload=e,n!=null&&(s.callback=n),e=$r(t,s,o),e!==null&&(Kn(e,t,o,r),$i(e,t,o))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=tn(),o=Mr(t),s=hr(r,o);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=$r(t,s,o),e!==null&&(Kn(e,t,o,r),$i(e,t,o))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=tn(),r=Mr(t),o=hr(n,r);o.tag=2,e!=null&&(o.callback=e),e=$r(t,o,r),e!==null&&(Kn(e,t,r,n),$i(e,t,r))}};function Sd(t,e,n,r,o,s,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,i):e.prototype&&e.prototype.isPureReactComponent?!Ms(n,r)||!Ms(o,s):!0}function ip(t,e,n){var r=!1,o=Fr,s=e.contextType;return typeof s=="object"&&s!==null?s=Ln(s):(o=vn(e)?so:Kt.current,r=e.contextTypes,s=(r=r!=null)?Wo(t,o):Fr),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ka,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=o,t.__reactInternalMemoizedMaskedChildContext=s),e}function _d(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&ka.enqueueReplaceState(e,e.state,null)}function ou(t,e,n,r){var o=t.stateNode;o.props=n,o.state=t.memoizedState,o.refs={},lc(t);var s=e.contextType;typeof s=="object"&&s!==null?o.context=Ln(s):(s=vn(e)?so:Kt.current,o.context=Wo(t,s)),o.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(ru(t,e,s,n),o.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(e=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),e!==o.state&&ka.enqueueReplaceState(o,o.state,null),oa(t,n,o,r),o.state=t.memoizedState),typeof o.componentDidMount=="function"&&(t.flags|=4194308)}function Ho(t,e){try{var n="",r=e;do n+=Fm(r),r=r.return;while(r);var o=n}catch(s){o=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:o,digest:null}}function ul(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function su(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var p0=typeof WeakMap=="function"?WeakMap:Map;function ap(t,e,n){n=hr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){ua||(ua=!0,mu=r),su(t,e)},n}function lp(t,e,n){n=hr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var o=e.value;n.payload=function(){return r(o)},n.callback=function(){su(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){su(t,e),typeof r!="function"&&(Ir===null?Ir=new Set([this]):Ir.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),n}function kd(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new p0;var o=new Set;r.set(e,o)}else o=r.get(e),o===void 0&&(o=new Set,r.set(e,o));o.has(n)||(o.add(n),t=R0.bind(null,t,e,n),e.then(t,t))}function Ed(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function jd(t,e,n,r,o){return t.mode&1?(t.flags|=65536,t.lanes=o,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=hr(-1,1),e.tag=2,$r(n,e,1))),n.lanes|=1),t)}var m0=xr.ReactCurrentOwner,gn=!1;function Xt(t,e,n,r){e.child=t===null?Ih(e,null,n,r):Go(e,t.child,n,r)}function Cd(t,e,n,r,o){n=n.render;var s=e.ref;return Uo(e,o),r=hc(t,e,n,r,s,o),n=pc(),t!==null&&!gn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~o,yr(t,e,o)):(ft&&n&&tc(e),e.flags|=1,Xt(t,e,r,o),e.child)}function Rd(t,e,n,r,o){if(t===null){var s=n.type;return typeof s=="function"&&!kc(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,up(t,e,s,r,o)):(t=zi(n.type,null,r,e,e.mode,o),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&o)){var i=s.memoizedProps;if(n=n.compare,n=n!==null?n:Ms,n(i,r)&&t.ref===e.ref)return yr(t,e,o)}return e.flags|=1,t=Br(s,r),t.ref=e.ref,t.return=e,e.child=t}function up(t,e,n,r,o){if(t!==null){var s=t.memoizedProps;if(Ms(s,r)&&t.ref===e.ref)if(gn=!1,e.pendingProps=r=s,(t.lanes&o)!==0)t.flags&131072&&(gn=!0);else return e.lanes=t.lanes,yr(t,e,o)}return iu(t,e,n,r,o)}function cp(t,e,n){var r=e.pendingProps,o=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},st(Lo,wn),wn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,st(Lo,wn),wn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,st(Lo,wn),wn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,st(Lo,wn),wn|=r;return Xt(t,e,o,n),e.child}function dp(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function iu(t,e,n,r,o){var s=vn(n)?so:Kt.current;return s=Wo(e,s),Uo(e,o),n=hc(t,e,n,r,s,o),r=pc(),t!==null&&!gn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~o,yr(t,e,o)):(ft&&r&&tc(e),e.flags|=1,Xt(t,e,n,o),e.child)}function Nd(t,e,n,r,o){if(vn(n)){var s=!0;Zi(e)}else s=!1;if(Uo(e,o),e.stateNode===null)Bi(t,e),ip(e,n,r),ou(e,n,r,o),r=!0;else if(t===null){var i=e.stateNode,l=e.memoizedProps;i.props=l;var u=i.context,c=n.contextType;typeof c=="object"&&c!==null?c=Ln(c):(c=vn(n)?so:Kt.current,c=Wo(e,c));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";h||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==r||u!==c)&&_d(e,i,r,c),jr=!1;var f=e.memoizedState;i.state=f,oa(e,r,i,o),u=e.memoizedState,l!==r||f!==u||yn.current||jr?(typeof d=="function"&&(ru(e,n,d,r),u=e.memoizedState),(l=jr||Sd(e,n,l,r,f,u,c))?(h||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),i.props=r,i.state=u,i.context=c,r=l):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{i=e.stateNode,Bh(t,e),l=e.memoizedProps,c=e.type===e.elementType?l:zn(e.type,l),i.props=c,h=e.pendingProps,f=i.context,u=n.contextType,typeof u=="object"&&u!==null?u=Ln(u):(u=vn(n)?so:Kt.current,u=Wo(e,u));var x=n.getDerivedStateFromProps;(d=typeof x=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==h||f!==u)&&_d(e,i,r,u),jr=!1,f=e.memoizedState,i.state=f,oa(e,r,i,o);var y=e.memoizedState;l!==h||f!==y||yn.current||jr?(typeof x=="function"&&(ru(e,n,x,r),y=e.memoizedState),(c=jr||Sd(e,n,c,r,f,y,u)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,y,u),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,y,u)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=y),i.props=r,i.state=y,i.context=u,r=c):(typeof i.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return au(t,e,n,r,s,o)}function au(t,e,n,r,o,s){dp(t,e);var i=(e.flags&128)!==0;if(!r&&!i)return o&&pd(e,n,!1),yr(t,e,s);r=e.stateNode,m0.current=e;var l=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&i?(e.child=Go(e,t.child,null,s),e.child=Go(e,null,l,s)):Xt(t,e,l,s),e.memoizedState=r.state,o&&pd(e,n,!0),e.child}function fp(t){var e=t.stateNode;e.pendingContext?hd(t,e.pendingContext,e.pendingContext!==e.context):e.context&&hd(t,e.context,!1),uc(t,e.containerInfo)}function Dd(t,e,n,r,o){return Vo(),rc(o),e.flags|=256,Xt(t,e,n,r),e.child}var lu={dehydrated:null,treeContext:null,retryLane:0};function uu(t){return{baseLanes:t,cachePool:null,transitions:null}}function hp(t,e,n){var r=e.pendingProps,o=ht.current,s=!1,i=(e.flags&128)!==0,l;if((l=i)||(l=t!==null&&t.memoizedState===null?!1:(o&2)!==0),l?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(o|=1),st(ht,o&1),t===null)return tu(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=r.children,t=r.fallback,s?(r=e.mode,s=e.child,i={mode:"hidden",children:i},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=Ca(i,r,0,null),t=oo(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=uu(n),e.memoizedState=lu,t):yc(e,i));if(o=t.memoizedState,o!==null&&(l=o.dehydrated,l!==null))return g0(t,e,i,r,l,o,n);if(s){s=r.fallback,i=e.mode,o=t.child,l=o.sibling;var u={mode:"hidden",children:r.children};return!(i&1)&&e.child!==o?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Br(o,u),r.subtreeFlags=o.subtreeFlags&14680064),l!==null?s=Br(l,s):(s=oo(s,i,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,i=t.child.memoizedState,i=i===null?uu(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=t.childLanes&~n,e.memoizedState=lu,r}return s=t.child,t=s.sibling,r=Br(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function yc(t,e){return e=Ca({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function vi(t,e,n,r){return r!==null&&rc(r),Go(e,t.child,null,n),t=yc(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function g0(t,e,n,r,o,s,i){if(n)return e.flags&256?(e.flags&=-257,r=ul(Error(U(422))),vi(t,e,i,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,o=e.mode,r=Ca({mode:"visible",children:r.children},o,0,null),s=oo(s,o,i,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Go(e,t.child,null,i),e.child.memoizedState=uu(i),e.memoizedState=lu,s);if(!(e.mode&1))return vi(t,e,i,null);if(o.data==="$!"){if(r=o.nextSibling&&o.nextSibling.dataset,r)var l=r.dgst;return r=l,s=Error(U(419)),r=ul(s,r,void 0),vi(t,e,i,r)}if(l=(i&t.childLanes)!==0,gn||l){if(r=It,r!==null){switch(i&-i){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(r.suspendedLanes|i)?0:o,o!==0&&o!==s.retryLane&&(s.retryLane=o,gr(t,o),Kn(r,t,o,-1))}return _c(),r=ul(Error(U(421))),vi(t,e,i,r)}return o.data==="$?"?(e.flags|=128,e.child=t.child,e=N0.bind(null,t),o._reactRetry=e,null):(t=s.treeContext,Sn=Lr(o.nextSibling),_n=e,ft=!0,Gn=null,t!==null&&(Dn[An++]=cr,Dn[An++]=dr,Dn[An++]=io,cr=t.id,dr=t.overflow,io=e),e=yc(e,r.children),e.flags|=4096,e)}function Ad(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),nu(t.return,e,n)}function cl(t,e,n,r,o){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=o)}function pp(t,e,n){var r=e.pendingProps,o=r.revealOrder,s=r.tail;if(Xt(t,e,r.children,n),r=ht.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Ad(t,n,e);else if(t.tag===19)Ad(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(st(ht,r),!(e.mode&1))e.memoizedState=null;else switch(o){case"forwards":for(n=e.child,o=null;n!==null;)t=n.alternate,t!==null&&sa(t)===null&&(o=n),n=n.sibling;n=o,n===null?(o=e.child,e.child=null):(o=n.sibling,n.sibling=null),cl(e,!1,o,n,s);break;case"backwards":for(n=null,o=e.child,e.child=null;o!==null;){if(t=o.alternate,t!==null&&sa(t)===null){e.child=o;break}t=o.sibling,o.sibling=n,n=o,o=t}cl(e,!0,n,null,s);break;case"together":cl(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Bi(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function yr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),lo|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(U(153));if(e.child!==null){for(t=e.child,n=Br(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Br(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function y0(t,e,n){switch(e.tag){case 3:fp(e),Vo();break;case 5:Uh(e);break;case 1:vn(e.type)&&Zi(e);break;case 4:uc(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,o=e.memoizedProps.value;st(na,r._currentValue),r._currentValue=o;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(st(ht,ht.current&1),e.flags|=128,null):n&e.child.childLanes?hp(t,e,n):(st(ht,ht.current&1),t=yr(t,e,n),t!==null?t.sibling:null);st(ht,ht.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return pp(t,e,n);e.flags|=128}if(o=e.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),st(ht,ht.current),r)break;return null;case 22:case 23:return e.lanes=0,cp(t,e,n)}return yr(t,e,n)}var mp,cu,gp,yp;mp=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};cu=function(){};gp=function(t,e,n,r){var o=t.memoizedProps;if(o!==r){t=e.stateNode,no(sr.current);var s=null;switch(n){case"input":o=Ol(t,o),r=Ol(t,r),s=[];break;case"select":o=mt({},o,{value:void 0}),r=mt({},r,{value:void 0}),s=[];break;case"textarea":o=Ll(t,o),r=Ll(t,r),s=[];break;default:typeof o.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Qi)}Il(n,r);var i;n=null;for(c in o)if(!r.hasOwnProperty(c)&&o.hasOwnProperty(c)&&o[c]!=null)if(c==="style"){var l=o[c];for(i in l)l.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(As.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var u=r[c];if(l=o!=null?o[c]:void 0,r.hasOwnProperty(c)&&u!==l&&(u!=null||l!=null))if(c==="style")if(l){for(i in l)!l.hasOwnProperty(i)||u&&u.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in u)u.hasOwnProperty(i)&&l[i]!==u[i]&&(n||(n={}),n[i]=u[i])}else n||(s||(s=[]),s.push(c,n)),n=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(s=s||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(s=s||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(As.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&lt("scroll",t),s||l===u||(s=[])):(s=s||[]).push(c,u))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};yp=function(t,e,n,r){n!==r&&(e.flags|=4)};function ls(t,e){if(!ft)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function qt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var o=t.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags&14680064,r|=o.flags&14680064,o.return=t,o=o.sibling;else for(o=t.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=t,o=o.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function v0(t,e,n){var r=e.pendingProps;switch(nc(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qt(e),null;case 1:return vn(e.type)&&Xi(),qt(e),null;case 3:return r=e.stateNode,qo(),ut(yn),ut(Kt),dc(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(gi(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Gn!==null&&(vu(Gn),Gn=null))),cu(t,e),qt(e),null;case 5:cc(e);var o=no(Ws.current);if(n=e.type,t!==null&&e.stateNode!=null)gp(t,e,n,r,o),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(U(166));return qt(e),null}if(t=no(sr.current),gi(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[nr]=e,r[Fs]=s,t=(e.mode&1)!==0,n){case"dialog":lt("cancel",r),lt("close",r);break;case"iframe":case"object":case"embed":lt("load",r);break;case"video":case"audio":for(o=0;o<ms.length;o++)lt(ms[o],r);break;case"source":lt("error",r);break;case"img":case"image":case"link":lt("error",r),lt("load",r);break;case"details":lt("toggle",r);break;case"input":Uc(r,s),lt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},lt("invalid",r);break;case"textarea":zc(r,s),lt("invalid",r)}Il(n,s),o=null;for(var i in s)if(s.hasOwnProperty(i)){var l=s[i];i==="children"?typeof l=="string"?r.textContent!==l&&(s.suppressHydrationWarning!==!0&&mi(r.textContent,l,t),o=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(s.suppressHydrationWarning!==!0&&mi(r.textContent,l,t),o=["children",""+l]):As.hasOwnProperty(i)&&l!=null&&i==="onScroll"&&lt("scroll",r)}switch(n){case"input":ai(r),Fc(r,s,!0);break;case"textarea":ai(r),Wc(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Qi)}r=o,e.updateQueue=r,r!==null&&(e.flags|=4)}else{i=o.nodeType===9?o:o.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Gf(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=i.createElement(n,{is:r.is}):(t=i.createElement(n),n==="select"&&(i=t,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):t=i.createElementNS(t,n),t[nr]=e,t[Fs]=r,mp(t,e,!1,!1),e.stateNode=t;e:{switch(i=Ml(n,r),n){case"dialog":lt("cancel",t),lt("close",t),o=r;break;case"iframe":case"object":case"embed":lt("load",t),o=r;break;case"video":case"audio":for(o=0;o<ms.length;o++)lt(ms[o],t);o=r;break;case"source":lt("error",t),o=r;break;case"img":case"image":case"link":lt("error",t),lt("load",t),o=r;break;case"details":lt("toggle",t),o=r;break;case"input":Uc(t,r),o=Ol(t,r),lt("invalid",t);break;case"option":o=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},o=mt({},r,{value:void 0}),lt("invalid",t);break;case"textarea":zc(t,r),o=Ll(t,r),lt("invalid",t);break;default:o=r}Il(n,o),l=o;for(s in l)if(l.hasOwnProperty(s)){var u=l[s];s==="style"?Kf(t,u):s==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&qf(t,u)):s==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Os(t,u):typeof u=="number"&&Os(t,""+u):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(As.hasOwnProperty(s)?u!=null&&s==="onScroll"&&lt("scroll",t):u!=null&&Fu(t,s,u,i))}switch(n){case"input":ai(t),Fc(t,r,!1);break;case"textarea":ai(t),Wc(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ur(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?$o(t,!!r.multiple,s,!1):r.defaultValue!=null&&$o(t,!!r.multiple,r.defaultValue,!0);break;default:typeof o.onClick=="function"&&(t.onclick=Qi)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return qt(e),null;case 6:if(t&&e.stateNode!=null)yp(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(U(166));if(n=no(Ws.current),no(sr.current),gi(e)){if(r=e.stateNode,n=e.memoizedProps,r[nr]=e,(s=r.nodeValue!==n)&&(t=_n,t!==null))switch(t.tag){case 3:mi(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&mi(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[nr]=e,e.stateNode=r}return qt(e),null;case 13:if(ut(ht),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ft&&Sn!==null&&e.mode&1&&!(e.flags&128))Lh(),Vo(),e.flags|=98560,s=!1;else if(s=gi(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(U(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(U(317));s[nr]=e}else Vo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;qt(e),s=!1}else Gn!==null&&(vu(Gn),Gn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ht.current&1?Nt===0&&(Nt=3):_c())),e.updateQueue!==null&&(e.flags|=4),qt(e),null);case 4:return qo(),cu(t,e),t===null&&Bs(e.stateNode.containerInfo),qt(e),null;case 10:return ic(e.type._context),qt(e),null;case 17:return vn(e.type)&&Xi(),qt(e),null;case 19:if(ut(ht),s=e.memoizedState,s===null)return qt(e),null;if(r=(e.flags&128)!==0,i=s.rendering,i===null)if(r)ls(s,!1);else{if(Nt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=sa(t),i!==null){for(e.flags|=128,ls(s,!1),r=i.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,t=i.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return st(ht,ht.current&1|2),e.child}t=t.sibling}s.tail!==null&&wt()>Ko&&(e.flags|=128,r=!0,ls(s,!1),e.lanes=4194304)}else{if(!r)if(t=sa(i),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ls(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!ft)return qt(e),null}else 2*wt()-s.renderingStartTime>Ko&&n!==1073741824&&(e.flags|=128,r=!0,ls(s,!1),e.lanes=4194304);s.isBackwards?(i.sibling=e.child,e.child=i):(n=s.last,n!==null?n.sibling=i:e.child=i,s.last=i)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=wt(),e.sibling=null,n=ht.current,st(ht,r?n&1|2:n&1),e):(qt(e),null);case 22:case 23:return Sc(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?wn&1073741824&&(qt(e),e.subtreeFlags&6&&(e.flags|=8192)):qt(e),null;case 24:return null;case 25:return null}throw Error(U(156,e.tag))}function x0(t,e){switch(nc(e),e.tag){case 1:return vn(e.type)&&Xi(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return qo(),ut(yn),ut(Kt),dc(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return cc(e),null;case 13:if(ut(ht),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(U(340));Vo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return ut(ht),null;case 4:return qo(),null;case 10:return ic(e.type._context),null;case 22:case 23:return Sc(),null;case 24:return null;default:return null}}var xi=!1,Ht=!1,b0=typeof WeakSet=="function"?WeakSet:Set,ee=null;function Po(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){vt(t,e,r)}else n.current=null}function du(t,e,n){try{n()}catch(r){vt(t,e,r)}}var Od=!1;function w0(t,e){if(Kl=Ki,t=Sh(),ec(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var o=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var i=0,l=-1,u=-1,c=0,d=0,h=t,f=null;t:for(;;){for(var x;h!==n||o!==0&&h.nodeType!==3||(l=i+o),h!==s||r!==0&&h.nodeType!==3||(u=i+r),h.nodeType===3&&(i+=h.nodeValue.length),(x=h.firstChild)!==null;)f=h,h=x;for(;;){if(h===t)break t;if(f===n&&++c===o&&(l=i),f===s&&++d===r&&(u=i),(x=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=x}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Jl={focusedElem:t,selectionRange:n},Ki=!1,ee=e;ee!==null;)if(e=ee,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ee=t;else for(;ee!==null;){e=ee;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var b=y.memoizedProps,_=y.memoizedState,p=e.stateNode,m=p.getSnapshotBeforeUpdate(e.elementType===e.type?b:zn(e.type,b),_);p.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var g=e.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(U(163))}}catch(w){vt(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,ee=t;break}ee=e.return}return y=Od,Od=!1,y}function _s(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&t)===t){var s=o.destroy;o.destroy=void 0,s!==void 0&&du(e,n,s)}o=o.next}while(o!==r)}}function Ea(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function fu(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function vp(t){var e=t.alternate;e!==null&&(t.alternate=null,vp(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[nr],delete e[Fs],delete e[Xl],delete e[r0],delete e[o0])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function xp(t){return t.tag===5||t.tag===3||t.tag===4}function Td(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||xp(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function hu(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Qi));else if(r!==4&&(t=t.child,t!==null))for(hu(t,e,n),t=t.sibling;t!==null;)hu(t,e,n),t=t.sibling}function pu(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(pu(t,e,n),t=t.sibling;t!==null;)pu(t,e,n),t=t.sibling}var Ut=null,Wn=!1;function wr(t,e,n){for(n=n.child;n!==null;)bp(t,e,n),n=n.sibling}function bp(t,e,n){if(or&&typeof or.onCommitFiberUnmount=="function")try{or.onCommitFiberUnmount(ya,n)}catch{}switch(n.tag){case 5:Ht||Po(n,e);case 6:var r=Ut,o=Wn;Ut=null,wr(t,e,n),Ut=r,Wn=o,Ut!==null&&(Wn?(t=Ut,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ut.removeChild(n.stateNode));break;case 18:Ut!==null&&(Wn?(t=Ut,n=n.stateNode,t.nodeType===8?rl(t.parentNode,n):t.nodeType===1&&rl(t,n),$s(t)):rl(Ut,n.stateNode));break;case 4:r=Ut,o=Wn,Ut=n.stateNode.containerInfo,Wn=!0,wr(t,e,n),Ut=r,Wn=o;break;case 0:case 11:case 14:case 15:if(!Ht&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){o=r=r.next;do{var s=o,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&du(n,e,i),o=o.next}while(o!==r)}wr(t,e,n);break;case 1:if(!Ht&&(Po(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){vt(n,e,l)}wr(t,e,n);break;case 21:wr(t,e,n);break;case 22:n.mode&1?(Ht=(r=Ht)||n.memoizedState!==null,wr(t,e,n),Ht=r):wr(t,e,n);break;default:wr(t,e,n)}}function Pd(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new b0),e.forEach(function(r){var o=D0.bind(null,t,r);n.has(r)||(n.add(r),r.then(o,o))})}}function Un(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var o=n[r];try{var s=t,i=e,l=i;e:for(;l!==null;){switch(l.tag){case 5:Ut=l.stateNode,Wn=!1;break e;case 3:Ut=l.stateNode.containerInfo,Wn=!0;break e;case 4:Ut=l.stateNode.containerInfo,Wn=!0;break e}l=l.return}if(Ut===null)throw Error(U(160));bp(s,i,o),Ut=null,Wn=!1;var u=o.alternate;u!==null&&(u.return=null),o.return=null}catch(c){vt(o,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)wp(e,t),e=e.sibling}function wp(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Un(e,t),Xn(t),r&4){try{_s(3,t,t.return),Ea(3,t)}catch(b){vt(t,t.return,b)}try{_s(5,t,t.return)}catch(b){vt(t,t.return,b)}}break;case 1:Un(e,t),Xn(t),r&512&&n!==null&&Po(n,n.return);break;case 5:if(Un(e,t),Xn(t),r&512&&n!==null&&Po(n,n.return),t.flags&32){var o=t.stateNode;try{Os(o,"")}catch(b){vt(t,t.return,b)}}if(r&4&&(o=t.stateNode,o!=null)){var s=t.memoizedProps,i=n!==null?n.memoizedProps:s,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&s.type==="radio"&&s.name!=null&&Wf(o,s),Ml(l,i);var c=Ml(l,s);for(i=0;i<u.length;i+=2){var d=u[i],h=u[i+1];d==="style"?Kf(o,h):d==="dangerouslySetInnerHTML"?qf(o,h):d==="children"?Os(o,h):Fu(o,d,h,c)}switch(l){case"input":Tl(o,s);break;case"textarea":Vf(o,s);break;case"select":var f=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!s.multiple;var x=s.value;x!=null?$o(o,!!s.multiple,x,!1):f!==!!s.multiple&&(s.defaultValue!=null?$o(o,!!s.multiple,s.defaultValue,!0):$o(o,!!s.multiple,s.multiple?[]:"",!1))}o[Fs]=s}catch(b){vt(t,t.return,b)}}break;case 6:if(Un(e,t),Xn(t),r&4){if(t.stateNode===null)throw Error(U(162));o=t.stateNode,s=t.memoizedProps;try{o.nodeValue=s}catch(b){vt(t,t.return,b)}}break;case 3:if(Un(e,t),Xn(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{$s(e.containerInfo)}catch(b){vt(t,t.return,b)}break;case 4:Un(e,t),Xn(t);break;case 13:Un(e,t),Xn(t),o=t.child,o.flags&8192&&(s=o.memoizedState!==null,o.stateNode.isHidden=s,!s||o.alternate!==null&&o.alternate.memoizedState!==null||(bc=wt())),r&4&&Pd(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(Ht=(c=Ht)||d,Un(e,t),Ht=c):Un(e,t),Xn(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!d&&t.mode&1)for(ee=t,d=t.child;d!==null;){for(h=ee=d;ee!==null;){switch(f=ee,x=f.child,f.tag){case 0:case 11:case 14:case 15:_s(4,f,f.return);break;case 1:Po(f,f.return);var y=f.stateNode;if(typeof y.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(b){vt(r,n,b)}}break;case 5:Po(f,f.return);break;case 22:if(f.memoizedState!==null){$d(h);continue}}x!==null?(x.return=f,ee=x):$d(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{o=h.stateNode,c?(s=o.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(l=h.stateNode,u=h.memoizedProps.style,i=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=Hf("display",i))}catch(b){vt(t,t.return,b)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(b){vt(t,t.return,b)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Un(e,t),Xn(t),r&4&&Pd(t);break;case 21:break;default:Un(e,t),Xn(t)}}function Xn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(xp(n)){var r=n;break e}n=n.return}throw Error(U(160))}switch(r.tag){case 5:var o=r.stateNode;r.flags&32&&(Os(o,""),r.flags&=-33);var s=Td(t);pu(t,s,o);break;case 3:case 4:var i=r.stateNode.containerInfo,l=Td(t);hu(t,l,i);break;default:throw Error(U(161))}}catch(u){vt(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function S0(t,e,n){ee=t,Sp(t)}function Sp(t,e,n){for(var r=(t.mode&1)!==0;ee!==null;){var o=ee,s=o.child;if(o.tag===22&&r){var i=o.memoizedState!==null||xi;if(!i){var l=o.alternate,u=l!==null&&l.memoizedState!==null||Ht;l=xi;var c=Ht;if(xi=i,(Ht=u)&&!c)for(ee=o;ee!==null;)i=ee,u=i.child,i.tag===22&&i.memoizedState!==null?Id(o):u!==null?(u.return=i,ee=u):Id(o);for(;s!==null;)ee=s,Sp(s),s=s.sibling;ee=o,xi=l,Ht=c}Ld(t)}else o.subtreeFlags&8772&&s!==null?(s.return=o,ee=s):Ld(t)}}function Ld(t){for(;ee!==null;){var e=ee;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ht||Ea(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ht)if(n===null)r.componentDidMount();else{var o=e.elementType===e.type?n.memoizedProps:zn(e.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&xd(e,s,r);break;case 3:var i=e.updateQueue;if(i!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}xd(e,i,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&$s(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(U(163))}Ht||e.flags&512&&fu(e)}catch(f){vt(e,e.return,f)}}if(e===t){ee=null;break}if(n=e.sibling,n!==null){n.return=e.return,ee=n;break}ee=e.return}}function $d(t){for(;ee!==null;){var e=ee;if(e===t){ee=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ee=n;break}ee=e.return}}function Id(t){for(;ee!==null;){var e=ee;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Ea(4,e)}catch(u){vt(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var o=e.return;try{r.componentDidMount()}catch(u){vt(e,o,u)}}var s=e.return;try{fu(e)}catch(u){vt(e,s,u)}break;case 5:var i=e.return;try{fu(e)}catch(u){vt(e,i,u)}}}catch(u){vt(e,e.return,u)}if(e===t){ee=null;break}var l=e.sibling;if(l!==null){l.return=e.return,ee=l;break}ee=e.return}}var _0=Math.ceil,la=xr.ReactCurrentDispatcher,vc=xr.ReactCurrentOwner,Tn=xr.ReactCurrentBatchConfig,Ge=0,It=null,kt=null,Ft=0,wn=0,Lo=Wr(0),Nt=0,Hs=null,lo=0,ja=0,xc=0,ks=null,pn=null,bc=0,Ko=1/0,ar=null,ua=!1,mu=null,Ir=null,bi=!1,Ar=null,ca=0,Es=0,gu=null,Ui=-1,Fi=0;function tn(){return Ge&6?wt():Ui!==-1?Ui:Ui=wt()}function Mr(t){return t.mode&1?Ge&2&&Ft!==0?Ft&-Ft:i0.transition!==null?(Fi===0&&(Fi=ih()),Fi):(t=Ze,t!==0||(t=window.event,t=t===void 0?16:hh(t.type)),t):1}function Kn(t,e,n,r){if(50<Es)throw Es=0,gu=null,Error(U(185));Qs(t,n,r),(!(Ge&2)||t!==It)&&(t===It&&(!(Ge&2)&&(ja|=n),Nt===4&&Rr(t,Ft)),xn(t,r),n===1&&Ge===0&&!(e.mode&1)&&(Ko=wt()+500,Sa&&Vr()))}function xn(t,e){var n=t.callbackNode;ig(t,e);var r=Hi(t,t===It?Ft:0);if(r===0)n!==null&&qc(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&qc(n),e===1)t.tag===0?s0(Md.bind(null,t)):Oh(Md.bind(null,t)),t0(function(){!(Ge&6)&&Vr()}),n=null;else{switch(ah(r)){case 1:n=qu;break;case 4:n=oh;break;case 16:n=qi;break;case 536870912:n=sh;break;default:n=qi}n=Dp(n,_p.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function _p(t,e){if(Ui=-1,Fi=0,Ge&6)throw Error(U(327));var n=t.callbackNode;if(Fo()&&t.callbackNode!==n)return null;var r=Hi(t,t===It?Ft:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=da(t,r);else{e=r;var o=Ge;Ge|=2;var s=Ep();(It!==t||Ft!==e)&&(ar=null,Ko=wt()+500,ro(t,e));do try{j0();break}catch(l){kp(t,l)}while(!0);sc(),la.current=s,Ge=o,kt!==null?e=0:(It=null,Ft=0,e=Nt)}if(e!==0){if(e===2&&(o=Wl(t),o!==0&&(r=o,e=yu(t,o))),e===1)throw n=Hs,ro(t,0),Rr(t,r),xn(t,wt()),n;if(e===6)Rr(t,r);else{if(o=t.current.alternate,!(r&30)&&!k0(o)&&(e=da(t,r),e===2&&(s=Wl(t),s!==0&&(r=s,e=yu(t,s))),e===1))throw n=Hs,ro(t,0),Rr(t,r),xn(t,wt()),n;switch(t.finishedWork=o,t.finishedLanes=r,e){case 0:case 1:throw Error(U(345));case 2:Qr(t,pn,ar);break;case 3:if(Rr(t,r),(r&130023424)===r&&(e=bc+500-wt(),10<e)){if(Hi(t,0)!==0)break;if(o=t.suspendedLanes,(o&r)!==r){tn(),t.pingedLanes|=t.suspendedLanes&o;break}t.timeoutHandle=Ql(Qr.bind(null,t,pn,ar),e);break}Qr(t,pn,ar);break;case 4:if(Rr(t,r),(r&4194240)===r)break;for(e=t.eventTimes,o=-1;0<r;){var i=31-Hn(r);s=1<<i,i=e[i],i>o&&(o=i),r&=~s}if(r=o,r=wt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*_0(r/1960))-r,10<r){t.timeoutHandle=Ql(Qr.bind(null,t,pn,ar),r);break}Qr(t,pn,ar);break;case 5:Qr(t,pn,ar);break;default:throw Error(U(329))}}}return xn(t,wt()),t.callbackNode===n?_p.bind(null,t):null}function yu(t,e){var n=ks;return t.current.memoizedState.isDehydrated&&(ro(t,e).flags|=256),t=da(t,e),t!==2&&(e=pn,pn=n,e!==null&&vu(e)),t}function vu(t){pn===null?pn=t:pn.push.apply(pn,t)}function k0(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var o=n[r],s=o.getSnapshot;o=o.value;try{if(!Jn(s(),o))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Rr(t,e){for(e&=~xc,e&=~ja,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Hn(e),r=1<<n;t[n]=-1,e&=~r}}function Md(t){if(Ge&6)throw Error(U(327));Fo();var e=Hi(t,0);if(!(e&1))return xn(t,wt()),null;var n=da(t,e);if(t.tag!==0&&n===2){var r=Wl(t);r!==0&&(e=r,n=yu(t,r))}if(n===1)throw n=Hs,ro(t,0),Rr(t,e),xn(t,wt()),n;if(n===6)throw Error(U(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Qr(t,pn,ar),xn(t,wt()),null}function wc(t,e){var n=Ge;Ge|=1;try{return t(e)}finally{Ge=n,Ge===0&&(Ko=wt()+500,Sa&&Vr())}}function uo(t){Ar!==null&&Ar.tag===0&&!(Ge&6)&&Fo();var e=Ge;Ge|=1;var n=Tn.transition,r=Ze;try{if(Tn.transition=null,Ze=1,t)return t()}finally{Ze=r,Tn.transition=n,Ge=e,!(Ge&6)&&Vr()}}function Sc(){wn=Lo.current,ut(Lo)}function ro(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,e0(n)),kt!==null)for(n=kt.return;n!==null;){var r=n;switch(nc(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Xi();break;case 3:qo(),ut(yn),ut(Kt),dc();break;case 5:cc(r);break;case 4:qo();break;case 13:ut(ht);break;case 19:ut(ht);break;case 10:ic(r.type._context);break;case 22:case 23:Sc()}n=n.return}if(It=t,kt=t=Br(t.current,null),Ft=wn=e,Nt=0,Hs=null,xc=ja=lo=0,pn=ks=null,to!==null){for(e=0;e<to.length;e++)if(n=to[e],r=n.interleaved,r!==null){n.interleaved=null;var o=r.next,s=n.pending;if(s!==null){var i=s.next;s.next=o,r.next=i}n.pending=r}to=null}return t}function kp(t,e){do{var n=kt;try{if(sc(),Ii.current=aa,ia){for(var r=pt.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}ia=!1}if(ao=0,$t=Rt=pt=null,Ss=!1,Vs=0,vc.current=null,n===null||n.return===null){Nt=1,Hs=e,kt=null;break}e:{var s=t,i=n.return,l=n,u=e;if(e=Ft,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var x=Ed(i);if(x!==null){x.flags&=-257,jd(x,i,l,s,e),x.mode&1&&kd(s,c,e),e=x,u=c;var y=e.updateQueue;if(y===null){var b=new Set;b.add(u),e.updateQueue=b}else y.add(u);break e}else{if(!(e&1)){kd(s,c,e),_c();break e}u=Error(U(426))}}else if(ft&&l.mode&1){var _=Ed(i);if(_!==null){!(_.flags&65536)&&(_.flags|=256),jd(_,i,l,s,e),rc(Ho(u,l));break e}}s=u=Ho(u,l),Nt!==4&&(Nt=2),ks===null?ks=[s]:ks.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var p=ap(s,u,e);vd(s,p);break e;case 1:l=u;var m=s.type,g=s.stateNode;if(!(s.flags&128)&&(typeof m.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(Ir===null||!Ir.has(g)))){s.flags|=65536,e&=-e,s.lanes|=e;var w=lp(s,l,e);vd(s,w);break e}}s=s.return}while(s!==null)}Cp(n)}catch(j){e=j,kt===n&&n!==null&&(kt=n=n.return);continue}break}while(!0)}function Ep(){var t=la.current;return la.current=aa,t===null?aa:t}function _c(){(Nt===0||Nt===3||Nt===2)&&(Nt=4),It===null||!(lo&268435455)&&!(ja&268435455)||Rr(It,Ft)}function da(t,e){var n=Ge;Ge|=2;var r=Ep();(It!==t||Ft!==e)&&(ar=null,ro(t,e));do try{E0();break}catch(o){kp(t,o)}while(!0);if(sc(),Ge=n,la.current=r,kt!==null)throw Error(U(261));return It=null,Ft=0,Nt}function E0(){for(;kt!==null;)jp(kt)}function j0(){for(;kt!==null&&!Qm();)jp(kt)}function jp(t){var e=Np(t.alternate,t,wn);t.memoizedProps=t.pendingProps,e===null?Cp(t):kt=e,vc.current=null}function Cp(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=x0(n,e),n!==null){n.flags&=32767,kt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Nt=6,kt=null;return}}else if(n=v0(n,e,wn),n!==null){kt=n;return}if(e=e.sibling,e!==null){kt=e;return}kt=e=t}while(e!==null);Nt===0&&(Nt=5)}function Qr(t,e,n){var r=Ze,o=Tn.transition;try{Tn.transition=null,Ze=1,C0(t,e,n,r)}finally{Tn.transition=o,Ze=r}return null}function C0(t,e,n,r){do Fo();while(Ar!==null);if(Ge&6)throw Error(U(327));n=t.finishedWork;var o=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(U(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(ag(t,s),t===It&&(kt=It=null,Ft=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||bi||(bi=!0,Dp(qi,function(){return Fo(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Tn.transition,Tn.transition=null;var i=Ze;Ze=1;var l=Ge;Ge|=4,vc.current=null,w0(t,n),wp(n,t),Hg(Jl),Ki=!!Kl,Jl=Kl=null,t.current=n,S0(n),Xm(),Ge=l,Ze=i,Tn.transition=s}else t.current=n;if(bi&&(bi=!1,Ar=t,ca=o),s=t.pendingLanes,s===0&&(Ir=null),tg(n.stateNode),xn(t,wt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)o=e[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(ua)throw ua=!1,t=mu,mu=null,t;return ca&1&&t.tag!==0&&Fo(),s=t.pendingLanes,s&1?t===gu?Es++:(Es=0,gu=t):Es=0,Vr(),null}function Fo(){if(Ar!==null){var t=ah(ca),e=Tn.transition,n=Ze;try{if(Tn.transition=null,Ze=16>t?16:t,Ar===null)var r=!1;else{if(t=Ar,Ar=null,ca=0,Ge&6)throw Error(U(331));var o=Ge;for(Ge|=4,ee=t.current;ee!==null;){var s=ee,i=s.child;if(ee.flags&16){var l=s.deletions;if(l!==null){for(var u=0;u<l.length;u++){var c=l[u];for(ee=c;ee!==null;){var d=ee;switch(d.tag){case 0:case 11:case 15:_s(8,d,s)}var h=d.child;if(h!==null)h.return=d,ee=h;else for(;ee!==null;){d=ee;var f=d.sibling,x=d.return;if(vp(d),d===c){ee=null;break}if(f!==null){f.return=x,ee=f;break}ee=x}}}var y=s.alternate;if(y!==null){var b=y.child;if(b!==null){y.child=null;do{var _=b.sibling;b.sibling=null,b=_}while(b!==null)}}ee=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,ee=i;else e:for(;ee!==null;){if(s=ee,s.flags&2048)switch(s.tag){case 0:case 11:case 15:_s(9,s,s.return)}var p=s.sibling;if(p!==null){p.return=s.return,ee=p;break e}ee=s.return}}var m=t.current;for(ee=m;ee!==null;){i=ee;var g=i.child;if(i.subtreeFlags&2064&&g!==null)g.return=i,ee=g;else e:for(i=m;ee!==null;){if(l=ee,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Ea(9,l)}}catch(j){vt(l,l.return,j)}if(l===i){ee=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,ee=w;break e}ee=l.return}}if(Ge=o,Vr(),or&&typeof or.onPostCommitFiberRoot=="function")try{or.onPostCommitFiberRoot(ya,t)}catch{}r=!0}return r}finally{Ze=n,Tn.transition=e}}return!1}function Bd(t,e,n){e=Ho(n,e),e=ap(t,e,1),t=$r(t,e,1),e=tn(),t!==null&&(Qs(t,1,e),xn(t,e))}function vt(t,e,n){if(t.tag===3)Bd(t,t,n);else for(;e!==null;){if(e.tag===3){Bd(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ir===null||!Ir.has(r))){t=Ho(n,t),t=lp(e,t,1),e=$r(e,t,1),t=tn(),e!==null&&(Qs(e,1,t),xn(e,t));break}}e=e.return}}function R0(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=tn(),t.pingedLanes|=t.suspendedLanes&n,It===t&&(Ft&n)===n&&(Nt===4||Nt===3&&(Ft&130023424)===Ft&&500>wt()-bc?ro(t,0):xc|=n),xn(t,e)}function Rp(t,e){e===0&&(t.mode&1?(e=ci,ci<<=1,!(ci&130023424)&&(ci=4194304)):e=1);var n=tn();t=gr(t,e),t!==null&&(Qs(t,e,n),xn(t,n))}function N0(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Rp(t,n)}function D0(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,o=t.memoizedState;o!==null&&(n=o.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(U(314))}r!==null&&r.delete(e),Rp(t,n)}var Np;Np=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||yn.current)gn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return gn=!1,y0(t,e,n);gn=!!(t.flags&131072)}else gn=!1,ft&&e.flags&1048576&&Th(e,ta,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Bi(t,e),t=e.pendingProps;var o=Wo(e,Kt.current);Uo(e,n),o=hc(null,e,r,t,o,n);var s=pc();return e.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,vn(r)?(s=!0,Zi(e)):s=!1,e.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,lc(e),o.updater=ka,e.stateNode=o,o._reactInternals=e,ou(e,r,t,n),e=au(null,e,r,!0,s,n)):(e.tag=0,ft&&s&&tc(e),Xt(null,e,o,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Bi(t,e),t=e.pendingProps,o=r._init,r=o(r._payload),e.type=r,o=e.tag=O0(r),t=zn(r,t),o){case 0:e=iu(null,e,r,t,n);break e;case 1:e=Nd(null,e,r,t,n);break e;case 11:e=Cd(null,e,r,t,n);break e;case 14:e=Rd(null,e,r,zn(r.type,t),n);break e}throw Error(U(306,r,""))}return e;case 0:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:zn(r,o),iu(t,e,r,o,n);case 1:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:zn(r,o),Nd(t,e,r,o,n);case 3:e:{if(fp(e),t===null)throw Error(U(387));r=e.pendingProps,s=e.memoizedState,o=s.element,Bh(t,e),oa(e,r,null,n);var i=e.memoizedState;if(r=i.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){o=Ho(Error(U(423)),e),e=Dd(t,e,r,n,o);break e}else if(r!==o){o=Ho(Error(U(424)),e),e=Dd(t,e,r,n,o);break e}else for(Sn=Lr(e.stateNode.containerInfo.firstChild),_n=e,ft=!0,Gn=null,n=Ih(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Vo(),r===o){e=yr(t,e,n);break e}Xt(t,e,r,n)}e=e.child}return e;case 5:return Uh(e),t===null&&tu(e),r=e.type,o=e.pendingProps,s=t!==null?t.memoizedProps:null,i=o.children,Yl(r,o)?i=null:s!==null&&Yl(r,s)&&(e.flags|=32),dp(t,e),Xt(t,e,i,n),e.child;case 6:return t===null&&tu(e),null;case 13:return hp(t,e,n);case 4:return uc(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Go(e,null,r,n):Xt(t,e,r,n),e.child;case 11:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:zn(r,o),Cd(t,e,r,o,n);case 7:return Xt(t,e,e.pendingProps,n),e.child;case 8:return Xt(t,e,e.pendingProps.children,n),e.child;case 12:return Xt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,o=e.pendingProps,s=e.memoizedProps,i=o.value,st(na,r._currentValue),r._currentValue=i,s!==null)if(Jn(s.value,i)){if(s.children===o.children&&!yn.current){e=yr(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var l=s.dependencies;if(l!==null){i=s.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(s.tag===1){u=hr(-1,n&-n),u.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}s.lanes|=n,u=s.alternate,u!==null&&(u.lanes|=n),nu(s.return,n,e),l.lanes|=n;break}u=u.next}}else if(s.tag===10)i=s.type===e.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(U(341));i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),nu(i,n,e),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===e){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}Xt(t,e,o.children,n),e=e.child}return e;case 9:return o=e.type,r=e.pendingProps.children,Uo(e,n),o=Ln(o),r=r(o),e.flags|=1,Xt(t,e,r,n),e.child;case 14:return r=e.type,o=zn(r,e.pendingProps),o=zn(r.type,o),Rd(t,e,r,o,n);case 15:return up(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:zn(r,o),Bi(t,e),e.tag=1,vn(r)?(t=!0,Zi(e)):t=!1,Uo(e,n),ip(e,r,o),ou(e,r,o,n),au(null,e,r,!0,t,n);case 19:return pp(t,e,n);case 22:return cp(t,e,n)}throw Error(U(156,e.tag))};function Dp(t,e){return rh(t,e)}function A0(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function On(t,e,n,r){return new A0(t,e,n,r)}function kc(t){return t=t.prototype,!(!t||!t.isReactComponent)}function O0(t){if(typeof t=="function")return kc(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Wu)return 11;if(t===Vu)return 14}return 2}function Br(t,e){var n=t.alternate;return n===null?(n=On(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function zi(t,e,n,r,o,s){var i=2;if(r=t,typeof t=="function")kc(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case Eo:return oo(n.children,o,s,e);case zu:i=8,o|=8;break;case Rl:return t=On(12,n,e,o|2),t.elementType=Rl,t.lanes=s,t;case Nl:return t=On(13,n,e,o),t.elementType=Nl,t.lanes=s,t;case Dl:return t=On(19,n,e,o),t.elementType=Dl,t.lanes=s,t;case Uf:return Ca(n,o,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Mf:i=10;break e;case Bf:i=9;break e;case Wu:i=11;break e;case Vu:i=14;break e;case Er:i=16,r=null;break e}throw Error(U(130,t==null?t:typeof t,""))}return e=On(i,n,e,o),e.elementType=t,e.type=r,e.lanes=s,e}function oo(t,e,n,r){return t=On(7,t,r,e),t.lanes=n,t}function Ca(t,e,n,r){return t=On(22,t,r,e),t.elementType=Uf,t.lanes=n,t.stateNode={isHidden:!1},t}function dl(t,e,n){return t=On(6,t,null,e),t.lanes=n,t}function fl(t,e,n){return e=On(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function T0(t,e,n,r,o){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=qa(0),this.expirationTimes=qa(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qa(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Ec(t,e,n,r,o,s,i,l,u){return t=new T0(t,e,n,l,u),e===1?(e=1,s===!0&&(e|=8)):e=0,s=On(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},lc(s),t}function P0(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ko,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Ap(t){if(!t)return Fr;t=t._reactInternals;e:{if(po(t)!==t||t.tag!==1)throw Error(U(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(vn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(U(171))}if(t.tag===1){var n=t.type;if(vn(n))return Ah(t,n,e)}return e}function Op(t,e,n,r,o,s,i,l,u){return t=Ec(n,r,!0,t,o,s,i,l,u),t.context=Ap(null),n=t.current,r=tn(),o=Mr(n),s=hr(r,o),s.callback=e??null,$r(n,s,o),t.current.lanes=o,Qs(t,o,r),xn(t,r),t}function Ra(t,e,n,r){var o=e.current,s=tn(),i=Mr(o);return n=Ap(n),e.context===null?e.context=n:e.pendingContext=n,e=hr(s,i),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=$r(o,e,i),t!==null&&(Kn(t,o,i,s),$i(t,o,i)),i}function fa(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Ud(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function jc(t,e){Ud(t,e),(t=t.alternate)&&Ud(t,e)}function L0(){return null}var Tp=typeof reportError=="function"?reportError:function(t){console.error(t)};function Cc(t){this._internalRoot=t}Na.prototype.render=Cc.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(U(409));Ra(t,e,null,null)};Na.prototype.unmount=Cc.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;uo(function(){Ra(null,t,null,null)}),e[mr]=null}};function Na(t){this._internalRoot=t}Na.prototype.unstable_scheduleHydration=function(t){if(t){var e=ch();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Cr.length&&e!==0&&e<Cr[n].priority;n++);Cr.splice(n,0,t),n===0&&fh(t)}};function Rc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Da(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Fd(){}function $0(t,e,n,r,o){if(o){if(typeof r=="function"){var s=r;r=function(){var c=fa(i);s.call(c)}}var i=Op(e,r,t,0,null,!1,!1,"",Fd);return t._reactRootContainer=i,t[mr]=i.current,Bs(t.nodeType===8?t.parentNode:t),uo(),i}for(;o=t.lastChild;)t.removeChild(o);if(typeof r=="function"){var l=r;r=function(){var c=fa(u);l.call(c)}}var u=Ec(t,0,!1,null,null,!1,!1,"",Fd);return t._reactRootContainer=u,t[mr]=u.current,Bs(t.nodeType===8?t.parentNode:t),uo(function(){Ra(e,u,n,r)}),u}function Aa(t,e,n,r,o){var s=n._reactRootContainer;if(s){var i=s;if(typeof o=="function"){var l=o;o=function(){var u=fa(i);l.call(u)}}Ra(e,i,t,o)}else i=$0(n,e,t,o,r);return fa(i)}lh=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ps(e.pendingLanes);n!==0&&(Hu(e,n|1),xn(e,wt()),!(Ge&6)&&(Ko=wt()+500,Vr()))}break;case 13:uo(function(){var r=gr(t,1);if(r!==null){var o=tn();Kn(r,t,1,o)}}),jc(t,1)}};Ku=function(t){if(t.tag===13){var e=gr(t,134217728);if(e!==null){var n=tn();Kn(e,t,134217728,n)}jc(t,134217728)}};uh=function(t){if(t.tag===13){var e=Mr(t),n=gr(t,e);if(n!==null){var r=tn();Kn(n,t,e,r)}jc(t,e)}};ch=function(){return Ze};dh=function(t,e){var n=Ze;try{return Ze=t,e()}finally{Ze=n}};Ul=function(t,e,n){switch(e){case"input":if(Tl(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var o=wa(r);if(!o)throw Error(U(90));zf(r),Tl(r,o)}}}break;case"textarea":Vf(t,n);break;case"select":e=n.value,e!=null&&$o(t,!!n.multiple,e,!1)}};Qf=wc;Xf=uo;var I0={usingClientEntryPoint:!1,Events:[Zs,No,wa,Jf,Yf,wc]},us={findFiberByHostInstance:eo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},M0={bundleType:us.bundleType,version:us.version,rendererPackageName:us.rendererPackageName,rendererConfig:us.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:xr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=th(t),t===null?null:t.stateNode},findFiberByHostInstance:us.findFiberByHostInstance||L0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wi=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wi.isDisabled&&wi.supportsFiber)try{ya=wi.inject(M0),or=wi}catch{}}En.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=I0;En.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Rc(e))throw Error(U(200));return P0(t,e,null,n)};En.createRoot=function(t,e){if(!Rc(t))throw Error(U(299));var n=!1,r="",o=Tp;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(o=e.onRecoverableError)),e=Ec(t,1,!1,null,null,n,!1,r,o),t[mr]=e.current,Bs(t.nodeType===8?t.parentNode:t),new Cc(e)};En.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(U(188)):(t=Object.keys(t).join(","),Error(U(268,t)));return t=th(e),t=t===null?null:t.stateNode,t};En.flushSync=function(t){return uo(t)};En.hydrate=function(t,e,n){if(!Da(e))throw Error(U(200));return Aa(null,t,e,!0,n)};En.hydrateRoot=function(t,e,n){if(!Rc(t))throw Error(U(405));var r=n!=null&&n.hydratedSources||null,o=!1,s="",i=Tp;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),e=Op(e,null,t,1,n??null,o,!1,s,i),t[mr]=e.current,Bs(t),r)for(t=0;t<r.length;t++)n=r[t],o=n._getVersion,o=o(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,o]:e.mutableSourceEagerHydrationData.push(n,o);return new Na(e)};En.render=function(t,e,n){if(!Da(e))throw Error(U(200));return Aa(null,t,e,!1,n)};En.unmountComponentAtNode=function(t){if(!Da(t))throw Error(U(40));return t._reactRootContainer?(uo(function(){Aa(null,null,t,!1,function(){t._reactRootContainer=null,t[mr]=null})}),!0):!1};En.unstable_batchedUpdates=wc;En.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Da(n))throw Error(U(200));if(t==null||t._reactInternals===void 0)throw Error(U(38));return Aa(t,e,n,!1,r)};En.version="18.3.1-next-f1338f8080-20240426";function Pp(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Pp)}catch(t){console.error(t)}}Pp(),Pf.exports=En;var B0=Pf.exports,zd=B0;jl.createRoot=zd.createRoot,jl.hydrateRoot=zd.hydrateRoot;const U0="modulepreload",F0=function(t){return"/"+t},Wd={},ti=function(e,n,r){let o=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));o=Promise.allSettled(n.map(u=>{if(u=F0(u),u in Wd)return;Wd[u]=!0;const c=u.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":U0,c||(h.as="script"),h.crossOrigin="",h.href=u,l&&h.setAttribute("nonce",l),document.head.appendChild(h),c)return new Promise((f,x)=>{h.addEventListener("load",f),h.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return o.then(i=>{for(const l of i||[])l.status==="rejected"&&s(l.reason);return e().catch(s)})},z0=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>ti(async()=>{const{default:r}=await Promise.resolve().then(()=>Zo);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)};class Nc extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class W0 extends Nc{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Vd extends Nc{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Gd extends Nc{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var xu;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(xu||(xu={}));var V0=function(t,e,n,r){function o(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?s(d.value):o(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};class G0{constructor(e,{headers:n={},customFetch:r,region:o=xu.Any}={}){this.url=e,this.headers=n,this.region=o,this.fetch=z0(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var r;return V0(this,void 0,void 0,function*(){try{const{headers:o,method:s,body:i}=n;let l={},{region:u}=n;u||(u=this.region);const c=new URL(`${this.url}/${e}`);u&&u!=="any"&&(l["x-region"]=u,c.searchParams.set("forceFunctionRegion",u));let d;i&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",d=i):typeof i=="string"?(l["Content-Type"]="text/plain",d=i):typeof FormData<"u"&&i instanceof FormData?d=i:(l["Content-Type"]="application/json",d=JSON.stringify(i)));const h=yield this.fetch(c.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),o),body:d}).catch(b=>{throw new W0(b)}),f=h.headers.get("x-relay-error");if(f&&f==="true")throw new Vd(h);if(!h.ok)throw new Gd(h);let x=((r=h.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),y;return x==="application/json"?y=yield h.json():x==="application/octet-stream"?y=yield h.blob():x==="text/event-stream"?y=h:x==="multipart/form-data"?y=yield h.formData():y=yield h.text(),{data:y,error:null,response:h}}catch(o){return{data:null,error:o,response:o instanceof Gd||o instanceof Vd?o.context:void 0}}})}}var mn={},Dc={},Oa={},ni={},Ta={},Pa={},q0=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Jo=q0();const H0=Jo.fetch,Lp=Jo.fetch.bind(Jo),$p=Jo.Headers,K0=Jo.Request,J0=Jo.Response,Zo=Object.freeze(Object.defineProperty({__proto__:null,Headers:$p,Request:K0,Response:J0,default:Lp,fetch:H0},Symbol.toStringTag,{value:"Module"})),Y0=hm(Zo);var La={};Object.defineProperty(La,"__esModule",{value:!0});let Q0=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};La.default=Q0;var Ip=Pn&&Pn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Pa,"__esModule",{value:!0});const X0=Ip(Y0),Z0=Ip(La);let ey=class{constructor(e){var n,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(n=e.shouldThrowOnError)!==null&&n!==void 0?n:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=X0.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,n){return this.headers=new Headers(this.headers),this.headers.set(e,n),this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const r=this.fetch;let o=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var i,l,u,c;let d=null,h=null,f=null,x=s.status,y=s.statusText;if(s.ok){if(this.method!=="HEAD"){const m=await s.text();m===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((i=this.headers.get("Accept"))===null||i===void 0)&&i.includes("application/vnd.pgrst.plan+text"))?h=m:h=JSON.parse(m))}const _=(l=this.headers.get("Prefer"))===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),p=(u=s.headers.get("content-range"))===null||u===void 0?void 0:u.split("/");_&&p&&p.length>1&&(f=parseInt(p[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(h)&&(h.length>1?(d={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,f=null,x=406,y="Not Acceptable"):h.length===1?h=h[0]:h=null)}else{const _=await s.text();try{d=JSON.parse(_),Array.isArray(d)&&s.status===404&&(h=[],d=null,x=200,y="OK")}catch{s.status===404&&_===""?(x=204,y="No Content"):d={message:_}}if(d&&this.isMaybeSingle&&(!((c=d==null?void 0:d.details)===null||c===void 0)&&c.includes("0 rows"))&&(d=null,x=200,y="OK"),d&&this.shouldThrowOnError)throw new Z0.default(d)}return{error:d,data:h,count:f,status:x,statusText:y}});return this.shouldThrowOnError||(o=o.catch(s=>{var i,l,u;return{error:{message:`${(i=s==null?void 0:s.name)!==null&&i!==void 0?i:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(l=s==null?void 0:s.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(u=s==null?void 0:s.code)!==null&&u!==void 0?u:""}`},data:null,count:null,status:0,statusText:""}})),o.then(e,n)}returns(){return this}overrideTypes(){return this}};Pa.default=ey;var ty=Pn&&Pn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ta,"__esModule",{value:!0});const ny=ty(Pa);let ry=class extends ny.default{select(e){let n=!1;const r=(e??"*").split("").map(o=>/\s/.test(o)&&!n?"":(o==='"'&&(n=!n),o)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:n=!0,nullsFirst:r,foreignTable:o,referencedTable:s=o}={}){const i=s?`${s}.order`:"order",l=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${l?`${l},`:""}${e}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:r=n}={}){const o=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(o,`${e}`),this}range(e,n,{foreignTable:r,referencedTable:o=r}={}){const s=typeof o>"u"?"offset":`${o}.offset`,i=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(i,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:n=!1,settings:r=!1,buffers:o=!1,wal:s=!1,format:i="text"}={}){var l;const u=[e?"analyze":null,n?"verbose":null,r?"settings":null,o?"buffers":null,s?"wal":null].filter(Boolean).join("|"),c=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${c}"; options=${u};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};Ta.default=ry;var oy=Pn&&Pn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(ni,"__esModule",{value:!0});const sy=oy(Ta);let iy=class extends sy.default{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const r=Array.from(new Set(n)).map(o=>typeof o=="string"&&new RegExp("[,()]").test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:r,type:o}={}){let s="";o==="plain"?s="pl":o==="phrase"?s="ph":o==="websearch"&&(s="w");const i=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${s}fts${i}.${n}`),this}match(e){return Object.entries(e).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(e,n,r){return this.url.searchParams.append(e,`not.${n}.${r}`),this}or(e,{foreignTable:n,referencedTable:r=n}={}){const o=r?`${r}.or`:"or";return this.url.searchParams.append(o,`(${e})`),this}filter(e,n,r){return this.url.searchParams.append(e,`${n}.${r}`),this}};ni.default=iy;var ay=Pn&&Pn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Oa,"__esModule",{value:!0});const cs=ay(ni);let ly=class{constructor(e,{headers:n={},schema:r,fetch:o}){this.url=e,this.headers=new Headers(n),this.schema=r,this.fetch=o}select(e,{head:n=!1,count:r}={}){const o=n?"HEAD":"GET";let s=!1;const i=(e??"*").split("").map(l=>/\s/.test(l)&&!s?"":(l==='"'&&(s=!s),l)).join("");return this.url.searchParams.set("select",i),r&&this.headers.append("Prefer",`count=${r}`),new cs.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:n,defaultToNull:r=!0}={}){var o;const s="POST";if(n&&this.headers.append("Prefer",`count=${n}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const i=e.reduce((l,u)=>l.concat(Object.keys(u)),[]);if(i.length>0){const l=[...new Set(i)].map(u=>`"${u}"`);this.url.searchParams.set("columns",l.join(","))}}return new cs.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}upsert(e,{onConflict:n,ignoreDuplicates:r=!1,count:o,defaultToNull:s=!0}={}){var i;const l="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),n!==void 0&&this.url.searchParams.set("on_conflict",n),o&&this.headers.append("Prefer",`count=${o}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const u=e.reduce((c,d)=>c.concat(Object.keys(d)),[]);if(u.length>0){const c=[...new Set(u)].map(d=>`"${d}"`);this.url.searchParams.set("columns",c.join(","))}}return new cs.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(e,{count:n}={}){var r;const o="PATCH";return n&&this.headers.append("Prefer",`count=${n}`),new cs.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var n;const r="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new cs.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}};Oa.default=ly;var Mp=Pn&&Pn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Dc,"__esModule",{value:!0});const uy=Mp(Oa),cy=Mp(ni);let dy=class Bp{constructor(e,{headers:n={},schema:r,fetch:o}={}){this.url=e,this.headers=new Headers(n),this.schemaName=r,this.fetch=o}from(e){const n=new URL(`${this.url}/${e}`);return new uy.default(n,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new Bp(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:r=!1,get:o=!1,count:s}={}){var i;let l;const u=new URL(`${this.url}/rpc/${e}`);let c;r||o?(l=r?"HEAD":"GET",Object.entries(n).filter(([h,f])=>f!==void 0).map(([h,f])=>[h,Array.isArray(f)?`{${f.join(",")}}`:`${f}`]).forEach(([h,f])=>{u.searchParams.append(h,f)})):(l="POST",c=n);const d=new Headers(this.headers);return s&&d.set("Prefer",`count=${s}`),new cy.default({method:l,url:u,headers:d,schema:this.schemaName,body:c,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};Dc.default=dy;var es=Pn&&Pn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(mn,"__esModule",{value:!0});mn.PostgrestError=mn.PostgrestBuilder=mn.PostgrestTransformBuilder=mn.PostgrestFilterBuilder=mn.PostgrestQueryBuilder=mn.PostgrestClient=void 0;const Up=es(Dc);mn.PostgrestClient=Up.default;const Fp=es(Oa);mn.PostgrestQueryBuilder=Fp.default;const zp=es(ni);mn.PostgrestFilterBuilder=zp.default;const Wp=es(Ta);mn.PostgrestTransformBuilder=Wp.default;const Vp=es(Pa);mn.PostgrestBuilder=Vp.default;const Gp=es(La);mn.PostgrestError=Gp.default;var fy=mn.default={PostgrestClient:Up.default,PostgrestQueryBuilder:Fp.default,PostgrestFilterBuilder:zp.default,PostgrestTransformBuilder:Wp.default,PostgrestBuilder:Vp.default,PostgrestError:Gp.default};const{PostgrestClient:hy,PostgrestQueryBuilder:hb,PostgrestFilterBuilder:pb,PostgrestTransformBuilder:mb,PostgrestBuilder:gb,PostgrestError:yb}=fy;class py{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const r=n.node,o=parseInt(r.replace(/^v/,"").split(".")[0]);return o>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${o} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${o} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const r=this.getWebSocketConstructor();return new r(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const my="2.15.5",gy=`realtime-js/${my}`,yy="1.0.0",bu=1e4,vy=1e3,xy=100;var js;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(js||(js={}));var jt;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(jt||(jt={}));var Vn;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Vn||(Vn={}));var wu;(function(t){t.websocket="websocket"})(wu||(wu={}));var Zr;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Zr||(Zr={}));class by{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const o=n.getUint8(1),s=n.getUint8(2);let i=this.HEADER_LENGTH+2;const l=r.decode(e.slice(i,i+o));i=i+o;const u=r.decode(e.slice(i,i+s));i=i+s;const c=JSON.parse(r.decode(e.slice(i,e.byteLength)));return{ref:null,topic:l,event:u,payload:c}}}class qp{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ot;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(ot||(ot={}));const qd=(t,e,n={})=>{var r;const o=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((s,i)=>(s[i]=wy(i,t,e,o),s),{})},wy=(t,e,n,r)=>{const o=e.find(l=>l.name===t),s=o==null?void 0:o.type,i=n[t];return s&&!r.includes(s)?Hp(s,i):Su(i)},Hp=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return Ey(e,n)}switch(t){case ot.bool:return Sy(e);case ot.float4:case ot.float8:case ot.int2:case ot.int4:case ot.int8:case ot.numeric:case ot.oid:return _y(e);case ot.json:case ot.jsonb:return ky(e);case ot.timestamp:return jy(e);case ot.abstime:case ot.date:case ot.daterange:case ot.int4range:case ot.int8range:case ot.money:case ot.reltime:case ot.text:case ot.time:case ot.timestamptz:case ot.timetz:case ot.tsrange:case ot.tstzrange:return Su(e);default:return Su(e)}},Su=t=>t,Sy=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},_y=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},ky=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},Ey=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let s;const i=t.slice(1,n);try{s=JSON.parse("["+i+"]")}catch{s=i?i.split(","):[]}return s.map(l=>Hp(e,l))}return t},jy=t=>typeof t=="string"?t.replace(" ","T"):t,Kp=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class hl{constructor(e,n,r={},o=bu){this.channel=e,this.event=n,this.payload=r,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Hd;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Hd||(Hd={}));class Cs{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},o=>{const{onJoin:s,onLeave:i,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Cs.syncState(this.state,o,s,i),this.pendingDiffs.forEach(u=>{this.state=Cs.syncDiff(this.state,u,s,i)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},o=>{const{onJoin:s,onLeave:i,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(o):(this.state=Cs.syncDiff(this.state,o,s,i),l())}),this.onJoin((o,s,i)=>{this.channel._trigger("presence",{event:"join",key:o,currentPresences:s,newPresences:i})}),this.onLeave((o,s,i)=>{this.channel._trigger("presence",{event:"leave",key:o,currentPresences:s,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,o){const s=this.cloneDeep(e),i=this.transformState(n),l={},u={};return this.map(s,(c,d)=>{i[c]||(u[c]=d)}),this.map(i,(c,d)=>{const h=s[c];if(h){const f=d.map(_=>_.presence_ref),x=h.map(_=>_.presence_ref),y=d.filter(_=>x.indexOf(_.presence_ref)<0),b=h.filter(_=>f.indexOf(_.presence_ref)<0);y.length>0&&(l[c]=y),b.length>0&&(u[c]=b)}else l[c]=d}),this.syncDiff(s,{joins:l,leaves:u},r,o)}static syncDiff(e,n,r,o){const{joins:s,leaves:i}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),o||(o=()=>{}),this.map(s,(l,u)=>{var c;const d=(c=e[l])!==null&&c!==void 0?c:[];if(e[l]=this.cloneDeep(u),d.length>0){const h=e[l].map(x=>x.presence_ref),f=d.filter(x=>h.indexOf(x.presence_ref)<0);e[l].unshift(...f)}r(l,d,u)}),this.map(i,(l,u)=>{let c=e[l];if(!c)return;const d=u.map(h=>h.presence_ref);c=c.filter(h=>d.indexOf(h.presence_ref)<0),e[l]=c,o(l,c,u),c.length===0&&delete e[l]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const o=e[r];return"metas"in o?n[r]=o.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):n[r]=o,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Kd;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Kd||(Kd={}));var Rs;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Rs||(Rs={}));var lr;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(lr||(lr={}));class Ac{constructor(e,n={config:{}},r){this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=jt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new hl(this,Vn.join,this.params,this.timeout),this.rejoinTimer=new qp(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=jt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=jt.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=jt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=jt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=jt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Vn.reply,{},(o,s)=>{this._trigger(this._replyEventName(s),o)}),this.presence=new Cs(this),this.broadcastEndpointURL=Kp(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var r,o,s;if(this.socket.isConnected()||this.socket.connect(),this.state==jt.closed){const{config:{broadcast:i,presence:l,private:u}}=this.params,c=(o=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(x=>x.filter))!==null&&o!==void 0?o:[],d=!!this.bindings[Rs.PRESENCE]&&this.bindings[Rs.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,h={},f={broadcast:i,presence:Object.assign(Object.assign({},l),{enabled:d}),postgres_changes:c,private:u};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(x=>e==null?void 0:e(lr.CHANNEL_ERROR,x)),this._onClose(()=>e==null?void 0:e(lr.CLOSED)),this.updateJoinPayload(Object.assign({config:f},h)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:x})=>{var y;if(this.socket.setAuth(),x===void 0){e==null||e(lr.SUBSCRIBED);return}else{const b=this.bindings.postgres_changes,_=(y=b==null?void 0:b.length)!==null&&y!==void 0?y:0,p=[];for(let m=0;m<_;m++){const g=b[m],{filter:{event:w,schema:j,table:R,filter:C}}=g,S=x&&x[m];if(S&&S.event===w&&S.schema===j&&S.table===R&&S.filter===C)p.push(Object.assign(Object.assign({},g),{id:S.id}));else{this.unsubscribe(),this.state=jt.errored,e==null||e(lr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=p,e&&e(lr.SUBSCRIBED);return}}).receive("error",x=>{this.state=jt.errored,e==null||e(lr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(x).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(lr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this.state===jt.joined&&e===Rs.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,n,r)}async send(e,n={}){var r,o;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:i}=e,u={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((o=c.body)===null||o===void 0?void 0:o.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var i,l,u;const c=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((u=(l=(i=this.params)===null||i===void 0?void 0:i.config)===null||l===void 0?void 0:l.broadcast)===null||u===void 0)&&u.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=jt.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Vn.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(o=>{r=new hl(this,Vn.leave,{},e),r.receive("ok",()=>{n(),o("ok")}).receive("timeout",()=>{n(),o("timed out")}).receive("error",()=>{o("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=jt.closed,this.bindings={}}async _fetchWithTimeout(e,n,r){const o=new AbortController,s=setTimeout(()=>o.abort(),r),i=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:o.signal}));return clearTimeout(s),i}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new hl(this,e,n,r);return this._canPush()?o.send():this._addToPushBuffer(o),o}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>xy){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var o,s;const i=e.toLocaleLowerCase(),{close:l,error:u,leave:c,join:d}=Vn;if(r&&[l,u,c,d].indexOf(i)>=0&&r!==this._joinRef())return;let f=this._onMessage(i,n,r);if(n&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(o=this.bindings.postgres_changes)===null||o===void 0||o.filter(x=>{var y,b,_;return((y=x.filter)===null||y===void 0?void 0:y.event)==="*"||((_=(b=x.filter)===null||b===void 0?void 0:b.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===i}).map(x=>x.callback(f,r)):(s=this.bindings[i])===null||s===void 0||s.filter(x=>{var y,b,_,p,m,g;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in x){const w=x.id,j=(y=x.filter)===null||y===void 0?void 0:y.event;return w&&((b=n.ids)===null||b===void 0?void 0:b.includes(w))&&(j==="*"||(j==null?void 0:j.toLocaleLowerCase())===((_=n.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const w=(m=(p=x==null?void 0:x.filter)===null||p===void 0?void 0:p.event)===null||m===void 0?void 0:m.toLocaleLowerCase();return w==="*"||w===((g=n==null?void 0:n.event)===null||g===void 0?void 0:g.toLocaleLowerCase())}else return x.type.toLocaleLowerCase()===i}).map(x=>{if(typeof f=="object"&&"ids"in f){const y=f.data,{schema:b,table:_,commit_timestamp:p,type:m,errors:g}=y;f=Object.assign(Object.assign({},{schema:b,table:_,commit_timestamp:p,eventType:m,new:{},old:{},errors:g}),this._getPayloadRecords(y))}x.callback(f,r)})}_isClosed(){return this.state===jt.closed}_isJoined(){return this.state===jt.joined}_isJoining(){return this.state===jt.joining}_isLeaving(){return this.state===jt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const o=e.toLocaleLowerCase(),s={type:o,filter:n,callback:r};return this.bindings[o]?this.bindings[o].push(s):this.bindings[o]=[s],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(o=>{var s;return!(((s=o.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===r&&Ac.isEqual(o.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Vn.close,{},e)}_onError(e){this._on(Vn.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=jt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=qd(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=qd(e.columns,e.old_record)),n}}const pl=()=>{},Si={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Cy=[1e3,2e3,5e3,1e4],Ry=1e4,Ny=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Dy{constructor(e,n){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=bu,this.transport=null,this.heartbeatIntervalMs=Si.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=pl,this.ref=0,this.reconnectTimer=null,this.logger=pl,this.conn=null,this.sendBuffer=[],this.serializer=new by,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=o=>{let s;return o?s=o:typeof fetch>"u"?s=(...i)=>ti(async()=>{const{default:l}=await Promise.resolve().then(()=>Zo);return{default:l}},void 0).then(({default:l})=>l(...i)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):s=fetch,(...i)=>s(...i)},!(!((r=n==null?void 0:n.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${wu.websocket}`,this.httpEndpoint=Kp(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=py.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:yy}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case js.connecting:return Zr.Connecting;case js.open:return Zr.Open;case js.closing:return Zr.Closing;default:return Zr.Closed}}isConnected(){return this.connectionState()===Zr.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const r=`realtime:${e}`,o=this.getChannels().find(s=>s.topic===r);if(o)return o;{const s=new Ac(`realtime:${e}`,n,this);return this.channels.push(s),s}}push(e){const{topic:n,event:r,payload:o,ref:s}=e,i=()=>{this.encode(e,l=>{var u;(u=this.conn)===null||u===void 0||u.send(l)})};this.log("push",`${n} ${r} (${s})`,o),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(vy,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},Si.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:o,payload:s,ref:i}=n,l=i?`(${i})`:"",u=s.status||"";this.log("receive",`${u} ${r} ${o} ${l}`.trim(),s),this.channels.filter(c=>c._isMember(r)).forEach(c=>c._trigger(o,s,i)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Vn.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",o=new URLSearchParams(n);return`${e}${r}${o}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([Ny],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n;e?n=e:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const o={access_token:n,version:gy};n&&r.updateJoinPayload(o),r.joinedOnce&&r._isJoined()&&r._push(Vn.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(n)}catch(o){this.log("error",`error in ${e} callback`,o)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new qp(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Si.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,r,o,s,i,l,u,c,d;if(this.transport=(n=e==null?void 0:e.transport)!==null&&n!==void 0?n:null,this.timeout=(r=e==null?void 0:e.timeout)!==null&&r!==void 0?r:bu,this.heartbeatIntervalMs=(o=e==null?void 0:e.heartbeatIntervalMs)!==null&&o!==void 0?o:Si.HEARTBEAT_INTERVAL,this.worker=(s=e==null?void 0:e.worker)!==null&&s!==void 0?s:!1,this.accessToken=(i=e==null?void 0:e.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(l=e==null?void 0:e.heartbeatCallback)!==null&&l!==void 0?l:pl,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=e==null?void 0:e.reconnectAfterMs)!==null&&u!==void 0?u:h=>Cy[h-1]||Ry,this.encode=(c=e==null?void 0:e.encode)!==null&&c!==void 0?c:(h,f)=>f(JSON.stringify(h)),this.decode=(d=e==null?void 0:e.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class Oc extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Ct(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class Ay extends Oc{constructor(e,n,r){super(e),this.name="StorageApiError",this.status=n,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class _u extends Oc{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var Oy=function(t,e,n,r){function o(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?s(d.value):o(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};const Jp=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>ti(async()=>{const{default:r}=await Promise.resolve().then(()=>Zo);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},Ty=()=>Oy(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield ti(()=>Promise.resolve().then(()=>Zo),void 0)).Response:Response}),ku=t=>{if(Array.isArray(t))return t.map(n=>ku(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const o=n.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[o]=ku(r)}),e},Py=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var mo=function(t,e,n,r){function o(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?s(d.value):o(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};const ml=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Ly=(t,e,n)=>mo(void 0,void 0,void 0,function*(){const r=yield Ty();t instanceof r&&!(n!=null&&n.noResolveJson)?t.json().then(o=>{const s=t.status||500,i=(o==null?void 0:o.statusCode)||s+"";e(new Ay(ml(o),s,i))}).catch(o=>{e(new _u(ml(o),o))}):e(new _u(ml(t),t))}),$y=(t,e,n,r)=>{const o={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!r?o:(Py(r)?(o.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),o.body=JSON.stringify(r)):o.body=r,e!=null&&e.duplex&&(o.duplex=e.duplex),Object.assign(Object.assign({},o),n))};function ri(t,e,n,r,o,s){return mo(this,void 0,void 0,function*(){return new Promise((i,l)=>{t(n,$y(e,r,o,s)).then(u=>{if(!u.ok)throw u;return r!=null&&r.noResolveJson?u:u.json()}).then(u=>i(u)).catch(u=>Ly(u,l,r))})})}function ha(t,e,n,r){return mo(this,void 0,void 0,function*(){return ri(t,"GET",e,n,r)})}function tr(t,e,n,r,o){return mo(this,void 0,void 0,function*(){return ri(t,"POST",e,r,o,n)})}function Eu(t,e,n,r,o){return mo(this,void 0,void 0,function*(){return ri(t,"PUT",e,r,o,n)})}function Iy(t,e,n,r){return mo(this,void 0,void 0,function*(){return ri(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function Yp(t,e,n,r,o){return mo(this,void 0,void 0,function*(){return ri(t,"DELETE",e,r,o,n)})}var Yt=function(t,e,n,r){function o(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?s(d.value):o(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};const My={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Jd={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class By{constructor(e,n={},r,o){this.shouldThrowOnError=!1,this.url=e,this.headers=n,this.bucketId=r,this.fetch=Jp(o)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,n,r,o){return Yt(this,void 0,void 0,function*(){try{let s;const i=Object.assign(Object.assign({},Jd),o);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(i.upsert)});const u=i.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),u&&s.append("metadata",this.encodeMetadata(u)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.append("cacheControl",i.cacheControl),u&&s.append("metadata",this.encodeMetadata(u))):(s=r,l["cache-control"]=`max-age=${i.cacheControl}`,l["content-type"]=i.contentType,u&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(u)))),o!=null&&o.headers&&(l=Object.assign(Object.assign({},l),o.headers));const c=this._removeEmptyFolders(n),d=this._getFinalPath(c),h=yield(e=="PUT"?Eu:tr)(this.fetch,`${this.url}/object/${d}`,s,Object.assign({headers:l},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:c,id:h.Id,fullPath:h.Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Ct(s))return{data:null,error:s};throw s}})}upload(e,n,r){return Yt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,o){return Yt(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),i=this._getFinalPath(s),l=new URL(this.url+`/object/upload/sign/${i}`);l.searchParams.set("token",n);try{let u;const c=Object.assign({upsert:Jd.upsert},o),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&r instanceof Blob?(u=new FormData,u.append("cacheControl",c.cacheControl),u.append("",r)):typeof FormData<"u"&&r instanceof FormData?(u=r,u.append("cacheControl",c.cacheControl)):(u=r,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType);const h=yield Eu(this.fetch,l.toString(),u,{headers:d});return{data:{path:s,fullPath:h.Key},error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(Ct(u))return{data:null,error:u};throw u}})}createSignedUploadUrl(e,n){return Yt(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const o=Object.assign({},this.headers);n!=null&&n.upsert&&(o["x-upsert"]="true");const s=yield tr(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:o}),i=new URL(this.url+s.url),l=i.searchParams.get("token");if(!l)throw new Oc("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:l},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ct(r))return{data:null,error:r};throw r}})}update(e,n,r){return Yt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return Yt(this,void 0,void 0,function*(){try{return{data:yield tr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Ct(o))return{data:null,error:o};throw o}})}copy(e,n,r){return Yt(this,void 0,void 0,function*(){try{return{data:{path:(yield tr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Ct(o))return{data:null,error:o};throw o}})}createSignedUrl(e,n,r){return Yt(this,void 0,void 0,function*(){try{let o=this._getFinalPath(e),s=yield tr(this.fetch,`${this.url}/object/sign/${o}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${i}`)},{data:s,error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Ct(o))return{data:null,error:o};throw o}})}createSignedUrls(e,n,r){return Yt(this,void 0,void 0,function*(){try{const o=yield tr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:o.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${s}`):null})),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Ct(o))return{data:null,error:o};throw o}})}download(e,n){return Yt(this,void 0,void 0,function*(){const o=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),i=s?`?${s}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield ha(this.fetch,`${this.url}/${o}/${l}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Ct(l))return{data:null,error:l};throw l}})}info(e){return Yt(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const r=yield ha(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:ku(r),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ct(r))return{data:null,error:r};throw r}})}exists(e){return Yt(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield Iy(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ct(r)&&r instanceof _u){const o=r.originalError;if([400,404].includes(o==null?void 0:o.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,n){const r=this._getFinalPath(e),o=[],s=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";s!==""&&o.push(s);const l=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",u=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});u!==""&&o.push(u);let c=o.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${c}`)}}}remove(e){return Yt(this,void 0,void 0,function*(){try{return{data:yield Yp(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}})}list(e,n,r){return Yt(this,void 0,void 0,function*(){try{const o=Object.assign(Object.assign(Object.assign({},My),n),{prefix:e||""});return{data:yield tr(this.fetch,`${this.url}/object/list/${this.bucketId}`,o,{headers:this.headers},r),error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Ct(o))return{data:null,error:o};throw o}})}listV2(e,n){return Yt(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield tr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},n),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ct(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const Uy="2.12.1",Fy={"X-Client-Info":`storage-js/${Uy}`};var yo=function(t,e,n,r){function o(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?s(d.value):o(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};class zy{constructor(e,n={},r,o){this.shouldThrowOnError=!1;const s=new URL(e);o!=null&&o.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href,this.headers=Object.assign(Object.assign({},Fy),n),this.fetch=Jp(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return yo(this,void 0,void 0,function*(){try{return{data:yield ha(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Ct(e))return{data:null,error:e};throw e}})}getBucket(e){return yo(this,void 0,void 0,function*(){try{return{data:yield ha(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return yo(this,void 0,void 0,function*(){try{return{data:yield tr(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ct(r))return{data:null,error:r};throw r}})}updateBucket(e,n){return yo(this,void 0,void 0,function*(){try{return{data:yield Eu(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Ct(r))return{data:null,error:r};throw r}})}emptyBucket(e){return yo(this,void 0,void 0,function*(){try{return{data:yield tr(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}})}deleteBucket(e){return yo(this,void 0,void 0,function*(){try{return{data:yield Yp(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Ct(n))return{data:null,error:n};throw n}})}}class Wy extends zy{constructor(e,n={},r,o){super(e,n,r,o)}from(e){return new By(this.url,this.headers,e,this.fetch)}}const Vy="2.57.4";let gs="";typeof Deno<"u"?gs="deno":typeof document<"u"?gs="web":typeof navigator<"u"&&navigator.product==="ReactNative"?gs="react-native":gs="node";const Gy={"X-Client-Info":`supabase-js-${gs}/${Vy}`},qy={headers:Gy},Hy={schema:"public"},Ky={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Jy={};var Yy=function(t,e,n,r){function o(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?s(d.value):o(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};const Qy=t=>{let e;return t?e=t:typeof fetch>"u"?e=Lp:e=fetch,(...n)=>e(...n)},Xy=()=>typeof Headers>"u"?$p:Headers,Zy=(t,e,n)=>{const r=Qy(n),o=Xy();return(s,i)=>Yy(void 0,void 0,void 0,function*(){var l;const u=(l=yield e())!==null&&l!==void 0?l:t;let c=new o(i==null?void 0:i.headers);return c.has("apikey")||c.set("apikey",t),c.has("Authorization")||c.set("Authorization",`Bearer ${u}`),r(s,Object.assign(Object.assign({},i),{headers:c}))})};var ev=function(t,e,n,r){function o(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?s(d.value):o(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};function tv(t){return t.endsWith("/")?t:t+"/"}function nv(t,e){var n,r;const{db:o,auth:s,realtime:i,global:l}=t,{db:u,auth:c,realtime:d,global:h}=e,f={db:Object.assign(Object.assign({},u),o),auth:Object.assign(Object.assign({},c),s),realtime:Object.assign(Object.assign({},d),i),storage:{},global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(n=h==null?void 0:h.headers)!==null&&n!==void 0?n:{}),(r=l==null?void 0:l.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>ev(this,void 0,void 0,function*(){return""})};return t.accessToken?f.accessToken=t.accessToken:delete f.accessToken,f}function rv(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(tv(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Qp="2.71.1",So=30*1e3,ju=3,gl=ju*So,ov="http://localhost:9999",sv="supabase.auth.token",iv={"X-Client-Info":`gotrue-js/${Qp}`},Cu="X-Supabase-Api-Version",Xp={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},av=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,lv=10*60*1e3;class Tc extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function Re(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class uv extends Tc{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function cv(t){return Re(t)&&t.name==="AuthApiError"}class Zp extends Tc{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class Gr extends Tc{constructor(e,n,r,o){super(e,r,o),this.name=n,this.status=r}}class kr extends Gr{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function dv(t){return Re(t)&&t.name==="AuthSessionMissingError"}class _i extends Gr{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ki extends Gr{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Ei extends Gr{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function fv(t){return Re(t)&&t.name==="AuthImplicitGrantRedirectError"}class Yd extends Gr{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ru extends Gr{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function yl(t){return Re(t)&&t.name==="AuthRetryableFetchError"}class Qd extends Gr{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class Nu extends Gr{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const pa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Xd=` 	
\r=`.split(""),hv=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<Xd.length;e+=1)t[Xd[e].charCodeAt(0)]=-2;for(let e=0;e<pa.length;e+=1)t[pa[e].charCodeAt(0)]=e;return t})();function Zd(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(pa[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(pa[r]),e.queuedBits-=6}}function em(t,e,n){const r=hv[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function ef(t){const e=[],n=i=>{e.push(String.fromCodePoint(i))},r={utf8seq:0,codepoint:0},o={queue:0,queuedBits:0},s=i=>{gv(i,r,n)};for(let i=0;i<t.length;i+=1)em(t.charCodeAt(i),o,s);return e.join("")}function pv(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function mv(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const o=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|o)+65536,n+=1}pv(r,e)}}function gv(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if(!(t>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function yv(t){const e=[],n={queue:0,queuedBits:0},r=o=>{e.push(o)};for(let o=0;o<t.length;o+=1)em(t.charCodeAt(o),n,r);return new Uint8Array(e)}function vv(t){const e=[];return mv(t,n=>e.push(n)),new Uint8Array(e)}function xv(t){const e=[],n={queue:0,queuedBits:0},r=o=>{e.push(o)};return t.forEach(o=>Zd(o,n,r)),Zd(null,n,r),e.join("")}function bv(t){return Math.round(Date.now()/1e3)+t}function wv(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Fn=()=>typeof window<"u"&&typeof document<"u",Kr={tested:!1,writable:!1},tm=()=>{if(!Fn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Kr.tested)return Kr.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Kr.tested=!0,Kr.writable=!0}catch{Kr.tested=!0,Kr.writable=!1}return Kr.writable};function Sv(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((o,s)=>{e[s]=o})}catch{}return n.searchParams.forEach((r,o)=>{e[o]=r}),e}const nm=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>ti(async()=>{const{default:r}=await Promise.resolve().then(()=>Zo);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},_v=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",_o=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},Jr=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Sr=async(t,e)=>{await t.removeItem(e)};class $a{constructor(){this.promise=new $a.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}$a.promiseConstructor=Promise;function vl(t){const e=t.split(".");if(e.length!==3)throw new Nu("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!av.test(e[r]))throw new Nu("JWT not in base64url format");return{header:JSON.parse(ef(e[0])),payload:JSON.parse(ef(e[1])),signature:yv(e[2]),raw:{header:e[0],payload:e[1]}}}async function kv(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function Ev(t,e){return new Promise((r,o)=>{(async()=>{for(let s=0;s<1/0;s++)try{const i=await t(s);if(!e(s,null,i)){r(i);return}}catch(i){if(!e(s,i)){o(i);return}}})()})}function jv(t){return("0"+t.toString(16)).substr(-2)}function Cv(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let o="";for(let s=0;s<56;s++)o+=n.charAt(Math.floor(Math.random()*r));return o}return crypto.getRandomValues(e),Array.from(e,jv).join("")}async function Rv(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),o=new Uint8Array(r);return Array.from(o).map(s=>String.fromCharCode(s)).join("")}async function Nv(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await Rv(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function vo(t,e,n=!1){const r=Cv();let o=r;n&&(o+="/PASSWORD_RECOVERY"),await _o(t,`${e}-code-verifier`,o);const s=await Nv(r);return[s,r===s?"plain":"s256"]}const Dv=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Av(t){const e=t.headers.get(Cu);if(!e||!e.match(Dv))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Ov(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function Tv(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Pv=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function xo(t){if(!Pv.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function xl(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function tf(t){return JSON.parse(JSON.stringify(t))}var Lv=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};const Xr=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),$v=[502,503,504];async function nf(t){var e;if(!_v(t))throw new Ru(Xr(t),0);if($v.includes(t.status))throw new Ru(Xr(t),t.status);let n;try{n=await t.json()}catch(s){throw new Zp(Xr(s),s)}let r;const o=Av(t);if(o&&o.getTime()>=Xp["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new Qd(Xr(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new kr}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((s,i)=>s&&typeof i=="string",!0))throw new Qd(Xr(n),t.status,n.weak_password.reasons);throw new uv(Xr(n),t.status||500,r)}const Iv=(t,e,n,r)=>{const o={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),o.body=JSON.stringify(r),Object.assign(Object.assign({},o),n))};async function $e(t,e,n,r){var o;const s=Object.assign({},r==null?void 0:r.headers);s[Cu]||(s[Cu]=Xp["2024-01-01"].name),r!=null&&r.jwt&&(s.Authorization=`Bearer ${r.jwt}`);const i=(o=r==null?void 0:r.query)!==null&&o!==void 0?o:{};r!=null&&r.redirectTo&&(i.redirect_to=r.redirectTo);const l=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",u=await Mv(t,e,n+l,{headers:s,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(u):{data:Object.assign({},u),error:null}}async function Mv(t,e,n,r,o,s){const i=Iv(e,r,o,s);let l;try{l=await t(n,Object.assign({},i))}catch(u){throw console.error(u),new Ru(Xr(u),0)}if(l.ok||await nf(l),r!=null&&r.noResolveJson)return l;try{return await l.json()}catch(u){await nf(u)}}function ir(t){var e;let n=null;zv(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=bv(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function rf(t){const e=ir(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Nr(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function Bv(t){return{data:t,error:null}}function Uv(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:o,verification_type:s}=t,i=Lv(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:n,hashed_token:r,redirect_to:o,verification_type:s},u=Object.assign({},i);return{data:{properties:l,user:u},error:null}}function Fv(t){return t}function zv(t){return t.access_token&&t.refresh_token&&t.expires_in}const bl=["global","local","others"];var Wv=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};class Vv{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=nm(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n=bl[0]){if(bl.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${bl.join(", ")}`);try{return await $e(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Re(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await $e(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Nr})}catch(r){if(Re(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=Wv(e,["options"]),o=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(o.new_email=r==null?void 0:r.newEmail,delete o.newEmail),await $e(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:o,headers:this.headers,xform:Uv,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(Re(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await $e(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Nr})}catch(n){if(Re(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,o,s,i,l,u;try{const c={nextPage:null,lastPage:0,total:0},d=await $e(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(s=(o=e==null?void 0:e.perPage)===null||o===void 0?void 0:o.toString())!==null&&s!==void 0?s:""},xform:Fv});if(d.error)throw d.error;const h=await d.json(),f=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,x=(u=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&u!==void 0?u:[];return x.length>0&&(x.forEach(y=>{const b=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(y.split(";")[1].split("=")[1]);c[`${_}Page`]=b}),c.total=parseInt(f)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(Re(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){xo(e);try{return await $e(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Nr})}catch(n){if(Re(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){xo(e);try{return await $e(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Nr})}catch(r){if(Re(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){xo(e);try{return await $e(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Nr})}catch(r){if(Re(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){xo(e.userId);try{const{data:n,error:r}=await $e(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:o=>({data:{factors:o},error:null})});return{data:n,error:r}}catch(n){if(Re(n))return{data:null,error:n};throw n}}async _deleteFactor(e){xo(e.userId),xo(e.id);try{return{data:await $e(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(Re(n))return{data:null,error:n};throw n}}}function of(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function Gv(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const bo={debug:!!(globalThis&&tm()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class rm extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class qv extends rm{}async function Hv(t,e,n){bo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),bo.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async o=>{if(o){bo.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,o.name);try{return await n()}finally{bo.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,o.name)}}else{if(e===0)throw bo.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new qv(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(bo.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}Gv();const Kv={url:ov,storageKey:sv,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:iv,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function sf(t,e,n){return await n()}const wo={};class Ks{constructor(e){var n,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ks.nextInstanceID,Ks.nextInstanceID+=1,this.instanceID>0&&Fn()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const o=Object.assign(Object.assign({},Kv),e);if(this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.persistSession=o.persistSession,this.storageKey=o.storageKey,this.autoRefreshToken=o.autoRefreshToken,this.admin=new Vv({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=nm(o.fetch),this.lock=o.lock||sf,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,o.lock?this.lock=o.lock:Fn()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=Hv:this.lock=sf,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:tm()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=of(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=of(this.memoryStorage)),Fn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}get jwks(){var e,n;return(n=(e=wo[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){wo[this.storageKey]=Object.assign(Object.assign({},wo[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=wo[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){wo[this.storageKey]=Object.assign(Object.assign({},wo[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Qp}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=Sv(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),Fn()&&this.detectSessionInUrl&&r!=="none"){const{data:o,error:s}=await this._getSessionFromURL(n,r);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),fv(s)){const u=(e=s.details)===null||e===void 0?void 0:e.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:i,redirectType:l}=o;return this._debug("#_initialize()","detected session in URL",i,"redirect type",l),await this._saveSession(i),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Re(n)?{error:n}:{error:new Zp("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,o;try{const s=await $e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(o=e==null?void 0:e.options)===null||o===void 0?void 0:o.captchaToken}},xform:ir}),{data:i,error:l}=s;if(l||!i)return{data:{user:null,session:null},error:l};const u=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(s){if(Re(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var n,r,o;try{let s;if("email"in e){const{email:d,password:h,options:f}=e;let x=null,y=null;this.flowType==="pkce"&&([x,y]=await vo(this.storage,this.storageKey)),s=await $e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:h,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:x,code_challenge_method:y},xform:ir})}else if("phone"in e){const{phone:d,password:h,options:f}=e;s=await $e(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},channel:(o=f==null?void 0:f.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:ir})}else throw new ki("You must provide either an email or phone number and a password");const{data:i,error:l}=s;if(l||!i)return{data:{user:null,session:null},error:l};const u=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(s){if(Re(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let n;if("email"in e){const{email:s,password:i,options:l}=e;n=await $e(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:rf})}else if("phone"in e){const{phone:s,password:i,options:l}=e;n=await $e(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:rf})}else throw new ki("You must provide either an email or phone number and a password");const{data:r,error:o}=n;return o?{data:{user:null,session:null},error:o}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new _i}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:o})}catch(n){if(Re(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,r,o,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(o=e.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;if(n==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(e){var n,r,o,s,i,l,u,c,d,h,f,x;let y,b;if("message"in e)y=e.message,b=e.signature;else{const{chain:_,wallet:p,statement:m,options:g}=e;let w;if(Fn())if(typeof p=="object")w=p;else{const R=window;if("solana"in R&&typeof R.solana=="object"&&("signIn"in R.solana&&typeof R.solana.signIn=="function"||"signMessage"in R.solana&&typeof R.solana.signMessage=="function"))w=R.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof p!="object"||!(g!=null&&g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=p}const j=new URL((n=g==null?void 0:g.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in w&&w.signIn){const R=await w.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},g==null?void 0:g.signInWithSolana),{version:"1",domain:j.host,uri:j.href}),m?{statement:m}:null));let C;if(Array.isArray(R)&&R[0]&&typeof R[0]=="object")C=R[0];else if(R&&typeof R=="object"&&"signedMessage"in R&&"signature"in R)C=R;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in C&&"signature"in C&&(typeof C.signedMessage=="string"||C.signedMessage instanceof Uint8Array)&&C.signature instanceof Uint8Array)y=typeof C.signedMessage=="string"?C.signedMessage:new TextDecoder().decode(C.signedMessage),b=C.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in w)||typeof w.signMessage!="function"||!("publicKey"in w)||typeof w!="object"||!w.publicKey||!("toBase58"in w.publicKey)||typeof w.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");y=[`${j.host} wants you to sign in with your Solana account:`,w.publicKey.toBase58(),...m?["",m,""]:[""],"Version: 1",`URI: ${j.href}`,`Issued At: ${(o=(r=g==null?void 0:g.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&o!==void 0?o:new Date().toISOString()}`,...!((s=g==null?void 0:g.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${g.signInWithSolana.notBefore}`]:[],...!((i=g==null?void 0:g.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${g.signInWithSolana.expirationTime}`]:[],...!((l=g==null?void 0:g.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${g.signInWithSolana.chainId}`]:[],...!((u=g==null?void 0:g.signInWithSolana)===null||u===void 0)&&u.nonce?[`Nonce: ${g.signInWithSolana.nonce}`]:[],...!((c=g==null?void 0:g.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${g.signInWithSolana.requestId}`]:[],...!((h=(d=g==null?void 0:g.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?["Resources",...g.signInWithSolana.resources.map(C=>`- ${C}`)]:[]].join(`
`);const R=await w.signMessage(new TextEncoder().encode(y),"utf8");if(!R||!(R instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");b=R}}try{const{data:_,error:p}=await $e(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:y,signature:xv(b)},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(x=e.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:ir});if(p)throw p;return!_||!_.session||!_.user?{data:{user:null,session:null},error:new _i}:(_.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),{data:Object.assign({},_),error:p})}catch(_){if(Re(_))return{data:{user:null,session:null},error:_};throw _}}async _exchangeCodeForSession(e){const n=await Jr(this.storage,`${this.storageKey}-code-verifier`),[r,o]=(n??"").split("/");try{const{data:s,error:i}=await $e(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:ir});if(await Sr(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new _i}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:o??null}),error:i})}catch(s){if(Re(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{const{options:n,provider:r,token:o,access_token:s,nonce:i}=e,l=await $e(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:o,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:ir}),{data:u,error:c}=l;return c?{data:{user:null,session:null},error:c}:!u||!u.session||!u.user?{data:{user:null,session:null},error:new _i}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:u,error:c})}catch(n){if(Re(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,r,o,s,i;try{if("email"in e){const{email:l,options:u}=e;let c=null,d=null;this.flowType==="pkce"&&([c,d]=await vo(this.storage,this.storageKey));const{error:h}=await $e(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(n=u==null?void 0:u.data)!==null&&n!==void 0?n:{},create_user:(r=u==null?void 0:u.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},code_challenge:c,code_challenge_method:d},redirectTo:u==null?void 0:u.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:l,options:u}=e,{data:c,error:d}=await $e(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(o=u==null?void 0:u.data)!==null&&o!==void 0?o:{},create_user:(s=u==null?void 0:u.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},channel:(i=u==null?void 0:u.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:d}}throw new ki("You must provide either an email or phone number.")}catch(l){if(Re(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var n,r;try{let o,s;"options"in e&&(o=(n=e.options)===null||n===void 0?void 0:n.redirectTo,s=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:i,error:l}=await $e(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:o,xform:ir});if(l)throw l;if(!i)throw new Error("An error occurred on token verification.");const u=i.session,c=i.user;return u!=null&&u.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(o){if(Re(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithSSO(e){var n,r,o;try{let s=null,i=null;return this.flowType==="pkce"&&([s,i]=await vo(this.storage,this.storageKey)),await $e(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((o=e==null?void 0:e.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:i}),headers:this.headers,xform:Bv})}catch(s){if(Re(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new kr;const{error:o}=await $e(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:o}})}catch(e){if(Re(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:o,options:s}=e,{error:i}=await $e(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:o,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in e){const{phone:r,type:o,options:s}=e,{data:i,error:l}=await $e(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:o,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:l}}throw new ki("You must provide either an email or phone number and a type")}catch(n){if(Re(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await Jr(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<gl:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const i=await Jr(this.userStorage,this.storageKey+"-user");i!=null&&i.user?e.user=i.user:e.user=xl()}if(this.storage.isServer&&e.user){let i=this.suppressGetSessionWarning;e=new Proxy(e,{get:(u,c,d)=>(!i&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(u,c,d))})}return{data:{session:e},error:null}}const{session:o,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:o},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await $e(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Nr}):await this._useSession(async n=>{var r,o,s;const{data:i,error:l}=n;if(l)throw l;return!(!((r=i.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new kr}:await $e(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(o=i.session)===null||o===void 0?void 0:o.access_token)!==null&&s!==void 0?s:void 0,xform:Nr})})}catch(n){if(Re(n))return dv(n)&&(await this._removeSession(),await Sr(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:o,error:s}=r;if(s)throw s;if(!o.session)throw new kr;const i=o.session;let l=null,u=null;this.flowType==="pkce"&&e.email!=null&&([l,u]=await vo(this.storage,this.storageKey));const{data:c,error:d}=await $e(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:u}),jwt:i.access_token,xform:Nr});if(d)throw d;return i.user=c.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(r){if(Re(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new kr;const n=Date.now()/1e3;let r=n,o=!0,s=null;const{payload:i}=vl(e.access_token);if(i.exp&&(r=i.exp,o=r<=n),o){const{session:l,error:u}=await this._callRefreshToken(e.refresh_token);if(u)return{data:{user:null,session:null},error:u};if(!l)return{data:{user:null,session:null},error:null};s=l}else{const{data:l,error:u}=await this._getUser(e.access_token);if(u)throw u;s={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(n){if(Re(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:i,error:l}=n;if(l)throw l;e=(r=i.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new kr;const{session:o,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:o?{data:{user:o.user,session:o},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(Re(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!Fn())throw new Ei("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ei(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new Yd("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Ei("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Yd("No code detected.");const{data:m,error:g}=await this._exchangeCodeForSession(e.code);if(g)throw g;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:m.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:o,access_token:s,refresh_token:i,expires_in:l,expires_at:u,token_type:c}=e;if(!s||!l||!i||!c)throw new Ei("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(l);let f=d+h;u&&(f=parseInt(u));const x=f-d;x*1e3<=So&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${x}s, should have been closer to ${h}s`);const y=f-h;d-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,f,d):d-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,f,d);const{data:b,error:_}=await this._getUser(s);if(_)throw _;const p={provider_token:r,provider_refresh_token:o,access_token:s,expires_in:h,expires_at:f,refresh_token:i,token_type:c,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:p,redirectType:e.type},error:null}}catch(r){if(Re(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await Jr(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:o,error:s}=n;if(s)return{error:s};const i=(r=o.session)===null||r===void 0?void 0:r.access_token;if(i){const{error:l}=await this.admin.signOut(i,e);if(l&&!(cv(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await Sr(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=wv(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,o;try{const{data:{session:s},error:i}=n;if(i)throw i;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((o=this.stateChangeEmitters.get(e))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,n={}){let r=null,o=null;this.flowType==="pkce"&&([r,o]=await vo(this.storage,this.storageKey,!0));try{return await $e(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:o,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(s){if(Re(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(Re(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:r,error:o}=await this._useSession(async s=>{var i,l,u,c,d;const{data:h,error:f}=s;if(f)throw f;const x=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(u=e.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await $e(this.fetch,"GET",x,{headers:this.headers,jwt:(d=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&d!==void 0?d:void 0})});if(o)throw o;return Fn()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(Re(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,o;const{data:s,error:i}=n;if(i)throw i;return await $e(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(o=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&o!==void 0?o:void 0})})}catch(n){if(Re(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await Ev(async o=>(o>0&&await kv(200*Math.pow(2,o-1)),this._debug(n,"refreshing attempt",o),await $e(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ir})),(o,s)=>{const i=200*Math.pow(2,o);return s&&yl(s)&&Date.now()+i-r<So})}catch(r){if(this._debug(n,"error",r),Re(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),Fn()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const o=await Jr(this.storage,this.storageKey);if(o&&this.userStorage){let i=await Jr(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:o.user},await _o(this.userStorage,this.storageKey+"-user",i)),o.user=(e=i==null?void 0:i.user)!==null&&e!==void 0?e:xl()}else if(o&&!o.user&&!o.user){const i=await Jr(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(o.user=i.user,await Sr(this.storage,this.storageKey+"-user"),await _o(this.storage,this.storageKey,o)):o.user=xl()}if(this._debug(r,"session from storage",o),!this._isValidSession(o)){this._debug(r,"session is not valid"),o!==null&&await this._removeSession();return}const s=((n=o.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<gl;if(this._debug(r,`session has${s?"":" not"} expired with margin of ${gl}s`),s){if(this.autoRefreshToken&&o.refresh_token){const{error:i}=await this._callRefreshToken(o.refresh_token);i&&(console.error(i),yl(i)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(o.user&&o.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:l}=await this._getUser(o.access_token);!l&&(i!=null&&i.user)?(o.user=i.user,await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(r,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",o)}catch(o){this._debug(r,"error",o),console.error(o);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new kr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new $a;const{data:s,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!s.session)throw new kr;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const l={session:s.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(s){if(this._debug(o,"error",s),Re(s)){const i={session:null,error:s};return yl(s)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(i),i}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(s),s}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(e,n,r=!0){const o=`#_notifyAllSubscribers(${e})`;this._debug(o,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const s=[],i=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,n)}catch(u){s.push(u)}});if(await Promise.all(i),s.length>0){for(let l=0;l<s.length;l+=1)console.error(s[l]);throw s[0]}}finally{this._debug(o,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const n=Object.assign({},e),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await _o(this.userStorage,this.storageKey+"-user",{user:n.user});const o=Object.assign({},n);delete o.user;const s=tf(o);await _o(this.storage,this.storageKey,s)}else{const o=tf(n);await _o(this.storage,this.storageKey,o)}}async _removeSession(){this._debug("#_removeSession()"),await Sr(this.storage,this.storageKey),await Sr(this.storage,this.storageKey+"-code-verifier"),await Sr(this.storage,this.storageKey+"-user"),this.userStorage&&await Sr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Fn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),So);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const o=Math.floor((r.expires_at*1e3-e)/So);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${So}ms, refresh threshold is ${ju} ticks`),o<=ju&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof rm)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Fn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const o=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&o.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&o.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[s,i]=await vo(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(i)}`});o.push(l.toString())}if(r!=null&&r.queryParams){const s=new URLSearchParams(r.queryParams);o.push(s.toString())}return r!=null&&r.skipBrowserRedirect&&o.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${o.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:o,error:s}=n;return s?{data:null,error:s}:await $e(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(Re(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,o;const{data:s,error:i}=n;if(i)return{data:null,error:i};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:u,error:c}=await $e(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((o=u==null?void 0:u.totp)===null||o===void 0)&&o.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),{data:u,error:null})})}catch(n){if(Re(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:o,error:s}=n;if(s)return{data:null,error:s};const{data:i,error:l}=await $e(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:l})})}catch(n){if(Re(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:o,error:s}=n;return s?{data:null,error:s}:await $e(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(Re(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(e==null?void 0:e.factors)||[],o=r.filter(i=>i.factor_type==="totp"&&i.status==="verified"),s=r.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:r,totp:o,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,r;const{data:{session:o},error:s}=e;if(s)return{data:null,error:s};if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=vl(o.access_token);let l=null;i.aal&&(l=i.aal);let u=l;((r=(n=o.user.factors)===null||n===void 0?void 0:n.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(u="aal2");const d=i.amr||[];return{data:{currentLevel:l,nextLevel:u,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(l=>l.kid===e);if(r)return r;const o=Date.now();if(r=this.jwks.keys.find(l=>l.kid===e),r&&this.jwks_cached_at+lv>o)return r;const{data:s,error:i}=await $e(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=o,r=s.keys.find(l=>l.kid===e),!r)?null:r}async getClaims(e,n={}){try{let r=e;if(!r){const{data:x,error:y}=await this.getSession();if(y||!x.session)return{data:null,error:y};r=x.session.access_token}const{header:o,payload:s,signature:i,raw:{header:l,payload:u}}=vl(r);n!=null&&n.allowExpired||Ov(s.exp);const c=!o.alg||o.alg.startsWith("HS")||!o.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(o.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!c){const{error:x}=await this.getUser(r);if(x)throw x;return{data:{claims:s,header:o,signature:i},error:null}}const d=Tv(o.alg),h=await crypto.subtle.importKey("jwk",c,d,!0,["verify"]);if(!await crypto.subtle.verify(d,h,i,vv(`${l}.${u}`)))throw new Nu("Invalid JWT signature");return{data:{claims:s,header:o,signature:i},error:null}}catch(r){if(Re(r))return{data:null,error:r};throw r}}}Ks.nextInstanceID=0;const Jv=Ks;class Yv extends Jv{constructor(e){super(e)}}var Qv=function(t,e,n,r){function o(s){return s instanceof n?s:new n(function(i){i(s)})}return new(n||(n=Promise))(function(s,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?s(d.value):o(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};class Xv{constructor(e,n,r){var o,s,i;this.supabaseUrl=e,this.supabaseKey=n;const l=rv(e);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const u=`sb-${l.hostname.split(".")[0]}-auth-token`,c={db:Hy,realtime:Jy,auth:Object.assign(Object.assign({},Ky),{storageKey:u}),global:qy},d=nv(r??{},c);this.storageKey=(o=d.auth.storageKey)!==null&&o!==void 0?o:"",this.headers=(s=d.global.headers)!==null&&s!==void 0?s:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(h,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=d.auth)!==null&&i!==void 0?i:{},this.headers,d.global.fetch),this.fetch=Zy(n,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new hy(new URL("rest/v1",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new Wy(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new G0(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r={}){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return Qv(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:o,userStorage:s,storageKey:i,flowType:l,lock:u,debug:c},d,h){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Yv({url:this.authUrl.href,headers:Object.assign(Object.assign({},f),d),storageKey:i,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:o,userStorage:s,flowType:l,lock:u,debug:c,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(x=>x.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new Dy(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Zv=(t,e,n)=>new Xv(t,e,n);function ex(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}ex()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const tx="https://wjylzxsfevdlhqunvfqc.supabase.co",nx="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndqeWx6eHNmZXZkbGhxdW52ZnFjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg2ODMwOTEsImV4cCI6MjA3NDI1OTA5MX0.SuB0gd7-gefwpUHFnKsupDgo8P2VeLuMbdlsU6AMrLw",af=globalThis,Ve=af.__sg_supabase||(af.__sg_supabase=Zv(tx,nx,{auth:{persistSession:!0,autoRefreshToken:!0,storageKey:"salesgame-auth"},realtime:{params:{eventsPerSecond:10}}}));function rx(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,8)}`}function Js(){const t="sg_tab_player_id";let e=sessionStorage.getItem(t);return e||(e=rx(),sessionStorage.setItem(t,e)),e}function co(t="Jogador"){const e="sg_tab_player_name";let n=sessionStorage.getItem(e);return n||(n=t,sessionStorage.setItem(e,n)),n}function ox(t){return sessionStorage.setItem("sg_tab_player_name",t??"Jogador"),t}const sx="/dynamic-data-visualization-3d.jpg",ix="/SalesGame_Logo-removebg-preview.png",ax="/Multiplier-Copia.png",lx="/WhatsApp_Image_2025-06-24_at_16.47.00-removebg-preview.png";function ux({onEnter:t}){const[e,n]=E.useState(co("")),r=E.useRef(null);E.useEffect(()=>{var i;(i=r.current)==null||i.focus()},[]);function o(){const i=(e||"").trim();i&&(ox(i),t==null||t(i))}function s(i){i.key==="Enter"&&o()}return a.jsxs("div",{className:"start",children:[a.jsx("img",{className:"startBg",src:sx,alt:""}),a.jsx("div",{className:"startShade"}),a.jsx("div",{className:"startHeader",children:a.jsx("img",{className:"startLogo",src:ix,alt:"Sales GAME"})}),a.jsx("div",{className:"startCenter",children:a.jsxs("div",{className:"startCard",children:[a.jsx("label",{className:"startLabel",htmlFor:"playerName",children:"Nome do Jogador"}),a.jsx("input",{id:"playerName",ref:r,className:"startInput",placeholder:"Digite seu nome",value:e,onChange:i=>n(i.target.value),onKeyDown:s,maxLength:30}),a.jsx("button",{className:"startBtn",onClick:o,children:"Entrar"})]})}),a.jsxs("div",{className:"startFooter",children:[a.jsxs("div",{className:"startLinks",children:[a.jsx("div",{children:"@multiplier.educacao"}),a.jsx("div",{children:"https://multipliereducacao.com.br/"})]}),a.jsx("div",{className:"startBrand",children:a.jsx("img",{className:"startBrandLogo",src:ax,alt:"Multiplier"})})]}),a.jsx("img",{className:"startCoach",src:lx,alt:"",draggable:"false"})]})}async function cx(){const{data:t,error:e}=await Ve.from("lobbies").select(`
      id,
      name,
      max_players,
      status,
      created_at,
      lobby_players!left(count)
    `).order("created_at",{ascending:!0});if(e)throw e;return(t||[]).map(n=>{var r,o;return{id:n.id,name:n.name,max:n.max_players,status:n.status||"open",players:(((o=(r=n.lobby_players)==null?void 0:r[0])==null?void 0:o.count)??0)|0}})}function dx(t){const e=Ve.channel("lobbies-list").on("postgres_changes",{event:"*",schema:"public",table:"lobbies"},()=>t==null?void 0:t()).on("postgres_changes",{event:"*",schema:"public",table:"lobby_players"},()=>t==null?void 0:t()).subscribe();return()=>Ve.removeChannel(e)}async function fx({name:t,hostId:e,max:n=4}){if(!e)throw new Error("hostId obrigatrio em createLobby");const o={id:typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,8)}`,name:t,host_id:e,max_players:Number(n)||4,status:"open",created_at:new Date().toISOString()},{data:s,error:i}=await Ve.from("lobbies").insert(o).select("id").single();if(i)throw i;return s.id}async function Du({lobbyId:t,playerId:e,playerName:n,ready:r=!1}){const{data:o,error:s}=await Ve.from("lobbies").select("id, max_players, status, host_id").eq("id",t).single();if(s)throw s;if(o.status!=="open")throw new Error("Sala fechada.");const{count:i,error:l}=await Ve.from("lobby_players").select("lobby_id",{count:"exact",head:!0}).eq("lobby_id",t);if(l)throw l;if((i||0)>=o.max_players)throw new Error("Sala cheia.");try{window.__MY_UID=e}catch{}const{error:u}=await Ve.from("lobby_players").upsert({lobby_id:t,player_id:e,player_name:n,ready:!!r,joined_at:new Date().toISOString()},{onConflict:"lobby_id,player_id"});if(u)throw u;o.host_id||await Ve.from("lobbies").update({host_id:e}).eq("id",t)}async function lf({lobbyId:t,playerId:e}){var l;const{data:n,error:r}=await Ve.from("lobbies").select("id, host_id").eq("id",t).single();if(r)throw r;const{error:o}=await Ve.from("lobby_players").delete().match({lobby_id:t,player_id:e});if(o)throw o;const{data:s,error:i}=await Ve.from("lobby_players").select("player_id, joined_at").eq("lobby_id",t).order("joined_at",{ascending:!0});if(i)throw i;if(!s||s.length===0){await Ve.from("lobbies").delete().eq("id",t);return}if((n==null?void 0:n.host_id)===e){const u=(l=s[0])==null?void 0:l.player_id;u&&await Ve.from("lobbies").update({host_id:u}).eq("id",t)}}async function uf(t){const{data:e,error:n}=await Ve.from("lobby_players").select("player_id, player_name, ready, joined_at").eq("lobby_id",t).order("joined_at",{ascending:!0});if(n)throw n;return e||[]}async function hx({lobbyId:t,playerId:e,ready:n}){const{error:r}=await Ve.from("lobby_players").update({ready:n}).match({lobby_id:t,player_id:e});if(r)throw r}async function px(t,e,n){return hx({lobbyId:t,playerId:e,ready:n})}async function mx({lobbyId:t,playerId:e,playerName:n}){const{error:r}=await Ve.from("lobby_players").update({player_name:n}).match({lobby_id:t,player_id:e});if(r)throw r}async function cf(t,e){const{error:n}=await Ve.from("lobbies").update({status:e}).eq("id",t);if(n)throw n}function gx(t,e){let n=0;const r=()=>{n&&cancelAnimationFrame(n),n=requestAnimationFrame(()=>e==null?void 0:e())},o=Ve.channel(`lobby-${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"lobby_players",filter:`lobby_id=eq.${t}`},s=>{console.debug("[rt] lobby_players:INSERT",s.new),r()}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"lobby_players",filter:`lobby_id=eq.${t}`},s=>{console.debug("[rt] lobby_players:UPDATE",s.new),r()}).on("postgres_changes",{event:"DELETE",schema:"public",table:"lobby_players",filter:`lobby_id=eq.${t}`},s=>{console.debug("[rt] lobby_players:DELETE",s.old),r()}).on("postgres_changes",{event:"*",schema:"public",table:"lobbies",filter:`id=eq.${t}`},s=>{console.debug("[rt] lobbies:*",s.new||s.old),r()}).subscribe();return()=>{n&&cancelAnimationFrame(n),Ve.removeChannel(o)}}async function yx(t){const{data:e,error:n}=await Ve.from("lobbies").select("id,name,status,max_players,host_id,created_at").eq("id",t).single();if(n)throw n;return e}async function vx({lobbyId:t}){var o;const{data:e}=await Ve.from("lobby_players").select("player_id, player_name, ready").eq("lobby_id",t),{data:n,error:r}=await Ve.from("matches").insert({lobby_id:t,host_id:((o=e==null?void 0:e[0])==null?void 0:o.player_id)||null,state:{players:e},created_at:new Date().toISOString()}).select("id").single();if(r)throw r;return n}async function xx(t){const{data:e,error:n}=await Ve.from("matches").select("id, lobby_id, created_at").eq("lobby_id",t).order("created_at",{ascending:!1}).limit(1);if(n)throw n;return(e==null?void 0:e[0])||null}async function wl({roomCode:t,playerId:e}){if(!t||!e){console.log("[leaveRoom] Parmetros invlidos:",{roomCode:t,playerId:e});return}try{console.log(`[leaveRoom] Tentando remover jogador ${e} da sala ${t}`);const{data:n,error:r}=await Ve.from("lobbies").select("id, name, host_id").eq("id",t).single();if(r){console.warn("[leaveRoom] Erro ao buscar lobby:",r);return}if(!n){console.log(`[leaveRoom] Lobby ${t} no encontrado`);return}console.log("[leaveRoom] Lobby encontrado:",n);const{error:o}=await Ve.from("lobby_players").delete().match({lobby_id:t,player_id:e});o?console.warn("[leaveRoom] Erro ao remover jogador:",o):console.log(`[leaveRoom] Jogador ${e} removido do lobby ${t}`);const{data:s,error:i}=await Ve.from("lobby_players").select("player_id").eq("lobby_id",t);if(i){console.warn("[leaveRoom] Erro ao contar jogadores restantes:",i);return}if(!s||s.length===0){const{error:l}=await Ve.from("lobbies").delete().eq("id",t);l?console.warn("[leaveRoom] Erro ao deletar lobby vazio:",l):console.log(`[leaveRoom] Lobby ${t} deletado com sucesso (sem jogadores)`)}else if(console.log(`[leaveRoom] Jogador ${e} saiu do lobby ${t}. Restam ${s.length} jogadores.`),n.host_id===e&&s.length>0){const l=s[0].player_id,{error:u}=await Ve.from("lobbies").update({host_id:l}).eq("id",t);u?console.warn("[leaveRoom] Erro ao transferir host:",u):console.log(`[leaveRoom] Host transferido para ${l}`)}}catch(n){console.error("[leaveRoom] Erro inesperado:",n)}}function bx({onEnterRoom:t}){const[e,n]=E.useState([]),[r,o]=E.useState(!1);async function s(){o(!0);try{const c=await cx();n(c)}finally{o(!1)}}E.useEffect(()=>(s(),dx(()=>s())),[]);async function i(){const c=co("Jogador"),d=`Sala de ${c}`,h=prompt("Nome do lobby:",d)||d,f=Js();try{const x=await fx({name:h,hostId:f,max:4});await Du({lobbyId:x,playerId:f,playerName:c,ready:!1}),t==null||t(x)}catch(x){alert(x.message||"No foi possvel criar o lobby."),await s()}}async function l(c){try{const d=co("Jogador"),h=Js();await Du({lobbyId:c,playerId:h,playerName:d,ready:!1}),t==null||t(c)}catch(d){alert(d.message||"No foi possvel entrar no lobby.")}}const u={page:{minHeight:"100vh",background:"#0f0f12",color:"#e9ecf1",padding:"32px 16px",display:"flex",justifyContent:"center"},container:{width:"100%",maxWidth:980},headerRow:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:16,marginBottom:16,flexWrap:"wrap"},title:{fontSize:28,fontWeight:800,color:"#fff"},actions:{display:"flex",gap:10},btn:{padding:"12px 16px",border:0,borderRadius:12,fontWeight:800,cursor:"pointer"},btnPrimary:{background:"#4f46e5",color:"#fff",boxShadow:"0 8px 24px rgba(79,70,229,.25)"},btnSecondary:{background:"#20222a",color:"#fff",border:"1px solid #2b2e38"},grid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:14},card:{background:"linear-gradient(180deg, rgba(255,255,255,0.02) 0%, rgba(255,255,255,0.00) 100%)",border:"1px solid rgba(255,255,255,.08)",borderRadius:16,padding:16,display:"flex",flexDirection:"column",gap:12,boxShadow:"0 10px 20px rgba(0,0,0,.25)"},cardHeader:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:10},lobbyName:{fontSize:18,fontWeight:800,color:"#fff",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:1},meta:{fontSize:13,color:"#b8c0cc"},joinBtn:{padding:"10px 14px",borderRadius:10,border:0,background:"#7c3aed",color:"#fff",fontWeight:800,cursor:"pointer",boxShadow:"0 10px 20px rgba(124,58,237,.25)"},disabled:{opacity:.6,cursor:"not-allowed",filter:"grayscale(.3)"},empty:{marginTop:24,padding:18,borderRadius:12,border:"1px dashed rgba(255,255,255,.12)",color:"#c7cfdb",textAlign:"center"}};return a.jsx("div",{style:u.page,children:a.jsxs("div",{style:u.container,children:[a.jsxs("div",{style:u.headerRow,children:[a.jsx("h2",{style:u.title,children:"SalesGame  Lobbies"}),a.jsxs("div",{style:u.actions,children:[a.jsx("button",{style:{...u.btn,...u.btnPrimary},onClick:i,children:"Criar Lobby"}),a.jsx("button",{style:{...u.btn,...u.btnSecondary},onClick:s,disabled:r,children:r?"Atualizando":"Atualizar"})]})]}),e.length===0&&!r?a.jsxs("div",{style:u.empty,children:["Nenhuma sala criada ainda. Clique em ",a.jsx("b",{children:"Criar Lobby"})," para comear."]}):a.jsx("div",{style:u.grid,children:e.map(c=>{const d=(c.players??0)>=(c.max??4),h=(c.status??"open")==="open",f=d||!h;return a.jsxs("div",{style:u.card,children:[a.jsxs("div",{style:u.cardHeader,children:[a.jsx("div",{style:u.lobbyName,title:c.name,children:c.name}),a.jsxs("span",{style:u.meta,children:[c.players??0,"/",c.max??4]})]}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("span",{style:u.meta,children:["status: ",c.status??"open"]}),a.jsx("button",{style:{...u.joinBtn,...f?u.disabled:{}},disabled:f,onClick:()=>l(c.id),title:f?d?"Sala cheia":"Sala no est aberta":"Entrar na sala",children:"Entrar"})]})]},c.id)})})]})})}function wx({lobbyId:t,onBack:e,onStartGame:n}){const r=Js(),o=co("Jogador"),[s,i]=E.useState(null),[l,u]=E.useState([]),[c,d]=E.useState(!0),[h,f]=E.useState(!1),x=E.useRef(!1),y=E.useRef(!0),b=E.useRef(!1),_=E.useRef(!1),p=E.useMemo(()=>(s==null?void 0:s.host_id)===r,[s,r]),m=E.useMemo(()=>l.find(v=>v.player_id===r),[l,r]),g=E.useMemo(()=>l.filter(v=>v.ready).length,[l]),w=p&&(s==null?void 0:s.status)==="open"&&l.length>=1&&g===l.length;console.log("[PlayersLobby] Debug:",{players:l.length,readyCount:g,lobbyStatus:s==null?void 0:s.status,amHost:p,canStart:w,meId:r,meName:o});async function j(v){if(_.current)return;const D=await xx(t);if(D!=null&&D.id){_.current=!0;const O=(v||[]).map((M,te)=>({id:M.player_id,name:M.player_name,index:te}));n==null||n({lobbyId:t,matchId:D==null?void 0:D.id,players:O,me:{id:r,name:o}})}}async function R(){y.current&&d(!0);try{console.log("[PlayersLobby] refreshAll - buscando lobby:",t);const[v,D]=await Promise.all([yx(t),uf(t)]);console.log("[PlayersLobby] refreshAll - lobby:",v,"players:",D),i(v),u(D);const O=D.find(M=>M.player_id===r);if(console.log("[PlayersLobby] refreshAll - mine:",O,"meId:",r),!O&&!x.current&&(v==null?void 0:v.status)==="open"){console.log("[PlayersLobby] refreshAll - entrando na sala"),x.current=!0;try{await Du({lobbyId:t,playerId:r,playerName:o,ready:!1}),console.log("[PlayersLobby] refreshAll - entrada na sala bem-sucedida");const M=await uf(t);console.log("[PlayersLobby] refreshAll - jogadores aps entrada:",M),u(M)}catch(M){console.error("[PlayersLobby] refreshAll - erro ao entrar na sala:",M)}}if(O&&!b.current&&o&&O.player_name!==o){console.log("[PlayersLobby] refreshAll - sincronizando nome"),b.current=!0;try{await mx({lobbyId:t,playerId:r,playerName:o})}catch{}}await j(D)}catch(v){console.error("[PlayersLobby] refreshAll - erro:",v)}finally{y.current&&(y.current=!1,d(!1))}}E.useEffect(()=>{const v=()=>{lf({lobbyId:t,playerId:r}).catch(()=>{})},D=()=>v();return window.addEventListener("pagehide",D),window.addEventListener("beforeunload",D),()=>{window.removeEventListener("pagehide",D),window.removeEventListener("beforeunload",D)}},[t,r]),E.useEffect(()=>(x.current=!1,y.current=!0,b.current=!1,_.current=!1,R(),gx(t,()=>R())),[t]);async function C(v){if(!m)return;f(!0);const D=m.ready;u(O=>O.map(M=>M.player_id===r?{...M,ready:v}:M));try{await px(t,r,v)}catch(O){u(M=>M.map(te=>te.player_id===r?{...te,ready:D}:te)),console.error("setReadyUI failed",O)}finally{f(!1)}}async function S(){try{await lf({lobbyId:t,playerId:r})}finally{e==null||e()}}async function A(){if(!w)return;const v=s==null?void 0:s.status;await cf(t,"locked");try{const D=await vx({lobbyId:t});_.current=!0;const O=l.map((M,te)=>({id:M.player_id,name:M.player_name,index:te}));n==null||n({lobbyId:t,matchId:D==null?void 0:D.id,players:O,me:{id:r,name:o}})}catch(D){console.error("startMatch failed",D),await cf(t,v||"open")}}return a.jsx("div",{style:qe.page,children:a.jsxs("div",{style:qe.container,children:[a.jsxs("div",{style:qe.top,children:[a.jsx("button",{style:qe.backBtn,onClick:S,children:" Voltar"}),a.jsxs("h2",{style:qe.title,children:["SalesGame  ",(s==null?void 0:s.name)||"..."]})]}),a.jsxs("div",{style:qe.table,children:[a.jsxs("div",{style:qe.thead,children:[a.jsx("div",{style:qe.colPlayer,children:"Jogador"}),a.jsx("div",{style:qe.colReady,children:"Pronto?"})]}),c?a.jsx("div",{style:qe.loading,children:"Carregando..."}):l.map(v=>a.jsxs("div",{style:qe.row,children:[a.jsxs("div",{style:qe.colPlayer,children:[a.jsx("span",{style:qe.avatar,children:(v.player_name||"?").slice(0,2).toLowerCase()}),a.jsx("span",{children:v.player_name||"Annimo"}),(s==null?void 0:s.host_id)===v.player_id&&a.jsx("span",{style:qe.badgeHost,children:"Host"}),v.player_id===r&&a.jsx("span",{style:qe.badgeYou,children:"Voc"})]}),a.jsx("div",{style:qe.colReady,children:v.player_id===r?a.jsxs("div",{style:{display:"flex",gap:8},children:[a.jsx("button",{style:{...qe.btn,...m!=null&&m.ready?qe.btnGhost:qe.btnDark},onClick:()=>C(!1),disabled:h||!(m!=null&&m.ready),children:"No pronto"}),a.jsxs("button",{style:{...qe.btn,...m!=null&&m.ready?qe.btnPrimary:qe.btnPurple},onClick:()=>C(!0),disabled:h||!!(m!=null&&m.ready),children:[" ",m!=null&&m.ready?"Pronto":"Ficar pronto"]})]}):a.jsx("span",{style:v.ready?qe.pillReady:qe.pillWait,children:v.ready?"Pronto":"Aguardando"})})]},v.player_id))]}),a.jsxs("div",{style:qe.footer,children:[a.jsxs("div",{style:qe.statusWrap,children:[a.jsx("span",{style:{...qe.dot,background:(s==null?void 0:s.status)==="open"?"#22c55e":"#f59e0b"}}),a.jsxs("span",{children:["status: ",(s==null?void 0:s.status)||"..."]}),a.jsxs("span",{style:{marginLeft:12},children:["Prontos: ",g,"/",l.length]})]}),a.jsxs("div",{style:{display:"flex",gap:12},children:[a.jsx("button",{style:{...qe.btn,...w?qe.btnPrimary:qe.disabled},onClick:A,disabled:!w,children:"Iniciar partida"}),a.jsx("button",{style:{...qe.btn,...qe.btnDark},onClick:S,children:"Sair da sala"})]})]})]})})}const qe={page:{minHeight:"100vh",background:"#0f0f12",color:"#e9ecf1",padding:"24px 16px",display:"flex",justifyContent:"center"},container:{width:"100%",maxWidth:980},top:{display:"flex",alignItems:"center",gap:12,marginBottom:16},backBtn:{padding:"10px 14px",background:"#20222a",border:"1px solid #2b2e38",borderRadius:12,color:"#fff",cursor:"pointer"},title:{margin:0,fontSize:28,fontWeight:800},table:{background:"rgba(255,255,255,.02)",border:"1px solid rgba(255,255,255,.08)",borderRadius:16,overflow:"hidden"},thead:{display:"grid",gridTemplateColumns:"1fr 220px",padding:"12px 16px",borderBottom:"1px solid rgba(255,255,255,.08)",color:"#c7cfdb"},row:{display:"grid",gridTemplateColumns:"1fr 220px",padding:"12px 16px",borderBottom:"1px solid rgba(255,255,255,.06)"},colPlayer:{display:"flex",alignItems:"center",gap:10,minWidth:0},colReady:{display:"flex",alignItems:"center",justifyContent:"flex-end"},avatar:{width:28,height:28,borderRadius:999,background:"#1f2430",display:"grid",placeItems:"center",color:"#c7cfdb",fontSize:12,textTransform:"lowercase"},badgeHost:{marginLeft:8,fontSize:12,background:"#fde68a",color:"#111827",padding:"2px 8px",borderRadius:999,fontWeight:800},badgeYou:{marginLeft:8,fontSize:12,background:"#bfdbfe",color:"#111827",padding:"2px 8px",borderRadius:999,fontWeight:800},loading:{padding:16,color:"#c7cfdb"},pillReady:{background:"rgba(34,197,94,.15)",color:"#22c55e",padding:"6px 10px",borderRadius:999,fontWeight:700},pillWait:{background:"rgba(245,158,11,.14)",color:"#f59e0b",padding:"6px 10px",borderRadius:999,fontWeight:700},footer:{display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:16},statusWrap:{display:"flex",alignItems:"center",gap:6,color:"#c7cfdb"},dot:{width:8,height:8,borderRadius:"50%"},btn:{padding:"12px 16px",border:0,borderRadius:12,fontWeight:800,cursor:"pointer"},btnPrimary:{background:"#4f46e5",color:"#fff",boxShadow:"0 8px 24px rgba(79,70,229,.25)"},btnPurple:{background:"#7c3aed",color:"#fff"},btnDark:{background:"#20222a",color:"#fff",border:"1px solid #2b2e38"},btnGhost:{background:"transparent",color:"#e9ecf1",border:"1px solid rgba(255,255,255,.15)"},disabled:{opacity:.5,cursor:"not-allowed",filter:"grayscale(.25)"}},Sx="/board.jpg",Au=800,Ou=700,Ia=[{nx:.9278494291885221,ny:.9008218764923216},{nx:.8188460351743289,ny:.9120818357755046},{nx:.7145819191607529,ny:.920124663834921},{nx:.6016291268127121,ny:.920124663834921},{nx:.49104597346497997,ny:.9233417950586875},{nx:.37888306078370876,ny:.920124663834921},{nx:.24618327676643012,ny:.9152989669992712},{nx:.21695772909595804,ny:.7994822429436751},{nx:.1853625424251774,ny:.7270967904089275},{nx:.1340203640851589,ny:.6354085505315806},{nx:.12851782363977485,ny:.5145797598627787},{nx:.12664165103189493,ny:.37392795883361923},{nx:.05347091932457786,ny:.30017152658662094},{nx:.051594746716697934,ny:.20240137221269297},{nx:.14540337711069418,ny:.12006861063464837},{nx:.23921200750469043,ny:.11663807890222985},{nx:.3771106941838649,ny:.11663807890222985},{nx:.5037523452157598,ny:.12006861063464837},{nx:.5975609756097561,ny:.1320754716981132},{nx:.5984990619136961,ny:.24356775300171526},{nx:.5065666041275797,ny:.2692967409948542},{nx:.398686679174484,ny:.27101200686106347},{nx:.28893058161350843,ny:.27101200686106347},{nx:.2373358348968105,ny:.3687821612349914},{nx:.23921200750469043,ny:.48027444253859347},{nx:.24202626641651032,ny:.5660377358490566},{nx:.26454033771106944,ny:.6895368782161235},{nx:.3330206378986867,ny:.6946826758147513},{nx:.35647279549718575,ny:.5831903945111492},{nx:.35647279549718575,ny:.4716981132075472},{nx:.3818011257035647,ny:.37735849056603776},{nx:.5225140712945591,ny:.3653516295025729},{nx:.6238273921200751,ny:.3687821612349914},{nx:.7223264540337712,ny:.40308747855917665},{nx:.6613508442776735,ny:.5197255574614065},{nx:.5300187617260788,ny:.5025728987993139},{nx:.4427767354596623,ny:.5694682675814752},{nx:.4896810506566604,ny:.6861063464837049},{nx:.6163227016885553,ny:.6861063464837049},{nx:.724202626641651,ny:.6861063464837049},{nx:.8273921200750469,ny:.660377358490566},{nx:.8395872420262664,ny:.5368782161234992},{nx:.8395872420262664,ny:.4339622641509434},{nx:.8283302063789869,ny:.313893653516295},{nx:.7176360225140713,ny:.30017152658662094},{nx:.6876172607879925,ny:.22298456260720412},{nx:.698874296435272,ny:.1457975986277873},{nx:.8020637898686679,ny:.11663807890222985},{nx:.8958724202626641,ny:.11663807890222985},{nx:.9446529080675422,ny:.21783876500857632},{nx:.9446529080675422,ny:.3293310463121784},{nx:.9380863039399625,ny:.45797598627787306},{nx:.9409005628517824,ny:.5711835334476844},{nx:.950281425891182,ny:.6723842195540308},{nx:.9540337711069419,ny:.7804459691252144}],Ns=Ia.length;function om(t,e,n){return{x:t.nx*e,y:t.ny*n}}Ia.map(t=>[t.nx*Au,t.ny*Ou]);function _x({visible:t=!0,boardWidth:e,boardHeight:n}){return t?a.jsx("div",{className:"markersLayer",children:Ia.map((r,o)=>{const{x:s,y:i}=om(r,e,n);return a.jsx("div",{className:"marker",style:{left:s,top:i},title:`Casa ${o+1}`,children:o+1},o)})}):null}function kx({boardRef:t,expected:e=55,onFinish:n,initial:r=[]}){const[o,s]=E.useState(r);function i(x){if(!(t!=null&&t.current))return;const y=t.current.getBoundingClientRect(),b=x.clientX-y.left,_=x.clientY-y.top,p=b/y.width,m=_/y.height;s(g=>g.length>=e?g:[...g,{nx:p,ny:m}])}function l(){s(x=>x.slice(0,-1))}function u(){s([])}const c=E.useMemo(()=>JSON.stringify(o,null,2),[o]);async function d(){try{await navigator.clipboard.writeText(c),alert("Copiado para a rea de transferncia!")}catch{alert("No foi possvel copiar. Use o boto Baixar.")}}function h(){const x=new Blob([c],{type:"application/json"}),y=URL.createObjectURL(x),b=document.createElement("a");b.href=y,b.download="track-points-55.json",document.body.appendChild(b),b.click(),b.remove(),URL.revokeObjectURL(y)}function f(){n==null||n(o),console.log(`TRACK_POINTS_NORM (cole em src/data/track.js):
`,c),alert("Finalizado! O JSON foi impresso no console. Copie e cole em src/data/track.js")}return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"recLayer",onClick:i}),a.jsx("div",{className:"recDotsLayer",pointerEvents:"none",children:o.map((x,y)=>a.jsx("div",{className:"recDot",style:{left:`${x.nx*100}%`,top:`${x.ny*100}%`},title:`Casa ${y+1}`,children:y+1},y))}),a.jsxs("div",{className:"recToolbar",children:[a.jsxs("div",{className:"recInfo",children:[a.jsx("b",{children:"Gravando trilha"}),"  clique nas casas na ordem.",a.jsxs("span",{children:["Marcados: ",a.jsx("b",{children:o.length})," / ",e]})]}),a.jsxs("div",{className:"recBtns",children:[a.jsx("button",{onClick:l,disabled:!o.length,children:"Desfazer"}),a.jsx("button",{onClick:u,disabled:!o.length,children:"Limpar"}),a.jsx("button",{onClick:d,disabled:!o.length,children:"Copiar JSON"}),a.jsx("button",{onClick:h,disabled:!o.length,children:"Baixar .json"}),a.jsx("button",{onClick:f,disabled:o.length!==e,children:"Finalizar"})]})]})]})}const Ex=40,jx=1.15,Cx=3,Rx="0 8px 18px rgba(0,0,0,.35)",df={cash:18e3,possibAt:0,clientsAt:0,faturamento:770,manutencao:1150,emprestimos:0,vendedoresComuns:0,fieldSales:0,insideSales:0,mixDBens:4e3,erpClientes:0,manualOnboarding:!0,azul:0,amarelo:0,roxo:0,gestores:0};function Nx({players:t,turnIdx:e,recordTrack:n=!1,matchId:r,me:o,onMeHud:s}){const i=E.useRef(null),[l,u]=E.useState({w:Au,h:Ou}),c=(o==null?void 0:o.id)||Js(),d=co("Jogador"),h=E.useMemo(()=>(t==null?void 0:t.find(w=>w.id===c))||null,[t,c]),f=(o==null?void 0:o.name)||(h==null?void 0:h.name)||d,x=(h==null?void 0:h.color)||"#6c5ce7",y=E.useMemo(()=>`sg_stats_v1:${r||"local"}:${c}`,[r,c]),[b,_]=E.useState(()=>{try{const w=sessionStorage.getItem(y);return w?JSON.parse(w):df}catch{return df}});E.useEffect(()=>{try{sessionStorage.setItem(y,JSON.stringify(b))}catch{}},[y,b]),E.useEffect(()=>{const w={id:c,name:f,color:x,cash:b.cash,possibAt:b.possibAt,clientsAt:b.clientsAt,matchId:r||"local"};s==null||s(w),document.dispatchEvent(new CustomEvent("sg:meHud",{detail:w}))},[c,f,x,b.cash,b.possibAt,b.clientsAt,r]),E.useLayoutEffect(()=>{if(!i.current)return;const w=i.current,j=new ResizeObserver(R=>{for(const C of R){const S=C.contentRect;u({w:S.width,h:S.height})}});return j.observe(w),()=>j.disconnect()},[]);const p=l.w/Au,m=l.h/Ou,g=Math.min(p,m);return a.jsxs("div",{className:"board",ref:i,children:[a.jsx("img",{src:Sx,alt:"Board",className:"boardImg"}),n&&a.jsx(kx,{boardRef:i,expected:55,onFinish:w=>{console.log("TRACK_POINTS_NORM (cole em src/data/track.js):",JSON.stringify(w,null,2))}}),!n&&a.jsxs(a.Fragment,{children:[a.jsx(_x,{visible:!1,boardWidth:l.w,boardHeight:l.h}),t.map((w,j)=>{const R=j===e,C=(w.pos%Ns+Ns)%Ns,S=Ia[C],A=om(S,l.w,l.h),v=j*12*g,O=Ex*g*(R?jx:1),M=Math.max(2,Cx*g),te=["","","","","","","",""],ne=te[j%te.length];return a.jsx("div",{className:"token",style:{position:"absolute",left:A.x+v,top:A.y-v,transform:"translate(-50%, -50%)",width:O,height:O,borderRadius:"50%",background:w.color,border:`${M}px solid rgba(255,255,255,.95)`,boxShadow:Rx,pointerEvents:"none",display:"grid",placeItems:"center",color:"#000",fontWeight:900,userSelect:"none",zIndex:R?4:3,fontSize:`${Math.max(16,O*.6)}px`},title:`${w.name}  Casa ${C+1}`,"aria-label":`${w.name} est na casa ${C+1}`,children:R?"":ne},w.id)})]})]})}function Dx({totals:t,players:e}){return E.useEffect(()=>{console.groupCollapsed("[HUD] totals"),console.log(t),console.groupEnd()},[t]),a.jsxs("div",{className:"hud",children:[a.jsxs("div",{className:"panel",children:[a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Faturamento:"})," ",a.jsxs("span",{className:"pos",children:["$ ",t.faturamento]})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Manuteno:"})," ",a.jsxs("span",{className:"neg",children:["$ ",t.manutencao]})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Emprstimos:"})," ",a.jsxs("span",{children:["$ ",t.emprestimos]})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Vendedores Comuns:"})," ",a.jsx("span",{children:t.vendedoresComuns})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Field Sales:"})," ",a.jsx("span",{children:t.fieldSales})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Inside Sales:"})," ",a.jsx("span",{children:t.insideSales})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Mix Produtos:"})," ",a.jsx("span",{children:t.mixProdutos})," ",a.jsx("b",{children:" Bens:"})," ",a.jsxs("span",{children:["$ ",t.bens]})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"ERP/Sistemas:"})," ",a.jsx("span",{children:t.erpSistemas})," ",a.jsx("b",{children:" Clientes:"})," ",a.jsx("span",{children:t.clientes})]}),a.jsxs("div",{children:[a.jsx("b",{children:"Manual Onboarding:"})," "]}),a.jsxs("div",{children:[a.jsx("b",{children:"Azul:"})," ",a.jsx("span",{children:t.az||0})," ",a.jsx("b",{children:" Amarelo: "}),a.jsx("span",{children:t.am||0})," ",a.jsx("b",{children:"Roxo:"})," ",a.jsx("span",{children:t.rox||0})]}),a.jsxs("div",{children:[a.jsx("b",{children:"Gestores Comerciais:"})," ",a.jsx("span",{children:t.gestores??t.gestoresComerciais??0})]}),a.jsxs("div",{children:[a.jsx("b",{children:"Capacidade:"})," ",a.jsx("span",{children:t.possibAt??0}),"  ",a.jsx("b",{children:"Em Atendimento:"})," ",a.jsx("span",{children:t.clientsAt??0})]})]}),a.jsxs("div",{className:"score",children:[a.jsx("div",{className:"title",children:"Placar"}),e.map(n=>a.jsxs("div",{className:"row",children:[a.jsx("span",{children:n.name}),a.jsx("span",{children:n.cash})]},n.id))]})]})}function Ax({onAction:t,current:e,isMyTurn:n=!0}){const r=!!(e!=null&&e.bankrupt),o=!!n&&!r;E.useEffect(()=>{console.groupCollapsed("[Controls] render"),console.log("current player:",e),console.log("isMyTurn prop:",n),console.log("isBankrupt:",r),console.log("canRoll (final):",o),console.groupEnd()},[e==null?void 0:e.id,e==null?void 0:e.name,e==null?void 0:e.bankrupt,n,o]);const s=()=>{if(console.log("[Controls] click => Rolar Dado & Andar (canRoll=%s)",o),!o)return;const u=Math.floor(Math.random()*6)+1,c=0,d=`Dado: ${u}`;console.log("[Controls] onAction ROLL => steps=%d cashDelta=%d note=%s",u,c,d),t==null||t({type:"ROLL",steps:u,cashDelta:c,note:d})},i=async()=>{r||(console.log("[Controls] click => Recuperao Financeira"),t==null||t({type:"RECOVERY_MODAL"}))},l=async()=>{r||(console.log("[Controls] click => Declarar Falncia"),t==null||t({type:"BANKRUPT_MODAL"}))};return a.jsxs("div",{className:`controls ${o?"":"is-wait"} ${r?"is-bankrupt":""}`,children:[a.jsx("button",{className:"btn primary",onClick:i,disabled:r,"aria-disabled":r,children:"RECUPERAO FINANCEIRA"}),a.jsx("button",{className:"btn dark",onClick:l,disabled:r,"aria-disabled":r,children:"DECLARAR FALNCIA"}),a.jsxs("div",{className:"turnBox",children:[a.jsxs("div",{children:["Vez de: ",a.jsx("b",{children:e==null?void 0:e.name})]}),a.jsx("button",{className:"btn go",onClick:s,disabled:!o,"aria-disabled":!o,children:"Rolar Dado & Andar"})]})]})}function oi({children:t,onClose:e,zIndex:n=3e3}){const r=()=>{typeof e=="function"&&e()};return a.jsx("div",{className:"sg-modal-backdrop",style:{position:"fixed",inset:0,background:"rgba(8,10,16,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:n},onClick:r,children:a.jsx("div",{className:"sg-modal-card",style:{position:"relative",background:"#0f1420",border:"1px solid rgba(255,255,255,.1)",borderRadius:14,width:"min(780px, 92vw)",maxWidth:"92vw",color:"#fff",boxShadow:"0 20px 60px rgba(0,0,0,.45)"},onClick:o=>o.stopPropagation(),children:t})})}function Ox({players:t=[],onExit:e,onResolve:n}){const r=E.useMemo(()=>{const u=[...t].map(c=>({...c,patrimonio:(Number(c.cash)||0)+(Number(c.bens)||0)})).sort((c,d)=>d.patrimonio-c.patrimonio);return[u[1],u[0],u[2]]},[t]),o=r==null?void 0:r[1],s=r==null?void 0:r[0],i=r==null?void 0:r[2],l=()=>{n?n({action:"EXIT"}):e==null||e()};return a.jsx(oi,{zIndex:2147483647,onClose:()=>{},children:a.jsxs("div",{style:qn.wrap,children:[a.jsx("h1",{style:qn.title,children:" Fim da 5 Rodada"}),a.jsxs("p",{style:qn.subtitle,children:["Vence quem tiver ",a.jsx("b",{children:"Saldo + Bens"}),". Eis o pdio:"]}),a.jsxs("div",{style:qn.podium,children:[a.jsx(Sl,{place:"second",player:s}),a.jsx(Sl,{place:"first",player:o,big:!0}),a.jsx(Sl,{place:"third",player:i})]}),a.jsx("div",{style:{display:"flex",gap:12,marginTop:18,flexWrap:"wrap",justifyContent:"center"},children:a.jsx("button",{style:qn.btn,onClick:l,children:" Voltar aos Lobbies"})})]})})}function Sl({place:t,player:e,big:n}){if(!e)return a.jsx("div",{style:{width:220}});const r={first:_l("#d4af37","#f5d76e"),second:_l("#9fa4ad","#cfd4db"),third:_l("#b87333","#d28c45")},o={first:"1",second:"2",third:"3"}[t],s=r[t].ring,i=r[t].face;return a.jsxs("div",{style:{...qn.medalCol,transform:n?"translateY(-18px)":"none"},children:[a.jsx("div",{style:qn.ribbon}),a.jsx("div",{style:{...qn.medal,...s,width:n?180:150,height:n?180:150},children:a.jsx("div",{style:{...qn.medalFace,...i},children:a.jsx("div",{style:qn.medalNumber,children:o})})}),a.jsxs("div",{style:qn.cardBelow,children:[a.jsx("div",{style:{fontWeight:900,fontSize:16,lineHeight:1.2,textAlign:"center"},children:e.name}),a.jsxs("div",{style:{opacity:.9,fontSize:13,marginTop:4,textAlign:"center"},children:["Saldo: ",a.jsxs("b",{children:["$ ",Number(e.cash||0).toLocaleString()]}),a.jsx("br",{}),"Bens: ",a.jsxs("b",{children:["$ ",Number(e.bens||0).toLocaleString()]})]}),a.jsxs("div",{style:{marginTop:6,fontWeight:900,textAlign:"center"},children:["Patrimnio: ",a.jsxs("b",{children:["$ ",Number(e.patrimonio||0).toLocaleString()]})]})]})]})}function _l(t,e){return{ring:{background:`radial-gradient(circle at 35% 30%, ${e} 0%, ${t} 65%, #000 120%)`,boxShadow:"0 12px 30px rgba(0,0,0,.35), inset 0 0 12px rgba(255,255,255,.12)"},face:{background:`conic-gradient(from 0deg, ${e}, ${t}, ${e})`}}}const qn={wrap:{pointerEvents:"auto",border:"1px solid rgba(255,255,255,.15)",background:"#11161f",color:"#eef1f6",borderRadius:16,padding:20,width:"min(900px, 92vw)",maxWidth:"92vw",textAlign:"center"},title:{margin:"0 0 6px",fontWeight:900,fontSize:28},subtitle:{margin:"0 0 14px",opacity:.9},podium:{display:"flex",alignItems:"flex-end",justifyContent:"center",gap:24,padding:"10px 0",flexWrap:"wrap"},medalCol:{display:"flex",flexDirection:"column",alignItems:"center"},ribbon:{width:16,height:70,background:"linear-gradient(#e41f1f,#9e1313)",borderRadius:4,marginBottom:-12},medal:{borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",border:"3px solid rgba(255,255,255,.18)"},medalFace:{width:"85%",height:"85%",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"inset 0 8px 18px rgba(0,0,0,.35), inset 0 -6px 10px rgba(255,255,255,.08)"},medalNumber:{fontWeight:900,fontSize:28,letterSpacing:1,textShadow:"0 2px 4px rgba(0,0,0,.45)"},cardBelow:{background:"#19202c",border:"1px solid rgba(255,255,255,.12)",borderRadius:12,padding:"10px 12px",width:220,marginTop:10},btn:{background:"#2a3342",color:"#fff",border:"1px solid rgba(255,255,255,.18)",borderRadius:10,padding:"10px 14px",fontWeight:800,cursor:"pointer"}},sm=E.createContext(null);function Tx({children:t}){const[e,n]=E.useState([]),r=E.useRef(null),o=d=>{const h=r.current;r.current=null,n(f=>f.slice(0,-1)),h&&h(d)},s=()=>o({action:"SKIP"}),i=()=>o(!1),l=d=>{var x;const h=((x=crypto==null?void 0:crypto.randomUUID)==null?void 0:x.call(crypto))||String(Date.now()+Math.random()),f=ye.cloneElement(d,{onResolve:y=>o(y)});n(y=>[...y,{id:h,el:f}])},u=()=>new Promise(d=>{r.current=d}),c=E.useMemo(()=>({pushModal:l,awaitTop:u,resolveTop:o,closeModal:s,popModal:i}),[]);return a.jsxs(sm.Provider,{value:c,children:[t,e.map(({id:d,el:h})=>a.jsx(ye.Fragment,{children:h},d))]})}const nn=()=>E.useContext(sm);function Px({playerName:t="Jogador"}){const{resolveTop:e,closeModal:n}=nn();return a.jsx(oi,{width:700,onClose:n,children:a.jsx("div",{className:"bankruptcyModal",children:a.jsxs("div",{className:"paper",style:{padding:24},children:[a.jsx("h2",{style:{marginTop:0},children:"Declarar Falncia"}),a.jsxs("p",{children:["Tem certeza que deseja declarar ",a.jsx("b",{children:"Falncia"}),", ",a.jsx("b",{children:t}),"?",a.jsx("br",{}),"Esta ao  irreversvel e voc no poder mais jogar."]}),a.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end",marginTop:24},children:[a.jsx("button",{onClick:()=>{n(),e(!1)},className:"btn",children:"Cancelar"}),a.jsx("button",{onClick:()=>{n(),e(!0)},className:"btn btn-danger",children:"Sim, declarar falncia"})]})]})})})}const Zt={comum:{cap:2,baseFat:600,incFat:100,baseDesp:100,incDesp:100},inside:{cap:5,baseFat:1500,incFat:500,baseDesp:2e3,incDesp:100},field:{cap:5,baseFat:1500,incFat:500,baseDesp:2e3,incDesp:100}},Tu={baseDesp:3e3,incDesp:500,boostByCert:[.2,.3,.4,.6]},im={A:{fat:1200,desp:700},B:{fat:600,desp:400},C:{fat:300,desp:200},D:{fat:100,desp:50}},am={A:{fat:1e3,desp:400},B:{fat:500,desp:200},C:{fat:200,desp:100},D:{fat:70,desp:50}},en=t=>Number(t||0),fr=(t={},e)=>{var n;return new Set(((n=t==null?void 0:t.trainingsByVendor)==null?void 0:n[e])||[]).size},Lx=t=>fr(t,"gestor");function ma(t={}){const e=Math.max(0,en(t.vendedoresComuns)),n=Math.max(0,en(t.insideSales)),r=Math.max(0,en(t.fieldSales)),o=e*Zt.comum.cap,s=n*Zt.inside.cap,i=r*Zt.field.cap,l=o+s+i,u=Math.max(0,en(t.clients)),c=Math.min(u,l);return{cap:l,inAtt:c}}function Ma(t={}){var C,S;const e=en(t.vendedoresComuns),n=en(t.insideSales),r=en(t.fieldSales),o=en(t.gestores??t.gestoresComerciais??t.managers),s=fr(t,"comum"),i=fr(t,"inside"),l=fr(t,"field"),u=fr(t,"gestor"),c=e*(Zt.comum.baseFat+Zt.comum.incFat*s),d=n*(Zt.inside.baseFat+Zt.inside.incFat*i),h=r*(Zt.field.baseFat+Zt.field.incFat*l);let f=c+d+h;const x=e+n+r,y=x>0?Math.min(1,o*7/x):0,b=Tu.boostByCert[Math.min(3,Math.max(0,u))]||0;f=f*(1+y*b);const _=String(t.mixProdutos||"D").toUpperCase(),p=(((C=im[_])==null?void 0:C.fat)||0)*en(t.clients),m=String(t.erpLevel||"D").toUpperCase(),g=x+o,w=(((S=am[m])==null?void 0:S.fat)||0)*g,j=en(t.revenue);return Math.max(0,Math.floor(f+p+w+j))}function Ba(t={}){var j,R;const e=en(t.vendedoresComuns),n=en(t.insideSales),r=en(t.fieldSales),o=en(t.gestores??t.gestoresComerciais??t.managers),s=fr(t,"comum"),i=fr(t,"inside"),l=fr(t,"field"),u=fr(t,"gestor"),c=e*(Zt.comum.baseDesp+Zt.comum.incDesp*s),d=n*(Zt.inside.baseDesp+Zt.inside.incDesp*i),h=r*(Zt.field.baseDesp+Zt.field.incDesp*l),f=o*(Tu.baseDesp+Tu.incDesp*u),x=String(t.mixProdutos||"D").toUpperCase(),y=(((j=im[x])==null?void 0:j.desp)||0)*en(t.clients),b=String(t.erpLevel||"D").toUpperCase(),_=e+n+r+o,p=(((R=am[b])==null?void 0:R.desp)||0)*_;return Math.max(0,Math.floor(c+d+h+f+y+p+0+1e3))}function Pt(t,e={}){var o,s;const n={...t},r=(i,l)=>{n[i]=(n[i]??0)+l};if(Number.isFinite(e.cashDelta)&&r("cash",Number(e.cashDelta)),Number.isFinite(e.clientsDelta)&&r("clients",Number(e.clientsDelta)),Number.isFinite(e.manutencaoDelta)&&r("manutencao",Number(e.manutencaoDelta)),Number.isFinite(e.bensDelta)&&r("bens",Number(e.bensDelta)),Number.isFinite(e.vendedoresComunsDelta)&&r("vendedoresComuns",Number(e.vendedoresComunsDelta)),Number.isFinite(e.fieldSalesDelta)&&r("fieldSales",Number(e.fieldSalesDelta)),Number.isFinite(e.insideSalesDelta)&&r("insideSales",Number(e.insideSalesDelta)),Number.isFinite(e.gestoresDelta)){const i=Number(e.gestoresDelta);n.gestores=(n.gestores??0)+i,n.gestoresComerciais=(n.gestoresComerciais??0)+i,n.managers=(n.managers??0)+i}if(Number.isFinite(e.revenueDelta)&&r("revenue",Number(e.revenueDelta)),typeof e.mixProdutosSet<"u"){n.mixProdutos=e.mixProdutosSet;const i=String(e.mixProdutosSet).toUpperCase();["A","B","C","D"].includes(i)&&(n.mixOwned={...n.mixOwned||{},[i]:!0},(o=n.reducedLevels)!=null&&o.MIX&&(n.reducedLevels={...n.reducedLevels,MIX:n.reducedLevels.MIX.filter(l=>l!==i)}))}if(e.mixBaseSet&&(n.mixBase={...n.mixBase||{},...e.mixBaseSet}),typeof e.erpLevelSet<"u"){n.erpLevel=e.erpLevelSet;const i=String(e.erpLevelSet).toUpperCase();["A","B","C","D"].includes(i)&&(n.erpOwned={...n.erpOwned||{},[i]:!0},(s=n.reducedLevels)!=null&&s.ERP&&(n.reducedLevels={...n.reducedLevels,ERP:n.reducedLevels.ERP.filter(l=>l!==i)}))}return Array.isArray(e.trainingsPush)&&e.trainingsPush.length&&(n.trainings=[...n.trainings||[],...e.trainingsPush]),Array.isArray(e.directBuysPush)&&e.directBuysPush.length&&(n.directBuys=[...n.directBuys||[],...e.directBuysPush]),n}function ff(t,e){const{purchases:n=[],grandTotal:r=0}=e||{},o={personalizado:"az",fieldsales:"am",imersaomultiplier:"rox"},s={...t};return s.cash=(s.cash??0)-Number(r||0),s.bens=(s.bens??0)+Number(r||0),s.onboarding=!0,n.forEach(i=>{var h;const{vendorType:l,items:u=[]}=i||{};u.forEach(f=>{const x=o[f==null?void 0:f.id];x&&(s[x]=(s[x]??0)+1)});const c=String(l||"comum"),d=new Set(((h=s.trainingsByVendor)==null?void 0:h[c])||[]);u.forEach(f=>{f!=null&&f.id&&d.add(f.id)}),s.trainingsByVendor={...s.trainingsByVendor||{},[c]:Array.from(d)}}),s}function kl(t,e,n){return t===e?!1:t<e?n>t&&n<=e:n>t||n<=e}function Ds(t){return t.reduce((e,n)=>e+(n!=null&&n.bankrupt?0:1),0)}function ds(t,e){var s;const n=t.length;if(n===0)return 0;let r=(e+1)%n,o=0;for(;o<n;){if(!((s=t[r])!=null&&s.bankrupt))return r;r=(r+1)%n,o++}return e}class lm{constructor(){this.errors=[],this.warnings=[]}validateGameState(e,n,r,o,s){return this.errors=[],this.warnings=[],this.validatePlayers(e),this.validateTurnState(e,n),this.validateGameOverState(e,o,s),this.validateRoundState(e,r),{isValid:this.errors.length===0,errors:this.errors,warnings:this.warnings}}validatePlayers(e){if(!Array.isArray(e)||e.length===0){this.addError("Jogadores invlidos: deve ser um array no vazio");return}e.forEach((n,r)=>{this.validatePlayer(n,r)}),this.validatePlayerUniqueness(e),this.validateAlivePlayers(e)}validatePlayer(e,n){const r=`Jogador ${n+1} (${e.name||"Sem nome"})`;e.id||this.addError(`${r}: ID  obrigatrio`),(typeof e.cash!="number"||e.cash<0)&&this.addError(`${r}: Cash deve ser um nmero no negativo (atual: ${e.cash})`),(typeof e.clients!="number"||e.clients<0)&&this.addError(`${r}: Clientes deve ser um nmero no negativo (atual: ${e.clients})`),this.validateResourceCounts(e,r),this.validateCalculations(e,r)}validateResourceCounts(e,n){["vendedoresComuns","fieldSales","insideSales","gestores","gestoresComerciais","managers"].forEach(s=>{const i=e[s];i!==void 0&&(typeof i!="number"||i<0)&&this.addError(`${n}: ${s} deve ser um nmero no negativo (atual: ${i})`)}),["az","am","rox"].forEach(s=>{const i=e[s];i!==void 0&&(typeof i!="number"||i<0)&&this.addError(`${n}: Certificado ${s} deve ser um nmero no negativo (atual: ${i})`)})}validateCalculations(e,n){try{const r=Ma(e),o=Ba(e),{cap:s,inAtt:i}=ma(e);(typeof r!="number"||r<0)&&this.addError(`${n}: Faturamento calculado invlido: ${r}`),(typeof o!="number"||o<0)&&this.addError(`${n}: Manuteno calculada invlida: ${o}`),(typeof s!="number"||s<0)&&this.addError(`${n}: Capacidade calculada invlida: ${s}`),(typeof i!="number"||i<0||i>s)&&this.addError(`${n}: Clientes em atendimento invlido: ${i} (capacidade: ${s})`),this.isInitialState(e)&&o!==1150&&this.addError(`${n}: Manuteno inicial deve ser 1150, mas  ${o}`)}catch(r){this.addError(`${n}: Erro ao calcular faturamento/manuteno: ${r.message}`)}}isInitialState(e){return e.vendedoresComuns===1&&e.clients===1&&e.fieldSales===0&&e.insideSales===0&&e.gestores===0&&e.mixProdutos==="D"&&e.erpLevel==="D"&&(e.az||0)===0&&(e.am||0)===0&&(e.rox||0)===0}validatePlayerUniqueness(e){const n=e.map(o=>o.id).filter(Boolean),r=new Set(n);n.length!==r.size&&this.addError("IDs de jogadores devem ser nicos")}validateAlivePlayers(e){const n=Ds(e);n===0&&this.addError("No pode haver zero jogadores vivos"),n===1&&this.addWarning("Apenas 1 jogador vivo - jogo deve terminar")}validateTurnState(e,n){if(typeof n!="number"||n<0||n>=e.length){this.addError(`TurnIdx invlido: ${n} (deve estar entre 0 e ${e.length-1})`);return}const r=e[n];if(!r){this.addError(`Jogador do turno no encontrado no ndice ${n}`);return}r.bankrupt&&this.addError(`Jogador do turno (${r.name}) est falido`)}validateGameOverState(e,n,r){const o=Ds(e);n&&o>1&&this.addError("Jogo marcado como terminado mas h mais de 1 jogador vivo"),n&&!r&&this.addError("Jogo terminado mas no h vencedor definido"),r&&!n&&this.addError("H vencedor definido mas jogo no terminou"),r&&r.bankrupt&&this.addError("Vencedor no pode estar falido")}validateRoundState(e,n){(typeof n!="number"||n<1)&&this.addError(`Rodada invlida: ${n} (deve ser >= 1)`),n>10&&this.addWarning(`Rodada muito alta: ${n} (jogo pode estar travado)`)}validateAction(e,n,r){switch(this.errors=[],this.warnings=[],e.type){case"MOVE":this.validateMoveAction(e,n);break;case"BUY":this.validateBuyAction(e,n);break;case"HIRE":this.validateHireAction(e,n);break;case"BANKRUPT":this.validateBankruptAction(e,n);break;default:this.addWarning(`Tipo de ao no reconhecido: ${e.type}`)}return{isValid:this.errors.length===0,errors:this.errors,warnings:this.warnings}}validateMoveAction(e,n){(typeof e.steps!="number"||e.steps<1||e.steps>6)&&this.addError(`Passos invlidos: ${e.steps} (deve estar entre 1 e 6)`)}validateBuyAction(e,n){const r=e.cost||e.price||0;r>n.cash&&this.addError(`Saldo insuficiente: precisa de ${r}, tem ${n.cash}`)}validateHireAction(e,n){const r=e.cost||0;r>n.cash&&this.addError(`Saldo insuficiente para contratao: precisa de ${r}, tem ${n.cash}`)}validateBankruptAction(e,n){n.bankrupt||this.addWarning("Jogador declarando falncia mas no est marcado como falido")}addError(e){this.errors.push(e)}addWarning(e){this.warnings.push(e)}}function $x(t,e,n,r,o){return new lm().validateGameState(t,e,n,r,o)}function Ix(t,e,n){return new lm().validateAction(t,e,n)}class Mx{constructor(){this.enabled=!1,this.logs=[],this.maxLogs=1e4,this.originalConsole={log:console.log,warn:console.warn,error:console.error,debug:console.debug,info:console.info},this.prefixes=["[DEBUG]","[NET]","[App]","[SG]","[Controls]","[HUD]","[DEBUG MODE]","[PlayersLobby]","[leaveRoom]","[GameNet]","[useTurnEngine]","[useGameSync]"]}shouldCapture(e){if(!this.enabled)return!1;const n=e.map(r=>{if(typeof r=="object")try{return JSON.stringify(r)}catch{return String(r)}return String(r)}).join(" ");return this.prefixes.some(r=>n.includes(r))}addLog(e,n){this.logs.length>=this.maxLogs&&(this.logs=this.logs.slice(-Math.floor(this.maxLogs*.9)));const r=Date.now(),o={timestamp:r,time:new Date(r).toISOString(),level:e,args:n.map(s=>{if(typeof s=="object"&&s!==null)try{return JSON.parse(JSON.stringify(s,(i,l)=>typeof l=="function"?"[Function]":l===void 0?"[undefined]":Array.isArray(l)&&l.length>100?`[Array(${l.length}) - truncado]`:l))}catch{return String(s)}return s}),message:n.map(s=>{if(typeof s=="object")try{return JSON.stringify(s)}catch{return String(s)}return String(s)}).join(" ")};this.logs.push(o)}interceptLog(...e){this.shouldCapture(e)&&this.addLog("log",e),this.originalConsole.log.apply(console,e)}interceptWarn(...e){this.shouldCapture(e)&&this.addLog("warn",e),this.originalConsole.warn.apply(console,e)}interceptError(...e){this.addLog("error",e),this.originalConsole.error.apply(console,e)}interceptDebug(...e){this.shouldCapture(e)&&this.addLog("debug",e),this.originalConsole.debug.apply(console,e)}interceptInfo(...e){this.shouldCapture(e)&&this.addLog("info",e),this.originalConsole.info.apply(console,e)}enable(){this.enabled||(this.enabled=!0,console.log=this.interceptLog.bind(this),console.warn=this.interceptWarn.bind(this),console.error=this.interceptError.bind(this),console.debug=this.interceptDebug.bind(this),console.info=this.interceptInfo.bind(this),console.log("[LogCapture]  Captura de logs ativada"))}disable(){this.enabled&&(this.enabled=!1,console.log=this.originalConsole.log,console.warn=this.originalConsole.warn,console.error=this.originalConsole.error,console.debug=this.originalConsole.debug,console.info=this.originalConsole.info,console.log("[LogCapture]  Captura de logs desativada"))}clear(){this.logs=[],console.log("[LogCapture]  Histrico de logs limpo")}getLogs(){return[...this.logs]}getStats(){const e=this.logs.length,n={log:0,warn:0,error:0,debug:0,info:0};return this.logs.forEach(r=>{n[r.level]=(n[r.level]||0)+1}),{total:e,byLevel:n,enabled:this.enabled}}exportAsText(){const e=["=".repeat(80),"RELATRIO DE LOGS - Sales Game","=".repeat(80),`Data/Hora: ${new Date().toISOString()}`,`Total de logs: ${this.logs.length}`,`Estatsticas: ${JSON.stringify(this.getStats(),null,2)}`,"=".repeat(80),""];return this.logs.forEach(n=>{const r={log:"",warn:"",error:"",debug:"",info:""}[n.level]||"";e.push(`[${n.time}] ${r} [${n.level.toUpperCase()}]`),n.args.forEach((o,s)=>{typeof o=="object"?e.push(`  Arg ${s+1}: ${JSON.stringify(o,null,2)}`):e.push(`  Arg ${s+1}: ${o}`)}),e.push("")}),e.join(`
`)}exportAsJSON(){return{timestamp:new Date().toISOString(),stats:this.getStats(),logs:this.logs}}exportFull(){return{timestamp:new Date().toISOString(),stats:this.getStats(),text:this.exportAsText(),json:this.exportAsJSON()}}}const rr=new Mx,Bx=()=>rr.clear(),Pu=()=>rr.getStats(),Ux=()=>rr.exportAsText(),Fx=()=>rr.exportAsJSON();class zx{constructor(){this.enabled=!1,this.validationHistory=[],this.maxHistorySize=100}toggle(){return this.enabled=!this.enabled,this.enabled&&rr.enable(),console.log(`[DEBUG MODE] ${this.enabled?"ATIVADO":"DESATIVADO"}`),this.enabled}validateGameState(e,n,r,o,s,i=""){if(!this.enabled)return;const l=$x(e,n,r,o,s);return this.addToHistory({type:"GAME_STATE",context:i,timestamp:Date.now(),result:l}),l.isValid||console.error("[DEBUG MODE]  Estado do jogo invlido:",l.errors),l.warnings.length>0&&console.warn("[DEBUG MODE]  Avisos:",l.warnings),l}validateAction(e,n,r,o=""){if(!this.enabled)return;const s=Ix(e,n,r);return this.addToHistory({type:"ACTION",context:o,timestamp:Date.now(),action:e.type,player:n.name,result:s}),s.isValid||console.error(`[DEBUG MODE]  Ao invlida (${e.type}):`,s.errors),s}validateResourceChange(e,n,r,o){if(!this.enabled)return;const s=[],i=[];if(n.clients!==r.clients){const c=r.clients-n.clients;r.clients<0&&s.push(`Clientes no pode ser negativo: ${r.clients}`),Math.abs(c)>10&&i.push(`Mudana grande de clientes: ${c}`)}if(n.cash!==r.cash){const c=r.cash-n.cash;r.cash<0&&s.push(`Cash no pode ser negativo: ${r.cash}`),Math.abs(c)>5e4&&i.push(`Mudana grande de cash: ${c}`)}["vendedoresComuns","fieldSales","insideSales","gestores"].forEach(c=>{if(n[c]!==r[c]){const d=r[c]-n[c];r[c]<0&&s.push(`${c} no pode ser negativo: ${r[c]}`),Math.abs(d)>5&&i.push(`Mudana grande de ${c}: ${d}`)}});const u={isValid:s.length===0,errors:s,warnings:i};return this.addToHistory({type:"RESOURCE_CHANGE",context:o,timestamp:Date.now(),player:e.name,oldState:n,newState:r,result:u}),u.isValid||console.error("[DEBUG MODE]  Mudana de recurso invlida:",u.errors),u}validateCalculations(e,n=""){if(this.enabled)try{const r=Ma(e),o=Ba(e),{cap:s,inAtt:i}=ma(e),l=[],u=[];(typeof r!="number"||r<0)&&l.push(`Faturamento invlido: ${r}`),(typeof o!="number"||o<0)&&l.push(`Manuteno invlida: ${o}`),(typeof s!="number"||s<0)&&l.push(`Capacidade invlida: ${s}`),(typeof i!="number"||i<0||i>s)&&l.push(`Clientes em atendimento invlido: ${i} (capacidade: ${s})`),this.isInitialState(e)&&o!==1150&&l.push(`Manuteno inicial deve ser 1150, mas  ${o}`);const c={isValid:l.length===0,errors:l,warnings:u,calculations:{faturamento:r,manutencao:o,cap:s,inAtt:i}};return this.addToHistory({type:"CALCULATIONS",context:n,timestamp:Date.now(),player:e.name,result:c}),c.isValid||console.error("[DEBUG MODE]  Clculos invlidos:",c.errors),c}catch(r){return console.error("[DEBUG MODE]  Erro ao validar clculos:",r),{isValid:!1,errors:[r.message],warnings:[]}}}isInitialState(e){return e.vendedoresComuns===1&&e.clients===1&&e.fieldSales===0&&e.insideSales===0&&e.gestores===0&&e.mixProdutos==="D"&&e.erpLevel==="D"}addToHistory(e){this.validationHistory.unshift(e),this.validationHistory.length>this.maxHistorySize&&(this.validationHistory=this.validationHistory.slice(0,this.maxHistorySize))}getHistory(){return this.validationHistory}clearHistory(){this.validationHistory=[]}getStats(){const e=this.validationHistory.length,n=this.validationHistory.filter(o=>!o.result.isValid).length,r=this.validationHistory.filter(o=>o.result.warnings.length>0).length;return{total:e,errors:n,warnings:r,errorRate:e>0?n/e*100:0,warningRate:e>0?r/e*100:0}}exportReport(){const e=this.getStats(),n={timestamp:new Date().toISOString(),stats:e,history:this.validationHistory};return console.log("[DEBUG MODE]  Relatrio de validao:",n),n}exportFullReport(){const e=this.exportReport(),n=rr.exportFull();return{timestamp:new Date().toISOString(),validation:e,logs:n,text:this.exportFullReportAsText(e,n)}}exportFullReportAsText(e,n){return["=".repeat(80),"RELATRIO COMPLETO DE DEBUG - Sales Game","=".repeat(80),`Data/Hora: ${new Date().toISOString()}`,"","--- VALIDAES ---",`Total de validaes: ${e.stats.total}`,`Erros: ${e.stats.errors}`,`Avisos: ${e.stats.warnings}`,`Taxa de erro: ${e.stats.errorRate.toFixed(2)}%`,"","--- LOGS CAPTURADOS ---",`Total de logs: ${n.stats.total}`,`Logs por nvel: ${JSON.stringify(n.stats.byLevel,null,2)}`,"","--- HISTRICO DE VALIDAES ---",...e.history.map(o=>`[${new Date(o.timestamp).toISOString()}] ${o.type} - ${o.context||""} - ${JSON.stringify(o.result,null,2)}`),"","--- LOGS DETALHADOS ---",n.text,"=".repeat(80)].join(`
`)}}const fo=new zx,Wx=(t,e,n,r,o,s)=>fo.validateGameState(t,e,n,r,o,s),Vx=(t,e)=>fo.validateCalculations(t,e),hf=()=>fo.getStats(),Gx=()=>fo.exportReport(),um=()=>fo.exportFullReport();function qx({players:t,turnIdx:e,round:n,gameOver:r,winner:o}){const[s,i]=E.useState(!1),[l,u]=E.useState({total:0,errors:0,warnings:0,errorRate:0,warningRate:0}),[c,d]=E.useState({total:0,byLevel:{},enabled:!1}),[h,f]=E.useState(!1),[x,y]=E.useState({x:0,y:0}),[b,_]=E.useState({x:0,y:0}),p=E.useRef(null);E.useEffect(()=>{const A=()=>{u(hf()),d(Pu())};A();const v=setInterval(A,1e3);return()=>clearInterval(v)},[]);const m=()=>{const A=fo.toggle();i(A)},g=()=>{const A=Gx(),v=new Blob([JSON.stringify(A,null,2)],{type:"application/json"}),D=URL.createObjectURL(v),O=document.createElement("a");O.href=D,O.download=`debug-report-${new Date().toISOString().slice(0,19)}.json`,O.click(),URL.revokeObjectURL(D)},w=()=>{const A=um(),v=new Blob([A.text],{type:"text/plain;charset=utf-8"}),D=URL.createObjectURL(v),O=document.createElement("a");O.href=D,O.download=`debug-logs-completo-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.txt`,O.click(),URL.revokeObjectURL(D);const M=new Blob([JSON.stringify(A,null,2)],{type:"application/json"}),te=URL.createObjectURL(M),ne=document.createElement("a");ne.href=te,ne.download=`debug-logs-completo-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.json`,ne.click(),URL.revokeObjectURL(te),console.log("[DebugPanel]  Relatrio completo exportado (texto + JSON)")},j=()=>{fo.clearHistory(),Bx(),u(hf()),d(Pu()),console.log("[DebugPanel]  Todos os logs foram limpos")},R=A=>{if(A.target.closest("button"))return;f(!0);const v=p.current.getBoundingClientRect();_({x:A.clientX-v.left,y:A.clientY-v.top})},C=A=>{h&&y({x:A.clientX-b.x,y:A.clientY-b.y})},S=()=>{f(!1)};return E.useEffect(()=>{if(h)return document.addEventListener("mousemove",C),document.addEventListener("mouseup",S),()=>{document.removeEventListener("mousemove",C),document.removeEventListener("mouseup",S)}},[h,b]),s?a.jsxs("div",{ref:p,style:{position:"fixed",top:x.y||10,left:x.x||10,zIndex:9999,background:"#1a1a1a",color:"#fff",padding:"12px",borderRadius:"8px",border:"1px solid #333",minWidth:"300px",maxHeight:"80vh",overflow:"auto",fontSize:"12px",fontFamily:"monospace",cursor:h?"grabbing":"grab",userSelect:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},onMouseDown:R,children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[a.jsx("h3",{style:{margin:0,color:"#4CAF50"},children:" Debug Panel"}),a.jsx("button",{onClick:m,style:{background:"#ff4444",color:"#fff",border:"none",borderRadius:"4px",padding:"4px 8px",cursor:"pointer",fontSize:"10px"},children:""})]}),a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("h4",{style:{margin:"0 0 8px 0",color:"#FFC107"},children:" Estatsticas de Validao"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px"},children:[a.jsxs("div",{children:["Total: ",l.total]}),a.jsxs("div",{style:{color:l.errors>0?"#ff4444":"#4CAF50"},children:["Erros: ",l.errors]}),a.jsxs("div",{style:{color:l.warnings>0?"#FFC107":"#4CAF50"},children:["Avisos: ",l.warnings]}),a.jsxs("div",{children:["Taxa Erro: ",l.errorRate.toFixed(1),"%"]})]})]}),a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("h4",{style:{margin:"0 0 8px 0",color:"#FFC107"},children:" Estatsticas de Logs"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px"},children:[a.jsxs("div",{children:["Total: ",c.total]}),a.jsxs("div",{style:{color:c.enabled?"#4CAF50":"#ff4444"},children:["Status: ",c.enabled?" Ativo":" Inativo"]}),c.byLevel&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:["Logs: ",c.byLevel.log||0]}),a.jsxs("div",{style:{color:"#FFC107"},children:["Warns: ",c.byLevel.warn||0]}),a.jsxs("div",{style:{color:"#ff4444"},children:["Errors: ",c.byLevel.error||0]}),a.jsxs("div",{children:["Debug: ",c.byLevel.debug||0]})]})]})]}),a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("h4",{style:{margin:"0 0 8px 0",color:"#FFC107"},children:" Estado do Jogo"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px"},children:[a.jsxs("div",{children:["Jogadores: ",t.length]}),a.jsxs("div",{children:["Turno: ",e+1]}),a.jsxs("div",{children:["Rodada: ",n]}),a.jsxs("div",{style:{color:r?"#ff4444":"#4CAF50"},children:["Status: ",r?"Fim":"Ativo"]}),o&&a.jsxs("div",{children:["Vencedor: ",o.name]})]})]}),a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("h4",{style:{margin:"0 0 8px 0",color:"#FFC107"},children:" Jogadores"}),t.map((A,v)=>{var D;return a.jsxs("div",{style:{background:v===e?"#333":"transparent",padding:"4px",borderRadius:"4px",marginBottom:"2px",border:A.bankrupt?"1px solid #ff4444":"1px solid transparent"},children:[a.jsxs("div",{style:{fontWeight:"bold"},children:[A.name," ",A.bankrupt?"":""," ",v===e?"":""]}),a.jsxs("div",{style:{fontSize:"10px",opacity:.8},children:["Cash: $",((D=A.cash)==null?void 0:D.toLocaleString())||0," | Clientes: ",A.clients||0," | Vendedores: ",A.vendedoresComuns||0]})]},A.id)})]}),a.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[a.jsx("button",{onClick:w,style:{background:"#2196F3",color:"#fff",border:"none",borderRadius:"4px",padding:"6px 12px",cursor:"pointer",fontSize:"10px",fontWeight:"bold"},title:"Exporta relatrio completo com todos os logs (texto + JSON)",children:" Exportar Logs Completos"}),a.jsx("button",{onClick:g,style:{background:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",padding:"6px 12px",cursor:"pointer",fontSize:"10px"},title:"Exporta apenas relatrio de validao (JSON)",children:" Exportar Validao"}),a.jsx("button",{onClick:j,style:{background:"#FF9800",color:"#fff",border:"none",borderRadius:"4px",padding:"6px 12px",cursor:"pointer",fontSize:"10px"},title:"Limpa todos os logs e histrico de validao",children:" Limpar Tudo"})]}),a.jsxs("div",{style:{marginTop:"12px",padding:"8px",background:"#333",borderRadius:"4px",fontSize:"10px"},children:[a.jsx("div",{style:{color:"#FFC107",marginBottom:"4px"},children:" Instrues:"}),a.jsx("div",{children:' Clique em " Debug" para ativar/desativar'}),a.jsx("div",{children:" Logs so capturados automaticamente quando debug est ativo"}),a.jsx("div",{children:' " Exportar Logs Completos" gera arquivo .txt e .json'}),a.jsx("div",{children:" Compartilhe o arquivo .txt para anlise de problemas"}),a.jsx("div",{children:" Todos os console.log com prefixos [DEBUG], [NET], [App], etc. so capturados"})]})]}):a.jsx("div",{style:{background:"#1a1a1a",color:"#fff",padding:"6px 10px",borderRadius:"4px",border:"1px solid #333",cursor:"pointer",fontSize:"11px",fontFamily:"monospace",display:"inline-block",userSelect:"none"},onClick:m,children:" Debug"})}function vr({onResolve:t,requiredAmount:e=0,currentCash:n=0,title:r="Saldo insuficiente",message:o="Seu saldo atual no  suficiente para concluir esta compra.",okLabel:s="OK",showRecoveryOptions:i=!1,canClose:l=!0}){const u=E.useRef(null),c=E.useMemo(()=>Math.max(0,Number(e||0)-Number(n||0)),[e,n]),d=b=>`$ ${Number(b||0).toLocaleString()}`,h=b=>{var _,p;(_=b==null?void 0:b.preventDefault)==null||_.call(b),(p=b==null?void 0:b.stopPropagation)==null||p.call(b),t==null||t({action:"ACK"})},f=b=>{var _,p;(_=b==null?void 0:b.preventDefault)==null||_.call(b),(p=b==null?void 0:b.stopPropagation)==null||p.call(b),!(i||!l)&&(t==null||t({action:"SKIP"}))},x=b=>{var _,p;(_=b==null?void 0:b.preventDefault)==null||_.call(b),(p=b==null?void 0:b.stopPropagation)==null||p.call(b),t==null||t({action:"RECOVERY"})},y=b=>{var _,p;(_=b==null?void 0:b.preventDefault)==null||_.call(b),(p=b==null?void 0:b.stopPropagation)==null||p.call(b),t==null||t({action:"BANKRUPT"})};return E.useEffect(()=>{const b=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var _,p;return(p=(_=u.current)==null?void 0:_.focus)==null?void 0:p.call(_)},0),()=>{document.body.style.overflow=b}},[]),a.jsx("div",{style:dn.wrap,role:"dialog","aria-modal":"true",onMouseDown:b=>{b.target===b.currentTarget&&b.stopPropagation()},children:a.jsxs("div",{style:dn.card,onMouseDown:b=>b.stopPropagation(),children:[!i&&l&&a.jsx("button",{type:"button",style:dn.close,onClick:f,"aria-label":"Fechar",children:""}),a.jsx("div",{style:dn.icon,children:""}),a.jsx("h2",{style:dn.title,children:r}),a.jsx("p",{style:dn.msg,children:o}),a.jsxs("div",{style:dn.grid,children:[a.jsxs("div",{style:dn.row,children:[a.jsx("span",{children:"Necessrio:"}),a.jsx("b",{children:d(e)})]}),a.jsxs("div",{style:dn.row,children:[a.jsx("span",{children:"Seu saldo:"}),a.jsx("b",{children:d(n)})]}),a.jsxs("div",{style:{...dn.row,color:"#fca5a5"},children:[a.jsx("span",{children:"Faltam:"}),a.jsx("b",{children:d(c)})]})]}),a.jsx("div",{style:dn.actions,children:i?a.jsxs(a.Fragment,{children:[a.jsx("button",{type:"button",style:{...dn.btn,background:"#f59e0b",color:"#fff",marginRight:"8px"},onClick:x,children:"Recuperao Financeira"}),a.jsx("button",{type:"button",style:{...dn.btn,background:"#dc2626",color:"#fff"},onClick:y,children:"Declarar Falncia"})]}):a.jsx("button",{ref:u,type:"button",style:{...dn.btn,background:"#6b7280",color:"#fff"},onClick:h,children:s})})]})})}const dn={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"grid",placeItems:"center",zIndex:1100},card:{width:"min(440px, 92vw)",background:"#1f2330",color:"#e9ecf1",borderRadius:16,padding:"18px 18px 16px",border:"1px solid rgba(255,255,255,.12)",boxShadow:"0 18px 50px rgba(0,0,0,.5)",position:"relative"},close:{position:"absolute",right:10,top:10,width:34,height:34,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},icon:{fontSize:28,lineHeight:1,marginBottom:6},title:{margin:"2px 0 6px",fontWeight:900,fontSize:20},msg:{opacity:.95,margin:"0 0 10px"},grid:{border:"1px solid rgba(255,255,255,.15)",borderRadius:12,padding:"10px 12px",marginBottom:12,background:"#171b26"},row:{display:"flex",justifyContent:"space-between",padding:"4px 0"},actions:{display:"flex",justifyContent:"center",marginTop:6},btn:{minWidth:120,padding:"10px 16px",borderRadius:10,border:"none",fontWeight:900,cursor:"pointer"}},fn={A:{compra:1e4,despesa:400,faturamento:1e3,color:"#1d4ed8",pill:"NVEL A"},B:{compra:4e3,despesa:200,faturamento:500,color:"#16a34a",pill:"NVEL B"},C:{compra:1500,despesa:100,faturamento:200,color:"#f59e0b",pill:"NVEL C"},D:{compra:500,despesa:50,faturamento:70,color:"#6b7280",pill:"NVEL D"}};function pf({onResolve:t,currentCash:e=0,currentLevel:n=null,erpOwned:r=null}){const o=E.useRef(null),{pushModal:s,awaitTop:i}=nn(),l=c=>{var d,h;(d=c==null?void 0:c.preventDefault)==null||d.call(c),(h=c==null?void 0:c.stopPropagation)==null||h.call(c),t==null||t({action:"SKIP"})},u=async c=>{if(r?r[c]===!0:n===c)return;const h=fn[c],f=Number((h==null?void 0:h.compra)||0),x=Number(e||0);if(x<f){s(a.jsx(vr,{requiredAmount:f,currentCash:x,title:"Saldo insuficiente para comprar ERP",message:`Voc precisa de $ ${f.toLocaleString()} para o ERP nvel ${c}, mas possui $ ${x.toLocaleString()}.`,okLabel:"Entendi"})),await i();return}t==null||t({action:"BUY",level:c,values:h})};return E.useEffect(()=>{const c=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var d,h;return(h=(d=o.current)==null?void 0:d.focus)==null?void 0:h.call(d)},0),()=>{document.body.style.overflow=c}},[]),a.jsx("div",{style:nt.wrap,role:"dialog","aria-modal":"true","aria-label":"ERP/Sistemas",children:a.jsxs("div",{style:nt.card,children:[a.jsx("button",{ref:o,type:"button",style:nt.close,onClick:l,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:nt.title,children:["Escolha o nvel de ",a.jsx("b",{children:"ERP / Sistemas"}),":"]}),a.jsxs("div",{style:nt.note,children:[a.jsx("div",{style:{fontWeight:900,marginBottom:4},children:"ERP / SISTEMAS"}),a.jsxs("div",{children:[a.jsx("b",{children:"Impacto mensal:"})," adiciona ",a.jsx("b",{children:"Despesa"})," e ",a.jsx("b",{children:"Faturamento"})," de acordo com o nvel."]}),a.jsxs("div",{children:["O nvel ",a.jsx("b",{children:"D"})," tambm pode ser adquirido."]})]}),a.jsxs("div",{style:nt.saldo,children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",Number(e||0).toLocaleString()]})]}),a.jsxs("div",{style:nt.table,children:[a.jsxs("div",{style:nt.trHead,children:[a.jsx("div",{style:nt.th}),a.jsx("div",{style:{...nt.th,background:"#10214d"},children:"Nvel A"}),a.jsx("div",{style:{...nt.th,background:"#0f3a1c"},children:"Nvel B"}),a.jsx("div",{style:{...nt.th,background:"#4a3705"},children:"Nvel C"}),a.jsx("div",{style:{...nt.th,background:"#2a2f3b"},children:"Nvel D"})]}),a.jsx(El,{label:"COMPRA",fmt:!0,vA:fn.A.compra,vB:fn.B.compra,vC:fn.C.compra,vD:fn.D.compra}),a.jsx(El,{label:"DESPESA",fmt:!0,vA:fn.A.despesa,vB:fn.B.despesa,vC:fn.C.despesa,vD:fn.D.despesa}),a.jsx(El,{label:"FATURAMENTO",fmt:!0,vA:fn.A.faturamento,vB:fn.B.faturamento,vC:fn.C.faturamento,vD:fn.D.faturamento})]}),a.jsx("div",{style:nt.cards,children:["A","B","C","D"].map(c=>{const d=fn[c],h=r?r[c]===!0:n===c,f=h;return a.jsxs("div",{style:{...nt.cardItem,borderColor:h?"#16a34a":"rgba(255,255,255,.15)",opacity:f?.6:1},children:[a.jsx("div",{style:{...nt.pill,background:h?"#16a34a":"#fff",color:h?"#fff":"#111"},children:h?" ADQUIRIDO":d.pill}),a.jsx("div",{style:{...nt.cardBadge,background:d.color}}),a.jsxs("ul",{style:nt.lines,children:[a.jsxs("li",{children:["Compra: ",a.jsxs("b",{children:["$ ",d.compra.toLocaleString()]})]}),a.jsxs("li",{children:["Despesa: ",a.jsxs("b",{children:["$ ",d.despesa.toLocaleString()]})]}),a.jsxs("li",{children:["Faturamento: ",a.jsxs("b",{children:["$ ",d.faturamento.toLocaleString()]})]})]}),a.jsx("button",{type:"button",style:{...nt.buyBtn,background:f?"#6b7280":"#2442f9",cursor:f?"not-allowed":"pointer"},onClick:()=>u(c),disabled:f,title:f?`ERP nvel ${c} j adquirido`:`Comprar ERP nvel ${c}`,children:f?"J Adquirido":`Comprar ${c}`})]},c)})}),a.jsx("div",{style:nt.actions,children:a.jsx("button",{type:"button",style:{...nt.bigBtn,background:"#444"},onClick:l,children:"No comprar"})})]})})}function El({label:t,vA:e,vB:n,vC:r,vD:o,fmt:s}){const i=l=>s?`$ ${Number(l).toLocaleString()}`:l;return a.jsxs("div",{style:nt.tr,children:[a.jsx("div",{style:{...nt.td,fontWeight:700},children:t}),a.jsx("div",{style:nt.td,children:i(e)}),a.jsx("div",{style:nt.td,children:i(n)}),a.jsx("div",{style:nt.td,children:i(r)}),a.jsx("div",{style:nt.td,children:i(o)})]})}const nt={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(980px, 94vw)",background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:900},note:{background:"#2a2f3b",border:"1px solid rgba(255,255,255,.15)",borderRadius:12,padding:"10px 12px",margin:"0 0 10px"},saldo:{margin:"0 0 10px",padding:"8px 12px",border:"1px dashed rgba(255,255,255,.25)",borderRadius:10},table:{border:"1px solid rgba(255,255,255,.12)",borderRadius:12,overflow:"hidden",marginBottom:12},trHead:{display:"grid",gridTemplateColumns:"1fr repeat(4, 1fr)",background:"#121621"},th:{padding:"10px 12px",fontWeight:800,borderLeft:"1px solid rgba(255,255,255,.06)"},tr:{display:"grid",gridTemplateColumns:"1fr repeat(4, 1fr)",background:"#0f1320"},td:{padding:"10px 12px",borderTop:"1px solid rgba(255,255,255,.06)",borderLeft:"1px solid rgba(255,255,255/.06)"},cards:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:12,marginTop:8},cardItem:{background:"#0f1320",border:"1px solid",borderRadius:14,padding:"12px",display:"flex",flexDirection:"column",gap:8},cardBadge:{width:"100%",height:6,borderRadius:999,opacity:.9},pill:{alignSelf:"flex-start",fontSize:12,fontWeight:900,padding:"4px 8px",borderRadius:999,color:"#111"},lines:{margin:0,padding:"0 0 0 16px",lineHeight:1.35},buyBtn:{marginTop:"auto",padding:"10px 12px",borderRadius:10,border:"none",fontWeight:900,cursor:"pointer",background:"#2442f9",color:"#fff"},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:14},bigBtn:{minWidth:160,padding:"14px 18px",borderRadius:12,border:"none",color:"#fff",fontWeight:900,cursor:"pointer"}},ji=[{id:"personalizado",label:`Treinamento de venda personalizado
Casagrande Consultores`,price:500,cert:"azul",colors:{bg:"#0f2848",border:"#3b82f6",pill:"#60a5fa"}},{id:"fieldsales",label:`Curso Field Sales Collab
Multiplier Educao e
Casagrande Consultores`,price:500,cert:"amarelo",colors:{bg:"#3a3202",border:"#facc15",pill:"#fde047"}},{id:"imersaomultiplier",label:`Pacote Imerses
Multiplier Educao`,price:500,cert:"roxo",colors:{bg:"#2b0840",border:"#a855f7",pill:"#c084fc"}}];function mf({onResolve:t,ownedByType:e={},canTrain:n={}}){const r=S=>typeof S=="string"&&S.trim()!==""&&!Number.isNaN(Number(S))?Number(S):S,o=S=>{const A=r(S);return typeof A=="number"?A>0:!!A},s=E.useMemo(()=>({comum:o(n.comum),field:o(n.field),inside:o(n.inside),gestor:o(n.gestor)}),[n]),i=ji.map(S=>S.id),l=E.useMemo(()=>[{id:"comum",label:"Vend. Comum"},{id:"field",label:"Field Sales"},{id:"inside",label:"Inside Sales"},{id:"gestor",label:"Gestor"}].filter(S=>s[S.id]).filter(S=>{const A=e[S.id]instanceof Set?e[S.id]:new Set(e[S.id]||[]);return i.some(v=>!A.has(v))}),[e,s]),[u,c]=E.useState(()=>new Set),[d,h]=E.useState(()=>new Set);E.useEffect(()=>{u.size===0&&l.length>0&&c(new Set([l[0].id]))},[l,u.size]);const f=E.useRef(null),x=E.useMemo(()=>{const S=[];if(d.size>0){const A=Array.from(d).map(D=>ji.find(O=>O.id===D)).filter(Boolean),v=A.reduce((D,O)=>D+((O==null?void 0:O.price)||0),0);u.forEach(D=>{S.push({vendorType:D,items:A,total:v})})}return S},[u,d]),y=E.useMemo(()=>x.reduce((S,A)=>S+A.total,0),[x]),b=E.useMemo(()=>{const S={azul:0,amarelo:0,roxo:0};return d.size>0&&Array.from(d).map(v=>ji.find(D=>D.id===v)).filter(Boolean).forEach(v=>{S[v.cert]=(S[v.cert]||0)+u.size}),S},[d,u.size]),_=E.useMemo(()=>{const S={};if(d.size>0){const A=Array.from(d);u.forEach(v=>{S[v]=A})}return S},[d,u]),p=S=>{c(A=>{const v=new Set(A);return v.has(S)?v.delete(S):v.add(S),v})},m=S=>{Array.from(u).some(v=>(e[v]instanceof Set?e[v]:new Set(e[v]||[])).has(S))||h(v=>{const D=new Set(v);return D.has(S)?D.delete(S):D.add(S),D})},g=()=>{x.length!==0&&(t==null||t({action:"BUY",purchases:x,grandTotal:y,bensDelta:y,certsCount:b,ownedUpdate:_}))},w=()=>{c(new Set),h(new Set)},j=S=>{var A,v;(A=S==null?void 0:S.preventDefault)==null||A.call(S),(v=S==null?void 0:S.stopPropagation)==null||v.call(S),t==null||t({action:"SKIP"})};E.useEffect(()=>{const S=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var A,v;return(v=(A=f.current)==null?void 0:A.focus)==null?void 0:v.call(A)},0),()=>{document.body.style.overflow=S}},[]);const R=l.length===0,C=!Object.values(s).some(Boolean);return a.jsx("div",{style:Qt.wrap,role:"dialog","aria-modal":"true",children:a.jsxs("div",{style:Qt.card,children:[a.jsx("button",{ref:f,type:"button",style:Qt.close,onClick:j,"aria-label":"Fechar",children:""}),a.jsx("h2",{style:Qt.title,children:"Escolha os vendedores e treinamentos que deseja comprar:"}),R?a.jsx("div",{style:Qt.allDoneBox,children:C?"Nenhum profissional disponvel para treinar no momento.":"Todos os treinamentos j foram comprados para os profissionais disponveis."}):a.jsx(a.Fragment,{children:a.jsxs("div",{style:{marginBottom:"16px"},children:[a.jsx("p",{style:{margin:"0 0 8px",opacity:.9,fontSize:"14px"},children:"Selecione os tipos de vendedores que deseja treinar:"}),a.jsx("div",{style:{...Qt.vendorRow,gridTemplateColumns:`repeat(${l.length}, minmax(0,1fr))`},children:l.map(S=>a.jsx("button",{type:"button",onClick:()=>p(S.id),style:{...Qt.vendorBtn,background:u.has(S.id)?"#6f5bd6":"#2a2f3b",borderColor:u.has(S.id)?"rgba(255,255,255,.35)":"rgba(255,255,255,.15)"},children:S.label},S.id))})]})}),!R&&u.size>0&&a.jsxs(a.Fragment,{children:[a.jsx("p",{style:{margin:"10px 2px 14px",opacity:.9},children:"Escolha os treinamentos que sero aplicados a todos os tipos selecionados:"}),a.jsxs("div",{style:{marginBottom:"16px"},children:[a.jsxs("div",{style:{marginBottom:"12px",padding:"8px 12px",background:"#2a2f3b",borderRadius:"8px",border:"1px solid rgba(255,255,255,.15)"},children:[a.jsx("div",{style:{fontWeight:"bold",marginBottom:"4px"},children:"Tipos selecionados:"}),a.jsx("div",{style:{fontSize:"14px",opacity:.9},children:Array.from(u).map(S=>{const A=l.find(v=>v.id===S);return A==null?void 0:A.label}).join(", ")})]}),a.jsx("div",{style:Qt.products,children:ji.map(S=>{const A=d.has(S.id),v=Array.from(u).some(D=>(e[D]instanceof Set?e[D]:new Set(e[D]||[])).has(S.id));return a.jsxs("button",{type:"button",onClick:()=>m(S.id),disabled:v,style:{...Qt.productCard,background:S.colors.bg,borderColor:S.colors.border,boxShadow:A?`0 0 0 3px ${S.colors.pill}`:"none",opacity:v?.45:1,cursor:v?"not-allowed":"pointer"},title:v?"J adquirido para algum tipo selecionado":void 0,children:[a.jsxs("div",{style:Qt.pill(S.colors.pill),children:["Certificado ",S.cert==="azul"?"Azul":S.cert==="amarelo"?"Amarelo":"Roxo"]}),a.jsx("div",{style:{whiteSpace:"pre-line",fontWeight:800,marginBottom:10},children:S.label}),a.jsxs("div",{style:{fontSize:22,fontWeight:900},children:["$ ",S.price.toLocaleString()]})]},S.id)})})]}),a.jsxs("div",{style:Qt.actionsRow,children:[a.jsx("button",{type:"button",style:{...Qt.smallBtn,background:"#3a4152"},onClick:w,children:"Limpar Tudo"}),a.jsx("div",{style:{flex:1}}),a.jsxs("div",{style:{fontWeight:900},children:["Total: $ ",y.toLocaleString(),u.size>1&&a.jsxs("span",{style:{fontSize:"12px",opacity:.8,marginLeft:"8px"},children:["(",d.size," treinamentos  ",u.size," tipos)"]})]})]}),a.jsxs("div",{style:Qt.btnRow,children:[a.jsx("button",{type:"button",style:{...Qt.bigBtn,background:"#444"},onClick:j,children:"No comprar"}),a.jsxs("button",{type:"button",disabled:x.length===0,style:{...Qt.bigBtn,background:x.length>0?"#6f5bd6":"#3a3a3a",opacity:x.length>0?1:.6,cursor:x.length>0?"pointer":"not-allowed"},onClick:g,children:["Comprar (",x.length," tipo",x.length!==1?"s":"",")"]})]})]})]})})}const Qt={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(980px, 94vw)",maxWidth:980,background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:900},allDoneBox:{background:"#0f1320",border:"1px solid rgba(255,255,255,.15)",borderRadius:12,padding:"14px",fontWeight:800,textAlign:"center"},vendorRow:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:10,marginBottom:12},vendorBtn:{padding:"10px 12px",borderRadius:10,border:"1px solid",color:"#fff",fontWeight:800,cursor:"pointer"},products:{display:"grid",gridTemplateColumns:"repeat(3, minmax(0,1fr))",gap:12,margin:"4px 0 10px"},productCard:{textAlign:"center",padding:"16px 14px",borderRadius:14,border:"2px solid",color:"#fff"},pill:t=>({display:"inline-block",background:t,color:"#111",fontWeight:900,padding:"4px 8px",borderRadius:999,marginBottom:8}),actionsRow:{display:"flex",alignItems:"center",gap:12,margin:"6px 0 6px"},smallBtn:{padding:"10px 14px",borderRadius:10,border:"none",color:"#fff",fontWeight:800,cursor:"pointer"},btnRow:{display:"flex",gap:12,justifyContent:"flex-end",marginTop:12},bigBtn:{minWidth:160,padding:"14px 18px",borderRadius:12,border:"none",color:"#fff",fontWeight:900,cursor:"pointer"}};function Hx({onResolve:t,currentCash:e=0}){const n=E.useRef(null),r=i=>{var l,u;(l=i==null?void 0:i.preventDefault)==null||l.call(i),(u=i==null?void 0:i.stopPropagation)==null||u.call(i),t==null||t({action:"SKIP"})};E.useEffect(()=>{const i=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var l,u;return(u=(l=n.current)==null?void 0:l.focus)==null?void 0:u.call(l)},0),()=>{document.body.style.overflow=i}},[]);const o=i=>()=>{t==null||t({action:"OPEN",open:String(i).toUpperCase()})},s=[{key:"mix",title:"Mix Produtos",lines:["Nvel A: $12000","Nvel B: $6000","Nvel C: $3000","Nvel D: $1000"],onBuy:o("MIX")},{key:"gestor",title:"Gestor Comercial",lines:["Contratao: $5000","Manuteno: $3000"],onBuy:o("MANAGER")},{key:"inside",title:"Inside Sales",lines:["Contratao: $3000","Manuteno: $2000"],onBuy:o("INSIDE")},{key:"field",title:"Field Sales",lines:["Contratao: $3000","Manuteno: $2000"],onBuy:o("FIELD")},{key:"vendedor",title:"Vendedor Comum",lines:["Contratao: $1500","Despesas: $1000"],onBuy:o("COMMON")},{key:"erp",title:"ERP/Sistemas",lines:["Nvel A: $10000","Nvel B: $4000","Nvel C: $1500","Nvel D: $500"],onBuy:o("ERP")},{key:"carteira",title:"Carteira de Clientes",lines:["Aquisio: $1000"],onBuy:o("CLIENTS")},{key:"training",title:"Treinamento",lines:["Azul: $500","Amarelo: $500","Roxo: $500"],onBuy:o("TRAINING")}];return a.jsx("div",{style:Zn.wrap,role:"dialog","aria-modal":"true",children:a.jsxs("div",{style:Zn.card,children:[a.jsx("button",{ref:n,type:"button",style:Zn.close,onClick:r,"aria-label":"Fechar",children:""}),a.jsx("h2",{style:Zn.title,children:"Direto de Compra  escolha uma casa para adquirir:"}),a.jsxs("div",{style:{marginBottom:8,opacity:.8,fontSize:13},children:["Saldo atual: ",a.jsxs("b",{children:["$",Number(e).toLocaleString()]})]}),a.jsx("div",{style:Zn.grid,children:s.map(i=>a.jsxs("div",{style:Zn.cell,children:[a.jsx("div",{style:Zn.cellTitle,children:i.title}),a.jsx("ul",{style:Zn.lines,children:i.lines.map((l,u)=>a.jsx("li",{children:l},u))}),a.jsx("button",{type:"button",style:Zn.buyBtn,onClick:i.onBuy,children:"Comprar"})]},i.key))}),a.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:16},children:a.jsx("button",{type:"button",style:{...Zn.buyBtn,background:"#666"},onClick:r,children:"No Comprar"})})]})})}const Zn={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(1000px, 94vw)",background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 16px",fontWeight:800},grid:{display:"grid",gridTemplateColumns:"repeat(4, minmax(180px, 1fr))",gap:12},cell:{background:"#0f1320",border:"1px solid rgba(255,255,255,.08)",borderRadius:12,padding:12,display:"flex",flexDirection:"column",gap:8,minHeight:160},cellTitle:{fontWeight:800,marginBottom:4},lines:{margin:0,padding:"0 0 0 16px",opacity:.85,lineHeight:1.3},buyBtn:{marginTop:"auto",alignSelf:"center",minWidth:140,padding:"10px 14px",borderRadius:10,border:"none",background:"#3fbf49",color:"#09110f",fontWeight:900,cursor:"pointer"}};function gf({onResolve:t,currentCash:e=0}){const n=E.useRef(null),[r,o]=E.useState(""),{pushModal:s,awaitTop:i}=nn(),l=3e3,u=2e3,c=1500,d=E.useMemo(()=>{const m=Number(r);return Number.isFinite(m)&&m>0?Math.floor(m):0},[r]),h=d*l,f=d>0,x=Math.max(0,Math.floor(Number(e||0)/l)),y=m=>{var g,w;(g=m==null?void 0:m.preventDefault)==null||g.call(m),(w=m==null?void 0:m.stopPropagation)==null||w.call(m),t==null||t({action:"SKIP"})},b=m=>{const g=Number(r)||0,w=Math.min(x||1/0,g+m);o(w||"")},_=()=>o(x||""),p=async()=>{if(!f)return;const m=Number(e||0),g=Number(h||0);if(m<g){s(a.jsx(vr,{requiredAmount:g,currentCash:m,title:"Saldo insuficiente para contratar Inside Sales",message:`Voc precisa de $ ${g.toLocaleString()} mas possui $ ${m.toLocaleString()}.`,okLabel:"Entendi"})),await i();return}t==null||t({action:"BUY",qty:d,headcount:d,unitHire:l,total:h,cost:h,totalCost:h,baseExpense:u,baseRevenue:c})};return E.useEffect(()=>{const m=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var g,w;return(w=(g=n.current)==null?void 0:g.focus)==null?void 0:w.call(g)},0),()=>{document.body.style.overflow=m}},[]),a.jsx("div",{style:yt.wrap,role:"dialog","aria-modal":"true","aria-label":"Inside Sales",children:a.jsxs("div",{style:yt.card,children:[a.jsx("button",{ref:n,type:"button",style:yt.close,onClick:y,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:yt.title,children:["Voc pode escolher quantos ",a.jsx("b",{children:"Inside Sales"})," quer comprar:"]}),a.jsxs("div",{style:yt.note,children:[a.jsx("div",{style:{fontWeight:900,marginBottom:4},children:"INSIDE SALES (SDR/BDR + CLOSER + CS)"}),a.jsxs("div",{children:[a.jsx("b",{children:"Base para clculo despesa:"}),"  quantidade ",a.jsx("b",{children:"field sales"})," ou ",a.jsx("b",{children:"inside sales"}),"."]}),a.jsxs("div",{children:[a.jsx("b",{children:"Base para clculo faturamento:"}),"  quantidade ",a.jsx("b",{children:"mxima de clientes que cada vendedor pode atender"}),"."]})]}),a.jsxs("div",{style:yt.saldoRow,children:[a.jsxs("div",{children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",Number(e||0).toLocaleString()]})]}),a.jsxs("div",{children:["Mximo por saldo: ",a.jsx("b",{children:x})]})]}),a.jsxs("div",{style:yt.inputRow,children:[a.jsx("input",{type:"number",inputMode:"numeric",min:1,placeholder:"Digite o nmero de Inside Sales",value:r,onChange:m=>o(m.target.value),style:yt.input}),a.jsxs("div",{style:yt.quickBtns,children:[a.jsx("button",{type:"button",style:yt.quickBtn,onClick:()=>b(1),children:"+1"}),a.jsx("button",{type:"button",style:yt.quickBtn,onClick:()=>b(5),children:"+5"}),a.jsx("button",{type:"button",style:yt.quickBtn,onClick:()=>b(10),children:"+10"}),a.jsx("button",{type:"button",style:{...yt.quickBtn,fontWeight:900},onClick:_,children:"Mx"})]}),a.jsxs("div",{style:yt.totalBox,children:["Total contratar: ",a.jsxs("b",{children:["$ ",Number(h).toLocaleString()]})]})]}),a.jsxs("div",{style:yt.cards,children:[a.jsx(Ci,{title:"Sem certificado",bg:"#2a2f3b",pill:"BASE",lines:[`Contratao: $ ${l.toLocaleString()}`,`Despesa: $ ${u.toLocaleString()}`,`Faturamento: $ ${c.toLocaleString()}`]}),a.jsx(Ci,{title:"1 certificado",bg:"#f1c40f",pill:"NVEL 1",dark:!0,lines:["Contratao: ","Despesa: $ 2.100","Faturamento: $ 2.000"]}),a.jsx(Ci,{title:"2 certificados",bg:"#a78bfa",pill:"NVEL 2",dark:!0,lines:["Contratao: ","Despesa: $ 2.200","Faturamento: $ 2.500"]}),a.jsx(Ci,{title:"3 certificados",bg:"#8b5cf6",pill:"NVEL 3",dark:!0,lines:["Contratao: ","Despesa: $ 2.300","Faturamento: $ 3.000"]})]}),a.jsxs("div",{style:yt.actions,children:[a.jsx("button",{type:"button",style:{...yt.bigBtn,background:"#666",color:"#fff"},onClick:y,children:"No comprar"}),a.jsxs("button",{type:"button",style:{...yt.bigBtn,background:f?"#3fbf49":"#2f5d33",color:"#09110f"},onClick:p,disabled:!f,title:f?void 0:"Informe uma quantidade vlida",children:["Comprar ",f?`($ ${h.toLocaleString()})`:""]})]})]})})}function Ci({title:t,pill:e,lines:n,bg:r,dark:o=!1}){return a.jsxs("div",{style:{...yt.cardItem,background:r,color:o?"#111":"#fff",borderColor:"rgba(255,255,255,.15)"},children:[a.jsxs("div",{style:yt.cardHeader,children:[a.jsx("span",{style:{...yt.pill,background:o?"#111":"#fff",color:o?"#fff":"#111"},children:e}),a.jsx("div",{style:{fontWeight:900},children:t})]}),a.jsx("ul",{style:yt.lines,children:n.map((s,i)=>a.jsx("li",{children:s},i))})]})}const yt={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(980px, 94vw)",background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:900},note:{background:"#2a2f3b",border:"1px solid rgba(255,255,255,.15)",borderRadius:12,padding:"10px 12px",margin:"0 0 10px"},saldoRow:{display:"flex",justifyContent:"space-between",gap:12,padding:"8px 12px",border:"1px dashed rgba(255,255,255,.25)",borderRadius:10,marginBottom:8},inputRow:{display:"grid",gridTemplateColumns:"1fr auto auto",alignItems:"center",gap:10,marginBottom:12},input:{height:42,borderRadius:10,padding:"0 12px",border:"1px solid rgba(255,255,255,.18)",background:"#0f1320",color:"#fff",outline:"none"},quickBtns:{display:"flex",gap:6},quickBtn:{minWidth:44,height:42,borderRadius:10,border:"1px solid rgba(255,255,255,.18)",background:"#2a2f3b",color:"#fff",fontWeight:800,cursor:"pointer",padding:"0 10px"},totalBox:{padding:"8px 12px",borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#0f1320",fontWeight:900},cards:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:12,margin:"8px 0 14px"},cardItem:{border:"1px solid",borderRadius:14,padding:"14px"},cardHeader:{display:"flex",alignItems:"center",gap:8,marginBottom:8},pill:{fontSize:12,fontWeight:900,padding:"4px 8px",borderRadius:999},lines:{margin:0,padding:"0 0 0 16px",lineHeight:1.35},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:8},bigBtn:{minWidth:180,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function yf({onResolve:t,unitAcquisition:e=1e3,unitMaintenance:n=50,currentCash:r=0}){const o=E.useRef(null),s=E.useRef(null),{pushModal:i,awaitTop:l}=nn(),[u,c]=E.useState(""),d=E.useMemo(()=>{const j=Math.floor(Number(u));return Number.isFinite(j)&&j>0?j:0},[u]),h=Number(e||0),f=Number(n||0),x=Number(r||0),y=E.useMemo(()=>h<=0?0:Math.max(0,Math.floor(x/h)),[x,h]),b=d*h,_=d*f,p=d>0,m=j=>{var R,C;(R=j==null?void 0:j.preventDefault)==null||R.call(j),(C=j==null?void 0:j.stopPropagation)==null||C.call(j),t==null||t({action:"SKIP"})},g=async()=>{if(p){if(x<b){i(a.jsx(vr,{requiredAmount:b,currentCash:x,title:"Saldo insuficiente para comprar clientes",message:"Voc no possui saldo suficiente para concluir esta aquisio.",okLabel:"Entendi"})),await l();return}t==null||t({action:"BUY",qty:d,unitAcquisition:h,totalCost:b,unitMaintenance:f,maintenanceDelta:_,bensDelta:b,clientsAdded:d})}};E.useEffect(()=>{const j=document.body.style.overflow;document.body.style.overflow="hidden";const R=setTimeout(()=>{var A,v;return(v=(A=o.current)==null?void 0:A.focus)==null?void 0:v.call(A)},0),C=setTimeout(()=>{var A,v;return(v=(A=s.current)==null?void 0:A.focus)==null?void 0:v.call(A)},50),S=A=>{A.key==="Enter"&&(A.preventDefault(),g())};return window.addEventListener("keydown",S),()=>{document.body.style.overflow=j,window.removeEventListener("keydown",S),clearTimeout(R),clearTimeout(C)}},[]);const w=j=>{const R=Math.max(0,Math.min(Math.floor(Number(j)||0),1e6));c(String(R))};return a.jsx("div",{style:Lt.wrap,role:"dialog","aria-modal":"true",onMouseDown:j=>{j.target===j.currentTarget&&j.stopPropagation()},children:a.jsxs("div",{style:Lt.card,onMouseDown:j=>j.stopPropagation(),children:[a.jsx("button",{ref:o,type:"button",style:Lt.close,onClick:m,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:Lt.title,children:["Voc pode escolher quantos clientes quer comprar,",a.jsx("br",{}),"Digite o nmero de clientes:"]}),a.jsxs("p",{style:Lt.warn,children:[a.jsx("b",{children:"Mas cuidado com a capacidade de atendimento da sua equipe!"}),a.jsx("br",{}),"Se o jogador adquirir mais clientes do que os vendedores podem atender, assim que passar na casa ",a.jsx("i",{children:"Faturamento do Ms"})," no receber o faturamento dos clientes excedentes e perder o(s) cliente(s) que no foram atendidos."]}),a.jsxs("div",{style:Lt.inlineInfo,children:[a.jsxs("div",{children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",x.toLocaleString()]})]}),a.jsxs("div",{children:["Mximo por saldo: ",a.jsx("b",{children:y})]})]}),a.jsxs("div",{style:Lt.qtyRow,children:[a.jsx("input",{ref:s,type:"number",inputMode:"numeric",min:1,placeholder:"Digite o nmero de Clientes",value:u,onChange:j=>w(j.target.value),style:Lt.input}),a.jsxs("div",{style:Lt.quickBtns,children:[a.jsx("button",{type:"button",style:Lt.qbtn,onClick:()=>w(d+1),children:"+1"}),a.jsx("button",{type:"button",style:Lt.qbtn,onClick:()=>w(d+5),children:"+5"}),a.jsx("button",{type:"button",style:Lt.qbtn,onClick:()=>w(d+10),children:"+10"}),a.jsx("button",{type:"button",style:Lt.qbtn,onClick:()=>w(y),title:"Comprar o mximo possvel com o saldo atual",children:"Mx"})]})]}),a.jsxs("div",{style:Lt.summary,children:[a.jsxs("div",{children:["Preo por cliente: ",a.jsxs("b",{children:["$ ",h.toLocaleString()]})]}),a.jsxs("div",{children:["Despesa mensal por cliente: ",a.jsxs("b",{children:["$ ",f.toLocaleString()]})]})]}),a.jsxs("div",{style:Lt.summaryStrong,children:[a.jsxs("div",{children:["Total compra: ",a.jsxs("b",{children:["$ ",Number(b).toLocaleString()]})]}),a.jsxs("div",{children:["Manuteno mensal adicionada: ",a.jsxs("b",{children:["$ ",Number(_).toLocaleString()]})]})]}),a.jsxs("div",{style:Lt.actions,children:[a.jsx("button",{type:"button",style:{...Lt.bigBtn,background:"#666",color:"#fff"},onClick:m,children:"No comprar"}),a.jsxs("button",{type:"button",style:{...Lt.bigBtn,background:p?"#3fbf49":"#2f5d33",color:"#09110f"},onClick:g,disabled:!p,title:p?x<b?"Saldo insuficiente":void 0:"Informe uma quantidade vlida",children:["Comprar ",p?`($ ${b.toLocaleString()})`:""]})]})]})})}const Lt={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(820px, 92vw)",maxWidth:820,background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px 20px 16px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:800,lineHeight:1.3},warn:{background:"#271c12",border:"1px solid rgba(255,180,0,.35)",color:"#ffd489",borderRadius:10,padding:"10px 12px",margin:"0 0 12px"},inlineInfo:{display:"flex",justifyContent:"space-between",gap:10,margin:"0 0 8px",opacity:.95,fontWeight:700,flexWrap:"wrap"},qtyRow:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},input:{flex:"1 1 260px",height:42,borderRadius:10,padding:"0 12px",border:"1px solid rgba(255,255,255,.18)",background:"#0f1320",color:"#fff",outline:"none"},quickBtns:{display:"flex",gap:6,flexWrap:"wrap"},qbtn:{height:42,padding:"0 12px",borderRadius:10,border:"1px solid rgba(255,255,255,.18)",background:"#2a2f3b",color:"#fff",cursor:"pointer",fontWeight:800},summary:{display:"flex",justifyContent:"space-between",gap:10,border:"1px dashed rgba(255,255,255,.2)",borderRadius:10,padding:"8px 12px",marginBottom:8,fontWeight:700,flexWrap:"wrap"},summaryStrong:{display:"flex",justifyContent:"space-between",gap:10,border:"1px solid rgba(255,255,255,.25)",borderRadius:10,padding:"10px 12px",marginBottom:10,fontWeight:800,flexWrap:"wrap"},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:4,flexWrap:"wrap"},bigBtn:{minWidth:180,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function vf({onResolve:t,unitHire:e=5e3,unitExpense:n=3e3,managesUpTo:r=7,currentCash:o=0}){const s=E.useRef(null),i=E.useRef(null),{pushModal:l,awaitTop:u}=nn(),[c,d]=E.useState(""),h=Number(e||0),f=Number(n||0),x=Number(o||0),y=E.useMemo(()=>{const R=Math.floor(Number(c));return Number.isFinite(R)&&R>0?R:0},[c]),b=E.useMemo(()=>h<=0?0:Math.max(0,Math.floor(x/h)),[x,h]),_=y*h,p=y*f,m=y>0,g=R=>{const C=Math.floor(Number(R)||0),S=Math.max(0,Math.min(C,1e6));d(String(S))},w=R=>{var C,S;(C=R==null?void 0:R.preventDefault)==null||C.call(R),(S=R==null?void 0:R.stopPropagation)==null||S.call(R),t==null||t({action:"SKIP"})},j=async()=>{if(m){if(x<_){l(a.jsx(vr,{requiredAmount:_,currentCash:x,title:"Saldo insuficiente para contratar Gestores",message:"Voc no possui saldo suficiente para concluir esta contratao.",okLabel:"Entendi"})),await u();return}t==null||t({action:"BUY",role:"MANAGER",qty:y,headcount:y,gestoresDelta:y,unitHire:h,unitExpense:f,totalHire:_,totalExpense:p,cost:_,total:_,cashDelta:-_,expenseDelta:p,hudUpdate:{category:"Gestores Comerciais",addQty:y}})}};return E.useEffect(()=>{const R=document.body.style.overflow;document.body.style.overflow="hidden";const C=setTimeout(()=>{var v,D;return(D=(v=s.current)==null?void 0:v.focus)==null?void 0:D.call(v)},0),S=setTimeout(()=>{var v,D;return(D=(v=i.current)==null?void 0:v.focus)==null?void 0:D.call(v)},60),A=v=>{v.key==="Enter"&&(v.preventDefault(),j())};return window.addEventListener("keydown",A),()=>{document.body.style.overflow=R,window.removeEventListener("keydown",A),clearTimeout(C),clearTimeout(S)}},[]),a.jsx("div",{style:Ye.wrap,role:"dialog","aria-modal":"true",onMouseDown:R=>{R.target===R.currentTarget&&R.stopPropagation()},children:a.jsxs("div",{style:Ye.card,onMouseDown:R=>R.stopPropagation(),children:[a.jsx("button",{ref:s,type:"button",style:Ye.close,onClick:w,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:Ye.title,children:["Voc pode escolher quantos ",a.jsx("b",{children:"Gestores"})," quer comprar,",a.jsx("br",{}),"Digite o nmero de gestores:"]}),a.jsxs("div",{style:Ye.inlineInfo,children:[a.jsxs("div",{children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",x.toLocaleString()]})]}),a.jsxs("div",{children:["Mximo por saldo: ",a.jsx("b",{children:b})]})]}),a.jsxs("div",{style:Ye.qtyRow,children:[a.jsx("input",{ref:i,type:"number",inputMode:"numeric",min:1,placeholder:"Digite o nmero de Gestores",value:c,onChange:R=>g(R.target.value),style:Ye.input}),a.jsxs("div",{style:Ye.quickBtns,children:[a.jsx("button",{type:"button",style:Ye.qbtn,onClick:()=>g(y+1),children:"+1"}),a.jsx("button",{type:"button",style:Ye.qbtn,onClick:()=>g(y+5),children:"+5"}),a.jsx("button",{type:"button",style:Ye.qbtn,onClick:()=>g(y+10),children:"+10"}),a.jsx("button",{type:"button",style:Ye.qbtn,onClick:()=>g(b),title:"Comprar o mximo possvel com o saldo atual",children:"Mx"})]})]}),a.jsxs("div",{style:Ye.infoBox,children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"GESTOR COMERCIAL"}),a.jsxs("div",{style:{opacity:.9,marginBottom:8},children:["Base para clculo de despesa: ",a.jsx("b",{children:"x quantidade de Gestores"}),".",a.jsx("br",{}),"Cada Gestor gerencia at ",a.jsx("b",{children:r})," colaboradores."]}),a.jsxs("div",{style:Ye.table,children:[a.jsxs("div",{style:Ye.trHead,children:[a.jsx("div",{style:Ye.th,children:"Certificao"}),a.jsx("div",{style:Ye.th,children:"Contratao"}),a.jsx("div",{style:Ye.th,children:"Despesa"}),a.jsx("div",{style:Ye.th,children:"Efeito"})]}),a.jsx(Ri,{label:"Sem Certificado",hire:5e3,expense:3e3,revenue:"potencializa colaboradores em 20%"}),a.jsx(Ri,{label:"Com 1 certificado",hire:"-",expense:3500,revenue:"potencializa colaboradores em 30%"}),a.jsx(Ri,{label:"Com 2 certificados",hire:"-",expense:4e3,revenue:"potencializa colaboradores em 40%"}),a.jsx(Ri,{label:"Com 3 certificados",hire:"-",expense:4500,revenue:"potencializa colaboradores em 60%"})]})]}),a.jsxs("div",{style:Ye.summary,children:[a.jsxs("div",{children:["Custo de contratao: ",a.jsxs("b",{children:["$ ",Number(e).toLocaleString()]})," / gestor"]}),a.jsxs("div",{children:["Despesa mensal: ",a.jsxs("b",{children:["$ ",Number(n).toLocaleString()]})," / gestor"]})]}),a.jsxs("div",{style:Ye.summaryStrong,children:[a.jsxs("div",{children:["Total contratar: ",a.jsxs("b",{children:["$ ",Number(_).toLocaleString()]})]}),a.jsxs("div",{children:["Despesa mensal total: ",a.jsxs("b",{children:["$ ",Number(p).toLocaleString()]})]})]}),a.jsxs("div",{style:Ye.actions,children:[a.jsx("button",{type:"button",style:{...Ye.bigBtn,background:"#666",color:"#fff"},onClick:w,children:"No comprar"}),a.jsxs("button",{type:"button",style:{...Ye.bigBtn,background:m?"#3fbf49":"#2f5d33",color:"#09110f"},onClick:j,disabled:!m,title:m?x<_?"Saldo insuficiente":void 0:"Informe uma quantidade vlida",children:["Comprar ",m?`(${y})`:""]})]})]})})}function Ri({label:t,hire:e,expense:n,revenue:r}){const o=s=>typeof s=="number"?`$ ${Number(s).toLocaleString()}`:s;return a.jsxs("div",{style:Ye.tr,children:[a.jsx("div",{style:Ye.td,children:t}),a.jsx("div",{style:Ye.td,children:o(e)}),a.jsx("div",{style:Ye.td,children:o(n)}),a.jsx("div",{style:Ye.td,children:r})]})}const Ye={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(880px, 92vw)",maxWidth:880,background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px 20px 16px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:800,lineHeight:1.3},inlineInfo:{display:"flex",justifyContent:"space-between",gap:10,margin:"0 0 8px",opacity:.95,fontWeight:700,flexWrap:"wrap"},qtyRow:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},input:{flex:"1 1 260px",height:42,borderRadius:10,padding:"0 12px",border:"1px solid rgba(255,255,255,.18)",background:"#0f1320",color:"#fff",outline:"none"},quickBtns:{display:"flex",gap:6,flexWrap:"wrap"},qbtn:{height:42,padding:"0 12px",borderRadius:10,border:"1px solid rgba(255,255,255,.18)",background:"#2a2f3b",color:"#fff",cursor:"pointer",fontWeight:800},infoBox:{border:"1px solid rgba(255,255,255,.12)",borderRadius:12,padding:"12px",background:"#101522",marginBottom:12},table:{border:"1px solid rgba(255,255,255,.12)",borderRadius:10,overflow:"hidden"},trHead:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 3fr",background:"#121621"},th:{padding:"10px 12px",fontWeight:800,borderLeft:"1px solid rgba(255,255,255,.06)"},tr:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 3fr",background:"#0f1320"},td:{padding:"10px 12px",borderTop:"1px solid rgba(255,255,255,.06)",borderLeft:"1px solid rgba(255,255,255,.06)"},summary:{display:"flex",justifyContent:"space-between",border:"1px dashed rgba(255,255,255,.2)",borderRadius:10,padding:"8px 12px",marginTop:10,flexWrap:"wrap",gap:10},summaryStrong:{display:"flex",justifyContent:"space-between",border:"1px solid rgba(255,255,255,.25)",borderRadius:10,padding:"10px 12px",marginTop:8,fontWeight:800,flexWrap:"wrap",gap:10},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:12,flexWrap:"wrap"},bigBtn:{minWidth:180,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function xf({onResolve:t,unitHire:e=3e3,unitExpense:n=2e3,attendsUpTo:r=5,currentCash:o=0}){const s=E.useRef(null),i=E.useRef(null),{pushModal:l,awaitTop:u}=nn(),[c,d]=E.useState(""),h=Number(e||0),f=Number(n||0),x=Number(o||0),y=E.useMemo(()=>{const S=Math.floor(Number(c));return Number.isFinite(S)&&S>0?S:0},[c]),b=E.useMemo(()=>h<=0?0:Math.max(0,Math.floor(x/h)),[x,h]),_=y*h,p=y*f,g=y*1500,w=y>0,j=S=>{const A=Math.floor(Number(S)||0),v=Math.max(0,Math.min(A,1e6));d(String(v))},R=S=>{var A,v;(A=S==null?void 0:S.preventDefault)==null||A.call(S),(v=S==null?void 0:S.stopPropagation)==null||v.call(S),t==null||t({action:"SKIP"})},C=async()=>{if(w){if(x<_){l(a.jsx(vr,{requiredAmount:_,currentCash:x,title:"Saldo insuficiente para contratar Field Sales",message:"Voc no possui saldo suficiente para concluir esta contratao.",okLabel:"Entendi"})),await u();return}t==null||t({action:"BUY",qty:y,unitHire:h,unitExpense:f,totalHire:_,totalExpense:p,cashDelta:-_,expenseDelta:p,revenueDelta:g,cost:_,total:_,role:"FIELD"})}};return E.useEffect(()=>{const S=document.body.style.overflow;document.body.style.overflow="hidden";const A=setTimeout(()=>{var O,M;return(M=(O=s.current)==null?void 0:O.focus)==null?void 0:M.call(O)},0),v=setTimeout(()=>{var O,M;return(M=(O=i.current)==null?void 0:O.focus)==null?void 0:M.call(O)},50),D=O=>{O.key==="Enter"&&(O.preventDefault(),C())};return window.addEventListener("keydown",D),()=>{document.body.style.overflow=S,window.removeEventListener("keydown",D),clearTimeout(A),clearTimeout(v)}},[]),a.jsx("div",{style:Qe.wrap,role:"dialog","aria-modal":"true",onMouseDown:S=>{S.target===S.currentTarget&&S.stopPropagation()},children:a.jsxs("div",{style:Qe.card,onMouseDown:S=>S.stopPropagation(),children:[a.jsx("button",{ref:s,type:"button",style:Qe.close,onClick:R,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:Qe.title,children:["Voc pode escolher quantos ",a.jsx("b",{children:"Field Sales"})," quer comprar,",a.jsx("br",{}),"Digite o nmero de vendedores:"]}),a.jsxs("div",{style:Qe.inlineInfo,children:[a.jsxs("div",{children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",x.toLocaleString()]})]}),a.jsxs("div",{children:["Mximo por saldo: ",a.jsx("b",{children:b})]})]}),a.jsxs("div",{style:Qe.qtyRow,children:[a.jsx("input",{ref:i,type:"number",inputMode:"numeric",min:1,placeholder:"Digite o nmero de Field Sales",value:c,onChange:S=>j(S.target.value),style:Qe.input}),a.jsxs("div",{style:Qe.quickBtns,children:[a.jsx("button",{type:"button",style:Qe.qbtn,onClick:()=>j(y+1),children:"+1"}),a.jsx("button",{type:"button",style:Qe.qbtn,onClick:()=>j(y+5),children:"+5"}),a.jsx("button",{type:"button",style:Qe.qbtn,onClick:()=>j(y+10),children:"+10"}),a.jsx("button",{type:"button",style:Qe.qbtn,onClick:()=>j(b),title:"Comprar o mximo possvel com o saldo atual",children:"Mx"})]})]}),a.jsxs("div",{style:Qe.infoBox,children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"FIELD SALES (REPRESENTANTES COMERCIAIS)"}),a.jsxs("div",{style:{opacity:.9,marginBottom:8},children:["Base para clculo de despesa: ",a.jsx("b",{children:"x quantidade de Field Sales"}),".",a.jsx("br",{}),"Base para clculo de faturamento: ",a.jsx("b",{children:"x quantidade mxima de clientes que cada vendedor pode atender"}),".",a.jsx("br",{}),"Cada vendedor atende at ",a.jsx("b",{children:r})," clientes."]}),a.jsxs("div",{style:Qe.table,children:[a.jsxs("div",{style:Qe.trHead,children:[a.jsx("div",{style:Qe.th,children:"Certificao"}),a.jsx("div",{style:Qe.th,children:"Contratao"}),a.jsx("div",{style:Qe.th,children:"Despesa"}),a.jsx("div",{style:Qe.th,children:"Faturamento"})]}),a.jsx(Ni,{label:"S/ Certificado",hire:"$ 3.000",expense:"$ 2.000",revenue:"$ 1.500"}),a.jsx(Ni,{label:"Com 1 certificado",hire:"-",expense:"$ 2.100",revenue:"$ 2.000"}),a.jsx(Ni,{label:"Com 2 certificados",hire:"-",expense:"$ 2.200",revenue:"$ 2.500"}),a.jsx(Ni,{label:"Com 3 certificados",hire:"-",expense:"$ 2.300",revenue:"$ 3.000"})]})]}),a.jsxs("div",{style:Qe.summary,children:[a.jsxs("div",{children:["Custo de contratao: ",a.jsxs("b",{children:["$ ",Number(e).toLocaleString()]})," / vendedor"]}),a.jsxs("div",{children:["Despesa mensal: ",a.jsxs("b",{children:["$ ",Number(n).toLocaleString()]})," / vendedor"]})]}),a.jsxs("div",{style:Qe.summaryStrong,children:[a.jsxs("div",{children:["Total contratar: ",a.jsxs("b",{children:["$ ",Number(_).toLocaleString()]})]}),a.jsxs("div",{children:["Despesa mensal total: ",a.jsxs("b",{children:["$ ",Number(p).toLocaleString()]})]})]}),a.jsxs("div",{style:Qe.actions,children:[a.jsx("button",{type:"button",style:{...Qe.bigBtn,background:"#666",color:"#fff"},onClick:R,children:"No comprar"}),a.jsxs("button",{type:"button",style:{...Qe.bigBtn,background:w?"#75e16c":"#365b31",color:"#0b120a"},onClick:C,disabled:!w,title:w?x<_?"Saldo insuficiente":void 0:"Informe uma quantidade vlida",children:["Comprar ",w?`(${y})`:""]})]})]})})}function Ni({label:t,hire:e,expense:n,revenue:r}){return a.jsxs("div",{style:Qe.tr,children:[a.jsx("div",{style:Qe.td,children:t}),a.jsx("div",{style:Qe.td,children:e}),a.jsx("div",{style:Qe.td,children:n}),a.jsx("div",{style:Qe.td,children:r})]})}const Qe={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(880px, 92vw)",maxWidth:880,background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px 20px 16px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:800,lineHeight:1.3},inlineInfo:{display:"flex",justifyContent:"space-between",gap:10,margin:"0 0 8px",opacity:.95,fontWeight:700,flexWrap:"wrap"},qtyRow:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},input:{flex:"1 1 260px",height:42,borderRadius:10,padding:"0 12px",border:"1px solid rgba(255,255,255,.18)",background:"#0f1320",color:"#fff",outline:"none"},quickBtns:{display:"flex",gap:6,flexWrap:"wrap"},qbtn:{height:42,padding:"0 12px",borderRadius:10,border:"1px solid rgba(255,255,255,.18)",background:"#2a2f3b",color:"#fff",cursor:"pointer",fontWeight:800},infoBox:{border:"1px solid rgba(255,255,255,.12)",borderRadius:12,padding:"12px",background:"#101522",marginBottom:12},table:{border:"1px solid rgba(255,255,255,.12)",borderRadius:10,overflow:"hidden"},trHead:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",background:"#121621"},th:{padding:"10px 12px",fontWeight:800,borderLeft:"1px solid rgba(255,255,255,.06)"},tr:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",background:"#0f1320"},td:{padding:"10px 12px",borderTop:"1px solid rgba(255,255,255,.06)",borderLeft:"1px solid rgba(255,255,255,.06)"},summary:{display:"flex",justifyContent:"space-between",border:"1px dashed rgba(255,255,255,.2)",borderRadius:10,padding:"8px 12px",marginTop:10,flexWrap:"wrap",gap:10},summaryStrong:{display:"flex",justifyContent:"space-between",border:"1px solid rgba(255,255,255,.25)",borderRadius:10,padding:"10px 12px",marginTop:8,fontWeight:800,flexWrap:"wrap",gap:10},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:12,flexWrap:"wrap"},bigBtn:{minWidth:180,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function bf({onResolve:t,unitHire:e=1500,unitExpense:n=1e3,attendsUpTo:r=2,currentCash:o=0}){const[s,i]=E.useState(""),l=E.useRef(null),u=E.useRef(null),{pushModal:c,awaitTop:d}=nn(),h=Number(e||0),f=Number(n||0),x=Number(o||0),y=600,b=E.useMemo(()=>{const C=Math.floor(Number(s));return Number.isFinite(C)&&C>0?C:0},[s]),_=E.useMemo(()=>h<=0?0:Math.max(0,Math.floor(x/h)),[x,h]),p=E.useMemo(()=>b*h,[b,h]),m=E.useMemo(()=>b*f,[b,f]),g=b>0,w=C=>{const S=Math.floor(Number(C)||0),A=Math.max(0,Math.min(S,1e6));i(String(A))},j=C=>{var S;(S=C==null?void 0:C.stopPropagation)==null||S.call(C),t==null||t({action:"SKIP"})},R=async()=>{if(!g)return;if(x<p){c(a.jsx(vr,{requiredAmount:p,currentCash:x,title:"Saldo insuficiente para contratar vendedores",message:"Voc no possui saldo suficiente para concluir esta contratao.",okLabel:"Entendi"})),await d();return}const C={action:"BUY",role:"COMMON",qty:b,headcount:b,unitHire:h,unitExpense:f,totalHire:p,totalExpense:m,total:p,cost:p,attendsUpTo:r,cashDelta:-p,expenseDelta:m,revenueDelta:y*b,revenuePerSeller:y,hudUpdate:{category:"Vendedores Comuns",addQty:b}};t==null||t(C)};return E.useEffect(()=>{const C=document.body.style.overflow;document.body.style.overflow="hidden";const S=setTimeout(()=>{var D,O;return(O=(D=l.current)==null?void 0:D.focus)==null?void 0:O.call(D)},0),A=setTimeout(()=>{var D,O;return(O=(D=u.current)==null?void 0:D.focus)==null?void 0:O.call(D)},50),v=D=>{D.key==="Enter"&&(D.preventDefault(),R())};return window.addEventListener("keydown",v),()=>{document.body.style.overflow=C,window.removeEventListener("keydown",v),clearTimeout(S),clearTimeout(A)}},[]),a.jsx("div",{style:Xe.wrap,role:"dialog","aria-modal":"true","aria-label":"Comprar Vendedores Comuns",onMouseDown:C=>{C.target===C.currentTarget&&C.stopPropagation()},children:a.jsxs("div",{style:Xe.card,onMouseDown:C=>C.stopPropagation(),children:[a.jsx("button",{ref:l,type:"button",style:Xe.close,onClick:j,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:Xe.title,children:["Voc pode escolher quantos ",a.jsx("b",{children:"Vendedores Comuns"})," quer comprar,",a.jsx("br",{}),"Digite o nmero de vendedores:"]}),a.jsxs("div",{style:Xe.inlineInfo,children:[a.jsxs("div",{children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",x.toLocaleString()]})]}),a.jsxs("div",{children:["Mximo por saldo: ",a.jsx("b",{children:_})]})]}),a.jsxs("div",{style:Xe.qtyRow,children:[a.jsx("input",{ref:u,type:"number",inputMode:"numeric",min:1,placeholder:"Digite o nmero de Vendedores Comuns",value:s,onChange:C=>w(C.target.value),style:Xe.input}),a.jsxs("div",{style:Xe.quickBtns,children:[a.jsx("button",{type:"button",style:Xe.qbtn,onClick:()=>w(b+1),children:"+1"}),a.jsx("button",{type:"button",style:Xe.qbtn,onClick:()=>w(b+5),children:"+5"}),a.jsx("button",{type:"button",style:Xe.qbtn,onClick:()=>w(b+10),children:"+10"}),a.jsx("button",{type:"button",style:Xe.qbtn,onClick:()=>w(_),title:"Comprar o mximo possvel com o saldo atual",children:"Mx"})]})]}),a.jsxs("div",{style:Xe.infoBox,children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"VENDEDOR COMUM (FAZ TUDO)"}),a.jsxs("div",{style:{opacity:.9,marginBottom:8},children:["Base para clculo despesa: ",a.jsx("b",{children:"x quantidade vendedor comum"}),".",a.jsx("br",{}),"Base para clculo faturamento: ",a.jsx("b",{children:"x quantidade mxima de clientes que cada vendedor pode atender"}),".",a.jsx("br",{}),a.jsxs("b",{children:["Atende at ",r," clientes"]}),"."]}),a.jsxs("div",{style:Xe.table,children:[a.jsxs("div",{style:Xe.trHead,children:[a.jsx("div",{style:Xe.th,children:"Certificao"}),a.jsx("div",{style:Xe.th,children:"Contratao"}),a.jsx("div",{style:Xe.th,children:"Despesa"}),a.jsx("div",{style:Xe.th,children:"Faturamento"})]}),a.jsx(Di,{label:"S/ Certificado",hire:"$ 1.500",expense:"$ 1.000",revenue:"$ 600"}),a.jsx(Di,{label:"Com 1 certificado",hire:"-",expense:"$ 1.100",revenue:"$ 700"}),a.jsx(Di,{label:"Com 2 certificados",hire:"-",expense:"$ 1.200",revenue:"$ 800"}),a.jsx(Di,{label:"Com 3 certificados",hire:"-",expense:"$ 1.300",revenue:"$ 900"})]})]}),a.jsxs("div",{style:Xe.summary,children:[a.jsxs("div",{children:["Custo de contratao: ",a.jsxs("b",{children:["$ ",Number(e).toLocaleString()]})," / vendedor"]}),a.jsxs("div",{children:["Despesa mensal: ",a.jsxs("b",{children:["$ ",Number(n).toLocaleString()]})," / vendedor"]})]}),a.jsxs("div",{style:Xe.summaryStrong,children:[a.jsxs("div",{children:["Total contratar: ",a.jsxs("b",{children:["$ ",Number(p).toLocaleString()]})]}),a.jsxs("div",{children:["Despesa mensal total: ",a.jsxs("b",{children:["$ ",Number(m).toLocaleString()]})]})]}),a.jsxs("div",{style:Xe.actions,children:[a.jsx("button",{type:"button",style:{...Xe.bigBtn,background:"#666",color:"#fff"},onClick:j,children:"No comprar"}),a.jsx("button",{type:"button",disabled:!g,style:{...Xe.bigBtn,background:g?"#7cbe1a":"#3a3f4a",color:"#0d1200",fontWeight:900},onClick:R,title:g?x<p?"Saldo insuficiente":void 0:"Informe uma quantidade vlida",children:"Comprar"})]})]})})}function Di({label:t,hire:e,expense:n,revenue:r}){return a.jsxs("div",{style:Xe.tr,children:[a.jsx("div",{style:Xe.td,children:t}),a.jsx("div",{style:Xe.td,children:e}),a.jsx("div",{style:Xe.td,children:n}),a.jsx("div",{style:Xe.td,children:r})]})}const Xe={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(880px, 92vw)",maxWidth:880,background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px 20px 16px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:800,lineHeight:1.3},inlineInfo:{display:"flex",justifyContent:"space-between",gap:10,margin:"0 0 8px",opacity:.95,fontWeight:700,flexWrap:"wrap"},qtyRow:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},input:{flex:"1 1 260px",height:42,borderRadius:10,padding:"0 12px",border:"1px solid rgba(255,255,255,.18)",background:"#111522",color:"#eef2f7",outline:"none"},quickBtns:{display:"flex",gap:6,flexWrap:"wrap"},qbtn:{height:42,padding:"0 12px",borderRadius:10,border:"1px solid rgba(255,255,255,.18)",background:"#2a2f3b",color:"#fff",cursor:"pointer",fontWeight:800},infoBox:{background:"#161a28",border:"1px solid rgba(255,255,255,.12)",borderRadius:14,padding:14,marginTop:6},table:{border:"1px solid rgba(255,255,255,.12)",borderRadius:12,overflow:"hidden",marginTop:8},trHead:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",background:"#121621"},th:{padding:"10px 12px",fontWeight:800,borderLeft:"1px solid rgba(255,255,255,.06)"},tr:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",background:"#0f1320"},td:{padding:"10px 12px",borderTop:"1px solid rgba(255,255,255,.06)",borderLeft:"1px solid rgba(255,255,255,.06)"},summary:{display:"flex",justifyContent:"space-between",border:"1px dashed rgba(255,255,255,.2)",borderRadius:10,padding:"8px 12px",marginTop:10,flexWrap:"wrap",gap:10},summaryStrong:{display:"flex",justifyContent:"space-between",border:"1px solid rgba(255,255,255,.25)",borderRadius:10,padding:"10px 12px",marginTop:8,fontWeight:800,flexWrap:"wrap",gap:10},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:12,flexWrap:"wrap"},bigBtn:{minWidth:180,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function wf({onResolve:t,currentCash:e,currentLevel:n=null,mixOwned:r=null}){const o=E.useRef(null),{pushModal:s,awaitTop:i}=nn(),l={A:{compra:12e3,despesa:700,faturamento:1200,color:"#1d4ed8",pill:"NVEL A",label:"100 produtos"},B:{compra:6e3,despesa:400,faturamento:600,color:"#16a34a",pill:"NVEL B",label:"50 produtos"},C:{compra:3e3,despesa:200,faturamento:300,color:"#f59e0b",pill:"NVEL C",label:"20 produtos"},D:{compra:1e3,despesa:50,faturamento:100,color:"#6b7280",pill:"NVEL D",label:"5 produtos"}};async function u(d){if(r?r[d]===!0:n===d)return;const f=l[d],x=Number((f==null?void 0:f.compra)||0),y=Number(e);if(Number.isFinite(y)&&y>=0&&y<x){s(a.jsx(vr,{requiredAmount:x,currentCash:y,title:"Saldo insuficiente para adquirir o Mix de Produtos",message:`Voc precisa de $ ${x.toLocaleString()} mas possui $ ${y.toLocaleString()}.`,okLabel:"Entendi"})),await i();return}t==null||t({action:"BUY",level:d,...f})}function c(){t==null||t({action:"SKIP"})}return E.useEffect(()=>{const d=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var h,f;return(f=(h=o.current)==null?void 0:h.focus)==null?void 0:f.call(h)},0),()=>{document.body.style.overflow=d}},[]),a.jsx("div",{style:hn.wrap,role:"dialog","aria-modal":"true","aria-label":"Mix de Produtos",children:a.jsxs("div",{style:hn.card,children:[a.jsx("button",{ref:o,type:"button",style:hn.close,onClick:c,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:hn.title,children:["Escolha um ",a.jsx("b",{children:"mix de produtos"}),":"]}),a.jsxs("div",{style:hn.note,children:[a.jsx("div",{style:{fontWeight:900,marginBottom:4},children:"MIX DE PRODUTOS"}),a.jsxs("div",{children:["Base para clculo de ",a.jsx("b",{children:"Despesa"}),"/",a.jsx("b",{children:"Faturamento"}),": multiplicar pela ",a.jsx("b",{children:"quantidade total de clientes"}),"."]})]}),Number.isFinite(Number(e))&&a.jsxs("div",{style:hn.saldo,children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",Number(e||0).toLocaleString()]})]}),a.jsx("div",{style:hn.cards,children:["A","B","C","D"].map(d=>{const h=l[d],f=r?r[d]===!0:n===d,x=f;return a.jsxs("div",{style:{...hn.cardItem,borderColor:f?"#16a34a":"rgba(255,255,255,.15)",opacity:x?.6:1},children:[a.jsx("div",{style:{...hn.pill,background:f?"#16a34a":"#fff",color:f?"#fff":"#111"},children:f?" ADQUIRIDO":h.pill}),a.jsx("div",{style:{...hn.cardBadge,background:h.color}}),a.jsxs("ul",{style:hn.lines,children:[a.jsx("li",{children:a.jsx("b",{children:h.label})}),a.jsxs("li",{children:["Compra: ",a.jsxs("b",{children:["$ ",h.compra.toLocaleString()]})]}),a.jsxs("li",{children:["Despesa: ",a.jsxs("b",{children:["$ ",h.despesa.toLocaleString()]})]}),a.jsxs("li",{children:["Faturamento: ",a.jsxs("b",{children:["$ ",h.faturamento.toLocaleString()]})]})]}),a.jsx("button",{type:"button",style:{...hn.buyBtn,background:x?"#6b7280":"#2442f9",cursor:x?"not-allowed":"pointer"},onClick:()=>u(d),disabled:x,title:x?`Mix nvel ${d} j adquirido`:`Comprar Mix de Produtos ${d}`,children:x?"J Adquirido":`Comprar ${d}`})]},d)})}),a.jsx("div",{style:hn.actions,children:a.jsx("button",{type:"button",style:{...hn.bigBtn,background:"#444",color:"#fff"},onClick:c,children:"No comprar"})})]})})}const hn={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(980px, 94vw)",background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:900},note:{background:"#2a2f3b",border:"1px solid rgba(255,255,255,.15)",borderRadius:12,padding:"10px 12px",margin:"0 0 10px"},saldo:{margin:"0 0 10px",padding:"8px 12px",border:"1px dashed rgba(255,255,255,.25)",borderRadius:10},cards:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:12,marginTop:8},cardItem:{background:"#0f1320",border:"1px solid",borderRadius:14,padding:"12px",display:"flex",flexDirection:"column",gap:8},cardBadge:{width:"100%",height:6,borderRadius:999,opacity:.9},pill:{alignSelf:"flex-start",fontSize:12,fontWeight:900,padding:"4px 8px",borderRadius:999,color:"#111"},lines:{margin:0,padding:"0 0 0 16px",lineHeight:1.35},buyBtn:{marginTop:"auto",padding:"10px 12px",borderRadius:10,border:"none",fontWeight:900,cursor:"pointer",background:"#2442f9",color:"#fff"},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:14},bigBtn:{minWidth:160,padding:"14px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function Kx({onResolve:t,player:e={}}){const n=E.useRef(null),r=(_,p=0)=>Number.isFinite(Number(_))?Number(_):p,o=_=>r(_.am,0)>0,s=_=>r(_.az,0)>0,i=_=>r(_.rox,0)>0,l=_=>String(_.erpLevel||_.erpSistemas||"D").toUpperCase()==="A",u=_=>{const p=String(_.mixProdutos||"D").toUpperCase();return p==="A"||p==="B"},c=_=>{var m;const p=g=>{if(!g)return 0;try{const w=Array.isArray(g)?g:Object.values(g);return new Set(w).size}catch{return 0}};return(m=_.trainingsByVendor)!=null&&m.gestor?p(_.trainingsByVendor.gestor):r(_.gestoresCertificados,0)},d=_=>r(_.vendedoresComuns)+r(_.insideSales)+r(_.fieldSales)+r(_.gestores??_.gestoresComerciais??_.managers),h=E.useMemo(()=>[{id:"gov_fgts",kind:"SORTE",title:"Ao Governamental Positiva",text:"Liberao de FGTS aumentou o poder de compra. Receba 5 novos clientes (se tiver equipe para atender).",clientsDelta:5},{id:"referral_bonus",kind:"SORTE",title:"Indicao Lucrativa",text:"Um cliente indicou amigos e a primeira compra foi tima. Receba R$ 800,00.",cashDelta:800},{id:"network_cert_mgr",kind:"SORTE",title:"Rede Estratgica",text:"Para cada gestor com certificado, receba R$ 5.000,00.",_compute:_=>({cashDelta:5e3*c(_)})},{id:"innovation_invest",kind:"SORTE",title:"Inovao Premiada",text:"Se tiver infraestrutura (mix/sistemas) nvel A ou B, receba aporte de R$ 25.000,00.",_compute:_=>({cashDelta:u(_)?25e3:0})},{id:"segmentation",kind:"SORTE",title:"Segmentao Inteligente",text:"Novo segmento lucrativo. Receba R$ 1.000,00.",cashDelta:1e3},{id:"casa_bonus_10k",kind:"SORTE",title:"Casagrande Insights",text:"Implementao bem-sucedida. Receba R$ 10.000,00.",cashDelta:1e4},{id:"casa_network_7k",kind:"SORTE",title:"Rede de Contatos Valiosa",text:"Parceria estratgica. Ganhe R$ 7.000,00.",cashDelta:7e3},{id:"casa_strategy_5k",kind:"SORTE",title:"Estratgia Personalizada",text:"Processos melhorados. Receba R$ 5.000,00.",cashDelta:5e3},{id:"casa_best_practices_8k",kind:"SORTE",title:"Melhores Prticas",text:"Eficincia aumentada. Receba R$ 8.000,00.",cashDelta:8e3},{id:"casa_start_6k",kind:"SORTE",title:"Satisfao do Cliente em Alta",text:"Fidelidade e vendas sobem. Receba R$ 6.000,00.",cashDelta:6e3},{id:"casa_change_cert_blue",kind:"SORTE",title:"Gesto de Mudanas Bem-sucedida",text:"Um vendedor generalista concluiu todos os treinamentos. Ganhe um certificado AZUL para esse vendedor.",_compute:()=>({certDelta:{az:1}})},{id:"training_roi_team",kind:"SORTE",title:"Treinamento Personalizado",text:"Receba R$ 500,00 por membro participante.",_compute:_=>({cashDelta:500*Math.max(0,d(_))})},{id:"purple_award_25k",kind:"SORTE",title:"Profissional do Ano (Roxo)",text:"Se houver pelo menos um colaborador com certificado roxo, receba R$ 25.000,00.",_compute:_=>({cashDelta:i(_)?25e3:0})},{id:"reputation_1500",kind:"SORTE",title:"Reputao Impecvel",text:"timas avaliaes elevam a confiana. Receba R$ 1.500,00.",cashDelta:1500},{id:"client_cheer_per_client",kind:"SORTE",title:"Cliente Promotor",text:"Ganhe R$ 500,00 por cada cliente atual.",_compute:_=>({cashDelta:500*Math.max(0,r(_.clients))})},{id:"big_order_freight_save",kind:"SORTE",title:"Grande Pedido + Frete Econmico",text:"Receba R$ 1.500,00.",cashDelta:1500},{id:"sales_win_2k",kind:"SORTE",title:"Vitria de Vendas",text:"Venda aguardada foi fechada. Receba R$ 2.000,00.",cashDelta:2e3},{id:"missed_admission",kind:"REVES",title:"Admisso No Reportada",text:"Multa governamental. Pague R$ 3.000,00.",cashDelta:-3e3},{id:"office_renovation",kind:"REVES",title:"Renovao Custosa",text:"Gastos de obra. Pague R$ 7.000,00.",cashDelta:-7e3},{id:"env_fine_20k",kind:"REVES",title:"Impacto Ambiental",text:"Multa ambiental. Pague R$ 20.000,00.",cashDelta:-2e4},{id:"key_client_at_risk",kind:"REVES",title:"Cliente Chave em Risco",text:"Sem certificado AMARELO: perca 1 cliente e pague R$ 2.000,00.",_compute:_=>o(_)?{clientsDelta:0,cashDelta:0,_overrideText:"Voc possui certificado amarelo. Nada acontece."}:{clientsDelta:-1,cashDelta:-2e3}},{id:"social_crisis",kind:"REVES",title:"Crise nas Redes",text:"Pague R$ 400,00 e perca 2 clientes.",cashDelta:-400,clientsDelta:-2},{id:"car_break",kind:"REVES",title:"Carro Quebrou",text:"Conserto urgente. Pague R$ 1.000,00.",cashDelta:-1e3},{id:"service_improvement_1k",kind:"REVES",title:"Aprimoramentos de Servio",text:"Pague R$ 1.000,00.",cashDelta:-1e3},{id:"recovery_failed_5k",kind:"REVES",title:"Recuperao Mal Sucedida",text:"Cancele grande pedido. Pague R$ 5.000,00.",cashDelta:-5e3},{id:"discount_pressure_1k",kind:"REVES",title:"Descontos Forados",text:"Sem certificado verde: perca R$ 1.000,00 de lucro.",cashDelta:-1e3},{id:"domino_2k",kind:"REVES",title:"Efeito Domin",text:"Cancelamentos em cadeia. Perca R$ 2.000,00.",cashDelta:-2e3},{id:"needs_change_lose4",kind:"REVES",title:"Necessidades Mudaram",text:"Sem certificado AZUL: perca 4 clientes.",_compute:_=>s(_)?{clientsDelta:0,_overrideText:"Voc possui certificado azul. Nada acontece."}:{clientsDelta:-4}},{id:"payroll_error_1k",kind:"REVES",title:"Erro na Folha",text:"Corrigir problema. Pague R$ 1.000,00.",cashDelta:-1e3},{id:"strike_lose5",kind:"REVES",title:"Greve Inesperada",text:"Atrasos e perdas. Perca 5 clientes.",clientsDelta:-5},{id:"customs_hold_3k",kind:"REVES",title:"Alfndega",text:"Pague R$ 3.000,00.",cashDelta:-3e3},{id:"cyber_breach_7k_or_A",kind:"REVES",title:"Falha de Segurana",text:"Se NO tiver sistemas nvel A, pague R$ 7.000,00.",_compute:_=>({cashDelta:l(_)?0:-7e3})},{id:"supplier_issue_2k",kind:"REVES",title:"Fornecedor em Crise",text:"Expedio expressa. Pague R$ 2.000,00.",cashDelta:-2e3},{id:"reg_change_30k",kind:"REVES",title:"Regulamentao Nova",text:"Adequao de processos. Pague R$ 30.000,00.",cashDelta:-3e4},{id:"bad_mix_2500",kind:"REVES",title:"Mix de Produtos Desequilibrado",text:"Descontos e liquidaes. Pague R$ 2.500,00.",cashDelta:-2500},{id:"quality_crisis",kind:"REVES",title:"Crise de Qualidade",text:"Perca 1 cliente e pague R$ 1.000,00.",cashDelta:-1e3,clientsDelta:-1}],[]),[f]=E.useState(()=>h[Math.floor(Math.random()*h.length)]),x=E.useMemo(()=>{const _={action:"APPLY_CARD",kind:f.kind,id:f.id,title:f.title};if(typeof f._compute=="function"){const m=f._compute(e||{}),{_overrideText:g,...w}=m||{};return{text:g||f.text,payload:{..._,...w}}}const p={};return Number.isFinite(f.cashDelta)&&(p.cashDelta=Number(f.cashDelta)),Number.isFinite(f.clientsDelta)&&(p.clientsDelta=Number(f.clientsDelta)),{text:f.text,payload:{..._,...p}}},[f,e]),y=()=>t==null?void 0:t(x.payload),b=()=>t==null?void 0:t({action:"SKIP"});return E.useEffect(()=>{const _=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var p,m;return(m=(p=n.current)==null?void 0:p.focus)==null?void 0:m.call(p)},0),()=>{document.body.style.overflow=_}},[]),a.jsx("div",{style:_r.wrap,role:"dialog","aria-modal":"true","aria-label":"Sorte e Revs",children:a.jsxs("div",{style:_r.card,children:[a.jsx("button",{ref:n,style:_r.close,onClick:b,"aria-label":"Fechar",children:""}),a.jsx("div",{style:_r.badge(f.kind),children:f.kind==="SORTE"?"SORTE":"REVS"}),f.title&&a.jsx("h2",{style:_r.title,children:f.title}),a.jsx("p",{style:_r.text,children:x.text}),a.jsx("div",{style:_r.footer,children:a.jsx("button",{type:"button",style:_r.okBtn,onClick:y,children:"OK"})})]})})}const _r={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(760px, 92vw)",background:"#1b1f2a",color:"#e9ecf1",borderRadius:18,padding:"22px",border:"1px solid rgba(255,255,255,.12)",boxShadow:"0 10px 40px rgba(0,0,0,.4)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},badge:t=>({display:"inline-block",padding:"6px 12px",borderRadius:999,fontWeight:900,marginBottom:8,background:t==="SORTE"?"#22c55e":"#ef4444",color:"#111"}),title:{margin:"2px 0 6px",fontWeight:900},text:{fontSize:18,lineHeight:1.5,opacity:.95,margin:"6px 0 14px"},footer:{display:"flex",justifyContent:"center"},okBtn:{minWidth:140,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer",background:"#fff",color:"#111"}};function Jx({value:t=0,onResolve:e}){const n=Number(t||0),r=o=>{var s,i;(s=o==null?void 0:o.preventDefault)==null||s.call(o),(i=o==null?void 0:o.stopPropagation)==null||i.call(o),e==null||e({action:"OK"})};return a.jsx(oi,{zIndex:2147483647,onClose:()=>e==null?void 0:e({action:"CLOSE"}),children:a.jsxs("div",{style:{padding:28,textAlign:"center",pointerEvents:"auto"},children:[a.jsx("div",{style:{fontWeight:900,fontSize:28,color:"#4caf50",letterSpacing:.5,marginBottom:6},children:"FATURAMENTO DO MS"}),a.jsx("div",{style:{opacity:.9,marginBottom:16},children:"Ser creditado o valor do Faturamento ao seu Saldo"}),a.jsxs("div",{style:{fontSize:18,marginBottom:24},children:["no valor de: ",a.jsxs("b",{children:["$ ",n.toLocaleString()]})]}),a.jsx("button",{type:"button",onClick:r,className:"btn",style:{minWidth:120,background:"#8bd65a",color:"#1a1f2a",fontWeight:800,borderRadius:10},children:"OK"})]})})}function Yx({expense:t=0,loanCharge:e=0,onResolve:n}){const r=Number(t||0)+Number(e||0),o=s=>{var i,l;(i=s==null?void 0:s.preventDefault)==null||i.call(s),(l=s==null?void 0:s.stopPropagation)==null||l.call(s),n==null||n({action:"OK"})};return a.jsx(oi,{zIndex:2147483647,onClose:()=>n==null?void 0:n({action:"CLOSE"}),children:a.jsxs("div",{style:{padding:28,textAlign:"center",pointerEvents:"auto"},children:[a.jsx("div",{style:{fontWeight:900,fontSize:26,color:"#ffb74d",letterSpacing:.5,marginBottom:6},children:"DESPESAS DO MS"}),a.jsxs("div",{style:{marginBottom:8},children:["Despesas operacionais:",a.jsxs("b",{children:["-$ ",Number(t).toLocaleString()]})]}),Number(e)>0&&a.jsxs("div",{style:{marginBottom:8,color:"#ffd54f"},children:["Emprstimo cobrado nesta rodada:",a.jsxs("b",{children:["-$ ",Number(e).toLocaleString()]})]}),a.jsxs("div",{style:{margin:"6px 0 18px",opacity:.85},children:["Total a debitar: ",a.jsxs("b",{children:["-$ ",r.toLocaleString()]})]}),a.jsx("button",{type:"button",onClick:o,className:"btn",style:{minWidth:120,background:"#ffcc80",color:"#1a1f2a",fontWeight:800,borderRadius:10},children:"OK"})]})})}const We={backdrop:{position:"fixed",inset:0,background:"rgba(0,0,0,.6)",display:"grid",placeItems:"center",zIndex:9999},card:{width:"min(920px, 96vw)",maxHeight:"90vh",overflow:"auto",background:"#15161a",color:"#e9ecf1",border:"1px solid rgba(255,255,255,.08)",borderRadius:20,boxShadow:"0 20px 50px rgba(0,0,0,.5)"},header:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"14px 16px",borderBottom:"1px solid rgba(255,255,255,.08)"},closeBtn:{width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"transparent",color:"#fff",fontSize:20,cursor:"pointer"},body:{padding:16},lead:{opacity:.95,lineHeight:1.5},bullets:{margin:"8px 0 16px 18px"},rowBtns:{display:"flex",gap:12,justifyContent:"flex-end",marginTop:12,flexWrap:"wrap"},cta:{padding:"12px 16px",border:0,borderRadius:12,color:"#fff",fontWeight:900,cursor:"pointer",boxShadow:"0 10px 24px rgba(0,0,0,.25)"},back:{padding:"10px 14px",borderRadius:12,border:"1px solid rgba(255,255,255,.15)",background:"transparent",color:"#e9ecf1",cursor:"pointer"},subHeader:{marginBottom:8},infoRow:{display:"flex",gap:8,alignItems:"baseline",margin:"4px 0"},input:{width:"100%",padding:"12px 12px",borderRadius:12,background:"#0f1115",color:"#fff",border:"1px solid rgba(255,255,255,.15)",marginTop:10},option:{padding:16,background:"rgba(255,255,255,.04)",border:"1px solid rgba(255,255,255,.08)",borderRadius:14,textAlign:"center",cursor:"pointer"},spin:{width:34,height:34,borderRadius:8,border:"1px solid rgba(255,255,255,.15)",background:"transparent",color:"#fff",fontSize:18,cursor:"pointer"}};function Qx({playerName:t,loanAvailable:e,hasPendingLoan:n,onGoLoan:r,onGoReduce:o,onGoFire:s,onDeclareBankruptcy:i}){return a.jsxs("div",{style:We.body,children:[a.jsxs("p",{style:We.lead,children:["Voc est sem dinheiro, ",t,". Escolha uma das opes:"]}),n&&a.jsx("div",{style:{...We.lead,color:"#ef4444",fontWeight:"bold",marginBottom:"16px"},children:" Voc j possui um emprstimo pendente. Cada jogador s pode ter um emprstimo por vez."}),a.jsxs("ul",{style:We.bullets,children:[a.jsxs("li",{children:["Pedir ",a.jsx("b",{children:"emprstimo"})," nico com 50% de juros garantido por 50% dos seus ",a.jsx("b",{children:"BENS"})," (limite ",`$ ${e}`,")."]}),a.jsxs("li",{children:[a.jsx("b",{children:"Reduzir"})," nveis de ",a.jsx("b",{children:"MIX de Produtos"})," ou ",a.jsx("b",{children:"ERP/Sistemas"})," e receber 50% do valor pago."]}),a.jsxs("li",{children:[a.jsx("b",{children:"Demitir"})," funcionrios e receber 50% do valor total."]})]}),a.jsxs("div",{style:We.rowBtns,children:[a.jsx("button",{style:{...We.cta,background:"#ef4444"},onClick:s,children:"DEMITIR"}),a.jsx("button",{style:{...We.cta,background:"#a16207"},onClick:o,children:"REDUZIR"}),a.jsx("button",{style:{...We.cta,background:n?"#6b7280":"#16a34a",cursor:n?"not-allowed":"pointer"},onClick:n?void 0:r,disabled:n,children:n?"EMPRSTIMO (J REALIZADO)":"EMPRSTIMO"}),a.jsx("button",{style:{...We.cta,background:"#d32f2f",fontWeight:"bold"},onClick:i,children:"DECLARAR FALNCIA"})]})]})}function Xx({loanAvailable:t,alreadyHasLoan:e=!1,onBack:n,onConfirm:r}){const[o,s]=E.useState(""),i=E.useMemo(()=>Math.max(0,Math.floor(Number(o)||0)),[o]),l=!e&&i>0&&i<=Number(t||0),u=()=>{if(e){r==null||r({type:"LOAN_DENIED",reason:"ALREADY_TAKEN"});return}const c=Math.max(0,Math.floor(Number(t)||0)),d=Math.max(0,Math.min(c,i));if(d>0){const h={type:"LOAN",amount:d,cashDelta:d,loan:{amount:d,charged:!1}};console.log("[DEBUG] RecoveryLoan enviando payload:",h),r==null||r(h)}else r==null||r({type:"LOAN_DENIED",reason:"INVALID_AMOUNT"})};return a.jsxs("div",{style:We.body,children:[a.jsx("div",{style:We.subHeader,children:a.jsx("b",{style:{fontSize:20},children:"EMPRSTIMO"})}),a.jsxs("p",{children:["Voc pode realizar um emprstimo colocando ",a.jsx("b",{children:"50% dos seus BENS"})," como garantia (pago na prxima Despesas Operacionais)."]}),a.jsxs("div",{style:We.infoRow,children:[a.jsx("span",{children:"Valor disponvel:"})," ",a.jsxs("b",{children:["$",Number(t||0)]})]}),a.jsxs("div",{style:We.infoRow,children:[a.jsx("span",{children:"Valor garantia:"})," ",a.jsxs("b",{children:["$",Number(t||0)]})]}),e&&a.jsx("div",{style:{...We.infoRow,color:"#fca5a5",border:"1px solid rgba(255,0,0,.25)",padding:"8px 10px",borderRadius:8,background:"rgba(255,0,0,.06)"},children:"Voc j possui um emprstimo ativo. No  possvel pegar outro."}),a.jsx("input",{style:We.input,type:"number",min:0,max:Math.max(0,Number(t||0)),placeholder:"Digite o valor que quer emprestar",value:o,onChange:c=>s(c.target.value),disabled:e}),a.jsxs("div",{style:{fontSize:12,opacity:.8,marginTop:6},children:["Mx: $",Number(t||0),"  valor ser somado ao seu saldo e cobrado na prxima Despesas Operacionais."]}),a.jsxs("div",{style:We.rowBtns,children:[a.jsx("button",{style:We.back,onClick:n,children:" Voltar"}),a.jsx("button",{style:{...We.cta,background:"#16a34a",opacity:l?1:.6,cursor:l?"pointer":"not-allowed"},onClick:u,disabled:!l,children:"Pegar Emprstimo"})]})]})}function Zx(t){const{options:e=[],optionsMix:n,optionsErp:r,mixOwned:o,erpOwned:s,credits:i,snapshot:l,onBack:u,onConfirm:c}=t,d=(...v)=>console.log("[RecoveryReduce]",...v),h={MIX:{accent:"#06B6D4",soft:"rgba(6,182,212,.14)",ring:"rgba(6,182,212,.45)",glow:"rgba(6,182,212,.35)",pillBg:"rgba(6,182,212,.18)",pillFg:"#9FF1FF"},ERP:{accent:"#8B5CF6",soft:"rgba(139,92,246,.14)",ring:"rgba(139,92,246,.45)",glow:"rgba(139,92,246,.35)",pillBg:"rgba(139,92,246,.18)",pillFg:"#E9D5FF"}},f=["A","B","C","D"],x=(v,D,O)=>f.map(M=>({key:`${v}-${M}`,group:v,level:M,label:`Nvel ${M}`,credit:Number((D==null?void 0:D[M])??0),owned:!!(O!=null&&O[M])})),y=E.useMemo(()=>Array.isArray(n)&&n.length?n:i!=null&&i.MIX?x("MIX",i.MIX,o):x("MIX",{A:0,B:0,C:0,D:0},o),[n,i,o]),b=E.useMemo(()=>Array.isArray(r)&&r.length?r:i!=null&&i.ERP?x("ERP",i.ERP,s):x("ERP",{A:0,B:0,C:0,D:0},s),[r,i,s]);E.useEffect(()=>{console.groupCollapsed("[RecoveryReduce] props snapshot"),console.log("mixCards:",y),console.log("erpCards:",b),console.log("mixOwned:",o),console.log("erpOwned:",s),console.log("credits:",i),console.groupEnd()},[y,b,o,s,i]);const[_,p]=E.useState([]),[m,g]=E.useState(new Set),[w,j]=E.useState(!1),R=v=>{v.level!=="D"&&(!v.owned||v.owned===!1||m.has(v.key)||v.alreadyReduced||p(D=>D.some(M=>M.key===v.key)?D.filter(M=>M.key!==v.key):[...D,v]))},C=E.useMemo(()=>_.reduce((v,D)=>v+Number(D.credit||0),0),[_]),S=v=>_.some(D=>D.key===v.key),A=v=>{var ie,Pe;const D=S(v),O=v.level==="D",M=v.owned===!0,te=O||!M||m.has(v.key)||v.alreadyReduced||w,ne=h[v.group]||h.MIX,ct={...We.option,position:"relative",borderRadius:14,background:te?"rgba(148,163,184,.12)":ne.soft,border:D?`2.5px solid ${ne.accent}`:"1px solid rgba(148,163,184,.25)",boxShadow:D?`0 0 0 2px ${ne.ring}, 0 10px 24px ${ne.glow}`:"none",cursor:te?"not-allowed":"pointer",opacity:te?.35:1,transition:"transform .06s ease-out, box-shadow .12s ease-out, border-color .12s"},rt={fontWeight:900,fontSize:16,marginBottom:8,color:te?"#CBD5E1":"#E5F9FF"},F={fontWeight:700,marginTop:2,color:te?"#A1A1AA":"#FFFFFF"},le={position:"absolute",top:8,right:8,fontSize:11,padding:"3px 8px",borderRadius:999,background:te?"rgba(148,163,184,.22)":ne.pillBg,color:te?"#E5E7EB":ne.pillFg,border:`1px solid ${te?"rgba(148,163,184,.35)":ne.ring}`,letterSpacing:.2};return a.jsxs("button",{onClick:()=>R(v),disabled:te,"aria-pressed":D,style:ct,title:O?"Nvel D  o bsico e no pode ser reduzido.":M?m.has(v.key)?"Nvel j reduzido nesta sesso.":v.alreadyReduced?"Este nvel j foi reduzido anteriormente. Compre o nvel novamente para poder reduzir.":"":"Este nvel no est disponvel. Compre o nvel novamente para poder reduzir.",onMouseDown:_e=>!te&&(_e.currentTarget.style.transform="translateY(1px)"),onMouseUp:_e=>_e.currentTarget.style.transform="translateY(0)",onMouseLeave:_e=>_e.currentTarget.style.transform="translateY(0)",children:[a.jsx("span",{style:le,children:O?"bsico":M?m.has(v.key)?"vendido":v.alreadyReduced?"j reduzido":"adquirido":"zerado"}),a.jsx("div",{style:rt,children:v.label}),a.jsx("div",{style:{color:te?"#A1A1AA":"#BFEFFF"},children:"Crdito ao reduzir:"}),a.jsxs("div",{style:F,children:["$",((Pe=(ie=v.credit).toLocaleString)==null?void 0:Pe.call(ie))??v.credit]})]},v.key)};return a.jsxs("div",{style:We.body,children:[a.jsx("div",{style:We.subHeader,children:a.jsx("b",{style:{fontSize:20},children:"REDUZIR NVEL MIX/ERP"})}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[a.jsxs("div",{style:{padding:8,borderRadius:8,background:"rgba(255,255,255,0.05)"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"MIX PRODUTOS"}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:12},children:y.map(A)})]}),a.jsxs("div",{style:{padding:8,borderRadius:8,background:"rgba(255,255,255,0.05)"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"ERP/SISTEMAS"}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:12},children:b.map(A)})]})]}),a.jsxs("div",{style:{marginTop:10,display:"flex",justifyContent:"space-between",alignItems:"center",opacity:.92},children:[a.jsxs("div",{children:["Selecionados: ",a.jsx("b",{children:_.length}),"    Total: ",a.jsxs("b",{children:["$",C.toLocaleString()]})]}),a.jsx("div",{style:{fontSize:12,opacity:.7},children:"S  possvel selecionar nveis adquiridos."})]}),a.jsxs("div",{style:We.rowBtns,children:[a.jsx("button",{style:We.back,onClick:u,disabled:w,children:" Voltar"}),a.jsx("button",{style:{...We.cta,background:"#F59E0B",color:"#101010",fontWeight:900,opacity:_.length&&!w?1:.55},onClick:()=>{if(!_.length||w)return;j(!0),g(D=>{const O=new Set(D);return _.forEach(M=>O.add(M.key)),O});const v={items:_.map(D=>({...D,selected:!0})),total:C};d("confirm payload =>",v),c==null||c(v),p([]),j(!1)},disabled:!_.length||w,children:"REDUZIR"})]})]})}function eb({roles:t=[],onBack:e,onConfirm:n}){const r=E.useMemo(()=>t.map(f=>{const x=Number(f.unit??f.total??0),y=Number(f.owned??f.qty??0);return{...f,unit:x,owned:y}}),[t]),[o,s]=E.useState(()=>{const f={};return r.forEach(x=>{f[x.key]=0}),f}),i=f=>`R$ ${Number(f||0).toLocaleString("pt-BR")}`,l=f=>Math.floor(Number(f||0)*.5),u=(f,x)=>{s(y=>{const b=r.find(m=>m.key===f);if(!b)return y;const _=Number(y[f]||0),p=Math.max(0,Math.min(b.owned,_+x));return p===_?y:{...y,[f]:p}})},c=E.useMemo(()=>{const f={};return r.forEach(x=>{const y=Number(o[x.key]||0);f[x.key]=l(x.unit)*y}),f},[o,r]),d=E.useMemo(()=>Object.values(c).reduce((f,x)=>f+x,0),[c]),h=()=>{if(d<=0)return;const f={};r.forEach(x=>{f[x.key]=Number(o[x.key]||0)}),n==null||n({type:"FIRE",items:f,creditByRole:c,totalCredit:d,amount:d,note:`Demisses +${i(d)}`})};return a.jsxs("div",{style:We.body,children:[a.jsx("div",{style:We.subHeader,children:a.jsx("b",{style:{fontSize:20},children:"DEMITIR FUNCIONRIOS"})}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1.2fr 1fr 1.2fr 1fr",gap:8,opacity:.9,fontWeight:700,marginBottom:6},children:[a.jsx("div",{children:"Cargo"}),a.jsx("div",{children:"Valor Unitrio"}),a.jsx("div",{children:"Qtd demitir"}),a.jsx("div",{children:"Crdito"})]}),a.jsx("div",{style:{display:"grid",gap:12},children:r.map(f=>{const x=Number(o[f.key]||0),y=Number(f.unit||0),b=Number(f.owned||0),_=l(y),p=_*x,m=x<=0,g=x>=b||b<=0;return a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1.2fr 1fr 1.2fr 1fr",alignItems:"center",gap:8},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:800},children:f.label}),a.jsxs("div",{style:{opacity:.75,fontSize:12},children:["Possui: ",a.jsx("b",{children:b})]})]}),a.jsxs("div",{children:[a.jsx("div",{children:a.jsx("b",{children:i(y)})}),a.jsxs("div",{style:{opacity:.75,fontSize:12},children:["Crdito por un.: ",a.jsx("b",{children:i(_)})]})]}),a.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center"},children:[a.jsx("button",{style:{...We.spin,opacity:m?.5:1,cursor:m?"not-allowed":"pointer"},disabled:m,onClick:()=>u(f.key,-1),children:"-"}),a.jsx("div",{style:{minWidth:28,textAlign:"center",fontWeight:800},children:x}),a.jsx("button",{style:{...We.spin,opacity:g?.5:1,cursor:g?"not-allowed":"pointer"},disabled:g,onClick:()=>u(f.key,1),children:"+"})]}),a.jsx("div",{children:a.jsx("b",{children:i(p)})})]},f.key)})}),a.jsxs("div",{style:{marginTop:12,textAlign:"right",fontWeight:900},children:["Total a resgatar: ",a.jsx("b",{children:i(d)})]}),a.jsxs("div",{style:We.rowBtns,children:[a.jsx("button",{style:We.back,onClick:e,children:" Voltar"}),a.jsx("button",{style:{...We.cta,background:"#ef4444",opacity:d>0?1:.6},onClick:h,disabled:d<=0,children:"DEMITIR"})]})]})}function Sf({playerName:t="Jogador",bens:e=0,currentPlayer:n,canClose:r=!0}){var A;const{resolveTop:o,popModal:s}=(nn==null?void 0:nn())||{},[i,l]=E.useState("menu"),u=()=>{r&&(s?s(!1):o==null||o(null))},c=E.useMemo(()=>({A:12e3,B:6e3,C:3e3,D:1e3}),[]),d=E.useMemo(()=>({A:1e4,B:4e3,C:1500,D:500}),[]),h=v=>{if(v==null)return"";const D=String(v).trim().toUpperCase();if(["A","B","C","D"].includes(D))return D;const O=Number(D);return O===1?"A":O===2?"B":O===3?"C":O===4?"D":""},f=E.useMemo(()=>{const v=n||{};return{name:v.name??t,bens:Number(v.bens??e??0),vendedoresComuns:Number(v.vendedoresComuns??0),fieldSales:Number(v.fieldSales??0),insideSales:Number(v.insideSales??0),gestores:Number(v.gestores??v.gestoresComerciais??0),raw:v}},[n,t,e]);E.useEffect(()=>{console.group("[RecoveryModal] mount snapshot"),console.log("raw player =>",f.raw),console.groupEnd()},[f.raw]);const x=E.useMemo(()=>Math.max(0,Math.floor(f.bens*.5)),[f.bens]),y=E.useMemo(()=>{var D;const v=(D=f.raw)==null?void 0:D.loanPending;return v&&Number(v.amount)>0},[(A=f.raw)==null?void 0:A.loanPending]),b=E.useMemo(()=>[{key:"mix",label:"MIX PRODUTOS",credit:1500},{key:"erp",label:"ERP/SISTEMAS",credit:1500}],[]),_=E.useMemo(()=>[{key:"comum",label:"Vendedor Comum",unit:1500,owned:f.vendedoresComuns},{key:"field",label:"Field Sales",unit:3e3,owned:f.fieldSales},{key:"inside",label:"Inside Sales",unit:3e3,owned:f.insideSales},{key:"gestor",label:"Gestor",unit:5e3,owned:f.gestores}],[f]),p=E.useMemo(()=>{const v=f.raw||{};return h(v.mixProdutosLetter??v.mixProdutos??v.mixProducts??v.mixLevelLetter??v.mixLevel??v.mix_level??v.mix??v.mix_produtos??v.mix_products)},[f.raw]),m=E.useMemo(()=>{var D;const v=f.raw||{};return h(v.erpSistemasLetter??v.erpSistemas??((D=v.erpSystems)==null?void 0:D.level)??v.erpSystemsLetter??v.erpLevelLetter??v.erpLevel??v.erp_level??v.erp??v.erp_sistemas)},[f.raw]),g=E.useMemo(()=>{const v=f.raw||{},D=v.mixOwned??v.mix??{},O=new Set;return D.A===!0&&O.add("A"),D.B===!0&&O.add("B"),D.C===!0&&O.add("C"),D.D===!0&&O.add("D"),O.size===0&&O.add("D"),O},[f.raw]),w=E.useMemo(()=>{const v=f.raw||{},D=v.erpOwned??v.erp??{},O=new Set;return D.A===!0&&O.add("A"),D.B===!0&&O.add("B"),D.C===!0&&O.add("C"),D.D===!0&&O.add("D"),O.size===0&&O.add("D"),O},[f.raw]);E.useEffect(()=>{console.group("[RecoveryModal] owned detect"),console.log("mixLetter(panel):",p," -> ownedMix =",Object.fromEntries(["A","B","C","D"].map(v=>[v,g.has(v)]))),console.log("erpLetter(panel):",m," -> ownedErp =",Object.fromEntries(["A","B","C","D"].map(v=>[v,w.has(v)]))),console.groupEnd()},[p,m,g,w]);const j=E.useMemo(()=>{var D,O;const v=f.raw||{};return{MIX:Array.isArray((D=v.reducedLevels)==null?void 0:D.MIX)?v.reducedLevels.MIX:[],ERP:Array.isArray((O=v.reducedLevels)==null?void 0:O.ERP)?v.reducedLevels.ERP:[]}},[f.raw]),R=E.useMemo(()=>["A","B","C","D"].map(v=>({key:`mix-${v}`,group:"MIX",level:v,label:`Nvel ${v}`,credit:(c[v]||0)/2,owned:g.has(v),alreadyReduced:j.MIX.includes(v)})),[g,c,j.MIX]),C=E.useMemo(()=>["A","B","C","D"].map(v=>({key:`erp-${v}`,group:"ERP",level:v,label:`Nvel ${v}`,credit:(d[v]||0)/2,owned:w.has(v),alreadyReduced:j.ERP.includes(v)})),[w,d,j.ERP]),S=E.useMemo(()=>({MIX:{A:c.A/2,B:c.B/2,C:c.C/2,D:c.D/2},ERP:{A:d.A/2,B:d.B/2,C:d.C/2,D:d.D/2}}),[c,d]);return a.jsx("div",{style:We.backdrop,children:a.jsxs("div",{style:We.card,children:[a.jsxs("div",{style:We.header,children:[a.jsx("div",{style:{fontWeight:900,fontSize:22},children:"RECUPERAO FINANCEIRA"}),r&&a.jsx("button",{onClick:u,style:We.closeBtn,children:""})]}),i==="menu"&&a.jsx(Qx,{playerName:f.name,loanAvailable:x,hasPendingLoan:y,onGoLoan:()=>l("loan"),onGoReduce:()=>l("reduce"),onGoFire:()=>l("fire"),onDeclareBankruptcy:()=>o==null?void 0:o({type:"TRIGGER_BANKRUPTCY"})}),i==="loan"&&a.jsx(Xx,{loanAvailable:x,onBack:()=>l("menu"),onConfirm:v=>{console.log("[DEBUG] RecoveryModal recebeu payload do RecoveryLoan:",v),console.log("[DEBUG] RecoveryModal chamando resolveTop com:",v);const D=o==null?void 0:o(v);console.log("[DEBUG] RecoveryModal resolveTop retornou:",D)}}),i==="reduce"&&a.jsx(Zx,{options:b,optionsMix:R,optionsErp:C,mixOwned:{A:g.has("A"),B:g.has("B"),C:g.has("C"),D:g.has("D")},erpOwned:{A:w.has("A"),B:w.has("B"),C:w.has("C"),D:w.has("D")},credits:S,snapshot:f,onBack:()=>l("menu"),onConfirm:v=>{if(Array.isArray(v==null?void 0:v.items)){const M=Number(v.total??v.items.filter(te=>te.selected).reduce((te,ne)=>te+Number(ne.credit||0),0));o==null||o({type:"REDUCE",amount:M,items:v.items,note:`Reduo mltipla +R$ ${M.toLocaleString()}`});return}const D=Number((v==null?void 0:v.credit)||(v==null?void 0:v.amount)||0),O=v&&v.group&&v.level?{group:String(v.group).toUpperCase(),level:String(v.level).toUpperCase(),credit:D}:null;o==null||o({type:"REDUCE",amount:D,group:O==null?void 0:O.group,level:O==null?void 0:O.level,selection:O,note:O?`Reduo ${O.group} nvel ${O.level} +R$ ${D.toLocaleString()}`:`Reduo +R$ ${D.toLocaleString()}`})}}),i==="fire"&&a.jsx(eb,{roles:_,onBack:()=>l("menu"),onConfirm:v=>o==null?void 0:o(v)})]},i)})}function tb({playerName:t="Jogador",balanceText:e=""}){const{resolveTop:n,closeModal:r}=nn(),o=E.useRef(null);E.useEffect(()=>{var c;const u=document.body.style.overflow;return document.body.style.overflow="hidden",(c=o.current)==null||c.focus(),()=>{document.body.style.overflow=u}},[]),E.useEffect(()=>{const u=c=>{(c.key==="Escape"||c.key==="Enter"||c.key===" ")&&(c.preventDefault(),c.stopPropagation())};return document.addEventListener("keydown",u,!0),()=>document.removeEventListener("keydown",u,!0)},[]);const s=u=>{u.preventDefault(),u.stopPropagation()},i=()=>{n(!1),r==null||r()},l=()=>{n(!0),r==null||r()};return a.jsxs(oi,{width:780,onClose:i,children:[a.jsx("style",{children:`
        .sg-modal-panel {
          background:#111827; border:1px solid rgba(255,255,255,0.08);
          border-radius:16px; padding:20px 22px 18px; color:#e5e7eb;
          position:relative; box-shadow:0 10px 35px rgba(0,0,0,.55);
        }
        .sg-modal-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
        .sg-modal-title{font-size:22px;font-weight:700;margin:0}
        .sg-icon-close{background:transparent;border:0;color:#9ca3af;font-size:24px;line-height:1;cursor:pointer}
        .sg-icon-close:hover{color:#e5e7eb}

        .sg-modal-infos{display:flex;justify-content:space-between;align-items:center;
          font-size:14px;color:#cbd5e1;margin:6px 0 12px}
        .sg-modal-infos .right{opacity:.8}

        .sg-callout-warning{
          background:rgba(250,204,21,.12); border:1px solid rgba(250,204,21,.45);
          border-radius:12px; padding:14px 16px; margin-bottom:14px
        }
        .sg-callout-title{font-weight:700;margin-bottom:6px;color:#fde68a}
        .sg-muted{opacity:.7}

        .sg-modal-body{margin:8px 2px 14px;font-size:15px;line-height:1.5}

        .sg-modal-actions{display:flex;justify-content:space-between;gap:12px;margin-top:10px}
        .sg-btn{font-weight:600;border:0;cursor:pointer;padding:12px 18px}
        .sg-pill{border-radius:999px}
        .sg-btn-neutral{background:#374151;color:#e5e7eb}
        .sg-btn-neutral:hover{background:#4b5563}
        .sg-btn-danger{background:#b91c1c;color:#fff}
        .sg-btn-danger:hover{background:#991b1b}
        .sg-btn:focus{outline:2px solid rgba(255,255,255,.35);outline-offset:2px}
      `}),a.jsxs("div",{className:"sg-modal-panel",role:"dialog","aria-modal":"true","aria-labelledby":"bk-title","aria-describedby":"bk-desc",onClick:s,onMouseDown:s,onKeyDown:s,children:[a.jsxs("div",{className:"sg-modal-header",children:[a.jsx("h2",{id:"bk-title",className:"sg-modal-title",children:"Declarar Falncia"}),a.jsx("button",{className:"sg-icon-close","aria-label":"Fechar",onClick:i,children:""})]}),a.jsxs("div",{className:"sg-modal-infos",children:[a.jsx("div",{className:"left",children:e?a.jsxs(a.Fragment,{children:["Saldo disponvel: ",a.jsx("b",{children:e})]}):a.jsx(a.Fragment,{children:""})}),a.jsx("div",{className:"right",children:"Ao permanente nesta partida"})]}),a.jsxs("div",{className:"sg-callout-warning",id:"bk-desc",children:[a.jsx("div",{className:"sg-callout-title",children:"Ateno"}),a.jsxs("p",{children:[t,", ao confirmar, voc ser marcado como ",a.jsx("b",{children:"FALIDO"}),". Seu turno ser ",a.jsx("b",{children:"sempre pulado"})," e voc no poder mais executar aes."]}),a.jsx("p",{className:"sg-muted",children:"Esta deciso  irreversvel at o fim da partida."})]}),a.jsx("div",{className:"sg-modal-body",children:a.jsxs("p",{children:["Confirme abaixo para encerrar sua participao ativa. Voc continuar visvel no placar como ",a.jsx("b",{children:"FALIDO"}),"."]})}),a.jsxs("div",{className:"sg-modal-actions",children:[a.jsx("button",{className:"sg-btn sg-pill sg-btn-neutral",onClick:i,children:"Cancelar"}),a.jsx("button",{ref:o,className:"sg-btn sg-pill sg-btn-danger",onClick:l,children:"Declarar Falncia"})]})]})]})}function nb({players:t,setPlayers:e,round:n,setRound:r,turnIdx:o,setTurnIdx:s,roundFlags:i,setRoundFlags:l,isMyTurn:u,isMine:c,myUid:d,meId:h,myCash:f,current:x,broadcastState:y,appendLog:b,turnLock:_,setTurnLockBroadcast:p,gameOver:m,setGameOver:g,winner:w,setWinner:j,setShowBankruptOverlay:R}){const{pushModal:C,awaitTop:S,closeTop:A}=(nn==null?void 0:nn())||{},[v,D]=ye.useState(0),O=ye.useRef(0);ye.useEffect(()=>{O.current=v},[v]);const M=ye.useRef(!1),te=ye.useRef(!1),ne=ye.useRef(null),ct=ye.useRef(null),rt=ye.useCallback(q=>{if(!Array.isArray(q)||q.length===0)return q;const Me=[...q].filter(Boolean);let Ne=Me.every(Le=>Number.isInteger(Le.seat))?Me.sort((Le,Ue)=>Le.seat-Ue.seat):Me.sort((Le,Ue)=>String((Le==null?void 0:Le.id)??(Le==null?void 0:Le.player_id)??"").localeCompare(String((Ue==null?void 0:Ue.id)??(Ue==null?void 0:Ue.player_id)??""))),Dt=0;const T=new Set(Ne.filter(Le=>Number.isInteger(Le.seat)).map(Le=>Le.seat));return Ne=Ne.map(Le=>{if(Number.isInteger(Le.seat))return Le;for(;T.has(Dt);)Dt++;return T.add(Dt),{...Le,seat:Dt++}}),Ne=Ne.sort((Le,Ue)=>Le.seat-Ue.seat),Ne},[]),F=ye.useMemo(()=>rt(t),[t,rt]);ye.useEffect(()=>{u?console.log("[DEBUG] modalLocks sync - isMyTurn:",u,"modalLocks:",v):v>0&&(console.log("[DEBUG] modalLocks sync - resetando modalLocks para 0 (no  minha vez)"),D(0),O.current=0,M.current=!1)},[u,v]),ye.useEffect(()=>(_?(ne.current&&clearTimeout(ne.current),ne.current=setTimeout(()=>{const q=Pe.current,Me=String(q||"")===String(d),Be=O.current,Ne=M.current;console.warn("[DEBUG]  TIMEOUT DE SEGURANA - turnLock ativo h mais de 30s",{isLockOwner:Me,currentModalLocks:Be,currentOpening:Ne,lockOwner:q}),Me&&Be===0&&!Ne&&(console.warn("[DEBUG]  FORANDO LIBERAO DO TURNLOCK (timeout de segurana)"),p(!1),te.current=!1)},3e4)):ne.current&&(clearTimeout(ne.current),ne.current=null),()=>{ne.current&&(clearTimeout(ne.current),ne.current=null)}),[_,d,p]);const[le,ie]=ye.useState(null),Pe=ye.useRef(null);ye.useEffect(()=>{Pe.current=le},[le]);const _e=ye.useRef(null),re=ye.useRef(n);ye.useEffect(()=>{re.current=n,console.log("[DEBUG]  currentRoundRef atualizado para:",n)},[n]);const we=ye.useRef(t);ye.useEffect(()=>{we.current=t},[t]);const bn=ye.useRef(o);ye.useEffect(()=>{bn.current=o},[o]);const Et=ye.useRef(m);ye.useEffect(()=>{Et.current=m},[m]);const Y=ye.useRef(!1),br=ye.useRef(!1);ye.useEffect(()=>{const q=t[o];q&&String(q.id)===String(d)?(console.log("[DEBUG]  minha vez - atualizando lockOwner para:",d,"turnIdx:",o),ie(String(d)),_e.current&&(_e.current.nextTurnIdx===o?(console.log("[DEBUG] Limpando pendingTurnDataRef - turno j foi processado (nextTurnIdx === turnIdx)"),_e.current=null):console.log("[DEBUG] Mantendo pendingTurnDataRef - prximo turno:",_e.current.nextTurnIdx,"turno atual:",o))):(le===String(d)&&(console.log("[DEBUG] No  mais minha vez - limpando lockOwner"),ie(null)),_e.current&&_e.current.nextTurnIdx!==o&&(console.log("[DEBUG] Limpando pendingTurnDataRef - no  minha vez e dados no so para turno atual"),_e.current=null))},[o,t,d,le]);const Oe=async q=>{if(!(C&&S))return null;M.current=!0,D(Be=>{const Ne=Be+1;return O.current=Ne,ct.current=null,console.log("[DEBUG] openModalAndWait - ABRINDO modal, modalLocks:",Be,"->",Ne,"openingModalRef:",M.current),Ne});let Me=!1;try{C(q),await new Promise(Ne=>setTimeout(Ne,100)),M.current=!1,console.log("[DEBUG] openModalAndWait - Modal renderizada, openingModalRef:",M.current);const Be=await S();return Me=!0,await new Promise(Ne=>setTimeout(Ne,50)),Be}catch(Be){return console.error("[DEBUG]  ERRO ao abrir/aguardar modal:",Be),Me=!0,M.current=!1,D(Ne=>{const Dt=Math.max(0,Ne-1);return O.current=Dt,Dt===0&&(ct.current=Date.now()),console.log("[DEBUG] openModalAndWait - ERRO, decrementando modalLocks:",Ne,"->",Dt),Dt}),null}finally{Me||(M.current=!1),Me&&D(Be=>{const Ne=Math.max(0,Be-1);return O.current=Ne,Ne===0&&(ct.current=Date.now(),console.log("[DEBUG] openModalAndWait - LTIMA MODAL FECHADA - timestamp:",ct.current)),console.log("[DEBUG] openModalAndWait - FECHANDO modal, modalLocks:",Be,"->",Ne),Ne})}},In=ye.useCallback((q,Me)=>{const Be=t[q],Ne=Math.max(0,Number(Me||0));return Number((Be==null?void 0:Be.cash)||0)>=Ne},[t]),dt=ye.useCallback((q,Me,Be)=>{const Ne=In(q,Me);return Ne||b(`Saldo insuficiente${Be?" para "+Be:""}. Use RECUPERAO (demitir / emprestar / reduzir) ou declare FALNCIA.`),Ne},[In,b]),qr=ye.useCallback((q,Me,Be)=>{var Le;if(Me<=5)return!1;const Ne=(q||[]).filter(Ue=>!(Ue!=null&&Ue.bankrupt));if(Ne.length===0){console.log("[DEBUG]  FIM DE JOGO - Nenhum jogador vivo restante"),e(q),j(null),g(!0),r(5),re.current=5,b("Fim de jogo! Todos os jogadores falidos."),_e.current=null,p(!1);try{y(q||[],Be||o,5,!0,null,{round:5,gameOver:!0,winner:null})}catch{}return!0}const T=((Le=Ne.map(Ue=>({player:Ue,patrimonio:(Ue.cash||0)+(Ue.bens||0),cash:Ue.cash||0})).sort((Ue,Wt)=>{var Mt,W;return Wt.patrimonio-Ue.patrimonio||Wt.cash-Ue.cash||String(((Mt=Ue.player)==null?void 0:Mt.name)||"").localeCompare(String(((W=Wt.player)==null?void 0:W.name)||""))})[0])==null?void 0:Le.player)||null;console.log("[ENDGAME] finalizando: vencedor=",(T==null?void 0:T.name)||"N/A",", round=5"),e(q),j(T),g(!0),r(5),re.current=5,b(`Fim de jogo! 5 rodadas completas. Vencedor: ${(T==null?void 0:T.name)||""}`),_e.current=null,p(!1);try{y(q||[],Be||o,5,!0,T,{round:5,gameOver:!0,winner:T})}catch{}return!0},[b,y,g,r,p,j,o]),sn=ye.useCallback((q,Me,Be)=>{var Ne,Dt;if(console.log("[DEBUG]  advanceAndMaybeLap chamada - steps:",q,"deltaCash:",Me,"note:",Be),!(Et.current||Y.current||br.current||!t.length)){if(te.current){console.warn("[DEBUG]  advanceAndMaybeLap - mudana de turno j em progresso, ignorando");return}if(O.current>0||M.current){console.warn("[DEBUG]  advanceAndMaybeLap - h modais abertas, aguardando...",{modalLocks:O.current,opening:M.current}),setTimeout(()=>{O.current===0&&!M.current&&sn(q,Me,Be)},200);return}te.current=!0,p(!0),ie(String(d));try{const T=o,Le=F[T];if(!Le){p(!1),te.current=!1;return}const Ue=String(Le.id);console.log("[DEBUG]  POSIO INICIAL - Jogador:",Le.name,"Posio:",Le.pos,"Saldo:",Le.cash);const Wt=async(k,B,H,K=t)=>{var G,Z,ue,ce,He,Je,Te,_t,tt,bt,Tt,Vt,Rn,Mn,Bn;const ge=Number(((G=K[T])==null?void 0:G.cash)||0);if(ge>=k){console.log("[DEBUG]  Saldo suficiente! Processando pagamento de:",k);const Se=rt(K).map(P=>String(P.id)!==Ue?P:{...P,cash:Math.max(0,(P.cash||0)-k),pos:P.pos});return e(Se),y(Se,o,re.current),!0}M.current=!0;const fe=await Oe(a.jsx(vr,{requiredAmount:k,currentCash:ge,title:`Saldo insuficiente para ${H} ${B}`,message:`Voc precisa ${H} R$ ${k.toLocaleString()} mas possui apenas R$ ${ge.toLocaleString()}.`,showRecoveryOptions:!0}));if(!fe)return p(!1),!1;if(fe.action==="RECOVERY"){console.log("[DEBUG] Abrindo RecoveryModal para jogador:",K[T]);const Se=await Oe(a.jsx(Sf,{currentPlayer:K[T],canClose:!1}));if(console.log("[DEBUG] RecoveryModal retornou:",Se),Se){console.log("[DEBUG] recoveryModalRes existe, tipo:",Se.type,"action:",Se.action);let P=K;if(Se.type==="FIRE"){console.log("[DEBUG]  Condio FIRE atendida! Processando demisses:",Se);const oe={cashDelta:Number(Se.amount||0),vendedoresComunsDelta:-Number(((Z=Se.items)==null?void 0:Z.comum)||0),fieldSalesDelta:-Number(((ue=Se.items)==null?void 0:ue.field)||0),insideSalesDelta:-Number(((ce=Se.items)==null?void 0:ce.inside)||0),gestoresDelta:-Number(((He=Se.items)==null?void 0:He.gestor)||0)};console.log("[DEBUG] Deltas de demisso:",oe),P=K.map((he,pe)=>pe!==T?he:{...Pt(he,oe),pos:he.pos}),console.log("[DEBUG] Novo saldo aps demisses:",(Je=P[T])==null?void 0:Je.cash),e(P),y(P,o,re.current)}else if(Se.type==="LOAN"){console.log("[DEBUG]  Condio LOAN atendida! Processando emprstimo:",Se);const oe=(Te=K[T])==null?void 0:Te.loanPending;if(oe&&Number(oe.amount)>0){console.log("[DEBUG]  Jogador j possui emprstimo pendente:",oe);const pe=await Oe(a.jsx(vr,{requiredAmount:k,currentCash:((_t=K[T])==null?void 0:_t.cash)||0,title:"Emprstimo j realizado",message:`Voc j possui um emprstimo pendente de R$ ${Number(oe.amount).toLocaleString()}. Cada jogador s pode ter um emprstimo por vez.`,showRecoveryOptions:!1,canClose:!1}));if(!pe||pe.action!=="BANKRUPT")return p(!1),!1;const me=K.map((Hr,ts)=>ts===T?{...Hr,bankrupt:!0}:Hr);if(Ds(me)<=1){const Hr=me.findIndex(ts=>!(ts!=null&&ts.bankrupt));return j(Hr>=0?me[Hr]:null),e(me),g(!0),p(!1),y(me,o,n,!0,Hr>=0?me[Hr]:null),!1}const Ke=ds(me,T),Nn=me[Ke],dm=Nn!=null&&Nn.id?String(Nn.id):null;return e(me),s(Ke),p(!1),y(me,Ke,re.current,!1,null,{turnPlayerId:dm}),!1}const he=Number(Se.amount||0);console.log("[DEBUG] Valor do emprstimo:",he),console.log("[DEBUG] Saldo atual do jogador:",(tt=K[T])==null?void 0:tt.cash),P=K.map((pe,me)=>me!==T?pe:{...pe,cash:(Number(pe.cash)||0)+he,loanPending:{amount:he,charged:!1,shouldChargeOnNextExpenses:!0},pos:pe.pos}),console.log("[DEBUG] Novo saldo do jogador:",(bt=P[T])==null?void 0:bt.cash),console.log("[DEBUG] Novo loanPending:",(Tt=P[T])==null?void 0:Tt.loanPending),e(P),y(P,o,re.current)}else if(Se.type==="REDUCE"){console.log("[DEBUG]  Condio REDUCE atendida! Processando reduo:",Se);const oe=Se.items||[];let he=0;console.log("[DEBUG] Selees para reduzir:",oe),P=K.map((pe,me)=>{if(me!==T)return pe;let Ee={...pe};for(const Ke of oe)Ke.selected&&(he+=Number(Ke.credit||0),Ke.group==="MIX"?Ee.mixOwned={...Ee.mixOwned||{},[Ke.level]:!1}:Ke.group==="ERP"&&(Ee.erpOwned={...Ee.erpOwned||{},[Ke.level]:!1}));return Ee.cash=(Number(Ee.cash)||0)+he,Ee.pos=pe.pos,Ee}),console.log("[DEBUG] Total de crdito da reduo:",he),console.log("[DEBUG] Novo saldo aps reduo:",(Vt=P[T])==null?void 0:Vt.cash),e(P),y(P,o,re.current)}else console.log("[DEBUG]  Nenhuma condio foi atendida! Tipo:",Se.type,"Action:",Se.action);const ke=Number(((Rn=P[T])==null?void 0:Rn.cash)||0);if(console.log("[DEBUG] Verificando saldo aps recuperao - Novo saldo:",ke,"Necessrio:",k),ke>=k){console.log("[DEBUG]  Saldo suficiente aps recuperao! Processando pagamento de:",k);const oe=P.map((he,pe)=>pe!==T?he:{...he,cash:Math.max(0,(he.cash||0)-k),pos:he.pos});return console.log("[DEBUG]  PAGAMENTO - Saldo antes:",(Mn=P[T])==null?void 0:Mn.cash,"Valor a pagar:",k,"Saldo aps:",(Bn=oe[T])==null?void 0:Bn.cash),e(oe),y(oe,o,re.current),!0}else return console.log("[DEBUG]  Saldo ainda insuficiente aps recuperao. Continuando recurso..."),await Wt(k,B,H,P)}else return p(!1),!1}else if(fe.action==="BANKRUPT"){const Se=K.map((pe,me)=>me===T?{...pe,bankrupt:!0}:pe);if(Ds(Se)<=1){const pe=Se.findIndex(me=>!(me!=null&&me.bankrupt));return j(pe>=0?Se[pe]:null),e(Se),g(!0),p(!1),y(Se,o,n,!0,pe>=0?Se[pe]:null),!1}const ke=ds(Se,T),oe=Se[ke],he=oe!=null&&oe.id?String(oe.id):null;return e(Se),s(ke),p(!1),y(Se,ke,re.current,!1,null,{turnPlayerId:he}),!1}else return p(!1),!1},Mt=Le.pos,W=(Mt+q)%Ns,de=W<Mt,De=de&&Mt>=Ns-1;console.log("[DEBUG]  MOVIMENTO - De posio:",Mt,"Para posio:",W,"Steps:",q,"Lap:",de,"CompletedLap:",De);const ve=kl(Mt,W,0)||de,Fe=re.current,ze=t.filter(k=>!(k!=null&&k.bankrupt)).length,J=rt(t).map(k=>{if(String(k.id)!==Ue)return k;const B=(k.cash||0)+(Me||0),H=Number(k.lastRevenueRound)||0;let K=!1,ge=W;if(ve){const fe=Math.max(H,Fe);return Fe===5&&ze>1&&(K=!0,ge=0),{...k,pos:ge,cash:Math.max(0,B),lastRevenueRound:fe,waitingAtRevenue:K}}return{...k,pos:ge,cash:Math.max(0,B),lastRevenueRound:H,waitingAtRevenue:!1}}),Ae=J.find(k=>String(k.id)===Ue);console.log("[DEBUG]  APS MOVIMENTO - Jogador:",Ae==null?void 0:Ae.name,"Posio:",Ae==null?void 0:Ae.pos,"Saldo:",Ae==null?void 0:Ae.cash,"lastRevenueRound:",Ae==null?void 0:Ae.lastRevenueRound,"waitingAtRevenue:",Ae==null?void 0:Ae.waitingAtRevenue);let N=re.current,I=[...i],se=!1,xe=!1;if(de){console.log("[DEBUG]  VOLTA COMPLETA DETECTADA (lap=true) - Jogador completou uma volta completa!",{jogador:Le.name,posicaoAnterior:Mt,posicaoNova:W,rodadaAtual:re.current}),I.length<t.length&&(I=[...I,...new Array(t.length-I.length).fill(!1)]);const k=F.findIndex(B=>String(B.id)===Ue);k>=0&&(I[k]=!0),console.log("[DEBUG]  Flag marcada por volta completa (lap) - Flags:",I.map((B,H)=>{var K;return`${(K=F[H])==null?void 0:K.name}:${B}`}).join(", "))}if(ve){I.length<t.length&&(I=[...I,...new Array(t.length-I.length).fill(!1)]);const k=F.findIndex(G=>String(G.id)===Ue);k>=0&&(I[k]?console.log("[DEBUG]  Jogador j tinha flag marcada (por lap) - Flags:",I.map((G,Z)=>{var ue;return`${(ue=F[Z])==null?void 0:ue.name}:${G}`}).join(", ")):(I[k]=!0,console.log("[DEBUG]  Jogador passou pela casa 0 (crossedStart1ForRound) - Flags:",I.map((G,Z)=>{var ue;return`${(ue=F[Z])==null?void 0:ue.name}:${G}`}).join(", "))));const B=J.filter(G=>!(G!=null&&G.bankrupt)),H=J.map((G,Z)=>G!=null&&G.bankrupt?-1:Z).filter(G=>G>=0),K=J.filter(G=>!(G!=null&&G.bankrupt)),ge=K.length>0&&K.every(G=>(Number(G.lastRevenueRound)||0)>=re.current);console.log("[DEBUG]  Verificando allAliveDone - Rodada atual:",re.current,"Jogadores vivos:",K.map(G=>({name:G.name,lastRevenueRound:G.lastRevenueRound})));const fe=J.find(G=>String(G.id)===Ue);if(console.log("[DEBUG]  Verificao de rodada - Jogador:",fe==null?void 0:fe.name,"Rodada atual:",re.current,"round do closure:",n),console.log("[DEBUG]  Jogadores vivos:",H.map(G=>{const Z=J[G],ue=F.findIndex(ce=>String(ce.id)===String(Z==null?void 0:Z.id));return`${Z==null?void 0:Z.name}:${ue>=0?I[ue]:!1}`}).join(", ")),console.log("[DEBUG]  Total de jogadores vivos:",H.length),console.log("[DEBUG]  Flags completas:",I.map((G,Z)=>{var ue;return`${(ue=J[Z])==null?void 0:ue.name}:${G?"":""}`}).join(", ")),console.log("[DEBUG]  Todos passaram pela casa 0?",ge),ge){const G=re.current;if(N=G+1,se=!0,G===5&&se){console.log("[ENDGAME] detectado: fim da 5 (tentaria round=6)"),qr(J,6,o);return}console.log("[DEBUG]  Calculando incremento - round (ref):",G,"round (closure):",n,"nextRound:",N),I=I.map((ue,ce)=>{var He;return(He=J[ce])!=null&&He.bankrupt?I[ce]:!1}),console.log("[DEBUG]  RODADA INCREMENTADA - Nova rodada:",N,"Rodada anterior (ref):",G,"Rodada anterior (closure):",n,"Jogadores vivos:",K.length),console.log("[DEBUG]  Flags resetadas:",I.map((ue,ce)=>{var He;return`${(He=J[ce])==null?void 0:He.name}:${ue}`}).join(", ")),b(` Rodada ${N} iniciada! Todos os jogadores vivos passaram pela casa de faturamento.`)}else{const G=K.filter(Z=>(Number(Z.lastRevenueRound)||0)<re.current).map(Z=>Z.name);console.log("[DEBUG]  Rodada NO incrementada - ainda faltam jogadores completarem o ms:",G.join(", "))}}l(I),console.log("[DEBUG] roundFlags updated / round closed:",I.map((k,B)=>{var H;return`${(H=J[B])==null?void 0:H.name}:${k}`}).join(", "));let L=ds(J,T);if(re.current===5){let k=0;for(;k<J.length;){const B=J[L];if(!B.bankrupt&&B.waitingAtRevenue!==!0)break;L=(L+1)%J.length,k++}}Me&&b(`${Le.name} ${Me>0?"ganhou":"pagou"} $${Math.abs(Me).toLocaleString()}`),Be&&b(Be),e(J),r(k=>{let B=k;return se?N>k?(B=N,console.log("[DEBUG]  RODADA INCREMENTADA - Rodada anterior:",k,"Nova rodada:",B,"nextRound calculado:",N),console.log("[DEBUG]  Rodada incrementada com sucesso!"),b(` Rodada ${B} iniciada! Todos os jogadores vivos passaram pela casa de faturamento.`)):(B=k+1,console.log("[DEBUG]  RODADA INCREMENTADA (forado) - Rodada anterior:",k,"Nova rodada:",B,"nextRound calculado:",N),console.log("[DEBUG]  Rodada incrementada com sucesso (forado devido a sincronizao)!"),b(` Rodada ${B} iniciada! Todos os jogadores vivos passaram pela casa de faturamento.`)):(B=Math.max(N,k),B!==k&&console.log("[DEBUG]  Rodada atualizada via Math.max - prevRound:",k,"nextRound:",N,"finalRound:",B)),re.current=B,B});const $=N,z=I,V=J[L],je=V!=null&&V.id?String(V.id):null;if(_e.current={nextPlayers:J,nextTurnIdx:L,nextTurnPlayerId:je,nextRound:$,nextRoundFlags:z,timestamp:Date.now(),shouldIncrementRound:se,endGame:xe},console.log("[DEBUG]  pendingTurnDataRef preenchido - prximo turno:",L,"rodada atual:",n,"prxima rodada:",$,"nextRound calculado:",N,"shouldIncrementRound:",se,"rodada foi incrementada?",N>n,"roundFlags:",z.map((k,B)=>{var H;return`${(H=J[B])==null?void 0:H.name}:${k}`}).join(", ")),qr(J,N,o)){_e.current=null,te.current=!1,M.current=!1;return}const ae=W+1,Ce=kl(Mt,W,0),et=kl(Mt,W,22);let gt=!1;if((ae===6||ae===16||ae===32||ae===49)&&u&&C&&S&&(gt=!0,M.current=!0,(async()=>{var ge,fe,G,Z,ue;const k=((ge=t[T])==null?void 0:ge.erpLevel)||null,B=((fe=t[T])==null?void 0:fe.erpOwned)||((G=t[T])==null?void 0:G.erp)||{},H=await Oe(a.jsx(pf,{currentCash:((Z=J[T])==null?void 0:Z.cash)??f,currentLevel:k,erpOwned:B}));if(!H||H.action!=="BUY")return;const K=Number(((ue=H.values)==null?void 0:ue.compra)||0);if(!dt(T,K,"comprar ERP")){p(!1);return}e(ce=>{const He=ce.map((Je,Te)=>Te!==T?Je:Pt(Je,{cashDelta:-K,erpLevelSet:H.level}));return y(He,o,re.current),He})})()),(ae===2||ae===11||ae===19||ae===47)&&u&&C&&S&&(M.current=!0,(async()=>{var K,ge,fe,G;const k=t.find(c)||J[T],B=await Oe(a.jsx(mf,{canTrain:{comum:Number(k==null?void 0:k.vendedoresComuns)||0,field:Number(k==null?void 0:k.fieldSales)||0,inside:Number(k==null?void 0:k.insideSales)||0,gestor:Number((k==null?void 0:k.gestores)??(k==null?void 0:k.gestoresComerciais)??(k==null?void 0:k.managers))||0},ownedByType:{comum:((K=k==null?void 0:k.trainingsByVendor)==null?void 0:K.comum)||[],field:((ge=k==null?void 0:k.trainingsByVendor)==null?void 0:ge.field)||[],inside:((fe=k==null?void 0:k.trainingsByVendor)==null?void 0:fe.inside)||[],gestor:((G=k==null?void 0:k.trainingsByVendor)==null?void 0:G.gestor)||[]}}));if(!B||B.action!=="BUY")return;const H=Number(B.grandTotal||0);if(!dt(T,H,"comprar Treinamento")){p(!1);return}e(Z=>{const ue=Z.map((ce,He)=>He!==T?ce:ff(ce,B));return y(ue,o,re.current),ue})})()),(ae===5||ae===10||ae===43)&&u&&C&&S&&(M.current=!0,(async()=>{var H,K,ge,fe,G,Z,ue,ce,He,Je,Te,_t,tt,bt,Tt,Vt,Rn,Mn,Bn;const k=((H=J[T])==null?void 0:H.cash)??f,B=await Oe(a.jsx(Hx,{currentCash:k}));if(B){if(B.action==="OPEN"){const Se=String(B.open||"").toUpperCase();if(Se==="MIX"){const P=((K=t[T])==null?void 0:K.mixProdutos)||null,ke=((ge=t[T])==null?void 0:ge.mixOwned)||((fe=t[T])==null?void 0:fe.mix)||{},oe=await Oe(a.jsx(wf,{currentCash:((G=J[T])==null?void 0:G.cash)??f,currentLevel:P,mixOwned:ke}));if(oe&&oe.action==="BUY"){const he=Number(oe.compra||0),pe=String(oe.level||"D");if(!dt(T,he,"comprar MIX")){p(!1);return}e(me=>{const Ee=me.map((Ke,Nn)=>Nn!==T?Ke:Pt(Ke,{cashDelta:-he,mixProdutosSet:pe,mixBaseSet:{despesaPorCliente:Number(oe.despesa||0),faturamentoPorCliente:Number(oe.faturamento||0)}}));return y(Ee,o,re.current),Ee})}return}if(Se==="MANAGER"){const P=await Oe(a.jsx(vf,{currentCash:((Z=J[T])==null?void 0:Z.cash)??f}));if(P&&(P.action==="BUY"||P.action==="HIRE")){const ke=Number(P.headcount??P.qty??P.managersQty??1),oe=Number(typeof P.cashDelta<"u"?P.cashDelta:-Number(P.cost??P.total??P.totalHire??0)),he=oe<0?-oe:0;if(he>0&&!dt(T,he,"contratar Gestor")){p(!1);return}const pe=Number(P.expenseDelta??P.totalExpense??P.maintenanceDelta??0);e(me=>{const Ee=me.map((Ke,Nn)=>Nn!==T?Ke:Pt(Ke,{cashDelta:oe,gestoresDelta:ke,manutencaoDelta:pe}));return y(Ee,o,re.current),Ee})}return}if(Se==="INSIDE"){const P=await Oe(a.jsx(gf,{currentCash:((ue=J[T])==null?void 0:ue.cash)??f}));if(P&&(P.action==="BUY"||P.action==="HIRE")){const ke=Number(P.cost??P.total??0);if(!dt(T,ke,"contratar Inside Sales")){p(!1);return}const oe=Number(P.headcount??P.qty??1);e(he=>{const pe=he.map((me,Ee)=>Ee!==T?me:Pt(me,{cashDelta:-ke,insideSalesDelta:oe}));return y(pe,o,re.current),pe})}return}if(Se==="FIELD"){const P=await Oe(a.jsx(xf,{currentCash:((ce=J[T])==null?void 0:ce.cash)??f}));if(P&&(P.action==="HIRE"||P.action==="BUY")){const ke=Number(P.headcount??P.qty??1),oe={cashDelta:Number(P.cashDelta??-Number(P.totalHire??P.total??P.cost??0)),manutencaoDelta:Number(P.expenseDelta??P.totalExpense??0),revenueDelta:Number(P.revenueDelta??0),fieldSalesDelta:ke},he=oe.cashDelta<0?-oe.cashDelta:0;if(he>0&&!dt(T,he,"contratar Field Sales")){p(!1);return}e(pe=>{const me=pe.map((Ee,Ke)=>Ke!==T?Ee:Pt(Ee,oe));return y(me,o,re.current),me})}return}if(Se==="COMMON"){const P=await Oe(a.jsx(bf,{currentCash:((He=J[T])==null?void 0:He.cash)??f}));if(P&&P.action==="BUY"){const ke=Number(P.headcount??P.qty??0),oe={cashDelta:Number(P.cashDelta??-Number(P.totalHire??P.total??P.cost??0)),vendedoresComunsDelta:ke,manutencaoDelta:Number(P.expenseDelta??P.totalExpense??0),revenueDelta:Number(P.revenueDelta??0)},he=oe.cashDelta<0?-oe.cashDelta:0;if(he>0&&!dt(T,he,"contratar Vendedores Comuns")){p(!1);return}e(pe=>{const me=pe.map((Ee,Ke)=>Ke!==T?Ee:Pt(Ee,oe));return y(me,o,re.current),me})}return}if(Se==="ERP"){const P=((Je=t[T])==null?void 0:Je.erpLevel)||null,ke=((Te=t[T])==null?void 0:Te.erpOwned)||((_t=t[T])==null?void 0:_t.erp)||{},oe=await Oe(a.jsx(pf,{currentCash:((tt=J[T])==null?void 0:tt.cash)??f,currentLevel:P,erpOwned:ke}));if(oe&&oe.action==="BUY"){const he=Number(((bt=oe.values)==null?void 0:bt.compra)||0);if(!dt(T,he,"comprar ERP")){p(!1);return}e(pe=>{const me=pe.map((Ee,Ke)=>Ke!==T?Ee:Pt(Ee,{cashDelta:-he,erpLevelSet:oe.level}));return y(me,o,re.current),me})}return}if(Se==="CLIENTS"){const P=await Oe(a.jsx(yf,{currentCash:((Tt=J[T])==null?void 0:Tt.cash)??f}));if(P&&P.action==="BUY"){const ke=Number(P.totalCost||0);if(!dt(T,ke,"comprar Clientes")){p(!1);return}const oe=Number(P.qty||0),he=Number(P.maintenanceDelta||0),pe=Number(P.bensDelta||ke);e(me=>{const Ee=me.map((Ke,Nn)=>Nn!==T?Ke:Pt(Ke,{cashDelta:-ke,clientsDelta:oe,manutencaoDelta:he,bensDelta:pe}));return y(Ee,o,re.current),Ee})}return}if(Se==="TRAINING"){const P=t.find(c)||J[T],ke=await Oe(a.jsx(mf,{canTrain:{comum:Number(P==null?void 0:P.vendedoresComuns)||0,field:Number(P==null?void 0:P.fieldSales)||0,inside:Number(P==null?void 0:P.insideSales)||0,gestor:Number((P==null?void 0:P.gestores)??(P==null?void 0:P.gestoresComerciais)??(P==null?void 0:P.managers))||0},ownedByType:{comum:((Vt=P==null?void 0:P.trainingsByVendor)==null?void 0:Vt.comum)||[],field:((Rn=P==null?void 0:P.trainingsByVendor)==null?void 0:Rn.field)||[],inside:((Mn=P==null?void 0:P.trainingsByVendor)==null?void 0:Mn.inside)||[],gestor:((Bn=P==null?void 0:P.trainingsByVendor)==null?void 0:Bn.gestor)||[]}}));if(ke&&ke.action==="BUY"){const oe=Number(ke.grandTotal||0);if(!dt(T,oe,"comprar Treinamento")){p(!1);return}e(he=>{const pe=he.map((me,Ee)=>Ee!==T?me:ff(me,ke));return y(pe,o,re.current),pe})}return}}if(B.action==="BUY"){if(B.kind==="CLIENTS"||B.modal==="CLIENTS"||typeof B.clientsQty<"u"||typeof B.numClients<"u"||typeof B.totalCost<"u"||typeof B.maintenanceDelta<"u"){const ke=Number(B.totalCost??B.total??B.amount??0);if(!dt(T,ke,"comprar Clientes")){p(!1);return}const oe=Number(B.clientsQty??B.numClients??B.qty??0),he=Number(B.maintenanceDelta??B.maintenance??B.mexp??0),pe=Number(B.bensDelta??ke);e(me=>{const Ee=me.map((Ke,Nn)=>Nn!==T?Ke:Pt(Ke,{cashDelta:-ke,clientsDelta:oe,manutencaoDelta:he,bensDelta:pe}));return y(Ee,o,re.current),Ee});return}const P=Number(B.total??B.amount??0);if(!dt(T,P,"esta compra")){p(!1);return}e(ke=>{const oe=ke.map((he,pe)=>pe!==T?he:Pt(he,{cashDelta:-P,directBuysPush:[B.item||{total:P}]}));return y(oe,o,re.current),oe})}}})()),(ae===12||ae===21||ae===30||ae===42||ae===53)&&u&&C&&S&&(M.current=!0,(async()=>{var K;const k=await Oe(a.jsx(gf,{currentCash:((K=J[T])==null?void 0:K.cash)??f}));if(!k||k.action!=="HIRE"&&k.action!=="BUY")return;const B=Number(k.cost??k.total??0);if(!dt(T,B,"contratar Inside Sales")){p(!1);return}const H=Number(k.headcount??k.qty??1);e(ge=>{const fe=ge.map((G,Z)=>Z!==T?G:Pt(G,{cashDelta:-B,insideSalesDelta:H}));return y(fe,o,re.current),fe})})()),[4,8,15,17,20,27,34,36,39,46,52,55].includes(ae)&&u&&C&&S&&(M.current=!0,(async()=>{var fe;const k=await Oe(a.jsx(yf,{currentCash:((fe=J[T])==null?void 0:fe.cash)??f}));if(!k||k.action!=="BUY")return;const B=Number(k.totalCost||0);if(!dt(T,B,"comprar Clientes")){p(!1);return}const H=Number(k.qty||0),K=Number(k.maintenanceDelta||0),ge=Number(k.bensDelta||B);e(G=>{const Z=G.map((ue,ce)=>ce!==T?ue:Pt(ue,{cashDelta:-B,clientsDelta:H,manutencaoDelta:K,bensDelta:ge}));return y(Z,o,re.current),Z})})()),[18,24,29,51].includes(ae)&&u&&C&&S&&(M.current=!0,(async()=>{var fe;const k=await Oe(a.jsx(vf,{currentCash:((fe=J[T])==null?void 0:fe.cash)??f}));if(!k||k.action!=="BUY"&&k.action!=="HIRE")return;const B=Number(k.headcount??k.qty??k.managersQty??1),H=Number(typeof k.cashDelta<"u"?k.cashDelta:-Number(k.cost??k.total??k.totalHire??0)),K=H<0?-H:0;if(K>0&&!dt(T,K,"contratar Gestor")){p(!1);return}const ge=Number(k.expenseDelta??k.totalExpense??k.maintenanceDelta??0);e(G=>{const Z=G.map((ue,ce)=>ce!==T?ue:Pt(ue,{cashDelta:H,gestoresDelta:B,manutencaoDelta:ge}));return y(Z,o,re.current),Z})})()),[13,25,33,38,50].includes(ae)&&u&&C&&S&&(M.current=!0,(async()=>{var B;const k=await Oe(a.jsx(xf,{currentCash:((B=J[T])==null?void 0:B.cash)??f}));if(k&&(k.action==="HIRE"||k.action==="BUY")){const H=Number(k.headcount??k.qty??1),K={cashDelta:Number(k.cashDelta??-Number(k.totalHire??k.total??k.cost??0)),manutencaoDelta:Number(k.expenseDelta??k.totalExpense??0),revenueDelta:Number(k.revenueDelta??0),fieldSalesDelta:H},ge=K.cashDelta<0?-K.cashDelta:0;if(ge>0&&!dt(T,ge,"contratar Field Sales")){p(!1);return}e(fe=>{const G=fe.map((Z,ue)=>ue!==T?Z:Pt(Z,K));return y(G,o,re.current),G})}})()),[9,28,40,45].includes(ae)&&u&&C&&S&&(M.current=!0,(async()=>{var ge;const k=await Oe(a.jsx(bf,{currentCash:((ge=J[T])==null?void 0:ge.cash)??f}));if(!k||k.action!=="BUY")return;const B=Number(k.headcount??k.qty??0),H={cashDelta:Number(k.cashDelta??-Number(k.totalHire??k.total??k.cost??0)),vendedoresComunsDelta:B,manutencaoDelta:Number(k.expenseDelta??k.totalExpense??0),revenueDelta:Number(k.revenueDelta??0)},K=H.cashDelta<0?-H.cashDelta:0;if(K>0&&!dt(T,K,"contratar Vendedores Comuns")){p(!1);return}e(fe=>{const G=fe.map((Z,ue)=>ue!==T?Z:Pt(Z,H));return y(G,o,re.current),G})})()),[7,31,44].includes(ae)&&u&&C&&S&&(M.current=!0,(async()=>{var fe,G,Z,ue;const k=((fe=t[T])==null?void 0:fe.mixProdutos)||null,B=((G=t[T])==null?void 0:G.mixOwned)||((Z=t[T])==null?void 0:Z.mix)||{},H=await Oe(a.jsx(wf,{currentCash:((ue=J[T])==null?void 0:ue.cash)??f,currentLevel:k,mixOwned:B}));if(!H||H.action!=="BUY")return;const K=Number(H.compra||0);if(!dt(T,K,"comprar MIX")){p(!1);return}const ge=String(H.level||"D");e(ce=>{const He=ce.map((Je,Te)=>Te!==T?Je:Pt(Je,{cashDelta:-K,mixProdutosSet:ge,mixBaseSet:{despesaPorCliente:Number(H.despesa||0),faturamentoPorCliente:Number(H.faturamento||0)}}));return y(He,o,re.current),He})})()),[3,14,22,26,35,41,48,54].includes(ae)&&u&&C&&S&&(M.current=!0,(async()=>{const k=await Oe(a.jsx(Kx,{}));if(!k||k.action!=="APPLY_CARD")return;const B=J[T]||t.find(c)||{};let H=Number.isFinite(k.cashDelta)?Number(k.cashDelta):0,K=Number.isFinite(k.clientsDelta)?Number(k.clientsDelta):0;if(H<0){const fe=-H;await Wt(fe,"Sorte & Revs","pagar",J)}if(e(fe=>{const G=fe.map((Z,ue)=>{var He;if(ue!==T)return Z;let ce={...Z};if(H&&(ce.cash=Math.max(0,(ce.cash??0)+H)),K){const Je=ce.clients||0;ce.clients=Math.max(0,Je+K),console.log("[DEBUG] SorteReves - Clientes alterados:",Je,"->",ce.clients,"delta:",K)}if(k.gainSpecialCell&&(ce.fieldSales=(ce.fieldSales||0)+(k.gainSpecialCell.fieldSales||0),ce.support=(ce.support||0)+(k.gainSpecialCell.support||0),ce.gestores=(ce.gestores||0)+(k.gainSpecialCell.manager||0),ce.gestoresComerciais=(ce.gestoresComerciais||0)+(k.gainSpecialCell.manager||0),ce.managers=(ce.managers||0)+(k.gainSpecialCell.manager||0)),k.id==="casa_change_cert_blue"){ce.az=(ce.az||0)+1;const Je=new Set(((He=ce.trainingsByVendor)==null?void 0:He.comum)||[]);Je.add("personalizado"),ce.trainingsByVendor={...ce.trainingsByVendor||{},comum:Array.from(Je)}}return ce});return y(G,o,re.current),G}),k.perClientBonus||k.perCertifiedManagerBonus||k.mixLevelBonusABOnly){const fe=J[T]||t.find(c)||{};let G=0;if(k.perClientBonus&&(G+=(Number(fe.clients)||0)*Number(k.perClientBonus||0)),k.perCertifiedManagerBonus&&(G+=Lx(fe)*Number(k.perCertifiedManagerBonus||0)),k.mixLevelBonusABOnly){const Z=String(fe.mixProdutos||"").toUpperCase();(Z==="A"||Z==="B")&&(G+=Number(k.mixLevelBonusABOnly||0))}G&&e(Z=>{const ue=Z.map((ce,He)=>He===T?{...ce,cash:(Number(ce.cash)||0)+G}:ce);return y(ue,o,re.current),ue})}})()),Ce&&u&&C&&S){M.current=!0;const k=J[T]||{},B=Math.max(0,Math.floor(Ma(k)));(async()=>{await Oe(a.jsx(Jx,{value:B})),e(H=>{const K=H.map((ge,fe)=>fe!==T?ge:{...ge,cash:(ge.cash||0)+B});return y(K,o,re.current),K}),b(`${k.name} recebeu faturamento do ms: +$${B.toLocaleString()}`);try{setTimeout(()=>A==null?void 0:A({action:"AUTO_CLOSE_BELOW"}),0)}catch{}})()}if(et&&u&&C&&S){M.current=!0,console.log("[DEBUG]  DESPESAS OPERACIONAIS - Jogador:",(Ne=J[T])==null?void 0:Ne.name,"Posio atual:",(Dt=J[T])==null?void 0:Dt.pos);const k=J[T]||{},B=Math.max(0,Math.floor(Ba(k))),H=k.loanPending||{},K=Number(H.amount)>0&&!H.charged&&H.shouldChargeOnNextExpenses===!0,ge=K?Math.max(0,Math.floor(Number(H.amount))):0;console.log("[DEBUG]  DESPESAS - Valor:",B,"Emprstimo a cobrar:",ge,"Total:",B+ge),console.log("[DEBUG]  EMPRSTIMO - Detalhes:",{amount:Number(H.amount),charged:H.charged,shouldChargeOnNextExpenses:H.shouldChargeOnNextExpenses,currentRound:n,shouldCharge:K}),(async()=>{var Z,ue,ce;await Oe(a.jsx(Yx,{expense:B,loanCharge:ge}));const fe=B+ge;console.log("[DEBUG]  ANTES handleInsufficientFunds - Saldo atual:",(Z=J[T])==null?void 0:Z.cash,"Total a pagar:",fe,"Posio:",(ue=J[T])==null?void 0:ue.pos);const G=await Wt(fe,"Despesas Operacionais","pagar",J);if(console.log("[DEBUG]  APS handleInsufficientFunds - canPayExpenses:",G,"Posio atual:",(ce=J[T])==null?void 0:ce.pos),!G){console.log("[DEBUG]  canPayExpenses  false - no liberando turno aqui, deixando tick() gerenciar");return}K&&e(He=>{const Je=He.map((Te,_t)=>{var bt;if(_t!==T)return Te;const tt={...Te};return tt.loanPending={...Te.loanPending||{},charged:!0,chargedAtRound:n,shouldChargeOnNextExpenses:!1},tt.pos=((bt=J[T])==null?void 0:bt.pos)??Te.pos,tt});return y(Je,o,re.current),Je}),b(`${k.name} pagou despesas operacionais: -$${B.toLocaleString()}`),ge>0&&b(`${k.name} teve emprstimo cobrado: -$${ge.toLocaleString()}`),e(He=>{var Te,_t,tt;const Je=He.map((bt,Tt)=>{var Vt;return Tt!==T?bt:{...bt,pos:((Vt=J[T])==null?void 0:Vt.pos)??bt.pos}});return console.log("[DEBUG]  DESPESAS FINALIZADAS - Jogador:",(Te=Je[T])==null?void 0:Te.name,"Posio final:",(_t=Je[T])==null?void 0:_t.pos,"Saldo final:",(tt=Je[T])==null?void 0:tt.cash),Je})})()}const Yn=Date.now();let ln=0;const Qn=200,at=()=>{var Z;if(ln++,ln>Qn){console.warn("[DEBUG]  TIMEOUT - excedeu tentativas mximas, forando desbloqueio");const ue=Pe.current;String(ue||"")===String(d)&&(p(!1),te.current=!1,O.current>0&&(console.warn("[DEBUG]  Forando modalLocks para 0 (timeout)"),O.current=0,D(0)),M.current=!1);return}const k=O.current,B=M.current,H=Pe.current,K=String(H||"")===String(d);if(console.log("[DEBUG] tick - tentativa:",ln,"modalLocks:",k,"openingModalRef:",B,"lockOwner:",H,"myUid:",d,"isLockOwner:",K),B){console.log("[DEBUG]  tick - modal est sendo aberta, aguardando..."),setTimeout(at,150);return}const ge=ct.current?Date.now()-ct.current:1/0;if(k===0&&(ge>=200||!ct.current)){const ue=_e.current;if(!!(ue!=null&&ue.endGame||Y.current)&&!br.current){br.current=!0,Y.current=!1;const Te=Array.isArray(we.current)?we.current:(ue==null?void 0:ue.nextPlayers)||[],_t=(Te||[]).filter(bt=>!(bt!=null&&bt.bankrupt));let tt=null;_t.length>0&&(tt=((Z=_t.map(Tt=>({p:Tt,patrimonio:(Number(Tt.cash)||0)+(Number(Tt.bens)||0),cash:Number(Tt.cash)||0})).sort((Tt,Vt)=>{var Rn,Mn;return Vt.patrimonio-Tt.patrimonio||Vt.cash-Tt.cash||String(((Rn=Tt.p)==null?void 0:Rn.name)||"").localeCompare(String(((Mn=Vt.p)==null?void 0:Mn.name)||""))})[0])==null?void 0:Z.p)||null),console.log("[ENDGAME] finalizando: vencedor=%s, round=5",(tt==null?void 0:tt.name)||""),e(Te||[]),g(!0),j(tt),r(5),re.current=5,_e.current=null,te.current=!1,M.current=!1,p(!1),y(Te||[],bn.current,5,!0,tt,{round:5,gameOver:!0,winner:tt});return}const He=t[o],Je=He&&String(He.id)===String(d);if(K||Je&&!H){const Te=_e.current;if(console.log("[DEBUG]  tick - verificando pendingTurnDataRef:",Te?`prximo turno: ${Te.nextTurnIdx}`:"null"),Te){const _t=O.current,tt=M.current,bt=o,Tt=Pe.current,Vt=String(Tt||"")===String(d),Rn=ct.current?Date.now()-ct.current:1/0,Mn=_t===0&&!tt&&(Rn>=200||!ct.current);if(Mn&&bt===o&&Vt){if(console.log("[DEBUG]  Mudando turno - de:",o,"para:",Te.nextTurnIdx,"finalModalLocks:",_t,"finalOpening:",tt,"timeSinceLastModalClosed:",Rn),Te.endGame){const ke=Math.min(5,Number(Te.nextRound||5)),oe=t.filter(me=>!(me!=null&&me.bankrupt));let he=null;oe.length>0&&(he=oe.map(Ee=>({...Ee,patrimonio:(Ee.cash||0)+(Ee.bens||0)})).sort((Ee,Ke)=>Ke.patrimonio-Ee.patrimonio)[0]||null),console.log("[DEBUG]  FIM DE JOGO no tick - Rodada:",ke,"Vencedor:",(he==null?void 0:he.name)||null),j(he),g(!0),b("Fim de jogo! 5 rodadas completas."),r(me=>{const Ee=Math.min(5,Math.max(me,ke));return re.current=Ee,Ee});const pe={};Te.nextRoundFlags&&(pe.roundFlags=Te.nextRoundFlags),pe.round=ke,pe.gameOver=!0,pe.winner=he,y(t,o,ke,!0,he,pe),_e.current=null,p(!1),te.current=!1;return}te.current=!0;const Bn=Te.nextRound,Se=Te.shouldIncrementRound||!1;console.log("[DEBUG]  Broadcast - Rodada a ser transmitida:",Bn,"Rodada atual no estado:",n,"shouldIncrement:",Se),s(Te.nextTurnIdx),r(ke=>{const oe=Math.max(ke,Bn);return oe!==ke&&console.log("[DEBUG]  Rodada atualizada no tick - de:",ke,"para:",oe),re.current=oe,oe});const P={};Te.nextRoundFlags&&(P.roundFlags=Te.nextRoundFlags),Te.shouldIncrementRound&&(P.round=Bn),Te.nextTurnPlayerId&&(P.turnPlayerId=Te.nextTurnPlayerId),y(Te.nextPlayers,Te.nextTurnIdx,Bn,m,w,P),_e.current=null,p(!1),te.current=!1,console.log("[DEBUG]  Turno mudado com sucesso - Rodada:",Bn)}else{console.log("[DEBUG]  tick - condies no atendidas, no mudando turno",{finalModalLocks:_t,finalOpening:tt,finalCanChangeTurn:Mn,timeSinceLastModalClosed:Rn,finalTurnIdx:bt,turnIdx:o,finalIsLockOwner:Vt,isLockOwner:K}),console.log("[DEBUG]  tick - condies no atendidas, no mudando turno",{finalModalLocks:_t,finalOpening:tt,finalTurnIdx:bt,turnIdx:o,finalIsLockOwner:Vt,isLockOwner:K}),setTimeout(at,150);return}}else{console.log("[DEBUG]  tick - turnData  null, no mudando turno. turnIdx atual:",o,"lockOwner:",H,"isLockOwner:",K);const _t=ct.current?Date.now()-ct.current:1/0,tt=k===0&&(_t>=200||!ct.current);if(K&&tt&&!B)if(ln<10){console.log("[DEBUG]  tick - tentando novamente em 200ms (pode ser que pendingTurnDataRef ainda no foi preenchido)"),setTimeout(at,200);return}else console.warn("[DEBUG]  tick - excedeu tentativas de retry, liberando turnLock"),p(!1),te.current=!1;else p(!1),te.current=!1}}else console.log("[DEBUG]  tick - no sou o dono do cadeado e no  minha vez, no mudando turno",{isLockOwner:K,isCurrentPlayerMe:Je,currentLockOwner:H,myUid:d,turnIdx:o}),Je||(p(!1),te.current=!1);return}setTimeout(at,100)};let Ot=0;const un=50,cn=()=>{Ot++;const k=M.current,B=O.current>0;if((k||B)&&Ot<un){console.log("[DEBUG]  checkBeforeTick - modal sendo aberta ou j aberta, aguardando...",{hasOpening:k,hasLocks:B,modalLocks:O.current,attempt:Ot}),setTimeout(cn,200);return}Ot>=un&&(console.warn("[DEBUG]  checkBeforeTick - excedeu tentativas, forando avano do turno",{hasOpening:k,hasLocks:B,modalLocks:O.current}),O.current>0&&(console.warn("[DEBUG]  checkBeforeTick - forando modalLocks para 0"),O.current=0,D(0)),M.current=!1),console.log("[DEBUG]  checkBeforeTick - iniciando tick, sem modais abertas"),at()};setTimeout(cn,500)}catch(T){throw console.error("[DEBUG] Erro em advanceAndMaybeLap:",T),Pe.current===String(d)&&p(!1),T}finally{Pe.current===String(d)?setTimeout(()=>{Pe.current===String(d)&&(p(!1),te.current=!1)},100):te.current=!1}}},[t,n,o,i,u,c,d,f,m,b,y,e,r,s,l,p,dt,qr,C,S,A]),Ua=ye.useCallback(()=>{if(m||!t.length)return;const q=ds(t,o),Me=t[q],Be=Me!=null&&Me.id?String(Me.id):null;s(q),y(t,q,re.current,!1,null,{turnPlayerId:Be})},[y,m,t,n,s,o]),St=ye.useCallback(q=>{var Me,Be,Ne,Dt,T,Le,Ue,Wt,Mt;if(!(!(q!=null&&q.type)||Et.current||Y.current||br.current)){if(q.type==="ROLL"){if(!u){console.warn("[DEBUG]  onAction ROLL - no  minha vez, ignorando");return}if(_){console.warn("[DEBUG]  onAction ROLL - turnLock ativo, ignorando");return}if(O.current>0){console.warn("[DEBUG]  onAction ROLL - h modais abertas, ignorando");return}try{sn(q.steps,q.cashDelta,q.note)}catch(W){console.error("[DEBUG] Erro em advanceAndMaybeLap:",W),Pe.current===String(d)&&p(!1)}return}if(q.type==="RECOVERY"){const W=Math.floor(Math.random()*3e3)+1e3,de=t.find(c);if(!de)return;const De=t.map(ve=>c(ve)?{...ve,cash:ve.cash+W}:ve);b(`${de.name} ativou Recuperao Financeira (+$${W})`),e(De),y(De,o,re.current);return}if(q.type==="RECOVERY_CUSTOM"){const W=Number(q.amount||0),de=t.find(c);if(!de)return;const De=t.map(ve=>c(ve)?{...ve,cash:ve.cash+W}:ve);b(`${de.name} recuperou +$${W}`),e(De),y(De,o,re.current);return}if(q.type==="RECOVERY_MODAL"){if(!u||!C||!S)return;(async()=>{const W=await Oe(a.jsx(Sf,{playerName:(x==null?void 0:x.name)||"Jogador",currentPlayer:x}));if(W){if(W&&W.type==="TRIGGER_BANKRUPTCY"){St({type:"BANKRUPT"});return}switch(W.type){case"FIRE":St==null||St({type:"RECOVERY_FIRE",items:W.items,amount:W.totalCredit??W.amount??0,note:W.note,creditByRole:W.creditByRole});break;case"REDUCE":{const de=Array.isArray(W.items)&&W.items.length>0,De=de?W.items.map((J,Ae)=>({...J,group:String(J.group||J.tipo||"").toUpperCase(),level:String(J.level||J.nivel||"").toUpperCase(),credit:Number(J.credit??J.amount??0),selected:Ae===0?!0:!!J.selected})):void 0,ve=de&&(De==null?void 0:De[0])||W.selection||W.sel||(W.group&&W.level?{group:String(W.group).toUpperCase(),level:String(W.level).toUpperCase(),credit:Number(W.credit??W.amount??0)}:null),Fe=Number((de?W.total??W.totalCredit:void 0)??(ve==null?void 0:ve.credit)??W.amount??0),ze=W.note||(de?`Reduo mltipla +R$ ${Fe.toLocaleString()}`:ve?`Reduo ${ve.group} nvel ${ve.level} +R$ ${Fe.toLocaleString()}`:`Reduo +R$ ${Fe.toLocaleString()}`);St==null||St({type:"RECOVERY_REDUCE",items:De,selection:ve||null,amount:Fe,note:ze});break}case"LOAN":{const de=typeof W.amount=="object"&&W.amount!==null?W.amount:{amount:Number(W.amount??0),cashDelta:Number(W.cashDelta??W.amount??0),loan:W.loan},De=Number(de.amount??0),ve=Number(de.cashDelta??De??0),Fe=de.loan??W.loan??{};St==null||St({type:"RECOVERY_LOAN",amount:De,cashDelta:ve,loan:Fe,note:W.note});break}default:W.amount>0&&(St==null||St({type:"RECOVERY_CUSTOM",amount:W.amount,note:W.note}))}}})();return}if(q.type==="BANKRUPT_MODAL"){if(!u||!C||!S)return;(async()=>await Oe(a.jsx(tb,{playerName:(x==null?void 0:x.name)||"Jogador"}))&&(St==null||St({type:"BANKRUPT"})))();return}if(q.type==="RECOVERY_FIRE"){const W=Number(q.amount||0),de=q.items||{},De={cashDelta:W,vendedoresComunsDelta:-Number(de.comum||0),fieldSalesDelta:-Number(de.field||0),insideSalesDelta:-Number(de.inside||0),gestoresDelta:-Number(de.gestor||0)},ve=o;e(Fe=>{const ze=Fe.map((J,Ae)=>Ae!==ve?J:Pt(J,De));return y(ze,o,re.current),ze}),b(`${((Me=t[ve])==null?void 0:Me.name)||"Jogador"}: ${q.note||"Demisses"}`);return}if(q.type==="RECOVERY_LOAN"){const W=Math.max(0,Number(q.amount||0));if(!W)return;const de=o,De=t[de];if(De!=null&&De.loanPending&&!De.loanPending.charged){b(`${(De==null?void 0:De.name)||"Jogador"} j possui um emprstimo pendente.`);return}e(ve=>{const Fe=ve.map((ze,J)=>J!==de?ze:{...ze,cash:(Number(ze.cash)||0)+W,loanPending:{amount:W,charged:!1,shouldChargeOnNextExpenses:!0}});return y(Fe,o,re.current),Fe}),b(`${(De==null?void 0:De.name)||"Jogador"} pegou emprstimo: +$${W.toLocaleString()}`);return}if(q.type==="BUY_MIX"||q.kind==="MIX_BUY"||q.type==="DIRECT_BUY_MIX"){const W=String(q.level||"").toUpperCase(),de=Math.max(0,Number(q.price??0));if(!["A","B","C","D"].includes(W)){p(!1);return}const De=o;if(!In(De,de)){b("Saldo insuficiente para comprar MIX"),p(!1);return}e(ve=>{const Fe=ve.map((ze,J)=>{if(J!==De)return ze;const Ae={...ze.mixOwned||ze.mix||{},D:!0};return Ae[W]=!0,{...ze,cash:Math.max(0,(Number(ze.cash)||0)-de),mixOwned:Ae,mix:Ae,mixLevel:W,mixProdutos:W}});return y(Fe,o,re.current),Fe}),b(`${((Be=t[De])==null?void 0:Be.name)||"Jogador"} comprou MIX nvel ${W} por -$${de.toLocaleString()}`),p(!1);return}if(q.type==="BUY_ERP"||q.kind==="ERP_BUY"||q.type==="DIRECT_BUY_ERP"){const W=String(q.level||"").toUpperCase(),de=Math.max(0,Number(q.price??0));if(!["A","B","C","D"].includes(W)){p(!1);return}const De=o;if(!In(De,de)){b("Saldo insuficiente para comprar ERP"),p(!1);return}e(ve=>{const Fe=ve.map((ze,J)=>{if(J!==De)return ze;const Ae={...ze.erpOwned||ze.erp||{},D:!0};return Ae[W]=!0,{...ze,cash:Math.max(0,(Number(ze.cash)||0)-de),erpOwned:Ae,erp:Ae,erpLevel:W,erpSystems:{...ze.erpSystems||{},level:W}}});return y(Fe,o,re.current),Fe}),b(`${((Ne=t[De])==null?void 0:Ne.name)||"Jogador"} comprou ERP nvel ${W} por -$${de.toLocaleString()}`),p(!1);return}if(q.type==="RECOVERY_REDUCE"){const W=$=>String($||"").toUpperCase(),de=$=>{const z=String($||"").toUpperCase();return z==="MIX"||z==="ERP"?z:z.includes("MIX")?"MIX":z.includes("ERP")?"ERP":""},ve=(()=>{if(Array.isArray(q.items)&&q.items.length)return q.items.filter(z=>(z==null?void 0:z.selected)??!0).map(z=>({group:de(z.group||z.kind),level:W(z.level),credit:Math.max(0,Number(z.credit??z.amount??0))})).filter(z=>(z.group==="MIX"||z.group==="ERP")&&["A","B","C"].includes(z.level));const $=q.selection||q.target||null;if($){const z={group:de($.group||$.kind),level:W($.level),credit:Math.max(0,Number($.credit??$.amount??q.amount??0))};if((z.group==="MIX"||z.group==="ERP")&&["A","B","C"].includes(z.level))return[z]}return[]})();if(!ve.length){const $=Math.max(0,Number(q.amount??0));if($>0){const z=o;e(V=>{const je=V.map((ae,Ce)=>Ce!==z?ae:{...ae,cash:(Number(ae.cash)||0)+$});return y(je,o,re.current),je})}return}const Fe=($,z)=>{const V={A:!1,B:!1,C:!1,D:!1,...$||{}},je=W(z);return!V.A&&!V.B&&!V.C&&!V.D&&(["A","B","C","D"].includes(je)?V[je]=!0:V.D=!0),V},ze=$=>$!=null&&$.A?"A":$!=null&&$.B?"B":$!=null&&$.C?"C":$!=null&&$.D?"D":"-",J=o,Ae=t[J];if(ve.some($=>$.level==="D")){b("No  possvel reduzir o nvel D (bsico).");return}const I=Array.isArray((Dt=Ae.reducedLevels)==null?void 0:Dt.MIX)?Ae.reducedLevels.MIX:[],se=Array.isArray((T=Ae.reducedLevels)==null?void 0:T.ERP)?Ae.reducedLevels.ERP:[];if(ve.some($=>$.group==="MIX"&&I.includes($.level)||$.group==="ERP"&&se.includes($.level))){b("No  possvel reduzir um nvel que j foi reduzido anteriormente.");return}e($=>{const z=$.map((V,je)=>{var ln,Qn;if(je!==J)return V;let ae={A:!1,B:!1,C:!1,D:!1,...V.mixOwned||V.mix||{}},Ce={A:!1,B:!1,C:!1,D:!1,...V.erpOwned||V.erp||{}};ae=Fe(ae,V.mixProdutos),Ce=Fe(Ce,V.erpSistemas);const et=[...Array.isArray((ln=V.reducedLevels)==null?void 0:ln.MIX)?V.reducedLevels.MIX:[]],gt=[...Array.isArray((Qn=V.reducedLevels)==null?void 0:Qn.ERP)?V.reducedLevels.ERP:[]];let it=0,be=String(V.mixProdutos||"D").toUpperCase(),Bt=String(V.erpLevel||V.erpSistemas||"D").toUpperCase();for(const at of ve)if(it+=Math.max(0,Number(at.credit||0)),at.group==="MIX"){if(at.level===be){const Ot=["A","B","C","D"],un=Ot.indexOf(be);for(let cn=un+1;cn<Ot.length;cn++){const k=Ot[cn];if(ae[k]||k==="D"){be=k;break}}}delete ae[at.level],ae[at.level]=!1,et.includes(at.level)||et.push(at.level)}else if(at.group==="ERP"){if(at.level===Bt){const Ot=["A","B","C","D"],un=Ot.indexOf(Bt);for(let cn=un+1;cn<Ot.length;cn++){const k=Ot[cn];if(Ce[k]||k==="D"){Bt=k;break}}}delete Ce[at.level],Ce[at.level]=!1,gt.includes(at.level)||gt.push(at.level)}ae.A||ae.B||ae.C||(ae.D=!0,ae.A=!1,ae.B=!1,ae.C=!1),Ce.A||Ce.B||Ce.C||(Ce.D=!0,Ce.A=!1,Ce.B=!1,Ce.C=!1);const Q=ze(ae),X=ze(Ce),xt=Q!=="-"?Q:be||"D",At=X!=="-"?X:Bt||"D",Cn={...ae},Yn={...Ce};return{...V,cash:(Number(V.cash)||0)+it,mixOwned:Cn,erpOwned:Yn,mix:Cn,erp:Yn,mixProdutos:xt,erpLevel:At,erpSistemas:At,reducedLevels:{MIX:et,ERP:gt}}});return y(z,o,re.current),z});const L=ve.reduce(($,z)=>$+Math.max(0,Number(z.credit||0)),0);if(ve.length===1){const $=ve[0];b(`${(Ae==null?void 0:Ae.name)||"Jogador"} reduziu ${$.group} nvel ${$.level} e recebeu +$${L.toLocaleString()}`)}else b(`${(Ae==null?void 0:Ae.name)||"Jogador"} reduziu ${ve.length} nveis e recebeu +$${L.toLocaleString()}`);return}if(q.type==="BANKRUPT"){const W=o;try{String((Le=t[W])==null?void 0:Le.id)===String(d)&&(R==null||R(!0))}catch{}const de=t.map((Fe,ze)=>ze===W?{...Fe,bankrupt:!0}:Fe);if(b(`${((Ue=t[W])==null?void 0:Ue.name)||"Jogador"} declarou FALNCIA.`),Ds(de)<=1){const Fe=de.findIndex(ze=>!(ze!=null&&ze.bankrupt));j(Fe>=0?de[Fe]:null),e(de),g(!0),p(!1),y(de,o,n,!0,Fe>=0?de[Fe]:null);return}const ve=ds(de,W);e(de),s(ve),p(!1),y(de,ve,re.current),console.log("[DEBUG]  advanceAndMaybeLap finalizada (falncia) - posio final:",(Wt=de[ve])==null?void 0:Wt.pos);return}console.log("[DEBUG]  advanceAndMaybeLap finalizada normalmente - posio final:",(Mt=nextPlayers[curIdx])==null?void 0:Mt.pos)}},[t,n,o,u,c,d,f,m,b,y,e,r,s,p,g,j,dt,C,S,A,R]);return ye.useEffect(()=>{if(v===0&&_&&!M.current){const q=Pe.current;String(q||"")===String(d)?(console.log("[DEBUG]  Destravando turnLock - modalLocks: 0, sou o lockOwner"),p(!1),te.current=!1):u||(console.log("[DEBUG]  Destravando turnLock - no  minha vez e no sou lockOwner"),p(!1),te.current=!1)}},[v,_,le,d,u,p]),ye.useEffect(()=>{if(u&&v===0&&_&&!M.current){const q=Pe.current;String(q||"")===String(d)?(console.log("[DEBUG]  Destravando turnLock -  minha vez e sou o lockOwner"),p(!1),te.current=!1):q||(console.log("[DEBUG]  Destravando turnLock -  minha vez mas no h lockOwner"),p(!1),te.current=!1)}},[u,v,_,le,d,p]),ye.useEffect(()=>()=>{ne.current&&(clearTimeout(ne.current),ne.current=null),te.current=!1,M.current=!1},[]),{advanceAndMaybeLap:sn,onAction:St,nextTurn:Ua,modalLocks:v,lockOwner:le}}const cm=E.createContext(null),rb=()=>{try{return E.useContext(cm)}catch{return null}};function ob({roomCode:t,hostId:e,children:n}){const r=!!Ve&&!!t,o=String(t||"").trim(),[s,i]=E.useState(!1),[l,u]=E.useState({}),[c,d]=E.useState(0),h=E.useRef(l),f=E.useRef(c),x=E.useRef(0),y=E.useRef(null),b=E.useRef(null);E.useEffect(()=>{h.current=l},[l]),E.useEffect(()=>{f.current=c},[c]);const _=async g=>{const{data:w,error:j}=await Ve.from("rooms").select("id, code, host_id, state, version, updated_at").eq("code",g).order("updated_at",{ascending:!1}).limit(1).maybeSingle();return j?(console.warn("[NET] getLatestRoomByCode error:",j.message||j),null):w};E.useEffect(()=>{if(!r)return;let g=!1;return(async()=>{let w=await _(o);if(!w){const j={code:o,state:{},version:0,host_id:e||null},{data:R,error:C}=await Ve.from("rooms").insert(j).select("id, code, host_id, state, version, updated_at").maybeSingle();if(C){console.warn("[NET] rooms/create:",C.message||C);return}if(g)return;R?w=R:w=await _(o)}g||(w&&(y.current=w.id,b.current=w.updated_at,u(w.state||{}),d(w.version??0)),i(!0))})(),()=>{g=!0}},[r,o,e]),E.useEffect(()=>{if(!r)return;const g=Ve.channel(`rooms:${o}`).on("postgres_changes",{event:"*",schema:"public",table:"rooms",filter:`code=eq.${o}`},w=>{const j=w.new||w.old||{};typeof j.version=="number"&&j.version>f.current&&(d(j.version),j.state&&u(j.state),j.updated_at&&(b.current=j.updated_at),j.id&&(y.current=j.id),x.current=Date.now(),console.log("[NET]  applied remote v=%d (realtime)",j.version))}).subscribe();return()=>{try{Ve.removeChannel(g)}catch{}}},[r,o]),E.useEffect(()=>{if(!r)return;const g=setInterval(async()=>{if(Date.now()-(x.current||0)<2e3)return;const w=await _(o);w&&w.version>f.current&&(d(w.version),u(w.state||{}),w.updated_at&&(b.current=w.updated_at),w.id&&(y.current=w.id))},700);return()=>clearInterval(g)},[r,o]);const p=async g=>{var C,S;if(!r||!s)return;const w=3,j=new Date().toISOString();for(let A=1;A<=w;A++){let v=await _(o);if(!v){const rt={code:o,state:{},version:0,host_id:e||null},{data:F,error:le}=await Ve.from("rooms").insert(rt).select("id, code, host_id, state, version, updated_at").maybeSingle();if(le){if(console.warn(`[NET] commit - insert failed (attempt ${A}/${w}):`,le.message||le),A<w){await new Promise(ie=>setTimeout(ie,50*A));continue}return}if(F)v=F,y.current=v.id,b.current=v.updated_at;else if(v=await _(o),!v){if(console.warn(`[NET] commit - no row after insert (attempt ${A}/${w})`),A<w){await new Promise(ie=>setTimeout(ie,50*A));continue}return}}v.id&&(y.current=v.id);let D=v.state||{},O=typeof g=="function"?g(D)||{}:g||{};const M=y.current||v.id;if(!M){if(console.warn("[NET] commit - no target ID available"),A<w){await new Promise(rt=>setTimeout(rt,50*A));continue}return}const{data:te,error:ne}=await Ve.from("rooms").update({state:O,version:(v.version||0)+1,updated_at:j}).eq("id",M).eq("version",v.version).select("state, version, updated_at").maybeSingle();if(!ne&&te){u(te.state||{}),d(te.version??(v.version||0)+1),te.updated_at&&(b.current=te.updated_at),A>1&&console.log(`[NET] commit succeeded on attempt ${A}/${w}`);return}if(((ne==null?void 0:ne.code)==="PGRST116"||((C=ne==null?void 0:ne.message)==null?void 0:C.includes("0 rows"))||((S=ne==null?void 0:ne.message)==null?void 0:S.includes("Cannot coerce"))||(ne==null?void 0:ne.code)==="23505"||(ne==null?void 0:ne.message)&&ne.message.includes("version")||!te)&&A<w){console.warn(`[NET] commit conflict (attempt ${A}/${w}):`,(ne==null?void 0:ne.message)||ne||"no rows updated","- retrying with fresh state...");const rt=await _(o);rt&&(v=rt,y.current=rt.id,b.current=rt.updated_at,D=rt.state||{},O=typeof g=="function"?g(D)||{}:g||{}),await new Promise(F=>setTimeout(F,50*A));continue}console.warn(`[NET] commit conflict (attempt ${A}/${w}):`,(ne==null?void 0:ne.message)||ne||"no rows updated")}const R=await _(o);R?(u(R.state||{}),d(R.version??0),R.updated_at&&(b.current=R.updated_at),R.id&&(y.current=R.id),console.warn("[NET] commit failed after retries, resynced to latest state")):console.warn("[NET] commit fallback resync failed: no row found")},m=E.useMemo(()=>({enabled:r,ready:s,state:l,version:c,commit:p}),[r,s,l,c]);return a.jsx(cm.Provider,{value:m,children:n})}function sb(){var Fe,ze,J,Ae;const[t,e]=E.useState("start"),[n,r]=E.useState(null),o=E.useMemo(()=>Js(),[]),s=E.useMemo(()=>co(""),[]),[i,l]=E.useState(o);E.useMemo(()=>Object.freeze({mixProdutos:"D",erpLevel:"D",clients:1,vendedoresComuns:1}),[]);const u=(N={})=>({...N,mixProdutos:N.mixProdutos??"D",erpLevel:N.erpLevel??"D",clients:N.clients??1,vendedoresComuns:N.vendedoresComuns??1}),c=N=>{if(!Array.isArray(N)||N.length===0)return N;const I=[...N].filter(Boolean);let xe=I.every(z=>Number.isInteger(z.seat))?I.sort((z,V)=>z.seat-V.seat):I.sort((z,V)=>String((z==null?void 0:z.id)??(z==null?void 0:z.player_id)??"").localeCompare(String((V==null?void 0:V.id)??(V==null?void 0:V.player_id)??""))),L=0;const $=new Set(xe.filter(z=>Number.isInteger(z.seat)).map(z=>z.seat));return xe=xe.map(z=>{if(Number.isInteger(z.seat))return z;for(;$.has(L);)L++;return $.add(L),{...z,seat:L++}}),xe=xe.sort((z,V)=>z.seat-V.seat),console.log("[App] normalizePlayers - ordenados:",xe.map(z=>({id:z.id,name:z.name,seat:z.seat}))),xe},[d,h]=E.useState([u({id:o,name:s||"Jogador",cash:18e3,pos:0,color:"#ffd54f",bens:4e3})]),[f,x]=E.useState(1),[y,b]=E.useState(0),[_,p]=E.useState(null),[m,g]=E.useState(new Array(1).fill(!1)),[w,j]=E.useState(!1),[R,C]=E.useState(null),[S,A]=E.useState({id:o,name:((Fe=d[0])==null?void 0:Fe.name)||"Jogador",color:((ze=d[0])==null?void 0:ze.color)||"#6c5ce7",cash:((J=d[0])==null?void 0:J.cash)??18e3,possibAt:0,clientsAt:0,matchId:"local"}),[v,D]=E.useState(["Bem-vindo ao Sales Game!"]),O=N=>D(I=>[N,...I].slice(0,12)),[M,te]=E.useState(!1),[ne,ct]=E.useState(null),rt=E.useRef(null),F=E.useRef(null),le=E.useRef(0),ie=ye.useCallback(N=>!!N&&String(N.id)===String(i),[i]),Pe=E.useMemo(()=>{var N;return((N=d.find(ie))==null?void 0:N.cash)??0},[d,ie]);E.useEffect(()=>{var N;try{const I=new URL(window.location.href),se=I.searchParams.get("room"),xe=localStorage.getItem("sg:lastRoomName"),L=se||xe;if(xe&&!se&&localStorage.removeItem("sg:lastRoomName"),L&&se){r(L),(N=window.__setRoomCode)==null||N.call(window,L);try{I.searchParams.set("room",String(L)),history.replaceState(null,"",I.toString())}catch{}e("playersLobby")}else s&&s.trim()!==""&&e("lobbies")}catch{}},[s]);const _e=E.useMemo(()=>`sg-sync:${n||"local"}`,[n]);E.useEffect(()=>{var N,I;try{(I=(N=rt.current)==null?void 0:N.close)==null||I.call(N);const se=new BroadcastChannel(_e);return se.onmessage=xe=>{var $,z,V,je,ae,Ce;const L=xe.data||{};if(String(L.source)!==String(o)){if(L.type==="START"){const et=Array.isArray(L.players)?L.players.map(u):[];if(!et.length)return;const gt=c(et);try{const be=window.__MY_UID||window.__myUid||window.__playerId||null;be&&l(String(be))}catch{}h(gt),b(0);const it=($=gt[0])!=null&&$.id?String(gt[0].id):null;p(it),x(1),g(new Array(Math.max(1,gt.length)).fill(!1)),j(!1),C(null),e("game"),D(["Jogo iniciado!"]);return}if(L.type==="TURNLOCK"){te(!!L.value);return}if(L.type==="SYNC"&&t==="game"){if(we!=null&&we.enabled&&(we!=null&&we.ready)&&Y){console.log("[App] SYNC ignorado - netState ativo, usando Supabase como autoridade nica");return}const et=Number(L.version||0),gt=Number(L.timestamp||0),it=dt.current;if(console.log("[App] SYNC recebido - verso remota:",et,"verso local:",it,"turnIdx:",L.turnIdx,"round:",L.round,"source:",L.source),console.log("[App] SYNC - meu turnIdx atual:",y,"meu myUid:",i),et>0&&it>0&&et<it){console.log("[App] SYNC -  REJEITANDO estado remoto - verso antiga:",et,"< verso local:",it);return}const be=Date.now(),Bt=Oe.current;if(et>it&&(dt.current=et,console.log("[App] SYNC -  Aceitando verso remota:",et,"> verso local:",it)),L.turnIdx!==y&&(!(we!=null&&we.enabled)||!(we!=null&&we.ready)))if(L.turnPlayerId!==void 0&&L.turnPlayerId!==null){p(L.turnPlayerId);const X=c(L.players||d).findIndex(xt=>String(xt.id)===String(L.turnPlayerId));X>=0&&(b(X),console.log("[App] SYNC (BC) - turnIdx derivado de turnPlayerId:",X,"turnPlayerId:",L.turnPlayerId))}else L.turnIdx>=0&&L.turnIdx<(((z=L.players)==null?void 0:z.length)||d.length)&&(b(L.turnIdx),console.log("[App] SYNC (BC) - Sincronizando turnIdx",{local:y,remote:L.turnIdx}));if(Array.isArray(L.roundFlags)&&L.roundFlags.length>0&&g(Q=>{const X=L.roundFlags.map((xt,At)=>Q[At]||!1||xt);for(;X.length<Q.length;)X.push(Q[X.length]||!1);return console.log("[App] SYNC - roundFlags sincronizado:",X.map((xt,At)=>{var Cn;return`${(Cn=d[At])==null?void 0:Cn.name}:${xt}`}).join(", ")),X}),L.round!==f)if(Bt&&be-Bt.timestamp<3e3){const Q=Bt.round!==f;x(Q?X=>{const xt=Math.max(X,L.round);return xt>X&&console.log("[App] SYNC - Rodada incrementada via sincronizao:",X,"->",xt),xt}:L.round)}else x(Q=>Math.max(Q,L.round));const an=d,Jt=L.players.map(Q=>{const X=an.find(At=>At.id===Q.id);if(!X)return Q;if(String(Q.id)===String(i)){const At=Number(X.clients||0),Cn=Number(Q.clients||0),Yn=Number(X.vendedoresComuns||0),ln=Number(Q.vendedoresComuns||0),Qn=Number(X.fieldSales||0),at=Number(Q.fieldSales||0),Ot=Number(X.insideSales||0),un=Number(Q.insideSales||0);return At>Cn||Yn>ln||Qn>at||Ot>un||X.mixProdutos&&X.mixProdutos!==Q.mixProdutos&&X.mixProdutos!=="D"||X.erpLevel&&X.erpLevel!==Q.erpLevel&&X.erpLevel!=="D"?(console.log("[App] SYNC - Detectadas compras locais, preservando estado local completo",{localClients:At,remoteClients:Cn,localVendedores:Yn,remoteVendedores:ln}),{...X,pos:Q.pos,bankrupt:Q.bankrupt??X.bankrupt,az:X.az||Q.az||0,am:X.am||Q.am||0,rox:X.rox||Q.rox||0,trainingsByVendor:X.trainingsByVendor||Q.trainingsByVendor||{},onboarding:X.onboarding||Q.onboarding||!1}):{...Q,cash:Math.max(Number(X.cash||0),Number(Q.cash||0)),clients:Math.max(At,Cn),mixProdutos:X.mixProdutos??Q.mixProdutos,erpLevel:X.erpLevel??Q.erpLevel,vendedoresComuns:Math.max(Yn,ln),fieldSales:Math.max(Qn,at),insideSales:Math.max(Ot,un),gestores:Math.max(Number(X.gestores??X.gestoresComerciais??X.managers??0),Number(Q.gestores??Q.gestoresComerciais??Q.managers??0)),gestoresComerciais:Math.max(Number(X.gestoresComerciais??X.gestores??X.managers??0),Number(Q.gestoresComerciais??Q.gestores??Q.managers??0)),managers:Math.max(Number(X.managers??X.gestores??X.gestoresComerciais??0),Number(Q.managers??Q.gestores??Q.gestoresComerciais??0)),bens:Math.max(Number(X.bens||0),Number(Q.bens||0)),manutencao:X.manutencao??Q.manutencao,loanPending:X.loanPending??Q.loanPending,az:X.az||Q.az||0,am:X.am||Q.am||0,rox:X.rox||Q.rox||0,trainingsByVendor:X.trainingsByVendor||Q.trainingsByVendor||{},onboarding:X.onboarding||Q.onboarding||!1}}return{...Q,az:X.az||Q.az||0,am:X.am||Q.am||0,rox:X.rox||Q.rox||0,trainingsByVendor:X.trainingsByVendor||Q.trainingsByVendor||{},onboarding:X.onboarding||Q.onboarding||!1}});h(Jt),console.log("[App] SYNC aplicado - novo turnIdx:",L.turnIdx),console.log("[App] SYNC - jogador da vez:",(V=Jt[L.turnIdx])==null?void 0:V.name,"id:",(je=Jt[L.turnIdx])==null?void 0:je.id),console.log("[App] SYNC -  minha vez?",String((ae=Jt[L.turnIdx])==null?void 0:ae.id)===String(i)),j(Q=>Q||!!L.gameOver),C(Q=>(w||L.gameOver)&&Q&&!L.winner?Q:L.winner??Q),L.gameOver===!0&&console.log(`[App] [ENDGAME] estado remoto aplicado: gameOver=true winner=${((Ce=L.winner)==null?void 0:Ce.name)??L.winner??"N/A"}`)}}},rt.current=se,()=>se.close()}catch(se){console.warn("[App] BroadcastChannel init failed:",se)}},[_e,o,t]),E.useEffect(()=>{const N=async()=>{if(console.log(`[App] handleLeaveRoom chamado - fase: ${t}, currentLobbyId: ${n}, myUid: ${i}`),(t==="lobbies"||t==="playersLobby"||t==="game")&&n&&i)try{console.log(`[App] Saindo da sala ${n} na fase ${t}`),await wl({roomCode:n,playerId:i})}catch(xe){console.warn("[App] Erro ao sair da sala:",xe)}else console.log("[App] No executando leaveRoom - condies no atendidas")},I=()=>{N()},se=()=>{N()};return window.addEventListener("beforeunload",I),window.addEventListener("pagehide",se),()=>{window.removeEventListener("beforeunload",I),window.removeEventListener("pagehide",se)}},[t,n,i]);const re=N=>{var se,xe;const I=!!N;te(I);try{(xe=(se=rt.current)==null?void 0:se.postMessage)==null||xe.call(se,{type:"TURNLOCK",value:I,source:o})}catch{}},we=rb(),bn=we==null?void 0:we.commit,Et=we==null?void 0:we.version,Y=we==null?void 0:we.state,br=E.useMemo(()=>{if(y<0||y>=d.length)return console.warn("[App] isMyTurn - turnIdx invlido:",y,"players.length:",d.length),!1;const N=d[y];if(!N)return console.log("[App] isMyTurn - owner no encontrado, turnIdx:",y,"players.length:",d.length),!1;if(N.bankrupt)return console.log("[App] isMyTurn - owner est falido:",N.name),!1;const I=N.id!=null&&String(N.id)===String(i);return console.log("[App] isMyTurn - owner:",N.name,"id:",N.id,"myUid:",i,"isMine:",I),I},[y,d,i]);ye.useRef(null);const Oe=ye.useRef(null),In=ye.useRef(0),dt=ye.useRef(0),qr=ye.useRef(0),sn=ye.useRef(null),Ua=ye.useCallback(({playersDeltaById:N={},statePatch:I={}})=>{if(typeof bn!="function")return;In.current=In.current+1;const se=In.current,xe=Date.now();try{bn(L=>{const $=L||{},z=c($.players||[]),V=new Map(z.map(et=>[String(et.id),et]));for(const[et,gt]of Object.entries(N)){const it=String(et),be=V.get(it);be?V.set(it,u({...be,...gt})):V.set(it,u({id:it,...gt}))}const je=c(Array.from(V.values())),ae={...I,stateVersion:se,updatedAt:xe,updatedBy:i};Object.keys(N).length>0&&(ae.players=je);const Ce={...$,...ae};return Ce.players&&(Ce.players=c(Ce.players)),console.log("[NET]  commitGamePatch - tipo:",I.turnPlayerId?"TURN":I.round?"ROUND":"PLAYER_DELTA","playersDeltaIds:",Object.keys(N).join(","),"statePatchKeys:",Object.keys(I).join(","),"netVersion ser incrementado pelo commit"),Ce})}catch(L){console.warn("[NET] commitGamePatch failed:",(L==null?void 0:L.message)||L)}},[bn,i]);ye.useEffect(()=>{const N=Oe.current,I=!N||N.turnIdx!==y,se=!N||N.round!==f,xe=!N||JSON.stringify(N.players)!==JSON.stringify(d);if(I||se||xe){const L=Date.now();(N?L-N.timestamp:1/0)>100?(Oe.current={players:d,turnIdx:y,round:f,timestamp:L},I&&console.log("[App] lastLocalStateRef atualizado via useEffect - turnIdx mudou:",N==null?void 0:N.turnIdx,"->",y)):Oe.current={...Oe.current,players:d,turnIdx:y,round:f}}},[d,y,f]),E.useEffect(()=>{var xe;if(!(we!=null&&we.enabled)||!(we!=null&&we.ready)||!Y)return;if(typeof Et=="number"){if(Et<=qr.current){console.log("[NET]  IGNORADO - netVersion no avanou:",{netVersion:Et,lastApplied:qr.current});return}qr.current=Et}else return;const N=Array.isArray(Y.players)?Y.players:null,I=Number.isInteger(Y.turnIdx)?Y.turnIdx:null,se=Number.isInteger(Y.round)?Y.round:null;if(Y.turnPlayerId!==void 0&&Y.turnPlayerId!==null){p(Y.turnPlayerId);const $=c(N||d).findIndex(z=>String(z.id)===String(Y.turnPlayerId));$>=0?$!==y&&(console.log("[NET]  turnIdx derivado de turnPlayerId:",$,"turnPlayerId:",Y.turnPlayerId),b($)):console.warn("[NET]  turnPlayerId no encontrado em players:",Y.turnPlayerId)}else I!==null&&b(I);if(N){const L=c(N);h(L),sn.current=JSON.parse(JSON.stringify(L)),console.log("[NET]  Aplicado players (snapshot autoritativo) - netVersion:",Et,"playersOrdered:",L.map($=>({id:$.id,seat:$.seat})))}if(se!==null){const L=se===1&&(I===0||I===null)&&Array.isArray(N)&&N.length>0&&N.every($=>Number(($==null?void 0:$.pos)??0)===0)&&(Y.gameOver===!1||Y.gameOver==null);x($=>L?1:Math.max($,se))}if(Y.roundFlags!==void 0){if(Array.isArray(Y.roundFlags))g(Y.roundFlags),console.log("[NET] applied remote includes roundFlags?",!0,"length:",Y.roundFlags.length);else if(typeof Y.roundFlags=="object"){const L=Object.values(Y.roundFlags);g(L),console.log("[NET] applied remote includes roundFlags?",!0,"converted from object, length:",L.length)}}if(typeof Y.turnLock=="boolean"&&(te(Y.turnLock),Y.turnLock&&!F.current?F.current=Date.now():Y.turnLock||(F.current=null),Y.turnLock&&Y.lockOwner&&console.log("[LOCK] bloqueado: turnLockBroadcast=true lockOwner=",Y.lockOwner,"myId=",i)),Y.lockOwner!==void 0&&(ct(Y.lockOwner),Oe.current&&(Oe.current.lockOwner=Y.lockOwner),console.log("[NET] applied remote includes lockOwner?",!0,"value:",Y.lockOwner)),Y.roundFlags!==void 0){if(Array.isArray(Y.roundFlags))g(Y.roundFlags),console.log("[NET] applied remote includes roundFlags?",!0,"length:",Y.roundFlags.length);else if(typeof Y.roundFlags=="object"){const L=Object.values(Y.roundFlags);g(L),console.log("[NET] applied remote includes roundFlags?",!0,"converted from object, length:",L.length)}}if(typeof Y.turnLock=="boolean"&&(te(Y.turnLock),Y.turnLock&&!F.current?F.current=Date.now():Y.turnLock||(F.current=null),Y.turnLock&&Y.lockOwner&&console.log("[LOCK] bloqueado: turnLockBroadcast=true lockOwner=",Y.lockOwner,"myId=",i)),Y.lockOwner!==void 0&&(ct(Y.lockOwner),Oe.current&&(Oe.current.lockOwner=Y.lockOwner),console.log("[NET] applied remote includes lockOwner?",!0,"value:",Y.lockOwner)),le.current=Date.now(),se!==null){const L=se===1&&(I===0||I===null)&&Array.isArray(N)&&N.length>0&&N.every($=>Number(($==null?void 0:$.pos)??0)===0)&&(Y.gameOver===!1||Y.gameOver==null);x($=>L?1:Math.max($,se))}j(L=>L||!!Y.gameOver),C(L=>(w||Y.gameOver)&&L&&!Y.winner?L:Y.winner??L),Y.gameOver===!0&&console.log(`[App] [ENDGAME] estado remoto aplicado: gameOver=true winner=${((xe=Y.winner)==null?void 0:xe.name)??Y.winner??"N/A"}`),console.log("[NET]  applied remote snapshot - netVersion:",Et,"turnPlayerId:",Y.turnPlayerId,"turnIdx:",I,"round:",se)},[Et,Y,we==null?void 0:we.enabled,we==null?void 0:we.ready]),E.useEffect(()=>{if(!M){F.current=null;return}F.current||(F.current=Date.now());const N=setInterval(()=>{const I=Date.now(),se=F.current?I-F.current:0,xe=d[y],L=xe&&String(xe.id)===String(i),$=br&&L,z=ne===i;se>8e3&&$&&!z&&ne!=null&&(console.warn("[LOCK-WATCHDOG] stole lock - turnLock travado por",se,"ms, liberando...",{isMyTurn:$,lockOwner:ne,myUid:i}),St({turnLock:!1,lockOwner:i}),re(!1),ct(i),F.current=null)},1e3);return()=>clearInterval(N)},[M,br,y,d,ne,i,bn]);async function St(N){if(typeof bn=="function")try{await bn(I=>{const se=I||{},xe=N||{};if(xe.players&&Array.isArray(xe.players)){const L=sn.current||se.players||[],$=se.players||[],z=xe.players,V=new Map(L.map(be=>[String(be==null?void 0:be.id),be])),je=new Map($.map(be=>[String(be==null?void 0:be.id),be])),ae=new Map(z.map(be=>[String(be==null?void 0:be.id),be])),Ce=[],et=new Set([...V.keys(),...je.keys(),...ae.keys()]);for(const be of et){const Bt=V.get(be),an=je.get(be),Jt=ae.get(be);Bt&&Jt&&JSON.stringify(Bt)!==JSON.stringify(Jt)&&Jt?Ce.push(u(Jt)):an?Ce.push(u(an)):Jt&&Ce.push(u(Jt))}const gt=[],it=z.map(be=>String(be==null?void 0:be.id));for(const be of it){const Bt=Ce.find(an=>String(an==null?void 0:an.id)===be);Bt&&gt.push(Bt)}for(const be of Ce)it.includes(String(be==null?void 0:be.id))||gt.push(be);return sn.current=null,{...se,...xe,players:gt.length>0?gt:z}}return{...se,...xe}})}catch(I){console.warn("[NET] commit failed:",(I==null?void 0:I.message)||I),sn.current=null}}function q(N,I,se,xe=w,L=R,$={}){var Yn,ln,Qn,at,Ot,un,cn;sn.current||(sn.current=JSON.parse(JSON.stringify(d)),console.log("[App] broadcastState - baseline capturado (estado atual antes da mudana):",sn.current.length,"players")),In.current=In.current+1;const z=In.current,V=$.roundFlags!==void 0?$.roundFlags:m,je=$.turnLock!==void 0?$.turnLock:M,ae=((Yn=Oe.current)==null?void 0:Yn.lockOwner)??null,Ce=$.lockOwner!==void 0?$.lockOwner:ae,et=$.gameOver!==void 0?$.gameOver:xe,it=!!w||!!((ln=Oe.current)!=null&&ln.gameOver)?!0:!!et,be=$.winner!==void 0?$.winner:L,Bt=R??((Qn=Oe.current)==null?void 0:Qn.winner)??null,an=it?be??Bt:be,Jt=$.round!==void 0?$.round:se,Q=Math.max(Number(Jt||1),Number(f||1),Number(((at=Oe.current)==null?void 0:at.round)||1));sn.current||(sn.current=JSON.parse(JSON.stringify(d)),console.log("[App] broadcastState - baseline capturado (fallback):",sn.current.length,"players"));const X=c(N),xt=$.turnPlayerId!==void 0?$.turnPlayerId:(Ot=X[I])!=null&&Ot.id?String(X[I].id):_,At=Date.now();if(Oe.current={players:X,turnIdx:I,turnPlayerId:xt,round:Q,gameOver:it,winner:an,lockOwner:Ce,timestamp:At,version:z,stateVersion:z,updatedAt:At,updatedBy:i},dt.current=z,$.isStartGame===!0||Q===1&&I===0&&X.every(k=>Number((k==null?void 0:k.pos)??0)===0))console.log("[App] broadcastState (START) - verso:",z,"turnPlayerId:",xt,"round:",Q),St({players:X,turnIdx:I,turnPlayerId:xt,round:Q,roundFlags:V,stateVersion:z,updatedAt:At,updatedBy:i});else{const k={},B=new Map(d.map(H=>[String(H.id),H]));for(const H of X){const K=String(H.id),ge=B.get(K);if(!ge)k[K]=H;else{const fe={},G=["pos","cash","bankrupt","clients","vendedoresComuns","fieldSales","insideSales","gestores","gestoresComerciais","manutencao","bens","mixProdutos","erpLevel","az","am","rox","onboarding","trainingByVendor","trainingsByVendor","loanPending","waitingAtRevenue","revenue","erpOwned","erp"];for(const Z of G)JSON.stringify(ge[Z])!==JSON.stringify(H[Z])&&(fe[Z]=H[Z]);Object.keys(fe).length>0&&(k[K]=fe)}}Ua({playersDeltaById:k,statePatch:{turnPlayerId:xt,turnIdx:I,round:Q,roundFlags:V,turnLock:je,lockOwner:Ce,gameOver:it,winner:an}}),console.log("[App] broadcastState (PATCH) - tipo:",xt&&xt!==_?"TURN":"PLAYER_DELTA","playersDeltaIds:",Object.keys(k).join(","),"turnPlayerId:",xt,"round:",Q)}try{(cn=(un=rt.current)==null?void 0:un.postMessage)==null||cn.call(un,{type:"SYNC",version:z,players:X,turnIdx:I,round:Q,roundFlags:V,turnLock:je,lockOwner:Ce,gameOver:it,winner:an,source:o,timestamp:At})}catch(k){console.warn("[App] broadcastState failed:",k)}}function Me(N){var xe,L,$;const I=c(N),se=(xe=I[0])!=null&&xe.id?String(I[0].id):null;q(I,0,1,!1,null,{turnPlayerId:se,roundFlags:Array(N.length).fill(!1),isStartGame:!0});try{($=(L=rt.current)==null?void 0:L.postMessage)==null||$.call(L,{type:"START",players:N,source:o})}catch(z){console.warn("[App] broadcastStart failed:",z)}}const Be=d[y];E.useEffect(()=>{t==="game"&&Wx(d,y,f,w,R,"Game State Update")},[d,y,f,w,R,t]),E.useEffect(()=>{const N=d.find(ie);if(!N)return;const{cap:I,inAtt:se}=ma(N);A(xe=>({...xe,cash:N.cash,possibAt:I,clientsAt:se,name:N.name,color:N.color}))},[d,ie]);const Ne=E.useMemo(()=>{const N=d.find(ie)||d[0]||{},I=Ma(N),se=Ba(N),{cap:xe,inAtt:L}=ma(N),$=String(N.erpLevel||"D").toUpperCase(),z=Number(N.gestores??N.gestoresComerciais??N.managers??0);return console.log("[App] Totals recalculado - me:",N.name,"clients:",N.clients,"faturamento:",I,"manutencao:",se,"vendedoresComuns:",N.vendedoresComuns,"fieldSales:",N.fieldSales,"insideSales:",N.insideSales),Vx(N,"HUD Totals"),{faturamento:I,manutencao:se,emprestimos:N.loanPending&&!N.loanPending.charged?Number(N.loanPending.amount||0):0,vendedoresComuns:N.vendedoresComuns||0,fieldSales:N.fieldSales||0,insideSales:N.insideSales||0,mixProdutos:N.mixProdutos||"D",bens:N.bens??0,erpSistemas:$,clientes:N.clients||0,onboarding:!!N.onboarding,az:N.az||0,am:N.am||0,rox:N.rox||0,gestores:z,gestoresComerciais:z,possibAt:xe,clientsAt:L}},[d,ie]),[Dt,T]=E.useState(!1),{onAction:Le,modalLocks:Ue}=nb({players:d,setPlayers:h,round:f,setRound:x,turnIdx:y,setTurnIdx:b,roundFlags:m,setRoundFlags:g,isMyTurn:br,isMine:ie,myUid:i,meId:o,myCash:Pe,current:Be,broadcastState:q,appendLog:O,turnLock:M,setTurnLockBroadcast:re,gameOver:w,setGameOver:j,winner:R,setWinner:C,setShowBankruptOverlay:T});if(t==="start")return a.jsx(ux,{onEnter:N=>{const I=co(N||"Jogador");h([u({id:o,name:I,cash:18e3,pos:0,color:"#ffd54f",bens:4e3})]),x(1),b(0),j(!1),C(null),g(new Array(1).fill(!1)),e("lobbies"),A(se=>({...se,name:I})),D([`Bem-vindo, ${I}!`])}});if(t==="lobbies")return a.jsx(bx,{onEnterRoom:N=>{var I;r(N),(I=window.__setRoomCode)==null||I.call(window,N);try{localStorage.setItem("sg:lastRoomName",String(N));const se=new URL(window.location.href);se.searchParams.set("room",String(N)),history.replaceState(null,"",se.toString())}catch{}e("playersLobby")}});if(t==="playersLobby")return a.jsx(wx,{lobbyId:n,onBack:()=>{var N;(N=window.__setRoomCode)==null||N.call(window,null),e("lobbies")},onStartGame:N=>{var z;const I=(N==null?void 0:N.lobbyName)||((z=N==null?void 0:N.lobby)==null?void 0:z.name)||(N==null?void 0:N.name)||n||"sala-demo";try{localStorage.setItem("sg:lastRoomName",String(I));const V=new URL(window.location.href);if(V.searchParams.set("room",String(I)),history.replaceState(null,"",V.toString()),!sessionStorage.getItem("sg:room-reloaded")){sessionStorage.setItem("sg:room-reloaded","1"),location.reload();return}}catch{}const L=[...Array.isArray(N)?N:(N==null?void 0:N.players)??(N==null?void 0:N.lobbyPlayers)??[]].sort((V,je)=>{const ae=V.created_at||V.joined_at||V.createdAt||V.joinedAt,Ce=je.created_at||je.joined_at||je.createdAt||je.joinedAt;if(ae&&Ce)return new Date(ae)-new Date(Ce);const et=String(V.id??V.player_id??""),gt=String(je.id??je.player_id??"");return et.localeCompare(gt)}).map((V,je)=>u({id:String(V.id??V.player_id),name:V.name??V.player_name,cash:18e3,pos:0,bens:4e3,color:["#ffd54f","#90caf9","#a5d6a7","#ffab91"][je%4],seat:je}));if(L.length===0)return;const $=c(L);try{const V=$.find(je=>String(je.name||"").trim().toLowerCase()===String(s||"").trim().toLowerCase());V!=null&&V.id&&l(String(V.id))}catch{}h($),b(0),x(1),g(new Array($.length).fill(!1)),j(!1),C(null),A(V=>{var ae,Ce;const je=$.find(ie);return{...V,name:(je==null?void 0:je.name)||((ae=$[0])==null?void 0:ae.name)||"Jogador",color:(je==null?void 0:je.color)||((Ce=$[0])==null?void 0:Ce.color)||"#6c5ce7",cash:(je==null?void 0:je.cash)??18e3,possibAt:0,clientsAt:0}}),D(["Jogo iniciado!"]),Me($),e("game")}});const Wt=d[y],Mt=(Wt==null?void 0:Wt.bankrupt)===!0;Wt&&(String(Wt.id),String(i));const W=_!=null&&String(_)===String(i),de=f===5&&((Ae=d[y])==null?void 0:Ae.waitingAtRevenue),De=ne==null||ne===i,ve=W&&Ue===0&&!M&&De&&!Mt&&!w&&!de;return console.log("[App] controlsCanRoll - turnPlayerId:",_,"myUid:",i,"isMyTurnFromId:",W,"modalLocks:",Ue,"turnLock:",M,"lockOwner:",ne,"lockOwnerOk:",De,"isBankrupt:",Mt,"gameOver:",w,"isWaitingRevenue:",de,"result:",ve),a.jsxs("div",{className:"page",children:[a.jsxs("header",{className:"topbar",children:[a.jsxs("div",{className:"status",style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[a.jsx("span",{style:{width:18,height:18,borderRadius:"50%",border:"2px solid rgba(255,255,255,.9)",boxShadow:"0 0 0 2px rgba(0,0,0,.25)",background:S.color}}),a.jsxs("span",{style:{background:"#1f2430",border:"1px solid rgba(255,255,255,.12)",borderRadius:10,padding:"4px 10px",fontWeight:800},children:[" ",S.name]}),a.jsxs("span",{children:["Possib. Atendimento: ",a.jsx("b",{children:S.possibAt??0})]}),a.jsxs("span",{children:["Clientes em Atendimento: ",a.jsx("b",{children:S.clientsAt??0})]}),a.jsx(qx,{players:d,turnIdx:y,round:f,gameOver:w,winner:R})]}),a.jsxs("div",{className:"status",style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[a.jsxs("span",{children:["Rodada: ",f]}),a.jsxs("span",{className:"money",children:[" $ ",Number(Pe).toLocaleString()]})]})]}),a.jsxs("main",{className:"content",children:[a.jsx("div",{className:"boardWrap",children:a.jsx(Nx,{players:d,turnIdx:y,onMeHud:A})}),a.jsxs("aside",{className:"side",children:[a.jsx(Dx,{totals:Ne,players:d}),a.jsxs("div",{className:"controlsSticky",children:[a.jsx(Ax,{onAction:N=>{Le(N)},current:Be,isMyTurn:ve}),a.jsx("div",{style:{marginTop:10},children:a.jsx("button",{className:"btn dark",onClick:async()=>{var N;if(n&&i)try{await wl({roomCode:n,playerId:i})}catch(I){console.warn("[App] Erro ao sair da sala:",I)}(N=window.__setRoomCode)==null||N.call(window,null),e("lobbies")},children:"Sair para Lobbies"})})]}),w&&a.jsx(Ox,{players:d,onExit:async()=>{var N;if(n&&i)try{await wl({roomCode:n,playerId:i})}catch(I){console.warn("[App] Erro ao sair da sala:",I)}(N=window.__setRoomCode)==null||N.call(window,null),e("lobbies")},onRestart:()=>{const N=d.map(I=>u({...I,cash:18e3,bens:4e3,pos:0}));h(N),b(0),x(1),g(new Array(N.length).fill(!1)),D(["Novo jogo iniciado!"]),j(!1),C(null)}})]})]}),a.jsx("footer",{className:"foot",children:a.jsxs("small",{children:["Desenvolvido por ",a.jsx("a",{href:"https://www.tironitech.com",target:"_blank",rel:"noreferrer",children:"tironitech.com"})]})}),Dt&&a.jsx(Px,{})]})}function ib(){const e=new URLSearchParams(window.location.search).get("room");return e&&String(e).trim()||null}function ab(){const[t,e]=ye.useState(ib());return ye.useEffect(()=>(window.__setRoomCode=n=>{const r=String(n||"").trim()||null;e(r);const o=new URL(window.location.href);r?o.searchParams.set("room",r):o.searchParams.delete("room"),window.history.replaceState({},"",o)},()=>{delete window.__setRoomCode}),[]),ye.useEffect(()=>(window.exportLogs=()=>{const n=um(),r=new Blob([n.text],{type:"text/plain;charset=utf-8"}),o=URL.createObjectURL(r),s=document.createElement("a");return s.href=o,s.download=`debug-logs-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.txt`,s.click(),URL.revokeObjectURL(o),console.log(" Logs exportados! Arquivo .txt baixado."),n},window.getLogsText=()=>Ux(),window.getLogsJSON=()=>Fx(),window.getLogStats=()=>Pu(),window.toggleLogCapture=()=>(rr.enabled?(rr.disable(),console.log(" Captura de logs DESATIVADA")):(rr.enable(),console.log(" Captura de logs ATIVADA")),rr.enabled),console.log("%c FUNES DE EXPORT DE LOGS DISPONVEIS:","color: #4CAF50; font-weight: bold; font-size: 14px"),console.log("%cexportLogs()","color: #2196F3; font-weight: bold","- Exporta logs completos (baixa arquivo .txt)"),console.log("%cgetLogsText()","color: #2196F3; font-weight: bold","- Retorna logs como string de texto"),console.log("%cgetLogsJSON()","color: #2196F3; font-weight: bold","- Retorna logs como objeto JSON"),console.log("%cgetLogStats()","color: #2196F3; font-weight: bold","- Retorna estatsticas dos logs"),console.log("%ctoggleLogCapture()","color: #2196F3; font-weight: bold","- Ativa/desativa captura de logs"),()=>{delete window.exportLogs,delete window.getLogsText,delete window.getLogsJSON,delete window.getLogStats,delete window.toggleLogCapture}),[]),a.jsx(Tx,{children:a.jsx(ob,{roomCode:t,children:a.jsx(sb,{})})})}jl.createRoot(document.getElementById("root")).render(a.jsx(ye.StrictMode,{children:a.jsx(ab,{})}));
//# sourceMappingURL=index-VrX8zrWf.js.map
