(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();var Wn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Mm(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Bm(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var Hf={exports:{}},$a={},Kf={exports:{}},Be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hi=Symbol.for("react.element"),Um=Symbol.for("react.portal"),Fm=Symbol.for("react.fragment"),zm=Symbol.for("react.strict_mode"),Wm=Symbol.for("react.profiler"),Vm=Symbol.for("react.provider"),Gm=Symbol.for("react.context"),qm=Symbol.for("react.forward_ref"),Hm=Symbol.for("react.suspense"),Km=Symbol.for("react.memo"),Jm=Symbol.for("react.lazy"),nd=Symbol.iterator;function Ym(t){return t===null||typeof t!="object"?null:(t=nd&&t[nd]||t["@@iterator"],typeof t=="function"?t:null)}var Jf={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Yf=Object.assign,Qf={};function fo(t,e,n){this.props=t,this.context=e,this.refs=Qf,this.updater=n||Jf}fo.prototype.isReactComponent={};fo.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};fo.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Xf(){}Xf.prototype=fo.prototype;function rc(t,e,n){this.props=t,this.context=e,this.refs=Qf,this.updater=n||Jf}var sc=rc.prototype=new Xf;sc.constructor=rc;Yf(sc,fo.prototype);sc.isPureReactComponent=!0;var rd=Array.isArray,Zf=Object.prototype.hasOwnProperty,oc={current:null},eh={key:!0,ref:!0,__self:!0,__source:!0};function th(t,e,n){var r,s={},o=null,i=null;if(e!=null)for(r in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(o=""+e.key),e)Zf.call(e,r)&&!eh.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];s.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:hi,type:t,key:o,ref:i,props:s,_owner:oc.current}}function Qm(t,e){return{$$typeof:hi,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function ic(t){return typeof t=="object"&&t!==null&&t.$$typeof===hi}function Xm(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var sd=/\/+/g;function ll(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Xm(""+t.key):e.toString(36)}function Yi(t,e,n,r,s){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case hi:case Um:i=!0}}if(i)return i=t,s=s(i),t=r===""?"."+ll(i,0):r,rd(s)?(n="",t!=null&&(n=t.replace(sd,"$&/")+"/"),Yi(s,e,n,"",function(c){return c})):s!=null&&(ic(s)&&(s=Qm(s,n+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(sd,"$&/")+"/")+t)),e.push(s)),1;if(i=0,r=r===""?".":r+":",rd(t))for(var l=0;l<t.length;l++){o=t[l];var u=r+ll(o,l);i+=Yi(o,e,n,u,s)}else if(u=Ym(t),typeof u=="function")for(t=u.call(t),l=0;!(o=t.next()).done;)o=o.value,u=r+ll(o,l++),i+=Yi(o,e,n,u,s);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function ki(t,e,n){if(t==null)return t;var r=[],s=0;return Yi(t,r,"","",function(o){return e.call(n,o,s++)}),r}function Zm(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var pn={current:null},Qi={transition:null},eg={ReactCurrentDispatcher:pn,ReactCurrentBatchConfig:Qi,ReactCurrentOwner:oc};function nh(){throw Error("act(...) is not supported in production builds of React.")}Be.Children={map:ki,forEach:function(t,e,n){ki(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return ki(t,function(){e++}),e},toArray:function(t){return ki(t,function(e){return e})||[]},only:function(t){if(!ic(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Be.Component=fo;Be.Fragment=Fm;Be.Profiler=Wm;Be.PureComponent=rc;Be.StrictMode=zm;Be.Suspense=Hm;Be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eg;Be.act=nh;Be.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Yf({},t.props),s=t.key,o=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,i=oc.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)Zf.call(e,u)&&!eh.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];r.children=l}return{$$typeof:hi,type:t.type,key:s,ref:o,props:r,_owner:i}};Be.createContext=function(t){return t={$$typeof:Gm,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Vm,_context:t},t.Consumer=t};Be.createElement=th;Be.createFactory=function(t){var e=th.bind(null,t);return e.type=t,e};Be.createRef=function(){return{current:null}};Be.forwardRef=function(t){return{$$typeof:qm,render:t}};Be.isValidElement=ic;Be.lazy=function(t){return{$$typeof:Jm,_payload:{_status:-1,_result:t},_init:Zm}};Be.memo=function(t,e){return{$$typeof:Km,type:t,compare:e===void 0?null:e}};Be.startTransition=function(t){var e=Qi.transition;Qi.transition={};try{t()}finally{Qi.transition=e}};Be.unstable_act=nh;Be.useCallback=function(t,e){return pn.current.useCallback(t,e)};Be.useContext=function(t){return pn.current.useContext(t)};Be.useDebugValue=function(){};Be.useDeferredValue=function(t){return pn.current.useDeferredValue(t)};Be.useEffect=function(t,e){return pn.current.useEffect(t,e)};Be.useId=function(){return pn.current.useId()};Be.useImperativeHandle=function(t,e,n){return pn.current.useImperativeHandle(t,e,n)};Be.useInsertionEffect=function(t,e){return pn.current.useInsertionEffect(t,e)};Be.useLayoutEffect=function(t,e){return pn.current.useLayoutEffect(t,e)};Be.useMemo=function(t,e){return pn.current.useMemo(t,e)};Be.useReducer=function(t,e,n){return pn.current.useReducer(t,e,n)};Be.useRef=function(t){return pn.current.useRef(t)};Be.useState=function(t){return pn.current.useState(t)};Be.useSyncExternalStore=function(t,e,n){return pn.current.useSyncExternalStore(t,e,n)};Be.useTransition=function(){return pn.current.useTransition()};Be.version="18.3.1";Kf.exports=Be;var j=Kf.exports;const ce=Mm(j);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tg=j,ng=Symbol.for("react.element"),rg=Symbol.for("react.fragment"),sg=Object.prototype.hasOwnProperty,og=tg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ig={key:!0,ref:!0,__self:!0,__source:!0};function rh(t,e,n){var r,s={},o=null,i=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(i=e.ref);for(r in e)sg.call(e,r)&&!ig.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:ng,type:t,key:o,ref:i,props:s,_owner:og.current}}$a.Fragment=rg;$a.jsx=rh;$a.jsxs=rh;Hf.exports=$a;var a=Hf.exports,Jl={},sh={exports:{}},In={},oh={exports:{}},ih={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Q,F){var pe=Q.length;Q.push(F);e:for(;0<pe;){var Ee=pe-1>>>1,xe=Q[Ee];if(0<s(xe,F))Q[Ee]=F,Q[pe]=xe,pe=Ee;else break e}}function n(Q){return Q.length===0?null:Q[0]}function r(Q){if(Q.length===0)return null;var F=Q[0],pe=Q.pop();if(pe!==F){Q[0]=pe;e:for(var Ee=0,xe=Q.length,Ye=xe>>>1;Ee<Ye;){var Ft=2*(Ee+1)-1,Tt=Q[Ft],zt=Ft+1,rr=Q[zt];if(0>s(Tt,pe))zt<xe&&0>s(rr,Tt)?(Q[Ee]=rr,Q[zt]=pe,Ee=zt):(Q[Ee]=Tt,Q[Ft]=pe,Ee=Ft);else if(zt<xe&&0>s(rr,pe))Q[Ee]=rr,Q[zt]=pe,Ee=zt;else break e}}return F}function s(Q,F){var pe=Q.sortIndex-F.sortIndex;return pe!==0?pe:Q.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var i=Date,l=i.now();t.unstable_now=function(){return i.now()-l}}var u=[],c=[],d=1,h=null,p=3,g=!1,b=!1,x=!1,S=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,f=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function m(Q){for(var F=n(c);F!==null;){if(F.callback===null)r(c);else if(F.startTime<=Q)r(c),F.sortIndex=F.expirationTime,e(u,F);else break;F=n(c)}}function w(Q){if(x=!1,m(Q),!b)if(n(u)!==null)b=!0,Je(_);else{var F=n(c);F!==null&&at(w,F.startTime-Q)}}function _(Q,F){b=!1,x&&(x=!1,y(k),k=-1),g=!0;var pe=p;try{for(m(F),h=n(u);h!==null&&(!(h.expirationTime>F)||Q&&!E());){var Ee=h.callback;if(typeof Ee=="function"){h.callback=null,p=h.priorityLevel;var xe=Ee(h.expirationTime<=F);F=t.unstable_now(),typeof xe=="function"?h.callback=xe:h===n(u)&&r(u),m(F)}else r(u);h=n(u)}if(h!==null)var Ye=!0;else{var Ft=n(c);Ft!==null&&at(w,Ft.startTime-F),Ye=!1}return Ye}finally{h=null,p=pe,g=!1}}var A=!1,D=null,k=-1,R=5,v=-1;function E(){return!(t.unstable_now()-v<R)}function T(){if(D!==null){var Q=t.unstable_now();v=Q;var F=!0;try{F=D(!0,Q)}finally{F?$():(A=!1,D=null)}}else A=!1}var $;if(typeof f=="function")$=function(){f(T)};else if(typeof MessageChannel<"u"){var U=new MessageChannel,V=U.port2;U.port1.onmessage=T,$=function(){V.postMessage(null)}}else $=function(){S(T,0)};function Je(Q){D=Q,A||(A=!0,$())}function at(Q,F){k=S(function(){Q(t.unstable_now())},F)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Q){Q.callback=null},t.unstable_continueExecution=function(){b||g||(b=!0,Je(_))},t.unstable_forceFrameRate=function(Q){0>Q||125<Q?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<Q?Math.floor(1e3/Q):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(Q){switch(p){case 1:case 2:case 3:var F=3;break;default:F=p}var pe=p;p=F;try{return Q()}finally{p=pe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Q,F){switch(Q){case 1:case 2:case 3:case 4:case 5:break;default:Q=3}var pe=p;p=Q;try{return F()}finally{p=pe}},t.unstable_scheduleCallback=function(Q,F,pe){var Ee=t.unstable_now();switch(typeof pe=="object"&&pe!==null?(pe=pe.delay,pe=typeof pe=="number"&&0<pe?Ee+pe:Ee):pe=Ee,Q){case 1:var xe=-1;break;case 2:xe=250;break;case 5:xe=1073741823;break;case 4:xe=1e4;break;default:xe=5e3}return xe=pe+xe,Q={id:d++,callback:F,priorityLevel:Q,startTime:pe,expirationTime:xe,sortIndex:-1},pe>Ee?(Q.sortIndex=pe,e(c,Q),n(u)===null&&Q===n(c)&&(x?(y(k),k=-1):x=!0,at(w,pe-Ee))):(Q.sortIndex=xe,e(u,Q),b||g||(b=!0,Je(_))),Q},t.unstable_shouldYield=E,t.unstable_wrapCallback=function(Q){var F=p;return function(){var pe=p;p=F;try{return Q.apply(this,arguments)}finally{p=pe}}}})(ih);oh.exports=ih;var ag=oh.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lg=j,Ln=ag;function G(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ah=new Set,Ko={};function Cs(t,e){ro(t,e),ro(t+"Capture",e)}function ro(t,e){for(Ko[t]=e,t=0;t<e.length;t++)ah.add(e[t])}var kr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Yl=Object.prototype.hasOwnProperty,ug=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,od={},id={};function cg(t){return Yl.call(id,t)?!0:Yl.call(od,t)?!1:ug.test(t)?id[t]=!0:(od[t]=!0,!1)}function dg(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function fg(t,e,n,r){if(e===null||typeof e>"u"||dg(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function mn(t,e,n,r,s,o,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=i}var Yt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Yt[t]=new mn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Yt[e]=new mn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Yt[t]=new mn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Yt[t]=new mn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Yt[t]=new mn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Yt[t]=new mn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Yt[t]=new mn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Yt[t]=new mn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Yt[t]=new mn(t,5,!1,t.toLowerCase(),null,!1,!1)});var ac=/[\-:]([a-z])/g;function lc(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(ac,lc);Yt[e]=new mn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(ac,lc);Yt[e]=new mn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(ac,lc);Yt[e]=new mn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Yt[t]=new mn(t,1,!1,t.toLowerCase(),null,!1,!1)});Yt.xlinkHref=new mn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Yt[t]=new mn(t,1,!1,t.toLowerCase(),null,!0,!0)});function uc(t,e,n,r){var s=Yt.hasOwnProperty(e)?Yt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(fg(e,n,s,r)&&(n=null),r||s===null?cg(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Nr=lg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ei=Symbol.for("react.element"),Bs=Symbol.for("react.portal"),Us=Symbol.for("react.fragment"),cc=Symbol.for("react.strict_mode"),Ql=Symbol.for("react.profiler"),lh=Symbol.for("react.provider"),uh=Symbol.for("react.context"),dc=Symbol.for("react.forward_ref"),Xl=Symbol.for("react.suspense"),Zl=Symbol.for("react.suspense_list"),fc=Symbol.for("react.memo"),$r=Symbol.for("react.lazy"),ch=Symbol.for("react.offscreen"),ad=Symbol.iterator;function bo(t){return t===null||typeof t!="object"?null:(t=ad&&t[ad]||t["@@iterator"],typeof t=="function"?t:null)}var wt=Object.assign,ul;function Do(t){if(ul===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);ul=e&&e[1]||""}return`
`+ul+t}var cl=!1;function dl(t,e){if(!t||cl)return"";cl=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),o=r.stack.split(`
`),i=s.length-1,l=o.length-1;1<=i&&0<=l&&s[i]!==o[l];)l--;for(;1<=i&&0<=l;i--,l--)if(s[i]!==o[l]){if(i!==1||l!==1)do if(i--,l--,0>l||s[i]!==o[l]){var u=`
`+s[i].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=i&&0<=l);break}}}finally{cl=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Do(t):""}function hg(t){switch(t.tag){case 5:return Do(t.type);case 16:return Do("Lazy");case 13:return Do("Suspense");case 19:return Do("SuspenseList");case 0:case 2:case 15:return t=dl(t.type,!1),t;case 11:return t=dl(t.type.render,!1),t;case 1:return t=dl(t.type,!0),t;default:return""}}function eu(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Us:return"Fragment";case Bs:return"Portal";case Ql:return"Profiler";case cc:return"StrictMode";case Xl:return"Suspense";case Zl:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case uh:return(t.displayName||"Context")+".Consumer";case lh:return(t._context.displayName||"Context")+".Provider";case dc:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case fc:return e=t.displayName||null,e!==null?e:eu(t.type)||"Memo";case $r:e=t._payload,t=t._init;try{return eu(t(e))}catch{}}return null}function pg(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return eu(e);case 8:return e===cc?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Xr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function dh(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function mg(t){var e=dh(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(i){r=""+i,o.call(this,i)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ji(t){t._valueTracker||(t._valueTracker=mg(t))}function fh(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=dh(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function la(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function tu(t,e){var n=e.checked;return wt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function ld(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Xr(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function hh(t,e){e=e.checked,e!=null&&uc(t,"checked",e,!1)}function nu(t,e){hh(t,e);var n=Xr(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?ru(t,e.type,n):e.hasOwnProperty("defaultValue")&&ru(t,e.type,Xr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function ud(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function ru(t,e,n){(e!=="number"||la(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ao=Array.isArray;function Qs(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Xr(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function su(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(G(91));return wt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function cd(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(G(92));if(Ao(n)){if(1<n.length)throw Error(G(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Xr(n)}}function ph(t,e){var n=Xr(e.value),r=Xr(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function dd(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function mh(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ou(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?mh(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ci,gh=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ci=Ci||document.createElement("div"),Ci.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ci.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Jo(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Lo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},gg=["Webkit","ms","Moz","O"];Object.keys(Lo).forEach(function(t){gg.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Lo[e]=Lo[t]})});function yh(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Lo.hasOwnProperty(t)&&Lo[t]?(""+e).trim():e+"px"}function vh(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=yh(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var yg=wt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function iu(t,e){if(e){if(yg[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(G(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(G(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(G(61))}if(e.style!=null&&typeof e.style!="object")throw Error(G(62))}}function au(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var lu=null;function hc(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var uu=null,Xs=null,Zs=null;function fd(t){if(t=gi(t)){if(typeof uu!="function")throw Error(G(280));var e=t.stateNode;e&&(e=za(e),uu(t.stateNode,t.type,e))}}function xh(t){Xs?Zs?Zs.push(t):Zs=[t]:Xs=t}function bh(){if(Xs){var t=Xs,e=Zs;if(Zs=Xs=null,fd(t),e)for(t=0;t<e.length;t++)fd(e[t])}}function wh(t,e){return t(e)}function Sh(){}var fl=!1;function _h(t,e,n){if(fl)return t(e,n);fl=!0;try{return wh(t,e,n)}finally{fl=!1,(Xs!==null||Zs!==null)&&(Sh(),bh())}}function Yo(t,e){var n=t.stateNode;if(n===null)return null;var r=za(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(G(231,e,typeof n));return n}var cu=!1;if(kr)try{var wo={};Object.defineProperty(wo,"passive",{get:function(){cu=!0}}),window.addEventListener("test",wo,wo),window.removeEventListener("test",wo,wo)}catch{cu=!1}function vg(t,e,n,r,s,o,i,l,u){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(d){this.onError(d)}}var Io=!1,ua=null,ca=!1,du=null,xg={onError:function(t){Io=!0,ua=t}};function bg(t,e,n,r,s,o,i,l,u){Io=!1,ua=null,vg.apply(xg,arguments)}function wg(t,e,n,r,s,o,i,l,u){if(bg.apply(this,arguments),Io){if(Io){var c=ua;Io=!1,ua=null}else throw Error(G(198));ca||(ca=!0,du=c)}}function Rs(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function kh(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function hd(t){if(Rs(t)!==t)throw Error(G(188))}function Sg(t){var e=t.alternate;if(!e){if(e=Rs(t),e===null)throw Error(G(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var o=s.alternate;if(o===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===o.child){for(o=s.child;o;){if(o===n)return hd(s),t;if(o===r)return hd(s),e;o=o.sibling}throw Error(G(188))}if(n.return!==r.return)n=s,r=o;else{for(var i=!1,l=s.child;l;){if(l===n){i=!0,n=s,r=o;break}if(l===r){i=!0,r=s,n=o;break}l=l.sibling}if(!i){for(l=o.child;l;){if(l===n){i=!0,n=o,r=s;break}if(l===r){i=!0,r=o,n=s;break}l=l.sibling}if(!i)throw Error(G(189))}}if(n.alternate!==r)throw Error(G(190))}if(n.tag!==3)throw Error(G(188));return n.stateNode.current===n?t:e}function Eh(t){return t=Sg(t),t!==null?jh(t):null}function jh(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=jh(t);if(e!==null)return e;t=t.sibling}return null}var Ch=Ln.unstable_scheduleCallback,pd=Ln.unstable_cancelCallback,_g=Ln.unstable_shouldYield,kg=Ln.unstable_requestPaint,jt=Ln.unstable_now,Eg=Ln.unstable_getCurrentPriorityLevel,pc=Ln.unstable_ImmediatePriority,Rh=Ln.unstable_UserBlockingPriority,da=Ln.unstable_NormalPriority,jg=Ln.unstable_LowPriority,Nh=Ln.unstable_IdlePriority,Ma=null,pr=null;function Cg(t){if(pr&&typeof pr.onCommitFiberRoot=="function")try{pr.onCommitFiberRoot(Ma,t,void 0,(t.current.flags&128)===128)}catch{}}var er=Math.clz32?Math.clz32:Dg,Rg=Math.log,Ng=Math.LN2;function Dg(t){return t>>>=0,t===0?32:31-(Rg(t)/Ng|0)|0}var Ri=64,Ni=4194304;function Oo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function fa(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,o=t.pingedLanes,i=n&268435455;if(i!==0){var l=i&~s;l!==0?r=Oo(l):(o&=i,o!==0&&(r=Oo(o)))}else i=n&~s,i!==0?r=Oo(i):o!==0&&(r=Oo(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,o=e&-e,s>=o||s===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-er(e),s=1<<n,r|=t[n],e&=~s;return r}function Ag(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Og(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,o=t.pendingLanes;0<o;){var i=31-er(o),l=1<<i,u=s[i];u===-1?(!(l&n)||l&r)&&(s[i]=Ag(l,e)):u<=e&&(t.expiredLanes|=l),o&=~l}}function fu(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Dh(){var t=Ri;return Ri<<=1,!(Ri&4194240)&&(Ri=64),t}function hl(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function pi(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-er(e),t[e]=n}function Tg(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-er(n),o=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~o}}function mc(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-er(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var ot=0;function Ah(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Oh,gc,Th,Ph,Lh,hu=!1,Di=[],Vr=null,Gr=null,qr=null,Qo=new Map,Xo=new Map,Br=[],Pg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function md(t,e){switch(t){case"focusin":case"focusout":Vr=null;break;case"dragenter":case"dragleave":Gr=null;break;case"mouseover":case"mouseout":qr=null;break;case"pointerover":case"pointerout":Qo.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xo.delete(e.pointerId)}}function So(t,e,n,r,s,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[s]},e!==null&&(e=gi(e),e!==null&&gc(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function Lg(t,e,n,r,s){switch(e){case"focusin":return Vr=So(Vr,t,e,n,r,s),!0;case"dragenter":return Gr=So(Gr,t,e,n,r,s),!0;case"mouseover":return qr=So(qr,t,e,n,r,s),!0;case"pointerover":var o=s.pointerId;return Qo.set(o,So(Qo.get(o)||null,t,e,n,r,s)),!0;case"gotpointercapture":return o=s.pointerId,Xo.set(o,So(Xo.get(o)||null,t,e,n,r,s)),!0}return!1}function Ih(t){var e=ms(t.target);if(e!==null){var n=Rs(e);if(n!==null){if(e=n.tag,e===13){if(e=kh(n),e!==null){t.blockedOn=e,Lh(t.priority,function(){Th(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Xi(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=pu(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);lu=r,n.target.dispatchEvent(r),lu=null}else return e=gi(n),e!==null&&gc(e),t.blockedOn=n,!1;e.shift()}return!0}function gd(t,e,n){Xi(t)&&n.delete(e)}function Ig(){hu=!1,Vr!==null&&Xi(Vr)&&(Vr=null),Gr!==null&&Xi(Gr)&&(Gr=null),qr!==null&&Xi(qr)&&(qr=null),Qo.forEach(gd),Xo.forEach(gd)}function _o(t,e){t.blockedOn===e&&(t.blockedOn=null,hu||(hu=!0,Ln.unstable_scheduleCallback(Ln.unstable_NormalPriority,Ig)))}function Zo(t){function e(s){return _o(s,t)}if(0<Di.length){_o(Di[0],t);for(var n=1;n<Di.length;n++){var r=Di[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Vr!==null&&_o(Vr,t),Gr!==null&&_o(Gr,t),qr!==null&&_o(qr,t),Qo.forEach(e),Xo.forEach(e),n=0;n<Br.length;n++)r=Br[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Br.length&&(n=Br[0],n.blockedOn===null);)Ih(n),n.blockedOn===null&&Br.shift()}var eo=Nr.ReactCurrentBatchConfig,ha=!0;function $g(t,e,n,r){var s=ot,o=eo.transition;eo.transition=null;try{ot=1,yc(t,e,n,r)}finally{ot=s,eo.transition=o}}function Mg(t,e,n,r){var s=ot,o=eo.transition;eo.transition=null;try{ot=4,yc(t,e,n,r)}finally{ot=s,eo.transition=o}}function yc(t,e,n,r){if(ha){var s=pu(t,e,n,r);if(s===null)_l(t,e,r,pa,n),md(t,r);else if(Lg(s,t,e,n,r))r.stopPropagation();else if(md(t,r),e&4&&-1<Pg.indexOf(t)){for(;s!==null;){var o=gi(s);if(o!==null&&Oh(o),o=pu(t,e,n,r),o===null&&_l(t,e,r,pa,n),o===s)break;s=o}s!==null&&r.stopPropagation()}else _l(t,e,r,null,n)}}var pa=null;function pu(t,e,n,r){if(pa=null,t=hc(r),t=ms(t),t!==null)if(e=Rs(t),e===null)t=null;else if(n=e.tag,n===13){if(t=kh(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return pa=t,null}function $h(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Eg()){case pc:return 1;case Rh:return 4;case da:case jg:return 16;case Nh:return 536870912;default:return 16}default:return 16}}var zr=null,vc=null,Zi=null;function Mh(){if(Zi)return Zi;var t,e=vc,n=e.length,r,s="value"in zr?zr.value:zr.textContent,o=s.length;for(t=0;t<n&&e[t]===s[t];t++);var i=n-t;for(r=1;r<=i&&e[n-r]===s[o-r];r++);return Zi=s.slice(t,1<r?1-r:void 0)}function ea(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ai(){return!0}function yd(){return!1}function $n(t){function e(n,r,s,o,i){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(o):o[l]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?Ai:yd,this.isPropagationStopped=yd,this}return wt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ai)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ai)},persist:function(){},isPersistent:Ai}),e}var ho={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},xc=$n(ho),mi=wt({},ho,{view:0,detail:0}),Bg=$n(mi),pl,ml,ko,Ba=wt({},mi,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:bc,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==ko&&(ko&&t.type==="mousemove"?(pl=t.screenX-ko.screenX,ml=t.screenY-ko.screenY):ml=pl=0,ko=t),pl)},movementY:function(t){return"movementY"in t?t.movementY:ml}}),vd=$n(Ba),Ug=wt({},Ba,{dataTransfer:0}),Fg=$n(Ug),zg=wt({},mi,{relatedTarget:0}),gl=$n(zg),Wg=wt({},ho,{animationName:0,elapsedTime:0,pseudoElement:0}),Vg=$n(Wg),Gg=wt({},ho,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),qg=$n(Gg),Hg=wt({},ho,{data:0}),xd=$n(Hg),Kg={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Jg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Yg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Qg(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Yg[t])?!!e[t]:!1}function bc(){return Qg}var Xg=wt({},mi,{key:function(t){if(t.key){var e=Kg[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=ea(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Jg[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:bc,charCode:function(t){return t.type==="keypress"?ea(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?ea(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Zg=$n(Xg),e0=wt({},Ba,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),bd=$n(e0),t0=wt({},mi,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:bc}),n0=$n(t0),r0=wt({},ho,{propertyName:0,elapsedTime:0,pseudoElement:0}),s0=$n(r0),o0=wt({},Ba,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),i0=$n(o0),a0=[9,13,27,32],wc=kr&&"CompositionEvent"in window,$o=null;kr&&"documentMode"in document&&($o=document.documentMode);var l0=kr&&"TextEvent"in window&&!$o,Bh=kr&&(!wc||$o&&8<$o&&11>=$o),wd=" ",Sd=!1;function Uh(t,e){switch(t){case"keyup":return a0.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Fh(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Fs=!1;function u0(t,e){switch(t){case"compositionend":return Fh(e);case"keypress":return e.which!==32?null:(Sd=!0,wd);case"textInput":return t=e.data,t===wd&&Sd?null:t;default:return null}}function c0(t,e){if(Fs)return t==="compositionend"||!wc&&Uh(t,e)?(t=Mh(),Zi=vc=zr=null,Fs=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Bh&&e.locale!=="ko"?null:e.data;default:return null}}var d0={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _d(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!d0[t.type]:e==="textarea"}function zh(t,e,n,r){xh(r),e=ma(e,"onChange"),0<e.length&&(n=new xc("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Mo=null,ei=null;function f0(t){Zh(t,0)}function Ua(t){var e=Vs(t);if(fh(e))return t}function h0(t,e){if(t==="change")return e}var Wh=!1;if(kr){var yl;if(kr){var vl="oninput"in document;if(!vl){var kd=document.createElement("div");kd.setAttribute("oninput","return;"),vl=typeof kd.oninput=="function"}yl=vl}else yl=!1;Wh=yl&&(!document.documentMode||9<document.documentMode)}function Ed(){Mo&&(Mo.detachEvent("onpropertychange",Vh),ei=Mo=null)}function Vh(t){if(t.propertyName==="value"&&Ua(ei)){var e=[];zh(e,ei,t,hc(t)),_h(f0,e)}}function p0(t,e,n){t==="focusin"?(Ed(),Mo=e,ei=n,Mo.attachEvent("onpropertychange",Vh)):t==="focusout"&&Ed()}function m0(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Ua(ei)}function g0(t,e){if(t==="click")return Ua(e)}function y0(t,e){if(t==="input"||t==="change")return Ua(e)}function v0(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var nr=typeof Object.is=="function"?Object.is:v0;function ti(t,e){if(nr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Yl.call(e,s)||!nr(t[s],e[s]))return!1}return!0}function jd(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Cd(t,e){var n=jd(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=jd(n)}}function Gh(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Gh(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function qh(){for(var t=window,e=la();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=la(t.document)}return e}function Sc(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function x0(t){var e=qh(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Gh(n.ownerDocument.documentElement,n)){if(r!==null&&Sc(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,o=Math.min(r.start,s);r=r.end===void 0?o:Math.min(r.end,s),!t.extend&&o>r&&(s=r,r=o,o=s),s=Cd(n,o);var i=Cd(n,r);s&&i&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var b0=kr&&"documentMode"in document&&11>=document.documentMode,zs=null,mu=null,Bo=null,gu=!1;function Rd(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;gu||zs==null||zs!==la(r)||(r=zs,"selectionStart"in r&&Sc(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Bo&&ti(Bo,r)||(Bo=r,r=ma(mu,"onSelect"),0<r.length&&(e=new xc("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=zs)))}function Oi(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Ws={animationend:Oi("Animation","AnimationEnd"),animationiteration:Oi("Animation","AnimationIteration"),animationstart:Oi("Animation","AnimationStart"),transitionend:Oi("Transition","TransitionEnd")},xl={},Hh={};kr&&(Hh=document.createElement("div").style,"AnimationEvent"in window||(delete Ws.animationend.animation,delete Ws.animationiteration.animation,delete Ws.animationstart.animation),"TransitionEvent"in window||delete Ws.transitionend.transition);function Fa(t){if(xl[t])return xl[t];if(!Ws[t])return t;var e=Ws[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Hh)return xl[t]=e[n];return t}var Kh=Fa("animationend"),Jh=Fa("animationiteration"),Yh=Fa("animationstart"),Qh=Fa("transitionend"),Xh=new Map,Nd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function es(t,e){Xh.set(t,e),Cs(e,[t])}for(var bl=0;bl<Nd.length;bl++){var wl=Nd[bl],w0=wl.toLowerCase(),S0=wl[0].toUpperCase()+wl.slice(1);es(w0,"on"+S0)}es(Kh,"onAnimationEnd");es(Jh,"onAnimationIteration");es(Yh,"onAnimationStart");es("dblclick","onDoubleClick");es("focusin","onFocus");es("focusout","onBlur");es(Qh,"onTransitionEnd");ro("onMouseEnter",["mouseout","mouseover"]);ro("onMouseLeave",["mouseout","mouseover"]);ro("onPointerEnter",["pointerout","pointerover"]);ro("onPointerLeave",["pointerout","pointerover"]);Cs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Cs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Cs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Cs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Cs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Cs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var To="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_0=new Set("cancel close invalid load scroll toggle".split(" ").concat(To));function Dd(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,wg(r,e,void 0,t),t.currentTarget=null}function Zh(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var i=r.length-1;0<=i;i--){var l=r[i],u=l.instance,c=l.currentTarget;if(l=l.listener,u!==o&&s.isPropagationStopped())break e;Dd(s,l,c),o=u}else for(i=0;i<r.length;i++){if(l=r[i],u=l.instance,c=l.currentTarget,l=l.listener,u!==o&&s.isPropagationStopped())break e;Dd(s,l,c),o=u}}}if(ca)throw t=du,ca=!1,du=null,t}function pt(t,e){var n=e[wu];n===void 0&&(n=e[wu]=new Set);var r=t+"__bubble";n.has(r)||(ep(e,t,2,!1),n.add(r))}function Sl(t,e,n){var r=0;e&&(r|=4),ep(n,t,r,e)}var Ti="_reactListening"+Math.random().toString(36).slice(2);function ni(t){if(!t[Ti]){t[Ti]=!0,ah.forEach(function(n){n!=="selectionchange"&&(_0.has(n)||Sl(n,!1,t),Sl(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ti]||(e[Ti]=!0,Sl("selectionchange",!1,e))}}function ep(t,e,n,r){switch($h(e)){case 1:var s=$g;break;case 4:s=Mg;break;default:s=yc}n=s.bind(null,e,n,t),s=void 0,!cu||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function _l(t,e,n,r,s){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(i===4)for(i=r.return;i!==null;){var u=i.tag;if((u===3||u===4)&&(u=i.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;i=i.return}for(;l!==null;){if(i=ms(l),i===null)return;if(u=i.tag,u===5||u===6){r=o=i;continue e}l=l.parentNode}}r=r.return}_h(function(){var c=o,d=hc(n),h=[];e:{var p=Xh.get(t);if(p!==void 0){var g=xc,b=t;switch(t){case"keypress":if(ea(n)===0)break e;case"keydown":case"keyup":g=Zg;break;case"focusin":b="focus",g=gl;break;case"focusout":b="blur",g=gl;break;case"beforeblur":case"afterblur":g=gl;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=vd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=Fg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=n0;break;case Kh:case Jh:case Yh:g=Vg;break;case Qh:g=s0;break;case"scroll":g=Bg;break;case"wheel":g=i0;break;case"copy":case"cut":case"paste":g=qg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=bd}var x=(e&4)!==0,S=!x&&t==="scroll",y=x?p!==null?p+"Capture":null:p;x=[];for(var f=c,m;f!==null;){m=f;var w=m.stateNode;if(m.tag===5&&w!==null&&(m=w,y!==null&&(w=Yo(f,y),w!=null&&x.push(ri(f,w,m)))),S)break;f=f.return}0<x.length&&(p=new g(p,b,null,n,d),h.push({event:p,listeners:x}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",g=t==="mouseout"||t==="pointerout",p&&n!==lu&&(b=n.relatedTarget||n.fromElement)&&(ms(b)||b[Er]))break e;if((g||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,g?(b=n.relatedTarget||n.toElement,g=c,b=b?ms(b):null,b!==null&&(S=Rs(b),b!==S||b.tag!==5&&b.tag!==6)&&(b=null)):(g=null,b=c),g!==b)){if(x=vd,w="onMouseLeave",y="onMouseEnter",f="mouse",(t==="pointerout"||t==="pointerover")&&(x=bd,w="onPointerLeave",y="onPointerEnter",f="pointer"),S=g==null?p:Vs(g),m=b==null?p:Vs(b),p=new x(w,f+"leave",g,n,d),p.target=S,p.relatedTarget=m,w=null,ms(d)===c&&(x=new x(y,f+"enter",b,n,d),x.target=m,x.relatedTarget=S,w=x),S=w,g&&b)t:{for(x=g,y=b,f=0,m=x;m;m=Ds(m))f++;for(m=0,w=y;w;w=Ds(w))m++;for(;0<f-m;)x=Ds(x),f--;for(;0<m-f;)y=Ds(y),m--;for(;f--;){if(x===y||y!==null&&x===y.alternate)break t;x=Ds(x),y=Ds(y)}x=null}else x=null;g!==null&&Ad(h,p,g,x,!1),b!==null&&S!==null&&Ad(h,S,b,x,!0)}}e:{if(p=c?Vs(c):window,g=p.nodeName&&p.nodeName.toLowerCase(),g==="select"||g==="input"&&p.type==="file")var _=h0;else if(_d(p))if(Wh)_=y0;else{_=m0;var A=p0}else(g=p.nodeName)&&g.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(_=g0);if(_&&(_=_(t,c))){zh(h,_,n,d);break e}A&&A(t,p,c),t==="focusout"&&(A=p._wrapperState)&&A.controlled&&p.type==="number"&&ru(p,"number",p.value)}switch(A=c?Vs(c):window,t){case"focusin":(_d(A)||A.contentEditable==="true")&&(zs=A,mu=c,Bo=null);break;case"focusout":Bo=mu=zs=null;break;case"mousedown":gu=!0;break;case"contextmenu":case"mouseup":case"dragend":gu=!1,Rd(h,n,d);break;case"selectionchange":if(b0)break;case"keydown":case"keyup":Rd(h,n,d)}var D;if(wc)e:{switch(t){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else Fs?Uh(t,n)&&(k="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(k="onCompositionStart");k&&(Bh&&n.locale!=="ko"&&(Fs||k!=="onCompositionStart"?k==="onCompositionEnd"&&Fs&&(D=Mh()):(zr=d,vc="value"in zr?zr.value:zr.textContent,Fs=!0)),A=ma(c,k),0<A.length&&(k=new xd(k,t,null,n,d),h.push({event:k,listeners:A}),D?k.data=D:(D=Fh(n),D!==null&&(k.data=D)))),(D=l0?u0(t,n):c0(t,n))&&(c=ma(c,"onBeforeInput"),0<c.length&&(d=new xd("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:c}),d.data=D))}Zh(h,e)})}function ri(t,e,n){return{instance:t,listener:e,currentTarget:n}}function ma(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,o=s.stateNode;s.tag===5&&o!==null&&(s=o,o=Yo(t,n),o!=null&&r.unshift(ri(t,o,s)),o=Yo(t,e),o!=null&&r.push(ri(t,o,s))),t=t.return}return r}function Ds(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Ad(t,e,n,r,s){for(var o=e._reactName,i=[];n!==null&&n!==r;){var l=n,u=l.alternate,c=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&c!==null&&(l=c,s?(u=Yo(n,o),u!=null&&i.unshift(ri(n,u,l))):s||(u=Yo(n,o),u!=null&&i.push(ri(n,u,l)))),n=n.return}i.length!==0&&t.push({event:e,listeners:i})}var k0=/\r\n?/g,E0=/\u0000|\uFFFD/g;function Od(t){return(typeof t=="string"?t:""+t).replace(k0,`
`).replace(E0,"")}function Pi(t,e,n){if(e=Od(e),Od(t)!==e&&n)throw Error(G(425))}function ga(){}var yu=null,vu=null;function xu(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var bu=typeof setTimeout=="function"?setTimeout:void 0,j0=typeof clearTimeout=="function"?clearTimeout:void 0,Td=typeof Promise=="function"?Promise:void 0,C0=typeof queueMicrotask=="function"?queueMicrotask:typeof Td<"u"?function(t){return Td.resolve(null).then(t).catch(R0)}:bu;function R0(t){setTimeout(function(){throw t})}function kl(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Zo(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Zo(e)}function Hr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Pd(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var po=Math.random().toString(36).slice(2),fr="__reactFiber$"+po,si="__reactProps$"+po,Er="__reactContainer$"+po,wu="__reactEvents$"+po,N0="__reactListeners$"+po,D0="__reactHandles$"+po;function ms(t){var e=t[fr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Er]||n[fr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Pd(t);t!==null;){if(n=t[fr])return n;t=Pd(t)}return e}t=n,n=t.parentNode}return null}function gi(t){return t=t[fr]||t[Er],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Vs(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(G(33))}function za(t){return t[si]||null}var Su=[],Gs=-1;function ts(t){return{current:t}}function mt(t){0>Gs||(t.current=Su[Gs],Su[Gs]=null,Gs--)}function dt(t,e){Gs++,Su[Gs]=t.current,t.current=e}var Zr={},rn=ts(Zr),En=ts(!1),ws=Zr;function so(t,e){var n=t.type.contextTypes;if(!n)return Zr;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},o;for(o in n)s[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function jn(t){return t=t.childContextTypes,t!=null}function ya(){mt(En),mt(rn)}function Ld(t,e,n){if(rn.current!==Zr)throw Error(G(168));dt(rn,e),dt(En,n)}function tp(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(G(108,pg(t)||"Unknown",s));return wt({},n,r)}function va(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Zr,ws=rn.current,dt(rn,t),dt(En,En.current),!0}function Id(t,e,n){var r=t.stateNode;if(!r)throw Error(G(169));n?(t=tp(t,e,ws),r.__reactInternalMemoizedMergedChildContext=t,mt(En),mt(rn),dt(rn,t)):mt(En),dt(En,n)}var xr=null,Wa=!1,El=!1;function np(t){xr===null?xr=[t]:xr.push(t)}function A0(t){Wa=!0,np(t)}function ns(){if(!El&&xr!==null){El=!0;var t=0,e=ot;try{var n=xr;for(ot=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}xr=null,Wa=!1}catch(s){throw xr!==null&&(xr=xr.slice(t+1)),Ch(pc,ns),s}finally{ot=e,El=!1}}return null}var qs=[],Hs=0,xa=null,ba=0,Bn=[],Un=0,Ss=null,br=1,wr="";function ds(t,e){qs[Hs++]=ba,qs[Hs++]=xa,xa=t,ba=e}function rp(t,e,n){Bn[Un++]=br,Bn[Un++]=wr,Bn[Un++]=Ss,Ss=t;var r=br;t=wr;var s=32-er(r)-1;r&=~(1<<s),n+=1;var o=32-er(e)+s;if(30<o){var i=s-s%5;o=(r&(1<<i)-1).toString(32),r>>=i,s-=i,br=1<<32-er(e)+s|n<<s|r,wr=o+t}else br=1<<o|n<<s|r,wr=t}function _c(t){t.return!==null&&(ds(t,1),rp(t,1,0))}function kc(t){for(;t===xa;)xa=qs[--Hs],qs[Hs]=null,ba=qs[--Hs],qs[Hs]=null;for(;t===Ss;)Ss=Bn[--Un],Bn[Un]=null,wr=Bn[--Un],Bn[Un]=null,br=Bn[--Un],Bn[Un]=null}var Pn=null,Tn=null,vt=!1,Xn=null;function sp(t,e){var n=Fn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function $d(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Pn=t,Tn=Hr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Pn=t,Tn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ss!==null?{id:br,overflow:wr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Fn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Pn=t,Tn=null,!0):!1;default:return!1}}function _u(t){return(t.mode&1)!==0&&(t.flags&128)===0}function ku(t){if(vt){var e=Tn;if(e){var n=e;if(!$d(t,e)){if(_u(t))throw Error(G(418));e=Hr(n.nextSibling);var r=Pn;e&&$d(t,e)?sp(r,n):(t.flags=t.flags&-4097|2,vt=!1,Pn=t)}}else{if(_u(t))throw Error(G(418));t.flags=t.flags&-4097|2,vt=!1,Pn=t}}}function Md(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Pn=t}function Li(t){if(t!==Pn)return!1;if(!vt)return Md(t),vt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!xu(t.type,t.memoizedProps)),e&&(e=Tn)){if(_u(t))throw op(),Error(G(418));for(;e;)sp(t,e),e=Hr(e.nextSibling)}if(Md(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(G(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Tn=Hr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Tn=null}}else Tn=Pn?Hr(t.stateNode.nextSibling):null;return!0}function op(){for(var t=Tn;t;)t=Hr(t.nextSibling)}function oo(){Tn=Pn=null,vt=!1}function Ec(t){Xn===null?Xn=[t]:Xn.push(t)}var O0=Nr.ReactCurrentBatchConfig;function Eo(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(G(309));var r=n.stateNode}if(!r)throw Error(G(147,t));var s=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(i){var l=s.refs;i===null?delete l[o]:l[o]=i},e._stringRef=o,e)}if(typeof t!="string")throw Error(G(284));if(!n._owner)throw Error(G(290,t))}return t}function Ii(t,e){throw t=Object.prototype.toString.call(e),Error(G(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Bd(t){var e=t._init;return e(t._payload)}function ip(t){function e(y,f){if(t){var m=y.deletions;m===null?(y.deletions=[f],y.flags|=16):m.push(f)}}function n(y,f){if(!t)return null;for(;f!==null;)e(y,f),f=f.sibling;return null}function r(y,f){for(y=new Map;f!==null;)f.key!==null?y.set(f.key,f):y.set(f.index,f),f=f.sibling;return y}function s(y,f){return y=Qr(y,f),y.index=0,y.sibling=null,y}function o(y,f,m){return y.index=m,t?(m=y.alternate,m!==null?(m=m.index,m<f?(y.flags|=2,f):m):(y.flags|=2,f)):(y.flags|=1048576,f)}function i(y){return t&&y.alternate===null&&(y.flags|=2),y}function l(y,f,m,w){return f===null||f.tag!==6?(f=Ol(m,y.mode,w),f.return=y,f):(f=s(f,m),f.return=y,f)}function u(y,f,m,w){var _=m.type;return _===Us?d(y,f,m.props.children,w,m.key):f!==null&&(f.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===$r&&Bd(_)===f.type)?(w=s(f,m.props),w.ref=Eo(y,f,m),w.return=y,w):(w=aa(m.type,m.key,m.props,null,y.mode,w),w.ref=Eo(y,f,m),w.return=y,w)}function c(y,f,m,w){return f===null||f.tag!==4||f.stateNode.containerInfo!==m.containerInfo||f.stateNode.implementation!==m.implementation?(f=Tl(m,y.mode,w),f.return=y,f):(f=s(f,m.children||[]),f.return=y,f)}function d(y,f,m,w,_){return f===null||f.tag!==7?(f=bs(m,y.mode,w,_),f.return=y,f):(f=s(f,m),f.return=y,f)}function h(y,f,m){if(typeof f=="string"&&f!==""||typeof f=="number")return f=Ol(""+f,y.mode,m),f.return=y,f;if(typeof f=="object"&&f!==null){switch(f.$$typeof){case Ei:return m=aa(f.type,f.key,f.props,null,y.mode,m),m.ref=Eo(y,null,f),m.return=y,m;case Bs:return f=Tl(f,y.mode,m),f.return=y,f;case $r:var w=f._init;return h(y,w(f._payload),m)}if(Ao(f)||bo(f))return f=bs(f,y.mode,m,null),f.return=y,f;Ii(y,f)}return null}function p(y,f,m,w){var _=f!==null?f.key:null;if(typeof m=="string"&&m!==""||typeof m=="number")return _!==null?null:l(y,f,""+m,w);if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Ei:return m.key===_?u(y,f,m,w):null;case Bs:return m.key===_?c(y,f,m,w):null;case $r:return _=m._init,p(y,f,_(m._payload),w)}if(Ao(m)||bo(m))return _!==null?null:d(y,f,m,w,null);Ii(y,m)}return null}function g(y,f,m,w,_){if(typeof w=="string"&&w!==""||typeof w=="number")return y=y.get(m)||null,l(f,y,""+w,_);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ei:return y=y.get(w.key===null?m:w.key)||null,u(f,y,w,_);case Bs:return y=y.get(w.key===null?m:w.key)||null,c(f,y,w,_);case $r:var A=w._init;return g(y,f,m,A(w._payload),_)}if(Ao(w)||bo(w))return y=y.get(m)||null,d(f,y,w,_,null);Ii(f,w)}return null}function b(y,f,m,w){for(var _=null,A=null,D=f,k=f=0,R=null;D!==null&&k<m.length;k++){D.index>k?(R=D,D=null):R=D.sibling;var v=p(y,D,m[k],w);if(v===null){D===null&&(D=R);break}t&&D&&v.alternate===null&&e(y,D),f=o(v,f,k),A===null?_=v:A.sibling=v,A=v,D=R}if(k===m.length)return n(y,D),vt&&ds(y,k),_;if(D===null){for(;k<m.length;k++)D=h(y,m[k],w),D!==null&&(f=o(D,f,k),A===null?_=D:A.sibling=D,A=D);return vt&&ds(y,k),_}for(D=r(y,D);k<m.length;k++)R=g(D,y,k,m[k],w),R!==null&&(t&&R.alternate!==null&&D.delete(R.key===null?k:R.key),f=o(R,f,k),A===null?_=R:A.sibling=R,A=R);return t&&D.forEach(function(E){return e(y,E)}),vt&&ds(y,k),_}function x(y,f,m,w){var _=bo(m);if(typeof _!="function")throw Error(G(150));if(m=_.call(m),m==null)throw Error(G(151));for(var A=_=null,D=f,k=f=0,R=null,v=m.next();D!==null&&!v.done;k++,v=m.next()){D.index>k?(R=D,D=null):R=D.sibling;var E=p(y,D,v.value,w);if(E===null){D===null&&(D=R);break}t&&D&&E.alternate===null&&e(y,D),f=o(E,f,k),A===null?_=E:A.sibling=E,A=E,D=R}if(v.done)return n(y,D),vt&&ds(y,k),_;if(D===null){for(;!v.done;k++,v=m.next())v=h(y,v.value,w),v!==null&&(f=o(v,f,k),A===null?_=v:A.sibling=v,A=v);return vt&&ds(y,k),_}for(D=r(y,D);!v.done;k++,v=m.next())v=g(D,y,k,v.value,w),v!==null&&(t&&v.alternate!==null&&D.delete(v.key===null?k:v.key),f=o(v,f,k),A===null?_=v:A.sibling=v,A=v);return t&&D.forEach(function(T){return e(y,T)}),vt&&ds(y,k),_}function S(y,f,m,w){if(typeof m=="object"&&m!==null&&m.type===Us&&m.key===null&&(m=m.props.children),typeof m=="object"&&m!==null){switch(m.$$typeof){case Ei:e:{for(var _=m.key,A=f;A!==null;){if(A.key===_){if(_=m.type,_===Us){if(A.tag===7){n(y,A.sibling),f=s(A,m.props.children),f.return=y,y=f;break e}}else if(A.elementType===_||typeof _=="object"&&_!==null&&_.$$typeof===$r&&Bd(_)===A.type){n(y,A.sibling),f=s(A,m.props),f.ref=Eo(y,A,m),f.return=y,y=f;break e}n(y,A);break}else e(y,A);A=A.sibling}m.type===Us?(f=bs(m.props.children,y.mode,w,m.key),f.return=y,y=f):(w=aa(m.type,m.key,m.props,null,y.mode,w),w.ref=Eo(y,f,m),w.return=y,y=w)}return i(y);case Bs:e:{for(A=m.key;f!==null;){if(f.key===A)if(f.tag===4&&f.stateNode.containerInfo===m.containerInfo&&f.stateNode.implementation===m.implementation){n(y,f.sibling),f=s(f,m.children||[]),f.return=y,y=f;break e}else{n(y,f);break}else e(y,f);f=f.sibling}f=Tl(m,y.mode,w),f.return=y,y=f}return i(y);case $r:return A=m._init,S(y,f,A(m._payload),w)}if(Ao(m))return b(y,f,m,w);if(bo(m))return x(y,f,m,w);Ii(y,m)}return typeof m=="string"&&m!==""||typeof m=="number"?(m=""+m,f!==null&&f.tag===6?(n(y,f.sibling),f=s(f,m),f.return=y,y=f):(n(y,f),f=Ol(m,y.mode,w),f.return=y,y=f),i(y)):n(y,f)}return S}var io=ip(!0),ap=ip(!1),wa=ts(null),Sa=null,Ks=null,jc=null;function Cc(){jc=Ks=Sa=null}function Rc(t){var e=wa.current;mt(wa),t._currentValue=e}function Eu(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function to(t,e){Sa=t,jc=Ks=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(kn=!0),t.firstContext=null)}function Vn(t){var e=t._currentValue;if(jc!==t)if(t={context:t,memoizedValue:e,next:null},Ks===null){if(Sa===null)throw Error(G(308));Ks=t,Sa.dependencies={lanes:0,firstContext:t}}else Ks=Ks.next=t;return e}var gs=null;function Nc(t){gs===null?gs=[t]:gs.push(t)}function lp(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,Nc(e)):(n.next=s.next,s.next=n),e.interleaved=n,jr(t,r)}function jr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Mr=!1;function Dc(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function up(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function _r(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Kr(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ge&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,jr(t,n)}return s=r.interleaved,s===null?(e.next=e,Nc(r)):(e.next=s.next,s.next=e),r.interleaved=e,jr(t,n)}function ta(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,mc(t,n)}}function Ud(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?s=o=i:o=o.next=i,n=n.next}while(n!==null);o===null?s=o=e:o=o.next=e}else s=o=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function _a(t,e,n,r){var s=t.updateQueue;Mr=!1;var o=s.firstBaseUpdate,i=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,c=u.next;u.next=null,i===null?o=c:i.next=c,i=u;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==i&&(l===null?d.firstBaseUpdate=c:l.next=c,d.lastBaseUpdate=u))}if(o!==null){var h=s.baseState;i=0,d=c=u=null,l=o;do{var p=l.lane,g=l.eventTime;if((r&p)===p){d!==null&&(d=d.next={eventTime:g,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var b=t,x=l;switch(p=e,g=n,x.tag){case 1:if(b=x.payload,typeof b=="function"){h=b.call(g,h,p);break e}h=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=x.payload,p=typeof b=="function"?b.call(g,h,p):b,p==null)break e;h=wt({},h,p);break e;case 2:Mr=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,p=s.effects,p===null?s.effects=[l]:p.push(l))}else g={eventTime:g,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(c=d=g,u=h):d=d.next=g,i|=p;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;p=l,l=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(d===null&&(u=h),s.baseState=u,s.firstBaseUpdate=c,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do i|=s.lane,s=s.next;while(s!==e)}else o===null&&(s.shared.lanes=0);ks|=i,t.lanes=i,t.memoizedState=h}}function Fd(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(G(191,s));s.call(r)}}}var yi={},mr=ts(yi),oi=ts(yi),ii=ts(yi);function ys(t){if(t===yi)throw Error(G(174));return t}function Ac(t,e){switch(dt(ii,e),dt(oi,t),dt(mr,yi),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ou(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=ou(e,t)}mt(mr),dt(mr,e)}function ao(){mt(mr),mt(oi),mt(ii)}function cp(t){ys(ii.current);var e=ys(mr.current),n=ou(e,t.type);e!==n&&(dt(oi,t),dt(mr,n))}function Oc(t){oi.current===t&&(mt(mr),mt(oi))}var xt=ts(0);function ka(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var jl=[];function Tc(){for(var t=0;t<jl.length;t++)jl[t]._workInProgressVersionPrimary=null;jl.length=0}var na=Nr.ReactCurrentDispatcher,Cl=Nr.ReactCurrentBatchConfig,_s=0,bt=null,Bt=null,qt=null,Ea=!1,Uo=!1,ai=0,T0=0;function en(){throw Error(G(321))}function Pc(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!nr(t[n],e[n]))return!1;return!0}function Lc(t,e,n,r,s,o){if(_s=o,bt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,na.current=t===null||t.memoizedState===null?$0:M0,t=n(r,s),Uo){o=0;do{if(Uo=!1,ai=0,25<=o)throw Error(G(301));o+=1,qt=Bt=null,e.updateQueue=null,na.current=B0,t=n(r,s)}while(Uo)}if(na.current=ja,e=Bt!==null&&Bt.next!==null,_s=0,qt=Bt=bt=null,Ea=!1,e)throw Error(G(300));return t}function Ic(){var t=ai!==0;return ai=0,t}function lr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qt===null?bt.memoizedState=qt=t:qt=qt.next=t,qt}function Gn(){if(Bt===null){var t=bt.alternate;t=t!==null?t.memoizedState:null}else t=Bt.next;var e=qt===null?bt.memoizedState:qt.next;if(e!==null)qt=e,Bt=t;else{if(t===null)throw Error(G(310));Bt=t,t={memoizedState:Bt.memoizedState,baseState:Bt.baseState,baseQueue:Bt.baseQueue,queue:Bt.queue,next:null},qt===null?bt.memoizedState=qt=t:qt=qt.next=t}return qt}function li(t,e){return typeof e=="function"?e(t):e}function Rl(t){var e=Gn(),n=e.queue;if(n===null)throw Error(G(311));n.lastRenderedReducer=t;var r=Bt,s=r.baseQueue,o=n.pending;if(o!==null){if(s!==null){var i=s.next;s.next=o.next,o.next=i}r.baseQueue=s=o,n.pending=null}if(s!==null){o=s.next,r=r.baseState;var l=i=null,u=null,c=o;do{var d=c.lane;if((_s&d)===d)u!==null&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};u===null?(l=u=h,i=r):u=u.next=h,bt.lanes|=d,ks|=d}c=c.next}while(c!==null&&c!==o);u===null?i=r:u.next=l,nr(r,e.memoizedState)||(kn=!0),e.memoizedState=r,e.baseState=i,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do o=s.lane,bt.lanes|=o,ks|=o,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Nl(t){var e=Gn(),n=e.queue;if(n===null)throw Error(G(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,o=e.memoizedState;if(s!==null){n.pending=null;var i=s=s.next;do o=t(o,i.action),i=i.next;while(i!==s);nr(o,e.memoizedState)||(kn=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function dp(){}function fp(t,e){var n=bt,r=Gn(),s=e(),o=!nr(r.memoizedState,s);if(o&&(r.memoizedState=s,kn=!0),r=r.queue,$c(mp.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||qt!==null&&qt.memoizedState.tag&1){if(n.flags|=2048,ui(9,pp.bind(null,n,r,s,e),void 0,null),Ht===null)throw Error(G(349));_s&30||hp(n,e,s)}return s}function hp(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=bt.updateQueue,e===null?(e={lastEffect:null,stores:null},bt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function pp(t,e,n,r){e.value=n,e.getSnapshot=r,gp(e)&&yp(t)}function mp(t,e,n){return n(function(){gp(e)&&yp(t)})}function gp(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!nr(t,n)}catch{return!0}}function yp(t){var e=jr(t,1);e!==null&&tr(e,t,1,-1)}function zd(t){var e=lr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:li,lastRenderedState:t},e.queue=t,t=t.dispatch=I0.bind(null,bt,t),[e.memoizedState,t]}function ui(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=bt.updateQueue,e===null?(e={lastEffect:null,stores:null},bt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function vp(){return Gn().memoizedState}function ra(t,e,n,r){var s=lr();bt.flags|=t,s.memoizedState=ui(1|e,n,void 0,r===void 0?null:r)}function Va(t,e,n,r){var s=Gn();r=r===void 0?null:r;var o=void 0;if(Bt!==null){var i=Bt.memoizedState;if(o=i.destroy,r!==null&&Pc(r,i.deps)){s.memoizedState=ui(e,n,o,r);return}}bt.flags|=t,s.memoizedState=ui(1|e,n,o,r)}function Wd(t,e){return ra(8390656,8,t,e)}function $c(t,e){return Va(2048,8,t,e)}function xp(t,e){return Va(4,2,t,e)}function bp(t,e){return Va(4,4,t,e)}function wp(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Sp(t,e,n){return n=n!=null?n.concat([t]):null,Va(4,4,wp.bind(null,e,t),n)}function Mc(){}function _p(t,e){var n=Gn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Pc(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function kp(t,e){var n=Gn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Pc(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Ep(t,e,n){return _s&21?(nr(n,e)||(n=Dh(),bt.lanes|=n,ks|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,kn=!0),t.memoizedState=n)}function P0(t,e){var n=ot;ot=n!==0&&4>n?n:4,t(!0);var r=Cl.transition;Cl.transition={};try{t(!1),e()}finally{ot=n,Cl.transition=r}}function jp(){return Gn().memoizedState}function L0(t,e,n){var r=Yr(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Cp(t))Rp(e,n);else if(n=lp(t,e,n,r),n!==null){var s=fn();tr(n,t,r,s),Np(n,e,r)}}function I0(t,e,n){var r=Yr(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Cp(t))Rp(e,s);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var i=e.lastRenderedState,l=o(i,n);if(s.hasEagerState=!0,s.eagerState=l,nr(l,i)){var u=e.interleaved;u===null?(s.next=s,Nc(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=lp(t,e,s,r),n!==null&&(s=fn(),tr(n,t,r,s),Np(n,e,r))}}function Cp(t){var e=t.alternate;return t===bt||e!==null&&e===bt}function Rp(t,e){Uo=Ea=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Np(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,mc(t,n)}}var ja={readContext:Vn,useCallback:en,useContext:en,useEffect:en,useImperativeHandle:en,useInsertionEffect:en,useLayoutEffect:en,useMemo:en,useReducer:en,useRef:en,useState:en,useDebugValue:en,useDeferredValue:en,useTransition:en,useMutableSource:en,useSyncExternalStore:en,useId:en,unstable_isNewReconciler:!1},$0={readContext:Vn,useCallback:function(t,e){return lr().memoizedState=[t,e===void 0?null:e],t},useContext:Vn,useEffect:Wd,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,ra(4194308,4,wp.bind(null,e,t),n)},useLayoutEffect:function(t,e){return ra(4194308,4,t,e)},useInsertionEffect:function(t,e){return ra(4,2,t,e)},useMemo:function(t,e){var n=lr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=lr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=L0.bind(null,bt,t),[r.memoizedState,t]},useRef:function(t){var e=lr();return t={current:t},e.memoizedState=t},useState:zd,useDebugValue:Mc,useDeferredValue:function(t){return lr().memoizedState=t},useTransition:function(){var t=zd(!1),e=t[0];return t=P0.bind(null,t[1]),lr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=bt,s=lr();if(vt){if(n===void 0)throw Error(G(407));n=n()}else{if(n=e(),Ht===null)throw Error(G(349));_s&30||hp(r,e,n)}s.memoizedState=n;var o={value:n,getSnapshot:e};return s.queue=o,Wd(mp.bind(null,r,o,t),[t]),r.flags|=2048,ui(9,pp.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=lr(),e=Ht.identifierPrefix;if(vt){var n=wr,r=br;n=(r&~(1<<32-er(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=ai++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=T0++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},M0={readContext:Vn,useCallback:_p,useContext:Vn,useEffect:$c,useImperativeHandle:Sp,useInsertionEffect:xp,useLayoutEffect:bp,useMemo:kp,useReducer:Rl,useRef:vp,useState:function(){return Rl(li)},useDebugValue:Mc,useDeferredValue:function(t){var e=Gn();return Ep(e,Bt.memoizedState,t)},useTransition:function(){var t=Rl(li)[0],e=Gn().memoizedState;return[t,e]},useMutableSource:dp,useSyncExternalStore:fp,useId:jp,unstable_isNewReconciler:!1},B0={readContext:Vn,useCallback:_p,useContext:Vn,useEffect:$c,useImperativeHandle:Sp,useInsertionEffect:xp,useLayoutEffect:bp,useMemo:kp,useReducer:Nl,useRef:vp,useState:function(){return Nl(li)},useDebugValue:Mc,useDeferredValue:function(t){var e=Gn();return Bt===null?e.memoizedState=t:Ep(e,Bt.memoizedState,t)},useTransition:function(){var t=Nl(li)[0],e=Gn().memoizedState;return[t,e]},useMutableSource:dp,useSyncExternalStore:fp,useId:jp,unstable_isNewReconciler:!1};function Jn(t,e){if(t&&t.defaultProps){e=wt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function ju(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:wt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Ga={isMounted:function(t){return(t=t._reactInternals)?Rs(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=fn(),s=Yr(t),o=_r(r,s);o.payload=e,n!=null&&(o.callback=n),e=Kr(t,o,s),e!==null&&(tr(e,t,s,r),ta(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=fn(),s=Yr(t),o=_r(r,s);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=Kr(t,o,s),e!==null&&(tr(e,t,s,r),ta(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=fn(),r=Yr(t),s=_r(n,r);s.tag=2,e!=null&&(s.callback=e),e=Kr(t,s,r),e!==null&&(tr(e,t,r,n),ta(e,t,r))}};function Vd(t,e,n,r,s,o,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,i):e.prototype&&e.prototype.isPureReactComponent?!ti(n,r)||!ti(s,o):!0}function Dp(t,e,n){var r=!1,s=Zr,o=e.contextType;return typeof o=="object"&&o!==null?o=Vn(o):(s=jn(e)?ws:rn.current,r=e.contextTypes,o=(r=r!=null)?so(t,s):Zr),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Ga,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=o),e}function Gd(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Ga.enqueueReplaceState(e,e.state,null)}function Cu(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Dc(t);var o=e.contextType;typeof o=="object"&&o!==null?s.context=Vn(o):(o=jn(e)?ws:rn.current,s.context=so(t,o)),s.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(ju(t,e,o,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Ga.enqueueReplaceState(s,s.state,null),_a(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function lo(t,e){try{var n="",r=e;do n+=hg(r),r=r.return;while(r);var s=n}catch(o){s=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:s,digest:null}}function Dl(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Ru(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var U0=typeof WeakMap=="function"?WeakMap:Map;function Ap(t,e,n){n=_r(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Ra||(Ra=!0,Mu=r),Ru(t,e)},n}function Op(t,e,n){n=_r(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Ru(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){Ru(t,e),typeof r!="function"&&(Jr===null?Jr=new Set([this]):Jr.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),n}function qd(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new U0;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=ey.bind(null,t,e,n),e.then(t,t))}function Hd(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Kd(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=_r(-1,1),e.tag=2,Kr(n,e,1))),n.lanes|=1),t)}var F0=Nr.ReactCurrentOwner,kn=!1;function cn(t,e,n,r){e.child=t===null?ap(e,null,n,r):io(e,t.child,n,r)}function Jd(t,e,n,r,s){n=n.render;var o=e.ref;return to(e,s),r=Lc(t,e,n,r,o,s),n=Ic(),t!==null&&!kn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Cr(t,e,s)):(vt&&n&&_c(e),e.flags|=1,cn(t,e,r,s),e.child)}function Yd(t,e,n,r,s){if(t===null){var o=n.type;return typeof o=="function"&&!qc(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,Tp(t,e,o,r,s)):(t=aa(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&s)){var i=o.memoizedProps;if(n=n.compare,n=n!==null?n:ti,n(i,r)&&t.ref===e.ref)return Cr(t,e,s)}return e.flags|=1,t=Qr(o,r),t.ref=e.ref,t.return=e,e.child=t}function Tp(t,e,n,r,s){if(t!==null){var o=t.memoizedProps;if(ti(o,r)&&t.ref===e.ref)if(kn=!1,e.pendingProps=r=o,(t.lanes&s)!==0)t.flags&131072&&(kn=!0);else return e.lanes=t.lanes,Cr(t,e,s)}return Nu(t,e,n,r,s)}function Pp(t,e,n){var r=e.pendingProps,s=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},dt(Ys,On),On|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,dt(Ys,On),On|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,dt(Ys,On),On|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,dt(Ys,On),On|=r;return cn(t,e,s,n),e.child}function Lp(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Nu(t,e,n,r,s){var o=jn(n)?ws:rn.current;return o=so(e,o),to(e,s),n=Lc(t,e,n,r,o,s),r=Ic(),t!==null&&!kn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Cr(t,e,s)):(vt&&r&&_c(e),e.flags|=1,cn(t,e,n,s),e.child)}function Qd(t,e,n,r,s){if(jn(n)){var o=!0;va(e)}else o=!1;if(to(e,s),e.stateNode===null)sa(t,e),Dp(e,n,r),Cu(e,n,r,s),r=!0;else if(t===null){var i=e.stateNode,l=e.memoizedProps;i.props=l;var u=i.context,c=n.contextType;typeof c=="object"&&c!==null?c=Vn(c):(c=jn(n)?ws:rn.current,c=so(e,c));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";h||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==r||u!==c)&&Gd(e,i,r,c),Mr=!1;var p=e.memoizedState;i.state=p,_a(e,r,i,s),u=e.memoizedState,l!==r||p!==u||En.current||Mr?(typeof d=="function"&&(ju(e,n,d,r),u=e.memoizedState),(l=Mr||Vd(e,n,l,r,p,u,c))?(h||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),i.props=r,i.state=u,i.context=c,r=l):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{i=e.stateNode,up(t,e),l=e.memoizedProps,c=e.type===e.elementType?l:Jn(e.type,l),i.props=c,h=e.pendingProps,p=i.context,u=n.contextType,typeof u=="object"&&u!==null?u=Vn(u):(u=jn(n)?ws:rn.current,u=so(e,u));var g=n.getDerivedStateFromProps;(d=typeof g=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==h||p!==u)&&Gd(e,i,r,u),Mr=!1,p=e.memoizedState,i.state=p,_a(e,r,i,s);var b=e.memoizedState;l!==h||p!==b||En.current||Mr?(typeof g=="function"&&(ju(e,n,g,r),b=e.memoizedState),(c=Mr||Vd(e,n,c,r,p,b,u)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,b,u),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,b,u)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=b),i.props=r,i.state=b,i.context=u,r=c):(typeof i.componentDidUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return Du(t,e,n,r,o,s)}function Du(t,e,n,r,s,o){Lp(t,e);var i=(e.flags&128)!==0;if(!r&&!i)return s&&Id(e,n,!1),Cr(t,e,o);r=e.stateNode,F0.current=e;var l=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&i?(e.child=io(e,t.child,null,o),e.child=io(e,null,l,o)):cn(t,e,l,o),e.memoizedState=r.state,s&&Id(e,n,!0),e.child}function Ip(t){var e=t.stateNode;e.pendingContext?Ld(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Ld(t,e.context,!1),Ac(t,e.containerInfo)}function Xd(t,e,n,r,s){return oo(),Ec(s),e.flags|=256,cn(t,e,n,r),e.child}var Au={dehydrated:null,treeContext:null,retryLane:0};function Ou(t){return{baseLanes:t,cachePool:null,transitions:null}}function $p(t,e,n){var r=e.pendingProps,s=xt.current,o=!1,i=(e.flags&128)!==0,l;if((l=i)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),dt(xt,s&1),t===null)return ku(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=r.children,t=r.fallback,o?(r=e.mode,o=e.child,i={mode:"hidden",children:i},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=Ka(i,r,0,null),t=bs(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=Ou(n),e.memoizedState=Au,t):Bc(e,i));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return z0(t,e,i,r,l,s,n);if(o){o=r.fallback,i=e.mode,s=t.child,l=s.sibling;var u={mode:"hidden",children:r.children};return!(i&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Qr(s,u),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?o=Qr(l,o):(o=bs(o,i,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,i=t.child.memoizedState,i=i===null?Ou(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=t.childLanes&~n,e.memoizedState=Au,r}return o=t.child,t=o.sibling,r=Qr(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Bc(t,e){return e=Ka({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function $i(t,e,n,r){return r!==null&&Ec(r),io(e,t.child,null,n),t=Bc(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function z0(t,e,n,r,s,o,i){if(n)return e.flags&256?(e.flags&=-257,r=Dl(Error(G(422))),$i(t,e,i,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,s=e.mode,r=Ka({mode:"visible",children:r.children},s,0,null),o=bs(o,s,i,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&io(e,t.child,null,i),e.child.memoizedState=Ou(i),e.memoizedState=Au,o);if(!(e.mode&1))return $i(t,e,i,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,o=Error(G(419)),r=Dl(o,r,void 0),$i(t,e,i,r)}if(l=(i&t.childLanes)!==0,kn||l){if(r=Ht,r!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|i)?0:s,s!==0&&s!==o.retryLane&&(o.retryLane=s,jr(t,s),tr(r,t,s,-1))}return Gc(),r=Dl(Error(G(421))),$i(t,e,i,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=ty.bind(null,t),s._reactRetry=e,null):(t=o.treeContext,Tn=Hr(s.nextSibling),Pn=e,vt=!0,Xn=null,t!==null&&(Bn[Un++]=br,Bn[Un++]=wr,Bn[Un++]=Ss,br=t.id,wr=t.overflow,Ss=e),e=Bc(e,r.children),e.flags|=4096,e)}function Zd(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Eu(t.return,e,n)}function Al(t,e,n,r,s){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=s)}function Mp(t,e,n){var r=e.pendingProps,s=r.revealOrder,o=r.tail;if(cn(t,e,r.children,n),r=xt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Zd(t,n,e);else if(t.tag===19)Zd(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(dt(xt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&ka(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Al(e,!1,s,n,o);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&ka(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Al(e,!0,n,null,o);break;case"together":Al(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function sa(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Cr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ks|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(G(153));if(e.child!==null){for(t=e.child,n=Qr(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Qr(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function W0(t,e,n){switch(e.tag){case 3:Ip(e),oo();break;case 5:cp(e);break;case 1:jn(e.type)&&va(e);break;case 4:Ac(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;dt(wa,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(dt(xt,xt.current&1),e.flags|=128,null):n&e.child.childLanes?$p(t,e,n):(dt(xt,xt.current&1),t=Cr(t,e,n),t!==null?t.sibling:null);dt(xt,xt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Mp(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),dt(xt,xt.current),r)break;return null;case 22:case 23:return e.lanes=0,Pp(t,e,n)}return Cr(t,e,n)}var Bp,Tu,Up,Fp;Bp=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Tu=function(){};Up=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,ys(mr.current);var o=null;switch(n){case"input":s=tu(t,s),r=tu(t,r),o=[];break;case"select":s=wt({},s,{value:void 0}),r=wt({},r,{value:void 0}),o=[];break;case"textarea":s=su(t,s),r=su(t,r),o=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=ga)}iu(n,r);var i;n=null;for(c in s)if(!r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var l=s[c];for(i in l)l.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Ko.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in r){var u=r[c];if(l=s!=null?s[c]:void 0,r.hasOwnProperty(c)&&u!==l&&(u!=null||l!=null))if(c==="style")if(l){for(i in l)!l.hasOwnProperty(i)||u&&u.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in u)u.hasOwnProperty(i)&&l[i]!==u[i]&&(n||(n={}),n[i]=u[i])}else n||(o||(o=[]),o.push(c,n)),n=u;else c==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(o=o||[]).push(c,u)):c==="children"?typeof u!="string"&&typeof u!="number"||(o=o||[]).push(c,""+u):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Ko.hasOwnProperty(c)?(u!=null&&c==="onScroll"&&pt("scroll",t),o||l===u||(o=[])):(o=o||[]).push(c,u))}n&&(o=o||[]).push("style",n);var c=o;(e.updateQueue=c)&&(e.flags|=4)}};Fp=function(t,e,n,r){n!==r&&(e.flags|=4)};function jo(t,e){if(!vt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function tn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function V0(t,e,n){var r=e.pendingProps;switch(kc(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return tn(e),null;case 1:return jn(e.type)&&ya(),tn(e),null;case 3:return r=e.stateNode,ao(),mt(En),mt(rn),Tc(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Li(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Xn!==null&&(Fu(Xn),Xn=null))),Tu(t,e),tn(e),null;case 5:Oc(e);var s=ys(ii.current);if(n=e.type,t!==null&&e.stateNode!=null)Up(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(G(166));return tn(e),null}if(t=ys(mr.current),Li(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[fr]=e,r[si]=o,t=(e.mode&1)!==0,n){case"dialog":pt("cancel",r),pt("close",r);break;case"iframe":case"object":case"embed":pt("load",r);break;case"video":case"audio":for(s=0;s<To.length;s++)pt(To[s],r);break;case"source":pt("error",r);break;case"img":case"image":case"link":pt("error",r),pt("load",r);break;case"details":pt("toggle",r);break;case"input":ld(r,o),pt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},pt("invalid",r);break;case"textarea":cd(r,o),pt("invalid",r)}iu(n,o),s=null;for(var i in o)if(o.hasOwnProperty(i)){var l=o[i];i==="children"?typeof l=="string"?r.textContent!==l&&(o.suppressHydrationWarning!==!0&&Pi(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(o.suppressHydrationWarning!==!0&&Pi(r.textContent,l,t),s=["children",""+l]):Ko.hasOwnProperty(i)&&l!=null&&i==="onScroll"&&pt("scroll",r)}switch(n){case"input":ji(r),ud(r,o,!0);break;case"textarea":ji(r),dd(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=ga)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=mh(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=i.createElement(n,{is:r.is}):(t=i.createElement(n),n==="select"&&(i=t,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):t=i.createElementNS(t,n),t[fr]=e,t[si]=r,Bp(t,e,!1,!1),e.stateNode=t;e:{switch(i=au(n,r),n){case"dialog":pt("cancel",t),pt("close",t),s=r;break;case"iframe":case"object":case"embed":pt("load",t),s=r;break;case"video":case"audio":for(s=0;s<To.length;s++)pt(To[s],t);s=r;break;case"source":pt("error",t),s=r;break;case"img":case"image":case"link":pt("error",t),pt("load",t),s=r;break;case"details":pt("toggle",t),s=r;break;case"input":ld(t,r),s=tu(t,r),pt("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=wt({},r,{value:void 0}),pt("invalid",t);break;case"textarea":cd(t,r),s=su(t,r),pt("invalid",t);break;default:s=r}iu(n,s),l=s;for(o in l)if(l.hasOwnProperty(o)){var u=l[o];o==="style"?vh(t,u):o==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&gh(t,u)):o==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&Jo(t,u):typeof u=="number"&&Jo(t,""+u):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Ko.hasOwnProperty(o)?u!=null&&o==="onScroll"&&pt("scroll",t):u!=null&&uc(t,o,u,i))}switch(n){case"input":ji(t),ud(t,r,!1);break;case"textarea":ji(t),dd(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Xr(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?Qs(t,!!r.multiple,o,!1):r.defaultValue!=null&&Qs(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=ga)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return tn(e),null;case 6:if(t&&e.stateNode!=null)Fp(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(G(166));if(n=ys(ii.current),ys(mr.current),Li(e)){if(r=e.stateNode,n=e.memoizedProps,r[fr]=e,(o=r.nodeValue!==n)&&(t=Pn,t!==null))switch(t.tag){case 3:Pi(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Pi(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[fr]=e,e.stateNode=r}return tn(e),null;case 13:if(mt(xt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(vt&&Tn!==null&&e.mode&1&&!(e.flags&128))op(),oo(),e.flags|=98560,o=!1;else if(o=Li(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(G(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(G(317));o[fr]=e}else oo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;tn(e),o=!1}else Xn!==null&&(Fu(Xn),Xn=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||xt.current&1?Ut===0&&(Ut=3):Gc())),e.updateQueue!==null&&(e.flags|=4),tn(e),null);case 4:return ao(),Tu(t,e),t===null&&ni(e.stateNode.containerInfo),tn(e),null;case 10:return Rc(e.type._context),tn(e),null;case 17:return jn(e.type)&&ya(),tn(e),null;case 19:if(mt(xt),o=e.memoizedState,o===null)return tn(e),null;if(r=(e.flags&128)!==0,i=o.rendering,i===null)if(r)jo(o,!1);else{if(Ut!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=ka(t),i!==null){for(e.flags|=128,jo(o,!1),r=i.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,t=i.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return dt(xt,xt.current&1|2),e.child}t=t.sibling}o.tail!==null&&jt()>uo&&(e.flags|=128,r=!0,jo(o,!1),e.lanes=4194304)}else{if(!r)if(t=ka(i),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),jo(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!vt)return tn(e),null}else 2*jt()-o.renderingStartTime>uo&&n!==1073741824&&(e.flags|=128,r=!0,jo(o,!1),e.lanes=4194304);o.isBackwards?(i.sibling=e.child,e.child=i):(n=o.last,n!==null?n.sibling=i:e.child=i,o.last=i)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=jt(),e.sibling=null,n=xt.current,dt(xt,r?n&1|2:n&1),e):(tn(e),null);case 22:case 23:return Vc(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?On&1073741824&&(tn(e),e.subtreeFlags&6&&(e.flags|=8192)):tn(e),null;case 24:return null;case 25:return null}throw Error(G(156,e.tag))}function G0(t,e){switch(kc(e),e.tag){case 1:return jn(e.type)&&ya(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ao(),mt(En),mt(rn),Tc(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Oc(e),null;case 13:if(mt(xt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(G(340));oo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return mt(xt),null;case 4:return ao(),null;case 10:return Rc(e.type._context),null;case 22:case 23:return Vc(),null;case 24:return null;default:return null}}var Mi=!1,nn=!1,q0=typeof WeakSet=="function"?WeakSet:Set,ie=null;function Js(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){kt(t,e,r)}else n.current=null}function Pu(t,e,n){try{n()}catch(r){kt(t,e,r)}}var ef=!1;function H0(t,e){if(yu=ha,t=qh(),Sc(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var i=0,l=-1,u=-1,c=0,d=0,h=t,p=null;t:for(;;){for(var g;h!==n||s!==0&&h.nodeType!==3||(l=i+s),h!==o||r!==0&&h.nodeType!==3||(u=i+r),h.nodeType===3&&(i+=h.nodeValue.length),(g=h.firstChild)!==null;)p=h,h=g;for(;;){if(h===t)break t;if(p===n&&++c===s&&(l=i),p===o&&++d===r&&(u=i),(g=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=g}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(vu={focusedElem:t,selectionRange:n},ha=!1,ie=e;ie!==null;)if(e=ie,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ie=t;else for(;ie!==null;){e=ie;try{var b=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var x=b.memoizedProps,S=b.memoizedState,y=e.stateNode,f=y.getSnapshotBeforeUpdate(e.elementType===e.type?x:Jn(e.type,x),S);y.__reactInternalSnapshotBeforeUpdate=f}break;case 3:var m=e.stateNode.containerInfo;m.nodeType===1?m.textContent="":m.nodeType===9&&m.documentElement&&m.removeChild(m.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(G(163))}}catch(w){kt(e,e.return,w)}if(t=e.sibling,t!==null){t.return=e.return,ie=t;break}ie=e.return}return b=ef,ef=!1,b}function Fo(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var o=s.destroy;s.destroy=void 0,o!==void 0&&Pu(e,n,o)}s=s.next}while(s!==r)}}function qa(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Lu(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function zp(t){var e=t.alternate;e!==null&&(t.alternate=null,zp(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[fr],delete e[si],delete e[wu],delete e[N0],delete e[D0])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Wp(t){return t.tag===5||t.tag===3||t.tag===4}function tf(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Wp(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Iu(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=ga));else if(r!==4&&(t=t.child,t!==null))for(Iu(t,e,n),t=t.sibling;t!==null;)Iu(t,e,n),t=t.sibling}function $u(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for($u(t,e,n),t=t.sibling;t!==null;)$u(t,e,n),t=t.sibling}var Kt=null,Yn=!1;function Tr(t,e,n){for(n=n.child;n!==null;)Vp(t,e,n),n=n.sibling}function Vp(t,e,n){if(pr&&typeof pr.onCommitFiberUnmount=="function")try{pr.onCommitFiberUnmount(Ma,n)}catch{}switch(n.tag){case 5:nn||Js(n,e);case 6:var r=Kt,s=Yn;Kt=null,Tr(t,e,n),Kt=r,Yn=s,Kt!==null&&(Yn?(t=Kt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Kt.removeChild(n.stateNode));break;case 18:Kt!==null&&(Yn?(t=Kt,n=n.stateNode,t.nodeType===8?kl(t.parentNode,n):t.nodeType===1&&kl(t,n),Zo(t)):kl(Kt,n.stateNode));break;case 4:r=Kt,s=Yn,Kt=n.stateNode.containerInfo,Yn=!0,Tr(t,e,n),Kt=r,Yn=s;break;case 0:case 11:case 14:case 15:if(!nn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var o=s,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&Pu(n,e,i),s=s.next}while(s!==r)}Tr(t,e,n);break;case 1:if(!nn&&(Js(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){kt(n,e,l)}Tr(t,e,n);break;case 21:Tr(t,e,n);break;case 22:n.mode&1?(nn=(r=nn)||n.memoizedState!==null,Tr(t,e,n),nn=r):Tr(t,e,n);break;default:Tr(t,e,n)}}function nf(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new q0),e.forEach(function(r){var s=ny.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Hn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var o=t,i=e,l=i;e:for(;l!==null;){switch(l.tag){case 5:Kt=l.stateNode,Yn=!1;break e;case 3:Kt=l.stateNode.containerInfo,Yn=!0;break e;case 4:Kt=l.stateNode.containerInfo,Yn=!0;break e}l=l.return}if(Kt===null)throw Error(G(160));Vp(o,i,s),Kt=null,Yn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(c){kt(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Gp(e,t),e=e.sibling}function Gp(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Hn(e,t),ir(t),r&4){try{Fo(3,t,t.return),qa(3,t)}catch(x){kt(t,t.return,x)}try{Fo(5,t,t.return)}catch(x){kt(t,t.return,x)}}break;case 1:Hn(e,t),ir(t),r&512&&n!==null&&Js(n,n.return);break;case 5:if(Hn(e,t),ir(t),r&512&&n!==null&&Js(n,n.return),t.flags&32){var s=t.stateNode;try{Jo(s,"")}catch(x){kt(t,t.return,x)}}if(r&4&&(s=t.stateNode,s!=null)){var o=t.memoizedProps,i=n!==null?n.memoizedProps:o,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&o.type==="radio"&&o.name!=null&&hh(s,o),au(l,i);var c=au(l,o);for(i=0;i<u.length;i+=2){var d=u[i],h=u[i+1];d==="style"?vh(s,h):d==="dangerouslySetInnerHTML"?gh(s,h):d==="children"?Jo(s,h):uc(s,d,h,c)}switch(l){case"input":nu(s,o);break;case"textarea":ph(s,o);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!o.multiple;var g=o.value;g!=null?Qs(s,!!o.multiple,g,!1):p!==!!o.multiple&&(o.defaultValue!=null?Qs(s,!!o.multiple,o.defaultValue,!0):Qs(s,!!o.multiple,o.multiple?[]:"",!1))}s[si]=o}catch(x){kt(t,t.return,x)}}break;case 6:if(Hn(e,t),ir(t),r&4){if(t.stateNode===null)throw Error(G(162));s=t.stateNode,o=t.memoizedProps;try{s.nodeValue=o}catch(x){kt(t,t.return,x)}}break;case 3:if(Hn(e,t),ir(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Zo(e.containerInfo)}catch(x){kt(t,t.return,x)}break;case 4:Hn(e,t),ir(t);break;case 13:Hn(e,t),ir(t),s=t.child,s.flags&8192&&(o=s.memoizedState!==null,s.stateNode.isHidden=o,!o||s.alternate!==null&&s.alternate.memoizedState!==null||(zc=jt())),r&4&&nf(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(nn=(c=nn)||d,Hn(e,t),nn=c):Hn(e,t),ir(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!d&&t.mode&1)for(ie=t,d=t.child;d!==null;){for(h=ie=d;ie!==null;){switch(p=ie,g=p.child,p.tag){case 0:case 11:case 14:case 15:Fo(4,p,p.return);break;case 1:Js(p,p.return);var b=p.stateNode;if(typeof b.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,b.props=e.memoizedProps,b.state=e.memoizedState,b.componentWillUnmount()}catch(x){kt(r,n,x)}}break;case 5:Js(p,p.return);break;case 22:if(p.memoizedState!==null){sf(h);continue}}g!==null?(g.return=p,ie=g):sf(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,c?(o=s.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(l=h.stateNode,u=h.memoizedProps.style,i=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=yh("display",i))}catch(x){kt(t,t.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(x){kt(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Hn(e,t),ir(t),r&4&&nf(t);break;case 21:break;default:Hn(e,t),ir(t)}}function ir(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Wp(n)){var r=n;break e}n=n.return}throw Error(G(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Jo(s,""),r.flags&=-33);var o=tf(t);$u(t,o,s);break;case 3:case 4:var i=r.stateNode.containerInfo,l=tf(t);Iu(t,l,i);break;default:throw Error(G(161))}}catch(u){kt(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function K0(t,e,n){ie=t,qp(t)}function qp(t,e,n){for(var r=(t.mode&1)!==0;ie!==null;){var s=ie,o=s.child;if(s.tag===22&&r){var i=s.memoizedState!==null||Mi;if(!i){var l=s.alternate,u=l!==null&&l.memoizedState!==null||nn;l=Mi;var c=nn;if(Mi=i,(nn=u)&&!c)for(ie=s;ie!==null;)i=ie,u=i.child,i.tag===22&&i.memoizedState!==null?of(s):u!==null?(u.return=i,ie=u):of(s);for(;o!==null;)ie=o,qp(o),o=o.sibling;ie=s,Mi=l,nn=c}rf(t)}else s.subtreeFlags&8772&&o!==null?(o.return=s,ie=o):rf(t)}}function rf(t){for(;ie!==null;){var e=ie;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:nn||qa(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!nn)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Jn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&Fd(e,o,r);break;case 3:var i=e.updateQueue;if(i!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Fd(e,i,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Zo(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(G(163))}nn||e.flags&512&&Lu(e)}catch(p){kt(e,e.return,p)}}if(e===t){ie=null;break}if(n=e.sibling,n!==null){n.return=e.return,ie=n;break}ie=e.return}}function sf(t){for(;ie!==null;){var e=ie;if(e===t){ie=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ie=n;break}ie=e.return}}function of(t){for(;ie!==null;){var e=ie;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{qa(4,e)}catch(u){kt(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){kt(e,s,u)}}var o=e.return;try{Lu(e)}catch(u){kt(e,o,u)}break;case 5:var i=e.return;try{Lu(e)}catch(u){kt(e,i,u)}}}catch(u){kt(e,e.return,u)}if(e===t){ie=null;break}var l=e.sibling;if(l!==null){l.return=e.return,ie=l;break}ie=e.return}}var J0=Math.ceil,Ca=Nr.ReactCurrentDispatcher,Uc=Nr.ReactCurrentOwner,zn=Nr.ReactCurrentBatchConfig,Ge=0,Ht=null,Ot=null,Jt=0,On=0,Ys=ts(0),Ut=0,ci=null,ks=0,Ha=0,Fc=0,zo=null,Sn=null,zc=0,uo=1/0,yr=null,Ra=!1,Mu=null,Jr=null,Bi=!1,Wr=null,Na=0,Wo=0,Bu=null,oa=-1,ia=0;function fn(){return Ge&6?jt():oa!==-1?oa:oa=jt()}function Yr(t){return t.mode&1?Ge&2&&Jt!==0?Jt&-Jt:O0.transition!==null?(ia===0&&(ia=Dh()),ia):(t=ot,t!==0||(t=window.event,t=t===void 0?16:$h(t.type)),t):1}function tr(t,e,n,r){if(50<Wo)throw Wo=0,Bu=null,Error(G(185));pi(t,n,r),(!(Ge&2)||t!==Ht)&&(t===Ht&&(!(Ge&2)&&(Ha|=n),Ut===4&&Ur(t,Jt)),Cn(t,r),n===1&&Ge===0&&!(e.mode&1)&&(uo=jt()+500,Wa&&ns()))}function Cn(t,e){var n=t.callbackNode;Og(t,e);var r=fa(t,t===Ht?Jt:0);if(r===0)n!==null&&pd(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&pd(n),e===1)t.tag===0?A0(af.bind(null,t)):np(af.bind(null,t)),C0(function(){!(Ge&6)&&ns()}),n=null;else{switch(Ah(r)){case 1:n=pc;break;case 4:n=Rh;break;case 16:n=da;break;case 536870912:n=Nh;break;default:n=da}n=em(n,Hp.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Hp(t,e){if(oa=-1,ia=0,Ge&6)throw Error(G(327));var n=t.callbackNode;if(no()&&t.callbackNode!==n)return null;var r=fa(t,t===Ht?Jt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Da(t,r);else{e=r;var s=Ge;Ge|=2;var o=Jp();(Ht!==t||Jt!==e)&&(yr=null,uo=jt()+500,xs(t,e));do try{X0();break}catch(l){Kp(t,l)}while(!0);Cc(),Ca.current=o,Ge=s,Ot!==null?e=0:(Ht=null,Jt=0,e=Ut)}if(e!==0){if(e===2&&(s=fu(t),s!==0&&(r=s,e=Uu(t,s))),e===1)throw n=ci,xs(t,0),Ur(t,r),Cn(t,jt()),n;if(e===6)Ur(t,r);else{if(s=t.current.alternate,!(r&30)&&!Y0(s)&&(e=Da(t,r),e===2&&(o=fu(t),o!==0&&(r=o,e=Uu(t,o))),e===1))throw n=ci,xs(t,0),Ur(t,r),Cn(t,jt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(G(345));case 2:fs(t,Sn,yr);break;case 3:if(Ur(t,r),(r&130023424)===r&&(e=zc+500-jt(),10<e)){if(fa(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){fn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=bu(fs.bind(null,t,Sn,yr),e);break}fs(t,Sn,yr);break;case 4:if(Ur(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var i=31-er(r);o=1<<i,i=e[i],i>s&&(s=i),r&=~o}if(r=s,r=jt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*J0(r/1960))-r,10<r){t.timeoutHandle=bu(fs.bind(null,t,Sn,yr),r);break}fs(t,Sn,yr);break;case 5:fs(t,Sn,yr);break;default:throw Error(G(329))}}}return Cn(t,jt()),t.callbackNode===n?Hp.bind(null,t):null}function Uu(t,e){var n=zo;return t.current.memoizedState.isDehydrated&&(xs(t,e).flags|=256),t=Da(t,e),t!==2&&(e=Sn,Sn=n,e!==null&&Fu(e)),t}function Fu(t){Sn===null?Sn=t:Sn.push.apply(Sn,t)}function Y0(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],o=s.getSnapshot;s=s.value;try{if(!nr(o(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ur(t,e){for(e&=~Fc,e&=~Ha,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-er(e),r=1<<n;t[n]=-1,e&=~r}}function af(t){if(Ge&6)throw Error(G(327));no();var e=fa(t,0);if(!(e&1))return Cn(t,jt()),null;var n=Da(t,e);if(t.tag!==0&&n===2){var r=fu(t);r!==0&&(e=r,n=Uu(t,r))}if(n===1)throw n=ci,xs(t,0),Ur(t,e),Cn(t,jt()),n;if(n===6)throw Error(G(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,fs(t,Sn,yr),Cn(t,jt()),null}function Wc(t,e){var n=Ge;Ge|=1;try{return t(e)}finally{Ge=n,Ge===0&&(uo=jt()+500,Wa&&ns())}}function Es(t){Wr!==null&&Wr.tag===0&&!(Ge&6)&&no();var e=Ge;Ge|=1;var n=zn.transition,r=ot;try{if(zn.transition=null,ot=1,t)return t()}finally{ot=r,zn.transition=n,Ge=e,!(Ge&6)&&ns()}}function Vc(){On=Ys.current,mt(Ys)}function xs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,j0(n)),Ot!==null)for(n=Ot.return;n!==null;){var r=n;switch(kc(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ya();break;case 3:ao(),mt(En),mt(rn),Tc();break;case 5:Oc(r);break;case 4:ao();break;case 13:mt(xt);break;case 19:mt(xt);break;case 10:Rc(r.type._context);break;case 22:case 23:Vc()}n=n.return}if(Ht=t,Ot=t=Qr(t.current,null),Jt=On=e,Ut=0,ci=null,Fc=Ha=ks=0,Sn=zo=null,gs!==null){for(e=0;e<gs.length;e++)if(n=gs[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,o=n.pending;if(o!==null){var i=o.next;o.next=s,r.next=i}n.pending=r}gs=null}return t}function Kp(t,e){do{var n=Ot;try{if(Cc(),na.current=ja,Ea){for(var r=bt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Ea=!1}if(_s=0,qt=Bt=bt=null,Uo=!1,ai=0,Uc.current=null,n===null||n.return===null){Ut=1,ci=e,Ot=null;break}e:{var o=t,i=n.return,l=n,u=e;if(e=Jt,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var c=u,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var g=Hd(i);if(g!==null){g.flags&=-257,Kd(g,i,l,o,e),g.mode&1&&qd(o,c,e),e=g,u=c;var b=e.updateQueue;if(b===null){var x=new Set;x.add(u),e.updateQueue=x}else b.add(u);break e}else{if(!(e&1)){qd(o,c,e),Gc();break e}u=Error(G(426))}}else if(vt&&l.mode&1){var S=Hd(i);if(S!==null){!(S.flags&65536)&&(S.flags|=256),Kd(S,i,l,o,e),Ec(lo(u,l));break e}}o=u=lo(u,l),Ut!==4&&(Ut=2),zo===null?zo=[o]:zo.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var y=Ap(o,u,e);Ud(o,y);break e;case 1:l=u;var f=o.type,m=o.stateNode;if(!(o.flags&128)&&(typeof f.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Jr===null||!Jr.has(m)))){o.flags|=65536,e&=-e,o.lanes|=e;var w=Op(o,l,e);Ud(o,w);break e}}o=o.return}while(o!==null)}Qp(n)}catch(_){e=_,Ot===n&&n!==null&&(Ot=n=n.return);continue}break}while(!0)}function Jp(){var t=Ca.current;return Ca.current=ja,t===null?ja:t}function Gc(){(Ut===0||Ut===3||Ut===2)&&(Ut=4),Ht===null||!(ks&268435455)&&!(Ha&268435455)||Ur(Ht,Jt)}function Da(t,e){var n=Ge;Ge|=2;var r=Jp();(Ht!==t||Jt!==e)&&(yr=null,xs(t,e));do try{Q0();break}catch(s){Kp(t,s)}while(!0);if(Cc(),Ge=n,Ca.current=r,Ot!==null)throw Error(G(261));return Ht=null,Jt=0,Ut}function Q0(){for(;Ot!==null;)Yp(Ot)}function X0(){for(;Ot!==null&&!_g();)Yp(Ot)}function Yp(t){var e=Zp(t.alternate,t,On);t.memoizedProps=t.pendingProps,e===null?Qp(t):Ot=e,Uc.current=null}function Qp(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=G0(n,e),n!==null){n.flags&=32767,Ot=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ut=6,Ot=null;return}}else if(n=V0(n,e,On),n!==null){Ot=n;return}if(e=e.sibling,e!==null){Ot=e;return}Ot=e=t}while(e!==null);Ut===0&&(Ut=5)}function fs(t,e,n){var r=ot,s=zn.transition;try{zn.transition=null,ot=1,Z0(t,e,n,r)}finally{zn.transition=s,ot=r}return null}function Z0(t,e,n,r){do no();while(Wr!==null);if(Ge&6)throw Error(G(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(G(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(Tg(t,o),t===Ht&&(Ot=Ht=null,Jt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Bi||(Bi=!0,em(da,function(){return no(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=zn.transition,zn.transition=null;var i=ot;ot=1;var l=Ge;Ge|=4,Uc.current=null,H0(t,n),Gp(n,t),x0(vu),ha=!!yu,vu=yu=null,t.current=n,K0(n),kg(),Ge=l,ot=i,zn.transition=o}else t.current=n;if(Bi&&(Bi=!1,Wr=t,Na=s),o=t.pendingLanes,o===0&&(Jr=null),Cg(n.stateNode),Cn(t,jt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Ra)throw Ra=!1,t=Mu,Mu=null,t;return Na&1&&t.tag!==0&&no(),o=t.pendingLanes,o&1?t===Bu?Wo++:(Wo=0,Bu=t):Wo=0,ns(),null}function no(){if(Wr!==null){var t=Ah(Na),e=zn.transition,n=ot;try{if(zn.transition=null,ot=16>t?16:t,Wr===null)var r=!1;else{if(t=Wr,Wr=null,Na=0,Ge&6)throw Error(G(331));var s=Ge;for(Ge|=4,ie=t.current;ie!==null;){var o=ie,i=o.child;if(ie.flags&16){var l=o.deletions;if(l!==null){for(var u=0;u<l.length;u++){var c=l[u];for(ie=c;ie!==null;){var d=ie;switch(d.tag){case 0:case 11:case 15:Fo(8,d,o)}var h=d.child;if(h!==null)h.return=d,ie=h;else for(;ie!==null;){d=ie;var p=d.sibling,g=d.return;if(zp(d),d===c){ie=null;break}if(p!==null){p.return=g,ie=p;break}ie=g}}}var b=o.alternate;if(b!==null){var x=b.child;if(x!==null){b.child=null;do{var S=x.sibling;x.sibling=null,x=S}while(x!==null)}}ie=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,ie=i;else e:for(;ie!==null;){if(o=ie,o.flags&2048)switch(o.tag){case 0:case 11:case 15:Fo(9,o,o.return)}var y=o.sibling;if(y!==null){y.return=o.return,ie=y;break e}ie=o.return}}var f=t.current;for(ie=f;ie!==null;){i=ie;var m=i.child;if(i.subtreeFlags&2064&&m!==null)m.return=i,ie=m;else e:for(i=f;ie!==null;){if(l=ie,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:qa(9,l)}}catch(_){kt(l,l.return,_)}if(l===i){ie=null;break e}var w=l.sibling;if(w!==null){w.return=l.return,ie=w;break e}ie=l.return}}if(Ge=s,ns(),pr&&typeof pr.onPostCommitFiberRoot=="function")try{pr.onPostCommitFiberRoot(Ma,t)}catch{}r=!0}return r}finally{ot=n,zn.transition=e}}return!1}function lf(t,e,n){e=lo(n,e),e=Ap(t,e,1),t=Kr(t,e,1),e=fn(),t!==null&&(pi(t,1,e),Cn(t,e))}function kt(t,e,n){if(t.tag===3)lf(t,t,n);else for(;e!==null;){if(e.tag===3){lf(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Jr===null||!Jr.has(r))){t=lo(n,t),t=Op(e,t,1),e=Kr(e,t,1),t=fn(),e!==null&&(pi(e,1,t),Cn(e,t));break}}e=e.return}}function ey(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=fn(),t.pingedLanes|=t.suspendedLanes&n,Ht===t&&(Jt&n)===n&&(Ut===4||Ut===3&&(Jt&130023424)===Jt&&500>jt()-zc?xs(t,0):Fc|=n),Cn(t,e)}function Xp(t,e){e===0&&(t.mode&1?(e=Ni,Ni<<=1,!(Ni&130023424)&&(Ni=4194304)):e=1);var n=fn();t=jr(t,e),t!==null&&(pi(t,e,n),Cn(t,n))}function ty(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Xp(t,n)}function ny(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(G(314))}r!==null&&r.delete(e),Xp(t,n)}var Zp;Zp=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||En.current)kn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return kn=!1,W0(t,e,n);kn=!!(t.flags&131072)}else kn=!1,vt&&e.flags&1048576&&rp(e,ba,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;sa(t,e),t=e.pendingProps;var s=so(e,rn.current);to(e,n),s=Lc(null,e,r,t,s,n);var o=Ic();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,jn(r)?(o=!0,va(e)):o=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Dc(e),s.updater=Ga,e.stateNode=s,s._reactInternals=e,Cu(e,r,t,n),e=Du(null,e,r,!0,o,n)):(e.tag=0,vt&&o&&_c(e),cn(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(sa(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=sy(r),t=Jn(r,t),s){case 0:e=Nu(null,e,r,t,n);break e;case 1:e=Qd(null,e,r,t,n);break e;case 11:e=Jd(null,e,r,t,n);break e;case 14:e=Yd(null,e,r,Jn(r.type,t),n);break e}throw Error(G(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Jn(r,s),Nu(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Jn(r,s),Qd(t,e,r,s,n);case 3:e:{if(Ip(e),t===null)throw Error(G(387));r=e.pendingProps,o=e.memoizedState,s=o.element,up(t,e),_a(e,r,null,n);var i=e.memoizedState;if(r=i.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){s=lo(Error(G(423)),e),e=Xd(t,e,r,n,s);break e}else if(r!==s){s=lo(Error(G(424)),e),e=Xd(t,e,r,n,s);break e}else for(Tn=Hr(e.stateNode.containerInfo.firstChild),Pn=e,vt=!0,Xn=null,n=ap(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(oo(),r===s){e=Cr(t,e,n);break e}cn(t,e,r,n)}e=e.child}return e;case 5:return cp(e),t===null&&ku(e),r=e.type,s=e.pendingProps,o=t!==null?t.memoizedProps:null,i=s.children,xu(r,s)?i=null:o!==null&&xu(r,o)&&(e.flags|=32),Lp(t,e),cn(t,e,i,n),e.child;case 6:return t===null&&ku(e),null;case 13:return $p(t,e,n);case 4:return Ac(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=io(e,null,r,n):cn(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Jn(r,s),Jd(t,e,r,s,n);case 7:return cn(t,e,e.pendingProps,n),e.child;case 8:return cn(t,e,e.pendingProps.children,n),e.child;case 12:return cn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,o=e.memoizedProps,i=s.value,dt(wa,r._currentValue),r._currentValue=i,o!==null)if(nr(o.value,i)){if(o.children===s.children&&!En.current){e=Cr(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var l=o.dependencies;if(l!==null){i=o.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(o.tag===1){u=_r(-1,n&-n),u.tag=2;var c=o.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?u.next=u:(u.next=d.next,d.next=u),c.pending=u}}o.lanes|=n,u=o.alternate,u!==null&&(u.lanes|=n),Eu(o.return,n,e),l.lanes|=n;break}u=u.next}}else if(o.tag===10)i=o.type===e.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(G(341));i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),Eu(i,n,e),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===e){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}cn(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,to(e,n),s=Vn(s),r=r(s),e.flags|=1,cn(t,e,r,n),e.child;case 14:return r=e.type,s=Jn(r,e.pendingProps),s=Jn(r.type,s),Yd(t,e,r,s,n);case 15:return Tp(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Jn(r,s),sa(t,e),e.tag=1,jn(r)?(t=!0,va(e)):t=!1,to(e,n),Dp(e,r,s),Cu(e,r,s,n),Du(null,e,r,!0,t,n);case 19:return Mp(t,e,n);case 22:return Pp(t,e,n)}throw Error(G(156,e.tag))};function em(t,e){return Ch(t,e)}function ry(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Fn(t,e,n,r){return new ry(t,e,n,r)}function qc(t){return t=t.prototype,!(!t||!t.isReactComponent)}function sy(t){if(typeof t=="function")return qc(t)?1:0;if(t!=null){if(t=t.$$typeof,t===dc)return 11;if(t===fc)return 14}return 2}function Qr(t,e){var n=t.alternate;return n===null?(n=Fn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function aa(t,e,n,r,s,o){var i=2;if(r=t,typeof t=="function")qc(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case Us:return bs(n.children,s,o,e);case cc:i=8,s|=8;break;case Ql:return t=Fn(12,n,e,s|2),t.elementType=Ql,t.lanes=o,t;case Xl:return t=Fn(13,n,e,s),t.elementType=Xl,t.lanes=o,t;case Zl:return t=Fn(19,n,e,s),t.elementType=Zl,t.lanes=o,t;case ch:return Ka(n,s,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case lh:i=10;break e;case uh:i=9;break e;case dc:i=11;break e;case fc:i=14;break e;case $r:i=16,r=null;break e}throw Error(G(130,t==null?t:typeof t,""))}return e=Fn(i,n,e,s),e.elementType=t,e.type=r,e.lanes=o,e}function bs(t,e,n,r){return t=Fn(7,t,r,e),t.lanes=n,t}function Ka(t,e,n,r){return t=Fn(22,t,r,e),t.elementType=ch,t.lanes=n,t.stateNode={isHidden:!1},t}function Ol(t,e,n){return t=Fn(6,t,null,e),t.lanes=n,t}function Tl(t,e,n){return e=Fn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function oy(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=hl(0),this.expirationTimes=hl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=hl(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Hc(t,e,n,r,s,o,i,l,u){return t=new oy(t,e,n,l,u),e===1?(e=1,o===!0&&(e|=8)):e=0,o=Fn(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Dc(o),t}function iy(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Bs,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function tm(t){if(!t)return Zr;t=t._reactInternals;e:{if(Rs(t)!==t||t.tag!==1)throw Error(G(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(jn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(G(171))}if(t.tag===1){var n=t.type;if(jn(n))return tp(t,n,e)}return e}function nm(t,e,n,r,s,o,i,l,u){return t=Hc(n,r,!0,t,s,o,i,l,u),t.context=tm(null),n=t.current,r=fn(),s=Yr(n),o=_r(r,s),o.callback=e??null,Kr(n,o,s),t.current.lanes=s,pi(t,s,r),Cn(t,r),t}function Ja(t,e,n,r){var s=e.current,o=fn(),i=Yr(s);return n=tm(n),e.context===null?e.context=n:e.pendingContext=n,e=_r(o,i),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Kr(s,e,i),t!==null&&(tr(t,s,i,o),ta(t,s,i)),i}function Aa(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function uf(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Kc(t,e){uf(t,e),(t=t.alternate)&&uf(t,e)}function ay(){return null}var rm=typeof reportError=="function"?reportError:function(t){console.error(t)};function Jc(t){this._internalRoot=t}Ya.prototype.render=Jc.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(G(409));Ja(t,e,null,null)};Ya.prototype.unmount=Jc.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Es(function(){Ja(null,t,null,null)}),e[Er]=null}};function Ya(t){this._internalRoot=t}Ya.prototype.unstable_scheduleHydration=function(t){if(t){var e=Ph();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Br.length&&e!==0&&e<Br[n].priority;n++);Br.splice(n,0,t),n===0&&Ih(t)}};function Yc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Qa(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function cf(){}function ly(t,e,n,r,s){if(s){if(typeof r=="function"){var o=r;r=function(){var c=Aa(i);o.call(c)}}var i=nm(e,r,t,0,null,!1,!1,"",cf);return t._reactRootContainer=i,t[Er]=i.current,ni(t.nodeType===8?t.parentNode:t),Es(),i}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var c=Aa(u);l.call(c)}}var u=Hc(t,0,!1,null,null,!1,!1,"",cf);return t._reactRootContainer=u,t[Er]=u.current,ni(t.nodeType===8?t.parentNode:t),Es(function(){Ja(e,u,n,r)}),u}function Xa(t,e,n,r,s){var o=n._reactRootContainer;if(o){var i=o;if(typeof s=="function"){var l=s;s=function(){var u=Aa(i);l.call(u)}}Ja(e,i,t,s)}else i=ly(n,e,t,s,r);return Aa(i)}Oh=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Oo(e.pendingLanes);n!==0&&(mc(e,n|1),Cn(e,jt()),!(Ge&6)&&(uo=jt()+500,ns()))}break;case 13:Es(function(){var r=jr(t,1);if(r!==null){var s=fn();tr(r,t,1,s)}}),Kc(t,1)}};gc=function(t){if(t.tag===13){var e=jr(t,134217728);if(e!==null){var n=fn();tr(e,t,134217728,n)}Kc(t,134217728)}};Th=function(t){if(t.tag===13){var e=Yr(t),n=jr(t,e);if(n!==null){var r=fn();tr(n,t,e,r)}Kc(t,e)}};Ph=function(){return ot};Lh=function(t,e){var n=ot;try{return ot=t,e()}finally{ot=n}};uu=function(t,e,n){switch(e){case"input":if(nu(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=za(r);if(!s)throw Error(G(90));fh(r),nu(r,s)}}}break;case"textarea":ph(t,n);break;case"select":e=n.value,e!=null&&Qs(t,!!n.multiple,e,!1)}};wh=Wc;Sh=Es;var uy={usingClientEntryPoint:!1,Events:[gi,Vs,za,xh,bh,Wc]},Co={findFiberByHostInstance:ms,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},cy={bundleType:Co.bundleType,version:Co.version,rendererPackageName:Co.rendererPackageName,rendererConfig:Co.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Nr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Eh(t),t===null?null:t.stateNode},findFiberByHostInstance:Co.findFiberByHostInstance||ay,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ui=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ui.isDisabled&&Ui.supportsFiber)try{Ma=Ui.inject(cy),pr=Ui}catch{}}In.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=uy;In.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Yc(e))throw Error(G(200));return iy(t,e,null,n)};In.createRoot=function(t,e){if(!Yc(t))throw Error(G(299));var n=!1,r="",s=rm;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Hc(t,1,!1,null,null,n,!1,r,s),t[Er]=e.current,ni(t.nodeType===8?t.parentNode:t),new Jc(e)};In.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(G(188)):(t=Object.keys(t).join(","),Error(G(268,t)));return t=Eh(e),t=t===null?null:t.stateNode,t};In.flushSync=function(t){return Es(t)};In.hydrate=function(t,e,n){if(!Qa(e))throw Error(G(200));return Xa(null,t,e,!0,n)};In.hydrateRoot=function(t,e,n){if(!Yc(t))throw Error(G(405));var r=n!=null&&n.hydratedSources||null,s=!1,o="",i=rm;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),e=nm(e,null,t,1,n??null,s,!1,o,i),t[Er]=e.current,ni(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Ya(e)};In.render=function(t,e,n){if(!Qa(e))throw Error(G(200));return Xa(null,t,e,!1,n)};In.unmountComponentAtNode=function(t){if(!Qa(t))throw Error(G(40));return t._reactRootContainer?(Es(function(){Xa(null,null,t,!1,function(){t._reactRootContainer=null,t[Er]=null})}),!0):!1};In.unstable_batchedUpdates=Wc;In.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Qa(n))throw Error(G(200));if(t==null||t._reactInternals===void 0)throw Error(G(38));return Xa(t,e,n,!1,r)};In.version="18.3.1-next-f1338f8080-20240426";function sm(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(sm)}catch(t){console.error(t)}}sm(),sh.exports=In;var dy=sh.exports,df=dy;Jl.createRoot=df.createRoot,Jl.hydrateRoot=df.hydrateRoot;const fy="modulepreload",hy=function(t){return"/"+t},ff={},vi=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=Promise.allSettled(n.map(u=>{if(u=hy(u),u in ff)return;ff[u]=!0;const c=u.endsWith(".css"),d=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const h=document.createElement("link");if(h.rel=c?"stylesheet":fy,c||(h.as="script"),h.crossOrigin="",h.href=u,l&&h.setAttribute("nonce",l),document.head.appendChild(h),c)return new Promise((p,g)=>{h.addEventListener("load",p),h.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${u}`)))})}))}function o(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return s.then(i=>{for(const l of i||[])l.status==="rejected"&&o(l.reason);return e().catch(o)})},py=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>vi(async()=>{const{default:r}=await Promise.resolve().then(()=>mo);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)};class Qc extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class my extends Qc{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class hf extends Qc{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class pf extends Qc{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var zu;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(zu||(zu={}));var gy=function(t,e,n,r){function s(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?o(d.value):s(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};class yy{constructor(e,{headers:n={},customFetch:r,region:s=zu.Any}={}){this.url=e,this.headers=n,this.region=s,this.fetch=py(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var r;return gy(this,void 0,void 0,function*(){try{const{headers:s,method:o,body:i}=n;let l={},{region:u}=n;u||(u=this.region);const c=new URL(`${this.url}/${e}`);u&&u!=="any"&&(l["x-region"]=u,c.searchParams.set("forceFunctionRegion",u));let d;i&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",d=i):typeof i=="string"?(l["Content-Type"]="text/plain",d=i):typeof FormData<"u"&&i instanceof FormData?d=i:(l["Content-Type"]="application/json",d=JSON.stringify(i)));const h=yield this.fetch(c.toString(),{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),s),body:d}).catch(x=>{throw new my(x)}),p=h.headers.get("x-relay-error");if(p&&p==="true")throw new hf(h);if(!h.ok)throw new pf(h);let g=((r=h.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),b;return g==="application/json"?b=yield h.json():g==="application/octet-stream"?b=yield h.blob():g==="text/event-stream"?b=h:g==="multipart/form-data"?b=yield h.formData():b=yield h.text(),{data:b,error:null,response:h}}catch(s){return{data:null,error:s,response:s instanceof pf||s instanceof hf?s.context:void 0}}})}}var _n={},Xc={},Za={},xi={},el={},tl={},vy=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},co=vy();const xy=co.fetch,om=co.fetch.bind(co),im=co.Headers,by=co.Request,wy=co.Response,mo=Object.freeze(Object.defineProperty({__proto__:null,Headers:im,Request:by,Response:wy,default:om,fetch:xy},Symbol.toStringTag,{value:"Module"})),Sy=Bm(mo);var nl={};Object.defineProperty(nl,"__esModule",{value:!0});let _y=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};nl.default=_y;var am=Wn&&Wn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(tl,"__esModule",{value:!0});const ky=am(Sy),Ey=am(nl);let jy=class{constructor(e){var n,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(n=e.shouldThrowOnError)!==null&&n!==void 0?n:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=ky.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,n){return this.headers=new Headers(this.headers),this.headers.set(e,n),this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const r=this.fetch;let s=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async o=>{var i,l,u,c;let d=null,h=null,p=null,g=o.status,b=o.statusText;if(o.ok){if(this.method!=="HEAD"){const f=await o.text();f===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((i=this.headers.get("Accept"))===null||i===void 0)&&i.includes("application/vnd.pgrst.plan+text"))?h=f:h=JSON.parse(f))}const S=(l=this.headers.get("Prefer"))===null||l===void 0?void 0:l.match(/count=(exact|planned|estimated)/),y=(u=o.headers.get("content-range"))===null||u===void 0?void 0:u.split("/");S&&y&&y.length>1&&(p=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(h)&&(h.length>1?(d={code:"PGRST116",details:`Results contain ${h.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},h=null,p=null,g=406,b="Not Acceptable"):h.length===1?h=h[0]:h=null)}else{const S=await o.text();try{d=JSON.parse(S),Array.isArray(d)&&o.status===404&&(h=[],d=null,g=200,b="OK")}catch{o.status===404&&S===""?(g=204,b="No Content"):d={message:S}}if(d&&this.isMaybeSingle&&(!((c=d==null?void 0:d.details)===null||c===void 0)&&c.includes("0 rows"))&&(d=null,g=200,b="OK"),d&&this.shouldThrowOnError)throw new Ey.default(d)}return{error:d,data:h,count:p,status:g,statusText:b}});return this.shouldThrowOnError||(s=s.catch(o=>{var i,l,u;return{error:{message:`${(i=o==null?void 0:o.name)!==null&&i!==void 0?i:"FetchError"}: ${o==null?void 0:o.message}`,details:`${(l=o==null?void 0:o.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(u=o==null?void 0:o.code)!==null&&u!==void 0?u:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,n)}returns(){return this}overrideTypes(){return this}};tl.default=jy;var Cy=Wn&&Wn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(el,"__esModule",{value:!0});const Ry=Cy(tl);let Ny=class extends Ry.default{select(e){let n=!1;const r=(e??"*").split("").map(s=>/\s/.test(s)&&!n?"":(s==='"'&&(n=!n),s)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:n=!0,nullsFirst:r,foreignTable:s,referencedTable:o=s}={}){const i=o?`${o}.order`:"order",l=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${l?`${l},`:""}${e}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:r=n}={}){const s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,n,{foreignTable:r,referencedTable:s=r}={}){const o=typeof s>"u"?"offset":`${s}.offset`,i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(o,`${e}`),this.url.searchParams.set(i,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:n=!1,settings:r=!1,buffers:s=!1,wal:o=!1,format:i="text"}={}){var l;const u=[e?"analyze":null,n?"verbose":null,r?"settings":null,s?"buffers":null,o?"wal":null].filter(Boolean).join("|"),c=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${c}"; options=${u};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};el.default=Ny;var Dy=Wn&&Wn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(xi,"__esModule",{value:!0});const Ay=Dy(el);let Oy=class extends Ay.default{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const r=Array.from(new Set(n)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:r,type:s}={}){let o="";s==="plain"?o="pl":s==="phrase"?o="ph":s==="websearch"&&(o="w");const i=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${o}fts${i}.${n}`),this}match(e){return Object.entries(e).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(e,n,r){return this.url.searchParams.append(e,`not.${n}.${r}`),this}or(e,{foreignTable:n,referencedTable:r=n}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,n,r){return this.url.searchParams.append(e,`${n}.${r}`),this}};xi.default=Oy;var Ty=Wn&&Wn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Za,"__esModule",{value:!0});const Ro=Ty(xi);let Py=class{constructor(e,{headers:n={},schema:r,fetch:s}){this.url=e,this.headers=new Headers(n),this.schema=r,this.fetch=s}select(e,{head:n=!1,count:r}={}){const s=n?"HEAD":"GET";let o=!1;const i=(e??"*").split("").map(l=>/\s/.test(l)&&!o?"":(l==='"'&&(o=!o),l)).join("");return this.url.searchParams.set("select",i),r&&this.headers.append("Prefer",`count=${r}`),new Ro.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:n,defaultToNull:r=!0}={}){var s;const o="POST";if(n&&this.headers.append("Prefer",`count=${n}`),r||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const i=e.reduce((l,u)=>l.concat(Object.keys(u)),[]);if(i.length>0){const l=[...new Set(i)].map(u=>`"${u}"`);this.url.searchParams.set("columns",l.join(","))}}return new Ro.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(e,{onConflict:n,ignoreDuplicates:r=!1,count:s,defaultToNull:o=!0}={}){var i;const l="POST";if(this.headers.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),n!==void 0&&this.url.searchParams.set("on_conflict",n),s&&this.headers.append("Prefer",`count=${s}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const u=e.reduce((c,d)=>c.concat(Object.keys(d)),[]);if(u.length>0){const c=[...new Set(u)].map(d=>`"${d}"`);this.url.searchParams.set("columns",c.join(","))}}return new Ro.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(e,{count:n}={}){var r;const s="PATCH";return n&&this.headers.append("Prefer",`count=${n}`),new Ro.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var n;const r="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new Ro.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}};Za.default=Py;var lm=Wn&&Wn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Xc,"__esModule",{value:!0});const Ly=lm(Za),Iy=lm(xi);let $y=class um{constructor(e,{headers:n={},schema:r,fetch:s}={}){this.url=e,this.headers=new Headers(n),this.schemaName=r,this.fetch=s}from(e){const n=new URL(`${this.url}/${e}`);return new Ly.default(n,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new um(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:r=!1,get:s=!1,count:o}={}){var i;let l;const u=new URL(`${this.url}/rpc/${e}`);let c;r||s?(l=r?"HEAD":"GET",Object.entries(n).filter(([h,p])=>p!==void 0).map(([h,p])=>[h,Array.isArray(p)?`{${p.join(",")}}`:`${p}`]).forEach(([h,p])=>{u.searchParams.append(h,p)})):(l="POST",c=n);const d=new Headers(this.headers);return o&&d.set("Prefer",`count=${o}`),new Iy.default({method:l,url:u,headers:d,schema:this.schemaName,body:c,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};Xc.default=$y;var go=Wn&&Wn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(_n,"__esModule",{value:!0});_n.PostgrestError=_n.PostgrestBuilder=_n.PostgrestTransformBuilder=_n.PostgrestFilterBuilder=_n.PostgrestQueryBuilder=_n.PostgrestClient=void 0;const cm=go(Xc);_n.PostgrestClient=cm.default;const dm=go(Za);_n.PostgrestQueryBuilder=dm.default;const fm=go(xi);_n.PostgrestFilterBuilder=fm.default;const hm=go(el);_n.PostgrestTransformBuilder=hm.default;const pm=go(tl);_n.PostgrestBuilder=pm.default;const mm=go(nl);_n.PostgrestError=mm.default;var My=_n.default={PostgrestClient:cm.default,PostgrestQueryBuilder:dm.default,PostgrestFilterBuilder:fm.default,PostgrestTransformBuilder:hm.default,PostgrestBuilder:pm.default,PostgrestError:mm.default};const{PostgrestClient:By,PostgrestQueryBuilder:Wb,PostgrestFilterBuilder:Vb,PostgrestTransformBuilder:Gb,PostgrestBuilder:qb,PostgrestError:Hb}=My;class Uy{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const r=n.node,s=parseInt(r.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let n=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(n+=`

Suggested solution: ${e.workaround}`),new Error(n)}static createWebSocket(e,n){const r=this.getWebSocketConstructor();return new r(e,n)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const Fy="2.15.5",zy=`realtime-js/${Fy}`,Wy="1.0.0",Wu=1e4,Vy=1e3,Gy=100;var Vo;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Vo||(Vo={}));var $t;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})($t||($t={}));var Qn;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Qn||(Qn={}));var Vu;(function(t){t.websocket="websocket"})(Vu||(Vu={}));var ps;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(ps||(ps={}));class qy{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const s=n.getUint8(1),o=n.getUint8(2);let i=this.HEADER_LENGTH+2;const l=r.decode(e.slice(i,i+s));i=i+s;const u=r.decode(e.slice(i,i+o));i=i+o;const c=JSON.parse(r.decode(e.slice(i,e.byteLength)));return{ref:null,topic:l,event:u,payload:c}}}class gm{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ct;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(ct||(ct={}));const mf=(t,e,n={})=>{var r;const s=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((o,i)=>(o[i]=Hy(i,t,e,s),o),{})},Hy=(t,e,n,r)=>{const s=e.find(l=>l.name===t),o=s==null?void 0:s.type,i=n[t];return o&&!r.includes(o)?ym(o,i):Gu(i)},ym=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return Qy(e,n)}switch(t){case ct.bool:return Ky(e);case ct.float4:case ct.float8:case ct.int2:case ct.int4:case ct.int8:case ct.numeric:case ct.oid:return Jy(e);case ct.json:case ct.jsonb:return Yy(e);case ct.timestamp:return Xy(e);case ct.abstime:case ct.date:case ct.daterange:case ct.int4range:case ct.int8range:case ct.money:case ct.reltime:case ct.text:case ct.time:case ct.timestamptz:case ct.timetz:case ct.tsrange:case ct.tstzrange:return Gu(e);default:return Gu(e)}},Gu=t=>t,Ky=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Jy=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Yy=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},Qy=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let o;const i=t.slice(1,n);try{o=JSON.parse("["+i+"]")}catch{o=i?i.split(","):[]}return o.map(l=>ym(e,l))}return t},Xy=t=>typeof t=="string"?t.replace(" ","T"):t,vm=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class Pl{constructor(e,n,r={},s=Wu){this.channel=e,this.event=n,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var gf;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(gf||(gf={}));class Go{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:o,onLeave:i,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Go.syncState(this.state,s,o,i),this.pendingDiffs.forEach(u=>{this.state=Go.syncDiff(this.state,u,o,i)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},s=>{const{onJoin:o,onLeave:i,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Go.syncDiff(this.state,s,o,i),l())}),this.onJoin((s,o,i)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:o,newPresences:i})}),this.onLeave((s,o,i)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:o,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,s){const o=this.cloneDeep(e),i=this.transformState(n),l={},u={};return this.map(o,(c,d)=>{i[c]||(u[c]=d)}),this.map(i,(c,d)=>{const h=o[c];if(h){const p=d.map(S=>S.presence_ref),g=h.map(S=>S.presence_ref),b=d.filter(S=>g.indexOf(S.presence_ref)<0),x=h.filter(S=>p.indexOf(S.presence_ref)<0);b.length>0&&(l[c]=b),x.length>0&&(u[c]=x)}else l[c]=d}),this.syncDiff(o,{joins:l,leaves:u},r,s)}static syncDiff(e,n,r,s){const{joins:o,leaves:i}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(o,(l,u)=>{var c;const d=(c=e[l])!==null&&c!==void 0?c:[];if(e[l]=this.cloneDeep(u),d.length>0){const h=e[l].map(g=>g.presence_ref),p=d.filter(g=>h.indexOf(g.presence_ref)<0);e[l].unshift(...p)}r(l,d,u)}),this.map(i,(l,u)=>{let c=e[l];if(!c)return;const d=u.map(h=>h.presence_ref);c=c.filter(h=>d.indexOf(h.presence_ref)<0),e[l]=c,s(l,c,u),c.length===0&&delete e[l]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const s=e[r];return"metas"in s?n[r]=s.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):n[r]=s,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var yf;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(yf||(yf={}));var qo;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(qo||(qo={}));var vr;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(vr||(vr={}));class Zc{constructor(e,n={config:{}},r){this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=$t.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Pl(this,Qn.join,this.params,this.timeout),this.rejoinTimer=new gm(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=$t.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=$t.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=$t.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=$t.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=$t.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Qn.reply,{},(s,o)=>{this._trigger(this._replyEventName(o),s)}),this.presence=new Go(this),this.broadcastEndpointURL=vm(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var r,s,o;if(this.socket.isConnected()||this.socket.connect(),this.state==$t.closed){const{config:{broadcast:i,presence:l,private:u}}=this.params,c=(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(g=>g.filter))!==null&&s!==void 0?s:[],d=!!this.bindings[qo.PRESENCE]&&this.bindings[qo.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,h={},p={broadcast:i,presence:Object.assign(Object.assign({},l),{enabled:d}),postgres_changes:c,private:u};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(g=>e==null?void 0:e(vr.CHANNEL_ERROR,g)),this._onClose(()=>e==null?void 0:e(vr.CLOSED)),this.updateJoinPayload(Object.assign({config:p},h)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:g})=>{var b;if(this.socket.setAuth(),g===void 0){e==null||e(vr.SUBSCRIBED);return}else{const x=this.bindings.postgres_changes,S=(b=x==null?void 0:x.length)!==null&&b!==void 0?b:0,y=[];for(let f=0;f<S;f++){const m=x[f],{filter:{event:w,schema:_,table:A,filter:D}}=m,k=g&&g[f];if(k&&k.event===w&&k.schema===_&&k.table===A&&k.filter===D)y.push(Object.assign(Object.assign({},m),{id:k.id}));else{this.unsubscribe(),this.state=$t.errored,e==null||e(vr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,e&&e(vr.SUBSCRIBED);return}}).receive("error",g=>{this.state=$t.errored,e==null||e(vr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(g).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(vr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this.state===$t.joined&&e===qo.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,n,r)}async send(e,n={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){const{event:o,payload:i}=e,u={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:i,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=c.body)===null||s===void 0?void 0:s.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var i,l,u;const c=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((u=(l=(i=this.params)===null||i===void 0?void 0:i.config)===null||l===void 0?void 0:l.broadcast)===null||u===void 0)&&u.ack)&&o("ok"),c.receive("ok",()=>o("ok")),c.receive("error",()=>o("error")),c.receive("timeout",()=>o("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=$t.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Qn.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new Pl(this,Qn.leave,{},e),r.receive("ok",()=>{n(),s("ok")}).receive("timeout",()=>{n(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=$t.closed,this.bindings={}}async _fetchWithTimeout(e,n,r){const s=new AbortController,o=setTimeout(()=>s.abort(),r),i=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:s.signal}));return clearTimeout(o),i}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Pl(this,e,n,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Gy){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var s,o;const i=e.toLocaleLowerCase(),{close:l,error:u,leave:c,join:d}=Qn;if(r&&[l,u,c,d].indexOf(i)>=0&&r!==this._joinRef())return;let p=this._onMessage(i,n,r);if(n&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(g=>{var b,x,S;return((b=g.filter)===null||b===void 0?void 0:b.event)==="*"||((S=(x=g.filter)===null||x===void 0?void 0:x.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===i}).map(g=>g.callback(p,r)):(o=this.bindings[i])===null||o===void 0||o.filter(g=>{var b,x,S,y,f,m;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in g){const w=g.id,_=(b=g.filter)===null||b===void 0?void 0:b.event;return w&&((x=n.ids)===null||x===void 0?void 0:x.includes(w))&&(_==="*"||(_==null?void 0:_.toLocaleLowerCase())===((S=n.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))}else{const w=(f=(y=g==null?void 0:g.filter)===null||y===void 0?void 0:y.event)===null||f===void 0?void 0:f.toLocaleLowerCase();return w==="*"||w===((m=n==null?void 0:n.event)===null||m===void 0?void 0:m.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===i}).map(g=>{if(typeof p=="object"&&"ids"in p){const b=p.data,{schema:x,table:S,commit_timestamp:y,type:f,errors:m}=b;p=Object.assign(Object.assign({},{schema:x,table:S,commit_timestamp:y,eventType:f,new:{},old:{},errors:m}),this._getPayloadRecords(b))}g.callback(p,r)})}_isClosed(){return this.state===$t.closed}_isJoined(){return this.state===$t.joined}_isJoining(){return this.state===$t.joining}_isLeaving(){return this.state===$t.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const s=e.toLocaleLowerCase(),o={type:s,filter:n,callback:r};return this.bindings[s]?this.bindings[s].push(o):this.bindings[s]=[o],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(s=>{var o;return!(((o=s.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===r&&Zc.isEqual(s.filter,n))})),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Qn.close,{},e)}_onError(e){this._on(Qn.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=$t.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=mf(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=mf(e.columns,e.old_record)),n}}const Ll=()=>{},Fi={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Zy=[1e3,2e3,5e3,1e4],ev=1e4,tv=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class nv{constructor(e,n){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Wu,this.transport=null,this.heartbeatIntervalMs=Fi.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ll,this.ref=0,this.reconnectTimer=null,this.logger=Ll,this.conn=null,this.sendBuffer=[],this.serializer=new qy,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let o;return s?o=s:typeof fetch>"u"?o=(...i)=>vi(async()=>{const{default:l}=await Promise.resolve().then(()=>mo);return{default:l}},void 0).then(({default:l})=>l(...i)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):o=fetch,(...i)=>o(...i)},!(!((r=n==null?void 0:n.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${e}/${Vu.websocket}`,this.httpEndpoint=vm(e),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Uy.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const n=e.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Wy}))}disconnect(e,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Vo.connecting:return ps.Connecting;case Vo.open:return ps.Open;case Vo.closing:return ps.Closing;default:return ps.Closed}}isConnected(){return this.connectionState()===ps.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,n={config:{}}){const r=`realtime:${e}`,s=this.getChannels().find(o=>o.topic===r);if(s)return s;{const o=new Zc(`realtime:${e}`,n,this);return this.channels.push(o),o}}push(e){const{topic:n,event:r,payload:s,ref:o}=e,i=()=>{this.encode(e,l=>{var u;(u=this.conn)===null||u===void 0||u.send(l)})};this.log("push",`${n} ${r} (${o})`,s),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(Vy,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},Fi.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(c){this.log("error","error in heartbeat callback",c)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:s,payload:o,ref:i}=n,l=i?`(${i})`:"",u=o.status||"";this.log("receive",`${u} ${r} ${s} ${l}`.trim(),o),this.channels.filter(c=>c._isMember(r)).forEach(c=>c._trigger(s,o,i)),this._triggerStateCallbacks("message",n)})}_clearTimer(e){var n;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var n;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Qn.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(n);return`${e}${r}${s}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([tv],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}_setConnectionState(e,n=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(e=null){let n;e?n=e:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const s={access_token:n,version:zy};n&&r.updateJoinPayload(s),r.joinedOnce&&r._isJoined()&&r._push(Qn.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${e}`,n)})}_triggerStateCallbacks(e,n){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(n)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new gm(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Fi.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var n,r,s,o,i,l,u,c,d;if(this.transport=(n=e==null?void 0:e.transport)!==null&&n!==void 0?n:null,this.timeout=(r=e==null?void 0:e.timeout)!==null&&r!==void 0?r:Wu,this.heartbeatIntervalMs=(s=e==null?void 0:e.heartbeatIntervalMs)!==null&&s!==void 0?s:Fi.HEARTBEAT_INTERVAL,this.worker=(o=e==null?void 0:e.worker)!==null&&o!==void 0?o:!1,this.accessToken=(i=e==null?void 0:e.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(l=e==null?void 0:e.heartbeatCallback)!==null&&l!==void 0?l:Ll,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=e==null?void 0:e.reconnectAfterMs)!==null&&u!==void 0?u:h=>Zy[h-1]||ev,this.encode=(c=e==null?void 0:e.encode)!==null&&c!==void 0?c:(h,p)=>p(JSON.stringify(h)),this.decode=(d=e==null?void 0:e.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class ed extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Mt(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class rv extends ed{constructor(e,n,r){super(e),this.name="StorageApiError",this.status=n,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class qu extends ed{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var sv=function(t,e,n,r){function s(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?o(d.value):s(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};const xm=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>vi(async()=>{const{default:r}=await Promise.resolve().then(()=>mo);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},ov=()=>sv(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield vi(()=>Promise.resolve().then(()=>mo),void 0)).Response:Response}),Hu=t=>{if(Array.isArray(t))return t.map(n=>Hu(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const s=n.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));e[s]=Hu(r)}),e},iv=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var Ns=function(t,e,n,r){function s(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?o(d.value):s(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};const Il=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),av=(t,e,n)=>Ns(void 0,void 0,void 0,function*(){const r=yield ov();t instanceof r&&!(n!=null&&n.noResolveJson)?t.json().then(s=>{const o=t.status||500,i=(s==null?void 0:s.statusCode)||o+"";e(new rv(Il(s),o,i))}).catch(s=>{e(new qu(Il(s),s))}):e(new qu(Il(t),t))}),lv=(t,e,n,r)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"||!r?s:(iv(r)?(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(r)):s.body=r,e!=null&&e.duplex&&(s.duplex=e.duplex),Object.assign(Object.assign({},s),n))};function bi(t,e,n,r,s,o){return Ns(this,void 0,void 0,function*(){return new Promise((i,l)=>{t(n,lv(e,r,s,o)).then(u=>{if(!u.ok)throw u;return r!=null&&r.noResolveJson?u:u.json()}).then(u=>i(u)).catch(u=>av(u,l,r))})})}function Oa(t,e,n,r){return Ns(this,void 0,void 0,function*(){return bi(t,"GET",e,n,r)})}function ur(t,e,n,r,s){return Ns(this,void 0,void 0,function*(){return bi(t,"POST",e,r,s,n)})}function Ku(t,e,n,r,s){return Ns(this,void 0,void 0,function*(){return bi(t,"PUT",e,r,s,n)})}function uv(t,e,n,r){return Ns(this,void 0,void 0,function*(){return bi(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function bm(t,e,n,r,s){return Ns(this,void 0,void 0,function*(){return bi(t,"DELETE",e,r,s,n)})}var ln=function(t,e,n,r){function s(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?o(d.value):s(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};const cv={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},vf={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class dv{constructor(e,n={},r,s){this.shouldThrowOnError=!1,this.url=e,this.headers=n,this.bucketId=r,this.fetch=xm(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,n,r,s){return ln(this,void 0,void 0,function*(){try{let o;const i=Object.assign(Object.assign({},vf),s);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(i.upsert)});const u=i.metadata;typeof Blob<"u"&&r instanceof Blob?(o=new FormData,o.append("cacheControl",i.cacheControl),u&&o.append("metadata",this.encodeMetadata(u)),o.append("",r)):typeof FormData<"u"&&r instanceof FormData?(o=r,o.append("cacheControl",i.cacheControl),u&&o.append("metadata",this.encodeMetadata(u))):(o=r,l["cache-control"]=`max-age=${i.cacheControl}`,l["content-type"]=i.contentType,u&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(u)))),s!=null&&s.headers&&(l=Object.assign(Object.assign({},l),s.headers));const c=this._removeEmptyFolders(n),d=this._getFinalPath(c),h=yield(e=="PUT"?Ku:ur)(this.fetch,`${this.url}/object/${d}`,o,Object.assign({headers:l},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:c,id:h.Id,fullPath:h.Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Mt(o))return{data:null,error:o};throw o}})}upload(e,n,r){return ln(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,s){return ln(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(e),i=this._getFinalPath(o),l=new URL(this.url+`/object/upload/sign/${i}`);l.searchParams.set("token",n);try{let u;const c=Object.assign({upsert:vf.upsert},s),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&r instanceof Blob?(u=new FormData,u.append("cacheControl",c.cacheControl),u.append("",r)):typeof FormData<"u"&&r instanceof FormData?(u=r,u.append("cacheControl",c.cacheControl)):(u=r,d["cache-control"]=`max-age=${c.cacheControl}`,d["content-type"]=c.contentType);const h=yield Ku(this.fetch,l.toString(),u,{headers:d});return{data:{path:o,fullPath:h.Key},error:null}}catch(u){if(this.shouldThrowOnError)throw u;if(Mt(u))return{data:null,error:u};throw u}})}createSignedUploadUrl(e,n){return ln(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const s=Object.assign({},this.headers);n!=null&&n.upsert&&(s["x-upsert"]="true");const o=yield ur(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),i=new URL(this.url+o.url),l=i.searchParams.get("token");if(!l)throw new ed("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:l},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Mt(r))return{data:null,error:r};throw r}})}update(e,n,r){return ln(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return ln(this,void 0,void 0,function*(){try{return{data:yield ur(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Mt(s))return{data:null,error:s};throw s}})}copy(e,n,r){return ln(this,void 0,void 0,function*(){try{return{data:{path:(yield ur(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Mt(s))return{data:null,error:s};throw s}})}createSignedUrl(e,n,r){return ln(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),o=yield ur(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${i}`)},{data:o,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Mt(s))return{data:null,error:s};throw s}})}createSignedUrls(e,n,r){return ln(this,void 0,void 0,function*(){try{const s=yield ur(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${o}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Mt(s))return{data:null,error:s};throw s}})}download(e,n){return ln(this,void 0,void 0,function*(){const s=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),i=o?`?${o}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield Oa(this.fetch,`${this.url}/${s}/${l}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(this.shouldThrowOnError)throw l;if(Mt(l))return{data:null,error:l};throw l}})}info(e){return ln(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const r=yield Oa(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Hu(r),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Mt(r))return{data:null,error:r};throw r}})}exists(e){return ln(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield uv(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Mt(r)&&r instanceof qu){const s=r.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,n){const r=this._getFinalPath(e),s=[],o=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";o!==""&&s.push(o);const l=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",u=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});u!==""&&s.push(u);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${c}`)}}}remove(e){return ln(this,void 0,void 0,function*(){try{return{data:yield bm(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Mt(n))return{data:null,error:n};throw n}})}list(e,n,r){return ln(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},cv),n),{prefix:e||""});return{data:yield ur(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Mt(s))return{data:null,error:s};throw s}})}listV2(e,n){return ln(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield ur(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},n),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Mt(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const fv="2.12.1",hv={"X-Client-Info":`storage-js/${fv}`};var As=function(t,e,n,r){function s(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?o(d.value):s(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};class pv{constructor(e,n={},r,s){this.shouldThrowOnError=!1;const o=new URL(e);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase.")),this.url=o.href,this.headers=Object.assign(Object.assign({},hv),n),this.fetch=xm(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return As(this,void 0,void 0,function*(){try{return{data:yield Oa(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Mt(e))return{data:null,error:e};throw e}})}getBucket(e){return As(this,void 0,void 0,function*(){try{return{data:yield Oa(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Mt(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return As(this,void 0,void 0,function*(){try{return{data:yield ur(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Mt(r))return{data:null,error:r};throw r}})}updateBucket(e,n){return As(this,void 0,void 0,function*(){try{return{data:yield Ku(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Mt(r))return{data:null,error:r};throw r}})}emptyBucket(e){return As(this,void 0,void 0,function*(){try{return{data:yield ur(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Mt(n))return{data:null,error:n};throw n}})}deleteBucket(e){return As(this,void 0,void 0,function*(){try{return{data:yield bm(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Mt(n))return{data:null,error:n};throw n}})}}class mv extends pv{constructor(e,n={},r,s){super(e,n,r,s)}from(e){return new dv(this.url,this.headers,e,this.fetch)}}const gv="2.57.4";let Po="";typeof Deno<"u"?Po="deno":typeof document<"u"?Po="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Po="react-native":Po="node";const yv={"X-Client-Info":`supabase-js-${Po}/${gv}`},vv={headers:yv},xv={schema:"public"},bv={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},wv={};var Sv=function(t,e,n,r){function s(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?o(d.value):s(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};const _v=t=>{let e;return t?e=t:typeof fetch>"u"?e=om:e=fetch,(...n)=>e(...n)},kv=()=>typeof Headers>"u"?im:Headers,Ev=(t,e,n)=>{const r=_v(n),s=kv();return(o,i)=>Sv(void 0,void 0,void 0,function*(){var l;const u=(l=yield e())!==null&&l!==void 0?l:t;let c=new s(i==null?void 0:i.headers);return c.has("apikey")||c.set("apikey",t),c.has("Authorization")||c.set("Authorization",`Bearer ${u}`),r(o,Object.assign(Object.assign({},i),{headers:c}))})};var jv=function(t,e,n,r){function s(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?o(d.value):s(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};function Cv(t){return t.endsWith("/")?t:t+"/"}function Rv(t,e){var n,r;const{db:s,auth:o,realtime:i,global:l}=t,{db:u,auth:c,realtime:d,global:h}=e,p={db:Object.assign(Object.assign({},u),s),auth:Object.assign(Object.assign({},c),o),realtime:Object.assign(Object.assign({},d),i),storage:{},global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(n=h==null?void 0:h.headers)!==null&&n!==void 0?n:{}),(r=l==null?void 0:l.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>jv(this,void 0,void 0,function*(){return""})};return t.accessToken?p.accessToken=t.accessToken:delete p.accessToken,p}function Nv(t){const e=t==null?void 0:t.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Cv(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const wm="2.71.1",Is=30*1e3,Ju=3,$l=Ju*Is,Dv="http://localhost:9999",Av="supabase.auth.token",Ov={"X-Client-Info":`gotrue-js/${wm}`},Yu="X-Supabase-Api-Version",Sm={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Tv=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Pv=10*60*1e3;class td extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function De(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class Lv extends td{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function Iv(t){return De(t)&&t.name==="AuthApiError"}class _m extends td{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class rs extends td{constructor(e,n,r,s){super(e,r,s),this.name=n,this.status=r}}class Ir extends rs{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function $v(t){return De(t)&&t.name==="AuthSessionMissingError"}class zi extends rs{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Wi extends rs{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Vi extends rs{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Mv(t){return De(t)&&t.name==="AuthImplicitGrantRedirectError"}class xf extends rs{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Qu extends rs{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function Ml(t){return De(t)&&t.name==="AuthRetryableFetchError"}class bf extends rs{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class Xu extends rs{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ta="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),wf=` 	
\r=`.split(""),Bv=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<wf.length;e+=1)t[wf[e].charCodeAt(0)]=-2;for(let e=0;e<Ta.length;e+=1)t[Ta[e].charCodeAt(0)]=e;return t})();function Sf(t,e,n){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(Ta[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;n(Ta[r]),e.queuedBits-=6}}function km(t,e,n){const r=Bv[t];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)n(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function _f(t){const e=[],n=i=>{e.push(String.fromCodePoint(i))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},o=i=>{zv(i,r,n)};for(let i=0;i<t.length;i+=1)km(t.charCodeAt(i),s,o);return e.join("")}function Uv(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function Fv(t,e){for(let n=0;n<t.length;n+=1){let r=t.charCodeAt(n);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(t.charCodeAt(n+1)-56320&65535|s)+65536,n+=1}Uv(r,e)}}function zv(t,e,n){if(e.utf8seq===0){if(t<=127){n(t);return}for(let r=1;r<6;r+=1)if(!(t>>7-r&1)){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&n(e.codepoint)}}function Wv(t){const e=[],n={queue:0,queuedBits:0},r=s=>{e.push(s)};for(let s=0;s<t.length;s+=1)km(t.charCodeAt(s),n,r);return new Uint8Array(e)}function Vv(t){const e=[];return Fv(t,n=>e.push(n)),new Uint8Array(e)}function Gv(t){const e=[],n={queue:0,queuedBits:0},r=s=>{e.push(s)};return t.forEach(s=>Sf(s,n,r)),Sf(null,n,r),e.join("")}function qv(t){return Math.round(Date.now()/1e3)+t}function Hv(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const Kn=()=>typeof window<"u"&&typeof document<"u",us={tested:!1,writable:!1},Em=()=>{if(!Kn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(us.tested)return us.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),us.tested=!0,us.writable=!0}catch{us.tested=!0,us.writable=!1}return us.writable};function Kv(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((s,o)=>{e[o]=s})}catch{}return n.searchParams.forEach((r,s)=>{e[s]=r}),e}const jm=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>vi(async()=>{const{default:r}=await Promise.resolve().then(()=>mo);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},Jv=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",$s=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},cs=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Pr=async(t,e)=>{await t.removeItem(e)};class rl{constructor(){this.promise=new rl.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}rl.promiseConstructor=Promise;function Bl(t){const e=t.split(".");if(e.length!==3)throw new Xu("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!Tv.test(e[r]))throw new Xu("JWT not in base64url format");return{header:JSON.parse(_f(e[0])),payload:JSON.parse(_f(e[1])),signature:Wv(e[2]),raw:{header:e[0],payload:e[1]}}}async function Yv(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function Qv(t,e){return new Promise((r,s)=>{(async()=>{for(let o=0;o<1/0;o++)try{const i=await t(o);if(!e(o,null,i)){r(i);return}}catch(i){if(!e(o,i)){s(i);return}}})()})}function Xv(t){return("0"+t.toString(16)).substr(-2)}function Zv(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let s="";for(let o=0;o<56;o++)s+=n.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,Xv).join("")}async function ex(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),s=new Uint8Array(r);return Array.from(s).map(o=>String.fromCharCode(o)).join("")}async function tx(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await ex(t);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Os(t,e,n=!1){const r=Zv();let s=r;n&&(s+="/PASSWORD_RECOVERY"),await $s(t,`${e}-code-verifier`,s);const o=await tx(r);return[o,r===o?"plain":"s256"]}const nx=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function rx(t){const e=t.headers.get(Yu);if(!e||!e.match(nx))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function sx(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function ox(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const ix=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Ts(t){if(!ix.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Ul(){const t={};return new Proxy(t,{get:(e,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function kf(t){return JSON.parse(JSON.stringify(t))}var ax=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n};const hs=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),lx=[502,503,504];async function Ef(t){var e;if(!Jv(t))throw new Qu(hs(t),0);if(lx.includes(t.status))throw new Qu(hs(t),t.status);let n;try{n=await t.json()}catch(o){throw new _m(hs(o),o)}let r;const s=rx(t);if(s&&s.getTime()>=Sm["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new bf(hs(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new Ir}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((o,i)=>o&&typeof i=="string",!0))throw new bf(hs(n),t.status,n.weak_password.reasons);throw new Lv(hs(n),t.status||500,r)}const ux=(t,e,n,r)=>{const s={method:t,headers:(e==null?void 0:e.headers)||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),n))};async function Me(t,e,n,r){var s;const o=Object.assign({},r==null?void 0:r.headers);o[Yu]||(o[Yu]=Sm["2024-01-01"].name),r!=null&&r.jwt&&(o.Authorization=`Bearer ${r.jwt}`);const i=(s=r==null?void 0:r.query)!==null&&s!==void 0?s:{};r!=null&&r.redirectTo&&(i.redirect_to=r.redirectTo);const l=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",u=await cx(t,e,n+l,{headers:o,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(u):{data:Object.assign({},u),error:null}}async function cx(t,e,n,r,s,o){const i=ux(e,r,s,o);let l;try{l=await t(n,Object.assign({},i))}catch(u){throw console.error(u),new Qu(hs(u),0)}if(l.ok||await Ef(l),r!=null&&r.noResolveJson)return l;try{return await l.json()}catch(u){await Ef(u)}}function gr(t){var e;let n=null;px(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=qv(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function jf(t){const e=gr(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function Fr(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function dx(t){return{data:t,error:null}}function fx(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:s,verification_type:o}=t,i=ax(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:n,hashed_token:r,redirect_to:s,verification_type:o},u=Object.assign({},i);return{data:{properties:l,user:u},error:null}}function hx(t){return t}function px(t){return t.access_token&&t.refresh_token&&t.expires_in}const Fl=["global","local","others"];var mx=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n};class gx{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=jm(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n=Fl[0]){if(Fl.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Fl.join(", ")}`);try{return await Me(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(De(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await Me(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Fr})}catch(r){if(De(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=mx(e,["options"]),s=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(s.new_email=r==null?void 0:r.newEmail,delete s.newEmail),await Me(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:fx,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(De(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await Me(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Fr})}catch(n){if(De(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,s,o,i,l,u;try{const c={nextPage:null,lastPage:0,total:0},d=await Me(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e==null?void 0:e.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(o=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&o!==void 0?o:""},xform:hx});if(d.error)throw d.error;const h=await d.json(),p=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,g=(u=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&u!==void 0?u:[];return g.length>0&&(g.forEach(b=>{const x=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(b.split(";")[1].split("=")[1]);c[`${S}Page`]=x}),c.total=parseInt(p)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(De(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){Ts(e);try{return await Me(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Fr})}catch(n){if(De(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){Ts(e);try{return await Me(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:Fr})}catch(r){if(De(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){Ts(e);try{return await Me(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:Fr})}catch(r){if(De(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Ts(e.userId);try{const{data:n,error:r}=await Me(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:n,error:r}}catch(n){if(De(n))return{data:null,error:n};throw n}}async _deleteFactor(e){Ts(e.userId),Ts(e.id);try{return{data:await Me(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(De(n))return{data:null,error:n};throw n}}}function Cf(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function yx(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Ps={debug:!!(globalThis&&Em()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Cm extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class vx extends Cm{}async function xx(t,e,n){Ps.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Ps.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){Ps.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,s.name);try{return await n()}finally{Ps.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,s.name)}}else{if(e===0)throw Ps.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new vx(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Ps.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}yx();const bx={url:Dv,storageKey:Av,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Ov,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Rf(t,e,n){return await n()}const Ls={};class di{constructor(e){var n,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=di.nextInstanceID,di.nextInstanceID+=1,this.instanceID>0&&Kn()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},bx),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new gx({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=jm(s.fetch),this.lock=s.lock||Rf,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:Kn()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=xx:this.lock=Rf,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:Em()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Cf(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=Cf(this.memoryStorage)),Kn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}get jwks(){var e,n;return(n=(e=Ls[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(e){Ls[this.storageKey]=Object.assign(Object.assign({},Ls[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,n;return(n=(e=Ls[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Ls[this.storageKey]=Object.assign(Object.assign({},Ls[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${wm}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=Kv(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),Kn()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:o}=await this._getSessionFromURL(n,r);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),Mv(o)){const u=(e=o.details)===null||e===void 0?void 0:e.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:i,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",i,"redirect type",l),await this._saveSession(i),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return De(n)?{error:n}:{error:new _m("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,s;try{const o=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e==null?void 0:e.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e==null?void 0:e.options)===null||s===void 0?void 0:s.captchaToken}},xform:gr}),{data:i,error:l}=o;if(l||!i)return{data:{user:null,session:null},error:l};const u=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(o){if(De(o))return{data:{user:null,session:null},error:o};throw o}}async signUp(e){var n,r,s;try{let o;if("email"in e){const{email:d,password:h,options:p}=e;let g=null,b=null;this.flowType==="pkce"&&([g,b]=await Os(this.storage,this.storageKey)),o=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:d,password:h,data:(n=p==null?void 0:p.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:g,code_challenge_method:b},xform:gr})}else if("phone"in e){const{phone:d,password:h,options:p}=e;o=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},channel:(s=p==null?void 0:p.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:gr})}else throw new Wi("You must provide either an email or phone number and a password");const{data:i,error:l}=o;if(l||!i)return{data:{user:null,session:null},error:l};const u=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(o){if(De(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithPassword(e){try{let n;if("email"in e){const{email:o,password:i,options:l}=e;n=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:jf})}else if("phone"in e){const{phone:o,password:i,options:l}=e;n=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:jf})}else throw new Wi("You must provide either an email or phone number and a password");const{data:r,error:s}=n;return s?{data:{user:null,session:null},error:s}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new zi}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(n){if(De(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,r,s,o;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:n}=e;if(n==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(e){var n,r,s,o,i,l,u,c,d,h,p,g;let b,x;if("message"in e)b=e.message,x=e.signature;else{const{chain:S,wallet:y,statement:f,options:m}=e;let w;if(Kn())if(typeof y=="object")w=y;else{const A=window;if("solana"in A&&typeof A.solana=="object"&&("signIn"in A.solana&&typeof A.solana.signIn=="function"||"signMessage"in A.solana&&typeof A.solana.signMessage=="function"))w=A.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(m!=null&&m.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");w=y}const _=new URL((n=m==null?void 0:m.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in w&&w.signIn){const A=await w.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},m==null?void 0:m.signInWithSolana),{version:"1",domain:_.host,uri:_.href}),f?{statement:f}:null));let D;if(Array.isArray(A)&&A[0]&&typeof A[0]=="object")D=A[0];else if(A&&typeof A=="object"&&"signedMessage"in A&&"signature"in A)D=A;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in D&&"signature"in D&&(typeof D.signedMessage=="string"||D.signedMessage instanceof Uint8Array)&&D.signature instanceof Uint8Array)b=typeof D.signedMessage=="string"?D.signedMessage:new TextDecoder().decode(D.signedMessage),x=D.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in w)||typeof w.signMessage!="function"||!("publicKey"in w)||typeof w!="object"||!w.publicKey||!("toBase58"in w.publicKey)||typeof w.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");b=[`${_.host} wants you to sign in with your Solana account:`,w.publicKey.toBase58(),...f?["",f,""]:[""],"Version: 1",`URI: ${_.href}`,`Issued At: ${(s=(r=m==null?void 0:m.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((o=m==null?void 0:m.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${m.signInWithSolana.notBefore}`]:[],...!((i=m==null?void 0:m.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${m.signInWithSolana.expirationTime}`]:[],...!((l=m==null?void 0:m.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${m.signInWithSolana.chainId}`]:[],...!((u=m==null?void 0:m.signInWithSolana)===null||u===void 0)&&u.nonce?[`Nonce: ${m.signInWithSolana.nonce}`]:[],...!((c=m==null?void 0:m.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${m.signInWithSolana.requestId}`]:[],...!((h=(d=m==null?void 0:m.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?["Resources",...m.signInWithSolana.resources.map(D=>`- ${D}`)]:[]].join(`
`);const A=await w.signMessage(new TextEncoder().encode(b),"utf8");if(!A||!(A instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");x=A}}try{const{data:S,error:y}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:b,signature:Gv(x)},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(g=e.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:gr});if(y)throw y;return!S||!S.session||!S.user?{data:{user:null,session:null},error:new zi}:(S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),{data:Object.assign({},S),error:y})}catch(S){if(De(S))return{data:{user:null,session:null},error:S};throw S}}async _exchangeCodeForSession(e){const n=await cs(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(n??"").split("/");try{const{data:o,error:i}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:gr});if(await Pr(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new zi}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:s??null}),error:i})}catch(o){if(De(o))return{data:{user:null,session:null,redirectType:null},error:o};throw o}}async signInWithIdToken(e){try{const{options:n,provider:r,token:s,access_token:o,nonce:i}=e,l=await Me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:o,nonce:i,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:gr}),{data:u,error:c}=l;return c?{data:{user:null,session:null},error:c}:!u||!u.session||!u.user?{data:{user:null,session:null},error:new zi}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:u,error:c})}catch(n){if(De(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,r,s,o,i;try{if("email"in e){const{email:l,options:u}=e;let c=null,d=null;this.flowType==="pkce"&&([c,d]=await Os(this.storage,this.storageKey));const{error:h}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(n=u==null?void 0:u.data)!==null&&n!==void 0?n:{},create_user:(r=u==null?void 0:u.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},code_challenge:c,code_challenge_method:d},redirectTo:u==null?void 0:u.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in e){const{phone:l,options:u}=e,{data:c,error:d}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=u==null?void 0:u.data)!==null&&s!==void 0?s:{},create_user:(o=u==null?void 0:u.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},channel:(i=u==null?void 0:u.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:d}}throw new Wi("You must provide either an email or phone number.")}catch(l){if(De(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var n,r;try{let s,o;"options"in e&&(s=(n=e.options)===null||n===void 0?void 0:n.redirectTo,o=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:i,error:l}=await Me(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:s,xform:gr});if(l)throw l;if(!i)throw new Error("An error occurred on token verification.");const u=i.session,c=i.user;return u!=null&&u.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(s){if(De(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var n,r,s;try{let o=null,i=null;return this.flowType==="pkce"&&([o,i]=await Os(this.storage,this.storageKey)),await Me(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:i}),headers:this.headers,xform:dx})}catch(o){if(De(o))return{data:null,error:o};throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new Ir;const{error:s}=await Me(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(De(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:o}=e,{error:i}=await Me(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},redirectTo:o==null?void 0:o.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in e){const{phone:r,type:s,options:o}=e,{data:i,error:l}=await Me(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:l}}throw new Wi("You must provide either an email or phone number and a type")}catch(n){if(De(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await cs(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<$l:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const i=await cs(this.userStorage,this.storageKey+"-user");i!=null&&i.user?e.user=i.user:e.user=Ul()}if(this.storage.isServer&&e.user){let i=this.suppressGetSessionWarning;e=new Proxy(e,{get:(u,c,d)=>(!i&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(u,c,d))})}return{data:{session:e},error:null}}const{session:s,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{session:null},error:o}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Fr}):await this._useSession(async n=>{var r,s,o;const{data:i,error:l}=n;if(l)throw l;return!(!((r=i.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ir}:await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&o!==void 0?o:void 0,xform:Fr})})}catch(n){if(De(n))return $v(n)&&(await this._removeSession(),await Pr(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:s,error:o}=r;if(o)throw o;if(!s.session)throw new Ir;const i=s.session;let l=null,u=null;this.flowType==="pkce"&&e.email!=null&&([l,u]=await Os(this.storage,this.storageKey));const{data:c,error:d}=await Me(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:u}),jwt:i.access_token,xform:Fr});if(d)throw d;return i.user=c.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(r){if(De(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ir;const n=Date.now()/1e3;let r=n,s=!0,o=null;const{payload:i}=Bl(e.access_token);if(i.exp&&(r=i.exp,s=r<=n),s){const{session:l,error:u}=await this._callRefreshToken(e.refresh_token);if(u)return{data:{user:null,session:null},error:u};if(!l)return{data:{user:null,session:null},error:null};o=l}else{const{data:l,error:u}=await this._getUser(e.access_token);if(u)throw u;o={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(n){if(De(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:i,error:l}=n;if(l)throw l;e=(r=i.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new Ir;const{session:s,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{user:null,session:null},error:o}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(De(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!Kn())throw new Vi("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Vi(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new xf("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Vi("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new xf("No code detected.");const{data:f,error:m}=await this._exchangeCodeForSession(e.code);if(m)throw m;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:f.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:o,refresh_token:i,expires_in:l,expires_at:u,token_type:c}=e;if(!o||!l||!i||!c)throw new Vi("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(l);let p=d+h;u&&(p=parseInt(u));const g=p-d;g*1e3<=Is&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${h}s`);const b=p-h;d-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,p,d):d-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,p,d);const{data:x,error:S}=await this._getUser(o);if(S)throw S;const y={provider_token:r,provider_refresh_token:s,access_token:o,expires_in:h,expires_at:p,refresh_token:i,token_type:c,user:x.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:e.type},error:null}}catch(r){if(De(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await cs(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:s,error:o}=n;if(o)return{error:o};const i=(r=s.session)===null||r===void 0?void 0:r.access_token;if(i){const{error:l}=await this.admin.signOut(i,e);if(l&&!(Iv(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await Pr(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=Hv(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,s;try{const{data:{session:o},error:i}=n;if(i)throw i;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}})}async resetPasswordForEmail(e,n={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await Os(this.storage,this.storageKey,!0));try{return await Me(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(o){if(De(o))return{data:null,error:o};throw o}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(De(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:r,error:s}=await this._useSession(async o=>{var i,l,u,c,d;const{data:h,error:p}=o;if(p)throw p;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(u=e.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await Me(this.fetch,"GET",g,{headers:this.headers,jwt:(d=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&d!==void 0?d:void 0})});if(s)throw s;return Kn()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(De(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,s;const{data:o,error:i}=n;if(i)throw i;return await Me(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(n){if(De(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await Qv(async s=>(s>0&&await Yv(200*Math.pow(2,s-1)),this._debug(n,"refreshing attempt",s),await Me(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:gr})),(s,o)=>{const i=200*Math.pow(2,s);return o&&Ml(o)&&Date.now()+i-r<Is})}catch(r){if(this._debug(n,"error",r),De(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),Kn()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await cs(this.storage,this.storageKey);if(s&&this.userStorage){let i=await cs(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:s.user},await $s(this.userStorage,this.storageKey+"-user",i)),s.user=(e=i==null?void 0:i.user)!==null&&e!==void 0?e:Ul()}else if(s&&!s.user&&!s.user){const i=await cs(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(s.user=i.user,await Pr(this.storage,this.storageKey+"-user"),await $s(this.storage,this.storageKey,s)):s.user=Ul()}if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&await this._removeSession();return}const o=((n=s.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<$l;if(this._debug(r,`session has${o?"":" not"} expired with margin of ${$l}s`),o){if(this.autoRefreshToken&&s.refresh_token){const{error:i}=await this._callRefreshToken(s.refresh_token);i&&(console.error(i),Ml(i)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:l}=await this._getUser(s.access_token);!l&&(i!=null&&i.user)?(s.user=i.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(r,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new Ir;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new rl;const{data:o,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!o.session)throw new Ir;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const l={session:o.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(o){if(this._debug(s,"error",o),De(o)){const i={session:null,error:o};return Ml(o)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(i),i}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(o),o}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,n,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const o=[],i=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,n)}catch(u){o.push(u)}});if(await Promise.all(i),o.length>0){for(let l=0;l<o.length;l+=1)console.error(o[l]);throw o[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const n=Object.assign({},e),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await $s(this.userStorage,this.storageKey+"-user",{user:n.user});const s=Object.assign({},n);delete s.user;const o=kf(s);await $s(this.storage,this.storageKey,o)}else{const s=kf(n);await $s(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await Pr(this.storage,this.storageKey),await Pr(this.storage,this.storageKey+"-code-verifier"),await Pr(this.storage,this.storageKey+"-user"),this.userStorage&&await Pr(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Kn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Is);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/Is);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${Is}ms, refresh threshold is ${Ju} ticks`),s<=Ju&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Cm)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Kn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const s=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[o,i]=await Os(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(i)}`});s.push(l.toString())}if(r!=null&&r.queryParams){const o=new URLSearchParams(r.queryParams);s.push(o.toString())}return r!=null&&r.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:s,error:o}=n;return o?{data:null,error:o}:await Me(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(De(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,s;const{data:o,error:i}=n;if(i)return{data:null,error:i};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:u,error:c}=await Me(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((s=u==null?void 0:u.totp)===null||s===void 0)&&s.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),{data:u,error:null})})}catch(n){if(De(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:o}=n;if(o)return{data:null,error:o};const{data:i,error:l}=await Me(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:l})})}catch(n){if(De(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:o}=n;return o?{data:null,error:o}:await Me(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(De(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(e==null?void 0:e.factors)||[],s=r.filter(i=>i.factor_type==="totp"&&i.status==="verified"),o=r.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:r,totp:s,phone:o},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,r;const{data:{session:s},error:o}=e;if(o)return{data:null,error:o};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=Bl(s.access_token);let l=null;i.aal&&(l=i.aal);let u=l;((r=(n=s.user.factors)===null||n===void 0?void 0:n.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(u="aal2");const d=i.amr||[];return{data:{currentLevel:l,nextLevel:u,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(e,n={keys:[]}){let r=n.keys.find(l=>l.kid===e);if(r)return r;const s=Date.now();if(r=this.jwks.keys.find(l=>l.kid===e),r&&this.jwks_cached_at+Pv>s)return r;const{data:o,error:i}=await Me(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=s,r=o.keys.find(l=>l.kid===e),!r)?null:r}async getClaims(e,n={}){try{let r=e;if(!r){const{data:g,error:b}=await this.getSession();if(b||!g.session)return{data:null,error:b};r=g.session.access_token}const{header:s,payload:o,signature:i,raw:{header:l,payload:u}}=Bl(r);n!=null&&n.allowExpired||sx(o.exp);const c=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!c){const{error:g}=await this.getUser(r);if(g)throw g;return{data:{claims:o,header:s,signature:i},error:null}}const d=ox(s.alg),h=await crypto.subtle.importKey("jwk",c,d,!0,["verify"]);if(!await crypto.subtle.verify(d,h,i,Vv(`${l}.${u}`)))throw new Xu("Invalid JWT signature");return{data:{claims:o,header:s,signature:i},error:null}}catch(r){if(De(r))return{data:null,error:r};throw r}}}di.nextInstanceID=0;const wx=di;class Sx extends wx{constructor(e){super(e)}}var _x=function(t,e,n,r){function s(o){return o instanceof n?o:new n(function(i){i(o)})}return new(n||(n=Promise))(function(o,i){function l(d){try{c(r.next(d))}catch(h){i(h)}}function u(d){try{c(r.throw(d))}catch(h){i(h)}}function c(d){d.done?o(d.value):s(d.value).then(l,u)}c((r=r.apply(t,e||[])).next())})};class kx{constructor(e,n,r){var s,o,i;this.supabaseUrl=e,this.supabaseKey=n;const l=Nv(e);if(!n)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const u=`sb-${l.hostname.split(".")[0]}-auth-token`,c={db:xv,realtime:wv,auth:Object.assign(Object.assign({},bv),{storageKey:u}),global:vv},d=Rv(r??{},c);this.storageKey=(s=d.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(o=d.global.headers)!==null&&o!==void 0?o:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(h,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=d.auth)!==null&&i!==void 0?i:{},this.headers,d.global.fetch),this.fetch=Ev(n,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new By(new URL("rest/v1",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new mv(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new yy(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r={}){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return _x(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:s,userStorage:o,storageKey:i,flowType:l,lock:u,debug:c},d,h){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Sx({url:this.authUrl.href,headers:Object.assign(Object.assign({},p),d),storageKey:i,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:s,userStorage:o,flowType:l,lock:u,debug:c,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(g=>g.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new nv(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Ex=(t,e,n)=>new kx(t,e,n);function jx(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}jx()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Cx="https://wjylzxsfevdlhqunvfqc.supabase.co",Rx="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndqeWx6eHNmZXZkbGhxdW52ZnFjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg2ODMwOTEsImV4cCI6MjA3NDI1OTA5MX0.SuB0gd7-gefwpUHFnKsupDgo8P2VeLuMbdlsU6AMrLw",Nf=globalThis,ze=Nf.__sg_supabase||(Nf.__sg_supabase=Ex(Cx,Rx,{auth:{persistSession:!0,autoRefreshToken:!0,storageKey:"salesgame-auth"},realtime:{params:{eventsPerSecond:10}}}));function Nx(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,8)}`}function fi(){const t="sg_tab_player_id";let e=sessionStorage.getItem(t);return e||(e=Nx(),sessionStorage.setItem(t,e)),e}const Rm="sg:playerName";function Pa(){try{return String(localStorage.getItem(Rm)||"")}catch{return""}}function Nm(t){const e=String(t??"");try{localStorage.setItem(Rm,e.trim())}catch{}return sessionStorage.setItem("sg_tab_player_name",e),e}const Dx="/dynamic-data-visualization-3d.jpg",Ax="/SalesGame_Logo-removebg-preview.png",Ox="/Multiplier-Copia.png",Tx="/WhatsApp_Image_2025-06-24_at_16.47.00-removebg-preview.png";function Px({onEnter:t}){const[e,n]=j.useState(""),r=j.useRef(null);j.useEffect(()=>{var l;(l=r.current)==null||l.focus()},[]);function s(){const l=(e||"").trim();l&&(Nm(l),t==null||t(l))}function o(l){l.key==="Enter"&&s()}const i=(e||"").trim().length>0;return a.jsxs("div",{className:"start",children:[a.jsx("img",{className:"startBg",src:Dx,alt:""}),a.jsx("div",{className:"startShade"}),a.jsx("div",{className:"startHeader",children:a.jsx("img",{className:"startLogo",src:Ax,alt:"Sales GAME"})}),a.jsx("div",{className:"startCenter",children:a.jsxs("div",{className:"startCard",children:[a.jsx("label",{className:"startLabel",htmlFor:"playerName",children:"Nome do Jogador"}),a.jsx("input",{id:"playerName",ref:r,className:"startInput",placeholder:"Digite seu nome",value:e,onChange:l=>n(l.target.value),onKeyDown:o,maxLength:30}),a.jsx("button",{className:"startBtn",onClick:s,disabled:!i,"aria-disabled":!i,children:"Entrar"})]})}),a.jsxs("div",{className:"startFooter",children:[a.jsxs("div",{className:"startLinks",children:[a.jsx("div",{children:"@multiplier.educacao"}),a.jsx("div",{children:"https://multipliereducacao.com.br/"})]}),a.jsx("div",{className:"startBrand",children:a.jsx("img",{className:"startBrandLogo",src:Ox,alt:"Multiplier"})})]}),a.jsx("img",{className:"startCoach",src:Tx,alt:"",draggable:"false"})]})}async function Lx(){const{data:t,error:e}=await ze.from("lobbies").select(`
      id,
      name,
      max_players,
      status,
      created_at,
      lobby_players!left(count)
    `).order("created_at",{ascending:!0});if(e)throw e;return(t||[]).map(n=>{var r,s;return{id:n.id,name:n.name,max:n.max_players,status:n.status||"open",players:(((s=(r=n.lobby_players)==null?void 0:r[0])==null?void 0:s.count)??0)|0}})}function Ix(t){const e=ze.channel("lobbies-list").on("postgres_changes",{event:"*",schema:"public",table:"lobbies"},()=>t==null?void 0:t()).on("postgres_changes",{event:"*",schema:"public",table:"lobby_players"},()=>t==null?void 0:t()).subscribe();return()=>ze.removeChannel(e)}async function $x({name:t,hostId:e,max:n=4}){if(!e)throw new Error("hostId obrigatrio em createLobby");const s={id:typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,8)}`,name:t,host_id:e,max_players:Number(n)||4,status:"open",created_at:new Date().toISOString()},{data:o,error:i}=await ze.from("lobbies").insert(s).select("id").single();if(i)throw i;return o.id}async function Zu({lobbyId:t,playerId:e,playerName:n,ready:r=!1}){const{data:s,error:o}=await ze.from("lobbies").select("id, max_players, status, host_id").eq("id",t).single();if(o)throw o;if(s.status!=="open")throw new Error("Sala fechada.");const{count:i,error:l}=await ze.from("lobby_players").select("lobby_id",{count:"exact",head:!0}).eq("lobby_id",t);if(l)throw l;if((i||0)>=s.max_players)throw new Error("Sala cheia.");try{window.__MY_UID=e}catch{}const{error:u}=await ze.from("lobby_players").upsert({lobby_id:t,player_id:e,player_name:n,ready:!!r,joined_at:new Date().toISOString()},{onConflict:"lobby_id,player_id"});if(u)throw u;s.host_id||await ze.from("lobbies").update({host_id:e}).eq("id",t)}async function Df({lobbyId:t,playerId:e}){var l;const{data:n,error:r}=await ze.from("lobbies").select("id, host_id").eq("id",t).single();if(r)throw r;const{error:s}=await ze.from("lobby_players").delete().match({lobby_id:t,player_id:e});if(s)throw s;const{data:o,error:i}=await ze.from("lobby_players").select("player_id, joined_at").eq("lobby_id",t).order("joined_at",{ascending:!0});if(i)throw i;if(!o||o.length===0){await ze.from("lobbies").delete().eq("id",t);return}if((n==null?void 0:n.host_id)===e){const u=(l=o[0])==null?void 0:l.player_id;u&&await ze.from("lobbies").update({host_id:u}).eq("id",t)}}async function Af(t){const{data:e,error:n}=await ze.from("lobby_players").select("player_id, player_name, ready, joined_at").eq("lobby_id",t).order("joined_at",{ascending:!0});if(n)throw n;return e||[]}async function Mx({lobbyId:t,playerId:e,ready:n}){const{error:r}=await ze.from("lobby_players").update({ready:n}).match({lobby_id:t,player_id:e});if(r)throw r}async function Bx(t,e,n){return Mx({lobbyId:t,playerId:e,ready:n})}async function Ux({lobbyId:t,playerId:e,playerName:n}){const{error:r}=await ze.from("lobby_players").update({player_name:n}).match({lobby_id:t,player_id:e});if(r)throw r}async function Of(t,e){const{error:n}=await ze.from("lobbies").update({status:e}).eq("id",t);if(n)throw n}function Fx(t,e){let n=0;const r=()=>{n&&cancelAnimationFrame(n),n=requestAnimationFrame(()=>e==null?void 0:e())},s=ze.channel(`lobby-${t}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"lobby_players",filter:`lobby_id=eq.${t}`},o=>{console.debug("[rt] lobby_players:INSERT",o.new),r()}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"lobby_players",filter:`lobby_id=eq.${t}`},o=>{console.debug("[rt] lobby_players:UPDATE",o.new),r()}).on("postgres_changes",{event:"DELETE",schema:"public",table:"lobby_players",filter:`lobby_id=eq.${t}`},o=>{console.debug("[rt] lobby_players:DELETE",o.old),r()}).on("postgres_changes",{event:"*",schema:"public",table:"lobbies",filter:`id=eq.${t}`},o=>{console.debug("[rt] lobbies:*",o.new||o.old),r()}).subscribe();return()=>{n&&cancelAnimationFrame(n),ze.removeChannel(s)}}async function zx(t){const{data:e,error:n}=await ze.from("lobbies").select("id,name,status,max_players,host_id,created_at").eq("id",t).single();if(n)throw n;return e}async function Wx({lobbyId:t}){var s;const{data:e}=await ze.from("lobby_players").select("player_id, player_name, ready").eq("lobby_id",t),{data:n,error:r}=await ze.from("matches").insert({lobby_id:t,host_id:((s=e==null?void 0:e[0])==null?void 0:s.player_id)||null,state:{players:e},created_at:new Date().toISOString()}).select("id").single();if(r)throw r;return n}async function Vx(t){const{data:e,error:n}=await ze.from("matches").select("id, lobby_id, created_at").eq("lobby_id",t).order("created_at",{ascending:!1}).limit(1);if(n)throw n;return(e==null?void 0:e[0])||null}async function zl({roomCode:t,playerId:e}){if(!t||!e){console.log("[leaveRoom] Parmetros invlidos:",{roomCode:t,playerId:e});return}try{console.log(`[leaveRoom] Tentando remover jogador ${e} da sala ${t}`);const{data:n,error:r}=await ze.from("lobbies").select("id, name, host_id").eq("id",t).single();if(r){console.warn("[leaveRoom] Erro ao buscar lobby:",r);return}if(!n){console.log(`[leaveRoom] Lobby ${t} no encontrado`);return}console.log("[leaveRoom] Lobby encontrado:",n);const{error:s}=await ze.from("lobby_players").delete().match({lobby_id:t,player_id:e});s?console.warn("[leaveRoom] Erro ao remover jogador:",s):console.log(`[leaveRoom] Jogador ${e} removido do lobby ${t}`);const{data:o,error:i}=await ze.from("lobby_players").select("player_id").eq("lobby_id",t);if(i){console.warn("[leaveRoom] Erro ao contar jogadores restantes:",i);return}if(!o||o.length===0){const{error:l}=await ze.from("lobbies").delete().eq("id",t);l?console.warn("[leaveRoom] Erro ao deletar lobby vazio:",l):console.log(`[leaveRoom] Lobby ${t} deletado com sucesso (sem jogadores)`)}else if(console.log(`[leaveRoom] Jogador ${e} saiu do lobby ${t}. Restam ${o.length} jogadores.`),n.host_id===e&&o.length>0){const l=o[0].player_id,{error:u}=await ze.from("lobbies").update({host_id:l}).eq("id",t);u?console.warn("[leaveRoom] Erro ao transferir host:",u):console.log(`[leaveRoom] Host transferido para ${l}`)}}catch(n){console.error("[leaveRoom] Erro inesperado:",n)}}function Gx({onEnterRoom:t}){const[e,n]=j.useState([]),[r,s]=j.useState(!1);async function o(){s(!0);try{const c=await Lx();n(c)}finally{s(!1)}}j.useEffect(()=>(o(),Ix(()=>o())),[]);async function i(){const c=Pa();if(!String(c||"").trim()){alert("Digite seu nome na tela inicial antes de criar/entrar em salas.");return}const d=`Sala de ${c}`,h=prompt("Nome do lobby:",d)||d,p=fi();try{const g=await $x({name:h,hostId:p,max:4});await Zu({lobbyId:g,playerId:p,playerName:c,ready:!1}),t==null||t(g)}catch(g){alert(g.message||"No foi possvel criar o lobby."),await o()}}async function l(c){try{const d=Pa();if(!String(d||"").trim()){alert("Digite seu nome na tela inicial antes de entrar em salas.");return}const h=fi();await Zu({lobbyId:c,playerId:h,playerName:d,ready:!1}),t==null||t(c)}catch(d){alert(d.message||"No foi possvel entrar no lobby.")}}const u={page:{minHeight:"100vh",background:"#0f0f12",color:"#e9ecf1",padding:"32px 16px",display:"flex",justifyContent:"center"},container:{width:"100%",maxWidth:980},headerRow:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:16,marginBottom:16,flexWrap:"wrap"},title:{fontSize:28,fontWeight:800,color:"#fff"},actions:{display:"flex",gap:10},btn:{padding:"12px 16px",border:0,borderRadius:12,fontWeight:800,cursor:"pointer"},btnPrimary:{background:"#4f46e5",color:"#fff",boxShadow:"0 8px 24px rgba(79,70,229,.25)"},btnSecondary:{background:"#20222a",color:"#fff",border:"1px solid #2b2e38"},grid:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:14},card:{background:"linear-gradient(180deg, rgba(255,255,255,0.02) 0%, rgba(255,255,255,0.00) 100%)",border:"1px solid rgba(255,255,255,.08)",borderRadius:16,padding:16,display:"flex",flexDirection:"column",gap:12,boxShadow:"0 10px 20px rgba(0,0,0,.25)"},cardHeader:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:10},lobbyName:{fontSize:18,fontWeight:800,color:"#fff",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",flex:1},meta:{fontSize:13,color:"#b8c0cc"},joinBtn:{padding:"10px 14px",borderRadius:10,border:0,background:"#7c3aed",color:"#fff",fontWeight:800,cursor:"pointer",boxShadow:"0 10px 20px rgba(124,58,237,.25)"},disabled:{opacity:.6,cursor:"not-allowed",filter:"grayscale(.3)"},empty:{marginTop:24,padding:18,borderRadius:12,border:"1px dashed rgba(255,255,255,.12)",color:"#c7cfdb",textAlign:"center"}};return a.jsx("div",{style:u.page,children:a.jsxs("div",{style:u.container,children:[a.jsxs("div",{style:u.headerRow,children:[a.jsx("h2",{style:u.title,children:"SalesGame  Lobbies"}),a.jsxs("div",{style:u.actions,children:[a.jsx("button",{style:{...u.btn,...u.btnPrimary},onClick:i,children:"Criar Lobby"}),a.jsx("button",{style:{...u.btn,...u.btnSecondary},onClick:o,disabled:r,children:r?"Atualizando":"Atualizar"})]})]}),e.length===0&&!r?a.jsxs("div",{style:u.empty,children:["Nenhuma sala criada ainda. Clique em ",a.jsx("b",{children:"Criar Lobby"})," para comear."]}):a.jsx("div",{style:u.grid,children:e.map(c=>{const d=(c.players??0)>=(c.max??4),h=(c.status??"open")==="open",p=d||!h;return a.jsxs("div",{style:u.card,children:[a.jsxs("div",{style:u.cardHeader,children:[a.jsx("div",{style:u.lobbyName,title:c.name,children:c.name}),a.jsxs("span",{style:u.meta,children:[c.players??0,"/",c.max??4]})]}),a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("span",{style:u.meta,children:["status: ",c.status??"open"]}),a.jsx("button",{style:{...u.joinBtn,...p?u.disabled:{}},disabled:p,onClick:()=>l(c.id),title:p?d?"Sala cheia":"Sala no est aberta":"Entrar na sala",children:"Entrar"})]})]},c.id)})})]})})}function qx({lobbyId:t,onBack:e,onStartGame:n}){const r=fi(),s=Pa(),[o,i]=j.useState(null),[l,u]=j.useState([]),[c,d]=j.useState(!0),[h,p]=j.useState(!1),g=j.useRef(!1),b=j.useRef(!0),x=j.useRef(!1),S=j.useRef(!1),y=j.useMemo(()=>(o==null?void 0:o.host_id)===r,[o,r]),f=j.useMemo(()=>l.find(E=>E.player_id===r),[l,r]),m=j.useMemo(()=>l.filter(E=>E.ready).length,[l]),w=j.useMemo(()=>{const E=l.map(T=>String(T.player_name||"").trim().toLowerCase()).filter(Boolean);return new Set(E).size!==E.length},[l]),_=y&&(o==null?void 0:o.status)==="open"&&l.length>=1&&m===l.length;console.log("[PlayersLobby] Debug:",{players:l.length,readyCount:m,lobbyStatus:o==null?void 0:o.status,amHost:y,canStart:_,meId:r,meName:s});async function A(E){if(S.current)return;const T=await Vx(t);if(T!=null&&T.id){S.current=!0;const $=(E||[]).map((U,V)=>({id:U.player_id,name:U.player_name,index:V}));n==null||n({lobbyId:t,matchId:T==null?void 0:T.id,players:$,me:{id:r,name:s}})}}async function D(){b.current&&d(!0);try{console.log("[PlayersLobby] refreshAll - buscando lobby:",t);const[E,T]=await Promise.all([zx(t),Af(t)]);console.log("[PlayersLobby] refreshAll - lobby:",E,"players:",T),i(E),u(T);const $=T.find(U=>U.player_id===r);if(console.log("[PlayersLobby] refreshAll - mine:",$,"meId:",r),!$&&!g.current&&(E==null?void 0:E.status)==="open"){console.log("[PlayersLobby] refreshAll - entrando na sala"),g.current=!0;try{await Zu({lobbyId:t,playerId:r,playerName:s,ready:!1}),console.log("[PlayersLobby] refreshAll - entrada na sala bem-sucedida");const U=await Af(t);console.log("[PlayersLobby] refreshAll - jogadores aps entrada:",U),u(U)}catch(U){console.error("[PlayersLobby] refreshAll - erro ao entrar na sala:",U)}}if($&&!x.current&&s&&$.player_name!==s){console.log("[PlayersLobby] refreshAll - sincronizando nome"),x.current=!0;try{await Ux({lobbyId:t,playerId:r,playerName:s})}catch{}}await A(T)}catch(E){console.error("[PlayersLobby] refreshAll - erro:",E)}finally{b.current&&(b.current=!1,d(!1))}}j.useEffect(()=>{const E=()=>{Df({lobbyId:t,playerId:r}).catch(()=>{})},T=()=>E();return window.addEventListener("pagehide",T),window.addEventListener("beforeunload",T),()=>{window.removeEventListener("pagehide",T),window.removeEventListener("beforeunload",T)}},[t,r]),j.useEffect(()=>(g.current=!1,b.current=!0,x.current=!1,S.current=!1,D(),Fx(t,()=>D())),[t]);async function k(E){if(!f)return;p(!0);const T=f.ready;u($=>$.map(U=>U.player_id===r?{...U,ready:E}:U));try{await Bx(t,r,E)}catch($){u(U=>U.map(V=>V.player_id===r?{...V,ready:T}:V)),console.error("setReadyUI failed",$)}finally{p(!1)}}async function R(){try{await Df({lobbyId:t,playerId:r})}finally{e==null||e()}}async function v(){if(!_)return;const E=o==null?void 0:o.status;await Of(t,"locked");try{const T=await Wx({lobbyId:t});S.current=!0;const $=l.map((U,V)=>({id:U.player_id,name:U.player_name,index:V}));n==null||n({lobbyId:t,matchId:T==null?void 0:T.id,players:$,me:{id:r,name:s}})}catch(T){console.error("startMatch failed",T),await Of(t,E||"open")}}return a.jsx("div",{style:He.page,children:a.jsxs("div",{style:He.container,children:[a.jsxs("div",{style:He.top,children:[a.jsx("button",{style:He.backBtn,onClick:R,children:" Voltar"}),a.jsxs("h2",{style:He.title,children:["SalesGame  ",(o==null?void 0:o.name)||"..."]})]}),a.jsxs("div",{style:He.table,children:[a.jsxs("div",{style:He.thead,children:[a.jsx("div",{style:He.colPlayer,children:"Jogador"}),a.jsx("div",{style:He.colReady,children:"Pronto?"})]}),c?a.jsx("div",{style:He.loading,children:"Carregando..."}):l.map(E=>a.jsxs("div",{style:He.row,children:[a.jsxs("div",{style:He.colPlayer,children:[a.jsx("span",{style:He.avatar,children:(E.player_name||"?").slice(0,2).toLowerCase()}),a.jsx("span",{children:E.player_name||"Annimo"}),(o==null?void 0:o.host_id)===E.player_id&&a.jsx("span",{style:He.badgeHost,children:"Host"}),E.player_id===r&&a.jsx("span",{style:He.badgeYou,children:"Voc"})]}),a.jsx("div",{style:He.colReady,children:E.player_id===r?a.jsxs("div",{style:{display:"flex",gap:8},children:[a.jsx("button",{style:{...He.btn,...f!=null&&f.ready?He.btnGhost:He.btnDark},onClick:()=>k(!1),disabled:h||!(f!=null&&f.ready),children:"No pronto"}),a.jsxs("button",{style:{...He.btn,...f!=null&&f.ready?He.btnPrimary:He.btnPurple},onClick:()=>k(!0),disabled:h||!!(f!=null&&f.ready),children:[" ",f!=null&&f.ready?"Pronto":"Ficar pronto"]})]}):a.jsx("span",{style:E.ready?He.pillReady:He.pillWait,children:E.ready?"Pronto":"Aguardando"})})]},E.player_id))]}),a.jsxs("div",{style:He.footer,children:[a.jsxs("div",{style:He.statusWrap,children:[a.jsx("span",{style:{...He.dot,background:(o==null?void 0:o.status)==="open"?"#22c55e":"#f59e0b"}}),a.jsxs("span",{children:["status: ",(o==null?void 0:o.status)||"..."]}),a.jsxs("span",{style:{marginLeft:12},children:["Prontos: ",m,"/",l.length]})]}),w&&a.jsx("div",{style:{marginTop:8,color:"#ffd54f",fontWeight:800},children:" Aviso: existe nome duplicado na sala. (A identidade  pelo ID; renomear evita confuso.)"}),a.jsxs("div",{style:{display:"flex",gap:12},children:[a.jsx("button",{style:{...He.btn,..._?He.btnPrimary:He.disabled},onClick:v,disabled:!_,children:"Iniciar partida"}),a.jsx("button",{style:{...He.btn,...He.btnDark},onClick:R,children:"Sair da sala"})]})]})]})})}const He={page:{minHeight:"100vh",background:"#0f0f12",color:"#e9ecf1",padding:"24px 16px",display:"flex",justifyContent:"center"},container:{width:"100%",maxWidth:980},top:{display:"flex",alignItems:"center",gap:12,marginBottom:16},backBtn:{padding:"10px 14px",background:"#20222a",border:"1px solid #2b2e38",borderRadius:12,color:"#fff",cursor:"pointer"},title:{margin:0,fontSize:28,fontWeight:800},table:{background:"rgba(255,255,255,.02)",border:"1px solid rgba(255,255,255,.08)",borderRadius:16,overflow:"hidden"},thead:{display:"grid",gridTemplateColumns:"1fr 220px",padding:"12px 16px",borderBottom:"1px solid rgba(255,255,255,.08)",color:"#c7cfdb"},row:{display:"grid",gridTemplateColumns:"1fr 220px",padding:"12px 16px",borderBottom:"1px solid rgba(255,255,255,.06)"},colPlayer:{display:"flex",alignItems:"center",gap:10,minWidth:0},colReady:{display:"flex",alignItems:"center",justifyContent:"flex-end"},avatar:{width:28,height:28,borderRadius:999,background:"#1f2430",display:"grid",placeItems:"center",color:"#c7cfdb",fontSize:12,textTransform:"lowercase"},badgeHost:{marginLeft:8,fontSize:12,background:"#fde68a",color:"#111827",padding:"2px 8px",borderRadius:999,fontWeight:800},badgeYou:{marginLeft:8,fontSize:12,background:"#bfdbfe",color:"#111827",padding:"2px 8px",borderRadius:999,fontWeight:800},loading:{padding:16,color:"#c7cfdb"},pillReady:{background:"rgba(34,197,94,.15)",color:"#22c55e",padding:"6px 10px",borderRadius:999,fontWeight:700},pillWait:{background:"rgba(245,158,11,.14)",color:"#f59e0b",padding:"6px 10px",borderRadius:999,fontWeight:700},footer:{display:"flex",alignItems:"center",justifyContent:"space-between",marginTop:16},statusWrap:{display:"flex",alignItems:"center",gap:6,color:"#c7cfdb"},dot:{width:8,height:8,borderRadius:"50%"},btn:{padding:"12px 16px",border:0,borderRadius:12,fontWeight:800,cursor:"pointer"},btnPrimary:{background:"#4f46e5",color:"#fff",boxShadow:"0 8px 24px rgba(79,70,229,.25)"},btnPurple:{background:"#7c3aed",color:"#fff"},btnDark:{background:"#20222a",color:"#fff",border:"1px solid #2b2e38"},btnGhost:{background:"transparent",color:"#e9ecf1",border:"1px solid rgba(255,255,255,.15)"},disabled:{opacity:.5,cursor:"not-allowed",filter:"grayscale(.25)"}},Hx="/board.jpg",ec=800,tc=700,sl=[{nx:.9278494291885221,ny:.9008218764923216},{nx:.8188460351743289,ny:.9120818357755046},{nx:.7145819191607529,ny:.920124663834921},{nx:.6016291268127121,ny:.920124663834921},{nx:.49104597346497997,ny:.9233417950586875},{nx:.37888306078370876,ny:.920124663834921},{nx:.24618327676643012,ny:.9152989669992712},{nx:.21695772909595804,ny:.7994822429436751},{nx:.1853625424251774,ny:.7270967904089275},{nx:.1340203640851589,ny:.6354085505315806},{nx:.12851782363977485,ny:.5145797598627787},{nx:.12664165103189493,ny:.37392795883361923},{nx:.05347091932457786,ny:.30017152658662094},{nx:.051594746716697934,ny:.20240137221269297},{nx:.14540337711069418,ny:.12006861063464837},{nx:.23921200750469043,ny:.11663807890222985},{nx:.3771106941838649,ny:.11663807890222985},{nx:.5037523452157598,ny:.12006861063464837},{nx:.5975609756097561,ny:.1320754716981132},{nx:.5984990619136961,ny:.24356775300171526},{nx:.5065666041275797,ny:.2692967409948542},{nx:.398686679174484,ny:.27101200686106347},{nx:.28893058161350843,ny:.27101200686106347},{nx:.2373358348968105,ny:.3687821612349914},{nx:.23921200750469043,ny:.48027444253859347},{nx:.24202626641651032,ny:.5660377358490566},{nx:.26454033771106944,ny:.6895368782161235},{nx:.3330206378986867,ny:.6946826758147513},{nx:.35647279549718575,ny:.5831903945111492},{nx:.35647279549718575,ny:.4716981132075472},{nx:.3818011257035647,ny:.37735849056603776},{nx:.5225140712945591,ny:.3653516295025729},{nx:.6238273921200751,ny:.3687821612349914},{nx:.7223264540337712,ny:.40308747855917665},{nx:.6613508442776735,ny:.5197255574614065},{nx:.5300187617260788,ny:.5025728987993139},{nx:.4427767354596623,ny:.5694682675814752},{nx:.4896810506566604,ny:.6861063464837049},{nx:.6163227016885553,ny:.6861063464837049},{nx:.724202626641651,ny:.6861063464837049},{nx:.8273921200750469,ny:.660377358490566},{nx:.8395872420262664,ny:.5368782161234992},{nx:.8395872420262664,ny:.4339622641509434},{nx:.8283302063789869,ny:.313893653516295},{nx:.7176360225140713,ny:.30017152658662094},{nx:.6876172607879925,ny:.22298456260720412},{nx:.698874296435272,ny:.1457975986277873},{nx:.8020637898686679,ny:.11663807890222985},{nx:.8958724202626641,ny:.11663807890222985},{nx:.9446529080675422,ny:.21783876500857632},{nx:.9446529080675422,ny:.3293310463121784},{nx:.9380863039399625,ny:.45797598627787306},{nx:.9409005628517824,ny:.5711835334476844},{nx:.950281425891182,ny:.6723842195540308},{nx:.9540337711069419,ny:.7804459691252144}],vs=sl.length;function Dm(t,e,n){return{x:t.nx*e,y:t.ny*n}}sl.map(t=>[t.nx*ec,t.ny*tc]);function Kx({visible:t=!0,boardWidth:e,boardHeight:n}){return t?a.jsx("div",{className:"markersLayer",children:sl.map((r,s)=>{const{x:o,y:i}=Dm(r,e,n);return a.jsx("div",{className:"marker",style:{left:o,top:i},title:`Casa ${s+1}`,children:s+1},s)})}):null}function Jx({boardRef:t,expected:e=55,onFinish:n,initial:r=[]}){const[s,o]=j.useState(r);function i(g){if(!(t!=null&&t.current))return;const b=t.current.getBoundingClientRect(),x=g.clientX-b.left,S=g.clientY-b.top,y=x/b.width,f=S/b.height;o(m=>m.length>=e?m:[...m,{nx:y,ny:f}])}function l(){o(g=>g.slice(0,-1))}function u(){o([])}const c=j.useMemo(()=>JSON.stringify(s,null,2),[s]);async function d(){try{await navigator.clipboard.writeText(c),alert("Copiado para a rea de transferncia!")}catch{alert("No foi possvel copiar. Use o boto Baixar.")}}function h(){const g=new Blob([c],{type:"application/json"}),b=URL.createObjectURL(g),x=document.createElement("a");x.href=b,x.download="track-points-55.json",document.body.appendChild(x),x.click(),x.remove(),URL.revokeObjectURL(b)}function p(){n==null||n(s),console.log(`TRACK_POINTS_NORM (cole em src/data/track.js):
`,c),alert("Finalizado! O JSON foi impresso no console. Copie e cole em src/data/track.js")}return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"recLayer",onClick:i}),a.jsx("div",{className:"recDotsLayer",pointerEvents:"none",children:s.map((g,b)=>a.jsx("div",{className:"recDot",style:{left:`${g.nx*100}%`,top:`${g.ny*100}%`},title:`Casa ${b+1}`,children:b+1},b))}),a.jsxs("div",{className:"recToolbar",children:[a.jsxs("div",{className:"recInfo",children:[a.jsx("b",{children:"Gravando trilha"}),"  clique nas casas na ordem.",a.jsxs("span",{children:["Marcados: ",a.jsx("b",{children:s.length})," / ",e]})]}),a.jsxs("div",{className:"recBtns",children:[a.jsx("button",{onClick:l,disabled:!s.length,children:"Desfazer"}),a.jsx("button",{onClick:u,disabled:!s.length,children:"Limpar"}),a.jsx("button",{onClick:d,disabled:!s.length,children:"Copiar JSON"}),a.jsx("button",{onClick:h,disabled:!s.length,children:"Baixar .json"}),a.jsx("button",{onClick:p,disabled:s.length!==e,children:"Finalizar"})]})]})]})}const Yx=40,Qx=1.15,Xx=3,Zx="0 8px 18px rgba(0,0,0,.35)",Tf={cash:18e3,possibAt:0,clientsAt:0,faturamento:770,manutencao:1150,emprestimos:0,vendedoresComuns:0,fieldSales:0,insideSales:0,mixDBens:4e3,erpClientes:0,manualOnboarding:!0,azul:0,amarelo:0,roxo:0,gestores:0};function eb({players:t,turnIdx:e,recordTrack:n=!1,matchId:r,me:s,onMeHud:o}){const i=j.useRef(null),[l,u]=j.useState({w:ec,h:tc}),c=(s==null?void 0:s.id)||fi(),d=Pa()||"Jogador",h=j.useMemo(()=>(t==null?void 0:t.find(w=>w.id===c))||null,[t,c]),p=(s==null?void 0:s.name)||(h==null?void 0:h.name)||d,g=(h==null?void 0:h.color)||"#6c5ce7",b=j.useMemo(()=>`sg_stats_v1:${r||"local"}:${c}`,[r,c]),[x,S]=j.useState(()=>{try{const w=sessionStorage.getItem(b);return w?JSON.parse(w):Tf}catch{return Tf}});j.useEffect(()=>{try{sessionStorage.setItem(b,JSON.stringify(x))}catch{}},[b,x]),j.useEffect(()=>{const w={id:c,name:p,color:g,cash:x.cash,possibAt:x.possibAt,clientsAt:x.clientsAt,matchId:r||"local"};o==null||o(w),document.dispatchEvent(new CustomEvent("sg:meHud",{detail:w}))},[c,p,g,x.cash,x.possibAt,x.clientsAt,r]),j.useLayoutEffect(()=>{if(!i.current)return;const w=i.current,_=new ResizeObserver(A=>{for(const D of A){const k=D.contentRect;u({w:k.width,h:k.height})}});return _.observe(w),()=>_.disconnect()},[]);const y=l.w/ec,f=l.h/tc,m=Math.min(y,f);return a.jsxs("div",{className:"board",ref:i,children:[a.jsx("img",{src:Hx,alt:"Board",className:"boardImg"}),n&&a.jsx(Jx,{boardRef:i,expected:55,onFinish:w=>{console.log("TRACK_POINTS_NORM (cole em src/data/track.js):",JSON.stringify(w,null,2))}}),!n&&a.jsxs(a.Fragment,{children:[a.jsx(Kx,{visible:!1,boardWidth:l.w,boardHeight:l.h}),t.map((w,_)=>{var at;const A=(at=t==null?void 0:t[e])==null?void 0:at.id,D=String(w==null?void 0:w.id)===String(A),k=(w.pos%vs+vs)%vs,R=sl[k],v=Dm(R,l.w,l.h),E=_*12*m,$=Yx*m*(D?Qx:1),U=Math.max(2,Xx*m),V=["","","","","","","",""],Je=V[_%V.length];return a.jsx("div",{className:"token",style:{position:"absolute",left:v.x+E,top:v.y-E,transform:"translate(-50%, -50%)",width:$,height:$,borderRadius:"50%",background:w.color,border:`${U}px solid rgba(255,255,255,.95)`,boxShadow:Zx,pointerEvents:"none",display:"grid",placeItems:"center",color:"#000",fontWeight:900,userSelect:"none",zIndex:D?4:3,fontSize:`${Math.max(16,$*.6)}px`},title:`${w.name}  Casa ${k+1}`,"aria-label":`${w.name} est na casa ${k+1}`,children:D?"":Je},w.id)})]})]})}function tb({totals:t,players:e}){return j.useEffect(()=>{console.groupCollapsed("[HUD] totals"),console.log(t),console.groupEnd()},[t]),a.jsxs("div",{className:"hud",children:[a.jsxs("div",{className:"panel",children:[a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Faturamento:"})," ",a.jsxs("span",{className:"pos",children:["$ ",t.faturamento]})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Manuteno:"})," ",a.jsxs("span",{className:"neg",children:["$ ",t.manutencao]})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Emprstimos:"})," ",a.jsxs("span",{children:["$ ",t.emprestimos]})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Vendedores Comuns:"})," ",a.jsx("span",{children:t.vendedoresComuns})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Field Sales:"})," ",a.jsx("span",{children:t.fieldSales})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Inside Sales:"})," ",a.jsx("span",{children:t.insideSales})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"Mix Produtos:"})," ",a.jsx("span",{children:t.mixProdutos})," ",a.jsx("b",{children:" Bens:"})," ",a.jsxs("span",{children:["$ ",t.bens]})]}),a.jsxs("div",{className:"line",children:[a.jsx("b",{children:"ERP/Sistemas:"})," ",a.jsx("span",{children:t.erpSistemas})," ",a.jsx("b",{children:" Clientes:"})," ",a.jsx("span",{children:t.clientes})]}),a.jsxs("div",{children:[a.jsx("b",{children:"Manual Onboarding:"})," "]}),a.jsxs("div",{children:[a.jsx("b",{children:"Azul:"})," ",a.jsx("span",{children:t.az||0})," ",a.jsx("b",{children:" Amarelo: "}),a.jsx("span",{children:t.am||0})," ",a.jsx("b",{children:"Roxo:"})," ",a.jsx("span",{children:t.rox||0})]}),a.jsxs("div",{children:[a.jsx("b",{children:"Gestores Comerciais:"})," ",a.jsx("span",{children:t.gestores??t.gestoresComerciais??0})]}),a.jsxs("div",{children:[a.jsx("b",{children:"Capacidade:"})," ",a.jsx("span",{children:t.possibAt??0}),"  ",a.jsx("b",{children:"Em Atendimento:"})," ",a.jsx("span",{children:t.clientsAt??0})]})]}),a.jsxs("div",{className:"score",children:[a.jsx("div",{className:"title",children:"Placar"}),e.map(n=>a.jsxs("div",{className:"row",children:[a.jsx("span",{children:n.name}),a.jsx("span",{children:n.cash})]},n.id))]})]})}function nb({onAction:t,current:e,isMyTurn:n=!1,myUid:r,turnPlayerId:s,turnLock:o=!1,lockOwner:i=null,modalLocks:l=0,gameOver:u=!1}){const c=!!(e!=null&&e.bankrupt),d=s!=null&&r!=null&&String(s)===String(r),h=!!s&&d&&o===!1&&Number(l||0)===0&&u!==!0&&!c;j.useEffect(()=>{console.log("[CAN_ROLL_CHECK]",{myUid:r,turnPlayerId:s,isMyTurn:d,turnLock:o,modalLocks:l,gameOver:u,bankrupt:c,result:h})},[r,s,d,o,l,u,c,h]);const p=()=>{if(console.log("[Controls] click => Rolar Dado & Andar (canRoll=%s)",h),!h)return;if(s!=null&&r!=null&&String(s)!==String(r)){console.warn("[ROLL_BLOCK][Controls] not my turn",{turnPlayerId:s,myUid:r});return}if(o)return;const x=Math.floor(Math.random()*6)+1,S=0,y=`Dado: ${x}`;console.log("[Controls] onAction ROLL => steps=%d cashDelta=%d note=%s",x,S,y),t==null||t({type:"ROLL",steps:x,cashDelta:S,note:y})},g=async()=>{c||(console.log("[Controls] click => Recuperao Financeira"),t==null||t({type:"RECOVERY_MODAL"}))},b=async()=>{c||(console.log("[Controls] click => Declarar Falncia"),t==null||t({type:"BANKRUPT_MODAL"}))};return a.jsxs("div",{className:`controls ${h?"":"is-wait"} ${c?"is-bankrupt":""}`,children:[a.jsx("button",{className:"btn primary",onClick:g,disabled:c,"aria-disabled":c,children:"RECUPERAO FINANCEIRA"}),a.jsx("button",{className:"btn dark",onClick:b,disabled:c,"aria-disabled":c,children:"DECLARAR FALNCIA"}),a.jsxs("div",{className:"turnBox",children:[a.jsxs("div",{children:["Vez de: ",a.jsx("b",{children:e==null?void 0:e.name})]}),a.jsx("button",{className:"btn go",onClick:p,disabled:!h,"aria-disabled":!h,children:"Rolar Dado & Andar"})]})]})}function wi({children:t,onClose:e,zIndex:n=3e3}){const r=()=>{typeof e=="function"&&e()};return a.jsx("div",{className:"sg-modal-backdrop",style:{position:"fixed",inset:0,background:"rgba(8,10,16,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:n},onClick:r,children:a.jsx("div",{className:"sg-modal-card",style:{position:"relative",background:"#0f1420",border:"1px solid rgba(255,255,255,.1)",borderRadius:14,width:"min(780px, 92vw)",maxWidth:"92vw",color:"#fff",boxShadow:"0 20px 60px rgba(0,0,0,.45)"},onClick:s=>s.stopPropagation(),children:t})})}function rb({players:t=[],onExit:e,onResolve:n}){const r=j.useMemo(()=>{const u=[...t].map(c=>({...c,patrimonio:(Number(c.cash)||0)+(Number(c.bens)||0)})).sort((c,d)=>d.patrimonio-c.patrimonio);return[u[1],u[0],u[2]]},[t]),s=r==null?void 0:r[1],o=r==null?void 0:r[0],i=r==null?void 0:r[2],l=()=>{n?n({action:"EXIT"}):e==null||e()};return a.jsx(wi,{zIndex:2147483647,onClose:()=>{},children:a.jsxs("div",{style:Zn.wrap,children:[a.jsx("h1",{style:Zn.title,children:" Fim da 5 Rodada"}),a.jsxs("p",{style:Zn.subtitle,children:["Vence quem tiver ",a.jsx("b",{children:"Saldo + Bens"}),". Eis o pdio:"]}),a.jsxs("div",{style:Zn.podium,children:[a.jsx(Wl,{place:"second",player:o}),a.jsx(Wl,{place:"first",player:s,big:!0}),a.jsx(Wl,{place:"third",player:i})]}),a.jsx("div",{style:{display:"flex",gap:12,marginTop:18,flexWrap:"wrap",justifyContent:"center"},children:a.jsx("button",{style:Zn.btn,onClick:l,children:" Voltar aos Lobbies"})})]})})}function Wl({place:t,player:e,big:n}){if(!e)return a.jsx("div",{style:{width:220}});const r={first:Vl("#d4af37","#f5d76e"),second:Vl("#9fa4ad","#cfd4db"),third:Vl("#b87333","#d28c45")},s={first:"1",second:"2",third:"3"}[t],o=r[t].ring,i=r[t].face;return a.jsxs("div",{style:{...Zn.medalCol,transform:n?"translateY(-18px)":"none"},children:[a.jsx("div",{style:Zn.ribbon}),a.jsx("div",{style:{...Zn.medal,...o,width:n?180:150,height:n?180:150},children:a.jsx("div",{style:{...Zn.medalFace,...i},children:a.jsx("div",{style:Zn.medalNumber,children:s})})}),a.jsxs("div",{style:Zn.cardBelow,children:[a.jsx("div",{style:{fontWeight:900,fontSize:16,lineHeight:1.2,textAlign:"center"},children:e.name}),a.jsxs("div",{style:{opacity:.9,fontSize:13,marginTop:4,textAlign:"center"},children:["Saldo: ",a.jsxs("b",{children:["$ ",Number(e.cash||0).toLocaleString()]}),a.jsx("br",{}),"Bens: ",a.jsxs("b",{children:["$ ",Number(e.bens||0).toLocaleString()]})]}),a.jsxs("div",{style:{marginTop:6,fontWeight:900,textAlign:"center"},children:["Patrimnio: ",a.jsxs("b",{children:["$ ",Number(e.patrimonio||0).toLocaleString()]})]})]})]})}function Vl(t,e){return{ring:{background:`radial-gradient(circle at 35% 30%, ${e} 0%, ${t} 65%, #000 120%)`,boxShadow:"0 12px 30px rgba(0,0,0,.35), inset 0 0 12px rgba(255,255,255,.12)"},face:{background:`conic-gradient(from 0deg, ${e}, ${t}, ${e})`}}}const Zn={wrap:{pointerEvents:"auto",border:"1px solid rgba(255,255,255,.15)",background:"#11161f",color:"#eef1f6",borderRadius:16,padding:20,width:"min(900px, 92vw)",maxWidth:"92vw",textAlign:"center"},title:{margin:"0 0 6px",fontWeight:900,fontSize:28},subtitle:{margin:"0 0 14px",opacity:.9},podium:{display:"flex",alignItems:"flex-end",justifyContent:"center",gap:24,padding:"10px 0",flexWrap:"wrap"},medalCol:{display:"flex",flexDirection:"column",alignItems:"center"},ribbon:{width:16,height:70,background:"linear-gradient(#e41f1f,#9e1313)",borderRadius:4,marginBottom:-12},medal:{borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",border:"3px solid rgba(255,255,255,.18)"},medalFace:{width:"85%",height:"85%",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"inset 0 8px 18px rgba(0,0,0,.35), inset 0 -6px 10px rgba(255,255,255,.08)"},medalNumber:{fontWeight:900,fontSize:28,letterSpacing:1,textShadow:"0 2px 4px rgba(0,0,0,.45)"},cardBelow:{background:"#19202c",border:"1px solid rgba(255,255,255,.12)",borderRadius:12,padding:"10px 12px",width:220,marginTop:10},btn:{background:"#2a3342",color:"#fff",border:"1px solid rgba(255,255,255,.18)",borderRadius:10,padding:"10px 14px",fontWeight:800,cursor:"pointer"}},Am=j.createContext(null);function sb({children:t}){const[e,n]=j.useState([]),r=j.useRef(null),s=d=>{const h=r.current;r.current=null,n(p=>p.slice(0,-1)),h&&h(d)},o=()=>s({action:"SKIP"}),i=()=>s(!1),l=d=>{var g;const h=((g=crypto==null?void 0:crypto.randomUUID)==null?void 0:g.call(crypto))||String(Date.now()+Math.random()),p=ce.cloneElement(d,{onResolve:b=>s(b)});n(b=>[...b,{id:h,el:p}])},u=()=>new Promise(d=>{r.current=d}),c=j.useMemo(()=>({pushModal:l,awaitTop:u,resolveTop:s,closeModal:o,popModal:i}),[]);return a.jsxs(Am.Provider,{value:c,children:[t,e.map(({id:d,el:h})=>a.jsx(ce.Fragment,{children:h},d))]})}const hn=()=>j.useContext(Am);function ob({playerName:t="Jogador"}){const{resolveTop:e,closeModal:n}=hn();return a.jsx(wi,{width:700,onClose:n,children:a.jsx("div",{className:"bankruptcyModal",children:a.jsxs("div",{className:"paper",style:{padding:24},children:[a.jsx("h2",{style:{marginTop:0},children:"Declarar Falncia"}),a.jsxs("p",{children:["Tem certeza que deseja declarar ",a.jsx("b",{children:"Falncia"}),", ",a.jsx("b",{children:t}),"?",a.jsx("br",{}),"Esta ao  irreversvel e voc no poder mais jogar."]}),a.jsxs("div",{style:{display:"flex",gap:12,justifyContent:"flex-end",marginTop:24},children:[a.jsx("button",{onClick:()=>{n(),e(!1)},className:"btn",children:"Cancelar"}),a.jsx("button",{onClick:()=>{n(),e(!0)},className:"btn btn-danger",children:"Sim, declarar falncia"})]})]})})})}const Te={comum:{cap:2,baseFat:600,incFat:100,baseDesp:1e3,incDesp:100},inside:{cap:5,baseFat:1500,incFat:500,baseDesp:2e3,incDesp:100},field:{cap:5,baseFat:1500,incFat:500,baseDesp:2e3,incDesp:100},gestor:{baseDesp:3e3,incDesp:500}},cr={A:{fat:1e3,desp:400},B:{fat:500,desp:200},C:{fat:200,desp:100},D:{fat:70,desp:50}},dr={A:{fatPerClient:1200,despPerClient:700},B:{fatPerClient:600,despPerClient:400},C:{fatPerClient:300,despPerClient:200},D:{fatPerClient:100,despPerClient:50}},La=[0,.2,.3,.4,.6],Om=7,dn=t=>Number(t||0),Sr=(t={},e)=>{var n;return new Set(((n=t==null?void 0:t.trainingsByVendor)==null?void 0:n[e])||[]).size},ib=t=>Sr(t,"gestor");function Ia(t={}){const e=Math.max(0,dn(t.vendedoresComuns)),n=Math.max(0,dn(t.insideSales)),r=Math.max(0,dn(t.fieldSales)),s=e*Te.comum.cap,o=n*Te.inside.cap,i=r*Te.field.cap,l=s+o+i,u=Math.max(0,dn(t.clients)),c=Math.min(u,l);return{cap:l,inAtt:c}}function ol(t={}){var k,R;const e=dn(t.vendedoresComuns),n=dn(t.insideSales),r=dn(t.fieldSales),s=dn(t.gestores??t.gestoresComerciais??t.managers),o=Sr(t,"comum"),i=Sr(t,"inside"),l=Sr(t,"field"),u=Sr(t,"gestor"),c=e*(Te.comum.baseFat+Te.comum.incFat*o),d=n*(Te.inside.baseFat+Te.inside.incFat*i),h=r*(Te.field.baseFat+Te.field.incFat*l);let p=c+d+h;const g=e+n+r,b=g>0?Math.min(1,s*Om/g):0,x=Math.max(0,u),S=La[Math.min(x,La.length-1)]||0;p=p*(1+b*S);const y=String(t.mixProdutos||"D").toUpperCase(),f=(((k=dr[y])==null?void 0:k.fatPerClient)||0)*dn(t.clients),m=String(t.erpLevel||"D").toUpperCase(),w=g+s,_=(((R=cr[m])==null?void 0:R.fat)||0)*w,A=dn(t.revenue);return Math.max(0,Math.floor(p+f+_+A))}function il(t={}){var _,A;const e=dn(t.vendedoresComuns),n=dn(t.insideSales),r=dn(t.fieldSales),s=dn(t.gestores??t.gestoresComerciais??t.managers),o=Sr(t,"comum"),i=Sr(t,"inside"),l=Sr(t,"field"),u=Sr(t,"gestor"),c=e*(Te.comum.baseDesp+Te.comum.incDesp*o),d=n*(Te.inside.baseDesp+Te.inside.incDesp*i),h=r*(Te.field.baseDesp+Te.field.incDesp*l),p=s*(Te.gestor.baseDesp+Te.gestor.incDesp*u),g=String(t.mixProdutos||"D").toUpperCase(),b=(((_=dr[g])==null?void 0:_.despPerClient)||0)*dn(t.clients),x=String(t.erpLevel||"D").toUpperCase(),S=e+n+r+s,y=(((A=cr[x])==null?void 0:A.desp)||0)*S;return Math.max(0,Math.floor(c+d+h+p+b+y+0+1e3))}function Vt(t,e={}){var s,o;const n={...t},r=(i,l)=>{n[i]=(n[i]??0)+l};if(Number.isFinite(e.cashDelta)&&r("cash",Number(e.cashDelta)),Number.isFinite(e.clientsDelta)&&r("clients",Number(e.clientsDelta)),Number.isFinite(e.manutencaoDelta)&&r("manutencao",Number(e.manutencaoDelta)),Number.isFinite(e.bensDelta)&&r("bens",Number(e.bensDelta)),Number.isFinite(e.vendedoresComunsDelta)&&r("vendedoresComuns",Number(e.vendedoresComunsDelta)),Number.isFinite(e.fieldSalesDelta)&&r("fieldSales",Number(e.fieldSalesDelta)),Number.isFinite(e.insideSalesDelta)&&r("insideSales",Number(e.insideSalesDelta)),Number.isFinite(e.gestoresDelta)){const i=Number(e.gestoresDelta);n.gestores=(n.gestores??0)+i,n.gestoresComerciais=(n.gestoresComerciais??0)+i,n.managers=(n.managers??0)+i}if(Number.isFinite(e.revenueDelta)&&r("revenue",Number(e.revenueDelta)),typeof e.mixProdutosSet<"u"){n.mixProdutos=e.mixProdutosSet;const i=String(e.mixProdutosSet).toUpperCase();["A","B","C","D"].includes(i)&&(n.mixOwned={...n.mixOwned||{},[i]:!0},(s=n.reducedLevels)!=null&&s.MIX&&(n.reducedLevels={...n.reducedLevels,MIX:n.reducedLevels.MIX.filter(l=>l!==i)}))}if(e.mixBaseSet&&(n.mixBase={...n.mixBase||{},...e.mixBaseSet}),typeof e.erpLevelSet<"u"){n.erpLevel=e.erpLevelSet;const i=String(e.erpLevelSet).toUpperCase();["A","B","C","D"].includes(i)&&(n.erpOwned={...n.erpOwned||{},[i]:!0},(o=n.reducedLevels)!=null&&o.ERP&&(n.reducedLevels={...n.reducedLevels,ERP:n.reducedLevels.ERP.filter(l=>l!==i)}))}return Array.isArray(e.trainingsPush)&&e.trainingsPush.length&&(n.trainings=[...n.trainings||[],...e.trainingsPush]),Array.isArray(e.directBuysPush)&&e.directBuysPush.length&&(n.directBuys=[...n.directBuys||[],...e.directBuysPush]),n}function Pf(t,e){const{purchases:n=[],grandTotal:r=0}=e||{},s={personalizado:"az",fieldsales:"am",imersaomultiplier:"rox"},o={...t};return o.cash=(o.cash??0)-Number(r||0),o.bens=(o.bens??0)+Number(r||0),o.onboarding=!0,n.forEach(i=>{var h;const{vendorType:l,items:u=[]}=i||{};u.forEach(p=>{const g=s[p==null?void 0:p.id];g&&(o[g]=(o[g]??0)+1)});const c=String(l||"comum"),d=new Set(((h=o.trainingsByVendor)==null?void 0:h[c])||[]);u.forEach(p=>{p!=null&&p.id&&d.add(p.id)}),o.trainingsByVendor={...o.trainingsByVendor||{},[c]:Array.from(d)}}),o}function Gl(t,e,n){return t===e?!1:t<e?n>t&&n<=e:n>t||n<=e}function Ho(t){return t.reduce((e,n)=>e+(n!=null&&n.bankrupt?0:1),0)}function No(t,e){var o;const n=t.length;if(n===0)return 0;let r=(e+1)%n,s=0;for(;s<n;){if(!((o=t[r])!=null&&o.bankrupt))return r;r=(r+1)%n,s++}return e}class Tm{constructor(){this.errors=[],this.warnings=[]}validateGameState(e,n,r,s,o){return this.errors=[],this.warnings=[],this.validatePlayers(e),this.validateTurnState(e,n),this.validateGameOverState(e,s,o),this.validateRoundState(e,r),{isValid:this.errors.length===0,errors:this.errors,warnings:this.warnings}}validatePlayers(e){if(!Array.isArray(e)||e.length===0){this.addError("Jogadores invlidos: deve ser um array no vazio");return}e.forEach((n,r)=>{this.validatePlayer(n,r)}),this.validatePlayerUniqueness(e),this.validateAlivePlayers(e)}validatePlayer(e,n){const r=`Jogador ${n+1} (${e.name||"Sem nome"})`;e.id||this.addError(`${r}: ID  obrigatrio`),(typeof e.cash!="number"||e.cash<0)&&this.addError(`${r}: Cash deve ser um nmero no negativo (atual: ${e.cash})`),(typeof e.clients!="number"||e.clients<0)&&this.addError(`${r}: Clientes deve ser um nmero no negativo (atual: ${e.clients})`),this.validateResourceCounts(e,r),this.validateCalculations(e,r)}validateResourceCounts(e,n){["vendedoresComuns","fieldSales","insideSales","gestores","gestoresComerciais","managers"].forEach(o=>{const i=e[o];i!==void 0&&(typeof i!="number"||i<0)&&this.addError(`${n}: ${o} deve ser um nmero no negativo (atual: ${i})`)}),["az","am","rox"].forEach(o=>{const i=e[o];i!==void 0&&(typeof i!="number"||i<0)&&this.addError(`${n}: Certificado ${o} deve ser um nmero no negativo (atual: ${i})`)})}validateCalculations(e,n){try{const r=ol(e),s=il(e),{cap:o,inAtt:i}=Ia(e);(typeof r!="number"||r<0)&&this.addError(`${n}: Faturamento calculado invlido: ${r}`),(typeof s!="number"||s<0)&&this.addError(`${n}: Manuteno calculada invlida: ${s}`),(typeof o!="number"||o<0)&&this.addError(`${n}: Capacidade calculada invlida: ${o}`),(typeof i!="number"||i<0||i>o)&&this.addError(`${n}: Clientes em atendimento invlido: ${i} (capacidade: ${o})`),this.isInitialState(e)&&s!==1150&&this.addError(`${n}: Manuteno inicial deve ser 1150, mas  ${s}`)}catch(r){this.addError(`${n}: Erro ao calcular faturamento/manuteno: ${r.message}`)}}isInitialState(e){return e.vendedoresComuns===1&&e.clients===1&&e.fieldSales===0&&e.insideSales===0&&e.gestores===0&&e.mixProdutos==="D"&&e.erpLevel==="D"&&(e.az||0)===0&&(e.am||0)===0&&(e.rox||0)===0}validatePlayerUniqueness(e){const n=e.map(s=>s.id).filter(Boolean),r=new Set(n);n.length!==r.size&&this.addError("IDs de jogadores devem ser nicos")}validateAlivePlayers(e){const n=Ho(e);n===0&&this.addError("No pode haver zero jogadores vivos"),n===1&&this.addWarning("Apenas 1 jogador vivo - jogo deve terminar")}validateTurnState(e,n){if(typeof n!="number"||n<0||n>=e.length){this.addError(`TurnIdx invlido: ${n} (deve estar entre 0 e ${e.length-1})`);return}const r=e[n];if(!r){this.addError(`Jogador do turno no encontrado no ndice ${n}`);return}r.bankrupt&&this.addError(`Jogador do turno (${r.name}) est falido`)}validateGameOverState(e,n,r){const s=Ho(e);n&&s>1&&this.addError("Jogo marcado como terminado mas h mais de 1 jogador vivo"),n&&!r&&this.addError("Jogo terminado mas no h vencedor definido"),r&&!n&&this.addError("H vencedor definido mas jogo no terminou"),r&&r.bankrupt&&this.addError("Vencedor no pode estar falido")}validateRoundState(e,n){(typeof n!="number"||n<1)&&this.addError(`Rodada invlida: ${n} (deve ser >= 1)`),n>10&&this.addWarning(`Rodada muito alta: ${n} (jogo pode estar travado)`)}validateAction(e,n,r){switch(this.errors=[],this.warnings=[],e.type){case"MOVE":this.validateMoveAction(e,n);break;case"BUY":this.validateBuyAction(e,n);break;case"HIRE":this.validateHireAction(e,n);break;case"BANKRUPT":this.validateBankruptAction(e,n);break;default:this.addWarning(`Tipo de ao no reconhecido: ${e.type}`)}return{isValid:this.errors.length===0,errors:this.errors,warnings:this.warnings}}validateMoveAction(e,n){(typeof e.steps!="number"||e.steps<1||e.steps>6)&&this.addError(`Passos invlidos: ${e.steps} (deve estar entre 1 e 6)`)}validateBuyAction(e,n){const r=e.cost||e.price||0;r>n.cash&&this.addError(`Saldo insuficiente: precisa de ${r}, tem ${n.cash}`)}validateHireAction(e,n){const r=e.cost||0;r>n.cash&&this.addError(`Saldo insuficiente para contratao: precisa de ${r}, tem ${n.cash}`)}validateBankruptAction(e,n){n.bankrupt||this.addWarning("Jogador declarando falncia mas no est marcado como falido")}addError(e){this.errors.push(e)}addWarning(e){this.warnings.push(e)}}function ab(t,e,n,r,s){return new Tm().validateGameState(t,e,n,r,s)}function lb(t,e,n){return new Tm().validateAction(t,e,n)}class ub{constructor(){this.enabled=!1,this.logs=[],this.maxLogs=1e4,this.originalConsole={log:console.log,warn:console.warn,error:console.error,debug:console.debug,info:console.info},this.prefixes=["[DEBUG]","[NET]","[App]","[SG]","[Controls]","[HUD]","[DEBUG MODE]","[PlayersLobby]","[leaveRoom]","[GameNet]","[useTurnEngine]","[useGameSync]"]}shouldCapture(e){if(!this.enabled)return!1;const n=e.map(r=>{if(typeof r=="object")try{return JSON.stringify(r)}catch{return String(r)}return String(r)}).join(" ");return this.prefixes.some(r=>n.includes(r))}addLog(e,n){this.logs.length>=this.maxLogs&&(this.logs=this.logs.slice(-Math.floor(this.maxLogs*.9)));const r=Date.now(),s={timestamp:r,time:new Date(r).toISOString(),level:e,args:n.map(o=>{if(typeof o=="object"&&o!==null)try{return JSON.parse(JSON.stringify(o,(i,l)=>typeof l=="function"?"[Function]":l===void 0?"[undefined]":Array.isArray(l)&&l.length>100?`[Array(${l.length}) - truncado]`:l))}catch{return String(o)}return o}),message:n.map(o=>{if(typeof o=="object")try{return JSON.stringify(o)}catch{return String(o)}return String(o)}).join(" ")};this.logs.push(s)}interceptLog(...e){this.shouldCapture(e)&&this.addLog("log",e),this.originalConsole.log.apply(console,e)}interceptWarn(...e){this.shouldCapture(e)&&this.addLog("warn",e),this.originalConsole.warn.apply(console,e)}interceptError(...e){this.addLog("error",e),this.originalConsole.error.apply(console,e)}interceptDebug(...e){this.shouldCapture(e)&&this.addLog("debug",e),this.originalConsole.debug.apply(console,e)}interceptInfo(...e){this.shouldCapture(e)&&this.addLog("info",e),this.originalConsole.info.apply(console,e)}enable(){this.enabled||(this.enabled=!0,console.log=this.interceptLog.bind(this),console.warn=this.interceptWarn.bind(this),console.error=this.interceptError.bind(this),console.debug=this.interceptDebug.bind(this),console.info=this.interceptInfo.bind(this),console.log("[LogCapture]  Captura de logs ativada"))}disable(){this.enabled&&(this.enabled=!1,console.log=this.originalConsole.log,console.warn=this.originalConsole.warn,console.error=this.originalConsole.error,console.debug=this.originalConsole.debug,console.info=this.originalConsole.info,console.log("[LogCapture]  Captura de logs desativada"))}clear(){this.logs=[],console.log("[LogCapture]  Histrico de logs limpo")}getLogs(){return[...this.logs]}getStats(){const e=this.logs.length,n={log:0,warn:0,error:0,debug:0,info:0};return this.logs.forEach(r=>{n[r.level]=(n[r.level]||0)+1}),{total:e,byLevel:n,enabled:this.enabled}}exportAsText(){const e=["=".repeat(80),"RELATRIO DE LOGS - Sales Game","=".repeat(80),`Data/Hora: ${new Date().toISOString()}`,`Total de logs: ${this.logs.length}`,`Estatsticas: ${JSON.stringify(this.getStats(),null,2)}`,"=".repeat(80),""];return this.logs.forEach(n=>{const r={log:"",warn:"",error:"",debug:"",info:""}[n.level]||"";e.push(`[${n.time}] ${r} [${n.level.toUpperCase()}]`),n.args.forEach((s,o)=>{typeof s=="object"?e.push(`  Arg ${o+1}: ${JSON.stringify(s,null,2)}`):e.push(`  Arg ${o+1}: ${s}`)}),e.push("")}),e.join(`
`)}exportAsJSON(){return{timestamp:new Date().toISOString(),stats:this.getStats(),logs:this.logs}}exportFull(){return{timestamp:new Date().toISOString(),stats:this.getStats(),text:this.exportAsText(),json:this.exportAsJSON()}}}const hr=new ub,cb=()=>hr.clear(),nc=()=>hr.getStats(),db=()=>hr.exportAsText(),fb=()=>hr.exportAsJSON();class hb{constructor(){this.enabled=!1,this.validationHistory=[],this.maxHistorySize=100}toggle(){return this.enabled=!this.enabled,this.enabled&&hr.enable(),console.log(`[DEBUG MODE] ${this.enabled?"ATIVADO":"DESATIVADO"}`),this.enabled}validateGameState(e,n,r,s,o,i=""){if(!this.enabled)return;const l=ab(e,n,r,s,o);return this.addToHistory({type:"GAME_STATE",context:i,timestamp:Date.now(),result:l}),l.isValid||console.error("[DEBUG MODE]  Estado do jogo invlido:",l.errors),l.warnings.length>0&&console.warn("[DEBUG MODE]  Avisos:",l.warnings),l}validateAction(e,n,r,s=""){if(!this.enabled)return;const o=lb(e,n,r);return this.addToHistory({type:"ACTION",context:s,timestamp:Date.now(),action:e.type,player:n.name,result:o}),o.isValid||console.error(`[DEBUG MODE]  Ao invlida (${e.type}):`,o.errors),o}validateResourceChange(e,n,r,s){if(!this.enabled)return;const o=[],i=[];if(n.clients!==r.clients){const c=r.clients-n.clients;r.clients<0&&o.push(`Clientes no pode ser negativo: ${r.clients}`),Math.abs(c)>10&&i.push(`Mudana grande de clientes: ${c}`)}if(n.cash!==r.cash){const c=r.cash-n.cash;r.cash<0&&o.push(`Cash no pode ser negativo: ${r.cash}`),Math.abs(c)>5e4&&i.push(`Mudana grande de cash: ${c}`)}["vendedoresComuns","fieldSales","insideSales","gestores"].forEach(c=>{if(n[c]!==r[c]){const d=r[c]-n[c];r[c]<0&&o.push(`${c} no pode ser negativo: ${r[c]}`),Math.abs(d)>5&&i.push(`Mudana grande de ${c}: ${d}`)}});const u={isValid:o.length===0,errors:o,warnings:i};return this.addToHistory({type:"RESOURCE_CHANGE",context:s,timestamp:Date.now(),player:e.name,oldState:n,newState:r,result:u}),u.isValid||console.error("[DEBUG MODE]  Mudana de recurso invlida:",u.errors),u}validateCalculations(e,n=""){if(this.enabled)try{const r=ol(e),s=il(e),{cap:o,inAtt:i}=Ia(e),l=[],u=[];(typeof r!="number"||r<0)&&l.push(`Faturamento invlido: ${r}`),(typeof s!="number"||s<0)&&l.push(`Manuteno invlida: ${s}`),(typeof o!="number"||o<0)&&l.push(`Capacidade invlida: ${o}`),(typeof i!="number"||i<0||i>o)&&l.push(`Clientes em atendimento invlido: ${i} (capacidade: ${o})`),this.isInitialState(e)&&s!==1150&&l.push(`Manuteno inicial deve ser 1150, mas  ${s}`);const c={isValid:l.length===0,errors:l,warnings:u,calculations:{faturamento:r,manutencao:s,cap:o,inAtt:i}};return this.addToHistory({type:"CALCULATIONS",context:n,timestamp:Date.now(),player:e.name,result:c}),c.isValid||console.error("[DEBUG MODE]  Clculos invlidos:",c.errors),c}catch(r){return console.error("[DEBUG MODE]  Erro ao validar clculos:",r),{isValid:!1,errors:[r.message],warnings:[]}}}isInitialState(e){return e.vendedoresComuns===1&&e.clients===1&&e.fieldSales===0&&e.insideSales===0&&e.gestores===0&&e.mixProdutos==="D"&&e.erpLevel==="D"}addToHistory(e){this.validationHistory.unshift(e),this.validationHistory.length>this.maxHistorySize&&(this.validationHistory=this.validationHistory.slice(0,this.maxHistorySize))}getHistory(){return this.validationHistory}clearHistory(){this.validationHistory=[]}getStats(){const e=this.validationHistory.length,n=this.validationHistory.filter(s=>!s.result.isValid).length,r=this.validationHistory.filter(s=>s.result.warnings.length>0).length;return{total:e,errors:n,warnings:r,errorRate:e>0?n/e*100:0,warningRate:e>0?r/e*100:0}}exportReport(){const e=this.getStats(),n={timestamp:new Date().toISOString(),stats:e,history:this.validationHistory};return console.log("[DEBUG MODE]  Relatrio de validao:",n),n}exportFullReport(){const e=this.exportReport(),n=hr.exportFull();return{timestamp:new Date().toISOString(),validation:e,logs:n,text:this.exportFullReportAsText(e,n)}}exportFullReportAsText(e,n){return["=".repeat(80),"RELATRIO COMPLETO DE DEBUG - Sales Game","=".repeat(80),`Data/Hora: ${new Date().toISOString()}`,"","--- VALIDAES ---",`Total de validaes: ${e.stats.total}`,`Erros: ${e.stats.errors}`,`Avisos: ${e.stats.warnings}`,`Taxa de erro: ${e.stats.errorRate.toFixed(2)}%`,"","--- LOGS CAPTURADOS ---",`Total de logs: ${n.stats.total}`,`Logs por nvel: ${JSON.stringify(n.stats.byLevel,null,2)}`,"","--- HISTRICO DE VALIDAES ---",...e.history.map(s=>`[${new Date(s.timestamp).toISOString()}] ${s.type} - ${s.context||""} - ${JSON.stringify(s.result,null,2)}`),"","--- LOGS DETALHADOS ---",n.text,"=".repeat(80)].join(`
`)}}const js=new hb,pb=(t,e,n,r,s,o)=>js.validateGameState(t,e,n,r,s,o),mb=(t,e)=>js.validateCalculations(t,e),Lf=()=>js.getStats(),gb=()=>js.exportReport(),Pm=()=>js.exportFullReport(),ql="__CASH_AUDIT__";function yo(){return typeof window>"u"?null:(window[ql]||(window[ql]={enabled:!1,entries:[],maxEntries:5e3,currentMeta:null}),window[ql])}function Lm(t={}){const e=yo();return e?(typeof t.enabled=="boolean"&&(e.enabled=t.enabled),Number.isFinite(t.maxEntries)&&t.maxEntries>0&&(e.maxEntries=Math.floor(t.maxEntries)),{enabled:e.enabled,maxEntries:e.maxEntries,size:e.entries.length}):{enabled:!1}}function yb(t){const e=yo();e&&(e.currentMeta=t||null)}function Im(t){const e=Number(t.beforeCash),n=Number(t.afterCash),r=Number(t.delta);if(!Number.isFinite(n)||Number.isNaN(n)||!Number.isFinite(r)||Number.isNaN(r)||n<-1e9||n>1e9)return"ERROR";const s=String(t.actionType||""),o=/PAY|EXPENSE|OPS|DEBT/i.test(s);return Math.abs(r)>=5e3||o&&r>0||Number.isFinite(e)&&Number.isFinite(n)&&n-e!==r?"WARN":"INFO"}function If(t){const e=yo();if(!e||!e.enabled)return;const n={...t};if(n.traceId=n.traceId||"unknown",n.ts=n.ts||new Date().toISOString(),n.severity=n.severity||Im(n),n.severity==="ERROR"&&!n.stack)try{n.stack=new Error("cashAudit").stack}catch{}e.entries.push(n),e.entries.length>e.maxEntries&&e.entries.splice(0,e.entries.length-e.maxEntries);const r=Number(n.delta||0),s=Number(n.afterCash||0),o=n.playerName||n.playerId,i=n.reason||"UNKNOWN_CASH_CHANGE",l=n.severity||"INFO";console.groupCollapsed(`[CASH] ${l} ${r} -> ${s} | ${o} | ${i}`),console.log(n),console.groupEnd()}function $f(t){return Array.isArray(t)?t:t&&Array.isArray(t.players)?t.players:null}function vb(t,e,n=null){var p;const r=yo();if(!r||!r.enabled)return;const s=$f(t)||[],o=$f(e)||[],i=new Map(s.map(g=>[String(g==null?void 0:g.id),g||{}])),l=new Map(o.map(g=>[String(g==null?void 0:g.id),g||{}])),u=new Set([...i.keys(),...l.keys()]),c=n||r.currentMeta||{},d=c.origin||{},h=c.context||{};for(const g of u){const b=i.get(g),x=l.get(g);if(!b&&x){If({ts:new Date().toISOString(),traceId:c.traceId||"unknown",actionType:c.actionType||"PLAYER_ADDED",reason:c.reason||"PLAYER_ADDED",severity:"INFO",playerId:g,playerName:x==null?void 0:x.name,beforeCash:0,afterCash:Number((x==null?void 0:x.cash)||0),delta:Number((x==null?void 0:x.cash)||0),origin:d,context:h});continue}if(!x&&b)continue;const S=Number((b==null?void 0:b.cash)||0),y=Number((x==null?void 0:x.cash)||0);if(S===y)continue;const f=y-S,m={ts:new Date().toISOString(),traceId:c.traceId||"unknown",actionType:c.actionType||"UNKNOWN",reason:c.reason||"UNKNOWN_CASH_CHANGE",playerId:g,playerName:x==null?void 0:x.name,beforeCash:S,afterCash:y,delta:f,origin:{...d,file:d.file,fn:d.fn,modal:d.modal,component:d.component},context:{round:h.round,pos:Number.isFinite(Number(x==null?void 0:x.pos))?Number(x.pos):h.pos,tile:h.tile,debt:h.debt,loanPending:Number(((p=x==null?void 0:x.loanPending)==null?void 0:p.amount)||0)||h.loanPending,opsExpense:h.opsExpense,revenue:h.revenue}};m.severity=Im(m),If(m)}}function xb({download:t=!1,filename:e}={}){var o;const n=yo(),r={exportedAt:new Date().toISOString(),enabled:!!(n!=null&&n.enabled),size:((o=n==null?void 0:n.entries)==null?void 0:o.length)||0,entries:(n==null?void 0:n.entries)||[]},s=JSON.stringify(r,null,2);if(t&&typeof window<"u")try{const i=new Blob([s],{type:"application/json"}),l=URL.createObjectURL(i),u=document.createElement("a");u.href=l,u.download=e||`cash-audit-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.json`,u.click(),URL.revokeObjectURL(l)}catch(i){console.warn("[cashAudit] download failed",i)}return s}function bb(){const t=yo();t&&(t.entries=[])}function wb({players:t,turnIdx:e,round:n,gameOver:r,winner:s}){var E,T;const[o,i]=j.useState(!1),[l,u]=j.useState({total:0,errors:0,warnings:0,errorRate:0,warningRate:0}),[c,d]=j.useState({total:0,byLevel:{},enabled:!1}),[h,p]=j.useState(!1),[g,b]=j.useState({x:0,y:0}),[x,S]=j.useState({x:0,y:0}),y=j.useRef(null);j.useEffect(()=>{const $=()=>{u(Lf()),d(nc())};$();const U=setInterval($,1e3);return()=>clearInterval(U)},[]);const f=()=>{const $=js.toggle();i($)},m=()=>{const $=gb(),U=new Blob([JSON.stringify($,null,2)],{type:"application/json"}),V=URL.createObjectURL(U),Je=document.createElement("a");Je.href=V,Je.download=`debug-report-${new Date().toISOString().slice(0,19)}.json`,Je.click(),URL.revokeObjectURL(V)},w=()=>{const $=Pm(),U=new Blob([$.text],{type:"text/plain;charset=utf-8"}),V=URL.createObjectURL(U),Je=document.createElement("a");Je.href=V,Je.download=`debug-logs-completo-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.txt`,Je.click(),URL.revokeObjectURL(V);const at=new Blob([JSON.stringify($,null,2)],{type:"application/json"}),Q=URL.createObjectURL(at),F=document.createElement("a");F.href=Q,F.download=`debug-logs-completo-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.json`,F.click(),URL.revokeObjectURL(Q),console.log("[DebugPanel]  Relatrio completo exportado (texto + JSON)")},_=()=>{js.clearHistory(),cb(),bb(),u(Lf()),d(nc()),console.log("[DebugPanel]  Todos os logs foram limpos")},A=()=>{const $=xb({download:!0});console.log("[CashAudit] export json:",$)},D=()=>{var U;const $=!!((U=window.__CASH_AUDIT__)!=null&&U.enabled);Lm({enabled:!$}),console.log("[CashAudit] enabled =",!$)},k=$=>{if($.target.closest("button"))return;p(!0);const U=y.current.getBoundingClientRect();S({x:$.clientX-U.left,y:$.clientY-U.top})},R=$=>{h&&b({x:$.clientX-x.x,y:$.clientY-x.y})},v=()=>{p(!1)};return j.useEffect(()=>{if(h)return document.addEventListener("mousemove",R),document.addEventListener("mouseup",v),()=>{document.removeEventListener("mousemove",R),document.removeEventListener("mouseup",v)}},[h,x]),o?a.jsxs("div",{ref:y,style:{position:"fixed",top:g.y||10,left:g.x||10,zIndex:9999,background:"#1a1a1a",color:"#fff",padding:"12px",borderRadius:"8px",border:"1px solid #333",minWidth:"300px",maxHeight:"80vh",overflow:"auto",fontSize:"12px",fontFamily:"monospace",cursor:h?"grabbing":"grab",userSelect:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.3)"},onMouseDown:k,children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"12px"},children:[a.jsx("h3",{style:{margin:0,color:"#4CAF50"},children:" Debug Panel"}),a.jsx("button",{onClick:f,style:{background:"#ff4444",color:"#fff",border:"none",borderRadius:"4px",padding:"4px 8px",cursor:"pointer",fontSize:"10px"},children:""})]}),a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("h4",{style:{margin:"0 0 8px 0",color:"#FFC107"},children:" Estatsticas de Validao"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px"},children:[a.jsxs("div",{children:["Total: ",l.total]}),a.jsxs("div",{style:{color:l.errors>0?"#ff4444":"#4CAF50"},children:["Erros: ",l.errors]}),a.jsxs("div",{style:{color:l.warnings>0?"#FFC107":"#4CAF50"},children:["Avisos: ",l.warnings]}),a.jsxs("div",{children:["Taxa Erro: ",l.errorRate.toFixed(1),"%"]})]})]}),a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("h4",{style:{margin:"0 0 8px 0",color:"#FFC107"},children:" Estatsticas de Logs"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px"},children:[a.jsxs("div",{children:["Total: ",c.total]}),a.jsxs("div",{style:{color:c.enabled?"#4CAF50":"#ff4444"},children:["Status: ",c.enabled?" Ativo":" Inativo"]}),c.byLevel&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:["Logs: ",c.byLevel.log||0]}),a.jsxs("div",{style:{color:"#FFC107"},children:["Warns: ",c.byLevel.warn||0]}),a.jsxs("div",{style:{color:"#ff4444"},children:["Errors: ",c.byLevel.error||0]}),a.jsxs("div",{children:["Debug: ",c.byLevel.debug||0]})]})]})]}),a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("h4",{style:{margin:"0 0 8px 0",color:"#FFC107"},children:" Estado do Jogo"}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"4px"},children:[a.jsxs("div",{children:["Jogadores: ",t.length]}),a.jsxs("div",{children:["Turno: ",e+1]}),a.jsxs("div",{children:["Rodada: ",n]}),a.jsxs("div",{style:{color:r?"#ff4444":"#4CAF50"},children:["Status: ",r?"Fim":"Ativo"]}),s&&a.jsxs("div",{children:["Vencedor: ",s.name]})]})]}),a.jsxs("div",{style:{marginBottom:"12px"},children:[a.jsx("h4",{style:{margin:"0 0 8px 0",color:"#FFC107"},children:" Jogadores"}),t.map(($,U)=>{var V;return a.jsxs("div",{style:{background:U===e?"#333":"transparent",padding:"4px",borderRadius:"4px",marginBottom:"2px",border:$.bankrupt?"1px solid #ff4444":"1px solid transparent"},children:[a.jsxs("div",{style:{fontWeight:"bold"},children:[$.name," ",$.bankrupt?"":""," ",U===e?"":""]}),a.jsxs("div",{style:{fontSize:"10px",opacity:.8},children:["Cash: $",((V=$.cash)==null?void 0:V.toLocaleString())||0," | Clientes: ",$.clients||0," | Vendedores: ",$.vendedoresComuns||0]})]},$.id)})]}),a.jsxs("div",{style:{display:"flex",gap:"8px",flexWrap:"wrap"},children:[a.jsx("button",{onClick:w,style:{background:"#2196F3",color:"#fff",border:"none",borderRadius:"4px",padding:"6px 12px",cursor:"pointer",fontSize:"10px",fontWeight:"bold"},title:"Exporta relatrio completo com todos os logs (texto + JSON)",children:" Exportar Logs Completos"}),a.jsx("button",{onClick:m,style:{background:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",padding:"6px 12px",cursor:"pointer",fontSize:"10px"},title:"Exporta apenas relatrio de validao (JSON)",children:" Exportar Validao"}),a.jsx("button",{onClick:_,style:{background:"#FF9800",color:"#fff",border:"none",borderRadius:"4px",padding:"6px 12px",cursor:"pointer",fontSize:"10px"},title:"Limpa todos os logs e histrico de validao",children:" Limpar Tudo"}),a.jsx("button",{onClick:A,style:{background:"#8e44ad",color:"#fff",border:"none",borderRadius:"4px",padding:"6px 12px",cursor:"pointer",fontSize:"10px"},title:"Exporta o audit log de saldo (JSON)",children:" Exportar Cash Audit"}),a.jsx("button",{onClick:D,style:{background:(E=window.__CASH_AUDIT__)!=null&&E.enabled?"#2ecc71":"#7f8c8d",color:"#111",border:"none",borderRadius:"4px",padding:"6px 12px",cursor:"pointer",fontSize:"10px",fontWeight:800},title:"Ativa/desativa auditoria de saldo (runtime)",children:(T=window.__CASH_AUDIT__)!=null&&T.enabled?" Cash Audit ON":" Cash Audit OFF"})]}),a.jsxs("div",{style:{marginTop:"12px",padding:"8px",background:"#333",borderRadius:"4px",fontSize:"10px"},children:[a.jsx("div",{style:{color:"#FFC107",marginBottom:"4px"},children:" Instrues:"}),a.jsx("div",{children:' Clique em " Debug" para ativar/desativar'}),a.jsx("div",{children:" Logs so capturados automaticamente quando debug est ativo"}),a.jsx("div",{children:' " Exportar Logs Completos" gera arquivo .txt e .json'}),a.jsx("div",{children:" Compartilhe o arquivo .txt para anlise de problemas"}),a.jsx("div",{children:" Todos os console.log com prefixos [DEBUG], [NET], [App], etc. so capturados"})]})]}):a.jsx("div",{style:{background:"#1a1a1a",color:"#fff",padding:"6px 10px",borderRadius:"4px",border:"1px solid #333",cursor:"pointer",fontSize:"11px",fontFamily:"monospace",display:"inline-block",userSelect:"none"},onClick:f,children:" Debug"})}function Rr({onResolve:t,requiredAmount:e=0,currentCash:n=0,title:r="Saldo insuficiente",message:s="Seu saldo atual no  suficiente para concluir esta compra.",okLabel:o="OK",showRecoveryOptions:i=!1,canClose:l=!0}){const u=j.useRef(null),c=j.useMemo(()=>Math.max(0,Number(e||0)-Number(n||0)),[e,n]),d=x=>`$ ${Number(x||0).toLocaleString()}`,h=x=>{var S,y;(S=x==null?void 0:x.preventDefault)==null||S.call(x),(y=x==null?void 0:x.stopPropagation)==null||y.call(x),t==null||t({action:"ACK"})},p=x=>{var S,y;(S=x==null?void 0:x.preventDefault)==null||S.call(x),(y=x==null?void 0:x.stopPropagation)==null||y.call(x),!(i||!l)&&(t==null||t({action:"SKIP"}))},g=x=>{var S,y;(S=x==null?void 0:x.preventDefault)==null||S.call(x),(y=x==null?void 0:x.stopPropagation)==null||y.call(x),t==null||t({action:"RECOVERY"})},b=x=>{var S,y;(S=x==null?void 0:x.preventDefault)==null||S.call(x),(y=x==null?void 0:x.stopPropagation)==null||y.call(x),t==null||t({action:"BANKRUPT"})};return j.useEffect(()=>{const x=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var S,y;return(y=(S=u.current)==null?void 0:S.focus)==null?void 0:y.call(S)},0),()=>{document.body.style.overflow=x}},[]),a.jsx("div",{style:xn.wrap,role:"dialog","aria-modal":"true",onMouseDown:x=>{x.target===x.currentTarget&&x.stopPropagation()},children:a.jsxs("div",{style:xn.card,onMouseDown:x=>x.stopPropagation(),children:[!i&&l&&a.jsx("button",{type:"button",style:xn.close,onClick:p,"aria-label":"Fechar",children:""}),a.jsx("div",{style:xn.icon,children:""}),a.jsx("h2",{style:xn.title,children:r}),a.jsx("p",{style:xn.msg,children:s}),a.jsxs("div",{style:xn.grid,children:[a.jsxs("div",{style:xn.row,children:[a.jsx("span",{children:"Necessrio:"}),a.jsx("b",{children:d(e)})]}),a.jsxs("div",{style:xn.row,children:[a.jsx("span",{children:"Seu saldo:"}),a.jsx("b",{children:d(n)})]}),a.jsxs("div",{style:{...xn.row,color:"#fca5a5"},children:[a.jsx("span",{children:"Faltam:"}),a.jsx("b",{children:d(c)})]})]}),a.jsx("div",{style:xn.actions,children:i?a.jsxs(a.Fragment,{children:[a.jsx("button",{type:"button",style:{...xn.btn,background:"#f59e0b",color:"#fff",marginRight:"8px"},onClick:g,children:"Recuperao Financeira"}),a.jsx("button",{type:"button",style:{...xn.btn,background:"#dc2626",color:"#fff"},onClick:b,children:"Declarar Falncia"})]}):a.jsx("button",{ref:u,type:"button",style:{...xn.btn,background:"#6b7280",color:"#fff"},onClick:h,children:o})})]})})}const xn={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"grid",placeItems:"center",zIndex:1100},card:{width:"min(440px, 92vw)",background:"#1f2330",color:"#e9ecf1",borderRadius:16,padding:"18px 18px 16px",border:"1px solid rgba(255,255,255,.12)",boxShadow:"0 18px 50px rgba(0,0,0,.5)",position:"relative"},close:{position:"absolute",right:10,top:10,width:34,height:34,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},icon:{fontSize:28,lineHeight:1,marginBottom:6},title:{margin:"2px 0 6px",fontWeight:900,fontSize:20},msg:{opacity:.95,margin:"0 0 10px"},grid:{border:"1px solid rgba(255,255,255,.15)",borderRadius:12,padding:"10px 12px",marginBottom:12,background:"#171b26"},row:{display:"flex",justifyContent:"space-between",padding:"4px 0"},actions:{display:"flex",justifyContent:"center",marginTop:6},btn:{minWidth:120,padding:"10px 16px",borderRadius:10,border:"none",fontWeight:900,cursor:"pointer"}},bn={A:{compra:1e4,despesa:cr.A.desp,faturamento:cr.A.fat,color:"#1d4ed8",pill:"NVEL A"},B:{compra:4e3,despesa:cr.B.desp,faturamento:cr.B.fat,color:"#16a34a",pill:"NVEL B"},C:{compra:1500,despesa:cr.C.desp,faturamento:cr.C.fat,color:"#f59e0b",pill:"NVEL C"},D:{compra:500,despesa:cr.D.desp,faturamento:cr.D.fat,color:"#6b7280",pill:"NVEL D"}};function Mf({onResolve:t,currentCash:e=0,currentLevel:n=null,erpOwned:r=null}){const s=j.useRef(null),{pushModal:o,awaitTop:i}=hn(),l=c=>{var d,h;(d=c==null?void 0:c.preventDefault)==null||d.call(c),(h=c==null?void 0:c.stopPropagation)==null||h.call(c),t==null||t({action:"SKIP"})},u=async c=>{if(r?r[c]===!0:n===c)return;const h=bn[c],p=Number((h==null?void 0:h.compra)||0),g=Number(e||0);if(g<p){o(a.jsx(Rr,{requiredAmount:p,currentCash:g,title:"Saldo insuficiente para comprar ERP",message:`Voc precisa de $ ${p.toLocaleString()} para o ERP nvel ${c}, mas possui $ ${g.toLocaleString()}.`,okLabel:"Entendi"})),await i();return}t==null||t({action:"BUY",level:c,values:h})};return j.useEffect(()=>{const c=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var d,h;return(h=(d=s.current)==null?void 0:d.focus)==null?void 0:h.call(d)},0),()=>{document.body.style.overflow=c}},[]),a.jsx("div",{style:lt.wrap,role:"dialog","aria-modal":"true","aria-label":"ERP/Sistemas",children:a.jsxs("div",{style:lt.card,children:[a.jsx("button",{ref:s,type:"button",style:lt.close,onClick:l,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:lt.title,children:["Escolha o nvel de ",a.jsx("b",{children:"ERP / Sistemas"}),":"]}),a.jsxs("div",{style:lt.note,children:[a.jsx("div",{style:{fontWeight:900,marginBottom:4},children:"ERP / SISTEMAS"}),a.jsxs("div",{children:[a.jsx("b",{children:"Impacto mensal:"})," adiciona ",a.jsx("b",{children:"Despesa"})," e ",a.jsx("b",{children:"Faturamento"})," de acordo com o nvel."]}),a.jsxs("div",{children:["O nvel ",a.jsx("b",{children:"D"})," tambm pode ser adquirido."]})]}),a.jsxs("div",{style:lt.saldo,children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",Number(e||0).toLocaleString()]})]}),a.jsxs("div",{style:lt.table,children:[a.jsxs("div",{style:lt.trHead,children:[a.jsx("div",{style:lt.th}),a.jsx("div",{style:{...lt.th,background:"#10214d"},children:"Nvel A"}),a.jsx("div",{style:{...lt.th,background:"#0f3a1c"},children:"Nvel B"}),a.jsx("div",{style:{...lt.th,background:"#4a3705"},children:"Nvel C"}),a.jsx("div",{style:{...lt.th,background:"#2a2f3b"},children:"Nvel D"})]}),a.jsx(Hl,{label:"COMPRA",fmt:!0,vA:bn.A.compra,vB:bn.B.compra,vC:bn.C.compra,vD:bn.D.compra}),a.jsx(Hl,{label:"DESPESA",fmt:!0,vA:bn.A.despesa,vB:bn.B.despesa,vC:bn.C.despesa,vD:bn.D.despesa}),a.jsx(Hl,{label:"FATURAMENTO",fmt:!0,vA:bn.A.faturamento,vB:bn.B.faturamento,vC:bn.C.faturamento,vD:bn.D.faturamento})]}),a.jsx("div",{style:lt.cards,children:["A","B","C","D"].map(c=>{const d=bn[c],h=r?r[c]===!0:n===c,p=h;return a.jsxs("div",{style:{...lt.cardItem,borderColor:h?"#16a34a":"rgba(255,255,255,.15)",opacity:p?.6:1},children:[a.jsx("div",{style:{...lt.pill,background:h?"#16a34a":"#fff",color:h?"#fff":"#111"},children:h?" ADQUIRIDO":d.pill}),a.jsx("div",{style:{...lt.cardBadge,background:d.color}}),a.jsxs("ul",{style:lt.lines,children:[a.jsxs("li",{children:["Compra: ",a.jsxs("b",{children:["$ ",d.compra.toLocaleString()]})]}),a.jsxs("li",{children:["Despesa: ",a.jsxs("b",{children:["$ ",d.despesa.toLocaleString()]})]}),a.jsxs("li",{children:["Faturamento: ",a.jsxs("b",{children:["$ ",d.faturamento.toLocaleString()]})]})]}),a.jsx("button",{type:"button",style:{...lt.buyBtn,background:p?"#6b7280":"#2442f9",cursor:p?"not-allowed":"pointer"},onClick:()=>u(c),disabled:p,title:p?`ERP nvel ${c} j adquirido`:`Comprar ERP nvel ${c}`,children:p?"J Adquirido":`Comprar ${c}`})]},c)})}),a.jsx("div",{style:lt.actions,children:a.jsx("button",{type:"button",style:{...lt.bigBtn,background:"#444"},onClick:l,children:"No comprar"})})]})})}function Hl({label:t,vA:e,vB:n,vC:r,vD:s,fmt:o}){const i=l=>o?`$ ${Number(l).toLocaleString()}`:l;return a.jsxs("div",{style:lt.tr,children:[a.jsx("div",{style:{...lt.td,fontWeight:700},children:t}),a.jsx("div",{style:lt.td,children:i(e)}),a.jsx("div",{style:lt.td,children:i(n)}),a.jsx("div",{style:lt.td,children:i(r)}),a.jsx("div",{style:lt.td,children:i(s)})]})}const lt={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(980px, 94vw)",background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:900},note:{background:"#2a2f3b",border:"1px solid rgba(255,255,255,.15)",borderRadius:12,padding:"10px 12px",margin:"0 0 10px"},saldo:{margin:"0 0 10px",padding:"8px 12px",border:"1px dashed rgba(255,255,255,.25)",borderRadius:10},table:{border:"1px solid rgba(255,255,255,.12)",borderRadius:12,overflow:"hidden",marginBottom:12},trHead:{display:"grid",gridTemplateColumns:"1fr repeat(4, 1fr)",background:"#121621"},th:{padding:"10px 12px",fontWeight:800,borderLeft:"1px solid rgba(255,255,255,.06)"},tr:{display:"grid",gridTemplateColumns:"1fr repeat(4, 1fr)",background:"#0f1320"},td:{padding:"10px 12px",borderTop:"1px solid rgba(255,255,255,.06)",borderLeft:"1px solid rgba(255,255,255/.06)"},cards:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:12,marginTop:8},cardItem:{background:"#0f1320",border:"1px solid",borderRadius:14,padding:"12px",display:"flex",flexDirection:"column",gap:8},cardBadge:{width:"100%",height:6,borderRadius:999,opacity:.9},pill:{alignSelf:"flex-start",fontSize:12,fontWeight:900,padding:"4px 8px",borderRadius:999,color:"#111"},lines:{margin:0,padding:"0 0 0 16px",lineHeight:1.35},buyBtn:{marginTop:"auto",padding:"10px 12px",borderRadius:10,border:"none",fontWeight:900,cursor:"pointer",background:"#2442f9",color:"#fff"},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:14},bigBtn:{minWidth:160,padding:"14px 18px",borderRadius:12,border:"none",color:"#fff",fontWeight:900,cursor:"pointer"}},Gi=[{id:"personalizado",label:`Treinamento de venda personalizado
Casagrande Consultores`,price:500,cert:"azul",colors:{bg:"#0f2848",border:"#3b82f6",pill:"#60a5fa"}},{id:"fieldsales",label:`Curso Field Sales Collab
Multiplier Educao e
Casagrande Consultores`,price:500,cert:"amarelo",colors:{bg:"#3a3202",border:"#facc15",pill:"#fde047"}},{id:"imersaomultiplier",label:`Pacote Imerses
Multiplier Educao`,price:500,cert:"roxo",colors:{bg:"#2b0840",border:"#a855f7",pill:"#c084fc"}}];function Bf({onResolve:t,ownedByType:e={},canTrain:n={}}){const r=k=>typeof k=="string"&&k.trim()!==""&&!Number.isNaN(Number(k))?Number(k):k,s=k=>{const R=r(k);return typeof R=="number"?R>0:!!R},o=j.useMemo(()=>({comum:s(n.comum),field:s(n.field),inside:s(n.inside),gestor:s(n.gestor)}),[n]),i=Gi.map(k=>k.id),l=j.useMemo(()=>[{id:"comum",label:"Vend. Comum"},{id:"field",label:"Field Sales"},{id:"inside",label:"Inside Sales"},{id:"gestor",label:"Gestor"}].filter(k=>o[k.id]).filter(k=>{const R=e[k.id]instanceof Set?e[k.id]:new Set(e[k.id]||[]);return i.some(v=>!R.has(v))}),[e,o]),[u,c]=j.useState(()=>new Set),[d,h]=j.useState(()=>new Set);j.useEffect(()=>{u.size===0&&l.length>0&&c(new Set([l[0].id]))},[l,u.size]);const p=j.useRef(null),g=j.useMemo(()=>{const k=[];if(d.size>0){const R=Array.from(d).map(E=>Gi.find(T=>T.id===E)).filter(Boolean),v=R.reduce((E,T)=>E+((T==null?void 0:T.price)||0),0);u.forEach(E=>{k.push({vendorType:E,items:R,total:v})})}return k},[u,d]),b=j.useMemo(()=>g.reduce((k,R)=>k+R.total,0),[g]),x=j.useMemo(()=>{const k={azul:0,amarelo:0,roxo:0};return d.size>0&&Array.from(d).map(v=>Gi.find(E=>E.id===v)).filter(Boolean).forEach(v=>{k[v.cert]=(k[v.cert]||0)+u.size}),k},[d,u.size]),S=j.useMemo(()=>{const k={};if(d.size>0){const R=Array.from(d);u.forEach(v=>{k[v]=R})}return k},[d,u]),y=k=>{c(R=>{const v=new Set(R);return v.has(k)?v.delete(k):v.add(k),v})},f=k=>{Array.from(u).some(v=>(e[v]instanceof Set?e[v]:new Set(e[v]||[])).has(k))||h(v=>{const E=new Set(v);return E.has(k)?E.delete(k):E.add(k),E})},m=()=>{g.length!==0&&(t==null||t({action:"BUY",purchases:g,grandTotal:b,bensDelta:b,certsCount:x,ownedUpdate:S}))},w=()=>{c(new Set),h(new Set)},_=k=>{var R,v;(R=k==null?void 0:k.preventDefault)==null||R.call(k),(v=k==null?void 0:k.stopPropagation)==null||v.call(k),t==null||t({action:"SKIP"})};j.useEffect(()=>{const k=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var R,v;return(v=(R=p.current)==null?void 0:R.focus)==null?void 0:v.call(R)},0),()=>{document.body.style.overflow=k}},[]);const A=l.length===0,D=!Object.values(o).some(Boolean);return a.jsx("div",{style:un.wrap,role:"dialog","aria-modal":"true",children:a.jsxs("div",{style:un.card,children:[a.jsx("button",{ref:p,type:"button",style:un.close,onClick:_,"aria-label":"Fechar",children:""}),a.jsx("h2",{style:un.title,children:"Escolha os vendedores e treinamentos que deseja comprar:"}),A?a.jsx("div",{style:un.allDoneBox,children:D?"Nenhum profissional disponvel para treinar no momento.":"Todos os treinamentos j foram comprados para os profissionais disponveis."}):a.jsx(a.Fragment,{children:a.jsxs("div",{style:{marginBottom:"16px"},children:[a.jsx("p",{style:{margin:"0 0 8px",opacity:.9,fontSize:"14px"},children:"Selecione os tipos de vendedores que deseja treinar:"}),a.jsx("div",{style:{...un.vendorRow,gridTemplateColumns:`repeat(${l.length}, minmax(0,1fr))`},children:l.map(k=>a.jsx("button",{type:"button",onClick:()=>y(k.id),style:{...un.vendorBtn,background:u.has(k.id)?"#6f5bd6":"#2a2f3b",borderColor:u.has(k.id)?"rgba(255,255,255,.35)":"rgba(255,255,255,.15)"},children:k.label},k.id))})]})}),!A&&u.size>0&&a.jsxs(a.Fragment,{children:[a.jsx("p",{style:{margin:"10px 2px 14px",opacity:.9},children:"Escolha os treinamentos que sero aplicados a todos os tipos selecionados:"}),a.jsxs("div",{style:{marginBottom:"16px"},children:[a.jsxs("div",{style:{marginBottom:"12px",padding:"8px 12px",background:"#2a2f3b",borderRadius:"8px",border:"1px solid rgba(255,255,255,.15)"},children:[a.jsx("div",{style:{fontWeight:"bold",marginBottom:"4px"},children:"Tipos selecionados:"}),a.jsx("div",{style:{fontSize:"14px",opacity:.9},children:Array.from(u).map(k=>{const R=l.find(v=>v.id===k);return R==null?void 0:R.label}).join(", ")})]}),a.jsx("div",{style:un.products,children:Gi.map(k=>{const R=d.has(k.id),v=Array.from(u).some(E=>(e[E]instanceof Set?e[E]:new Set(e[E]||[])).has(k.id));return a.jsxs("button",{type:"button",onClick:()=>f(k.id),disabled:v,style:{...un.productCard,background:k.colors.bg,borderColor:k.colors.border,boxShadow:R?`0 0 0 3px ${k.colors.pill}`:"none",opacity:v?.45:1,cursor:v?"not-allowed":"pointer"},title:v?"J adquirido para algum tipo selecionado":void 0,children:[a.jsxs("div",{style:un.pill(k.colors.pill),children:["Certificado ",k.cert==="azul"?"Azul":k.cert==="amarelo"?"Amarelo":"Roxo"]}),a.jsx("div",{style:{whiteSpace:"pre-line",fontWeight:800,marginBottom:10},children:k.label}),a.jsxs("div",{style:{fontSize:22,fontWeight:900},children:["$ ",k.price.toLocaleString()]})]},k.id)})})]}),a.jsxs("div",{style:un.actionsRow,children:[a.jsx("button",{type:"button",style:{...un.smallBtn,background:"#3a4152"},onClick:w,children:"Limpar Tudo"}),a.jsx("div",{style:{flex:1}}),a.jsxs("div",{style:{fontWeight:900},children:["Total: $ ",b.toLocaleString(),u.size>1&&a.jsxs("span",{style:{fontSize:"12px",opacity:.8,marginLeft:"8px"},children:["(",d.size," treinamentos  ",u.size," tipos)"]})]})]}),a.jsxs("div",{style:un.btnRow,children:[a.jsx("button",{type:"button",style:{...un.bigBtn,background:"#444"},onClick:_,children:"No comprar"}),a.jsxs("button",{type:"button",disabled:g.length===0,style:{...un.bigBtn,background:g.length>0?"#6f5bd6":"#3a3a3a",opacity:g.length>0?1:.6,cursor:g.length>0?"pointer":"not-allowed"},onClick:m,children:["Comprar (",g.length," tipo",g.length!==1?"s":"",")"]})]})]})]})})}const un={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(980px, 94vw)",maxWidth:980,background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:900},allDoneBox:{background:"#0f1320",border:"1px solid rgba(255,255,255,.15)",borderRadius:12,padding:"14px",fontWeight:800,textAlign:"center"},vendorRow:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:10,marginBottom:12},vendorBtn:{padding:"10px 12px",borderRadius:10,border:"1px solid",color:"#fff",fontWeight:800,cursor:"pointer"},products:{display:"grid",gridTemplateColumns:"repeat(3, minmax(0,1fr))",gap:12,margin:"4px 0 10px"},productCard:{textAlign:"center",padding:"16px 14px",borderRadius:14,border:"2px solid",color:"#fff"},pill:t=>({display:"inline-block",background:t,color:"#111",fontWeight:900,padding:"4px 8px",borderRadius:999,marginBottom:8}),actionsRow:{display:"flex",alignItems:"center",gap:12,margin:"6px 0 6px"},smallBtn:{padding:"10px 14px",borderRadius:10,border:"none",color:"#fff",fontWeight:800,cursor:"pointer"},btnRow:{display:"flex",gap:12,justifyContent:"flex-end",marginTop:12},bigBtn:{minWidth:160,padding:"14px 18px",borderRadius:12,border:"none",color:"#fff",fontWeight:900,cursor:"pointer"}};function Sb({onResolve:t,currentCash:e=0}){const n=j.useRef(null),r=i=>{var l,u;(l=i==null?void 0:i.preventDefault)==null||l.call(i),(u=i==null?void 0:i.stopPropagation)==null||u.call(i),t==null||t({action:"SKIP"})};j.useEffect(()=>{const i=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var l,u;return(u=(l=n.current)==null?void 0:l.focus)==null?void 0:u.call(l)},0),()=>{document.body.style.overflow=i}},[]);const s=i=>()=>{t==null||t({action:"OPEN",open:String(i).toUpperCase()})},o=[{key:"mix",title:"Mix Produtos",lines:["Nvel A: $12000","Nvel B: $6000","Nvel C: $3000","Nvel D: $1000"],onBuy:s("MIX")},{key:"gestor",title:"Gestor Comercial",lines:["Contratao: $5000","Manuteno: $3000"],onBuy:s("MANAGER")},{key:"inside",title:"Inside Sales",lines:["Contratao: $3000","Manuteno: $2000"],onBuy:s("INSIDE")},{key:"field",title:"Field Sales",lines:["Contratao: $3000","Manuteno: $2000"],onBuy:s("FIELD")},{key:"vendedor",title:"Vendedor Comum",lines:["Contratao: $1500","Despesas: $1000"],onBuy:s("COMMON")},{key:"erp",title:"ERP/Sistemas",lines:["Nvel A: $10000","Nvel B: $4000","Nvel C: $1500","Nvel D: $500"],onBuy:s("ERP")},{key:"carteira",title:"Carteira de Clientes",lines:["Aquisio: $1000"],onBuy:s("CLIENTS")},{key:"training",title:"Treinamento",lines:["Azul: $500","Amarelo: $500","Roxo: $500"],onBuy:s("TRAINING")}];return a.jsx("div",{style:ar.wrap,role:"dialog","aria-modal":"true",children:a.jsxs("div",{style:ar.card,children:[a.jsx("button",{ref:n,type:"button",style:ar.close,onClick:r,"aria-label":"Fechar",children:""}),a.jsx("h2",{style:ar.title,children:"Direto de Compra  escolha uma casa para adquirir:"}),a.jsxs("div",{style:{marginBottom:8,opacity:.8,fontSize:13},children:["Saldo atual: ",a.jsxs("b",{children:["$",Number(e).toLocaleString()]})]}),a.jsx("div",{style:ar.grid,children:o.map(i=>a.jsxs("div",{style:ar.cell,children:[a.jsx("div",{style:ar.cellTitle,children:i.title}),a.jsx("ul",{style:ar.lines,children:i.lines.map((l,u)=>a.jsx("li",{children:l},u))}),a.jsx("button",{type:"button",style:ar.buyBtn,onClick:i.onBuy,children:"Comprar"})]},i.key))}),a.jsx("div",{style:{display:"flex",justifyContent:"center",marginTop:16},children:a.jsx("button",{type:"button",style:{...ar.buyBtn,background:"#666"},onClick:r,children:"No Comprar"})})]})})}const ar={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(1000px, 94vw)",background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 16px",fontWeight:800},grid:{display:"grid",gridTemplateColumns:"repeat(4, minmax(180px, 1fr))",gap:12},cell:{background:"#0f1320",border:"1px solid rgba(255,255,255,.08)",borderRadius:12,padding:12,display:"flex",flexDirection:"column",gap:8,minHeight:160},cellTitle:{fontWeight:800,marginBottom:4},lines:{margin:0,padding:"0 0 0 16px",opacity:.85,lineHeight:1.3},buyBtn:{marginTop:"auto",alignSelf:"center",minWidth:140,padding:"10px 14px",borderRadius:10,border:"none",background:"#3fbf49",color:"#09110f",fontWeight:900,cursor:"pointer"}};function Uf({onResolve:t,currentCash:e=0}){const n=j.useRef(null),[r,s]=j.useState(""),{pushModal:o,awaitTop:i}=hn(),l=3e3,u=Te.inside.baseDesp,c=Te.inside.baseFat,d=_=>`$ ${Number(_||0).toLocaleString()}`,h=_=>Te.inside.baseDesp+Te.inside.incDesp*Math.max(0,_),p=_=>Te.inside.baseFat+Te.inside.incFat*Math.max(0,_),g=j.useMemo(()=>{const _=Number(r);return Number.isFinite(_)&&_>0?Math.floor(_):0},[r]),b=g*l,x=g>0,S=Math.max(0,Math.floor(Number(e||0)/l)),y=_=>{var A,D;(A=_==null?void 0:_.preventDefault)==null||A.call(_),(D=_==null?void 0:_.stopPropagation)==null||D.call(_),t==null||t({action:"SKIP"})},f=_=>{const A=Number(r)||0,D=Math.min(S||1/0,A+_);s(D||"")},m=()=>s(S||""),w=async()=>{if(!x)return;const _=Number(e||0),A=Number(b||0);if(_<A){o(a.jsx(Rr,{requiredAmount:A,currentCash:_,title:"Saldo insuficiente para contratar Inside Sales",message:`Voc precisa de $ ${A.toLocaleString()} mas possui $ ${_.toLocaleString()}.`,okLabel:"Entendi"})),await i();return}t==null||t({action:"BUY",qty:g,headcount:g,unitHire:l,total:b,cost:b,totalCost:b,baseExpense:u,baseRevenue:c})};return j.useEffect(()=>{const _=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var A,D;return(D=(A=n.current)==null?void 0:A.focus)==null?void 0:D.call(A)},0),()=>{document.body.style.overflow=_}},[]),a.jsx("div",{style:_t.wrap,role:"dialog","aria-modal":"true","aria-label":"Inside Sales",children:a.jsxs("div",{style:_t.card,children:[a.jsx("button",{ref:n,type:"button",style:_t.close,onClick:y,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:_t.title,children:["Voc pode escolher quantos ",a.jsx("b",{children:"Inside Sales"})," quer comprar:"]}),a.jsxs("div",{style:_t.note,children:[a.jsx("div",{style:{fontWeight:900,marginBottom:4},children:"INSIDE SALES (SDR/BDR + CLOSER + CS)"}),a.jsxs("div",{children:[a.jsx("b",{children:"Base para clculo despesa:"}),"  quantidade ",a.jsx("b",{children:"field sales"})," ou ",a.jsx("b",{children:"inside sales"}),"."]}),a.jsxs("div",{children:[a.jsx("b",{children:"Base para clculo faturamento:"}),"  quantidade ",a.jsx("b",{children:"mxima de clientes que cada vendedor pode atender"}),"."]})]}),a.jsxs("div",{style:_t.saldoRow,children:[a.jsxs("div",{children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",Number(e||0).toLocaleString()]})]}),a.jsxs("div",{children:["Mximo por saldo: ",a.jsx("b",{children:S})]})]}),a.jsxs("div",{style:_t.inputRow,children:[a.jsx("input",{type:"number",inputMode:"numeric",min:1,placeholder:"Digite o nmero de Inside Sales",value:r,onChange:_=>s(_.target.value),style:_t.input}),a.jsxs("div",{style:_t.quickBtns,children:[a.jsx("button",{type:"button",style:_t.quickBtn,onClick:()=>f(1),children:"+1"}),a.jsx("button",{type:"button",style:_t.quickBtn,onClick:()=>f(5),children:"+5"}),a.jsx("button",{type:"button",style:_t.quickBtn,onClick:()=>f(10),children:"+10"}),a.jsx("button",{type:"button",style:{..._t.quickBtn,fontWeight:900},onClick:m,children:"Mx"})]}),a.jsxs("div",{style:_t.totalBox,children:["Total contratar: ",a.jsxs("b",{children:["$ ",Number(b).toLocaleString()]})]})]}),a.jsxs("div",{style:_t.cards,children:[a.jsx(qi,{title:"Sem certificado",bg:"#2a2f3b",pill:"BASE",lines:[`Contratao: $ ${l.toLocaleString()}`,`Despesa: ${d(h(0))}`,`Faturamento: ${d(p(0))}`]}),a.jsx(qi,{title:"1 certificado",bg:"#f1c40f",pill:"NVEL 1",dark:!0,lines:["Contratao: ",`Despesa: ${d(h(1))}`,`Faturamento: ${d(p(1))}`]}),a.jsx(qi,{title:"2 certificados",bg:"#a78bfa",pill:"NVEL 2",dark:!0,lines:["Contratao: ",`Despesa: ${d(h(2))}`,`Faturamento: ${d(p(2))}`]}),a.jsx(qi,{title:"3 certificados",bg:"#8b5cf6",pill:"NVEL 3",dark:!0,lines:["Contratao: ",`Despesa: ${d(h(3))}`,`Faturamento: ${d(p(3))}`]})]}),a.jsxs("div",{style:_t.actions,children:[a.jsx("button",{type:"button",style:{..._t.bigBtn,background:"#666",color:"#fff"},onClick:y,children:"No comprar"}),a.jsxs("button",{type:"button",style:{..._t.bigBtn,background:x?"#3fbf49":"#2f5d33",color:"#09110f"},onClick:w,disabled:!x,title:x?void 0:"Informe uma quantidade vlida",children:["Comprar ",x?`($ ${b.toLocaleString()})`:""]})]})]})})}function qi({title:t,pill:e,lines:n,bg:r,dark:s=!1}){return a.jsxs("div",{style:{..._t.cardItem,background:r,color:s?"#111":"#fff",borderColor:"rgba(255,255,255,.15)"},children:[a.jsxs("div",{style:_t.cardHeader,children:[a.jsx("span",{style:{..._t.pill,background:s?"#111":"#fff",color:s?"#fff":"#111"},children:e}),a.jsx("div",{style:{fontWeight:900},children:t})]}),a.jsx("ul",{style:_t.lines,children:n.map((o,i)=>a.jsx("li",{children:o},i))})]})}const _t={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(980px, 94vw)",background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:900},note:{background:"#2a2f3b",border:"1px solid rgba(255,255,255,.15)",borderRadius:12,padding:"10px 12px",margin:"0 0 10px"},saldoRow:{display:"flex",justifyContent:"space-between",gap:12,padding:"8px 12px",border:"1px dashed rgba(255,255,255,.25)",borderRadius:10,marginBottom:8},inputRow:{display:"grid",gridTemplateColumns:"1fr auto auto",alignItems:"center",gap:10,marginBottom:12},input:{height:42,borderRadius:10,padding:"0 12px",border:"1px solid rgba(255,255,255,.18)",background:"#0f1320",color:"#fff",outline:"none"},quickBtns:{display:"flex",gap:6},quickBtn:{minWidth:44,height:42,borderRadius:10,border:"1px solid rgba(255,255,255,.18)",background:"#2a2f3b",color:"#fff",fontWeight:800,cursor:"pointer",padding:"0 10px"},totalBox:{padding:"8px 12px",borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#0f1320",fontWeight:900},cards:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:12,margin:"8px 0 14px"},cardItem:{border:"1px solid",borderRadius:14,padding:"14px"},cardHeader:{display:"flex",alignItems:"center",gap:8,marginBottom:8},pill:{fontSize:12,fontWeight:900,padding:"4px 8px",borderRadius:999},lines:{margin:0,padding:"0 0 0 16px",lineHeight:1.35},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:8},bigBtn:{minWidth:180,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function Ff({onResolve:t,unitAcquisition:e=1e3,unitMaintenance:n=50,currentCash:r=0}){const s=j.useRef(null),o=j.useRef(null),{pushModal:i,awaitTop:l}=hn(),[u,c]=j.useState(""),d=j.useMemo(()=>{const _=Math.floor(Number(u));return Number.isFinite(_)&&_>0?_:0},[u]),h=Number(e||0),p=Number(n||0),g=Number(r||0),b=j.useMemo(()=>h<=0?0:Math.max(0,Math.floor(g/h)),[g,h]),x=d*h,S=d*p,y=d>0,f=_=>{var A,D;(A=_==null?void 0:_.preventDefault)==null||A.call(_),(D=_==null?void 0:_.stopPropagation)==null||D.call(_),t==null||t({action:"SKIP"})},m=async()=>{if(y){if(g<x){i(a.jsx(Rr,{requiredAmount:x,currentCash:g,title:"Saldo insuficiente para comprar clientes",message:"Voc no possui saldo suficiente para concluir esta aquisio.",okLabel:"Entendi"})),await l();return}t==null||t({action:"BUY",qty:d,unitAcquisition:h,totalCost:x,unitMaintenance:p,maintenanceDelta:S,bensDelta:x,clientsAdded:d,source:{modal:"BuyClientsModal",file:"src/modals/BuyClientsModal.jsx"}})}};j.useEffect(()=>{const _=document.body.style.overflow;document.body.style.overflow="hidden";const A=setTimeout(()=>{var R,v;return(v=(R=s.current)==null?void 0:R.focus)==null?void 0:v.call(R)},0),D=setTimeout(()=>{var R,v;return(v=(R=o.current)==null?void 0:R.focus)==null?void 0:v.call(R)},50),k=R=>{R.key==="Enter"&&(R.preventDefault(),m())};return window.addEventListener("keydown",k),()=>{document.body.style.overflow=_,window.removeEventListener("keydown",k),clearTimeout(A),clearTimeout(D)}},[]);const w=_=>{const A=Math.max(0,Math.min(Math.floor(Number(_)||0),1e6));c(String(A))};return a.jsx("div",{style:Gt.wrap,role:"dialog","aria-modal":"true",onMouseDown:_=>{_.target===_.currentTarget&&_.stopPropagation()},children:a.jsxs("div",{style:Gt.card,onMouseDown:_=>_.stopPropagation(),children:[a.jsx("button",{ref:s,type:"button",style:Gt.close,onClick:f,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:Gt.title,children:["Voc pode escolher quantos clientes quer comprar,",a.jsx("br",{}),"Digite o nmero de clientes:"]}),a.jsxs("p",{style:Gt.warn,children:[a.jsx("b",{children:"Mas cuidado com a capacidade de atendimento da sua equipe!"}),a.jsx("br",{}),"Se o jogador adquirir mais clientes do que os vendedores podem atender, assim que passar na casa ",a.jsx("i",{children:"Faturamento do Ms"})," no receber o faturamento dos clientes excedentes e perder o(s) cliente(s) que no foram atendidos."]}),a.jsxs("div",{style:Gt.inlineInfo,children:[a.jsxs("div",{children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",g.toLocaleString()]})]}),a.jsxs("div",{children:["Mximo por saldo: ",a.jsx("b",{children:b})]})]}),a.jsxs("div",{style:Gt.qtyRow,children:[a.jsx("input",{ref:o,type:"number",inputMode:"numeric",min:1,placeholder:"Digite o nmero de Clientes",value:u,onChange:_=>w(_.target.value),style:Gt.input}),a.jsxs("div",{style:Gt.quickBtns,children:[a.jsx("button",{type:"button",style:Gt.qbtn,onClick:()=>w(d+1),children:"+1"}),a.jsx("button",{type:"button",style:Gt.qbtn,onClick:()=>w(d+5),children:"+5"}),a.jsx("button",{type:"button",style:Gt.qbtn,onClick:()=>w(d+10),children:"+10"}),a.jsx("button",{type:"button",style:Gt.qbtn,onClick:()=>w(b),title:"Comprar o mximo possvel com o saldo atual",children:"Mx"})]})]}),a.jsxs("div",{style:Gt.summary,children:[a.jsxs("div",{children:["Preo por cliente: ",a.jsxs("b",{children:["$ ",h.toLocaleString()]})]}),a.jsxs("div",{children:["Despesa mensal por cliente: ",a.jsxs("b",{children:["$ ",p.toLocaleString()]})]})]}),a.jsxs("div",{style:Gt.summaryStrong,children:[a.jsxs("div",{children:["Total compra: ",a.jsxs("b",{children:["$ ",Number(x).toLocaleString()]})]}),a.jsxs("div",{children:["Manuteno mensal adicionada: ",a.jsxs("b",{children:["$ ",Number(S).toLocaleString()]})]})]}),a.jsxs("div",{style:Gt.actions,children:[a.jsx("button",{type:"button",style:{...Gt.bigBtn,background:"#666",color:"#fff"},onClick:f,children:"No comprar"}),a.jsxs("button",{type:"button",style:{...Gt.bigBtn,background:y?"#3fbf49":"#2f5d33",color:"#09110f"},onClick:m,disabled:!y,title:y?g<x?"Saldo insuficiente":void 0:"Informe uma quantidade vlida",children:["Comprar ",y?`($ ${x.toLocaleString()})`:""]})]})]})})}const Gt={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(820px, 92vw)",maxWidth:820,background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px 20px 16px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:800,lineHeight:1.3},warn:{background:"#271c12",border:"1px solid rgba(255,180,0,.35)",color:"#ffd489",borderRadius:10,padding:"10px 12px",margin:"0 0 12px"},inlineInfo:{display:"flex",justifyContent:"space-between",gap:10,margin:"0 0 8px",opacity:.95,fontWeight:700,flexWrap:"wrap"},qtyRow:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},input:{flex:"1 1 260px",height:42,borderRadius:10,padding:"0 12px",border:"1px solid rgba(255,255,255,.18)",background:"#0f1320",color:"#fff",outline:"none"},quickBtns:{display:"flex",gap:6,flexWrap:"wrap"},qbtn:{height:42,padding:"0 12px",borderRadius:10,border:"1px solid rgba(255,255,255,.18)",background:"#2a2f3b",color:"#fff",cursor:"pointer",fontWeight:800},summary:{display:"flex",justifyContent:"space-between",gap:10,border:"1px dashed rgba(255,255,255,.2)",borderRadius:10,padding:"8px 12px",marginBottom:8,fontWeight:700,flexWrap:"wrap"},summaryStrong:{display:"flex",justifyContent:"space-between",gap:10,border:"1px solid rgba(255,255,255,.25)",borderRadius:10,padding:"10px 12px",marginBottom:10,fontWeight:800,flexWrap:"wrap"},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:4,flexWrap:"wrap"},bigBtn:{minWidth:180,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function zf({onResolve:t,unitHire:e=5e3,unitExpense:n=Te.gestor.baseDesp,managesUpTo:r=Om,currentCash:s=0}){const o=j.useRef(null),i=j.useRef(null),{pushModal:l,awaitTop:u}=hn(),[c,d]=j.useState(""),h=Number(e||0),p=Number(n||0),g=Number(s||0),b=j.useMemo(()=>{const R=Math.floor(Number(c));return Number.isFinite(R)&&R>0?R:0},[c]),x=j.useMemo(()=>h<=0?0:Math.max(0,Math.floor(g/h)),[g,h]),S=b*h,y=b*p,f=b>0,m=R=>`$ ${Number(R||0).toLocaleString()}`,w=R=>Te.gestor.baseDesp+Te.gestor.incDesp*Math.max(0,R),_=R=>{const v=Math.max(0,R);return(La[Math.min(v,La.length-1)]||0)*100},A=R=>{const v=Math.floor(Number(R)||0),E=Math.max(0,Math.min(v,1e6));d(String(E))},D=R=>{var v,E;(v=R==null?void 0:R.preventDefault)==null||v.call(R),(E=R==null?void 0:R.stopPropagation)==null||E.call(R),t==null||t({action:"SKIP"})},k=async()=>{if(f){if(g<S){l(a.jsx(Rr,{requiredAmount:S,currentCash:g,title:"Saldo insuficiente para contratar Gestores",message:"Voc no possui saldo suficiente para concluir esta contratao.",okLabel:"Entendi"})),await u();return}t==null||t({action:"BUY",role:"MANAGER",qty:b,headcount:b,gestoresDelta:b,unitHire:h,unitExpense:p,totalHire:S,totalExpense:y,cost:S,total:S,cashDelta:-S,expenseDelta:y,hudUpdate:{category:"Gestores Comerciais",addQty:b}})}};return j.useEffect(()=>{const R=document.body.style.overflow;document.body.style.overflow="hidden";const v=setTimeout(()=>{var $,U;return(U=($=o.current)==null?void 0:$.focus)==null?void 0:U.call($)},0),E=setTimeout(()=>{var $,U;return(U=($=i.current)==null?void 0:$.focus)==null?void 0:U.call($)},60),T=$=>{$.key==="Enter"&&($.preventDefault(),k())};return window.addEventListener("keydown",T),()=>{document.body.style.overflow=R,window.removeEventListener("keydown",T),clearTimeout(v),clearTimeout(E)}},[]),a.jsx("div",{style:nt.wrap,role:"dialog","aria-modal":"true",onMouseDown:R=>{R.target===R.currentTarget&&R.stopPropagation()},children:a.jsxs("div",{style:nt.card,onMouseDown:R=>R.stopPropagation(),children:[a.jsx("button",{ref:o,type:"button",style:nt.close,onClick:D,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:nt.title,children:["Voc pode escolher quantos ",a.jsx("b",{children:"Gestores"})," quer comprar,",a.jsx("br",{}),"Digite o nmero de gestores:"]}),a.jsxs("div",{style:nt.inlineInfo,children:[a.jsxs("div",{children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",g.toLocaleString()]})]}),a.jsxs("div",{children:["Mximo por saldo: ",a.jsx("b",{children:x})]})]}),a.jsxs("div",{style:nt.qtyRow,children:[a.jsx("input",{ref:i,type:"number",inputMode:"numeric",min:1,placeholder:"Digite o nmero de Gestores",value:c,onChange:R=>A(R.target.value),style:nt.input}),a.jsxs("div",{style:nt.quickBtns,children:[a.jsx("button",{type:"button",style:nt.qbtn,onClick:()=>A(b+1),children:"+1"}),a.jsx("button",{type:"button",style:nt.qbtn,onClick:()=>A(b+5),children:"+5"}),a.jsx("button",{type:"button",style:nt.qbtn,onClick:()=>A(b+10),children:"+10"}),a.jsx("button",{type:"button",style:nt.qbtn,onClick:()=>A(x),title:"Comprar o mximo possvel com o saldo atual",children:"Mx"})]})]}),a.jsxs("div",{style:nt.infoBox,children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"GESTOR COMERCIAL"}),a.jsxs("div",{style:{opacity:.9,marginBottom:8},children:["Base para clculo de despesa: ",a.jsx("b",{children:"x quantidade de Gestores"}),".",a.jsx("br",{}),"Cada Gestor gerencia at ",a.jsx("b",{children:r})," colaboradores."]}),a.jsxs("div",{style:nt.table,children:[a.jsxs("div",{style:nt.trHead,children:[a.jsx("div",{style:nt.th,children:"Certificao"}),a.jsx("div",{style:nt.th,children:"Contratao"}),a.jsx("div",{style:nt.th,children:"Despesa"}),a.jsx("div",{style:nt.th,children:"Efeito"})]}),a.jsx(Hi,{label:"Sem Certificado",hire:m(e),expense:m(w(0)),revenue:`potencializa colaboradores em ${_(0)}%`}),a.jsx(Hi,{label:"Com 1 certificado",hire:"-",expense:m(w(1)),revenue:`potencializa colaboradores em ${_(1)}%`}),a.jsx(Hi,{label:"Com 2 certificados",hire:"-",expense:m(w(2)),revenue:`potencializa colaboradores em ${_(2)}%`}),a.jsx(Hi,{label:"Com 3 certificados",hire:"-",expense:m(w(3)),revenue:`potencializa colaboradores em ${_(3)}%`})]})]}),a.jsxs("div",{style:nt.summary,children:[a.jsxs("div",{children:["Custo de contratao (pagamento nico): ",a.jsxs("b",{children:["$ ",Number(e).toLocaleString()]})," / gestor"]}),a.jsxs("div",{children:["Despesa mensal recorrente (OPEX): ",a.jsxs("b",{children:["$ ",Number(n).toLocaleString()]})," / gestor"]})]}),a.jsxs("div",{style:nt.summaryStrong,children:[a.jsxs("div",{children:["Total contratar: ",a.jsxs("b",{children:["$ ",Number(S).toLocaleString()]})]}),a.jsxs("div",{children:["Despesa mensal total: ",a.jsxs("b",{children:["$ ",Number(y).toLocaleString()]})]})]}),a.jsxs("div",{style:nt.actions,children:[a.jsx("button",{type:"button",style:{...nt.bigBtn,background:"#666",color:"#fff"},onClick:D,children:"No comprar"}),a.jsxs("button",{type:"button",style:{...nt.bigBtn,background:f?"#3fbf49":"#2f5d33",color:"#09110f"},onClick:k,disabled:!f,title:f?g<S?"Saldo insuficiente":void 0:"Informe uma quantidade vlida",children:["Comprar ",f?`(${b})`:""]})]})]})})}function Hi({label:t,hire:e,expense:n,revenue:r}){const s=o=>typeof o=="number"?`$ ${Number(o).toLocaleString()}`:o;return a.jsxs("div",{style:nt.tr,children:[a.jsx("div",{style:nt.td,children:t}),a.jsx("div",{style:nt.td,children:s(e)}),a.jsx("div",{style:nt.td,children:s(n)}),a.jsx("div",{style:nt.td,children:r})]})}const nt={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(880px, 92vw)",maxWidth:880,background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px 20px 16px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:800,lineHeight:1.3},inlineInfo:{display:"flex",justifyContent:"space-between",gap:10,margin:"0 0 8px",opacity:.95,fontWeight:700,flexWrap:"wrap"},qtyRow:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},input:{flex:"1 1 260px",height:42,borderRadius:10,padding:"0 12px",border:"1px solid rgba(255,255,255,.18)",background:"#0f1320",color:"#fff",outline:"none"},quickBtns:{display:"flex",gap:6,flexWrap:"wrap"},qbtn:{height:42,padding:"0 12px",borderRadius:10,border:"1px solid rgba(255,255,255,.18)",background:"#2a2f3b",color:"#fff",cursor:"pointer",fontWeight:800},infoBox:{border:"1px solid rgba(255,255,255,.12)",borderRadius:12,padding:"12px",background:"#101522",marginBottom:12},table:{border:"1px solid rgba(255,255,255,.12)",borderRadius:10,overflow:"hidden"},trHead:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 3fr",background:"#121621"},th:{padding:"10px 12px",fontWeight:800,borderLeft:"1px solid rgba(255,255,255,.06)"},tr:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 3fr",background:"#0f1320"},td:{padding:"10px 12px",borderTop:"1px solid rgba(255,255,255,.06)",borderLeft:"1px solid rgba(255,255,255,.06)"},summary:{display:"flex",justifyContent:"space-between",border:"1px dashed rgba(255,255,255,.2)",borderRadius:10,padding:"8px 12px",marginTop:10,flexWrap:"wrap",gap:10},summaryStrong:{display:"flex",justifyContent:"space-between",border:"1px solid rgba(255,255,255,.25)",borderRadius:10,padding:"10px 12px",marginTop:8,fontWeight:800,flexWrap:"wrap",gap:10},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:12,flexWrap:"wrap"},bigBtn:{minWidth:180,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function Wf({onResolve:t,unitHire:e=3e3,unitExpense:n=Te.field.baseDesp,attendsUpTo:r=Te.field.cap,currentCash:s=0}){const o=j.useRef(null),i=j.useRef(null),{pushModal:l,awaitTop:u}=hn(),[c,d]=j.useState(""),h=Number(e||0),p=Number(n||0),g=Number(s||0),b=j.useMemo(()=>{const E=Math.floor(Number(c));return Number.isFinite(E)&&E>0?E:0},[c]),x=j.useMemo(()=>h<=0?0:Math.max(0,Math.floor(g/h)),[g,h]),S=b*h,y=b*p,f=Te.field.baseFat,m=b*f,w=b>0,_=E=>`$ ${Number(E||0).toLocaleString()}`,A=E=>Te.field.baseDesp+Te.field.incDesp*Math.max(0,E),D=E=>Te.field.baseFat+Te.field.incFat*Math.max(0,E),k=E=>{const T=Math.floor(Number(E)||0),$=Math.max(0,Math.min(T,1e6));d(String($))},R=E=>{var T,$;(T=E==null?void 0:E.preventDefault)==null||T.call(E),($=E==null?void 0:E.stopPropagation)==null||$.call(E),t==null||t({action:"SKIP"})},v=async()=>{if(w){if(g<S){l(a.jsx(Rr,{requiredAmount:S,currentCash:g,title:"Saldo insuficiente para contratar Field Sales",message:"Voc no possui saldo suficiente para concluir esta contratao.",okLabel:"Entendi"})),await u();return}t==null||t({action:"BUY",qty:b,unitHire:h,unitExpense:p,totalHire:S,totalExpense:y,cashDelta:-S,expenseDelta:y,revenueDelta:m,cost:S,total:S,role:"FIELD"})}};return j.useEffect(()=>{const E=document.body.style.overflow;document.body.style.overflow="hidden";const T=setTimeout(()=>{var V,Je;return(Je=(V=o.current)==null?void 0:V.focus)==null?void 0:Je.call(V)},0),$=setTimeout(()=>{var V,Je;return(Je=(V=i.current)==null?void 0:V.focus)==null?void 0:Je.call(V)},50),U=V=>{V.key==="Enter"&&(V.preventDefault(),v())};return window.addEventListener("keydown",U),()=>{document.body.style.overflow=E,window.removeEventListener("keydown",U),clearTimeout(T),clearTimeout($)}},[]),a.jsx("div",{style:rt.wrap,role:"dialog","aria-modal":"true",onMouseDown:E=>{E.target===E.currentTarget&&E.stopPropagation()},children:a.jsxs("div",{style:rt.card,onMouseDown:E=>E.stopPropagation(),children:[a.jsx("button",{ref:o,type:"button",style:rt.close,onClick:R,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:rt.title,children:["Voc pode escolher quantos ",a.jsx("b",{children:"Field Sales"})," quer comprar,",a.jsx("br",{}),"Digite o nmero de vendedores:"]}),a.jsxs("div",{style:rt.inlineInfo,children:[a.jsxs("div",{children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",g.toLocaleString()]})]}),a.jsxs("div",{children:["Mximo por saldo: ",a.jsx("b",{children:x})]})]}),a.jsxs("div",{style:rt.qtyRow,children:[a.jsx("input",{ref:i,type:"number",inputMode:"numeric",min:1,placeholder:"Digite o nmero de Field Sales",value:c,onChange:E=>k(E.target.value),style:rt.input}),a.jsxs("div",{style:rt.quickBtns,children:[a.jsx("button",{type:"button",style:rt.qbtn,onClick:()=>k(b+1),children:"+1"}),a.jsx("button",{type:"button",style:rt.qbtn,onClick:()=>k(b+5),children:"+5"}),a.jsx("button",{type:"button",style:rt.qbtn,onClick:()=>k(b+10),children:"+10"}),a.jsx("button",{type:"button",style:rt.qbtn,onClick:()=>k(x),title:"Comprar o mximo possvel com o saldo atual",children:"Mx"})]})]}),a.jsxs("div",{style:rt.infoBox,children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"FIELD SALES (REPRESENTANTES COMERCIAIS)"}),a.jsxs("div",{style:{opacity:.9,marginBottom:8},children:["Base para clculo de despesa: ",a.jsx("b",{children:"x quantidade de Field Sales"}),".",a.jsx("br",{}),"Base para clculo de faturamento: ",a.jsx("b",{children:"x quantidade mxima de clientes que cada vendedor pode atender"}),".",a.jsx("br",{}),"Cada vendedor atende at ",a.jsx("b",{children:r})," clientes."]}),a.jsxs("div",{style:rt.table,children:[a.jsxs("div",{style:rt.trHead,children:[a.jsx("div",{style:rt.th,children:"Certificao"}),a.jsx("div",{style:rt.th,children:"Contratao"}),a.jsx("div",{style:rt.th,children:"Despesa"}),a.jsx("div",{style:rt.th,children:"Faturamento"})]}),a.jsx(Ki,{label:"S/ Certificado",hire:_(e),expense:_(A(0)),revenue:_(D(0))}),a.jsx(Ki,{label:"Com 1 certificado",hire:"-",expense:_(A(1)),revenue:_(D(1))}),a.jsx(Ki,{label:"Com 2 certificados",hire:"-",expense:_(A(2)),revenue:_(D(2))}),a.jsx(Ki,{label:"Com 3 certificados",hire:"-",expense:_(A(3)),revenue:_(D(3))})]})]}),a.jsxs("div",{style:rt.summary,children:[a.jsxs("div",{children:["Custo de contratao (pagamento nico): ",a.jsxs("b",{children:["$ ",Number(e).toLocaleString()]})," / vendedor"]}),a.jsxs("div",{children:["Despesa mensal recorrente (OPEX): ",a.jsxs("b",{children:["$ ",Number(n).toLocaleString()]})," / vendedor"]})]}),a.jsxs("div",{style:rt.summaryStrong,children:[a.jsxs("div",{children:["Total contratar: ",a.jsxs("b",{children:["$ ",Number(S).toLocaleString()]})]}),a.jsxs("div",{children:["Despesa mensal total: ",a.jsxs("b",{children:["$ ",Number(y).toLocaleString()]})]})]}),a.jsxs("div",{style:rt.actions,children:[a.jsx("button",{type:"button",style:{...rt.bigBtn,background:"#666",color:"#fff"},onClick:R,children:"No comprar"}),a.jsxs("button",{type:"button",style:{...rt.bigBtn,background:w?"#75e16c":"#365b31",color:"#0b120a"},onClick:v,disabled:!w,title:w?g<S?"Saldo insuficiente":void 0:"Informe uma quantidade vlida",children:["Comprar ",w?`(${b})`:""]})]})]})})}function Ki({label:t,hire:e,expense:n,revenue:r}){return a.jsxs("div",{style:rt.tr,children:[a.jsx("div",{style:rt.td,children:t}),a.jsx("div",{style:rt.td,children:e}),a.jsx("div",{style:rt.td,children:n}),a.jsx("div",{style:rt.td,children:r})]})}const rt={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(880px, 92vw)",maxWidth:880,background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px 20px 16px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:800,lineHeight:1.3},inlineInfo:{display:"flex",justifyContent:"space-between",gap:10,margin:"0 0 8px",opacity:.95,fontWeight:700,flexWrap:"wrap"},qtyRow:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},input:{flex:"1 1 260px",height:42,borderRadius:10,padding:"0 12px",border:"1px solid rgba(255,255,255,.18)",background:"#0f1320",color:"#fff",outline:"none"},quickBtns:{display:"flex",gap:6,flexWrap:"wrap"},qbtn:{height:42,padding:"0 12px",borderRadius:10,border:"1px solid rgba(255,255,255,.18)",background:"#2a2f3b",color:"#fff",cursor:"pointer",fontWeight:800},infoBox:{border:"1px solid rgba(255,255,255,.12)",borderRadius:12,padding:"12px",background:"#101522",marginBottom:12},table:{border:"1px solid rgba(255,255,255,.12)",borderRadius:10,overflow:"hidden"},trHead:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",background:"#121621"},th:{padding:"10px 12px",fontWeight:800,borderLeft:"1px solid rgba(255,255,255,.06)"},tr:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",background:"#0f1320"},td:{padding:"10px 12px",borderTop:"1px solid rgba(255,255,255,.06)",borderLeft:"1px solid rgba(255,255,255,.06)"},summary:{display:"flex",justifyContent:"space-between",border:"1px dashed rgba(255,255,255,.2)",borderRadius:10,padding:"8px 12px",marginTop:10,flexWrap:"wrap",gap:10},summaryStrong:{display:"flex",justifyContent:"space-between",border:"1px solid rgba(255,255,255,.25)",borderRadius:10,padding:"10px 12px",marginTop:8,fontWeight:800,flexWrap:"wrap",gap:10},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:12,flexWrap:"wrap"},bigBtn:{minWidth:180,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function Vf({onResolve:t,unitHire:e=1500,unitExpense:n=Te.comum.baseDesp,attendsUpTo:r=Te.comum.cap,currentCash:s=0}){const[o,i]=j.useState(""),l=j.useRef(null),u=j.useRef(null),{pushModal:c,awaitTop:d}=hn(),h=Number(e||0),p=Number(n||0),g=Number(s||0),b=Te.comum.baseFat,x=v=>`$ ${Number(v||0).toLocaleString()}`,S=v=>Te.comum.baseDesp+Te.comum.incDesp*Math.max(0,v),y=v=>Te.comum.baseFat+Te.comum.incFat*Math.max(0,v),f=j.useMemo(()=>{const v=Math.floor(Number(o));return Number.isFinite(v)&&v>0?v:0},[o]),m=j.useMemo(()=>h<=0?0:Math.max(0,Math.floor(g/h)),[g,h]),w=j.useMemo(()=>f*h,[f,h]),_=j.useMemo(()=>f*p,[f,p]),A=f>0,D=v=>{const E=Math.floor(Number(v)||0),T=Math.max(0,Math.min(E,1e6));i(String(T))},k=v=>{var E;(E=v==null?void 0:v.stopPropagation)==null||E.call(v),t==null||t({action:"SKIP"})},R=async()=>{if(!A)return;if(g<w){c(a.jsx(Rr,{requiredAmount:w,currentCash:g,title:"Saldo insuficiente para contratar vendedores",message:"Voc no possui saldo suficiente para concluir esta contratao.",okLabel:"Entendi"})),await d();return}const v={action:"BUY",role:"COMMON",qty:f,headcount:f,unitHire:h,unitExpense:p,totalHire:w,totalExpense:_,total:w,cost:w,attendsUpTo:r,cashDelta:-w,expenseDelta:_,revenueDelta:b*f,revenuePerSeller:b,hudUpdate:{category:"Vendedores Comuns",addQty:f}};t==null||t(v)};return j.useEffect(()=>{const v=document.body.style.overflow;document.body.style.overflow="hidden";const E=setTimeout(()=>{var U,V;return(V=(U=l.current)==null?void 0:U.focus)==null?void 0:V.call(U)},0),T=setTimeout(()=>{var U,V;return(V=(U=u.current)==null?void 0:U.focus)==null?void 0:V.call(U)},50),$=U=>{U.key==="Enter"&&(U.preventDefault(),R())};return window.addEventListener("keydown",$),()=>{document.body.style.overflow=v,window.removeEventListener("keydown",$),clearTimeout(E),clearTimeout(T)}},[]),a.jsx("div",{style:st.wrap,role:"dialog","aria-modal":"true","aria-label":"Comprar Vendedores Comuns",onMouseDown:v=>{v.target===v.currentTarget&&v.stopPropagation()},children:a.jsxs("div",{style:st.card,onMouseDown:v=>v.stopPropagation(),children:[a.jsx("button",{ref:l,type:"button",style:st.close,onClick:k,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:st.title,children:["Voc pode escolher quantos ",a.jsx("b",{children:"Vendedores Comuns"})," quer comprar,",a.jsx("br",{}),"Digite o nmero de vendedores:"]}),a.jsxs("div",{style:st.inlineInfo,children:[a.jsxs("div",{children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",g.toLocaleString()]})]}),a.jsxs("div",{children:["Mximo por saldo: ",a.jsx("b",{children:m})]})]}),a.jsxs("div",{style:st.qtyRow,children:[a.jsx("input",{ref:u,type:"number",inputMode:"numeric",min:1,placeholder:"Digite o nmero de Vendedores Comuns",value:o,onChange:v=>D(v.target.value),style:st.input}),a.jsxs("div",{style:st.quickBtns,children:[a.jsx("button",{type:"button",style:st.qbtn,onClick:()=>D(f+1),children:"+1"}),a.jsx("button",{type:"button",style:st.qbtn,onClick:()=>D(f+5),children:"+5"}),a.jsx("button",{type:"button",style:st.qbtn,onClick:()=>D(f+10),children:"+10"}),a.jsx("button",{type:"button",style:st.qbtn,onClick:()=>D(m),title:"Comprar o mximo possvel com o saldo atual",children:"Mx"})]})]}),a.jsxs("div",{style:st.infoBox,children:[a.jsx("div",{style:{fontWeight:800,marginBottom:6},children:"VENDEDOR COMUM (FAZ TUDO)"}),a.jsxs("div",{style:{opacity:.9,marginBottom:8},children:["Base para clculo despesa: ",a.jsx("b",{children:"x quantidade vendedor comum"}),".",a.jsx("br",{}),"Base para clculo faturamento: ",a.jsx("b",{children:"x quantidade mxima de clientes que cada vendedor pode atender"}),".",a.jsx("br",{}),a.jsxs("b",{children:["Atende at ",r," clientes"]}),"."]}),a.jsxs("div",{style:st.table,children:[a.jsxs("div",{style:st.trHead,children:[a.jsx("div",{style:st.th,children:"Certificao"}),a.jsx("div",{style:st.th,children:"Contratao"}),a.jsx("div",{style:st.th,children:"Despesa"}),a.jsx("div",{style:st.th,children:"Faturamento"})]}),a.jsx(Ji,{label:"S/ Certificado",hire:x(e),expense:x(S(0)),revenue:x(y(0))}),a.jsx(Ji,{label:"Com 1 certificado",hire:"-",expense:x(S(1)),revenue:x(y(1))}),a.jsx(Ji,{label:"Com 2 certificados",hire:"-",expense:x(S(2)),revenue:x(y(2))}),a.jsx(Ji,{label:"Com 3 certificados",hire:"-",expense:x(S(3)),revenue:x(y(3))})]})]}),a.jsxs("div",{style:st.summary,children:[a.jsxs("div",{children:["Custo de contratao (pagamento nico): ",a.jsxs("b",{children:["$ ",Number(e).toLocaleString()]})," / vendedor"]}),a.jsxs("div",{children:["Despesa mensal recorrente (OPEX): ",a.jsxs("b",{children:["$ ",Number(n).toLocaleString()]})," / vendedor"]})]}),a.jsxs("div",{style:st.summaryStrong,children:[a.jsxs("div",{children:["Total contratar: ",a.jsxs("b",{children:["$ ",Number(w).toLocaleString()]})]}),a.jsxs("div",{children:["Despesa mensal total: ",a.jsxs("b",{children:["$ ",Number(_).toLocaleString()]})]})]}),a.jsxs("div",{style:st.actions,children:[a.jsx("button",{type:"button",style:{...st.bigBtn,background:"#666",color:"#fff"},onClick:k,children:"No comprar"}),a.jsx("button",{type:"button",disabled:!A,style:{...st.bigBtn,background:A?"#7cbe1a":"#3a3f4a",color:"#0d1200",fontWeight:900},onClick:R,title:A?g<w?"Saldo insuficiente":void 0:"Informe uma quantidade vlida",children:"Comprar"})]})]})})}function Ji({label:t,hire:e,expense:n,revenue:r}){return a.jsxs("div",{style:st.tr,children:[a.jsx("div",{style:st.td,children:t}),a.jsx("div",{style:st.td,children:e}),a.jsx("div",{style:st.td,children:n}),a.jsx("div",{style:st.td,children:r})]})}const st={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(880px, 92vw)",maxWidth:880,background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px 20px 16px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:800,lineHeight:1.3},inlineInfo:{display:"flex",justifyContent:"space-between",gap:10,margin:"0 0 8px",opacity:.95,fontWeight:700,flexWrap:"wrap"},qtyRow:{display:"flex",gap:8,alignItems:"center",marginBottom:12,flexWrap:"wrap"},input:{flex:"1 1 260px",height:42,borderRadius:10,padding:"0 12px",border:"1px solid rgba(255,255,255,.18)",background:"#111522",color:"#eef2f7",outline:"none"},quickBtns:{display:"flex",gap:6,flexWrap:"wrap"},qbtn:{height:42,padding:"0 12px",borderRadius:10,border:"1px solid rgba(255,255,255,.18)",background:"#2a2f3b",color:"#fff",cursor:"pointer",fontWeight:800},infoBox:{background:"#161a28",border:"1px solid rgba(255,255,255,.12)",borderRadius:14,padding:14,marginTop:6},table:{border:"1px solid rgba(255,255,255,.12)",borderRadius:12,overflow:"hidden",marginTop:8},trHead:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",background:"#121621"},th:{padding:"10px 12px",fontWeight:800,borderLeft:"1px solid rgba(255,255,255,.06)"},tr:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",background:"#0f1320"},td:{padding:"10px 12px",borderTop:"1px solid rgba(255,255,255,.06)",borderLeft:"1px solid rgba(255,255,255,.06)"},summary:{display:"flex",justifyContent:"space-between",border:"1px dashed rgba(255,255,255,.2)",borderRadius:10,padding:"8px 12px",marginTop:10,flexWrap:"wrap",gap:10},summaryStrong:{display:"flex",justifyContent:"space-between",border:"1px solid rgba(255,255,255,.25)",borderRadius:10,padding:"10px 12px",marginTop:8,fontWeight:800,flexWrap:"wrap",gap:10},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:12,flexWrap:"wrap"},bigBtn:{minWidth:180,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function Gf({onResolve:t,currentCash:e,currentLevel:n=null,mixOwned:r=null}){const s=j.useRef(null),{pushModal:o,awaitTop:i}=hn(),l={A:{compra:12e3,despesa:dr.A.despPerClient,faturamento:dr.A.fatPerClient,color:"#1d4ed8",pill:"NVEL A",label:"100 produtos"},B:{compra:6e3,despesa:dr.B.despPerClient,faturamento:dr.B.fatPerClient,color:"#16a34a",pill:"NVEL B",label:"50 produtos"},C:{compra:3e3,despesa:dr.C.despPerClient,faturamento:dr.C.fatPerClient,color:"#f59e0b",pill:"NVEL C",label:"20 produtos"},D:{compra:1e3,despesa:dr.D.despPerClient,faturamento:dr.D.fatPerClient,color:"#6b7280",pill:"NVEL D",label:"5 produtos"}};async function u(d){if(r?r[d]===!0:n===d)return;const p=l[d],g=Number((p==null?void 0:p.compra)||0),b=Number(e);if(Number.isFinite(b)&&b>=0&&b<g){o(a.jsx(Rr,{requiredAmount:g,currentCash:b,title:"Saldo insuficiente para adquirir o Mix de Produtos",message:`Voc precisa de $ ${g.toLocaleString()} mas possui $ ${b.toLocaleString()}.`,okLabel:"Entendi"})),await i();return}t==null||t({action:"BUY",level:d,...p})}function c(){t==null||t({action:"SKIP"})}return j.useEffect(()=>{const d=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var h,p;return(p=(h=s.current)==null?void 0:h.focus)==null?void 0:p.call(h)},0),()=>{document.body.style.overflow=d}},[]),a.jsx("div",{style:wn.wrap,role:"dialog","aria-modal":"true","aria-label":"Mix de Produtos",children:a.jsxs("div",{style:wn.card,children:[a.jsx("button",{ref:s,type:"button",style:wn.close,onClick:c,"aria-label":"Fechar",children:""}),a.jsxs("h2",{style:wn.title,children:["Escolha um ",a.jsx("b",{children:"mix de produtos"}),":"]}),a.jsxs("div",{style:wn.note,children:[a.jsx("div",{style:{fontWeight:900,marginBottom:4},children:"MIX DE PRODUTOS"}),a.jsxs("div",{children:["Base para clculo de ",a.jsx("b",{children:"Despesa"}),"/",a.jsx("b",{children:"Faturamento"}),": multiplicar pela ",a.jsx("b",{children:"quantidade total de clientes"}),"."]})]}),Number.isFinite(Number(e))&&a.jsxs("div",{style:wn.saldo,children:["Saldo disponvel: ",a.jsxs("b",{children:["$ ",Number(e||0).toLocaleString()]})]}),a.jsx("div",{style:wn.cards,children:["A","B","C","D"].map(d=>{const h=l[d],p=r?r[d]===!0:n===d,g=p;return a.jsxs("div",{style:{...wn.cardItem,borderColor:p?"#16a34a":"rgba(255,255,255,.15)",opacity:g?.6:1},children:[a.jsx("div",{style:{...wn.pill,background:p?"#16a34a":"#fff",color:p?"#fff":"#111"},children:p?" ADQUIRIDO":h.pill}),a.jsx("div",{style:{...wn.cardBadge,background:h.color}}),a.jsxs("ul",{style:wn.lines,children:[a.jsx("li",{children:a.jsx("b",{children:h.label})}),a.jsxs("li",{children:["Compra: ",a.jsxs("b",{children:["$ ",h.compra.toLocaleString()]})]}),a.jsxs("li",{children:["Despesa: ",a.jsxs("b",{children:["$ ",h.despesa.toLocaleString()]})]}),a.jsxs("li",{children:["Faturamento: ",a.jsxs("b",{children:["$ ",h.faturamento.toLocaleString()]})]})]}),a.jsx("button",{type:"button",style:{...wn.buyBtn,background:g?"#6b7280":"#2442f9",cursor:g?"not-allowed":"pointer"},onClick:()=>u(d),disabled:g,title:g?`Mix nvel ${d} j adquirido`:`Comprar Mix de Produtos ${d}`,children:g?"J Adquirido":`Comprar ${d}`})]},d)})}),a.jsx("div",{style:wn.actions,children:a.jsx("button",{type:"button",style:{...wn.bigBtn,background:"#444",color:"#fff"},onClick:c,children:"No comprar"})})]})})}const wn={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(980px, 94vw)",background:"#1b1f2a",color:"#e9ecf1",borderRadius:16,padding:"20px",boxShadow:"0 10px 40px rgba(0,0,0,.4)",border:"1px solid rgba(255,255,255,.12)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},title:{margin:"6px 0 12px",fontWeight:900},note:{background:"#2a2f3b",border:"1px solid rgba(255,255,255,.15)",borderRadius:12,padding:"10px 12px",margin:"0 0 10px"},saldo:{margin:"0 0 10px",padding:"8px 12px",border:"1px dashed rgba(255,255,255,.25)",borderRadius:10},cards:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:12,marginTop:8},cardItem:{background:"#0f1320",border:"1px solid",borderRadius:14,padding:"12px",display:"flex",flexDirection:"column",gap:8},cardBadge:{width:"100%",height:6,borderRadius:999,opacity:.9},pill:{alignSelf:"flex-start",fontSize:12,fontWeight:900,padding:"4px 8px",borderRadius:999,color:"#111"},lines:{margin:0,padding:"0 0 0 16px",lineHeight:1.35},buyBtn:{marginTop:"auto",padding:"10px 12px",borderRadius:10,border:"none",fontWeight:900,cursor:"pointer",background:"#2442f9",color:"#fff"},actions:{display:"flex",gap:12,justifyContent:"center",marginTop:14},bigBtn:{minWidth:160,padding:"14px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer"}};function _b({onResolve:t,player:e={}}){const n=j.useRef(null),r=(f,m=0)=>Number.isFinite(Number(f))?Number(f):m,s=f=>r(f.am,0)>0,o=f=>r(f.az,0)>0,i=f=>{var w,_;const m=(f==null?void 0:f.certPurple)??((w=f==null?void 0:f.certs)==null?void 0:w.purple)??((_=f==null?void 0:f.certificates)==null?void 0:_.purple)??(f==null?void 0:f.cert_roxo)??(f==null?void 0:f.rox)??0;return m===!0||Number(m)>0},l=f=>{var w;const m=(f==null?void 0:f.mixLevel)??((w=f==null?void 0:f.mixProdutos)==null?void 0:w.level)??(f==null?void 0:f.mixProdutos)??(f==null?void 0:f.mix)??"D";return String(m||"D").toUpperCase()},u=f=>l(f)==="A",c=f=>String(f.erpLevel||f.erpSistemas||"D").toUpperCase()==="A",d=f=>{const m=String(f.mixProdutos||"D").toUpperCase();return m==="A"||m==="B"},h=f=>{var w;const m=_=>{if(!_)return 0;try{const A=Array.isArray(_)?_:Object.values(_);return new Set(A).size}catch{return 0}};return(w=f.trainingsByVendor)!=null&&w.gestor?m(f.trainingsByVendor.gestor):r(f.gestoresCertificados,0)},p=f=>r(f.vendedoresComuns)+r(f.insideSales)+r(f.fieldSales)+r(f.gestores??f.gestoresComerciais??f.managers),g=j.useMemo(()=>[{id:"gov_fgts",kind:"SORTE",title:"Ao Governamental Positiva",text:"Liberao de FGTS aumentou o poder de compra. Receba 5 novos clientes (se tiver equipe para atender).",clientsDelta:5},{id:"referral_bonus",kind:"SORTE",title:"Indicao Lucrativa",text:"Um cliente indicou amigos e a primeira compra foi tima. Receba R$ 800,00.",cashDelta:800},{id:"network_cert_mgr",kind:"SORTE",title:"Rede Estratgica",text:"Para cada gestor com certificado, receba R$ 5.000,00.",_compute:f=>({cashDelta:5e3*h(f)})},{id:"innovation_invest",kind:"SORTE",title:"Inovao Premiada",text:"Se tiver infraestrutura (mix/sistemas) nvel A ou B, receba aporte de R$ 25.000,00.",_compute:f=>({cashDelta:d(f)?25e3:0})},{id:"segmentation",kind:"SORTE",title:"Segmentao Inteligente",text:"Novo segmento lucrativo. Receba R$ 1.000,00.",cashDelta:1e3},{id:"casa_bonus_10k",kind:"SORTE",title:"Casagrande Insights",text:"Implementao bem-sucedida. Receba R$ 10.000,00.",cashDelta:1e4},{id:"casa_network_7k",kind:"SORTE",title:"Rede de Contatos Valiosa",text:"Parceria estratgica. Ganhe R$ 7.000,00.",cashDelta:7e3},{id:"casa_strategy_5k",kind:"SORTE",title:"Estratgia Personalizada",text:"Processos melhorados. Receba R$ 5.000,00.",cashDelta:5e3},{id:"casa_best_practices_8k",kind:"SORTE",title:"Melhores Prticas",text:"Eficincia aumentada. Receba R$ 8.000,00.",cashDelta:8e3},{id:"casa_start_6k",kind:"SORTE",title:"Satisfao do Cliente em Alta",text:"Fidelidade e vendas sobem. Receba R$ 6.000,00.",cashDelta:6e3},{id:"casa_change_cert_blue",kind:"SORTE",title:"Gesto de Mudanas Bem-sucedida",text:"Um vendedor generalista concluiu todos os treinamentos. Ganhe um certificado AZUL para esse vendedor.",_compute:()=>({certDelta:{az:1}})},{id:"training_roi_team",kind:"SORTE",title:"Treinamento Personalizado",text:"Receba R$ 500,00 por membro participante.",_compute:f=>({cashDelta:500*Math.max(0,p(f))})},{id:"purple_award_25k",kind:"SORTE",title:"Profissional do Ano (Roxo)",text:"Se houver pelo menos um colaborador com certificado roxo, receba R$ 25.000,00.",_compute:f=>({cashDelta:i(f)?25e3:0})},{id:"reputation_1500",kind:"SORTE",title:"Reputao Impecvel",text:"timas avaliaes elevam a confiana. Receba R$ 1.500,00.",cashDelta:1500},{id:"client_cheer_per_client",kind:"SORTE",title:"Cliente Promotor",text:"Ganhe R$ 500,00 por cada cliente atual.",_compute:f=>({cashDelta:500*Math.max(0,r(f.clients))})},{id:"big_order_freight_save",kind:"SORTE",title:"Grande Pedido + Frete Econmico",text:"Receba R$ 1.500,00.",cashDelta:1500},{id:"sales_win_2k",kind:"SORTE",title:"Vitria de Vendas",text:"Venda aguardada foi fechada. Receba R$ 2.000,00.",cashDelta:2e3},{id:"missed_admission",kind:"REVES",title:"Admisso No Reportada",text:"Multa governamental. Pague R$ 3.000,00.",cashDelta:-3e3},{id:"no_mix_a_pay_7000",kind:"REVES",title:"Mix A Ausente",text:"Se no tiver Mix nvel A, pague R$ 7.000,00.",_compute:f=>({cashDelta:u(f)?0:-7e3})},{id:"env_fine_20k",kind:"REVES",title:"Impacto Ambiental",text:"Multa ambiental. Pague R$ 20.000,00.",cashDelta:-2e4},{id:"key_client_at_risk",kind:"REVES",title:"Cliente Chave em Risco",text:"Sem certificado AMARELO: perca 1 cliente e pague R$ 2.000,00.",_compute:f=>s(f)?{clientsDelta:0,cashDelta:0,_overrideText:"Voc possui certificado amarelo. Nada acontece."}:{clientsDelta:-1,cashDelta:-2e3}},{id:"social_crisis",kind:"REVES",title:"Crise nas Redes",text:"Pague R$ 400,00 e perca 2 clientes.",cashDelta:-400,clientsDelta:-2},{id:"car_break",kind:"REVES",title:"Carro Quebrou",text:"Conserto urgente. Pague R$ 1.000,00.",cashDelta:-1e3},{id:"service_improvement_1k",kind:"REVES",title:"Aprimoramentos de Servio",text:"Pague R$ 1.000,00.",cashDelta:-1e3},{id:"recovery_failed_5k",kind:"REVES",title:"Recuperao Mal Sucedida",text:"Cancele grande pedido. Pague R$ 5.000,00.",cashDelta:-5e3},{id:"discount_pressure_1k",kind:"REVES",title:"Descontos Forados",text:"Presso por descontos reduziu sua margem. Pague R$ 1.000,00.",cashDelta:-1e3},{id:"domino_2k",kind:"REVES",title:"Efeito Domin",text:"Cancelamentos em cadeia. Perca R$ 2.000,00.",cashDelta:-2e3},{id:"needs_change_lose4",kind:"REVES",title:"Necessidades Mudaram",text:"Sem certificado AZUL: perca 4 clientes.",_compute:f=>o(f)?{clientsDelta:0,_overrideText:"Voc possui certificado azul. Nada acontece."}:{clientsDelta:-4}},{id:"payroll_error_1k",kind:"REVES",title:"Erro na Folha",text:"Corrigir problema. Pague R$ 1.000,00.",cashDelta:-1e3},{id:"strike_lose5",kind:"REVES",title:"Greve Inesperada",text:"Atrasos e perdas. Perca 5 clientes.",clientsDelta:-5},{id:"customs_hold_3k",kind:"REVES",title:"Alfndega",text:"Pague R$ 3.000,00.",cashDelta:-3e3},{id:"cyber_breach_7k_or_A",kind:"REVES",title:"Falha de Segurana",text:"Se NO tiver sistemas nvel A, pague R$ 7.000,00.",_compute:f=>({cashDelta:c(f)?0:-7e3})},{id:"supplier_issue_2k",kind:"REVES",title:"Fornecedor em Crise",text:"Expedio expressa. Pague R$ 2.000,00.",cashDelta:-2e3},{id:"reg_change_30k",kind:"REVES",title:"Regulamentao Nova",text:"Adequao de processos. Pague R$ 30.000,00.",cashDelta:-3e4},{id:"bad_mix_2500",kind:"REVES",title:"Mix de Produtos Desequilibrado",text:"Descontos e liquidaes. Pague R$ 2.500,00.",cashDelta:-2500},{id:"quality_crisis",kind:"REVES",title:"Crise de Qualidade",text:"Perca 1 cliente e pague R$ 1.000,00.",cashDelta:-1e3,clientsDelta:-1}],[]),[b]=j.useState(()=>g[Math.floor(Math.random()*g.length)]),x=j.useMemo(()=>{const f={action:"APPLY_CARD",kind:b.kind,id:b.id,title:b.title};if(typeof b._compute=="function"){const w=b._compute(e||{}),{_overrideText:_,...A}=w||{};return{text:_||b.text,payload:{...f,...A}}}const m={};return Number.isFinite(b.cashDelta)&&(m.cashDelta=Number(b.cashDelta)),Number.isFinite(b.clientsDelta)&&(m.clientsDelta=Number(b.clientsDelta)),{text:b.text,payload:{...f,...m}}},[b,e]),S=()=>t==null?void 0:t(x.payload),y=()=>t==null?void 0:t({action:"SKIP"});return j.useEffect(()=>{const f=document.body.style.overflow;return document.body.style.overflow="hidden",setTimeout(()=>{var m,w;return(w=(m=n.current)==null?void 0:m.focus)==null?void 0:w.call(m)},0),()=>{document.body.style.overflow=f}},[]),a.jsx("div",{style:Lr.wrap,role:"dialog","aria-modal":"true","aria-label":"Sorte e Revs",children:a.jsxs("div",{style:Lr.card,children:[a.jsx("button",{ref:n,style:Lr.close,onClick:y,"aria-label":"Fechar",children:""}),a.jsx("div",{style:Lr.badge(b.kind),children:b.kind==="SORTE"?"SORTE":"REVS"}),b.title&&a.jsx("h2",{style:Lr.title,children:b.title}),a.jsx("p",{style:Lr.text,children:x.text}),a.jsx("div",{style:Lr.footer,children:a.jsx("button",{type:"button",style:Lr.okBtn,onClick:S,children:"OK"})})]})})}const Lr={wrap:{position:"fixed",inset:0,background:"rgba(0,0,0,.55)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},card:{width:"min(760px, 92vw)",background:"#1b1f2a",color:"#e9ecf1",borderRadius:18,padding:"22px",border:"1px solid rgba(255,255,255,.12)",boxShadow:"0 10px 40px rgba(0,0,0,.4)",position:"relative"},close:{position:"absolute",right:10,top:10,width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"#2a2f3b",color:"#fff",cursor:"pointer"},badge:t=>({display:"inline-block",padding:"6px 12px",borderRadius:999,fontWeight:900,marginBottom:8,background:t==="SORTE"?"#22c55e":"#ef4444",color:"#111"}),title:{margin:"2px 0 6px",fontWeight:900},text:{fontSize:18,lineHeight:1.5,opacity:.95,margin:"6px 0 14px"},footer:{display:"flex",justifyContent:"center"},okBtn:{minWidth:140,padding:"12px 18px",borderRadius:12,border:"none",fontWeight:900,cursor:"pointer",background:"#fff",color:"#111"}};function kb({value:t=0,onResolve:e}){const n=Number(t||0),r=s=>{var o,i;(o=s==null?void 0:s.preventDefault)==null||o.call(s),(i=s==null?void 0:s.stopPropagation)==null||i.call(s),e==null||e({action:"OK",value:n,source:{modal:"FaturamentoMesModal",file:"src/modals/FaturamentoMesModal.jsx"}})};return a.jsx(wi,{zIndex:2147483647,onClose:()=>e==null?void 0:e({action:"CLOSE",value:n,source:{modal:"FaturamentoMesModal",file:"src/modals/FaturamentoMesModal.jsx"}}),children:a.jsxs("div",{style:{padding:28,textAlign:"center",pointerEvents:"auto"},children:[a.jsx("div",{style:{fontWeight:900,fontSize:28,color:"#4caf50",letterSpacing:.5,marginBottom:6},children:"FATURAMENTO DO MS"}),a.jsx("div",{style:{opacity:.9,marginBottom:16},children:"Ser creditado o valor do Faturamento ao seu Saldo"}),a.jsxs("div",{style:{fontSize:18,marginBottom:24},children:["no valor de: ",a.jsxs("b",{children:["$ ",n.toLocaleString()]})]}),a.jsx("button",{type:"button",onClick:r,className:"btn",style:{minWidth:120,background:"#8bd65a",color:"#1a1f2a",fontWeight:800,borderRadius:10},children:"OK"})]})})}function Eb({expense:t=0,loanCharge:e=0,onResolve:n}){const r=Number(t||0)+Number(e||0),s=o=>{var i,l;(i=o==null?void 0:o.preventDefault)==null||i.call(o),(l=o==null?void 0:o.stopPropagation)==null||l.call(o),n==null||n({action:"OK",expense:Number(t||0),loanCharge:Number(e||0),total:Number(r||0),source:{modal:"DespesasOperacionaisModal",file:"src/modals/DespesasOperacionaisModal.jsx"}})};return a.jsx(wi,{zIndex:2147483647,onClose:()=>n==null?void 0:n({action:"CLOSE",source:{modal:"DespesasOperacionaisModal",file:"src/modals/DespesasOperacionaisModal.jsx"}}),children:a.jsxs("div",{style:{padding:28,textAlign:"center",pointerEvents:"auto"},children:[a.jsx("div",{style:{fontWeight:900,fontSize:26,color:"#ffb74d",letterSpacing:.5,marginBottom:6},children:"DESPESAS DO MS"}),a.jsxs("div",{style:{marginBottom:8},children:["Despesas operacionais:",a.jsxs("b",{children:["-$ ",Number(t).toLocaleString()]})]}),Number(e)>0&&a.jsxs("div",{style:{marginBottom:8,color:"#ffd54f"},children:["Emprstimo cobrado nesta rodada:",a.jsxs("b",{children:["-$ ",Number(e).toLocaleString()]})]}),a.jsxs("div",{style:{margin:"6px 0 18px",opacity:.85},children:["Total a debitar: ",a.jsxs("b",{children:["-$ ",r.toLocaleString()]})]}),a.jsx("button",{type:"button",onClick:s,className:"btn",style:{minWidth:120,background:"#ffcc80",color:"#1a1f2a",fontWeight:800,borderRadius:10},children:"OK"})]})})}const Fe={backdrop:{position:"fixed",inset:0,background:"rgba(0,0,0,.6)",display:"grid",placeItems:"center",zIndex:9999},card:{width:"min(920px, 96vw)",maxHeight:"90vh",overflow:"auto",background:"#15161a",color:"#e9ecf1",border:"1px solid rgba(255,255,255,.08)",borderRadius:20,boxShadow:"0 20px 50px rgba(0,0,0,.5)"},header:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"14px 16px",borderBottom:"1px solid rgba(255,255,255,.08)"},closeBtn:{width:36,height:36,borderRadius:10,border:"1px solid rgba(255,255,255,.15)",background:"transparent",color:"#fff",fontSize:20,cursor:"pointer"},body:{padding:16},lead:{opacity:.95,lineHeight:1.5},bullets:{margin:"8px 0 16px 18px"},rowBtns:{display:"flex",gap:12,justifyContent:"flex-end",marginTop:12,flexWrap:"wrap"},cta:{padding:"12px 16px",border:0,borderRadius:12,color:"#fff",fontWeight:900,cursor:"pointer",boxShadow:"0 10px 24px rgba(0,0,0,.25)"},back:{padding:"10px 14px",borderRadius:12,border:"1px solid rgba(255,255,255,.15)",background:"transparent",color:"#e9ecf1",cursor:"pointer"},subHeader:{marginBottom:8},infoRow:{display:"flex",gap:8,alignItems:"baseline",margin:"4px 0"},input:{width:"100%",padding:"12px 12px",borderRadius:12,background:"#0f1115",color:"#fff",border:"1px solid rgba(255,255,255,.15)",marginTop:10},option:{padding:16,background:"rgba(255,255,255,.04)",border:"1px solid rgba(255,255,255,.08)",borderRadius:14,textAlign:"center",cursor:"pointer"},spin:{width:34,height:34,borderRadius:8,border:"1px solid rgba(255,255,255,.15)",background:"transparent",color:"#fff",fontSize:18,cursor:"pointer"}};function jb({playerName:t,loanAvailable:e,hasPendingLoan:n,onGoLoan:r,onGoReduce:s,onGoFire:o,onDeclareBankruptcy:i}){return a.jsxs("div",{style:Fe.body,children:[a.jsxs("p",{style:Fe.lead,children:["Voc est sem dinheiro, ",t,". Escolha uma das opes:"]}),n&&a.jsx("div",{style:{...Fe.lead,color:"#ef4444",fontWeight:"bold",marginBottom:"16px"},children:" Voc j possui um emprstimo pendente. Cada jogador s pode ter um emprstimo por vez."}),a.jsxs("ul",{style:Fe.bullets,children:[a.jsxs("li",{children:["Pedir ",a.jsx("b",{children:"emprstimo"})," nico com 50% de juros garantido por 50% dos seus ",a.jsx("b",{children:"BENS"})," (limite ",`$ ${e}`,")."]}),a.jsxs("li",{children:[a.jsx("b",{children:"Reduzir"})," nveis de ",a.jsx("b",{children:"MIX de Produtos"})," ou ",a.jsx("b",{children:"ERP/Sistemas"})," e receber 50% do valor pago."]}),a.jsxs("li",{children:[a.jsx("b",{children:"Demitir"})," funcionrios e receber 50% do valor total."]})]}),a.jsxs("div",{style:Fe.rowBtns,children:[a.jsx("button",{style:{...Fe.cta,background:"#ef4444"},onClick:o,children:"DEMITIR"}),a.jsx("button",{style:{...Fe.cta,background:"#a16207"},onClick:s,children:"REDUZIR"}),a.jsx("button",{style:{...Fe.cta,background:n?"#6b7280":"#16a34a",cursor:n?"not-allowed":"pointer"},onClick:n?void 0:r,disabled:n,children:n?"EMPRSTIMO (J REALIZADO)":"EMPRSTIMO"}),a.jsx("button",{style:{...Fe.cta,background:"#d32f2f",fontWeight:"bold"},onClick:i,children:"DECLARAR FALNCIA"})]})]})}function Cb({loanAvailable:t,alreadyHasLoan:e=!1,onBack:n,onConfirm:r}){const[s,o]=j.useState(""),i=j.useMemo(()=>Math.max(0,Math.floor(Number(s)||0)),[s]),l=!e&&i>0&&i<=Number(t||0),u=()=>{if(e){r==null||r({type:"LOAN_DENIED",reason:"ALREADY_TAKEN"});return}const c=Math.max(0,Math.floor(Number(t)||0)),d=Math.max(0,Math.min(c,i));if(d>0){const h={type:"LOAN",amount:d,cashDelta:d,loan:{amount:d,charged:!1}};console.log("[DEBUG] RecoveryLoan enviando payload:",h),r==null||r(h)}else r==null||r({type:"LOAN_DENIED",reason:"INVALID_AMOUNT"})};return a.jsxs("div",{style:Fe.body,children:[a.jsx("div",{style:Fe.subHeader,children:a.jsx("b",{style:{fontSize:20},children:"EMPRSTIMO"})}),a.jsxs("p",{children:["Voc pode realizar um emprstimo colocando ",a.jsx("b",{children:"50% dos seus BENS"})," como garantia (pago na prxima Despesas Operacionais)."]}),a.jsxs("div",{style:Fe.infoRow,children:[a.jsx("span",{children:"Valor disponvel:"})," ",a.jsxs("b",{children:["$",Number(t||0)]})]}),a.jsxs("div",{style:Fe.infoRow,children:[a.jsx("span",{children:"Valor garantia:"})," ",a.jsxs("b",{children:["$",Number(t||0)]})]}),e&&a.jsx("div",{style:{...Fe.infoRow,color:"#fca5a5",border:"1px solid rgba(255,0,0,.25)",padding:"8px 10px",borderRadius:8,background:"rgba(255,0,0,.06)"},children:"Voc j possui um emprstimo ativo. No  possvel pegar outro."}),a.jsx("input",{style:Fe.input,type:"number",min:0,max:Math.max(0,Number(t||0)),placeholder:"Digite o valor que quer emprestar",value:s,onChange:c=>o(c.target.value),disabled:e}),a.jsxs("div",{style:{fontSize:12,opacity:.8,marginTop:6},children:["Mx: $",Number(t||0),"  valor ser somado ao seu saldo e cobrado na prxima Despesas Operacionais."]}),a.jsxs("div",{style:Fe.rowBtns,children:[a.jsx("button",{style:Fe.back,onClick:n,children:" Voltar"}),a.jsx("button",{style:{...Fe.cta,background:"#16a34a",opacity:l?1:.6,cursor:l?"pointer":"not-allowed"},onClick:u,disabled:!l,children:"Pegar Emprstimo"})]})]})}function Rb(t){const{options:e=[],optionsMix:n,optionsErp:r,mixOwned:s,erpOwned:o,credits:i,snapshot:l,onBack:u,onConfirm:c}=t,d=(...v)=>console.log("[RecoveryReduce]",...v),h={MIX:{accent:"#06B6D4",soft:"rgba(6,182,212,.14)",ring:"rgba(6,182,212,.45)",glow:"rgba(6,182,212,.35)",pillBg:"rgba(6,182,212,.18)",pillFg:"#9FF1FF"},ERP:{accent:"#8B5CF6",soft:"rgba(139,92,246,.14)",ring:"rgba(139,92,246,.45)",glow:"rgba(139,92,246,.35)",pillBg:"rgba(139,92,246,.18)",pillFg:"#E9D5FF"}},p=["A","B","C","D"],g=(v,E,T)=>p.map($=>({key:`${v}-${$}`,group:v,level:$,label:`Nvel ${$}`,credit:Number((E==null?void 0:E[$])??0),owned:!!(T!=null&&T[$])})),b=j.useMemo(()=>Array.isArray(n)&&n.length?n:i!=null&&i.MIX?g("MIX",i.MIX,s):g("MIX",{A:0,B:0,C:0,D:0},s),[n,i,s]),x=j.useMemo(()=>Array.isArray(r)&&r.length?r:i!=null&&i.ERP?g("ERP",i.ERP,o):g("ERP",{A:0,B:0,C:0,D:0},o),[r,i,o]);j.useEffect(()=>{console.groupCollapsed("[RecoveryReduce] props snapshot"),console.log("mixCards:",b),console.log("erpCards:",x),console.log("mixOwned:",s),console.log("erpOwned:",o),console.log("credits:",i),console.groupEnd()},[b,x,s,o,i]);const[S,y]=j.useState([]),[f,m]=j.useState(new Set),[w,_]=j.useState(!1),A=v=>{v.level!=="D"&&(!v.owned||v.owned===!1||f.has(v.key)||v.alreadyReduced||y(E=>E.some($=>$.key===v.key)?E.filter($=>$.key!==v.key):[...E,v]))},D=j.useMemo(()=>S.reduce((v,E)=>v+Number(E.credit||0),0),[S]),k=v=>S.some(E=>E.key===v.key),R=v=>{var pe,Ee;const E=k(v),T=v.level==="D",$=v.owned===!0,U=T||!$||f.has(v.key)||v.alreadyReduced||w,V=h[v.group]||h.MIX,Je={...Fe.option,position:"relative",borderRadius:14,background:U?"rgba(148,163,184,.12)":V.soft,border:E?`2.5px solid ${V.accent}`:"1px solid rgba(148,163,184,.25)",boxShadow:E?`0 0 0 2px ${V.ring}, 0 10px 24px ${V.glow}`:"none",cursor:U?"not-allowed":"pointer",opacity:U?.35:1,transition:"transform .06s ease-out, box-shadow .12s ease-out, border-color .12s"},at={fontWeight:900,fontSize:16,marginBottom:8,color:U?"#CBD5E1":"#E5F9FF"},Q={fontWeight:700,marginTop:2,color:U?"#A1A1AA":"#FFFFFF"},F={position:"absolute",top:8,right:8,fontSize:11,padding:"3px 8px",borderRadius:999,background:U?"rgba(148,163,184,.22)":V.pillBg,color:U?"#E5E7EB":V.pillFg,border:`1px solid ${U?"rgba(148,163,184,.35)":V.ring}`,letterSpacing:.2};return a.jsxs("button",{onClick:()=>A(v),disabled:U,"aria-pressed":E,style:Je,title:T?"Nvel D  o bsico e no pode ser reduzido.":$?f.has(v.key)?"Nvel j reduzido nesta sesso.":v.alreadyReduced?"Este nvel j foi reduzido anteriormente. Compre o nvel novamente para poder reduzir.":"":"Este nvel no est disponvel. Compre o nvel novamente para poder reduzir.",onMouseDown:xe=>!U&&(xe.currentTarget.style.transform="translateY(1px)"),onMouseUp:xe=>xe.currentTarget.style.transform="translateY(0)",onMouseLeave:xe=>xe.currentTarget.style.transform="translateY(0)",children:[a.jsx("span",{style:F,children:T?"bsico":$?f.has(v.key)?"vendido":v.alreadyReduced?"j reduzido":"adquirido":"zerado"}),a.jsx("div",{style:at,children:v.label}),a.jsx("div",{style:{color:U?"#A1A1AA":"#BFEFFF"},children:"Crdito ao reduzir:"}),a.jsxs("div",{style:Q,children:["$",((Ee=(pe=v.credit).toLocaleString)==null?void 0:Ee.call(pe))??v.credit]})]},v.key)};return a.jsxs("div",{style:Fe.body,children:[a.jsx("div",{style:Fe.subHeader,children:a.jsx("b",{style:{fontSize:20},children:"REDUZIR NVEL MIX/ERP"})}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[a.jsxs("div",{style:{padding:8,borderRadius:8,background:"rgba(255,255,255,0.05)"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"MIX PRODUTOS"}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:12},children:b.map(R)})]}),a.jsxs("div",{style:{padding:8,borderRadius:8,background:"rgba(255,255,255,0.05)"},children:[a.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"ERP/SISTEMAS"}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, minmax(0,1fr))",gap:12},children:x.map(R)})]})]}),a.jsxs("div",{style:{marginTop:10,display:"flex",justifyContent:"space-between",alignItems:"center",opacity:.92},children:[a.jsxs("div",{children:["Selecionados: ",a.jsx("b",{children:S.length}),"    Total: ",a.jsxs("b",{children:["$",D.toLocaleString()]})]}),a.jsx("div",{style:{fontSize:12,opacity:.7},children:"S  possvel selecionar nveis adquiridos."})]}),a.jsxs("div",{style:Fe.rowBtns,children:[a.jsx("button",{style:Fe.back,onClick:u,disabled:w,children:" Voltar"}),a.jsx("button",{style:{...Fe.cta,background:"#F59E0B",color:"#101010",fontWeight:900,opacity:S.length&&!w?1:.55},onClick:()=>{if(!S.length||w)return;_(!0),m(E=>{const T=new Set(E);return S.forEach($=>T.add($.key)),T});const v={items:S.map(E=>({...E,selected:!0})),total:D};d("confirm payload =>",v),c==null||c(v),y([]),_(!1)},disabled:!S.length||w,children:"REDUZIR"})]})]})}function Nb({roles:t=[],onBack:e,onConfirm:n}){const r=j.useMemo(()=>t.map(p=>{const g=Number(p.unit??p.total??0),b=Number(p.owned??p.qty??0);return{...p,unit:g,owned:b}}),[t]),[s,o]=j.useState(()=>{const p={};return r.forEach(g=>{p[g.key]=0}),p}),i=p=>`R$ ${Number(p||0).toLocaleString("pt-BR")}`,l=p=>Math.floor(Number(p||0)*.5),u=(p,g)=>{o(b=>{const x=r.find(f=>f.key===p);if(!x)return b;const S=Number(b[p]||0),y=Math.max(0,Math.min(x.owned,S+g));return y===S?b:{...b,[p]:y}})},c=j.useMemo(()=>{const p={};return r.forEach(g=>{const b=Number(s[g.key]||0);p[g.key]=l(g.unit)*b}),p},[s,r]),d=j.useMemo(()=>Object.values(c).reduce((p,g)=>p+g,0),[c]),h=()=>{if(d<=0)return;const p={};r.forEach(g=>{p[g.key]=Number(s[g.key]||0)}),n==null||n({type:"FIRE",items:p,creditByRole:c,totalCredit:d,amount:d,note:`Demisses +${i(d)}`})};return a.jsxs("div",{style:Fe.body,children:[a.jsx("div",{style:Fe.subHeader,children:a.jsx("b",{style:{fontSize:20},children:"DEMITIR FUNCIONRIOS"})}),a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1.2fr 1fr 1.2fr 1fr",gap:8,opacity:.9,fontWeight:700,marginBottom:6},children:[a.jsx("div",{children:"Cargo"}),a.jsx("div",{children:"Valor Unitrio"}),a.jsx("div",{children:"Qtd demitir"}),a.jsx("div",{children:"Crdito"})]}),a.jsx("div",{style:{display:"grid",gap:12},children:r.map(p=>{const g=Number(s[p.key]||0),b=Number(p.unit||0),x=Number(p.owned||0),S=l(b),y=S*g,f=g<=0,m=g>=x||x<=0;return a.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1.2fr 1fr 1.2fr 1fr",alignItems:"center",gap:8},children:[a.jsxs("div",{children:[a.jsx("div",{style:{fontWeight:800},children:p.label}),a.jsxs("div",{style:{opacity:.75,fontSize:12},children:["Possui: ",a.jsx("b",{children:x})]})]}),a.jsxs("div",{children:[a.jsx("div",{children:a.jsx("b",{children:i(b)})}),a.jsxs("div",{style:{opacity:.75,fontSize:12},children:["Crdito por un.: ",a.jsx("b",{children:i(S)})]})]}),a.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center"},children:[a.jsx("button",{style:{...Fe.spin,opacity:f?.5:1,cursor:f?"not-allowed":"pointer"},disabled:f,onClick:()=>u(p.key,-1),children:"-"}),a.jsx("div",{style:{minWidth:28,textAlign:"center",fontWeight:800},children:g}),a.jsx("button",{style:{...Fe.spin,opacity:m?.5:1,cursor:m?"not-allowed":"pointer"},disabled:m,onClick:()=>u(p.key,1),children:"+"})]}),a.jsx("div",{children:a.jsx("b",{children:i(y)})})]},p.key)})}),a.jsxs("div",{style:{marginTop:12,textAlign:"right",fontWeight:900},children:["Total a resgatar: ",a.jsx("b",{children:i(d)})]}),a.jsxs("div",{style:Fe.rowBtns,children:[a.jsx("button",{style:Fe.back,onClick:e,children:" Voltar"}),a.jsx("button",{style:{...Fe.cta,background:"#ef4444",opacity:d>0?1:.6},onClick:h,disabled:d<=0,children:"DEMITIR"})]})]})}function qf({playerName:t="Jogador",bens:e=0,currentPlayer:n,canClose:r=!0}){var R;const{resolveTop:s,popModal:o}=(hn==null?void 0:hn())||{},[i,l]=j.useState("menu"),u=()=>{r&&(o?o(!1):s==null||s(null))},c=j.useMemo(()=>({A:12e3,B:6e3,C:3e3,D:1e3}),[]),d=j.useMemo(()=>({A:1e4,B:4e3,C:1500,D:500}),[]),h=v=>{if(v==null)return"";const E=String(v).trim().toUpperCase();if(["A","B","C","D"].includes(E))return E;const T=Number(E);return T===1?"A":T===2?"B":T===3?"C":T===4?"D":""},p=j.useMemo(()=>{const v=n||{};return{name:v.name??t,bens:Number(v.bens??e??0),vendedoresComuns:Number(v.vendedoresComuns??0),fieldSales:Number(v.fieldSales??0),insideSales:Number(v.insideSales??0),gestores:Number(v.gestores??v.gestoresComerciais??0),raw:v}},[n,t,e]);j.useEffect(()=>{console.group("[RecoveryModal] mount snapshot"),console.log("raw player =>",p.raw),console.groupEnd()},[p.raw]);const g=j.useMemo(()=>Math.max(0,Math.floor(p.bens*.5)),[p.bens]),b=j.useMemo(()=>{var E;const v=(E=p.raw)==null?void 0:E.loanPending;return v&&Number(v.amount)>0},[(R=p.raw)==null?void 0:R.loanPending]),x=j.useMemo(()=>[{key:"mix",label:"MIX PRODUTOS",credit:1500},{key:"erp",label:"ERP/SISTEMAS",credit:1500}],[]),S=j.useMemo(()=>[{key:"comum",label:"Vendedor Comum",unit:1500,owned:p.vendedoresComuns},{key:"field",label:"Field Sales",unit:3e3,owned:p.fieldSales},{key:"inside",label:"Inside Sales",unit:3e3,owned:p.insideSales},{key:"gestor",label:"Gestor",unit:5e3,owned:p.gestores}],[p]),y=j.useMemo(()=>{const v=p.raw||{};return h(v.mixProdutosLetter??v.mixProdutos??v.mixProducts??v.mixLevelLetter??v.mixLevel??v.mix_level??v.mix??v.mix_produtos??v.mix_products)},[p.raw]),f=j.useMemo(()=>{var E;const v=p.raw||{};return h(v.erpSistemasLetter??v.erpSistemas??((E=v.erpSystems)==null?void 0:E.level)??v.erpSystemsLetter??v.erpLevelLetter??v.erpLevel??v.erp_level??v.erp??v.erp_sistemas)},[p.raw]),m=j.useMemo(()=>{const v=p.raw||{},E=v.mixOwned??v.mix??{},T=new Set;return typeof E=="object"&&!Array.isArray(E)&&E!==null&&(E.A===!0&&T.add("A"),E.B===!0&&T.add("B"),E.C===!0&&T.add("C"),E.D===!0&&T.add("D")),T.size===0&&y&&(T.add("D"),y==="A"?(T.add("A"),T.add("B"),T.add("C")):y==="B"?(T.add("B"),T.add("C")):y==="C"&&T.add("C")),T.size===0&&T.add("D"),T},[p.raw,y]),w=j.useMemo(()=>{const v=p.raw||{},E=v.erpOwned??v.erp??{},T=new Set;return typeof E=="object"&&!Array.isArray(E)&&E!==null&&(E.A===!0&&T.add("A"),E.B===!0&&T.add("B"),E.C===!0&&T.add("C"),E.D===!0&&T.add("D")),T.size===0&&f&&(T.add("D"),f==="A"?(T.add("A"),T.add("B"),T.add("C")):f==="B"?(T.add("B"),T.add("C")):f==="C"&&T.add("C")),T.size===0&&T.add("D"),T},[p.raw,f]);j.useEffect(()=>{console.group("[RecoveryModal] owned detect"),console.log("mixLetter(panel):",y," -> ownedMix =",Object.fromEntries(["A","B","C","D"].map(v=>[v,m.has(v)]))),console.log("erpLetter(panel):",f," -> ownedErp =",Object.fromEntries(["A","B","C","D"].map(v=>[v,w.has(v)]))),console.groupEnd()},[y,f,m,w]);const _=j.useMemo(()=>{var E,T;const v=p.raw||{};return{MIX:Array.isArray((E=v.reducedLevels)==null?void 0:E.MIX)?v.reducedLevels.MIX:[],ERP:Array.isArray((T=v.reducedLevels)==null?void 0:T.ERP)?v.reducedLevels.ERP:[]}},[p.raw]),A=j.useMemo(()=>["A","B","C","D"].map(v=>({key:`mix-${v}`,group:"MIX",level:v,label:`Nvel ${v}`,credit:(c[v]||0)/2,owned:m.has(v),alreadyReduced:_.MIX.includes(v)})),[m,c,_.MIX]),D=j.useMemo(()=>["A","B","C","D"].map(v=>({key:`erp-${v}`,group:"ERP",level:v,label:`Nvel ${v}`,credit:(d[v]||0)/2,owned:w.has(v),alreadyReduced:_.ERP.includes(v)})),[w,d,_.ERP]),k=j.useMemo(()=>({MIX:{A:c.A/2,B:c.B/2,C:c.C/2,D:c.D/2},ERP:{A:d.A/2,B:d.B/2,C:d.C/2,D:d.D/2}}),[c,d]);return a.jsx("div",{style:Fe.backdrop,children:a.jsxs("div",{style:Fe.card,children:[a.jsxs("div",{style:Fe.header,children:[a.jsx("div",{style:{fontWeight:900,fontSize:22},children:"RECUPERAO FINANCEIRA"}),r&&a.jsx("button",{onClick:u,style:Fe.closeBtn,children:""})]}),i==="menu"&&a.jsx(jb,{playerName:p.name,loanAvailable:g,hasPendingLoan:b,onGoLoan:()=>l("loan"),onGoReduce:()=>l("reduce"),onGoFire:()=>l("fire"),onDeclareBankruptcy:()=>s==null?void 0:s({type:"TRIGGER_BANKRUPTCY",source:{modal:"RecoveryModal",file:"src/modals/RecoveryModal.jsx"}})}),i==="loan"&&a.jsx(Cb,{loanAvailable:g,onBack:()=>l("menu"),onConfirm:v=>{console.log("[DEBUG] RecoveryModal recebeu payload do RecoveryLoan:",v),console.log("[DEBUG] RecoveryModal chamando resolveTop com:",v);const E=s==null?void 0:s({...v||{},source:{modal:"RecoveryModal",file:"src/modals/RecoveryModal.jsx"}});console.log("[DEBUG] RecoveryModal resolveTop retornou:",E)}}),i==="reduce"&&a.jsx(Rb,{options:x,optionsMix:A,optionsErp:D,mixOwned:{A:m.has("A"),B:m.has("B"),C:m.has("C"),D:m.has("D")},erpOwned:{A:w.has("A"),B:w.has("B"),C:w.has("C"),D:w.has("D")},credits:k,snapshot:p,onBack:()=>l("menu"),onConfirm:v=>{if(Array.isArray(v==null?void 0:v.items)){const $=Number(v.total??v.items.filter(U=>U.selected).reduce((U,V)=>U+Number(V.credit||0),0));s==null||s({type:"REDUCE",amount:$,items:v.items,note:`Reduo mltipla +R$ ${$.toLocaleString()}`,source:{modal:"RecoveryModal",file:"src/modals/RecoveryModal.jsx"}});return}const E=Number((v==null?void 0:v.credit)||(v==null?void 0:v.amount)||0),T=v&&v.group&&v.level?{group:String(v.group).toUpperCase(),level:String(v.level).toUpperCase(),credit:E}:null;s==null||s({type:"REDUCE",amount:E,group:T==null?void 0:T.group,level:T==null?void 0:T.level,selection:T,note:T?`Reduo ${T.group} nvel ${T.level} +R$ ${E.toLocaleString()}`:`Reduo +R$ ${E.toLocaleString()}`,source:{modal:"RecoveryModal",file:"src/modals/RecoveryModal.jsx"}})}}),i==="fire"&&a.jsx(Nb,{roles:S,onBack:()=>l("menu"),onConfirm:v=>s==null?void 0:s({...v||{},source:{modal:"RecoveryModal",file:"src/modals/RecoveryModal.jsx"}})})]},i)})}function Db({playerName:t="Jogador",balanceText:e=""}){const{resolveTop:n,closeModal:r}=hn(),s=j.useRef(null);j.useEffect(()=>{var c;const u=document.body.style.overflow;return document.body.style.overflow="hidden",(c=s.current)==null||c.focus(),()=>{document.body.style.overflow=u}},[]),j.useEffect(()=>{const u=c=>{(c.key==="Escape"||c.key==="Enter"||c.key===" ")&&(c.preventDefault(),c.stopPropagation())};return document.addEventListener("keydown",u,!0),()=>document.removeEventListener("keydown",u,!0)},[]);const o=u=>{u.preventDefault(),u.stopPropagation()},i=()=>{n(!1),r==null||r()},l=()=>{n(!0),r==null||r()};return a.jsxs(wi,{width:780,onClose:i,children:[a.jsx("style",{children:`
        .sg-modal-panel {
          background:#111827; border:1px solid rgba(255,255,255,0.08);
          border-radius:16px; padding:20px 22px 18px; color:#e5e7eb;
          position:relative; box-shadow:0 10px 35px rgba(0,0,0,.55);
        }
        .sg-modal-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
        .sg-modal-title{font-size:22px;font-weight:700;margin:0}
        .sg-icon-close{background:transparent;border:0;color:#9ca3af;font-size:24px;line-height:1;cursor:pointer}
        .sg-icon-close:hover{color:#e5e7eb}

        .sg-modal-infos{display:flex;justify-content:space-between;align-items:center;
          font-size:14px;color:#cbd5e1;margin:6px 0 12px}
        .sg-modal-infos .right{opacity:.8}

        .sg-callout-warning{
          background:rgba(250,204,21,.12); border:1px solid rgba(250,204,21,.45);
          border-radius:12px; padding:14px 16px; margin-bottom:14px
        }
        .sg-callout-title{font-weight:700;margin-bottom:6px;color:#fde68a}
        .sg-muted{opacity:.7}

        .sg-modal-body{margin:8px 2px 14px;font-size:15px;line-height:1.5}

        .sg-modal-actions{display:flex;justify-content:space-between;gap:12px;margin-top:10px}
        .sg-btn{font-weight:600;border:0;cursor:pointer;padding:12px 18px}
        .sg-pill{border-radius:999px}
        .sg-btn-neutral{background:#374151;color:#e5e7eb}
        .sg-btn-neutral:hover{background:#4b5563}
        .sg-btn-danger{background:#b91c1c;color:#fff}
        .sg-btn-danger:hover{background:#991b1b}
        .sg-btn:focus{outline:2px solid rgba(255,255,255,.35);outline-offset:2px}
      `}),a.jsxs("div",{className:"sg-modal-panel",role:"dialog","aria-modal":"true","aria-labelledby":"bk-title","aria-describedby":"bk-desc",onClick:o,onMouseDown:o,onKeyDown:o,children:[a.jsxs("div",{className:"sg-modal-header",children:[a.jsx("h2",{id:"bk-title",className:"sg-modal-title",children:"Declarar Falncia"}),a.jsx("button",{className:"sg-icon-close","aria-label":"Fechar",onClick:i,children:""})]}),a.jsxs("div",{className:"sg-modal-infos",children:[a.jsx("div",{className:"left",children:e?a.jsxs(a.Fragment,{children:["Saldo disponvel: ",a.jsx("b",{children:e})]}):a.jsx(a.Fragment,{children:""})}),a.jsx("div",{className:"right",children:"Ao permanente nesta partida"})]}),a.jsxs("div",{className:"sg-callout-warning",id:"bk-desc",children:[a.jsx("div",{className:"sg-callout-title",children:"Ateno"}),a.jsxs("p",{children:[t,", ao confirmar, voc ser marcado como ",a.jsx("b",{children:"FALIDO"}),". Seu turno ser ",a.jsx("b",{children:"sempre pulado"})," e voc no poder mais executar aes."]}),a.jsx("p",{className:"sg-muted",children:"Esta deciso  irreversvel at o fim da partida."})]}),a.jsx("div",{className:"sg-modal-body",children:a.jsxs("p",{children:["Confirme abaixo para encerrar sua participao ativa. Voc continuar visvel no placar como ",a.jsx("b",{children:"FALIDO"}),"."]})}),a.jsxs("div",{className:"sg-modal-actions",children:[a.jsx("button",{className:"sg-btn sg-pill sg-btn-neutral",onClick:i,children:"Cancelar"}),a.jsx("button",{ref:s,className:"sg-btn sg-pill sg-btn-danger",onClick:l,children:"Declarar Falncia"})]})]})]})}function Ab({traceId:t="unknown",actionType:e="UNKNOWN",reason:n="UNKNOWN_CASH_CHANGE",origin:r={},context:s={}}={}){return{traceId:t||"unknown",actionType:e||"UNKNOWN",reason:n||"UNKNOWN_CASH_CHANGE",origin:{file:r.file,fn:r.fn,modal:r.modal,component:r.component},context:{round:s.round,pos:s.pos,tile:s.tile,debt:s.debt,loanPending:s.loanPending,opsExpense:s.opsExpense,revenue:s.revenue}}}const An=5;function Ob({players:t,setPlayers:e,round:n,setRound:r,turnIdx:s,setTurnIdx:o,turnPlayerId:i,setTurnPlayerId:l,roundFlags:u,setRoundFlags:c,isMyTurn:d,isMine:h,myUid:p,meId:g,myCash:b,current:x,broadcastState:S,appendLog:y,turnLock:f,setTurnLockBroadcast:m,gameOver:w,setGameOver:_,winner:A,setWinner:D,setShowBankruptOverlay:k}){const{pushModal:R,awaitTop:v,closeTop:E}=(hn==null?void 0:hn())||{},[T,$]=ce.useState(0),U=ce.useRef(0);ce.useEffect(()=>{U.current=T},[T]);const V=ce.useRef(!1),Je=ce.useRef(!1),at=ce.useRef(Promise.resolve()),Q=ce.useCallback(Y=>{const je=async()=>{Je.current=!0;try{return await Y()}finally{Je.current=!1}},Re=at.current.then(je,je);return at.current=Re.catch(W=>{console.error("[DEBUG] actionQueue error:",W)}),Re},[]),F=ce.useRef(!1),pe=ce.useRef(null),Ee=ce.useRef(null),xe=ce.useRef(null),Ye=ce.useRef(null),Ft=ce.useRef(Promise.resolve()),Tt=ce.useCallback(Y=>{if(!Array.isArray(Y)||Y.length===0)return Y;const je=[...Y].filter(Boolean);let W=je.every(Oe=>Number.isInteger(Oe.seat))?je.sort((Oe,we)=>Oe.seat-we.seat):je.sort((Oe,we)=>String((Oe==null?void 0:Oe.id)??(Oe==null?void 0:Oe.player_id)??"").localeCompare(String((we==null?void 0:we.id)??(we==null?void 0:we.player_id)??""))),Qe=0;const ne=new Set(W.filter(Oe=>Number.isInteger(Oe.seat)).map(Oe=>Oe.seat));return W=W.map(Oe=>{if(Number.isInteger(Oe.seat))return Oe;for(;ne.has(Qe);)Qe++;return ne.add(Qe),{...Oe,seat:Qe++}}),W=W.sort((Oe,we)=>Oe.seat-we.seat),W},[]),zt=ce.useMemo(()=>Tt(t),[t,Tt]),rr=ce.useCallback((Y,je)=>(Y||[]).findIndex(Re=>String(Re==null?void 0:Re.id)===String(je)),[]),Ct=ce.useCallback((Y,je)=>(Y||[]).find(Re=>String(Re==null?void 0:Re.id)===String(je)),[]),te=ce.useCallback((Y,je,Re)=>(Y||[]).map(W=>String(W==null?void 0:W.id)===String(je)?Re(W):W),[]);ce.useEffect(()=>{d?console.log("[DEBUG] modalLocks sync - isMyTurn:",d,"modalLocks:",T):T>0&&(console.log("[DEBUG] modalLocks sync - resetando modalLocks para 0 (no  minha vez)"),$(0),U.current=0,V.current=!1)},[d,T]),ce.useEffect(()=>(f?(xe.current&&clearTimeout(xe.current),xe.current=setTimeout(()=>{const Y=ae.current,je=String(Y||"")===String(p),Re=U.current,W=V.current;console.warn("[DEBUG]  TIMEOUT DE SEGURANA - turnLock ativo h mais de 30s",{isLockOwner:je,currentModalLocks:Re,currentOpening:W,lockOwner:Y}),(je&&Re===0&&!W||Y==null&&Re===0&&!W)&&(console.warn("[DEBUG]  FORANDO LIBERAO DO TURNLOCK (timeout de segurana)",{isLockOwner:je,lockOwner:Y,modalLocks:Re,opening:W}),m(!1),F.current=!1)},3e4)):xe.current&&(clearTimeout(xe.current),xe.current=null),()=>{xe.current&&(clearTimeout(xe.current),xe.current=null)}),[f,p,m]);const[Rn,gn]=ce.useState(null),ae=ce.useRef(null);ce.useEffect(()=>{ae.current=Rn},[Rn]);const Qt=ce.useRef(null),he=ce.useRef(n);ce.useEffect(()=>{he.current=n,console.log("[DEBUG]  currentRoundRef atualizado para:",n)},[n]);const tt=ce.useRef(t);ce.useEffect(()=>{tt.current=t},[t]);const Xt=ce.useRef(s);ce.useEffect(()=>{Xt.current=s},[s]);const Dr=ce.useRef(w);ce.useEffect(()=>{Dr.current=w},[w]);const sr=ce.useRef(!1),ss=ce.useRef(!1);ce.useEffect(()=>{const Y=t[s];Y&&String(Y.id)===String(p)?Qt.current&&(Qt.current.nextTurnIdx===s?(console.log("[DEBUG] Limpando pendingTurnDataRef - turno j foi processado (nextTurnIdx === turnIdx)"),Qt.current=null):console.log("[DEBUG] Mantendo pendingTurnDataRef - prximo turno:",Qt.current.nextTurnIdx,"turno atual:",s)):Qt.current&&Qt.current.nextTurnIdx!==s&&(console.log("[DEBUG] Limpando pendingTurnDataRef - no  minha vez e dados no so para turno atual"),Qt.current=null)},[s,t,p]);const Pe=ce.useCallback(Y=>{if(!R||!v)return Promise.resolve(null);const je=async()=>{let W=!1;try{V.current=!0,$(Oe=>{const we=Oe+1;return U.current=we,Ye.current=null,console.log("[DEBUG] openModalAndWait - ABRINDO modal, modalLocks:",Oe,"->",we,"openingModalRef:",V.current),we}),R(Y),await new Promise(Oe=>setTimeout(Oe,100)),V.current=!1,console.log("[DEBUG] openModalAndWait - Modal renderizada, openingModalRef:",V.current);const Qe=new Promise((Oe,we)=>setTimeout(()=>we(new Error("Modal timeout")),15e3)),ne=await Promise.race([v(),Qe]);return W=!0,await new Promise(Oe=>setTimeout(Oe,50)),ne??null}catch(Qe){if(console.error("[DEBUG] openModalAndWait - erro aguardando modal:",Qe),Qe.message==="Modal timeout"){console.warn("[WARN] modal timeout -> auto-close");try{E==null||E({action:"SKIP"})}catch{}}return W=!0,null}finally{V.current=!1,W&&$(Qe=>{const ne=Math.max(0,Qe-1);return U.current=ne,ne===0&&(Ye.current=Date.now(),console.log("[DEBUG] openModalAndWait - LTIMA MODAL FECHADA - timestamp:",Ye.current)),console.log("[DEBUG] openModalAndWait - FECHANDO modal, modalLocks:",Qe,"->",ne),ne})}},Re=Ft.current.then(je,je);return Ft.current=Re.catch(()=>{}),Re},[R,v,E]),os=ce.useCallback((Y,je)=>{const Re=t[Y],W=Math.max(0,Number(je||0));return Number((Re==null?void 0:Re.cash)||0)>=W},[t]),Rt=ce.useCallback((Y,je,Re)=>{const W=os(Y,je);return W||y(`Saldo insuficiente${Re?" para "+Re:""}. Use RECUPERAO (demitir / emprestar / reduzir) ou declare FALNCIA.`),W},[os,y]),vo=ce.useCallback((Y,je,Re)=>{var Oe;if(je<=An)return{finished:!1,winner:null,finalRound:je};const W=(Y||[]).filter(we=>!(we!=null&&we.bankrupt));if(W.length===0)return console.log("[DEBUG]  FIM DE JOGO - Nenhum jogador vivo restante"),{finished:!0,winner:null,finalRound:An};const ne=((Oe=W.map(we=>({player:we,patrimonio:(we.cash||0)+(we.bens||0),cash:we.cash||0})).sort((we,Wt)=>{var Nn,or;return Wt.patrimonio-we.patrimonio||Wt.cash-we.cash||String(((Nn=we.player)==null?void 0:Nn.name)||"").localeCompare(String(((or=Wt.player)==null?void 0:or.name)||""))})[0])==null?void 0:Oe.player)||null;return console.log("[ENDGAME] finalizando: vencedor=",(ne==null?void 0:ne.name)||"N/A",", round=",An),{finished:!0,winner:ne,finalRound:An}},[]),xo=ce.useCallback((Y,je,Re)=>{if(console.log("[DEBUG]  advanceAndMaybeLap chamada - steps:",Y,"deltaCash:",je,"note:",Re),!(Dr.current||sr.current||ss.current||!t.length)){if(F.current){console.warn("[DEBUG]  advanceAndMaybeLap - mudana de turno j em progresso, ignorando");return}if(U.current>0||V.current){if(console.warn("[DEBUG]  advanceAndMaybeLap - h modais abertas, aguardando...",{modalLocks:U.current,opening:V.current}),Ee.current={steps:Y,deltaCash:je,note:Re},pe.current)return;pe.current=setTimeout(()=>{pe.current=null;const W=Ee.current;Ee.current=null,W&&U.current===0&&!V.current&&xo(W.steps,W.deltaCash,W.note)},200);return}F.current=!0,m(!0,String(p)),gn(String(p));try{const W=s,Qe=zt[W];if(!Qe){m(!1),F.current=!1;return}const ne=String(Qe.id);console.log("[DEBUG]  POSIO INICIAL - Jogador:",Qe.name,"Posio:",Qe.pos,"Saldo:",Qe.cash);const Oe=async(O,z,Z,H=t)=>{var J,ve,Ve,gt,ht,Ae,Dt,Ie,on,At;const _e=Ct(H,ne)||{},ye=Number((_e==null?void 0:_e.cash)||0);if(ye>=O){console.log("[DEBUG]  Saldo suficiente! Processando pagamento de:",O);const Se=Tt(H).map(Ne=>String(Ne.id)!==ne?Ne:{...Ne,cash:Math.max(0,(Ne.cash||0)-O),pos:Ne.pos});return e(Se),S(Se,s,he.current),!0}V.current=!0;const K=await Pe(a.jsx(Rr,{requiredAmount:O,currentCash:ye,title:`Saldo insuficiente para ${Z} ${z}`,message:`Voc precisa ${Z} R$ ${O.toLocaleString()} mas possui apenas R$ ${ye.toLocaleString()}.`,showRecoveryOptions:!0}));if(!K)return m(!1),!1;if(K.action==="RECOVERY"){console.log("[DEBUG] Abrindo RecoveryModal para jogador:",_e);const Se=await Pe(a.jsx(qf,{currentPlayer:_e,canClose:!1}));if(console.log("[DEBUG] RecoveryModal retornou:",Se),Se){console.log("[DEBUG] recoveryModalRes existe, tipo:",Se.type,"action:",Se.action);let Ne=H;if(Se.type==="FIRE"){console.log("[DEBUG]  Condio FIRE atendida! Processando demisses:",Se);const it={cashDelta:Number(Se.amount||0),vendedoresComunsDelta:-Number(((J=Se.items)==null?void 0:J.comum)||0),fieldSalesDelta:-Number(((ve=Se.items)==null?void 0:ve.field)||0),insideSalesDelta:-Number(((Ve=Se.items)==null?void 0:Ve.inside)||0),gestoresDelta:-Number(((gt=Se.items)==null?void 0:gt.gestor)||0)};console.log("[DEBUG] Deltas de demisso:",it),Ne=te(H,ne,et=>({...Vt(et,it),pos:et.pos})),console.log("[DEBUG] Novo saldo aps demisses:",(ht=Ct(Ne,ne))==null?void 0:ht.cash),e(Ne),S(Ne,s,he.current)}else if(Se.type==="LOAN"){console.log("[DEBUG]  Condio LOAN atendida! Processando emprstimo:",Se);const it=(Ct(H,ne)||{}).loanPending;if(it&&Number(it.amount)>0){console.log("[DEBUG]  Jogador j possui emprstimo pendente:",it);const ut=await Pe(a.jsx(Rr,{requiredAmount:O,currentCash:Number((Ct(H,ne)||{}).cash||0),title:"Emprstimo j realizado",message:`Voc j possui um emprstimo pendente de R$ ${Number(it.amount).toLocaleString()}. Cada jogador s pode ter um emprstimo por vez.`,showRecoveryOptions:!1,canClose:!1}));if(!ut||ut.action!=="BANKRUPT")return m(!1),!1;const I=te(H,ne,Ue=>({...Ue,bankrupt:!0}));if(Ho(I)<=1){const Ue=I.findIndex(yt=>!(yt!=null&&yt.bankrupt));return D(Ue>=0?I[Ue]:null),e(I),_(!0),m(!1),S(I,s,n,!0,Ue>=0?I[Ue]:null),!1}const fe=rr(I,ne),ke=No(I,fe>=0?fe:W),$e=I[ke],Ce=$e!=null&&$e.id?String($e.id):null;return e(I),o(ke),l&&l(Ce),m(!1),S(I,ke,he.current,!1,null,{turnPlayerId:Ce}),!1}const et=Number(Se.amount||0);console.log("[DEBUG] Valor do emprstimo:",et),console.log("[DEBUG] Saldo atual do jogador:",Number((Ct(H,ne)||{}).cash||0)),Ne=te(H,ne,ut=>({...ut,cash:(Number(ut.cash)||0)+et,loanPending:{amount:et,charged:!1,shouldChargeOnNextExpenses:!0},pos:ut.pos})),console.log("[DEBUG] Novo saldo do jogador:",(Ae=Ct(Ne,ne))==null?void 0:Ae.cash),console.log("[DEBUG] Novo loanPending:",(Dt=Ct(Ne,ne))==null?void 0:Dt.loanPending),e(Ne),S(Ne,s,he.current)}else if(Se.type==="REDUCE"){console.log("[DEBUG]  Condio REDUCE atendida! Processando reduo:",Se);const it=Se.items||[];let et=0;console.log("[DEBUG] Selees para reduzir:",it);const ut=I=>(I==null?void 0:I.A)===!0?"A":(I==null?void 0:I.B)===!0?"B":(I==null?void 0:I.C)===!0?"C":"D";Ne=te(H,ne,I=>{let de={...I},fe={A:!1,B:!1,C:!1,D:!1,...de.mixOwned||de.mix||{}},ke={A:!1,B:!1,C:!1,D:!1,...de.erpOwned||de.erp||{}};const $e=String(de.mixProdutos||"D").toUpperCase(),Ce=String(de.erpLevel||de.erpSistemas||"D").toUpperCase();!fe.A&&!fe.B&&!fe.C&&!fe.D&&$e&&($e==="A"?fe={A:!0,B:!0,C:!0,D:!0}:$e==="B"?fe={A:!1,B:!0,C:!0,D:!0}:$e==="C"?fe={A:!1,B:!1,C:!0,D:!0}:fe={A:!1,B:!1,C:!1,D:!0}),!ke.A&&!ke.B&&!ke.C&&!ke.D&&Ce&&(Ce==="A"?ke={A:!0,B:!0,C:!0,D:!0}:Ce==="B"?ke={A:!1,B:!0,C:!0,D:!0}:Ce==="C"?ke={A:!1,B:!1,C:!0,D:!0}:ke={A:!1,B:!1,C:!1,D:!0});let Ue=$e,yt=Ce;for(const Or of it)if(Or.selected){if(et+=Number(Or.credit||0),Or.group==="MIX"){if(fe[Or.level]=!1,Or.level===Ue){const is=["A","B","C","D"],al=is.indexOf(Ue);for(let as=al+1;as<is.length;as++){const ls=is[as];if(fe[ls]||ls==="D"){Ue=ls;break}}}}else if(Or.group==="ERP"&&(ke[Or.level]=!1,Or.level===yt)){const is=["A","B","C","D"],al=is.indexOf(yt);for(let as=al+1;as<is.length;as++){const ls=is[as];if(ke[ls]||ls==="D"){yt=ls;break}}}}const an=ut(fe)||Ue||"D",_i=ut(ke)||yt||"D";return de.mixOwned=fe,de.mix=fe,de.erpOwned=ke,de.erp=ke,de.mixProdutos=an,de.erpLevel=_i,de.erpSistemas=_i,de.mixLevel=an,de.mixProducts=an,de.mixLevelLetter=an,de.erpLevelLetter=_i,de.cash=(Number(de.cash)||0)+et,de.pos=I.pos,console.log("[DEBUG] Reduo aplicada - mixProdutos:",an,"erpLevel:",_i,"crdito:",et),de}),console.log("[DEBUG] Total de crdito da reduo:",et),console.log("[DEBUG] Novo saldo aps reduo:",(Ie=Ct(Ne,ne))==null?void 0:Ie.cash),console.log("[DEBUG] Novo mixProdutos:",(on=Ct(Ne,ne))==null?void 0:on.mixProdutos,"Novo erpLevel:",(At=Ct(Ne,ne))==null?void 0:At.erpLevel),e(Ne),S(Ne,s,he.current)}else console.log("[DEBUG]  Nenhuma condio foi atendida! Tipo:",Se.type,"Action:",Se.action);const vn=Number((Ct(Ne,ne)||{}).cash||0);if(console.log("[DEBUG] Verificando saldo aps recuperao - Novo saldo:",vn,"Necessrio:",O),vn>=O){console.log("[DEBUG]  Saldo suficiente aps recuperao! Processando pagamento de:",O);const it=te(Ne,ne,et=>({...et,cash:Math.max(0,(et.cash||0)-O),pos:et.pos}));return console.log("[DEBUG]  PAGAMENTO - Saldo antes:",Number((Ct(Ne,ne)||{}).cash||0),"Valor a pagar:",O,"Saldo aps:",Number((Ct(it,ne)||{}).cash||0)),e(it),S(it,s,he.current),!0}else return console.log("[DEBUG]  Saldo ainda insuficiente aps recuperao. Continuando recurso..."),await Oe(O,z,Z,Ne)}else return m(!1),!1}else if(K.action==="BANKRUPT"){const Se=te(H,ne,I=>({...I,bankrupt:!0}));if(Ho(Se)<=1){const I=Se.findIndex(de=>!(de!=null&&de.bankrupt));return D(I>=0?Se[I]:null),e(Se),_(!0),m(!1),S(Se,s,n,!0,I>=0?Se[I]:null),!1}const vn=rr(Se,ne),it=No(Se,vn>=0?vn:W),et=Se[it],ut=et!=null&&et.id?String(et.id):null;return e(Se),o(it),l&&l(ut),m(!1),S(Se,it,he.current,!1,null,{turnPlayerId:ut}),!1}else return m(!1),!1},we=Qe.pos,Wt=(we+Y)%vs,Nn=Wt<we,or=Nn&&we>=vs-1;console.log("[DEBUG]  MOVIMENTO - De posio:",we,"Para posio:",Wt,"Steps:",Y,"Lap:",Nn,"CompletedLap:",or);const ee=Gl(we,Wt,0)||Nn,le=he.current,C=t.filter(O=>!(O!=null&&O.bankrupt)).length,N=Tt(t).map(O=>{if(String(O.id)!==ne)return O;const z=(O.cash||0)+(je||0),Z=Number(O.lastRevenueRound)||0,H=O.waitingAtRevenue===!0;let _e=Z,ye=le===An?H:!1,K=ye?0:Wt;return ee&&(_e=Math.max(Z,le),le===An&&C>1&&(ye=!0,K=0)),{...O,pos:K,cash:Math.max(0,z),lastRevenueRound:_e,waitingAtRevenue:ye}}),L=N.find(O=>String(O.id)===ne);console.log("[DEBUG]  APS MOVIMENTO - Jogador:",L==null?void 0:L.name,"Posio:",L==null?void 0:L.pos,"Saldo:",L==null?void 0:L.cash,"lastRevenueRound:",L==null?void 0:L.lastRevenueRound,"waitingAtRevenue:",L==null?void 0:L.waitingAtRevenue);let q=he.current,P=[...u],B=!1,ge=!1;if(Nn){console.log("[DEBUG]  VOLTA COMPLETA DETECTADA (lap=true) - Jogador completou uma volta completa!",{jogador:Qe.name,posicaoAnterior:we,posicaoNova:Wt,rodadaAtual:he.current}),P.length<t.length&&(P=[...P,...new Array(t.length-P.length).fill(!1)]);const O=zt.findIndex(z=>String(z.id)===ne);O>=0&&(P[O]=!0),console.log("[DEBUG]  Flag marcada por volta completa (lap) - Flags:",P.map((z,Z)=>{var H;return`${(H=zt[Z])==null?void 0:H.name}:${z}`}).join(", "))}if(ee){P.length<t.length&&(P=[...P,...new Array(t.length-P.length).fill(!1)]);const O=zt.findIndex(K=>String(K.id)===ne);O>=0&&(P[O]?console.log("[DEBUG]  Jogador j tinha flag marcada (por lap) - Flags:",P.map((K,J)=>{var ve;return`${(ve=zt[J])==null?void 0:ve.name}:${K}`}).join(", ")):(P[O]=!0,console.log("[DEBUG]  Jogador passou pela casa 0 (crossedStart1ForRound) - Flags:",P.map((K,J)=>{var ve;return`${(ve=zt[J])==null?void 0:ve.name}:${K}`}).join(", "))));const z=N.filter(K=>!(K!=null&&K.bankrupt)),Z=N.map((K,J)=>K!=null&&K.bankrupt?-1:J).filter(K=>K>=0),H=N.filter(K=>!(K!=null&&K.bankrupt)),_e=H.length>0&&H.every(K=>(Number(K.lastRevenueRound)||0)>=le);console.log("[DEBUG]  Verificando allAliveDone - Rodada atual:",le,"Jogadores vivos:",H.map(K=>({name:K.name,lastRevenueRound:K.lastRevenueRound})));const ye=N.find(K=>String(K.id)===ne);if(console.log("[DEBUG]  Verificao de rodada - Jogador:",ye==null?void 0:ye.name,"Rodada atual:",le,"round do closure:",n),console.log("[DEBUG]  Jogadores vivos:",Z.map(K=>{const J=N[K],ve=zt.findIndex(Ve=>String(Ve.id)===String(J==null?void 0:J.id));return`${J==null?void 0:J.name}:${ve>=0?P[ve]:!1}`}).join(", ")),console.log("[DEBUG]  Total de jogadores vivos:",Z.length),console.log("[DEBUG]  Flags completas:",P.map((K,J)=>{var ve;return`${(ve=N[J])==null?void 0:ve.name}:${K?"":""}`}).join(", ")),console.log("[DEBUG]  Todos passaram pela casa 0?",_e),_e)le<An?(q=le+1,B=!0):ge=!0,B?(P=P.map((K,J)=>{var ve;return(ve=N[J])!=null&&ve.bankrupt?P[J]:!1}),console.log("[DEBUG]  RODADA INCREMENTADA - Nova rodada:",q,"Rodada anterior:",le,"Jogadores vivos:",H.length),console.log("[DEBUG]  Flags resetadas:",P.map((K,J)=>{var ve;return`${(ve=N[J])==null?void 0:ve.name}:${K}`}).join(", ")),y(` Rodada ${q} iniciada! Todos os jogadores vivos passaram pela casa de faturamento.`)):ge&&console.log("[DEBUG]  FIM DE JOGO - Rodada 5 completa, todos os jogadores vivos chegaram!");else{const K=H.filter(J=>(Number(J.lastRevenueRound)||0)<le).map(J=>J.name);console.log("[DEBUG]  Rodada NO incrementada - ainda faltam jogadores completarem o ms:",K.join(", "))}}c(P),console.log("[DEBUG] roundFlags updated / round closed:",P.map((O,z)=>{var Z;return`${(Z=N[z])==null?void 0:Z.name}:${O}`}).join(", "));let M=No(N,W);if(he.current===5){let O=0;for(;O<N.length;){const z=N[M];if(!z.bankrupt&&z.waitingAtRevenue!==!0)break;M=(M+1)%N.length,O++}}je&&y(`${Qe.name} ${je>0?"ganhou":"pagou"} $${Math.abs(je).toLocaleString()}`),Re&&y(Re),e(N,{source:"ROLL"}),S(N,s,he.current,Dr.current,winnerRef.current,{kind:"PLAYER_DELTA"}),r(O=>{const z=Math.min(An,q),Z=Math.min(An,Math.max(O,z));return B&&Z>O&&(console.log("[ROUND] allAliveDone=true -> round",O,"->",Z),y(` Rodada ${Z} iniciada! Todos os jogadores vivos passaram pela casa de faturamento.`)),Z!==O&&console.log("[ROUND]",O,"->",Z),he.current=Z,Z});const oe=q,St=P,Xe=N[M],se=Xe!=null&&Xe.id?String(Xe.id):null;Qt.current={nextPlayers:N,nextTurnIdx:M,nextTurnPlayerId:se,nextRound:oe,nextRoundFlags:St,timestamp:Date.now(),shouldIncrementRound:B,endGame:ge},console.log("[DEBUG]  pendingTurnDataRef preenchido - prximo turno:",M,"rodada atual:",n,"prxima rodada:",oe,"nextRound calculado:",q,"shouldIncrementRound:",B,"rodada foi incrementada?",q>n,"roundFlags:",St.map((O,z)=>{var Z;return`${(Z=N[z])==null?void 0:Z.name}:${O}`}).join(", "));const re=Wt+1,be=Gl(we,Wt,0),Ze=Gl(we,Wt,22);let Ke=!1;(re===6||re===16||re===32||re===49)&&d&&R&&v&&(Ke=!0,V.current=!0,(async()=>{var _e,ye,K,J,ve;const O=((_e=t[W])==null?void 0:_e.erpLevel)||null,z=((ye=t[W])==null?void 0:ye.erpOwned)||((K=t[W])==null?void 0:K.erp)||{},Z=await Pe(a.jsx(Mf,{currentCash:((J=N[W])==null?void 0:J.cash)??b,currentLevel:O,erpOwned:z}));if(!Z||Z.action!=="BUY")return;const H=Number(((ve=Z.values)==null?void 0:ve.compra)||0);if(!Rt(W,H,"comprar ERP")){m(!1);return}e(Ve=>{const gt=te(Ve,ne,ht=>Vt(ht,{cashDelta:-H,erpLevelSet:Z.level}));return S(gt,s,he.current),gt})})()),(re===2||re===11||re===19||re===47)&&d&&R&&v&&(V.current=!0,(async()=>{var H,_e,ye,K;const O=t.find(h)||N[W],z=await Pe(a.jsx(Bf,{canTrain:{comum:Number(O==null?void 0:O.vendedoresComuns)||0,field:Number(O==null?void 0:O.fieldSales)||0,inside:Number(O==null?void 0:O.insideSales)||0,gestor:Number((O==null?void 0:O.gestores)??(O==null?void 0:O.gestoresComerciais)??(O==null?void 0:O.managers))||0},ownedByType:{comum:((H=O==null?void 0:O.trainingsByVendor)==null?void 0:H.comum)||[],field:((_e=O==null?void 0:O.trainingsByVendor)==null?void 0:_e.field)||[],inside:((ye=O==null?void 0:O.trainingsByVendor)==null?void 0:ye.inside)||[],gestor:((K=O==null?void 0:O.trainingsByVendor)==null?void 0:K.gestor)||[]}}));if(!z||z.action!=="BUY")return;const Z=Number(z.grandTotal||0);if(!Rt(W,Z,"comprar Treinamento")){m(!1);return}e(J=>{const ve=te(J,ne,Ve=>Pf(Ve,z));return S(ve,s,he.current),ve})})()),(re===5||re===10||re===43)&&d&&R&&v&&(V.current=!0,(async()=>{var Z,H,_e,ye,K,J,ve,Ve,gt,ht,Ae,Dt,Ie,on,At,Se,Ne,vn,it,et;const O=((Z=N[W])==null?void 0:Z.cash)??b,z=await Pe(a.jsx(Sb,{currentCash:O}));if(z){if(z.action==="OPEN"){const ut=String(z.open||"").toUpperCase();if(ut==="MIX"){const I=((H=t[W])==null?void 0:H.mixProdutos)||null,de=((_e=t[W])==null?void 0:_e.mixOwned)||((ye=t[W])==null?void 0:ye.mix)||{},fe=await Pe(a.jsx(Gf,{currentCash:((K=N[W])==null?void 0:K.cash)??b,currentLevel:I,mixOwned:de}));if(fe&&fe.action==="BUY"){const ke=Number(fe.compra||0),$e=String(fe.level||"D");if(!Rt(W,ke,"comprar MIX")){m(!1);return}const Ce=Math.max(0,- -ke);e(Ue=>{const yt=te(Ue,ne,an=>Vt(an,{cashDelta:-ke,bensDelta:Ce,mixProdutosSet:$e,mixBaseSet:{despesaPorCliente:Number(fe.despesa||0),faturamentoPorCliente:Number(fe.faturamento||0)}}));return S(yt,s,he.current),yt})}return}if(ut==="MANAGER"){const I=await Pe(a.jsx(zf,{currentCash:((J=N[W])==null?void 0:J.cash)??b}));if(I&&(I.action==="BUY"||I.action==="HIRE")){const de=Number(I.headcount??I.qty??I.managersQty??1),fe=Number(typeof I.cashDelta<"u"?I.cashDelta:-Number(I.cost??I.total??I.totalHire??0)),ke=fe<0?-fe:0;if(ke>0&&!Rt(W,ke,"contratar Gestor")){m(!1);return}const $e=Number(I.expenseDelta??I.totalExpense??I.maintenanceDelta??0);e(Ce=>{const Ue=te(Ce,ne,yt=>Vt(yt,{cashDelta:fe,gestoresDelta:de,manutencaoDelta:$e}));return S(Ue,s,he.current),Ue})}return}if(ut==="INSIDE"){const I=await Pe(a.jsx(Uf,{currentCash:((ve=N[W])==null?void 0:ve.cash)??b}));if(I&&(I.action==="BUY"||I.action==="HIRE")){const de=Number(I.cost??I.total??0);if(!Rt(W,de,"contratar Inside Sales")){m(!1);return}const fe=Number(I.headcount??I.qty??1);e(ke=>{const $e=te(ke,ne,Ce=>Vt(Ce,{cashDelta:-de,insideSalesDelta:fe}));return S($e,s,he.current),$e})}return}if(ut==="FIELD"){const I=await Pe(a.jsx(Wf,{currentCash:((Ve=N[W])==null?void 0:Ve.cash)??b}));if(I&&(I.action==="HIRE"||I.action==="BUY")){const de=Number(I.headcount??I.qty??1),fe={cashDelta:Number(I.cashDelta??-Number(I.totalHire??I.total??I.cost??0)),manutencaoDelta:Number(I.expenseDelta??I.totalExpense??0),revenueDelta:Number(I.revenueDelta??0),fieldSalesDelta:de},ke=fe.cashDelta<0?-fe.cashDelta:0;if(ke>0&&!Rt(W,ke,"contratar Field Sales")){m(!1);return}e($e=>{const Ce=te($e,ne,Ue=>Vt(Ue,fe));return S(Ce,s,he.current),Ce})}return}if(ut==="COMMON"){const I=await Pe(a.jsx(Vf,{currentCash:((gt=N[W])==null?void 0:gt.cash)??b}));if(I&&I.action==="BUY"){const de=Number(I.headcount??I.qty??0),fe={cashDelta:Number(I.cashDelta??-Number(I.totalHire??I.total??I.cost??0)),vendedoresComunsDelta:de,manutencaoDelta:Number(I.expenseDelta??I.totalExpense??0),revenueDelta:Number(I.revenueDelta??0)},ke=fe.cashDelta<0?-fe.cashDelta:0;if(ke>0&&!Rt(W,ke,"contratar Vendedores Comuns")){m(!1);return}e($e=>{const Ce=te($e,ne,Ue=>Vt(Ue,fe));return S(Ce,s,he.current),Ce})}return}if(ut==="ERP"){const I=((ht=t[W])==null?void 0:ht.erpLevel)||null,de=((Ae=t[W])==null?void 0:Ae.erpOwned)||((Dt=t[W])==null?void 0:Dt.erp)||{},fe=await Pe(a.jsx(Mf,{currentCash:((Ie=N[W])==null?void 0:Ie.cash)??b,currentLevel:I,erpOwned:de}));if(fe&&fe.action==="BUY"){const ke=Number(((on=fe.values)==null?void 0:on.compra)||0);if(!Rt(W,ke,"comprar ERP")){m(!1);return}e($e=>{const Ce=te($e,ne,Ue=>Vt(Ue,{cashDelta:-ke,erpLevelSet:fe.level}));return S(Ce,s,he.current),Ce})}return}if(ut==="CLIENTS"){const I=Number(((At=N.find(fe=>String(fe.id)===ne))==null?void 0:At.cash)??b),de=await Pe(a.jsx(Ff,{currentCash:I}));if(de&&de.action==="BUY"){const fe=Number(de.totalCost||0);if(I<fe){y("Saldo insuficiente para comprar Clientes."),m(!1);return}const ke=Number(de.qty||0),$e=Number(de.maintenanceDelta||0),Ce=Number(de.bensDelta||fe);e(Ue=>{const yt=Ue.map(an=>String(an.id)!==ne?an:Vt(an,{cashDelta:-fe,clientsDelta:ke,manutencaoDelta:$e,bensDelta:Ce}));return S(yt,s,he.current),yt})}return}if(ut==="TRAINING"){const I=t.find(h)||N[W],de=await Pe(a.jsx(Bf,{canTrain:{comum:Number(I==null?void 0:I.vendedoresComuns)||0,field:Number(I==null?void 0:I.fieldSales)||0,inside:Number(I==null?void 0:I.insideSales)||0,gestor:Number((I==null?void 0:I.gestores)??(I==null?void 0:I.gestoresComerciais)??(I==null?void 0:I.managers))||0},ownedByType:{comum:((Se=I==null?void 0:I.trainingsByVendor)==null?void 0:Se.comum)||[],field:((Ne=I==null?void 0:I.trainingsByVendor)==null?void 0:Ne.field)||[],inside:((vn=I==null?void 0:I.trainingsByVendor)==null?void 0:vn.inside)||[],gestor:((it=I==null?void 0:I.trainingsByVendor)==null?void 0:it.gestor)||[]}}));if(de&&de.action==="BUY"){const fe=Number(de.grandTotal||0);if(!Rt(W,fe,"comprar Treinamento")){m(!1);return}e(ke=>{const $e=te(ke,ne,Ce=>Pf(Ce,de));return S($e,s,he.current),$e})}return}}if(z.action==="BUY"){if(z.kind==="CLIENTS"||z.modal==="CLIENTS"||typeof z.clientsQty<"u"||typeof z.numClients<"u"||typeof z.totalCost<"u"||typeof z.maintenanceDelta<"u"){const de=Number(z.totalCost??z.total??z.amount??0);if(Number(((et=N.find(Ue=>String(Ue.id)===ne))==null?void 0:et.cash)??b)<de){y("Saldo insuficiente para comprar Clientes."),m(!1);return}const ke=Number(z.clientsQty??z.numClients??z.qty??0),$e=Number(z.maintenanceDelta??z.maintenance??z.mexp??0),Ce=Number(z.bensDelta??de);e(Ue=>{const yt=Ue.map(an=>String(an.id)!==ne?an:Vt(an,{cashDelta:-de,clientsDelta:ke,manutencaoDelta:$e,bensDelta:Ce}));return S(yt,s,he.current),yt});return}const I=Number(z.total??z.amount??0);if(!Rt(W,I,"esta compra")){m(!1);return}e(de=>{const fe=de.map((ke,$e)=>$e!==W?ke:Vt(ke,{cashDelta:-I,directBuysPush:[z.item||{total:I}]}));return S(fe,s,he.current),fe})}}})()),(re===12||re===21||re===30||re===42||re===53)&&d&&R&&v&&(V.current=!0,(async()=>{var H;const O=await Pe(a.jsx(Uf,{currentCash:((H=N[W])==null?void 0:H.cash)??b}));if(!O||O.action!=="HIRE"&&O.action!=="BUY")return;const z=Number(O.cost??O.total??0);if(!Rt(W,z,"contratar Inside Sales")){m(!1);return}const Z=Number(O.headcount??O.qty??1);e(_e=>{const ye=te(_e,ne,K=>Vt(K,{cashDelta:-z,insideSalesDelta:Z}));return S(ye,s,he.current),ye})})()),[4,8,15,17,20,27,34,36,39,46,52,55].includes(re)&&d&&R&&v&&(V.current=!0,(async()=>{var K;const O=Number(((K=N.find(J=>String(J.id)===ne))==null?void 0:K.cash)??b),z=await Pe(a.jsx(Ff,{currentCash:O}));if(!z||z.action!=="BUY")return;const Z=Number(z.totalCost||0);if(O<Z){y("Saldo insuficiente para comprar Clientes."),m(!1);return}const H=Number(z.qty||0),_e=Number(z.maintenanceDelta||0),ye=Number(z.bensDelta||Z);e(J=>{const ve=J.map(Ve=>String(Ve.id)!==ne?Ve:Vt(Ve,{cashDelta:-Z,clientsDelta:H,manutencaoDelta:_e,bensDelta:ye}));return S(ve,s,he.current),ve})})()),[18,24,29,51].includes(re)&&d&&R&&v&&(V.current=!0,(async()=>{var ye;const O=await Pe(a.jsx(zf,{currentCash:((ye=N[W])==null?void 0:ye.cash)??b}));if(!O||O.action!=="BUY"&&O.action!=="HIRE")return;const z=Number(O.headcount??O.qty??O.managersQty??1),Z=Number(typeof O.cashDelta<"u"?O.cashDelta:-Number(O.cost??O.total??O.totalHire??0)),H=Z<0?-Z:0;if(H>0&&!Rt(W,H,"contratar Gestor")){m(!1);return}const _e=Number(O.expenseDelta??O.totalExpense??O.maintenanceDelta??0);e(K=>{const J=te(K,ne,ve=>Vt(ve,{cashDelta:Z,gestoresDelta:z,manutencaoDelta:_e}));return S(J,s,he.current),J})})()),[13,25,33,38,50].includes(re)&&d&&R&&v&&(V.current=!0,(async()=>{var z;const O=await Pe(a.jsx(Wf,{currentCash:((z=N[W])==null?void 0:z.cash)??b}));if(O&&(O.action==="HIRE"||O.action==="BUY")){const Z=Number(O.headcount??O.qty??1),H={cashDelta:Number(O.cashDelta??-Number(O.totalHire??O.total??O.cost??0)),manutencaoDelta:Number(O.expenseDelta??O.totalExpense??0),revenueDelta:Number(O.revenueDelta??0),fieldSalesDelta:Z},_e=H.cashDelta<0?-H.cashDelta:0;if(_e>0&&!Rt(W,_e,"contratar Field Sales")){m(!1);return}e(ye=>{const K=te(ye,ne,J=>Vt(J,H));return S(K,s,he.current),K})}})()),[9,28,40,45].includes(re)&&d&&R&&v&&(V.current=!0,(async()=>{var _e;const O=await Pe(a.jsx(Vf,{currentCash:((_e=N[W])==null?void 0:_e.cash)??b}));if(!O||O.action!=="BUY")return;const z=Number(O.headcount??O.qty??0),Z={cashDelta:Number(O.cashDelta??-Number(O.totalHire??O.total??O.cost??0)),vendedoresComunsDelta:z,manutencaoDelta:Number(O.expenseDelta??O.totalExpense??0),revenueDelta:Number(O.revenueDelta??0)},H=Z.cashDelta<0?-Z.cashDelta:0;if(H>0&&!Rt(W,H,"contratar Vendedores Comuns")){m(!1);return}e(ye=>{const K=te(ye,ne,J=>Vt(J,Z));return S(K,s,he.current),K})})()),[7,31,44].includes(re)&&d&&R&&v&&(V.current=!0,(async()=>{var K,J,ve,Ve;const O=((K=t[W])==null?void 0:K.mixProdutos)||null,z=((J=t[W])==null?void 0:J.mixOwned)||((ve=t[W])==null?void 0:ve.mix)||{},Z=await Pe(a.jsx(Gf,{currentCash:((Ve=N[W])==null?void 0:Ve.cash)??b,currentLevel:O,mixOwned:z}));if(!Z||Z.action!=="BUY")return;const H=Number(Z.compra||0);if(!Rt(W,H,"comprar MIX")){m(!1);return}const _e=String(Z.level||"D"),ye=Math.max(0,H);e(gt=>{const ht=gt.map((Ae,Dt)=>Dt!==W?Ae:Vt(Ae,{cashDelta:-H,bensDelta:ye,mixProdutosSet:_e,mixBaseSet:{despesaPorCliente:Number(Z.despesa||0),faturamentoPorCliente:Number(Z.faturamento||0)}}));return S(ht,s,he.current),ht})})());const ft=[3,14,22,26,35,41,48,54].includes(re);if(d&&!!R&&!!v&&(be||Ze||ft)){const O=Qt.current;O._once=O._once||{};const z=(H,_e,ye)=>{const K=(_e-H+ye)%ye;return K===0?ye:K},Z=[];be&&!O._once.faturamento&&(O._once.faturamento=!0,Z.push({type:"REVENUE",at:z(we,0,vs)})),Ze&&!O._once.expenses23&&(O._once.expenses23=!0,Z.push({type:"EXPENSES",at:z(we,22,vs)})),ft&&!O._once.luck&&(O._once.luck=!0,Z.push({type:"LUCK",at:Y})),Z.sort((H,_e)=>H.at-_e.at),Q(async()=>{let H=Array.isArray(tt.current)?tt.current:N;for(const _e of Z){const ye=Ct(H,ne)||{};if(!(ye!=null&&ye.id))break;if(_e.type==="REVENUE"){V.current=!0;const K=Math.max(0,Math.floor(ol(ye)));await Pe(a.jsx(kb,{value:K})),H=te(H,ne,J=>({...J,cash:(Number(J.cash)||0)+K})),e(H),S(H,Xt.current,he.current),y(`${ye.name} recebeu faturamento do ms: +$${K.toLocaleString()}`);continue}if(_e.type==="EXPENSES"){V.current=!0;const K=Math.max(0,Math.floor(il(ye))),J=ye.loanPending||{},ve=Number(J.amount)>0&&!J.charged&&J.shouldChargeOnNextExpenses===!0,Ve=ve?Math.max(0,Math.floor(Number(J.amount))):0;await Pe(a.jsx(Eb,{expense:K,loanCharge:Ve}));const gt=K+Ve;if(!await Oe(gt,"Despesas Operacionais","pagar",H))return;H=Array.isArray(tt.current)?tt.current:H,ve&&(H=te(H,ne,Ae=>({...Ae,loanPending:{...Ae.loanPending||{},charged:!0,chargedAtRound:he.current,shouldChargeOnNextExpenses:!1}})),e(H),S(H,Xt.current,he.current)),y(`${ye.name} pagou despesas operacionais: -$${K.toLocaleString()}`),Ve>0&&y(`${ye.name} teve emprstimo cobrado: -$${Ve.toLocaleString()}`);continue}if(_e.type==="LUCK"){V.current=!0;const K=Ct(Array.isArray(tt.current)?tt.current:H,ne)||Ct(H,ne)||ye,J=await Pe(a.jsx(_b,{player:K}));if(!J||J.action!=="APPLY_CARD")continue;let ve=Number.isFinite(J.cashDelta)?Number(J.cashDelta):0;const Ve=Number.isFinite(J.clientsDelta)?Number(J.clientsDelta):0;if(ve<0){if(!await Oe(Math.abs(ve),"Sorte & Revs","pagar",H))return;ve=0,H=Array.isArray(tt.current)?tt.current:H}if(H=te(H,ne,ht=>{var Dt;let Ae={...ht};if(ve&&(Ae.cash=Math.max(0,(Number(Ae.cash)||0)+ve)),Ve&&(Ae.clients=Math.max(0,(Number(Ae.clients)||0)+Ve)),J.gainSpecialCell&&(Ae.fieldSales=(Ae.fieldSales||0)+(J.gainSpecialCell.fieldSales||0),Ae.support=(Ae.support||0)+(J.gainSpecialCell.support||0),Ae.gestores=(Ae.gestores||0)+(J.gainSpecialCell.manager||0),Ae.gestoresComerciais=(Ae.gestoresComerciais||0)+(J.gainSpecialCell.manager||0),Ae.managers=(Ae.managers||0)+(J.gainSpecialCell.manager||0)),J.id==="casa_change_cert_blue"){Ae.az=(Ae.az||0)+1;const Ie=new Set(((Dt=Ae.trainingsByVendor)==null?void 0:Dt.comum)||[]);Ie.add("personalizado"),Ae.trainingsByVendor={...Ae.trainingsByVendor||{},comum:Array.from(Ie)}}return Ae}),e(H),S(H,Xt.current,he.current),J.perClientBonus||J.perCertifiedManagerBonus||J.mixLevelBonusABOnly){const ht=Ct(H,ne)||{};let Ae=0;if(J.perClientBonus&&(Ae+=(Number(ht.clients)||0)*Number(J.perClientBonus||0)),J.perCertifiedManagerBonus&&(Ae+=ib(ht)*Number(J.perCertifiedManagerBonus||0)),J.mixLevelBonusABOnly){const Dt=String(ht.mixProdutos||"").toUpperCase();(Dt==="A"||Dt==="B")&&(Ae+=Number(J.mixLevelBonusABOnly||0))}Ae&&(H=te(H,ne,Dt=>({...Dt,cash:(Number(Dt.cash)||0)+Ae})),e(H),S(H,Xt.current,he.current))}}}})}const Dn=Date.now();let Zt=0;const Ar=200,qn=()=>{var J,ve,Ve;if(Zt++,Zt>Ar){console.warn("[DEBUG]  TIMEOUT - excedeu tentativas mximas, forando desbloqueio");const gt=ae.current;String(gt||"")===String(p)&&(m(!1),F.current=!1,U.current>0&&(console.warn("[DEBUG]  Forando modalLocks para 0 (timeout)"),U.current=0,$(0)),V.current=!1);return}const O=U.current,z=V.current||Je.current,Z=ae.current,H=String(Z||"")===String(p);if(console.log("[DEBUG] tick - tentativa:",Zt,"modalLocks:",O,"openingModalRef:",z,"lockOwner:",Z,"myUid:",p,"isLockOwner:",H),z){console.log("[DEBUG]  tick - modal est sendo aberta, aguardando..."),setTimeout(qn,150);return}const _e=Ye.current?Date.now()-Ye.current:1/0;if(O===0&&(_e>=200||!Ye.current)){const gt=Qt.current;if(!!(gt!=null&&gt.endGame||sr.current)&&!ss.current){ss.current=!0,sr.current=!1;const Ie=Array.isArray(tt.current)?tt.current:(gt==null?void 0:gt.nextPlayers)||[],on=(Ie||[]).filter(Se=>!(Se!=null&&Se.bankrupt));let At=null;on.length>0&&(At=((J=on.map(Ne=>({p:Ne,patrimonio:(Number(Ne.cash)||0)+(Number(Ne.bens)||0),cash:Number(Ne.cash)||0})).sort((Ne,vn)=>{var it,et;return vn.patrimonio-Ne.patrimonio||vn.cash-Ne.cash||String(((it=Ne.p)==null?void 0:it.name)||"").localeCompare(String(((et=vn.p)==null?void 0:et.name)||""))})[0])==null?void 0:J.p)||null),console.log("[ENDGAME] finalizando: vencedor=%s, round=5",(At==null?void 0:At.name)||""),e(Ie||[]),_(!0),D(At),r(5),he.current=5,Qt.current=null,F.current=!1,V.current=!1,m(!1),S(Ie||[],Xt.current,5,!0,At,{round:5,gameOver:!0,winner:At});return}const Ae=t[s],Dt=Ae&&String(Ae.id)===String(p);if(H||Dt&&!Z){const Ie=Qt.current;if(console.log("[DEBUG]  tick - verificando pendingTurnDataRef:",Ie?`prximo turno: ${Ie.nextTurnIdx}`:"null"),Ie){const on=Array.isArray(tt.current)&&tt.current.length?tt.current:Ie.nextPlayers||[],At=U.current,Se=V.current,Ne=s,vn=ae.current,it=String(vn||"")===String(p),et=Ye.current?Date.now()-Ye.current:1/0,ut=At===0&&!Se&&(et>=200||!Ye.current);if(ut&&Ne===s&&it){console.log("[DEBUG]  Mudando turno - de:",s,"para:",Ie.nextTurnIdx,"finalModalLocks:",At,"finalOpening:",Se,"timeSinceLastModalClosed:",et);const I=he.current===5&&Ie.shouldIncrementRound,de=Ie.endGame===!0;if(I||de||Ie.shouldIncrementRound&&Ie.nextRound>An){console.log("[ENDGAME] detectado: fim da 5 - currentRound:",he.current,"shouldIncrementRound:",Ie.shouldIncrementRound,"nextRound:",Ie.nextRound);const Ce=vo(on,Ie.nextRound,s);if(Ce.finished){console.log("[DEBUG]  FIM DE JOGO finalizando - Rodada:",Ce.finalRound,"Vencedor:",((ve=Ce.winner)==null?void 0:ve.name)||null),e(on),D(Ce.winner),_(!0),r(Ce.finalRound),he.current=Ce.finalRound,y(`Fim de jogo! ${An} rodadas completas. Vencedor: ${((Ve=Ce.winner)==null?void 0:Ve.name)||""}`);const Ue={};Ie.nextRoundFlags&&(Ue.roundFlags=Ie.nextRoundFlags),Ue.round=Ce.finalRound,Ue.gameOver=!0,Ue.winner=Ce.winner,S(on,s,Ce.finalRound,!0,Ce.winner,Ue),Qt.current=null,m(!1),F.current=!1;return}}F.current=!0;const fe=Ie.nextRound,ke=Ie.shouldIncrementRound||!1;console.log("[DEBUG]  Broadcast - Rodada a ser transmitida:",fe,"Rodada atual no estado:",n,"shouldIncrement:",ke),o(Ie.nextTurnIdx),l&&l(Ie.nextTurnPlayerId??null),r(Ce=>{const Ue=Math.min(An,fe),yt=Math.min(An,Math.max(Ce,Ue));return yt!==Ce&&console.log("[DEBUG]  Rodada atualizada no tick - de:",Ce,"para:",yt),he.current=yt,yt});const $e={};Ie.nextRoundFlags&&($e.roundFlags=Ie.nextRoundFlags),Ie.shouldIncrementRound&&($e.round=fe),Ie.nextTurnPlayerId&&($e.turnPlayerId=Ie.nextTurnPlayerId),S(on,Ie.nextTurnIdx,fe,w,A,$e),Qt.current=null,m(!1),F.current=!1,console.log("[DEBUG]  Turno mudado com sucesso - Rodada:",fe)}else{console.log("[DEBUG]  tick - condies no atendidas, no mudando turno",{finalModalLocks:At,finalOpening:Se,finalCanChangeTurn:ut,timeSinceLastModalClosed:et,finalTurnIdx:Ne,turnIdx:s,finalIsLockOwner:it,isLockOwner:H}),console.log("[DEBUG]  tick - condies no atendidas, no mudando turno",{finalModalLocks:At,finalOpening:Se,finalTurnIdx:Ne,turnIdx:s,finalIsLockOwner:it,isLockOwner:H}),setTimeout(qn,150);return}}else{console.log("[DEBUG]  tick - turnData  null, no mudando turno. turnIdx atual:",s,"lockOwner:",Z,"isLockOwner:",H);const on=Ye.current?Date.now()-Ye.current:1/0,At=O===0&&(on>=200||!Ye.current);if(H&&At&&!z)if(Zt<10){console.log("[DEBUG]  tick - tentando novamente em 200ms (pode ser que pendingTurnDataRef ainda no foi preenchido)"),setTimeout(qn,200);return}else console.warn("[DEBUG]  tick - excedeu tentativas de retry, liberando turnLock"),m(!1),F.current=!1;else m(!1),F.current=!1}}else console.log("[DEBUG]  tick - no sou o dono do cadeado e no  minha vez, no mudando turno",{isLockOwner:H,isCurrentPlayerMe:Dt,currentLockOwner:Z,myUid:p,turnIdx:s}),Dt||(m(!1),F.current=!1);return}setTimeout(qn,100)};let Mn=0;const It=50,sn=()=>{Mn++;const O=V.current,z=U.current>0;if((O||z)&&Mn<It){Mn%5===1&&console.log("[DEBUG]  checkBeforeTick - aguardando modais...",{hasOpening:O,hasLocks:z,modalLocks:U.current,attempt:Mn});const Z=Math.min(1e3,Math.floor(150*Math.pow(1.35,Mn)));setTimeout(sn,Z);return}Mn>=It&&(console.warn("[DEBUG]  checkBeforeTick - excedeu tentativas, forando avano do turno",{hasOpening:O,hasLocks:z,modalLocks:U.current}),U.current>0&&(console.warn("[DEBUG]  checkBeforeTick - forando modalLocks para 0"),U.current=0,$(0)),V.current=!1),console.log("[DEBUG]  checkBeforeTick - iniciando tick, sem modais abertas"),qn()};setTimeout(sn,500)}catch(W){throw console.error("[DEBUG] Erro em advanceAndMaybeLap:",W),ae.current===String(p)&&m(!1),W}finally{ae.current===String(p)?setTimeout(()=>{ae.current===String(p)&&(m(!1),F.current=!1)},100):F.current=!1}}},[t,n,s,u,d,h,p,b,w,y,S,e,r,o,c,m,Rt,vo,R,v,E]),Si=ce.useCallback(()=>{if(w||!t.length)return;const Y=No(t,s),je=t[Y],Re=je!=null&&je.id?String(je.id):null;o(Y),l&&l(Re),S(t,Y,he.current,!1,null,{turnPlayerId:Re})},[S,w,t,n,o,l,s]),Pt=ce.useCallback(Y=>{var je,Re,W,Qe,ne,Oe,we,Wt,Nn,or;if(!(!(Y!=null&&Y.type)||Dr.current||sr.current||ss.current)){if(Y.type==="ROLL"){if(!i||String(i)!==String(p)){console.warn("[ROLL_BLOCK] not my turn (turnPlayerId mismatch)",{turnPlayerId:i,myUid:p});return}if(!d){console.warn("[DEBUG]  onAction ROLL - no  minha vez, ignorando");return}if(f){console.warn("[DEBUG]  onAction ROLL - turnLock ativo, ignorando");return}const ee=ae.current;if(f&&ee&&String(ee)!==String(p)){console.warn("[ROLL_BLOCK] locked by other",{lockOwner:ee,myUid:p});return}if(U.current>0){console.warn("[DEBUG]  onAction ROLL - h modais abertas, ignorando");return}try{const le=`ROLL:r${he.current}:t${Xt.current}:${Date.now()}`;yb(Ab({traceId:le,actionType:"ROLL",reason:Y.note||"ROLL",origin:{file:"src/game/useTurnEngine.jsx",fn:"onAction(ROLL)"},context:{round:he.current}}))}catch{}try{xo(Y.steps,Y.cashDelta,Y.note)}catch(le){console.error("[DEBUG] Erro em advanceAndMaybeLap:",le),ae.current===String(p)&&m(!1)}return}if(Y.type==="RECOVERY"){const ee=Math.floor(Math.random()*3e3)+1e3,le=t.find(h);if(!le)return;const C=t.map(N=>h(N)?{...N,cash:N.cash+ee}:N);y(`${le.name} ativou Recuperao Financeira (+$${ee})`),e(C),S(C,s,he.current);return}if(Y.type==="RECOVERY_CUSTOM"){const ee=Number(Y.amount||0),le=t.find(h);if(!le)return;const C=t.map(N=>h(N)?{...N,cash:N.cash+ee}:N);y(`${le.name} recuperou +$${ee}`),e(C),S(C,s,he.current);return}if(Y.type==="RECOVERY_MODAL"){if(!d||!R||!v)return;(async()=>{const ee=await Pe(a.jsx(qf,{playerName:(x==null?void 0:x.name)||"Jogador",currentPlayer:x}));if(ee){if(ee&&ee.type==="TRIGGER_BANKRUPTCY"){Pt({type:"BANKRUPT"});return}switch(ee.type){case"FIRE":Pt==null||Pt({type:"RECOVERY_FIRE",items:ee.items,amount:ee.totalCredit??ee.amount??0,note:ee.note,creditByRole:ee.creditByRole});break;case"REDUCE":{const le=Array.isArray(ee.items)&&ee.items.length>0,C=le?ee.items.map((P,B)=>({...P,group:String(P.group||P.tipo||"").toUpperCase(),level:String(P.level||P.nivel||"").toUpperCase(),credit:Number(P.credit??P.amount??0),selected:B===0?!0:!!P.selected})):void 0,N=le&&(C==null?void 0:C[0])||ee.selection||ee.sel||(ee.group&&ee.level?{group:String(ee.group).toUpperCase(),level:String(ee.level).toUpperCase(),credit:Number(ee.credit??ee.amount??0)}:null),L=Number((le?ee.total??ee.totalCredit:void 0)??(N==null?void 0:N.credit)??ee.amount??0),q=ee.note||(le?`Reduo mltipla +R$ ${L.toLocaleString()}`:N?`Reduo ${N.group} nvel ${N.level} +R$ ${L.toLocaleString()}`:`Reduo +R$ ${L.toLocaleString()}`);Pt==null||Pt({type:"RECOVERY_REDUCE",items:C,selection:N||null,amount:L,note:q});break}case"LOAN":{const le=typeof ee.amount=="object"&&ee.amount!==null?ee.amount:{amount:Number(ee.amount??0),cashDelta:Number(ee.cashDelta??ee.amount??0),loan:ee.loan},C=Number(le.amount??0),N=Number(le.cashDelta??C??0),L=le.loan??ee.loan??{};Pt==null||Pt({type:"RECOVERY_LOAN",amount:C,cashDelta:N,loan:L,note:ee.note});break}default:ee.amount>0&&(Pt==null||Pt({type:"RECOVERY_CUSTOM",amount:ee.amount,note:ee.note}))}}})();return}if(Y.type==="BANKRUPT_MODAL"){if(!d||!R||!v)return;(async()=>await Pe(a.jsx(Db,{playerName:(x==null?void 0:x.name)||"Jogador"}))&&(Pt==null||Pt({type:"BANKRUPT"})))();return}if(Y.type==="RECOVERY_FIRE"){const ee=Number(Y.amount||0),le=Y.items||{},C={cashDelta:ee,vendedoresComunsDelta:-Number(le.comum||0),fieldSalesDelta:-Number(le.field||0),insideSalesDelta:-Number(le.inside||0),gestoresDelta:-Number(le.gestor||0)},N=s,L=String(((je=t[N])==null?void 0:je.id)??"");e(q=>{const P=L?te(q,L,B=>Vt(B,C)):q;return S(P,s,he.current),P}),y(`${((Re=t[N])==null?void 0:Re.name)||"Jogador"}: ${Y.note||"Demisses"}`);return}if(Y.type==="RECOVERY_LOAN"){const ee=Math.max(0,Number(Y.amount||0));if(!ee)return;const le=s,C=t[le];if(C!=null&&C.loanPending&&!C.loanPending.charged){y(`${(C==null?void 0:C.name)||"Jogador"} j possui um emprstimo pendente.`);return}e(N=>{const L=N.map((q,P)=>P!==le?q:{...q,cash:(Number(q.cash)||0)+ee,loanPending:{amount:ee,charged:!1,shouldChargeOnNextExpenses:!0}});return S(L,s,he.current),L}),y(`${(C==null?void 0:C.name)||"Jogador"} pegou emprstimo: +$${ee.toLocaleString()}`);return}if(Y.type==="BUY_MIX"||Y.kind==="MIX_BUY"||Y.type==="DIRECT_BUY_MIX"){const ee=String(Y.level||"").toUpperCase(),le=Math.max(0,Number(Y.price??0));if(!["A","B","C","D"].includes(ee)){m(!1);return}const C=s;if(!os(C,le)){y("Saldo insuficiente para comprar MIX"),m(!1);return}e(N=>{const L=N.map((q,P)=>{if(P!==C)return q;const B={...q.mixOwned||q.mix||{},D:!0};return B[ee]=!0,{...q,cash:Math.max(0,(Number(q.cash)||0)-le),bens:(Number(q.bens)||0)+le,mixOwned:B,mix:B,mixLevel:ee,mixProdutos:ee}});return S(L,s,he.current),L}),y(`${((W=t[C])==null?void 0:W.name)||"Jogador"} comprou MIX nvel ${ee} por -$${le.toLocaleString()}`),m(!1);return}if(Y.type==="BUY_ERP"||Y.kind==="ERP_BUY"||Y.type==="DIRECT_BUY_ERP"){const ee=String(Y.level||"").toUpperCase(),le=Math.max(0,Number(Y.price??0));if(!["A","B","C","D"].includes(ee)){m(!1);return}const C=s;if(!os(C,le)){y("Saldo insuficiente para comprar ERP"),m(!1);return}e(N=>{const L=N.map((q,P)=>{if(P!==C)return q;const B={...q.erpOwned||q.erp||{},D:!0};return B[ee]=!0,{...q,cash:Math.max(0,(Number(q.cash)||0)-le),erpOwned:B,erp:B,erpLevel:ee,erpSystems:{...q.erpSystems||{},level:ee}}});return S(L,s,he.current),L}),y(`${((Qe=t[C])==null?void 0:Qe.name)||"Jogador"} comprou ERP nvel ${ee} por -$${le.toLocaleString()}`),m(!1);return}if(Y.type==="RECOVERY_REDUCE"){const ee=se=>String(se||"").toUpperCase(),le=se=>{const re=String(se||"").toUpperCase();return re==="MIX"||re==="ERP"?re:re.includes("MIX")?"MIX":re.includes("ERP")?"ERP":""},N=(()=>{if(Array.isArray(Y.items)&&Y.items.length)return Y.items.filter(re=>(re==null?void 0:re.selected)??!0).map(re=>({group:le(re.group||re.kind),level:ee(re.level),credit:Math.max(0,Number(re.credit??re.amount??0))})).filter(re=>(re.group==="MIX"||re.group==="ERP")&&["A","B","C"].includes(re.level));const se=Y.selection||Y.target||null;if(se){const re={group:le(se.group||se.kind),level:ee(se.level),credit:Math.max(0,Number(se.credit??se.amount??Y.amount??0))};if((re.group==="MIX"||re.group==="ERP")&&["A","B","C"].includes(re.level))return[re]}return[]})();if(!N.length){const se=Math.max(0,Number(Y.amount??0));if(se>0){const re=s;e(be=>{const Ze=be.map((Ke,We)=>We!==re?Ke:{...Ke,cash:(Number(Ke.cash)||0)+se});return S(Ze,s,he.current),Ze})}return}const L=(se,re)=>{const be={A:!1,B:!1,C:!1,D:!1,...se||{}},Ze=ee(re);return!be.A&&!be.B&&!be.C&&!be.D&&(["A","B","C","D"].includes(Ze)?be[Ze]=!0:be.D=!0),be},q=se=>se!=null&&se.A?"A":se!=null&&se.B?"B":se!=null&&se.C?"C":se!=null&&se.D?"D":"-",P=s,B=t[P];if(N.some(se=>se.level==="D")){y("No  possvel reduzir o nvel D (bsico).");return}const M=Array.isArray((ne=B.reducedLevels)==null?void 0:ne.MIX)?B.reducedLevels.MIX:[],oe=Array.isArray((Oe=B.reducedLevels)==null?void 0:Oe.ERP)?B.reducedLevels.ERP:[];if(N.some(se=>se.group==="MIX"&&M.includes(se.level)||se.group==="ERP"&&oe.includes(se.level))){y("No  possvel reduzir um nvel que j foi reduzido anteriormente.");return}e(se=>{const re=se.map((be,Ze)=>{var qn,Mn;if(Ze!==P)return be;let Ke={A:!1,B:!1,C:!1,D:!1,...be.mixOwned||be.mix||{}},We={A:!1,B:!1,C:!1,D:!1,...be.erpOwned||be.erp||{}};Ke=L(Ke,be.mixProdutos),We=L(We,be.erpSistemas);const Et=[...Array.isArray((qn=be.reducedLevels)==null?void 0:qn.MIX)?be.reducedLevels.MIX:[]],X=[...Array.isArray((Mn=be.reducedLevels)==null?void 0:Mn.ERP)?be.reducedLevels.ERP:[]];let ue=0,Le=String(be.mixProdutos||"D").toUpperCase(),qe=String(be.erpLevel||be.erpSistemas||"D").toUpperCase();for(const It of N)if(ue+=Math.max(0,Number(It.credit||0)),It.group==="MIX"){if(It.level===Le){const sn=["A","B","C","D"],O=sn.indexOf(Le);for(let z=O+1;z<sn.length;z++){const Z=sn[z];if(Ke[Z]||Z==="D"){Le=Z;break}}}delete Ke[It.level],Ke[It.level]=!1,Et.includes(It.level)||Et.push(It.level)}else if(It.group==="ERP"){if(It.level===qe){const sn=["A","B","C","D"],O=sn.indexOf(qe);for(let z=O+1;z<sn.length;z++){const Z=sn[z];if(We[Z]||Z==="D"){qe=Z;break}}}delete We[It.level],We[It.level]=!1,X.includes(It.level)||X.push(It.level)}Ke.A||Ke.B||Ke.C||(Ke.D=!0,Ke.A=!1,Ke.B=!1,Ke.C=!1),We.A||We.B||We.C||(We.D=!0,We.A=!1,We.B=!1,We.C=!1);const Nt=q(Ke),ft=q(We),yn=Nt!=="-"?Nt:Le||"D",Dn=ft!=="-"?ft:qe||"D",Zt={...Ke},Ar={...We};return{...be,cash:(Number(be.cash)||0)+ue,mixOwned:Zt,erpOwned:Ar,mix:Zt,erp:Ar,mixProdutos:yn,erpLevel:Dn,erpSistemas:Dn,reducedLevels:{MIX:Et,ERP:X}}});return S(re,s,he.current),re});const Xe=N.reduce((se,re)=>se+Math.max(0,Number(re.credit||0)),0);if(N.length===1){const se=N[0];y(`${(B==null?void 0:B.name)||"Jogador"} reduziu ${se.group} nvel ${se.level} e recebeu +$${Xe.toLocaleString()}`)}else y(`${(B==null?void 0:B.name)||"Jogador"} reduziu ${N.length} nveis e recebeu +$${Xe.toLocaleString()}`);return}if(Y.type==="BANKRUPT"){const ee=s;try{String((we=t[ee])==null?void 0:we.id)===String(p)&&(k==null||k(!0))}catch{}const le=t.map((L,q)=>q===ee?{...L,bankrupt:!0}:L);if(y(`${((Wt=t[ee])==null?void 0:Wt.name)||"Jogador"} declarou FALNCIA.`),Ho(le)<=1){const L=le.findIndex(q=>!(q!=null&&q.bankrupt));D(L>=0?le[L]:null),e(le),_(!0),m(!1),S(le,s,n,!0,L>=0?le[L]:null);return}const N=No(le,ee);if(e(le),o(N),l){const L=le[N];l(L!=null&&L.id?String(L.id):null)}m(!1),S(le,N,he.current),console.log("[DEBUG]  advanceAndMaybeLap finalizada (falncia) - posio final:",(Nn=le[N])==null?void 0:Nn.pos);return}console.log("[DEBUG]  advanceAndMaybeLap finalizada normalmente - posio final:",(or=nextPlayers[curIdx])==null?void 0:or.pos)}},[t,n,s,d,h,p,b,w,y,S,e,r,o,m,_,D,Rt,R,v,E,k]);return ce.useEffect(()=>{if(T===0&&f&&!V.current){const Y=ae.current;String(Y||"")===String(p)?(console.log("[DEBUG]  Destravando turnLock - modalLocks: 0, sou o lockOwner"),m(!1),F.current=!1):d||(console.log("[DEBUG]  Destravando turnLock - no  minha vez e no sou lockOwner"),m(!1),F.current=!1)}},[T,f,Rn,p,d,m]),ce.useEffect(()=>{if(d&&T===0&&f&&!V.current){const Y=ae.current;String(Y||"")===String(p)?(console.log("[DEBUG]  Destravando turnLock -  minha vez e sou o lockOwner"),m(!1),F.current=!1):Y||(console.log("[DEBUG]  Destravando turnLock -  minha vez mas no h lockOwner"),m(!1),F.current=!1)}},[d,T,f,Rn,p,m]),ce.useEffect(()=>()=>{xe.current&&(clearTimeout(xe.current),xe.current=null),F.current=!1,V.current=!1},[]),{advanceAndMaybeLap:xo,onAction:Pt,nextTurn:Si,modalLocks:T,lockOwner:Rn}}const $m=j.createContext(null),Tb=()=>j.useContext($m);function Pb({roomCode:t,hostId:e,children:n}){const r=!!ze&&!!t,s=String(t||"").trim(),[o,i]=j.useState(!1),[l,u]=j.useState({}),[c,d]=j.useState(0),[h,p]=j.useState(null),g=j.useRef(l),b=j.useRef(c),x=j.useRef(h),S=j.useRef(0),y=j.useRef(null),f=j.useRef(null);j.useEffect(()=>{g.current=l},[l]),j.useEffect(()=>{b.current=c},[c]),j.useEffect(()=>{x.current=h},[h]);const m=async A=>{const{data:D,error:k}=await ze.from("rooms").select("id, code, host_id, state, version, updated_at").eq("code",A).order("updated_at",{ascending:!1}).limit(1).maybeSingle();return k?(console.warn("[NET] getLatestRoomByCode error:",k.message||k),null):D};j.useEffect(()=>{if(!r)return;let A=!1;return(async()=>{let D=await m(s);if(!D){const k={code:s,state:{},version:0,host_id:e||null},{data:R,error:v}=await ze.from("rooms").insert(k).select("id, code, host_id, state, version, updated_at").maybeSingle();if(v){console.warn("[NET] rooms/create:",v.message||v);return}if(A)return;R?D=R:D=await m(s)}A||(D&&(y.current=D.id,f.current=D.updated_at,u(D.state||{}),d(D.version??0)),i(!0))})(),()=>{A=!0}},[r,s,e]),j.useEffect(()=>{if(!r)return;const A=ze.channel(`rooms:${s}`).on("postgres_changes",{event:"*",schema:"public",table:"rooms",filter:`code=eq.${s}`},D=>{const k=D.new||D.old||{},R=typeof k.version=="number"?k.version:null,v=k.state||null,E=(v==null?void 0:v.stateId)??null;(R!=null&&R>b.current||R!=null&&R===b.current&&E&&E!==x.current)&&(R!=null&&d(R),v&&u(v),E&&p(String(E)),k.updated_at&&(f.current=k.updated_at),k.id&&(y.current=k.id),S.current=Date.now(),R===b.current&&E&&E!==x.current?console.warn("[NET]  applied remote (same version, different stateId)",{version:R,stateId:E}):console.log("[NET]  applied remote v=%d (realtime)",R))}).subscribe();return()=>{try{ze.removeChannel(A)}catch{}}},[r,s]),j.useEffect(()=>{if(!r)return;const A=setInterval(async()=>{var k;if(Date.now()-(S.current||0)<2e3)return;const D=await m(s);if(D){const R=((k=D.state)==null?void 0:k.stateId)??null;(D.version>b.current||D.version===b.current&&R&&R!==x.current)&&(d(D.version),u(D.state||{}),R&&p(String(R)),D.updated_at&&(f.current=D.updated_at),D.id&&(y.current=D.id))}},700);return()=>clearInterval(A)},[r,s]);const w=async A=>{var v,E,T;if(!r||!o)return;const D=3,k=new Date().toISOString();for(let $=1;$<=D;$++){let U=await m(s);if(!U){const Ee={code:s,state:{},version:0,host_id:e||null},{data:xe,error:Ye}=await ze.from("rooms").insert(Ee).select("id, code, host_id, state, version, updated_at").maybeSingle();if(Ye){if(console.warn(`[NET] commit - insert failed (attempt ${$}/${D}):`,Ye.message||Ye),$<D){await new Promise(Ft=>setTimeout(Ft,50*$));continue}return}if(xe)U=xe,y.current=U.id,f.current=U.updated_at;else if(U=await m(s),!U){if(console.warn(`[NET] commit - no row after insert (attempt ${$}/${D})`),$<D){await new Promise(Ft=>setTimeout(Ft,50*$));continue}return}}U.id&&(y.current=U.id);let V=U.state||{},Je=typeof A=="function"?A(V)||{}:A||{};const at=y.current||U.id;if(!at){if(console.warn("[NET] commit - no target ID available"),$<D){await new Promise(Ee=>setTimeout(Ee,50*$));continue}return}const{data:Q,error:F}=await ze.from("rooms").update({state:Je,version:(U.version||0)+1,updated_at:k}).eq("id",at).eq("version",U.version).select("state, version, updated_at").maybeSingle();if(!F&&Q){u(Q.state||{}),d(Q.version??(U.version||0)+1),Q.updated_at&&(f.current=Q.updated_at),$>1&&console.log(`[NET] commit succeeded on attempt ${$}/${D}`);return}if(((F==null?void 0:F.code)==="PGRST116"||(F==null?void 0:F.status)===406||((v=F==null?void 0:F.message)==null?void 0:v.includes("0 rows"))||((E=F==null?void 0:F.message)==null?void 0:E.includes("Cannot coerce"))||(F==null?void 0:F.code)==="23505"||(F==null?void 0:F.message)&&F.message.includes("version")||!Q)&&$<D){console.warn(`[NET] commit conflict (attempt ${$}/${D}):`,(F==null?void 0:F.message)||F||"no rows updated","- retrying with merge monotnico...");const Ee=await m(s);if(Ee){U=Ee,y.current=Ee.id,f.current=Ee.updated_at,V=Ee.state||{};const xe=typeof A=="function"?A(V)||{}:A||{},Ye=((T=Ee.state)==null?void 0:T.stateVersion)??0,Ft=(xe==null?void 0:xe.stateVersion)??0,Tt=Math.max(Ye,Ft)+1;Je={...V,...xe,stateVersion:Tt}}await new Promise(xe=>setTimeout(xe,50*$));continue}console.warn(`[NET] commit conflict (attempt ${$}/${D}):`,(F==null?void 0:F.message)||F||"no rows updated")}const R=await m(s);R?(u(R.state||{}),d(R.version??0),R.updated_at&&(f.current=R.updated_at),R.id&&(y.current=R.id),console.warn("[NET] commit failed after retries, resynced to latest state")):console.warn("[NET] commit fallback resync failed: no row found")},_=j.useMemo(()=>({enabled:r,ready:o,state:l,version:c,stateId:h,commit:w}),[r,o,l,c,h]);return a.jsx($m.Provider,{value:_,children:n})}const Ms=5,Kl=t=>{const e=Number(t);return Number.isFinite(e)?Math.min(Ms,Math.max(1,e)):1};function Lb(){var Nn,or,ee,le;const[t,e]=j.useState("start"),[n,r]=j.useState(null),[s,o]=j.useState(null),i=j.useMemo(()=>fi(),[]),[l,u]=j.useState(""),[c,d]=j.useState(i);j.useMemo(()=>Object.freeze({mixProdutos:"D",erpLevel:"D",clients:1,vendedoresComuns:1}),[]);const h=(C={})=>({...C,mixProdutos:C.mixProdutos??"D",erpLevel:C.erpLevel??"D",clients:C.clients??1,vendedoresComuns:C.vendedoresComuns??1}),p=C=>{if(!Array.isArray(C)||C.length===0)return C;const N=[...C].filter(Boolean),L=N.every(M=>Number.isInteger(M.joinOrder)),q=N.every(M=>Number.isInteger(M.seat));let P=L?N.sort((M,oe)=>M.joinOrder-oe.joinOrder||String((M==null?void 0:M.id)??"").localeCompare(String((oe==null?void 0:oe.id)??""))):q?N.sort((M,oe)=>M.seat-oe.seat||String((M==null?void 0:M.id)??"").localeCompare(String((oe==null?void 0:oe.id)??""))):N.sort((M,oe)=>String((M==null?void 0:M.id)??(M==null?void 0:M.player_id)??"").localeCompare(String((oe==null?void 0:oe.id)??(oe==null?void 0:oe.player_id)??""))),B=0;const ge=new Set(P.filter(M=>Number.isInteger(M.seat)).map(M=>M.seat));return P=P.map(M=>{if(Number.isInteger(M.seat))return M;for(;ge.has(B);)B++;return ge.add(B),{...M,seat:B++}}),P=P.map(M=>Number.isInteger(M.joinOrder)?M:Number.isInteger(M.seat)?{...M,joinOrder:M.seat}:{...M,joinOrder:0}),P=P.sort((M,oe)=>M.joinOrder-oe.joinOrder||String((M==null?void 0:M.id)??"").localeCompare(String((oe==null?void 0:oe.id)??""))),console.log("[App] normalizePlayers - ordenados:",P.map(M=>({id:M.id,name:M.name,seat:M.seat}))),P},[g,b]=j.useState([h({id:i,name:"",cash:18e3,pos:0,color:"#ffd54f",bens:4e3})]),x=ce.useCallback((C,N={})=>{b(L=>{var P;const q=typeof C=="function"?C(L):C;vb(L,q,null);try{const B=(N==null?void 0:N.source)||"UNKNOWN",ge=new Map((L||[]).map(M=>[String(M==null?void 0:M.id),M]));for(const M of q||[]){const oe=String(M==null?void 0:M.id),St=(P=ge.get(oe))==null?void 0:P.pos,Xe=M==null?void 0:M.pos;Xe!==void 0&&St!==void 0&&Number(St)!==Number(Xe)&&console.log("[POS_CHANGE]",{playerId:oe,from:St,to:Xe,source:B})}}catch{}return q})},[]);j.useEffect(()=>{let C=!1;try{C=!1}catch{}try{new URL(window.location.href).searchParams.get("cashAudit")==="1"&&(C=!0)}catch{}Lm({enabled:C})},[]);const[S,y]=j.useState(1),[f,m]=j.useState(0),[w,_]=j.useState(null),[A,D]=j.useState(new Array(1).fill(!1)),[k,R]=j.useState(!1),[v,E]=j.useState(null),[T,$]=j.useState({id:i,name:((Nn=g[0])==null?void 0:Nn.name)||"Jogador",color:((or=g[0])==null?void 0:or.color)||"#6c5ce7",cash:((ee=g[0])==null?void 0:ee.cash)??18e3,possibAt:0,clientsAt:0,matchId:"local"}),[U,V]=j.useState(["Bem-vindo ao Sales Game!"]),Je=C=>V(N=>[C,...N].slice(0,12)),[at,Q]=j.useState(!1),[F,pe]=j.useState(null),Ee=j.useRef(null),xe=j.useRef(!1),Ye=j.useRef(null),Ft=j.useRef(0);j.useEffect(()=>{at&&(F||(w?(console.warn("[LOCK_INVARIANT] turnLock=true com lockOwner=null -> corrigindo owner para turnPlayerId",{turnPlayerId:w}),pe(String(w))):(console.warn("[LOCK_INVARIANT] turnLock=true sem turnPlayerId -> desligando turnLock"),Q(!1))))},[at,F,w]);const Tt=ce.useCallback(C=>!!C&&String(C.id)===String(c),[c]),zt=j.useMemo(()=>{var C;return((C=g.find(Tt))==null?void 0:C.cash)??0},[g,Tt]);j.useEffect(()=>{try{const C=new URL(window.location.href),N=C.searchParams.get("room"),L=localStorage.getItem("sg:lastRoomName"),q=N||L;if(L&&!N&&localStorage.removeItem("sg:lastRoomName"),q&&N){o(String(q)),r(String(q));try{C.searchParams.set("room",String(q)),history.replaceState(null,"",C.toString())}catch{}}}catch{}},[]);const rr=j.useMemo(()=>`sg-sync:${n||"local"}`,[n]);j.useEffect(()=>{var C,N;try{(N=(C=Ee.current)==null?void 0:C.close)==null||N.call(C);const L=new BroadcastChannel(rr);return L.onmessage=q=>{var B,ge,M,oe,St,Xe;const P=q.data||{};if(String(P.source)!==String(i)){if(P.type==="START"){if(te!=null&&te.enabled&&(te!=null&&te.ready)){console.log("[INIT_GUARD] init skipped: net enabled/ready (BC START ignored)");return}if(xe.current){console.log("[INIT_GUARD] init skipped: hydratedFromNet=true (BC START ignored)");return}if(t==="start"){console.log("[INIT_GUARD] init skipped: phase=start (BC START ignored)");return}const se=Array.isArray(P.players)?P.players.map(h):[];if(!se.length)return;const re=p(se);try{const Ze=window.__MY_UID||window.__myUid||window.__playerId||null;Ze&&d(String(Ze))}catch{}x(re,{source:"BC_START"}),m(0);const be=(B=re[0])!=null&&B.id?String(re[0].id):null;_(be),y(1),D(new Array(Math.max(1,re.length)).fill(!1)),R(!1),E(null),V(["Jogo iniciado!"]);return}if(P.type==="TURNLOCK"){Q(!!P.value),P.value?P.owner&&pe(String(P.owner)):pe(null);return}if(P.type==="SYNC"&&t==="game"){if(te!=null&&te.enabled&&(te!=null&&te.ready)&&ae){console.log("[App] SYNC ignorado - netState ativo, usando Supabase como autoridade nica");return}const se=Number(P.version||0),re=Number(P.timestamp||0),be=Dr.current;if(console.log("[App] SYNC recebido - verso remota:",se,"verso local:",be,"turnIdx:",P.turnIdx,"round:",P.round,"source:",P.source),console.log("[App] SYNC - meu turnIdx atual:",f,"meu myUid:",c),se>0&&be>0&&se<be){console.log("[App] SYNC -  REJEITANDO estado remoto - verso antiga:",se,"< verso local:",be);return}const Ze=Date.now(),Ke=tt.current;if(se>be&&(Dr.current=se,console.log("[App] SYNC -  Aceitando verso remota:",se,"> verso local:",be)),P.turnIdx!==f&&(!(te!=null&&te.enabled)||!(te!=null&&te.ready)))if(P.turnPlayerId!==void 0&&P.turnPlayerId!==null){_(P.turnPlayerId);const ue=p(P.players||g).findIndex(Le=>String(Le.id)===String(P.turnPlayerId));ue>=0&&(m(ue),console.log("[App] SYNC (BC) - turnIdx derivado de turnPlayerId:",ue,"turnPlayerId:",P.turnPlayerId))}else P.turnIdx>=0&&P.turnIdx<(((ge=P.players)==null?void 0:ge.length)||g.length)&&(m(P.turnIdx),console.log("[App] SYNC (BC) - Sincronizando turnIdx",{local:f,remote:P.turnIdx}));if(Array.isArray(P.roundFlags)&&P.roundFlags.length>0&&D(X=>{const ue=P.roundFlags.map((Le,qe)=>X[qe]||!1||Le);for(;ue.length<X.length;)ue.push(X[ue.length]||!1);return console.log("[App] SYNC - roundFlags sincronizado:",ue.map((Le,qe)=>{var me;return`${(me=g[qe])==null?void 0:me.name}:${Le}`}).join(", ")),ue}),P.round!==S){const X=Kl(P.round);if(Ke&&Ze-Ke.timestamp<3e3){const ue=Ke.round!==S;y(ue?Le=>{const qe=Math.min(Ms,Math.max(Le,X));return qe>Le&&console.log("[App] SYNC round aplicado (clamp): local=",Le,"remote=",X,"final=",qe),qe}:X)}else y(ue=>{const Le=Math.min(Ms,Math.max(ue,X));return console.log("[App] SYNC round aplicado (clamp): local=",ue,"remote=",X,"final=",Le),Le})}(P.gameOver===!0||P.winner)&&y(Ms);const We=g,Et=P.players.map(X=>{const ue=We.find(qe=>qe.id===X.id);if(!ue)return X;if(String(X.id)===String(c)){const qe=Number(ue.clients||0),me=Number(X.clients||0),Lt=Number(ue.vendedoresComuns||0),Nt=Number(X.vendedoresComuns||0),ft=Number(ue.fieldSales||0),yn=Number(X.fieldSales||0),Dn=Number(ue.insideSales||0),Zt=Number(X.insideSales||0);return qe>me||Lt>Nt||ft>yn||Dn>Zt||ue.mixProdutos&&ue.mixProdutos!==X.mixProdutos&&ue.mixProdutos!=="D"||ue.erpLevel&&ue.erpLevel!==X.erpLevel&&ue.erpLevel!=="D"?(console.log("[App] SYNC - Detectadas compras locais, preservando estado local completo",{localClients:qe,remoteClients:me,localVendedores:Lt,remoteVendedores:Nt}),{...ue,pos:X.pos,bankrupt:X.bankrupt??ue.bankrupt,az:ue.az||X.az||0,am:ue.am||X.am||0,rox:ue.rox||X.rox||0,trainingsByVendor:ue.trainingsByVendor||X.trainingsByVendor||{},onboarding:ue.onboarding||X.onboarding||!1}):{...X,cash:Number(X.cash||0),clients:me,mixProdutos:X.mixProdutos,erpLevel:X.erpLevel,vendedoresComuns:Nt,fieldSales:yn,insideSales:Zt,gestores:Number(X.gestores??X.gestoresComerciais??X.managers??0),gestoresComerciais:Number(X.gestoresComerciais??X.gestores??X.managers??0),managers:Number(X.managers??X.gestores??X.gestoresComerciais??0),bens:Number(X.bens||0),manutencao:X.manutencao,loanPending:X.loanPending,az:ue.az||X.az||0,am:ue.am||X.am||0,rox:ue.rox||X.rox||0,trainingsByVendor:ue.trainingsByVendor||X.trainingsByVendor||{},onboarding:ue.onboarding||X.onboarding||!1}}return{...X,az:ue.az||X.az||0,am:ue.am||X.am||0,rox:ue.rox||X.rox||0,trainingsByVendor:ue.trainingsByVendor||X.trainingsByVendor||{},onboarding:ue.onboarding||X.onboarding||!1}});x(Et,{source:"BC_SYNC"}),console.log("[App] SYNC aplicado - novo turnIdx:",P.turnIdx),console.log("[App] SYNC - jogador da vez:",(M=Et[P.turnIdx])==null?void 0:M.name,"id:",(oe=Et[P.turnIdx])==null?void 0:oe.id),console.log("[App] SYNC -  minha vez?",String((St=Et[P.turnIdx])==null?void 0:St.id)===String(c)),R(X=>X||!!P.gameOver),E(X=>(k||P.gameOver)&&X&&!P.winner?X:P.winner??X),P.gameOver===!0&&console.log(`[App] [ENDGAME] estado remoto aplicado: gameOver=true winner=${((Xe=P.winner)==null?void 0:Xe.name)??P.winner??"N/A"}`)}}},Ee.current=L,()=>L.close()}catch(L){console.warn("[App] BroadcastChannel init failed:",L)}},[rr,i,t]),j.useEffect(()=>{const C=async()=>{if(console.log(`[App] handleLeaveRoom chamado - fase: ${t}, currentLobbyId: ${n}, myUid: ${c}`),(t==="lobbies"||t==="playersLobby"||t==="game")&&n&&c)try{console.log(`[App] Saindo da sala ${n} na fase ${t}`),await zl({roomCode:n,playerId:c})}catch(q){console.warn("[App] Erro ao sair da sala:",q)}else console.log("[App] No executando leaveRoom - condies no atendidas")},N=()=>{C()},L=()=>{C()};return window.addEventListener("beforeunload",N),window.addEventListener("pagehide",L),()=>{window.removeEventListener("beforeunload",N),window.removeEventListener("pagehide",L)}},[t,n,c]);const Ct=(C,N=void 0)=>{var P,B;const L=!!C,q=L?String(N??c??w??""):null;Q(L),L?q&&pe(q):pe(null);try{(B=(P=Ee.current)==null?void 0:P.postMessage)==null||B.call(P,{type:"TURNLOCK",value:L,owner:q,ts:Date.now(),source:i})}catch{}try{te!=null&&te.enabled&&(te!=null&&te.ready)&&typeof Rn=="function"&&os({playersDeltaById:{},statePatch:{kind:"LOCK",turnLock:L,lockOwner:q,lockTs:Date.now()}})}catch{}},te=Tb(),Rn=te==null?void 0:te.commit,gn=te==null?void 0:te.version,ae=te==null?void 0:te.state,Qt=te==null?void 0:te.stateId,he=j.useMemo(()=>{const C=String(c||i||"");return!C||!w?!1:String(w)===C},[w,c,i]);j.useEffect(()=>{var C,N;if(g!=null&&g.length){if(w){const L=g.findIndex(q=>String(q.id)===String(w));L>=0&&L!==f&&m(L)}else if(!(te!=null&&te.enabled)||!(te!=null&&te.ready)){const L=((C=g[f])==null?void 0:C.id)||((N=g[0])==null?void 0:N.id);L&&_(String(L))}}},[g,w,f]),ce.useRef(null);const tt=ce.useRef(null),Xt=ce.useRef(0),Dr=ce.useRef(0),sr=ce.useRef(0),ss=ce.useRef(null),Pe=ce.useRef(null),os=ce.useCallback(({playersDeltaById:C={},statePatch:N={}})=>{if(typeof Rn!="function")return;Xt.current=Xt.current+1;const L=Xt.current,q=Date.now();try{Rn(P=>{var Ke;const B=P||{},ge=L,M=B.stateVersion??0,oe=Math.max(ge,M)+1,St=Array.isArray(B.players)&&B.players.length>0?B.players:Array.isArray((Ke=tt.current)==null?void 0:Ke.players)&&tt.current.players.length>0?tt.current.players:Array.isArray(Pe.current)&&Pe.current.length>0?Pe.current:[],Xe=p(St),se=new Map(Xe.map(We=>[String(We.id),We]));for(const[We,Et]of Object.entries(C)){const X=String(We),ue=se.get(X);if(ue){const Le=(Et==null?void 0:Et._actionId)||(N==null?void 0:N.actionId)||null;if(Le){const qe=ue.lastActions&&typeof ue.lastActions=="object"?ue.lastActions:{};if(qe[Le]){console.warn("[IDEMPOTENCY] ignorando delta j aplicado",{playerId:X,actionId:Le});continue}const me={...qe,[Le]:q},Lt=Object.keys(me);Lt.length>50&&Lt.sort((Dn,Zt)=>Number(me[Dn]||0)-Number(me[Zt]||0)).slice(0,Lt.length-50).forEach(Dn=>{try{delete me[Dn]}catch{}});const{_actionId:Nt,...ft}=Et||{},yn={...ue};for(const[Dn,Zt]of Object.entries(ft))Zt!==void 0&&(yn[Dn]=Zt);se.set(X,h({...yn,lastActions:me}))}else{const{_actionId:qe,...me}=Et||{},Lt={...ue};for(const[Nt,ft]of Object.entries(me))ft!==void 0&&(Lt[Nt]=ft);se.set(X,h(Lt))}}else{const{_actionId:Le,...qe}=Et||{};se.set(X,h({id:X,...qe}))}}const re=p(Array.from(se.values())),be={...N,stateVersion:oe,updatedAt:q,updatedBy:c};Object.keys(C).length>0&&(be.players=re);const Ze={...B,...be};try{delete Ze.turnIdx}catch{}return Ze.players&&(Ze.players=p(Ze.players)),console.log("[NET]  commitGamePatch - tipo:",N.turnPlayerId?"TURN":N.round?"ROUND":"PLAYER_DELTA","playersDeltaIds:",Object.keys(C).join(","),"statePatchKeys:",Object.keys(N).join(","),"stateVersion:",oe,"(local:",ge,"remote:",M,")"),Ze})}catch(P){console.warn("[NET] commitGamePatch failed:",(P==null?void 0:P.message)||P)}},[Rn,c]);ce.useEffect(()=>{const C=tt.current,N=!C||C.turnIdx!==f,L=!C||C.round!==S,q=!C||JSON.stringify(C.players)!==JSON.stringify(g);if(N||L||q){const P=Date.now();(C?P-C.timestamp:1/0)>100?(tt.current={...C||{},players:g,turnIdx:f,round:S,timestamp:P,stateVersion:(C==null?void 0:C.stateVersion)??Xt.current??0},N&&console.log("[App] lastLocalStateRef atualizado via useEffect - turnIdx mudou:",C==null?void 0:C.turnIdx,"->",f)):tt.current={...tt.current,players:g,turnIdx:f,round:S}}},[g,f,S]),j.useEffect(()=>{var q,P;if(!(te!=null&&te.enabled)||!(te!=null&&te.ready)||!ae)return;if(typeof gn=="number"){const B=Xt.current??((q=tt.current)==null?void 0:q.stateVersion)??0,ge=(ae==null?void 0:ae.stateVersion)??0,M=String((ae==null?void 0:ae.stateId)??(ae==null?void 0:ae.actionId)??Qt??""),oe=String(ss.current??"");if(gn<sr.current){console.log("[NET]  IGNORADO - netVersion regressivo:",{netVersion:gn,lastApplied:sr.current});return}if(gn===sr.current)if(M&&M!==oe)console.warn("[NET] same version but different stateId -> applying",{netVersion:gn,incomingStateId:M,lastStateId:oe});else{console.log("[NET]  IGNORADO - same version and same stateId:",{netVersion:gn,stateId:M||"(empty)"});return}if(ge>0&&B>0&&ge<B){console.warn("[NET]  IGNORANDO rollback de stateVersion:",{remoteStateVersion:ge,localStateVersion:B,netVersion:gn}),sr.current=gn;return}sr.current=gn,M&&(ss.current=M)}else return;const C=Array.isArray(ae.players)?ae.players:null,N=Number.isInteger(ae.round)?ae.round:null,L=ae.turnPlayerId!==void 0&&ae.turnPlayerId!==null&&String(ae.turnPlayerId)!==""?String(ae.turnPlayerId):null;if(L&&String(w||"")!==L&&_(L),C){const B=p(C);if(x(B,{source:"SNAPSHOT"}),Pe.current=JSON.parse(JSON.stringify(B)),console.log("[NET]  Aplicado players (snapshot autoritativo) - netVersion:",gn,"playersOrdered:",B.map(ge=>({id:ge.id,seat:ge.seat}))),L){const ge=B.findIndex(M=>String(M.id)===String(L));ge>=0&&ge!==f&&(console.log("[NET]  derived turnIdx from turnPlayerId:",ge,"turnPlayerId:",L),m(ge))}}if(N!==null){const B=N===1&&Array.isArray(C)&&C.length>0&&C.every(M=>Number((M==null?void 0:M.pos)??0)===0)&&(ae.gameOver===!1||ae.gameOver==null),ge=Kl(N);y(M=>B?1:Math.min(Ms,Math.max(M,ge)))}if((ae.gameOver===!0||ae.winner)&&y(Ms),ae.roundFlags!==void 0){if(Array.isArray(ae.roundFlags))D(ae.roundFlags),console.log("[NET] applied remote includes roundFlags?",!0,"length:",ae.roundFlags.length);else if(typeof ae.roundFlags=="object"){const B=Object.values(ae.roundFlags);D(B),console.log("[NET] applied remote includes roundFlags?",!0,"converted from object, length:",B.length)}}typeof ae.turnLock<"u"&&Q(!!ae.turnLock),typeof ae.lockOwner<"u"&&pe(ae.lockOwner?String(ae.lockOwner):null),ae.turnLock===!0&&!ae.lockOwner&&L&&pe(L),Ft.current=Date.now(),R(B=>B||!!ae.gameOver),E(B=>(!!ae.gameOver||!!ae.winner)&&B&&!ae.winner?B:ae.winner??B),ae.gameOver===!0&&console.log(`[App] [ENDGAME] estado remoto aplicado: gameOver=true winner=${((P=ae.winner)==null?void 0:P.name)??ae.winner??"N/A"}`),console.log("[NET]  applied remote snapshot - netVersion:",gn,"turnPlayerId:",ae.turnPlayerId,"round:",N);try{const B=Array.isArray(ae.players)&&ae.players.length>0,ge=ae.turnPlayerId!==void 0&&ae.turnPlayerId!==null&&String(ae.turnPlayerId)!=="";B&&ge&&(xe.current=!0)}catch{}},[gn,ae,te==null?void 0:te.enabled,te==null?void 0:te.ready]),j.useEffect(()=>{if(!at){Ye.current=null;return}Ye.current||(Ye.current=Date.now());const C=setInterval(()=>{const N=Date.now(),L=Ye.current?N-Ye.current:0,q=g[f],P=q&&String(q.id)===String(c),B=he&&P,ge=F===c;L>8e3&&B&&!ge&&F!=null&&(console.warn("[LOCK-WATCHDOG] stole lock - turnLock travado por",L,"ms, liberando...",{isMyTurn:B,lockOwner:F,myUid:c}),Rt({turnLock:!1,lockOwner:c}),Ct(!1),pe(c),Ye.current=null)},1e3);return()=>clearInterval(C)},[at,he,f,g,F,c,Rn]);async function Rt(C){if(typeof Rn=="function")try{await Rn(N=>{const L=N||{},q=C||{};if(q.players&&Array.isArray(q.players)){const oe=Pe.current||L.players||[],St=L.players||[],Xe=q.players,se=new Map(oe.map(me=>[String(me==null?void 0:me.id),me])),re=new Map(St.map(me=>[String(me==null?void 0:me.id),me])),be=new Map(Xe.map(me=>[String(me==null?void 0:me.id),me])),Ze=[],Ke=new Set([...se.keys(),...re.keys(),...be.keys()]);for(const me of Ke){const Lt=se.get(me),Nt=re.get(me),ft=be.get(me);Lt&&ft&&JSON.stringify(Lt)!==JSON.stringify(ft)&&ft?Ze.push(h(ft)):Nt?Ze.push(h(Nt)):ft&&Ze.push(h(ft))}const We=[],Et=Xe.map(me=>String(me==null?void 0:me.id));for(const me of Et){const Lt=Ze.find(Nt=>String(Nt==null?void 0:Nt.id)===me);Lt&&We.push(Lt)}for(const me of Ze)Et.includes(String(me==null?void 0:me.id))||We.push(me);Pe.current=null;const X=q.stateVersion??0,ue=L.stateVersion??0,Le=Math.max(X,ue)+1,qe={...L,...q,players:We.length>0?We:Xe,stateVersion:Le};try{delete qe.turnIdx}catch{}return qe}const P=q.stateVersion??0,B=L.stateVersion??0,ge=Math.max(P,B)+1,M={...L,...q,stateVersion:ge};try{delete M.turnIdx}catch{}return M})}catch(N){console.warn("[NET] commit failed:",(N==null?void 0:N.message)||N),Pe.current=null}}function vo(C,N,L,q=k,P=v,B={}){var Ar,qn,Mn,It,sn,O;Pe.current||(Pe.current=JSON.parse(JSON.stringify(g)),console.log("[App] broadcastState - baseline capturado (estado atual antes da mudana):",Pe.current.length,"players")),Xt.current=Xt.current+1;const ge=Xt.current,M=B.roundFlags!==void 0?B.roundFlags:A,oe=B.turnLock!==void 0?B.turnLock:at,St=((Ar=tt.current)==null?void 0:Ar.lockOwner)??null,Xe=B.lockOwner!==void 0?B.lockOwner:St,se=B.gameOver!==void 0?B.gameOver:q,be=!!k||!!((qn=tt.current)!=null&&qn.gameOver)?!0:!!se,Ze=B.winner!==void 0?B.winner:P,Ke=v??((Mn=tt.current)==null?void 0:Mn.winner)??null,We=be?Ze??Ke:Ze,Et=B.round!==void 0?B.round:L,X=Kl(Math.max(Number(Et||1),Number(S||1),Number(((It=tt.current)==null?void 0:It.round)||1)));Pe.current||(Pe.current=JSON.parse(JSON.stringify(g)),console.log("[App] broadcastState - baseline capturado (fallback):",Pe.current.length,"players"));const ue=p(C),Le=B.turnPlayerId!==void 0&&B.turnPlayerId!==null?String(B.turnPlayerId):String(w||"");if(Le!=null){const z=String(Le);String(w||"")!==z&&_(z)}const qe=!Le||Le===w?w:(B.turnPlayerId!==void 0||X!==S,Le),me=B.kind||(B.turnPlayerId!==void 0?"TURN":"PLAYER_DELTA"),Lt=()=>{try{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID()}catch{}return`${String(c||"anon")}-${Date.now()}-${Math.random().toString(16).slice(2)}`},Nt=String(B.stateId||Lt()),ft=String(B.actionId||`${String(c||"anon")}-${Date.now()}-${ge}`),yn=Date.now(),Dn=Le?ue.findIndex(z=>String(z.id)===String(Le)):N;if(tt.current={players:ue,turnIdx:Dn,turnPlayerId:qe,round:X,gameOver:be,winner:We,lockOwner:Xe,timestamp:yn,version:ge,stateVersion:ge,updatedAt:yn,updatedBy:c},Dr.current=ge,B.isStartGame===!0||X===1&&N===0&&ue.every(z=>Number((z==null?void 0:z.pos)??0)===0))console.log("[App] broadcastState (START) - verso:",ge,"turnPlayerId:",qe,"round:",X),Rt({players:ue,turnPlayerId:qe,round:X,roundFlags:M,stateId:Nt,actionId:ft,kind:"START",stateVersion:ge,updatedAt:yn,updatedBy:c});else{const z={},Z=new Map(g.map(K=>[String(K.id),K]));for(const K of ue){const J=String(K.id),ve=Z.get(J);if(!ve)z[J]={...K,_actionId:ft};else{const Ve={},gt=["pos","cash","bankrupt","clients","vendedoresComuns","fieldSales","insideSales","gestores","gestoresComerciais","manutencao","bens","mixProdutos","erpLevel","az","am","rox","onboarding","trainingByVendor","trainingsByVendor","loanPending","waitingAtRevenue","revenue","erpOwned","erp","mixOwned","mix","lastRevenueRound","directBuys","directBuysPush","trainings","mixBase"];for(const ht of gt)JSON.stringify(ve[ht])!==JSON.stringify(K[ht])&&(Ve[ht]=K[ht]);Object.keys(Ve).length>0&&(z[J]={...Ve,_actionId:ft})}}const H=Object.keys(z).length>0,_e=me==="TURN"||me==="LOCK"||B.round!==void 0||B.roundFlags!==void 0||B.gameOver!==void 0||B.winner!==void 0;if(!H&&!_e){console.log("[App] broadcastState skipped (no-op)",{actionId:ft,patchKind:me});return}const ye={kind:me,actionId:ft,stateId:Nt,...be?{gameOver:!0,winner:We}:{},...me==="TURN"?{turnPlayerId:Le,round:X,roundFlags:M,gameOver:be,winner:We}:{},...me==="LOCK"?{turnLock:oe,lockOwner:Xe,lockTs:Date.now()}:{}};os({playersDeltaById:z,statePatch:ye}),console.log("[App] broadcastState (PATCH) - kind:",me,"playersDeltaIds:",Object.keys(z).join(","),"turnPlayerId:",qe,"round:",X)}try{(O=(sn=Ee.current)==null?void 0:sn.postMessage)==null||O.call(sn,{type:"SYNC",version:ge,players:ue,round:X,roundFlags:M,turnLock:oe,lockOwner:Xe,gameOver:be,winner:We,source:i,timestamp:yn})}catch(z){console.warn("[App] broadcastState failed:",z)}}function xo(C){var P,B,ge;let N=p(C);const L=N.findIndex(M=>String(M==null?void 0:M.id)===String(c));L>0&&(N=[N[L],...N.slice(0,L),...N.slice(L+1)]);const q=(P=N[0])!=null&&P.id?String(N[0].id):null;vo(N,0,1,!1,null,{turnPlayerId:q,roundFlags:Array(N.length).fill(!1),isStartGame:!0});try{(ge=(B=Ee.current)==null?void 0:B.postMessage)==null||ge.call(B,{type:"START",players:N,source:i})}catch(M){console.warn("[App] broadcastStart failed:",M)}}const Si=g[f];j.useEffect(()=>{t==="game"&&pb(g,f,S,k,v,"Game State Update")},[g,f,S,k,v,t]),j.useEffect(()=>{const C=g.find(Tt);if(!C)return;const{cap:N,inAtt:L}=Ia(C);$(q=>({...q,cash:C.cash,possibAt:N,clientsAt:L,name:C.name,color:C.color}))},[g,Tt]);const Pt=j.useMemo(()=>{const C=g.find(Tt)||g[0]||{},N=ol(C),L=il(C),{cap:q,inAtt:P}=Ia(C),B=String(C.erpLevel||"D").toUpperCase(),ge=Number(C.gestores??C.gestoresComerciais??C.managers??0);return console.log("[App] Totals recalculado - me:",C.name,"clients:",C.clients,"faturamento:",N,"manutencao:",L,"vendedoresComuns:",C.vendedoresComuns,"fieldSales:",C.fieldSales,"insideSales:",C.insideSales),mb(C,"HUD Totals"),{faturamento:N,manutencao:L,emprestimos:C.loanPending&&!C.loanPending.charged?Number(C.loanPending.amount||0):0,vendedoresComuns:C.vendedoresComuns||0,fieldSales:C.fieldSales||0,insideSales:C.insideSales||0,mixProdutos:C.mixProdutos||"D",bens:C.bens??0,erpSistemas:B,clientes:C.clients||0,onboarding:!!C.onboarding,az:C.az||0,am:C.am||0,rox:C.rox||0,gestores:ge,gestoresComerciais:ge,possibAt:q,clientsAt:P}},[g,Tt]),[Y,je]=j.useState(!1),{onAction:Re,modalLocks:W}=Ob({players:g,setPlayers:x,round:S,setRound:y,turnIdx:f,setTurnIdx:m,turnPlayerId:w,setTurnPlayerId:_,roundFlags:A,setRoundFlags:D,isMyTurn:he,isMine:Tt,myUid:c,meId:i,myCash:zt,current:Si,broadcastState:vo,appendLog:Je,turnLock:at,setTurnLockBroadcast:Ct,gameOver:k,setGameOver:R,winner:v,setWinner:E,setShowBankruptOverlay:je}),Qe=g[f],ne=(Qe==null?void 0:Qe.bankrupt)===!0,Oe=S===5&&((le=g[f])==null?void 0:le.waitingAtRevenue),we=w!=null&&c!=null&&String(w)===String(c),Wt=!!w&&g.length>0&&we&&at===!1&&Number(W||0)===0&&k!==!0&&ne!==!0&&Oe!==!0;return j.useEffect(()=>{console.log("[CAN_ROLL_CHECK]",{phase:t,myUid:c,turnPlayerId:w,isMyTurn:we,turnLock:at,modalLocks:W,gameOver:k,bankrupt:ne,result:Wt})},[t,c,w,we,at,W,k,ne,Wt]),t==="start"?a.jsx(Px,{onEnter:C=>{var L;const N=String(C||"").trim();N&&(Nm(N),u(N),x([h({id:i,name:N,cash:18e3,pos:0,color:"#ffd54f",bens:4e3})],{source:"START"}),y(1),m(0),R(!1),E(null),D(new Array(1).fill(!1)),$(q=>({...q,name:N})),V([`Bem-vindo, ${N}!`]),s?(r(s),(L=window.__setRoomCode)==null||L.call(window,s),e("playersLobby")):e("lobbies"))}}):t==="lobbies"?a.jsx(Gx,{onEnterRoom:C=>{var N;r(C),(N=window.__setRoomCode)==null||N.call(window,C);try{localStorage.setItem("sg:lastRoomName",String(C));const L=new URL(window.location.href);L.searchParams.set("room",String(C)),history.replaceState(null,"",L.toString())}catch{}e("playersLobby")}}):t==="playersLobby"?a.jsx(qx,{lobbyId:n,onBack:()=>{var C;(C=window.__setRoomCode)==null||C.call(window,null),e("lobbies")},onStartGame:C=>{var ge;const N=(C==null?void 0:C.lobbyName)||((ge=C==null?void 0:C.lobby)==null?void 0:ge.name)||(C==null?void 0:C.name)||n||"sala-demo";try{localStorage.setItem("sg:lastRoomName",String(N));const M=new URL(window.location.href);if(M.searchParams.set("room",String(N)),history.replaceState(null,"",M.toString()),!sessionStorage.getItem("sg:room-reloaded")){sessionStorage.setItem("sg:room-reloaded","1"),location.reload();return}}catch{}const P=[...Array.isArray(C)?C:(C==null?void 0:C.players)??(C==null?void 0:C.lobbyPlayers)??[]].sort((M,oe)=>{const St=M.created_at||M.joined_at||M.createdAt||M.joinedAt,Xe=oe.created_at||oe.joined_at||oe.createdAt||oe.joinedAt;if(St&&Xe)return new Date(St)-new Date(Xe);const se=String(M.id??M.player_id??""),re=String(oe.id??oe.player_id??"");return se.localeCompare(re)}).map((M,oe)=>h({id:String(M.id??M.player_id),name:M.name??M.player_name,cash:18e3,pos:0,bens:4e3,color:["#ffd54f","#90caf9","#a5d6a7","#ffab91"][oe%4],seat:oe}));if(P.length===0)return;const B=p(P);try{B.find(oe=>String(oe.id)===String(i))&&d(String(i))}catch{}x(B,{source:"START_GAME"}),m(0),y(1),D(new Array(B.length).fill(!1)),R(!1),E(null),$(M=>{var St,Xe;const oe=B.find(Tt);return{...M,name:(oe==null?void 0:oe.name)||((St=B[0])==null?void 0:St.name)||"Jogador",color:(oe==null?void 0:oe.color)||((Xe=B[0])==null?void 0:Xe.color)||"#6c5ce7",cash:(oe==null?void 0:oe.cash)??18e3,possibAt:0,clientsAt:0}}),V(["Jogo iniciado!"]),xo(B),e("game")}}):a.jsxs("div",{className:"page",children:[a.jsxs("header",{className:"topbar",children:[a.jsxs("div",{className:"status",style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[a.jsx("span",{style:{width:18,height:18,borderRadius:"50%",border:"2px solid rgba(255,255,255,.9)",boxShadow:"0 0 0 2px rgba(0,0,0,.25)",background:T.color}}),a.jsxs("span",{style:{background:"#1f2430",border:"1px solid rgba(255,255,255,.12)",borderRadius:10,padding:"4px 10px",fontWeight:800},children:[" ",T.name]}),a.jsxs("span",{children:["Possib. Atendimento: ",a.jsx("b",{children:T.possibAt??0})]}),a.jsxs("span",{children:["Clientes em Atendimento: ",a.jsx("b",{children:T.clientsAt??0})]}),a.jsx(wb,{players:g,turnIdx:f,round:S,gameOver:k,winner:v})]}),a.jsxs("div",{className:"status",style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[a.jsxs("span",{children:["Rodada: ",S]}),a.jsxs("span",{className:"money",children:[" $ ",Number(zt).toLocaleString()]})]})]}),a.jsxs("main",{className:"content",children:[a.jsx("div",{className:"boardWrap",children:a.jsx(eb,{players:g,turnIdx:f,onMeHud:$})}),a.jsxs("aside",{className:"side",children:[a.jsx(tb,{totals:Pt,players:g}),a.jsxs("div",{className:"controlsSticky",children:[a.jsx(nb,{onAction:C=>{Re(C)},current:Si,isMyTurn:he,myUid:c,turnPlayerId:w,turnLock:at,lockOwner:F,modalLocks:W,gameOver:k}),a.jsx("div",{style:{marginTop:10},children:a.jsx("button",{className:"btn dark",onClick:async()=>{var C;if(n&&c)try{await zl({roomCode:n,playerId:c})}catch(N){console.warn("[App] Erro ao sair da sala:",N)}(C=window.__setRoomCode)==null||C.call(window,null),e("lobbies")},children:"Sair para Lobbies"})})]}),k&&a.jsx(rb,{players:g,onExit:async()=>{var C;if(n&&c)try{await zl({roomCode:n,playerId:c})}catch(N){console.warn("[App] Erro ao sair da sala:",N)}(C=window.__setRoomCode)==null||C.call(window,null),e("lobbies")},onRestart:()=>{const C=g.map(N=>h({...N,cash:18e3,bens:4e3,pos:0}));x(C,{source:"RESTART"}),m(0),y(1),D(new Array(C.length).fill(!1)),V(["Novo jogo iniciado!"]),R(!1),E(null)}})]})]}),a.jsx("footer",{className:"foot",children:a.jsxs("small",{children:["Desenvolvido por ",a.jsx("a",{href:"https://www.tironitech.com",target:"_blank",rel:"noreferrer",children:"tironitech.com"})]})}),Y&&a.jsx(ob,{})]})}function Ib(){const e=new URLSearchParams(window.location.search).get("room");return e&&String(e).trim()||null}function $b(){const[t,e]=ce.useState(Ib());return ce.useEffect(()=>(window.__setRoomCode=n=>{const r=String(n||"").trim()||null;e(r);const s=new URL(window.location.href);r?s.searchParams.set("room",r):s.searchParams.delete("room"),window.history.replaceState({},"",s)},()=>{delete window.__setRoomCode}),[]),ce.useEffect(()=>(window.exportLogs=()=>{const n=Pm(),r=new Blob([n.text],{type:"text/plain;charset=utf-8"}),s=URL.createObjectURL(r),o=document.createElement("a");return o.href=s,o.download=`debug-logs-${new Date().toISOString().slice(0,19).replace(/:/g,"-")}.txt`,o.click(),URL.revokeObjectURL(s),console.log(" Logs exportados! Arquivo .txt baixado."),n},window.getLogsText=()=>db(),window.getLogsJSON=()=>fb(),window.getLogStats=()=>nc(),window.toggleLogCapture=()=>(hr.enabled?(hr.disable(),console.log(" Captura de logs DESATIVADA")):(hr.enable(),console.log(" Captura de logs ATIVADA")),hr.enabled),console.log("%c FUNES DE EXPORT DE LOGS DISPONVEIS:","color: #4CAF50; font-weight: bold; font-size: 14px"),console.log("%cexportLogs()","color: #2196F3; font-weight: bold","- Exporta logs completos (baixa arquivo .txt)"),console.log("%cgetLogsText()","color: #2196F3; font-weight: bold","- Retorna logs como string de texto"),console.log("%cgetLogsJSON()","color: #2196F3; font-weight: bold","- Retorna logs como objeto JSON"),console.log("%cgetLogStats()","color: #2196F3; font-weight: bold","- Retorna estatsticas dos logs"),console.log("%ctoggleLogCapture()","color: #2196F3; font-weight: bold","- Ativa/desativa captura de logs"),()=>{delete window.exportLogs,delete window.getLogsText,delete window.getLogsJSON,delete window.getLogStats,delete window.toggleLogCapture}),[]),a.jsx(sb,{children:a.jsx(Pb,{roomCode:t,children:a.jsx(Lb,{})})})}Jl.createRoot(document.getElementById("root")).render(a.jsx(ce.StrictMode,{children:a.jsx($b,{})}));
//# sourceMappingURL=index-CZg4Xxey.js.map
